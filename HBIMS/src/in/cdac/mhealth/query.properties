* Department Service Query */

GET_DEPARTMENT_LIST_FOR_REGISTRATION = Select hopnum_deptunitcode, gstr_dept_name || '('||hgstr_unitname||')' ||'('|| string_agg(DOW, ', ')||')' dept_name from (SELECT DISTINCT hopnum_deptunitcode, gstr_dept_name, hgstr_unitname,(hopdt_start_dt), DECODE(EXTRACT(DOW FROM  hopdt_start_dt),0,'Su',1,'M',2,'Tu',3,'W',4,'Th',5,'F',6,'Sa') DOW, ROW_NUMBER() OVER (PARTITION BY hopnum_deptunitcode, trunc(hopdt_start_dt) ORDER BY hopnum_deptunitcode ASC,trunc(hopdt_start_dt) ASC) R FROM hopt_dept_unit_roster_dtl a WHERE  gnum_isvalid \= 1  AND hgnum_roster_type \= 1 AND gnum_hospital_code \= ? AND trunc(hopdt_start_dt) >\= trunc(SYSDATE) AND trunc(hopdt_end_dt)<\= trunc(SYSDATE+6) and gnum_dept_code not in(101,134,190,123) order by 1,4) x Where R\=1  group by hopnum_deptunitcode, gstr_dept_name || '('||hgstr_unitname||')'  order by 2 

GET_CATEGORY_LIST_FOR_REGISTRATION = select gnum_patient_cat_code,gstr_patient_cat_name from gblt_patient_cat_mst where gnum_isvalid\=1 and gnum_hospital_code\=? and gnum_patient_cat_code in (69) 



GET_DEPARMENT_LIST = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM ahis.GBLT_DEPARTMENT_MST WHERE GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE) AND GNUM_ISVALID \= 1 AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE \= 1  ORDER BY GSTR_DEPT_NAME
						
GET_DEPARTMENT_NAME_FROM_DEPARTMENT_ID = Select hopnum_deptunitcode, gstr_dept_name || '('||hgstr_unitname||')' ||'('|| string_agg(DOW, ', ')||')' dept_name from (SELECT DISTINCT hopnum_deptunitcode, gstr_dept_name, hgstr_unitname,(hopdt_start_dt), DECODE(EXTRACT(DOW FROM  hopdt_start_dt),0,'Su',1,'M',2,'Tu',3,'W',4,'Th',5,'F',6,'Sa') DOW, ROW_NUMBER() OVER (PARTITION BY hopnum_deptunitcode, trunc(hopdt_start_dt) ORDER BY hopnum_deptunitcode ASC,trunc(hopdt_start_dt) ASC) R FROM hopt_dept_unit_roster_dtl a WHERE  gnum_isvalid \= 1  AND hgnum_roster_type \= 1 AND gnum_hospital_code \= ? AND trunc(hopdt_start_dt) >\= trunc(SYSDATE) AND trunc(hopdt_end_dt)<\= trunc(SYSDATE+6) and gnum_dept_code not in(101,134,190,116, 123)  order by 1,4) x Where R\=1 and hopnum_deptunitcode\=? group by hopnum_deptunitcode, gstr_dept_name || '('||hgstr_unitname||')'  order by 2 
						
GET_DEPARMENT_FROM_ID = SELECT GSTR_DEPT_NAME FROM ahis.GBLT_DEPARTMENT_MST WHERE GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE) AND GNUM_ISVALID \= 1 AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE \= 1  AND GNUM_DEPT_CODE \= ?
	
DEPARTMENT_SERVICE_GET_DEPT_DETAIL = SELECT G.GSTR_DEPT_NAME as dept_name, (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || NVL (DECODE (INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE (SIGN (LENGTH (TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM (INITCAP (STR_MIDDLE_NAME))) || DECODE (SIGN (LENGTH (TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM (INITCAP (STR_LAST_NAME))), '-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= G.GSTR_HOD_CODE) hod_name, (SELECT L.HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST L WHERE GNUM_ISVALID \= 1 AND L.HGNUM_LOCATION_CODE \= G.GNUM_LOCATION_CODE) location, (SELECT T.GSTR_DEPT_TYPE_NAME FROM AHIS.GBLT_DEPARTMENT_TYPE T where T.GNUM_DEPT_TYPE \= G.GNUM_DEPT_TYPE ) dept_type FROM AHIS.GBLT_DEPARTMENT_MST G WHERE GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE) AND GNUM_ISVALID \= 1 AND G.GNUM_HOSPITAL_CODE \= ? AND G.GNUM_DEPT_CODE \= ? Order by dept_name\t\t\t\t\t\t
						
/* Disease Do's Don't Service Query */\t\t\t\t                 \t\t\t\t                 
DEPARTMENT_SERVICE_GET_DEPT_MEMBER_DETAIL_VIEW = select DECODE (a.GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || ' ' || a.FULL_NAME as name, decode(a.STR_GENDER_NAME, 'M', 'Male', 'F', 'Female', 'Other'), to_char(a.DT_BIRTH_DATE,'dd-Mon-yyyy'), a.STR_VALIDATE, a.STR_DESIG_NAME from v_employee_details a where A.GNUM_HOSPITAL_CODE\=? and a.CURRENT_DEPT \= ?
DEPARTMENT_SERVICE_GET_DEPT_MEMBER_DETAIL = select  DECODE (p.GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || ' ' || P.STR_FIRST_NAME || ' ' || P.STR_MIDDLE_NAME || ' ' || P.STR_LAST_NAME as nm, decode(P.STR_GENDER_NAME, 'M', 'Male', 'F', 'Female', 'Other') as gender, P.DT_BIRTH_DATE, P.STR_VALIDATE, (select D.STR_DESIG_NAME from PIST_DESIGNATION_MST d where D.NUM_DESIG_ID\= C.NUM_DESIG_ID and D.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE and D.GNUM_ISVALID \= 1) as desig from PIST_EMP_PERSONNEL_DTL p, PIST_EMP_CUR_DETAIL_DTL c where C.STR_EMP_NO \= P.STR_EMP_NO and C.GNUM_HOSPITAL_CODE \= P.GNUM_HOSPITAL_CODE and P.GNUM_HOSPITAL_CODE \= ? and C.GNUM_ISVALID \= 1 and P.GNUM_ISVALID \= 1 and C.NUM_DEPT_ID \= ?
GET_OPD_PATIENT_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) || ' ' || INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname) AS patname, DECODE (a.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.dob_age_on (A.HRGDT_DOB, SYSDATE) gen_age, a.hrgnum_episode_code AS episodecode FROM ahis.hrgt_daily_patient_dtl a WHERE TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1 ORDER BY a.hrgnum_is_confirmed, a.hrgnum_que_no ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
              			
GET_OPD_PATIENT_LIST_COUNT = SELECT count(*) FROM ahis.hrgt_daily_patient_dtl a WHERE TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1 

GET_OPD_PATIENT_NAME_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) || ' ' || INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname) AS patname, a.gnum_gender_code, A.HRGDT_DOB, a.hrgnum_episode_code AS episodecode  FROM ahis.hrgt_daily_patient_dtl a WHERE (upper(INITCAP (a.hrgstr_fname) || ' ' || INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname)) like ?) AND TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1 ORDER BY a.hrgnum_is_confirmed, a.hrgnum_que_no ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?

GET_OPD_PATIENT_NAME_SEARCH_LIST_COUNT = SELECT count(*) FROM ahis.hrgt_daily_patient_dtl a WHERE (upper(INITCAP (a.hrgstr_fname) || ' ' || INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname)) like ?) AND TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1 
								         
GET_OPD_PATIENT_CRNO_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) || ' ' ||  INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname) AS patname, a.gnum_gender_code, A.HRGDT_DOB, a.hrgnum_episode_code AS episodecode  FROM ahis.hrgt_daily_patient_dtl a WHERE a.hrgnum_puk like ? AND TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1 ORDER BY a.hrgnum_is_confirmed, a.hrgnum_que_no ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?

GET_OPD_PATIENT_CRNO_SEARCH_LIST_COUNT = SELECT count(*) FROM ahis.hrgt_daily_patient_dtl a WHERE a.hrgnum_puk like ? AND TRUNC (a.gdt_entry_date) \= TRUNC (SYSDATE) AND a.hrgnum_is_confirmed IN (1, 2) AND ( (hrgnum_change_type \= 0 AND a.GNUM_DEPT_CODE \= ?) OR (hrgnum_change_type \= 1 AND a.GNUM_DEPT_CODE \= ?)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= 1\t\t\t\t\t\t\t\t         

GET_IPD_PATIENT_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT  a.hrgnum_puk AS patcrno, INITCAP (c.hrgstr_fname) || ' ' || INITCAP (c.hrgstr_mname) || ' '  || INITCAP (c.hrgstr_lname) AS patname, DECODE (c.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, a.hipnum_ward_code || '/' || (SELECT hgnum_bed_name FROM ahis.hipt_ward_room_bed_mst WHERE hgnum_bed_code \= a.hipnum_bed_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1)  ward_bed, a.hrgnum_episode_code AS episodecode FROM ahis.hipt_patadmission_dtl a, ahis.hrgt_patient_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_hospital_code \= ? AND a.gnum_dept_code \= ? AND a.gnum_isvalid \= 1 ORDER BY a.hipdt_admdatetime DESC ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
     					
GET_IPD_PATIENT_LIST_COUNT = SELECT   count(*) FROM ahis.hipt_patadmission_dtl a, ahis.hrgt_patient_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_dept_code \= ? AND a.gnum_isvalid \= 1 and C.GNUM_HOSPITAL_CODE\=?     \t\t\t\t\t
              															
GET_IPD_PATIENT_NAME_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT  a.hrgnum_puk AS patcrno, INITCAP (c.hrgstr_fname) || ' ' || INITCAP (c.hrgstr_mname) || ' '  || INITCAP (c.hrgstr_lname) AS patname, DECODE (c.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, 'WARD ' || a.hipnum_ward_code || '/' || (SELECT hgnum_bed_name FROM ahis.hipt_ward_room_bed_mst WHERE hgnum_bed_code \= a.hipnum_bed_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1)  ward_bed, a.hrgnum_episode_code FROM ahis.hipt_patadmission_dtl a, ahis.hrgt_patient_dtl c WHERE (upper(INITCAP (c.hrgstr_fname) || ' ' || INITCAP (c.hrgstr_mname) || ' '  || INITCAP (c.hrgstr_lname)) like ?) and a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_hospital_code \= ? AND a.gnum_dept_code \= ?  AND a.gnum_isvalid \= 1 ORDER BY a.hipdt_admdatetime DESC ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
				                   
GET_IPD_PATIENT_NAME_SEARCH_LIST_COUNT = SELECT count(*) FROM ahis.hipt_patadmission_dtl a, ahis.hrgt_patient_dtl c WHERE  (upper(INITCAP (c.hrgstr_fname) || ' ' || INITCAP (c.hrgstr_mname) || ' '  || INITCAP (c.hrgstr_lname)) like ?) and a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_dept_code \= ? AND a.gnum_isvalid \= 1 and C.GNUM_HOSPITAL_CODE\=?\t\t\t\t                   
     
GET_IPD_PATIENT_CRNO_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT  a.hrgnum_puk AS patcrno, INITCAP (c.hrgstr_fname) || ' ' || INITCAP (c.hrgstr_mname) || ' '  || INITCAP (c.hrgstr_lname) AS patname, DECODE (c.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, 'WARD ' || a.hipnum_ward_code || '/' || (SELECT hgnum_bed_name FROM ahis.hipt_ward_room_bed_mst WHERE hgnum_bed_code \= a.hipnum_bed_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1)  ward_bed, a.hrgnum_episode_code AS episodecode FROM ahis.hipt_patadmission_dtl a, ahis.hrgt_patient_dtl c WHERE A.HRGNUM_PUK like ?  and a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_hospital_code \= ? AND a.gnum_dept_code \= ? AND a.gnum_isvalid \= 1 ORDER BY a.hipdt_admdatetime DESC ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
     
GET_IPD_PATIENT_CRNO_SEARCH_LIST_COUNT = SELECT count(*) FROM ahis.hipt_patadmission_dtl a, hrgt_patient_dtl c WHERE a.hrgnum_puk like ? and a.hrgnum_puk \= c.hrgnum_puk AND a.hipdt_admstatus_code IN (12, 18) AND hipnum_isaccepted \= 1 AND a.gnum_dept_code \= ? AND a.gnum_isvalid \= 1 and C.GNUM_HOSPITAL_CODE\=?
     
              															
GET_PATIENT_DETAIL = SELECT a.hrgnum_puk AS patcrno,  a.hrgstr_fname || ' ' || a.hrgstr_mname || ' ' || a.hrgstr_lname as pname, DECODE (a.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, (SELECT e.gstr_patient_cat_name FROM ahis.gblt_patient_cat_mst e WHERE e.gnum_patient_cat_code \= a.hgnum_patient_cat_code AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= 1 AND e.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (e.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS patprimarycat, (SELECT k.gstr_dept_name FROM ahis.gblt_department_mst k WHERE k.gnum_dept_code \= p.gnum_dept_code AND k.gnum_hospital_code \= p.gnum_hospital_code AND k.gnum_isvalid \= 1 AND k.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (k.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS departmentname, (SELECT l.hgstr_unitname FROM ahis.hgbt_unit_mst l WHERE l.hgnum_deptunitcode \= p.gnum_deptunit_code AND l.gnum_hospital_code \= p.gnum_hospital_code AND l.gnum_isvalid \= 1 AND l.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (l.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS departmentunitname, p.hrgnum_episode_code AS episodecode, p.HRGNUM_VISIT_NO as visit_no,to_char(P.HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mm') as adm_date FROM ahis.hrgt_patient_dtl a, hipt_patadmission_dtl p WHERE a.hrgnum_puk \= p.hrgnum_puk AND p.hipdt_admstatus_code NOT IN (13, 14, 16) AND p.gnum_isvalid \= 1 AND a.hrgnum_puk \= ? and P.HRGNUM_EPISODE_CODE\=? AND a.gnum_isvalid \= 1 AND a.gnum_hospital_code \= ?
              				
              				
GET_PATIENT_DETAIL_OPD = SELECT a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) || ' ' || INITCAP (a.hrgstr_mname) || ' ' || INITCAP (a.hrgstr_lname) AS pname, DECODE (a.gnum_gender_code,  1, 'M',  2, 'F',  'O') || '/' || ahis_util.dob_age_on (A.HRGDT_DOB, SYSDATE)  AS patage, (SELECT e.gstr_patient_cat_name  FROM ahis.gblt_patient_cat_mst e  WHERE     e.gnum_patient_cat_code \= a.hgnum_patient_cat_code AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= 1 AND e.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (e.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS patprimarycat, (SELECT k.gstr_dept_name FROM ahis.gblt_department_mst k WHERE k.gnum_dept_code \= a.gnum_dept_code AND k.gnum_hospital_code \= a.gnum_hospital_code AND k.gnum_isvalid \= 1 AND k.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (k.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS departmentname, (SELECT l.hgstr_unitname          FROM ahis.hgbt_unit_mst l WHERE l.hgnum_deptunitcode \= a.HGNUM_DEPTUNITCODE AND l.gnum_hospital_code \= a.gnum_hospital_code AND l.gnum_isvalid \= 1 AND l.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (l.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE))          AS departmentunitname, a.HRGNUM_EPISODE_CODE AS episodecode, a.HRGNUM_VISIT_NO AS visit_no, to_char(A.HRGDT_EPISODE_DATE, 'dd-Mon-yyyy hh24\:mm') as episodedate FROM ahis.hrgt_daily_patient_dtl a WHERE  a.hrgnum_is_confirmed IN (1, 2) AND a.gnum_isvalid \= 1 AND a.hrgnum_puk \= ? AND a.HRGNUM_EPISODE_CODE \= ? AND a.gnum_hospital_code \= ?\t\t\t\t\t\t\t\t\t\t\t
              															
GET_PATIENT_DIAGNOSIS_LIST = SELECT   hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode, DECODE (hrgnum_diagnosis_code_type, 0, (SELECT nvl(hgbstr_disease,'-') FROM ahis.hgbt_icd_disease_mst WHERE TRIM (UPPER (hgbstr_disease_code)) \= TRIM (UPPER (a.hrgnum_diagnostic_code)) AND hgnum_record_type \= 0), 1, (SELECT nvl(hgbstr_disease_desc,'-') FROM ahis.hgbt_hospital_disease_mst WHERE TRIM (hgbstr_hospital_disease_code) \= TRIM (a.hrgnum_diagnostic_code) AND gnum_hospital_code \= a.gnum_hospital_code) ) AS dignosisname, (SELECT nvl(hgbstr_diagnostic_type_name,'-') FROM ahis.hgbt_diagnosis_type_mst WHERE a.gnum_diagnostic_type_code \= hgbnum_diagnostic_type_code AND gnum_hospital_code \= a.gnum_hospital_code) AS diagnostictypename, TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy') AS entrydate FROM ahis.hrgt_episode_diagnosis_dtl a WHERE hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND gnum_hospital_code \= ? ORDER BY hrgnum_visit_no, hrgnum_s_no              \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
			   				 
GET_PATIENT_DIAGNOSIS_LIST_COUNT = SELECT   count(*) FROM ahis.hrgt_episode_diagnosis_dtl a WHERE hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND gnum_hospital_code \= ? ORDER BY hrgnum_visit_no, hrgnum_s_no
			   				 
GET_PATIENT_TREATMENT_LIST = SELECT 0 AS opdipdflag, hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode, nvl(hststr_item_name,'-') AS drugname, (SELECT nvl(hgstr_frequency_name,'-') FROM ahis.hgbt_drug_frequency_mst WHERE hgnum_frequency_id \= b.hgnum_frequency_id AND gnum_isvalid \= 1 AND gnum_hospital_code \= b.gnum_hospital_code) AS frequencyname, nvl(hgnum_dose_qty, 0) AS doseqty, TO_CHAR (GDT_ENTRY_DATE, 'dd-Mon-yyyy') AS orderbydate FROM ahis.hrgt_episode_drug_dtl b WHERE     hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND b.hrgnum_entry_mode \= 1 UNION SELECT 1 AS opdipdflag, hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode, nvl(hststr_item_name,'-') AS drugname, (SELECT nvl(hgstr_frequency_name,'-') FROM ahis.hgbt_drug_frequency_mst WHERE     hgnum_frequency_id \= a.hgnum_frequency_id AND gnum_isvalid \= 1 AND gnum_hospital_code \= b.gnum_hospital_code) AS frequencyname, nvl(hgnum_dose_qty, 0) AS doseqty, TO_CHAR (a.GDT_ENTRY_DATE, 'dd-Mon-yyyy') AS orderbydate FROM ahis.hpmrt_profile_drug_advice_dtl a, ahis.hpmrt_pat_profile_dtl b WHERE     a.hpmrnum_profile_id \= b.hpmrnum_profile_id AND a.gnum_hospital_code \= b.gnum_hospital_code AND hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND a.gnum_hospital_code \= ? AND b.gnum_isvalid \= 1 AND a.gnum_isvalid \= 1 AND a.hrgnum_entry_mode \= 1 ORDER BY orderbydate\t\t\t   \t\t\t\t 
					         
GET_PATIENT_TREATMENT_LIST_COUNT = SELECT a + b FROM (SELECT (SELECT COUNT (*) FROM ahis.hrgt_episode_drug_dtl b WHERE hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND b.hrgnum_entry_mode \= 1) a, (SELECT COUNT (*) FROM ahis.hpmrt_profile_drug_advice_dtl a, ahis.hpmrt_pat_profile_dtl b WHERE     a.hpmrnum_profile_id \= b.hpmrnum_profile_id AND a.gnum_isvalid \= b.gnum_isvalid AND a.gnum_hospital_code \= b.gnum_hospital_code AND hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND a.gnum_hospital_code \= ? AND b.gnum_isvalid \= 1 AND a.gnum_isvalid \= 1 AND a.hrgnum_entry_mode \= 1) b FROM DUAL)
					         
GET_PATIENT_PROGRESS_NOTES_LIST = SELECT a.hrgnum_puk, a.hrgnum_episode_code, nvl(a.hipstr_progress_notes,'-') AS progressnote, TO_CHAR (a.hipdt_round_time, 'dd-Mon-yyyy hh24\:mi') AS roundtime FROM ahis.hipd_doctor_round_dtl a WHERE a.hrgnum_puk \= ? AND a.hrgnum_episode_code \= ? AND a.hipnum_verify_flag \= 1 AND a.gnum_doctorseat_id \= 10001 AND a.gnum_isvalid \= 1 AND a.gnum_hospital_code \= ? ORDER BY roundtime DESC
					         
GET_PATIENT_PROGRESS_NOTES_LIST_COUNT = SELECT count(*) FROM ahis.hipd_doctor_round_dtl a WHERE a.hrgnum_puk = ? AND a.hrgnum_episode_code = ? AND a.hipnum_verify_flag = 1 AND a.gnum_doctorseat_id = 10001 AND a.gnum_isvalid = 1 AND a.gnum_hospital_code = ?					         

DOCTOR_DESK_SERVICE_GET_INVEST_LIST = select * from (select z.*, rownum as rnum from (SELECT to_char(requisitiondno), to_char(requisitionno), patvisitno, requisitiondate,  (select A.GSTR_LAB_NAME from GBLT_LABORATORY_MST a where A.GBL_ISVALID \= 1 and A.GNUM_HOSPITAL_CODE \= hospitalcode and A.GNUM_LAB_CODE \= laboratorycode) as labname, (select A.GSTR_TEST_NAME from GBLT_TEST_MST a where A.GNUM_ISVALID \= 1 and A.GNUM_HOSPITAL_CODE \= hospitalcode and A.GNUM_TEST_CODE \= testcode) as testname, DECODE ( NVL (samplegroupcode, 0), 0, 'READY',DECODE ((SELECT COUNT (hrdf.hivtnum_req_dno) FROM hivt_requisition_dtl hrdf WHERE SUBSTR (hrdf.hivtnum_req_dno, 1, 18) \= SUBSTR (requisitiondno, 1, 18) AND hrdf.gnum_lab_test_code \= laboratorycode || testcode AND hrdf.hgnum_samplegroup_code \= samplegroupcode AND hrdf.gbnum_status_code < 16), 0, 'READY', 'NOTREADY'))AS istestready, investigationpatientdetails.getrequisitiontypename (requisitiontypecode) AS requisitiontypename, testStatusCode, investigationpatientdetails. GETREPORTINGFILECREATIONDATE (requisitiontypecode, patcrno, requisitiondno, NVL (hwmd.hivtnum_multisession_id, 0), hospitalCode) AS fileCreationDateTime FROM    (SELECT hrh.hivnum_req_no AS requisitionno, hrd.hivtnum_req_dno AS requisitiondno, hrd.HIVTNUM_ASSO_TO_WORK_ORDR AS associatedToWorkOrder, hrd.hgnum_sample_code AS samplecode, hrd.hgnum_group_code AS groupcode, hltd.gnum_hospital_Code AS hospitalCode, hrh.hgnum_visitno AS patvisitno,hrd.hgnum_samplegroup_code AS samplegroupcode,hrd.gbnum_priority_code AS prioritycode,SUBSTR (hrd.gnum_lab_test_code, 1, 5) AS laboratorycode,SUBSTR (hrd.gnum_lab_test_code, 6, 4) AS testcode,hrh.hbnum_requisition_type AS requisitiontypecode, DECODE (hrh.hbnum_requisition_type,1, hrh.hrgnum_puk,2, hrh.hrgnum_puk, '')AS patcrno,DECODE (hrh.hbnum_requisition_type,1, hrh.hrgstr_episode_code,2, hrh.hrgstr_episode_code,'') AS patepisodecode,hrd.hivtnum_res_val_seatid AS resultvalidatedby,hrh.hipstr_ward_name AS wardname, TO_CHAR (hrh.hrgdt_episode_date, 'dd/mm/yyyy') AS visitdate,hrh.hipstr_room_name AS roomname,hrh.hipnum_bed_code AS bedcode,hrh.hipstr_bed_name AS bedname,TO_CHAR (hrh.hivt_requisition_date, 'DD/MM/YYYY') AS requisitiondate,hrh.hgnum_deptunitcode AS deptunitcode, hrh.hgnum_dept_code AS deptcode,DECODE (NVL (hrd.hgnum_sample_code, 0), 0, 'P', 'S')AS testtype,hrd.GBNUM_STATUS_CODE AS testStatusCode,hrh.HGSTR_ORDERED_BY_DOC AS patAdvisedBy FROM hivt_requisition_dtl hrd, hivt_requisition_header hrh, hivt_laboratory_test_dtl hltd WHERE hrh.hivnum_req_no \= SUBSTR (hrd.hivtnum_req_dno, 1, 18) AND hltd.GNUM_LAB_TEST_CODE \= hrd.gnum_current_lab_code || SUBSTR (hrd.GNUM_LAB_TEST_CODE, 6, 4) AND hrd.gbnum_status_code IN (9, 16, 17) AND hltd.GDT_EFFECTIVE_FRM <\= TRUNC (hrd.hivt_entry_date) AND NVL (GDT_EFFECTIVE_TO, SYSDATE) >\= TRUNC (hrd.hivt_entry_date)AND hltd.gnum_hospital_Code \= ? AND hrh.HRGSTR_EPISODE_CODE \= ? AND HRH.HRGNUM_PUK \= ?) view1 LEFT OUTER JOIN hivt_wrkdr_multisession_dtl hwmd ON view1.requisitiondno \= hwmd.hivtnum_req_dno AND hwmd.hivtnum_status_code \= 10 ORDER BY fileCreationDateTime desc) z ) where rnum>\=? and rnum<\=?

DOCTOR_DESK_SERVICE_GET_INVEST_LIST_COUNT = SELECT count(*) FROM    (SELECT hrh.hivnum_req_no AS requisitionno, hrd.hivtnum_req_dno AS requisitiondno, hrd.HIVTNUM_ASSO_TO_WORK_ORDR AS associatedToWorkOrder, hrd.hgnum_sample_code AS samplecode, hrd.hgnum_group_code AS groupcode, hltd.gnum_hospital_Code AS hospitalCode, hrh.hgnum_visitno AS patvisitno,hrd.hgnum_samplegroup_code AS samplegroupcode,hrd.gbnum_priority_code AS prioritycode,SUBSTR (hrd.gnum_lab_test_code, 1, 5) AS laboratorycode,SUBSTR (hrd.gnum_lab_test_code, 6, 4) AS testcode,hrh.hbnum_requisition_type AS requisitiontypecode, DECODE (hrh.hbnum_requisition_type,1, hrh.hrgnum_puk,2, hrh.hrgnum_puk, '')AS patcrno,DECODE (hrh.hbnum_requisition_type,1, hrh.hrgstr_episode_code,2, hrh.hrgstr_episode_code,'') AS patepisodecode,hrd.hivtnum_res_val_seatid AS resultvalidatedby,hrh.hipstr_ward_name AS wardname, TO_CHAR (hrh.hrgdt_episode_date, 'dd/mm/yyyy') AS visitdate,hrh.hipstr_room_name AS roomname,hrh.hipnum_bed_code AS bedcode,hrh.hipstr_bed_name AS bedname,TO_CHAR (hrh.hivt_requisition_date, 'DD/MM/YYYY') AS requisitiondate,hrh.hgnum_deptunitcode AS deptunitcode, hrh.hgnum_dept_code AS deptcode,DECODE (NVL (hrd.hgnum_sample_code, 0), 0, 'P', 'S')AS testtype,hrd.GBNUM_STATUS_CODE AS testStatusCode,hrh.HGSTR_ORDERED_BY_DOC AS patAdvisedBy FROM hivt_requisition_dtl hrd, hivt_requisition_header hrh, hivt_laboratory_test_dtl hltd WHERE hrh.hivnum_req_no \= SUBSTR (hrd.hivtnum_req_dno, 1, 18) AND hltd.GNUM_LAB_TEST_CODE \= hrd.gnum_current_lab_code || SUBSTR (hrd.GNUM_LAB_TEST_CODE, 6, 4) AND hrd.gbnum_status_code IN (9, 16, 17) AND hltd.GDT_EFFECTIVE_FRM <\= TRUNC (hrd.hivt_entry_date) AND NVL (GDT_EFFECTIVE_TO, SYSDATE) >\= TRUNC (hrd.hivt_entry_date)AND hltd.gnum_hospital_Code \= ? AND hrh.HRGSTR_EPISODE_CODE \= ? AND HRH.HRGNUM_PUK \= ?) view1 LEFT OUTER JOIN hivt_wrkdr_multisession_dtl hwmd ON view1.requisitiondno \= hwmd.hivtnum_req_dno AND hwmd.hivtnum_status_code \= 10    

DOCTOR_DESK_SERVICE_GET_INVEST_PDF = SELECT investigationpatientdetails.getpdfreportingfile (requisitiontypecode,patcrno,requisitiondno,NVL (hwmd.hivtnum_multisession_id, 0),hospitalcode) AS PdfFtpUrl FROM    (SELECT hrh.hivnum_req_no AS requisitionno, hrd.hivtnum_req_dno AS requisitiondno, hrd.HIVTNUM_ASSO_TO_WORK_ORDR AS associatedToWorkOrder, hrd.hgnum_sample_code AS samplecode, hrd.hgnum_group_code AS groupcode, hltd.gnum_hospital_Code AS hospitalCode, hrh.hgnum_visitno AS patvisitno,hrd.hgnum_samplegroup_code AS samplegroupcode,hrd.gbnum_priority_code AS prioritycode,SUBSTR (hrd.gnum_lab_test_code, 1, 5) AS laboratorycode,SUBSTR (hrd.gnum_lab_test_code, 6, 4) AS testcode,hrh.hbnum_requisition_type AS requisitiontypecode, DECODE (hrh.hbnum_requisition_type,1, hrh.hrgnum_puk,2, hrh.hrgnum_puk, '')AS patcrno,DECODE (hrh.hbnum_requisition_type,1, hrh.hrgstr_episode_code,2, hrh.hrgstr_episode_code,'') AS patepisodecode,hrd.hivtnum_res_val_seatid AS resultvalidatedby,hrh.hipstr_ward_name AS wardname, TO_CHAR (hrh.hrgdt_episode_date, 'dd/mm/yyyy') AS visitdate,hrh.hipstr_room_name AS roomname,hrh.hipnum_bed_code AS bedcode,hrh.hipstr_bed_name AS bedname,TO_CHAR (hrh.hivt_requisition_date, 'DD/MM/YYYY') AS requisitiondate,hrh.hgnum_deptunitcode AS deptunitcode,  hrh.hgnum_dept_code AS deptcode,DECODE (NVL (hrd.hgnum_sample_code, 0), 0, 'P', 'S')AS testtype,hrd.GBNUM_STATUS_CODE AS testStatusCode,hrh.HGSTR_ORDERED_BY_DOC AS patAdvisedBy FROM hivt_requisition_dtl hrd, hivt_requisition_header hrh, hivt_laboratory_test_dtl hltd  WHERE hrh.hivnum_req_no \= SUBSTR (hrd.hivtnum_req_dno, 1, 18) AND hltd.GNUM_LAB_TEST_CODE \= hrd.gnum_current_lab_code || SUBSTR (hrd.GNUM_LAB_TEST_CODE, 6, 4) AND hrd.gbnum_status_code IN (9, 16, 17) AND hltd.GDT_EFFECTIVE_FRM <\= TRUNC (hrd.hivt_entry_date) AND NVL (GDT_EFFECTIVE_TO, SYSDATE) >\= TRUNC (hrd.hivt_entry_date)AND hltd.gnum_hospital_Code \= ? AND hrh.HRGSTR_EPISODE_CODE \= ? AND HRH.HRGNUM_PUK \= ? and hrd.hivtnum_req_dno\=? and hrh.hivnum_req_no\=?) view1  LEFT OUTER JOIN hivt_wrkdr_multisession_dtl hwmd ON view1.requisitiondno \= hwmd.hivtnum_req_dno AND hwmd.hivtnum_status_code \= 10 

DOCTOR_DESK_SERVICE_GET_INVEST_GROUP = SELECT H.HGNUM_GROUP_CODE, H.HGSTR_GROUP_NAME FROM AHIS.HIVT_TEST_GROUP_MST H where H.GNUM_ISVALID=1 and H.GNUM_HOSPITAL_CODE=?

DOCTOR_DESK_SERVICE_GET_INVEST_GROUP_INFO = SELECT substr(H.GNUM_LAB_TEST_CODE,1,5) lab_code, AA.GSTR_LAB_NAME, substr(H.GNUM_LAB_TEST_CODE,6,4) test_code, A.GSTR_TEST_NAME  FROM AHIS.HIVT_TEST_GROUP_INFO_MST H, AHIS.GBLT_TEST_MST a, AHIS.GBLT_LABORATORY_MST aa where H.GNUM_IS_VALID\=1 and AA.GBL_ISVALID\=1 and A.GNUM_ISVALID\=1  and Aa.GNUM_HOSPITAL_CODE\=H.GNUM_HOSPITAL_CODE and a.GNUM_HOSPITAL_CODE\=H.GNUM_HOSPITAL_CODE  and AA.GNUM_LAB_CODE \=substr(H.GNUM_LAB_TEST_CODE,1,5) AND TO_DATE (a.GDT_EFFECTIVE_FRM) <\= TO_DATE (SYSDATE) AND TO_DATE (NVL (a.GDT_EFFECTIVE_To, SYSDATE)) <\= TO_DATE (SYSDATE) AND TO_DATE (aa.GDT_EFFECTIVE_FRM) <\= TO_DATE (SYSDATE) AND TO_DATE (NVL (aa.GDT_EFFECTIVE_To, SYSDATE)) <\= TO_DATE (SYSDATE) and A.GNUM_TEST_CODE\=substr(H.GNUM_LAB_TEST_CODE,6,4) and H.GNUM_HOSPITAL_CODE\=? and H.HGNUM_GROUP_CODE \= ? order by H.HGNUM_TESTGROUP_SEQ
											
DOCTOR_DESK_SERVICE_GET_MAX_INVEST_ORDER_NO = SELECT MAX(M.HRGNUM_INV_ORDER_NO) FROM MHEALTH.MHIVT_INVEST_ORDER M where M.GNUM_HOSPITAL_CODE = ? and M.GNUM_ISVALID = 1

DOCTOR_DESK_SERVICE_GENERATE_NEW_ORDER_NO = select decode(substr(to_char(sysdate,'dd-mm-yyyy'),9,2), substr(?,4,2), \
								             decode(substr(to_char(sysdate,'dd-mm-yyyy'),4,2), substr(?,6,2), \
								             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(nvl(substr(?, 8,6),0)+1 ,6,0), \
								             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1 ,6,0)), \
								             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1 ,6,0)) from dual

DOCTOR_DESK_SERVICE_INSERT_INVEST_ORDER = INSERT INTO MHEALTH.MHIVT_INVEST_ORDER (HRGNUM_INV_ORDER_NO, HRGNUM_PUK, HRGNUM_EPISODE_CODE,HRGNUM_VISIT_NO, GNUM_HOSPITAL_CODE) \
										  VALUES (?,?,?,?,?)

DOCTOR_DESK_SERVICE_INSERT_INVEST_ORDER_DTL = INSERT INTO MHEALTH.MHIVT_INVEST_ORDER_DTL (HRGNUM_INV_ORDER_NO, HGNUM_GROUP_CODE, GNUM_LAB_CODE,GNUM_TEST_CODE) VALUES (?,?,?,?) 

GET_MAX_CR_NO = SELECT  max(HRGNUM_PPUK)  FROM MHEALTH.MHRGT_MOBREG_DTL

GENERATE_NEW_CR_NO = select decode(substr(to_char(sysdate,'dd-mm-yyyy'),9,2), substr(?,4,2), \
		             decode(substr(to_char(sysdate,'dd-mm-yyyy'),4,2), substr(?,6,2), \
		             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(nvl(substr(?, 8,5),0)+1 ,5,0), \
		             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1 ,5,0)), \
		             ?||substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1 ,5,0)) from dual

GENERATE_QUEUE_NO = SELECT nvl(max(M.HRGNUM_QUE_NO), 0) + 1 FROM MHEALTH.MHRGT_MOBREG_DTL M where to_char(M.GDT_ENTRY_DATE,'dd-mm-yyyy') = to_char(sysdate,'dd-mm-yyyy')

REGISTER_PATIENT = \
INSERT INTO MHEALTH.MHRGT_MOBREG_DTL (HRGNUM_PPUK, HRGSTR_FNAME, HRGSTR_LNAME, GNUM_GENDER_CODE, HRGSTR_FATHER_NAME, \
HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGSTR_AGE, GNUM_HOSPITAL_CODE, GNUM_STATECODE, HRGSTR_CITY, HRGNUM_PIN_CODE, HRGNUM_QUE_NO) \
VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)

IPD_SEARCH_SERVICE_GET_NAME_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_NAME, decode(HRGSTR_SEX, 1, 'M', 2, 'F', 'O') || '/'|| HRGNUM_AGE || ' Yrs' as age, IPD_MST.GETWARDNAME(HIPNUM_WARD_CODE, GNUM_HOSPITAL_CODE , SYSDATE , NULL), IPD_MST.GETBEDNAME(HIPNUM_BED_CODE , GNUM_HOSPITAL_CODE) as bed, HIPDT_ADMSTATUS_CODE FROM ahis.HIPT_PATADMDISC_DTL WHERE GNUM_ISVALID \= 1 and HIPDT_ADMSTATUS_CODE in (11, 12) AND GNUM_HOSPITAL_CODE \= ? AND upper(HRGNUM_NAME) like ? ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
											
											
IPD_SEARCH_SERVICE_GET_NAME_SEARCH_COUNT = SELECT count (*) FROM ahis.HIPT_PATADMDISC_DTL WHERE GNUM_ISVALID = 1 and HIPDT_ADMSTATUS_CODE in (11, 12) AND GNUM_HOSPITAL_CODE = ? AND upper(HRGNUM_NAME) like ?

IPD_SEARCH_SERVICE_GET_CRNO_SEARCH_LIST = SELECT *  FROM(SELECT ROWNUM RNUM, Z.*  FROM ( SELECT HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_NAME, decode(HRGSTR_SEX, 1, 'M', 2, 'F', 'O') || '/'|| HRGNUM_AGE || ' Yrs' as age, IPD_MST.GETWARDNAME(HIPNUM_WARD_CODE, GNUM_HOSPITAL_CODE , SYSDATE , NULL), IPD_MST.GETBEDNAME(HIPNUM_BED_CODE , GNUM_HOSPITAL_CODE) as bed, HIPDT_ADMSTATUS_CODE FROM ahis.HIPT_PATADMDISC_DTL WHERE GNUM_ISVALID \= 1 AND GNUM_HOSPITAL_CODE \= ? AND HRGNUM_PUK like ? ) Z WHERE ROWNUM <\=?) WHERE RNUM >\=?
											
											
IPD_SEARCH_SERVICE_GET_CRNO_SEARCH_COUNT = SELECT count (*) FROM ahis.HIPT_PATADMDISC_DTL WHERE GNUM_ISVALID = 1 AND GNUM_HOSPITAL_CODE = ? AND HRGNUM_PUK like ?

IPD_SEARCH_SERVICE_GET_PATIENT_DETAIL = SELECT HRGNUM_NAME, decode(HRGSTR_SEX, 1, 'Male', 2, 'Female', 3, 'Other')  ||'/' || HRGNUM_AGE || ' Yrs' as age, IPD_MST.GETDEPTUNITNAME(GNUM_DEPTUNIT_CODE ,GNUM_HOSPITAL_CODE ) as dept_unit_name, IPD_MST.GETWARDNAME(HIPNUM_WARD_CODE, GNUM_HOSPITAL_CODE , SYSDATE , NULL) as ward_name, IPD_MST.GETROOMNAME(HIPNUM_ROOM_CODE ,GNUM_HOSPITAL_CODE ) as room , IPD_MST.GETBEDNAME(HIPNUM_BED_CODE , GNUM_HOSPITAL_CODE) as bed ,  DECODE(HIPDT_ADMSTATUS_CODE , 11,'On Transit (Within Hospital)' , 12, 'Admitted' , 13 , 'Not Reported' , 14,'Admission Cancelled',15,'On Leave' ,16, 'Discharged' , 17,'On Transit (outside hospital)',  18 ,'Discharge Approval' , 'NA' ) as Current_Status , TO_CHAR(HIPDT_ADMDATETIME,'dd-Mon-yyy hh\:mm')  as Adm_status_date, to_char(HIPDT_DISDATETIME,'dd-Mon-yyy hh\:mm') as dis_date FROM HIPT_PATADMDISC_DTL WHERE GNUM_ISVALID \= 1 AND GNUM_HOSPITAL_CODE \= ? AND HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ?

DUTY_ROSTER_SERVICE_GET_SHIFT_TYPE = SELECT distinct HGNUM_SHIFT_CODE, (SELECT  G.HRGSTR_SHIFT_DESC FROM AHIS.GBLT_SHIFT_MST G where G.GNUM_ISVALID \= 1 and G.GNUM_HOSPITAL_CODE \= ? and G.HGNUM_SHIFT_CODE \= A.HGNUM_SHIFT_CODE  ) as shift_name FROM AHIS.HGBT_UNITCONSULTANT_ROSTER_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= 1 and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK\t\t\t\t\t\t\t\t\t    

DUTY_ROSTER_SERVICE_GET_DEPARTMENT = SELECT distinct SUBSTR (HGNUM_DEPTUNITCODE, 1, 3) duc, (SELECT GSTR_DEPT_NAME FROM AHIS.GBLT_DEPARTMENT_MST a WHERE GNUM_ISVALID \= 1 AND GNUM_DEPT_CODE \= SUBSTR (HGNUM_DEPTUNITCODE, 1, 3)) dept_name FROM AHIS.HGBT_UNITCONSULTANT_ROSTER_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= 1 and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK Order BY dept_name
									 
DUTY_ROSTER_SERVICE_GET_DEPARTMENT_WITH_SHIFT = SELECT distinct SUBSTR (HGNUM_DEPTUNITCODE, 1, 3) duc, (SELECT GSTR_DEPT_NAME FROM AHIS.GBLT_DEPARTMENT_MST a WHERE GNUM_ISVALID \= 1 AND GNUM_DEPT_CODE \= SUBSTR (HGNUM_DEPTUNITCODE, 1, 3)) dept_name FROM AHIS.HGBT_UNITCONSULTANT_ROSTER_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= 1 and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK and HGNUM_SHIFT_CODE \= ? Order BY dept_name\t\t\t\t\t\t\t\t\t 

DUTY_ROSTER_SERVICE_GET_UNIT = SELECT distinct HGNUM_DEPTUNITCODE duc, (SELECT  H.HGSTR_UNITNAME FROM AHIS.HGBT_UNIT_MST H where H.GNUM_HOSPITAL_CODE \= ? and H.GNUM_ISVALID \= 1 and H.HGNUM_DEPTUNITCODE \= A.HGNUM_DEPTUNITCODE and H.HGNUM_DEPT_CODE \= SUBSTR (HGNUM_DEPTUNITCODE, 1, 3)) unit_name FROM AHIS.HGBT_UNITCONSULTANT_ROSTER_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? and GNUM_ISVALID \= 1 and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK and SUBSTR (HGNUM_DEPTUNITCODE, 1, 3) \= ?

DUTY_ROSTER_SERVICE_GET_ROOM = SELECT distinct A.HGNUM_ROOM_CODE duc, (SELECT H.HGSTR_ROOM_NAME FROM AHIS.HGBT_ROOM_MST H where H.GNUM_HOSPITAL_CODE \= ? and H.GNUM_ISVALID \= 1 and H.HGNUM_ROOM_CODE\=A.HGNUM_ROOM_CODE) as room_name FROM AHIS.HGBT_UNITCONSULTANT_ROSTER_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? and GNUM_ISVALID \= 1 and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK and SUBSTR (HGNUM_DEPTUNITCODE, 1, 3) \= ? and HGNUM_DEPTUNITCODE \= ? order by room_name

DUTY_ROSTER_SERVICE_GET_ROSTER = WITH data AS (  SELECT HGNUM_DEPTUNITCODE duc, DECODE (HOPNUM_WEEK_OF_MONTH, 1, '1st', 2, '2nd', 3, '3rd', 4, '4th', 5, '5th') wom, DECODE (HOPNUM_DAY_OF_WEEK, 1, '1Sun', 2, '2Mon', 3, '3Tue', 4, '4Wed', 5, '5Thu', 6, '6Fri', 7, '7Sat') dow, HGNUM_SHIFT_CODE sc, HGNUM_ROOM_CODE rc, listagg ( (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ')  || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH (TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_MIDDLE_NAME)))  || DECODE ( SIGN ( LENGTH (TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_LAST_NAME))),'-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.PSRSTR_EMP_NO), ',') WITHIN GROUP (ORDER BY PSRSTR_EMP_NO) emplist FROM HGBT_UNITCONSULTANT_ROSTER_MST A WHERE GNUM_ISVALID \= 1 and GNUM_HOSPITAL_CODE \= ? and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK --condition-- GROUP BY HGNUM_DEPTUNITCODE, HOPNUM_WEEK_OF_MONTH, HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_ROOM_CODE), data2 AS (  SELECT duc, emplist, dow, sc, rc, listagg (wom, ',') WITHIN GROUP (ORDER BY wom) womlist FROM data GROUP BY duc, emplist, dow, sc, rc), data3 AS (  SELECT duc, emplist, womlist, sc, rc, listagg (SUBSTR (dow, 2), ',') WITHIN GROUP (ORDER BY dow) dowlist FROM data2 GROUP BY duc, emplist, womlist, sc, rc) SELECT   SUBSTR (o.dept_hod_name, 1, (INSTR (o.dept_hod_name, '\#') - 1)) dept_name, (SELECT  G.HRGSTR_SHIFT_DESC FROM AHIS.GBLT_SHIFT_MST G where G.GNUM_ISVALID \= 1 and G.GNUM_HOSPITAL_CODE \= ? and G.HGNUM_SHIFT_CODE \= o.sc) as sc, o.opd_start_timing opd_start_time, o.opd_end_timing opd_end_time, o.rc, SUBSTR (o.unit_dtl, (INSTR (o.unit_dtl, '\#') + 1)) dept_category_name, SUBSTR (o.dept_hod_name, (INSTR (o.dept_hod_name, '\#') + 1)) dept_hod, o.emplist consultant_name,  o.work_days working_days, SUBSTR (o.loc_info, (INSTR (o.loc_info, '\#') + 1)) loc_info FROM (SELECT SUBSTR (duc, 1, 3) dept_id, b.sc as sc,   (SELECT H.HGSTR_ROOM_NAME FROM AHIS.HGBT_ROOM_MST H where H.GNUM_HOSPITAL_CODE \= ? and H.GNUM_ISVALID \= 1 and H.HGNUM_ROOM_CODE\=b.rc) as rc, (SELECT GSTR_DEPT_NAME || '\#' || (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH ( TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_MIDDLE_NAME))) || DECODE ( SIGN ( LENGTH ( TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_LAST_NAME))), '-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.GSTR_HOD_CODE) FROM GBLT_DEPARTMENT_MST a WHERE GNUM_ISVALID \= 1 AND GNUM_DEPT_CODE \= SUBSTR (duc, 1, 3)) dept_hod_name,  (SELECT    DECODE (HGNUM_ISGENERAL, 1, 1, 2) || '\#' || HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_DEPTUNITCODE \= b.duc) unit_dtl, emplist, (SELECT HOPSTR_START_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_start_timing, (SELECT HOPSTR_END_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_end_timing, (SELECT GNUM_LOCATION_CODE || '\#' || COALESCE (  (SELECT HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_LOCATION_CODE \= c.GNUM_LOCATION_CODE), HGSTR_ROOM_DESC) loc_desc FROM HGBT_ROOM_MST c WHERE GNUM_ISVALID \= 1 AND HGNUM_ROOM_CODE \= b.rc) loc_info, DECODE (womlist, '1st,2nd,3rd,4th,5th', 'All Week ', womlist || ' Week') || '(' || dowlist || ')' work_days FROM data3 b) o
				                 
DUTY_ROSTER_SERVICE_GET_DOC_AVAILABILITY_BY_NAME = WITH data AS (  SELECT HGNUM_DEPTUNITCODE duc, DECODE (HOPNUM_WEEK_OF_MONTH, 1, '1st', 2, '2nd', 3, '3rd', 4, '4th', 5, '5th') wom, DECODE (HOPNUM_DAY_OF_WEEK, 1, '1Sun', 2, '2Mon', 3, '3Tue', 4, '4Wed', 5, '5Thu', 6, '6Fri', 7, '7Sat') dow, HGNUM_SHIFT_CODE sc, HGNUM_ROOM_CODE rc, listagg ( (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ')  || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH (TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_MIDDLE_NAME)))  || DECODE ( SIGN ( LENGTH (TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_LAST_NAME))),'-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.PSRSTR_EMP_NO), ',') WITHIN GROUP (ORDER BY PSRSTR_EMP_NO) emplist FROM HGBT_UNITCONSULTANT_ROSTER_MST A WHERE GNUM_ISVALID \= 1 and GNUM_HOSPITAL_CODE \= ? GROUP BY HGNUM_DEPTUNITCODE, HOPNUM_WEEK_OF_MONTH, HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_ROOM_CODE), data2 AS (  SELECT duc, emplist, dow, sc, rc, listagg (wom, ',') WITHIN GROUP (ORDER BY wom) womlist FROM data GROUP BY duc, emplist, dow, sc, rc), data3 AS (  SELECT duc, emplist, womlist, sc, rc, listagg (SUBSTR (dow, 2), ',') WITHIN GROUP (ORDER BY dow) dowlist FROM data2 GROUP BY duc, emplist, womlist, sc, rc) SELECT   SUBSTR (o.dept_hod_name, 1, (INSTR (o.dept_hod_name, '\#') - 1)) dept_name, (SELECT  G.HRGSTR_SHIFT_DESC FROM AHIS.GBLT_SHIFT_MST G where G.GNUM_ISVALID \= 1 and G.GNUM_HOSPITAL_CODE \= ? and G.HGNUM_SHIFT_CODE \= o.sc) as sc, o.opd_start_timing opd_start_time, o.opd_end_timing opd_end_time, o.rc, SUBSTR (o.unit_dtl, (INSTR (o.unit_dtl, '\#') + 1)) dept_category_name, SUBSTR (o.dept_hod_name, (INSTR (o.dept_hod_name, '\#') + 1)) dept_hod, o.emplist consultant_name,  o.work_days working_days, SUBSTR (o.loc_info, (INSTR (o.loc_info, '\#') + 1)) loc_info FROM (SELECT SUBSTR (duc, 1, 3) dept_id, b.sc as sc,   (SELECT H.HGSTR_ROOM_NAME FROM AHIS.HGBT_ROOM_MST H where H.GNUM_HOSPITAL_CODE \= ? and H.GNUM_ISVALID \= 1 and H.HGNUM_ROOM_CODE\=b.rc) as rc, (SELECT GSTR_DEPT_NAME || '\#' || (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH ( TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_MIDDLE_NAME))) || DECODE ( SIGN ( LENGTH ( TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_LAST_NAME))), '-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.GSTR_HOD_CODE) FROM GBLT_DEPARTMENT_MST a WHERE GNUM_ISVALID \= 1 AND GNUM_DEPT_CODE \= SUBSTR (duc, 1, 3)) dept_hod_name,  (SELECT    DECODE (HGNUM_ISGENERAL, 1, 1, 2) || '\#' || HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_DEPTUNITCODE \= b.duc) unit_dtl, emplist, (SELECT HOPSTR_START_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_start_timing, (SELECT HOPSTR_END_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_end_timing, (SELECT GNUM_LOCATION_CODE || '\#' || COALESCE (  (SELECT HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_LOCATION_CODE \= c.GNUM_LOCATION_CODE), HGSTR_ROOM_DESC) loc_desc FROM HGBT_ROOM_MST c WHERE GNUM_ISVALID \= 1 AND HGNUM_ROOM_CODE \= b.rc) loc_info, DECODE (womlist, '1st,2nd,3rd,4th,5th', 'All Week ', womlist || ' Week') || '(' || dowlist || ')' work_days FROM data3 b) o where upper(o.emplist) like ?
				                 
DUTY_ROSTER_SERVICE_GET_DOC_AVAILABILITY_BY_NAME_DATE = WITH data AS (  SELECT HGNUM_DEPTUNITCODE duc, DECODE (HOPNUM_WEEK_OF_MONTH, 1, '1st', 2, '2nd', 3, '3rd', 4, '4th', 5, '5th') wom, DECODE (HOPNUM_DAY_OF_WEEK, 1, '1Sun', 2, '2Mon', 3, '3Tue', 4, '4Wed', 5, '5Thu', 6, '6Fri', 7, '7Sat') dow, HGNUM_SHIFT_CODE sc, HGNUM_ROOM_CODE rc, listagg ( (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ')  || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH (TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_MIDDLE_NAME)))  || DECODE ( SIGN ( LENGTH (TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP (STR_LAST_NAME))),'-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.PSRSTR_EMP_NO), ',') WITHIN GROUP (ORDER BY PSRSTR_EMP_NO) emplist FROM HGBT_UNITCONSULTANT_ROSTER_MST A WHERE GNUM_ISVALID \= 1 and GNUM_HOSPITAL_CODE \= ? and to_char(?,'w') \= HOPNUM_WEEK_OF_MONTH and to_char(?,'d') \= HOPNUM_DAY_OF_WEEK GROUP BY HGNUM_DEPTUNITCODE, HOPNUM_WEEK_OF_MONTH, HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_ROOM_CODE), data2 AS (  SELECT duc, emplist, dow, sc, rc, listagg (wom, ',') WITHIN GROUP (ORDER BY wom) womlist FROM data GROUP BY duc, emplist, dow, sc, rc), data3 AS (  SELECT duc, emplist, womlist, sc, rc, listagg (SUBSTR (dow, 2), ',') WITHIN GROUP (ORDER BY dow) dowlist FROM data2 GROUP BY duc, emplist, womlist, sc, rc) SELECT   SUBSTR (o.dept_hod_name, 1, (INSTR (o.dept_hod_name, '\#') - 1)) dept_name, (SELECT  G.HRGSTR_SHIFT_DESC FROM AHIS.GBLT_SHIFT_MST G where G.GNUM_ISVALID \= 1 and G.GNUM_HOSPITAL_CODE \= ? and G.HGNUM_SHIFT_CODE \= o.sc) as sc, o.opd_start_timing opd_start_time, o.opd_end_timing opd_end_time, o.rc, SUBSTR (o.unit_dtl, (INSTR (o.unit_dtl, '\#') + 1)) dept_category_name, SUBSTR (o.dept_hod_name, (INSTR (o.dept_hod_name, '\#') + 1)) dept_hod, o.emplist consultant_name,  o.work_days working_days, SUBSTR (o.loc_info, (INSTR (o.loc_info, '\#') + 1)) loc_info FROM (SELECT SUBSTR (duc, 1, 3) dept_id, b.sc as sc,   (SELECT H.HGSTR_ROOM_NAME FROM AHIS.HGBT_ROOM_MST H where H.GNUM_HOSPITAL_CODE \= ? and H.GNUM_ISVALID \= 1 and H.HGNUM_ROOM_CODE\=b.rc) as rc, (SELECT GSTR_DEPT_NAME || '\#' || (SELECT DECODE (GNUM_SALUTATION_ID, 1, 'Mr. ', 2, 'Ms. ', 3, 'Dr. ', 4, 'Prof. ', 5, 'Mrs. ', 6, 'Sh. ', 7, 'Smt. ') || NVL ( DECODE ( INSTR (INITCAP (STR_FIRST_NAME), 'Dr.'), 0, INITCAP (STR_FIRST_NAME), SUBSTR (INITCAP (STR_FIRST_NAME), 5)) || DECODE ( SIGN ( LENGTH ( TRIM (STR_MIDDLE_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_MIDDLE_NAME))) || DECODE ( SIGN ( LENGTH ( TRIM (STR_LAST_NAME)) - 0), 1, ' ' || TRIM ( INITCAP ( STR_LAST_NAME))), '-') FROM PIST_EMP_PERSONNEL_DTL WHERE GNUM_ISVALID \= 1 AND STR_EMP_NO \= A.GSTR_HOD_CODE) FROM GBLT_DEPARTMENT_MST a WHERE GNUM_ISVALID \= 1 AND GNUM_DEPT_CODE \= SUBSTR (duc, 1, 3)) dept_hod_name,  (SELECT    DECODE (HGNUM_ISGENERAL, 1, 1, 2) || '\#' || HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_DEPTUNITCODE \= b.duc) unit_dtl, emplist, (SELECT HOPSTR_START_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_start_timing, (SELECT HOPSTR_END_TIME FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_SHIFT_CODE \= b.sc) opd_end_timing, (SELECT GNUM_LOCATION_CODE || '\#' || COALESCE (  (SELECT HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST WHERE GNUM_ISVALID \= 1 AND HGNUM_LOCATION_CODE \= c.GNUM_LOCATION_CODE), HGSTR_ROOM_DESC) loc_desc FROM HGBT_ROOM_MST c WHERE GNUM_ISVALID \= 1 AND HGNUM_ROOM_CODE \= b.rc) loc_info, DECODE (womlist, '1st,2nd,3rd,4th,5th', 'All Week ', womlist || ' Week') || '(' || dowlist || ')' work_days FROM data3 b) o where upper(o.emplist) like ?

DISEASE_DOS_DONT_SERVICE_GET_DISEASE_LIST = select D.GNUM_DISEASE_CODE d_code, D.GSTR_DISEASE_NAME d_name from mhealth.MHRGT_DISEASES_DTL d where D.GNUM_ISVALID = 1

DISEASE_DOS_DONT_SERVICE_GET_DISEASE = select d_code, d_name from  (select rownum as rnum, D.GNUM_DISEASE_CODE d_code, D.GSTR_DISEASE_NAME d_name from mhealth.MHRGT_DISEASES_DTL d where D.GNUM_ISVALID = 1) where rnum=?

DISEASE_DOS_DONT_SERVICE_GET_DISEASE_DOS_DONT = select DOS.GNUM_IS_DOS, DOS.GNUM_DOS_DONT_CODE, DOS.GSTR_DOS_DONT from mhealth.MHRGT_DISEASE_DOS_DONT dos where DOS.GNUM_ISVALID = 1 and DOS.GNUM_DISEASE_CODE = ?


# Gender List
GENERAL.Gender_List.1 = select gstr_gender_code, gstr_gender_name from gblt_gender_mst where gnum_isvalid\=1

GENERAL.State_List.1 = select gnum_state_code, gstr_state_name from gblt_state_mst where gnum_isvalid\=1 and gstr_country_code\=? order by gstr_state_name

GENERAL.District_List.1 = select gnum_district_code, gstr_district_name from gblt_district_mst where gnum_isvalid\=1 and gnum_state_code\=? order by gstr_district_name

# Provisional Regstration
PROVISIONAL_REGISTRATION.Register.1 = \
INSERT INTO mhealth.mhrgt_mobreg_dtl(hrgstr_aadhaar_no, hrgnum_ppuk, hrgstr_fname, hrgstr_mname, hrgstr_lname, gstr_gender_code, hrgstr_father_name, hrgstr_momname, \
hrgstr_spousename, hrgstr_age, gnum_hospital_code, hrgstr_city, hrgnum_pincode, hrgstr_mobile_no, \
gnum_state_code, gnum_district_code, gstr_country_code, hrgstr_email_id, hrgnum_que_no, hrgstr_ip_add, hrgstr_imei, hospital_desc) \
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)


PROVISIONAL_REGISTRATION_NIMS.Register.1 = \
INSERT INTO ahiscl.hrgt_portal_regist_dtl(hrgstr_aadhaar_no, hrgnum_temp_reg_no, hrgstr_fname, hrgstr_mname, hrgstr_lname, gstr_gender_code, hrgstr_father_name, hrgstr_momname, \
hrgstr_spousename, gdt_entry_date, gnum_isvalid, hrgstr_age, gnum_hospital_code, hrgstr_city, hrgnum_pincode, hrgstr_mobile_no, \
gnum_state_code, gnum_district_code, gstr_country_code, hrgstr_email_id, gnum_department_code,gnum_reg_flag) \
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,1)


PROVISIONAL_REGISTRATION.Max_CR_No.1 = SELECT max(hrgnum_ppuk) FROM MHEALTH.MHRGT_MOBREG_DTL where gnum_hospital_code \= ? and hospital_desc \= ?

PROVISIONAL_REGISTRATION.New_CR_No.1 = select decode(substr(to_char(sysdate,'dd-mm-yyyy'),9,2), substr(?,1,2), decode(substr(to_char(sysdate,'dd-mm-yyyy'),4,2), substr(?,3,2), substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(coalesce(substr(?, 5,5)\:\:numeric,0)+1 ,5,0), substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1,5,0)), substr(to_char(sysdate,'DD-MM-YYYY'),9,2) ||substr(to_char(sysdate,'DD-MM-YYYY'),4,2) ||lpad(1,5,0)) from dual 

PROVISIONAL_REGISTRATION.New_Queue_No.1 = SELECT nvl(max(M.HRGNUM_QUE_NO), 0) + 1 FROM MHEALTH.MHRGT_MOBREG_DTL M where to_char(M.GDT_ENTRY_DATE,'dd-mm-yyyy') \= to_char(sysdate,'dd-mm-yyyy') and gnum_hospital_code \= ? and hospital_desc \= ?




SPECIAL_CLINIC_APPOINTMENT_GET_CR_DETAILS = select hrgnum_puk as crno, hrgstr_fname as firstName, hrgstr_mname as middleName, hrgstr_lname as lastName, hrgstr_age as age, hrgstr_father_name as fatherName from hrgt_patient_dtl where gnum_isvalid\=1 and gnum_hospital_code\=? and hrgnum_puk\=?


SPECIAL_CLINIC_APPOINTMENT_GET_DEPARTMENTS = SELECT dept.gstr_dept_name ,unit.hgnum_deptunitcode, unit.hgstr_unitname FROM ahiscl.hgbt_unit_mst AS unit , ahiscl.hapt_para_schedule_mst as sch, ahiscl.hapt_actual_para_map_mst as para, ahiscl.gblt_department_mst as dept WHERE sch.hapnum_actual_para_refid \= para.hapnum_actual_para_refid AND para.hapstr_actual_para_id_1 \= unit.hgnum_deptunitcode AND unit.gnum_hospital_code \= sch.gnum_hospital_code AND unit.gnum_hospital_code \= para.gnum_hospital_code AND unit.gnum_hospital_code \= dept.gnum_hospital_code AND unit.gnum_dept_code \= dept.gnum_dept_code AND unit.gnum_isvalid \= sch.gnum_isvalid  AND sch.hapnum_weekofmonth \= ? AND sch.hotnum_day_of_week \= ? AND unit.gnum_hospital_code \= ? AND unit.gnum_isvalid \= 1 AND unit.hgnum_deptunitcode not in (11214,11213) GROUP BY unit.hgstr_unitname,unit.hgnum_deptunitcode,dept.gstr_dept_name ORDER BY dept.gstr_dept_name ASC 



SPECIAL_CLINIC_APPOINTMENT_GET_SLOT = SELECT dept.gstr_dept_name ,unit.hgnum_deptunitcode, unit.hgstr_unitname,sch.hapdat_shift_start_time, sch.hapdat_shift_end_time,sch.hapnum_shift_id FROM ahiscl.hgbt_unit_mst AS unit , ahiscl.hapt_para_schedule_mst as sch, ahiscl.hapt_actual_para_map_mst as para, ahiscl.gblt_department_mst as dept WHERE sch.hapnum_actual_para_refid \= para.hapnum_actual_para_refid AND para.hapstr_actual_para_id_1 \= unit.hgnum_deptunitcode AND unit.gnum_hospital_code \= sch.gnum_hospital_code AND unit.gnum_hospital_code \= para.gnum_hospital_code AND unit.gnum_hospital_code \= dept.gnum_hospital_code AND unit.gnum_dept_code \= dept.gnum_dept_code AND unit.gnum_isvalid \= sch.gnum_isvalid  AND unit.hgnum_deptunitcode not in (11214) AND unit.hgnum_deptunitcode not in (11213) AND sch.hapnum_weekofmonth \= ? AND sch.hotnum_day_of_week \= ? AND unit.gnum_hospital_code \= ? AND unit.gnum_isvalid \= 1 AND unit.hgnum_deptunitcode \= ? GROUP BY unit.hgstr_unitname,unit.hgnum_deptunitcode,dept.gstr_dept_name,4,5,sch.hapnum_shift_id ORDER BY dept.gstr_dept_name ASC 




SPECIAL_CLINIC_APPOINTMENT_DATES = \
SELECT current_date + s.a AS dates \
FROM generate_series(1, 30, 1) AS s(a);


SPECIAL_CLINIC_SLOT_DURATION = SELECT  max(hapstr_slot_time) as slot FROM hapt_appointment_dtl where gnum_hospital_code \= ? and TRUNC(hapdt_appointment_date) \= ?

SPECIAL_CLINIC_FIRST_SLOT_DURATION = SELECT hapstr_slot_duration_time FROM ahiscl.hapt_actual_para_map_mst WHERE hapstr_actual_para_id_1 \= ?


SPECIAL_CLINIC_GET_APPOINTMENT_NUMBER = select nvl(to_char(max(hapnum_apt_no)),to_char((?||to_char(sysdate,'yy')||to_char(sysdate,'mm')||'000000')))+1 as appointmentno from hapt_appointment_dtl where hapnum_apt_no in (select nvl(to_char(max(hapnum_apt_no)),(?||to_char(sysdate,'yy')||to_char(sysdate,'mm')||'000000')) from hapt_appointment_dtl where gnum_hospital_code\=? and substr(to_char(hapnum_apt_no),LENGTH(?)+1,4)\=(to_char(sysdate,'yy')||to_char(sysdate,'mm')))

SPECIAL_CLINIC_SAVE_APPOINTMENT = \
insert into hapt_appointment_dtl (hapnum_apt_id, hapnum_apt_no, gnum_hospital_code, hrgnum_puk, \
hapstr_pat_first_name, hapstr_pat_last_name, hapstr_patient_fname, gstr_gender_code, \
hapdt_appointment_date, hapstr_email, hapstr_mobile_no, \
hapstr_actual_para_id_1, hapdt_entry_date, gnum_isvalid, \
hapstr_slot_time, hapnum_apt_status, hapnum_slot_type, hapnum_appt_type_id, \
hapstr_patage, hapstr_spousename, hapnum_shift_id, hapstr_slot_start_time, hapstr_slot_end_time, hapstr_slot_duration, hapnum_actual_para_refid) \
VALUES (1,?,?,?,?,?,?,?,?,?,?,?,sysdate,1,?,1,1,1,?,?,?,?,?,?,?)







AADHAAR_SERVICE.State_Mapping.1 = select m.gnum_state_code || '\#\#' || s.gstr_state_name from mhealth.gblt_aadhaar_state_map m, ahiscl.gblt_state_mst s where m.gnum_aadhaar_state_code\=? and m.gnum_isvalid \= 1 and m.gnum_state_code\=s.gnum_state_code

AADHAAR_SERVICE.Gender_Mapping.1 = select gstr_gender_name from ahiscl.gblt_gender_mst where gstr_gender_code\=? and gnum_isvalid\=1

AADHAAR_SERVICE.Duplicate_Aadhaar_Registeration.1 = SELECT case when (count(*) >\= nvl((select config_value from mhealth.configuration_sys where config_name\='MAX_AADHAAR_REG'), 1)) then 1 else 0 end FROM MHEALTH.MHRGT_MOBREG_DTL M where hrgstr_aadhaar_no \= ? and to_char(M.GDT_ENTRY_DATE,'dd-mm-yyyy') \= to_char(sysdate,'dd-mm-yyyy') and gnum_hospital_code \= ? and hospital_desc \= ?

GET_DEPARTMENT_FROM_USERNAME = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM ahis.GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE IN(SELECT UNIQUE(SUBSTR(HGNUM_DEPTUNITCODE,1,3))FROM GBLT_USER_DESKMENU_MST WHERE GNUM_USERSEAT_ID IN(SELECT GNUM_USERID FROM GBLT_USER_MST WHERE GSTR_USER_NAME\=? AND GNUM_ISVALID\=1)AND GNUM_ISVALID\=1) AND GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE) AND GNUM_ISVALID\=1AND GNUM_HOSPITAL_CODE\=? AND GNUM_DEPT_TYPE\= 1 ORDER BY GSTR_DEPT_NAME


# NIMS
# User Login
LOGIN_SERVICE.User_Detail.1 = select gstr_usr_name, gstr_password, psrstr_emp_no,gnum_user_seatid  from ahiscl.gblt_user_mst where gstr_user_name\=? and gdt_effect_date <\= sysdate and gdt_expiry_date > sysdate and gnum_isvalid\=1 and gnum_hospital_code\=?

DEPARTMENT_SERVICE.User_wise_department.1 = SELECT d.GNUM_DEPT_CODE, d.GSTR_DEPT_NAME FROM ahiscl.GBLT_DEPARTMENT_MST d WHERE d.GNUM_ISVALID \= 1 AND d.GNUM_HOSPITAL_CODE \= ? AND d.GNUM_DEPT_TYPE \= 1 and exists (select 1 from ahiscl.GBLT_ROLE_SEAT_TABLE_DTL q, ahiscl.gblt_metatable_column_mst p where p.gnum_metatable_id \= q.gnum_metatable_id and d.GNUM_HOSPITAL_CODE \= q.GNUM_HOSPITAL_CODE and q.gbl_isvalid\=1 and p.gbl_isvalid\=1 and upper(p.gstr_table_name)\='GBLT_DEPARTMENT_MST' and upper(p.gstr_column_name) \= 'GNUM_DEPT_CODE' and q.gnum_seatid\=(select u.gnum_user_seatid from ahiscl.gblt_user_mst u where u.gstr_user_name\=? and u.gnum_isvalid\=1 and u.gnum_hospital_code\=d.GNUM_HOSPITAL_CODE)) order by d.GSTR_DEPT_NAME

DEPARTMENT_SERVICE.Unit_List_User_Wise.1 = SELECT u.hgnum_deptunitcode, d.GSTR_DEPT_NAME || ' (' || u.hgstr_unitname || ')' FROM ahiscl.HGBT_UNIT_MST u, ahiscl.GBLT_DEPARTMENT_MST d WHERE d.gnum_dept_code \= u.gnum_dept_code and d.GNUM_ISVALID \= 1 AND d.GNUM_HOSPITAL_CODE \= ? AND d.GNUM_DEPT_TYPE \= 1 and HGNUM_DEPTUNITCODE in (select gnum_column_value from ahiscl.GBLT_ROLE_SEAT_TABLE_DTL q, ahiscl.gblt_metatable_column_mst p where p.gnum_metatable_id \= q.gnum_metatable_id and d.GNUM_HOSPITAL_CODE \= q.GNUM_HOSPITAL_CODE and q.gbl_isvalid\=1 and p.gbl_isvalid\=1 and upper(p.gstr_table_name)\='HGBT_UNIT_MST' and upper(p.gstr_column_name) \= 'HGNUM_DEPTUNITCODE' and q.gnum_seatid\=(select u.gnum_user_seatid from ahiscl.gblt_user_mst u where u.gstr_user_name\=? and u.gnum_isvalid\=1)) order by d.GSTR_DEPT_NAME

# User Login
# NIMS

# Hospital Name List
GLOBAL_SERVICE.Hospital_List.1 = select gnum_hospital_code, gstr_hospital_name from ahiscl.gblt_hospital_mst where gnum_isvalid\=1

# Old query
# GLOBAL_SERVICE.Hospital_List.1 = \
# select hospital_code, hospital_name from mhealth.hospital_list where isvalid=1

# Hospital Name List


# RAOL Patient Investigation Report
RAOL.DOCTOR_DESK_SERVICE_GET_INVEST_PDF = SELECT investigationpatientdetails.getpdfreportingfile (requisitiontypecode,patcrno,requisitiondno,nvl(hwmd.hivtnum_multisession_id,0),hospitalcode) as PdfFtpUrl FROM ( SELECT HRH.HRGNUM_PUK, HRD.HIVNUM_WORKORDER_NO, hrh.hivnum_req_no as requisitionno, hrd.hivtnum_req_dno AS requisitiondno,hrd.HIVTNUM_ASSO_TO_WORK_ORDR as associatedToWorkOrder,hrd.hgnum_sample_code as samplecode ,hrd.hgnum_group_code AS groupcode,SUBSTR (hrd.hivtnum_req_dno, 1, 3) as hospitalCode, hrh.hgnum_visitno AS patvisitno, hrd.hgnum_samplegroup_code AS samplegroupcode, hrd.gbnum_priority_code AS prioritycode,SUBSTR (hrd.gnum_lab_test_code, 1, 5) AS laboratorycode, SUBSTR (hrd.gnum_lab_test_code, 6, 4) AS testcode,hrh.hbnum_requisition_type AS requisitiontypecode, DECODE (hrh.hbnum_requisition_type, 1, hrh.hrgnum_puk,2, hrh.hrgnum_puk,'''') AS patcrno, hrd.hivtnum_res_val_seatid AS resultvalidatedby, hrd.GBNUM_STATUS_CODE as testStatusCode FROM hivt_requisition_dtl hrd,hivt_requisition_header hrh WHERE hrh.hivnum_req_no \= SUBSTR (hrd.hivtnum_req_dno, 1, 18)  and HRD.GBNUM_STATUS_CODE in (9, 16, 17, 18)  AND HRH.HRGNUM_PUK\=? AND HRD.HIVNUM_WORKORDER_NO \= ? ) view1 LEFT OUTER JOIN hivt_wrkdr_multisession_dtl hwmd ON view1.requisitiondno \= hwmd.hivtnum_req_dno AND hwmd.hivtnum_status_code IN(9, 10, 11, 19)



# Investigation Report

#GET_REPORT_DETAIL_INVESTIGATION = Select c.gstr_test_name as testName,hivtnum_req_dno,hivdt_report_date from hivt_requisition_dtl as a,hivt_test_mst as c    where   a.gnum_test_code\=c.gnum_test_code and   hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?)     and (to_char(hivt_entry_date,'dd-Mon-yyyy')) in (SELECT TO_CHAR( MAX(gdt_entry_date) , 'dd-Mon-yyyy') from hrgt_episode_dtl a WHERE a.gnum_isvalid \= 1 AND a.gnum_hospital_code \= ? AND a.hrgnum_puk \= ?) and gnum_hospital_code \= ? order by c.gstr_test_name
#GET_REPORT_DETAIL_INVESTIGATION = Select c.gstr_test_name as testName,hivtnum_req_dno,hivdt_report_date from hivt_requisition_dtl as a, hivt_test_mst as c    where   a.gnum_test_code\=c.gnum_test_code and   hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?  order by hivdt_entry_date DESC limit 7)  and a.hivnum_reqdtl_status IN (14,26) and gnum_hospital_code \= ? order by c.gstr_test_name
GET_REPORT_DETAIL_INVESTIGATION = Select c.gstr_test_name as testName,hivtnum_req_dno,hivdt_report_date from hivt_requisition_dtl as a,  hivt_test_mst as c    where   a.gnum_test_code\=c.gnum_test_code and   hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header  where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?  order by hivdt_entry_date)  and a.hivnum_reqdtl_status IN (14,26) and gnum_hospital_code \= ? order by c.gstr_test_name,hivdt_report_date DESC limit 7


#GET_INVESTIGATION_DATA=Select hivtnum_test_code as testCode,c.gstr_test_name as testName,hivnum_parameter_code as parameterCode, b.hgstr_parameter as parameterName,hivtstr_value as value, hivstr_ref_range as standardRange from hivt_parameter_dtl as a,hivt_parameter_mst as b,hivt_test_mst as c where a.hivnum_parameter_code = b.hgnum_parameter_id and a.hivtnum_test_code=c.gnum_test_code  and hivtnum_req_dno in (Select hivtnum_req_dno from hivt_requisition_dtl   where       hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid=1 and gnum_hospital_code = ? and hrgnum_puk = ?)     and (to_char(hivt_entry_date,'dd-Mon-yyyy')) in (SELECT TO_CHAR( MAX(gdt_entry_date) , 'dd-Mon-yyyy') from hrgt_episode_dtl a WHERE a.gnum_isvalid = 1 AND a.gnum_hospital_code =? AND a.hrgnum_puk = ?) and gnum_hospital_code= ?)  order by hivtnum_test_code
GET_INVESTIGATION_DATA=Select hivtnum_test_code as testCode,c.gstr_test_name as testName,hivnum_parameter_code as parameterCode, b.hgstr_parameter as parameterName,hivtstr_value as value, hivstr_ref_range as standardRange,(to_char(hivt_entry_date,'dd-Mon-yyyy')) as entryDate  from hivt_parameter_dtl as a,hivt_parameter_mst as b,hivt_test_mst as c where a.hivnum_parameter_code = b.hgnum_parameter_id and a.hivtnum_test_code=c.gnum_test_code  and hivtnum_req_dno in (Select hivtnum_req_dno from hivt_requisition_dtl   where   hivnum_reqdtl_status >= 7 and  hivnum_req_no in (Select hivnum_req_no from hivt_requisition_header where gnum_isvalid=1 and gnum_hospital_code = ? and hrgnum_puk = ? order by hivdt_entry_date DESC ) limit 7)  order by hivtnum_test_code,(to_char(hivt_entry_date,'dd-Mon-yyyy')),hivnum_parameter_code


SELECT_FILENAME_FOR_REPORT_WEBSERVICE=select hivstr_report_url from hivt_requisition_dtl where hivtnum_req_dno=? and gnum_hospital_code=?

GLOBAL_SERVICE.Hospital_Name_From_Code = select gstr_hospital_name from ahiscl.gblt_hospital_mst where gnum_hospital_code\=? and gnum_isvalid\=1
PROVISIONAL_REGISTRATION_NIMS.Register.2 = \
INSERT INTO ahiscl.gccst_pat_provisional_reg_dtl(hrgstr_national_id, gnum_provisional_regno, hrgstr_fname, hrgstr_mname, hrgstr_lname, gstr_gender_code, hrgstr_father_name, hrgstr_momname, \
hrgstr_spousename, gdt_entry_date, gnum_isvalid, hrgstr_age, gnum_hospital_code, hrgstr_city, hrgnum_pincode, hrgstr_mobile_no, \
gnum_state_code, gnum_district_code, gstr_country_name, hrgstr_email_id, hgnum_deptunitcode, gnum_dept_code, hrgnum_reg_mode) \
VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,3)


GLOBAL_SERVICE.Check_date=select hrgnum_provisional_regno from ahiscl.gccst_max_provisional_regno where to_char(GDT_ENTRY_DATE,'dd-mm-yyyy') = to_char(sysdate,'dd-mm-yyyy') 
GLOBAL_SERVICE.insert_into_gccst_max_provisional_regno=UPDATE gccst_max_provisional_regno SET hrgnum_provisional_regno = ?,GDT_ENTRY_DATE=sysdate() where to_char(GDT_ENTRY_DATE,'dd-mm-yyyy') != to_char(sysdate,'dd-mm-yyyy')
GLOBAL_SERVICE.update_gccst_max_provisional_regno=UPDATE gccst_max_provisional_regno SET hrgnum_provisional_regno \= hrgnum_provisional_regno + 1 where to_char(GDT_ENTRY_DATE,'dd-mm-yyyy') \= to_char(sysdate,'dd-mm-yyyy') 




# RAOL Patient Investigation Report

GET_DEPARTMENT_LIST_FOR_OPDROSTER_NEW = Select distinct gnum_dept_code, gstr_dept_name FROM hopt_dept_unit_roster_dtl a WHERE  gnum_isvalid \= 1  AND gnum_hospital_code \= ? order by gstr_dept_name
                                          # AND trunc(hopdt_start_dt) >\= trunc(SYSDATE) AND trunc(hopdt_end_dt)<\= trunc(SYSDATE) 

#OPD_ROSTER_SERVICE_GET_ROSTER_DEPTWISE = Select distinct gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name, to_char(hopdt_start_dt, 'D') as dt,extract (dow from hopdt_start_dt) as dayy, TO_CHAR(hopdt_start_dt, 'hh12:mi AM') ||' - ' || TO_CHAR(hopdt_end_dt, 'hh12:mi AM') as shifttime,hgnum_roster_type  FROM hopt_dept_unit_roster_dtl where gnum_isvalid=1 and gnum_hospital_code = ?  and trunc(hopdt_start_dt) >=to_date(?,'DD-Mon-YYYY')  and trunc(hopdt_end_dt) <=to_date(?,'DD-Mon-YYYY') --condition--


OPD_ROSTER_SERVICE_GET_ROSTER_DEPTWISE = select gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name,string_agg(dt, ', ') as unitDays,shifttime,decode(hgnum_roster_type,'1','General','2','Special','3','Casuality'),consultants, locations FROM (Select	distinct gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name , to_char(hopdt_start_dt, 'DY') as dt,extract (dow from hopdt_start_dt) as dayy,	TO_CHAR(hopdt_start_dt, 'hh12:mi AM') || ' - ' || TO_CHAR(hopdt_end_dt, 'hh12:mi AM') as shifttime,hgnum_roster_type,hopstr_consultants as consultants, (SELECT distinct L.HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST L WHERE GNUM_ISVALID = 1 and gnum_hospital_code = g.gnum_hospital_code and L.HGNUM_LOCATION_CODE =(select distinct HGNUM_LOCATION_CODE from hgbt_unit_mst where hgnum_deptunitcode=hopnum_deptunitcode and gnum_isvalid=1 and gnum_hospital_code = g.gnum_hospital_code ) ) as locations FROM hopt_dept_unit_roster_dtl g  where g.gnum_isvalid=1  and g.gnum_hospital_code = ? --condition--  and to_char(trunc(hopdt_start_dt),'Mon')=to_char(trunc(sysdate),'Mon') order by gnum_dept_code,hopnum_deptunitcode,hgnum_room_code,dayy)	group by gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name,shifttime,hgnum_roster_type,consultants,locations order by gnum_dept_code,hopnum_deptunitcode,unitDays   


PATIENT_LOGIN_USING_MOBILENO = select a.hrgnum_puk as crno, hrgstr_mobile_no as mobileNumber, hrgstr_fname||' '||hrgstr_lname as patName ,NVL((select count(b.hblnum_pataccount_no) from hblt_pataccount_dtl b where a.hrgnum_puk\=b.hrgnum_puk and a.hrgstr_mobile_no\=b.hblnum_mob_no),0) as iswalletaccountexists from hrgt_patient_dtl a where a.gnum_isvalid\=1 and a.gnum_hospital_code\=? and hrgstr_mobile_no\=?
PATIENT_LOGIN_USING_CRNO = select a.hrgnum_puk as crno, hrgstr_mobile_no as mobileNumber, hrgstr_fname||' '||hrgstr_lname as patName ,NVL((select count(b.hblnum_pataccount_no) from hblt_pataccount_dtl b where a.hrgnum_puk\=b.hrgnum_puk and a.hrgstr_mobile_no\=b.hblnum_mob_no),0) as iswalletaccountexists from hrgt_patient_dtl a where a.gnum_isvalid\=1 and a.gnum_hospital_code\=? and hrgnum_puk\=?



# CONSULTANT ENQUIRY SERVICE START

CONSULTANT_ENQUIRY = select gnum_dept_code ,gstr_dept_name ,hopnum_deptunitcode ,hgstr_unitname, hgnum_room_code, hgstr_room_name\:\:character varying ,hopstr_opd_name\:\:character varying ,string_agg(dt, ', ')\:\:character varying as unitDays, shifttime\:\:character varying ,decode(hgnum_roster_type,'1','General','2','Special','3','Casuality')\:\:character varying as roster from (Select distinct gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name , to_char(hopdt_start_dt, 'DY') as dt,extract (dow from hopdt_start_dt) as dayy, TO_CHAR(hopdt_start_dt, 'hh12\:mi AM') || ' - ' || TO_CHAR(hopdt_end_dt, 'hh12\:mi AM') as shifttime,hgnum_roster_type FROM hopt_dept_unit_roster_dtl where gnum_isvalid\=1 and gnum_hospital_code \= ? and trunc(hopdt_start_dt) >\=to_date(?,'DD-Mon-YYYY') and trunc(hopdt_end_dt) <\=to_date(?,'DD-Mon-YYYY') and hgnum_roster_type in ('1','2')--condition-- order by gnum_dept_code,hopnum_deptunitcode,hgnum_room_code,dayy  ) group by gnum_dept_code,gstr_dept_name,hopnum_deptunitcode,hgstr_unitname,hgnum_room_code,hgstr_room_name,hopstr_opd_name,shifttime,hgnum_roster_type order by gnum_dept_code,hopnum_deptunitcode 
# CONSULTANT_ENQUIRY SERVICE END
# TARIFF_QUERY START
TARIFF_ENQUIRY = SELECT PATCAT AS "PATIENT CATEGORY", CHARGETYPE ||' ' ||IPDCHARGETYPE AS "CHARGE TYPE", TARIFFNAME, TARIFFSERVICEID, CHARGE "CHARGE IN RS." FROM( SELECT (SELECT HBLSTR_TARIFF_NAME FROM HBLT_TARIFF_MST WHERE HBLNUM_TARIFF_ID \= A.HBLNUM_TARIFF_ID LIMIT 1) TARIFFNAME, (SELECT SBLNUM_SERVICE_ID FROM HBLT_TARIFF_MST WHERE HBLNUM_TARIFF_ID \= A.HBLNUM_TARIFF_ID LIMIT 1) TARIFFSERVICEID, (SELECT SBLSTR_CHARGETYPE_NAME FROM SBLT_CHARGETYPE_MST WHERE SBLNUM_CHARGETYPE_ID \= A.SBLNUM_CHARGETYPE_ID AND GNUM_ISVALID \= A.GNUM_ISVALID LIMIT 1) CHARGETYPE, HBLNUM_COST\:\:CHARACTER VARYING CHARGE, (SELECT    GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE \= A.GNUM_PATIENT_CAT_CODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= A.GNUM_ISVALID AND TRUNC (GDT_EFFECTIVE_FRM) <\= TRUNC (SYSDATE) AND TRUNC (NVL (GDT_EFFECTIVE_TO, SYSDATE)) >\= TRUNC (SYSDATE) LIMIT 1) PATCAT, SBLNUM_IPD_CHARGETYPE_ID IPDCHARGETYPEID, (SELECT SBLSTR_IPD_CHARGETYPE_NAME FROM SBLT_IPD_CHARGETYPE_MST WHERE SBLNUM_IPD_CHARGETYPE_ID \= A.SBLNUM_IPD_CHARGETYPE_ID AND GNUM_ISVALID \= A.GNUM_ISVALID AND TRUNC (GDT_EFFECTIVE_FRM) <\= TRUNC (SYSDATE) LIMIT 1) IPDCHARGETYPE, DECODE (SBLNUM_CHARGETYPE_ID || '|' || SBLNUM_IPD_CHARGETYPE_ID, '1|0', 0, '2|1', 1, '2|2', 2, 3) INDEXID FROM HBLT_CHARGE_MST A WHERE GNUM_HOSPITAL_CODE \= ?   AND GNUM_ISVALID \= 1 UNION SELECT (SELECT HBLSTR_TARIFF_NAME FROM HBLT_TARIFF_MST WHERE HBLNUM_TARIFF_ID \= A.HBLNUM_TARIFF_ID LIMIT 1) TARIFFNAME, (SELECT SBLNUM_SERVICE_ID FROM HBLT_TARIFF_MST WHERE HBLNUM_TARIFF_ID \= A.HBLNUM_TARIFF_ID LIMIT 1) TARIFFSERVICEID, 'IPD' CHARGETYPE, DECODE(TO_NUMBER(BILL_MST.GETCHARGEDETAILS(9\:\:NUMERIC,GNUM_HOSPITAL_CODE\:\:NUMERIC,1\:\:NUMERIC,A.GNUM_PATIENT_CAT_CODE\:\:NUMERIC,2\:\:NUMERIC,HBLNUM_TARIFF_ID,GDT_EFFECTIVE_FRM\:\:CHARACTER VARYING)),0,HBLNUM_COST, TO_NUMBER(BILL_MST.GETCHARGEDETAILS(9\:\:NUMERIC,GNUM_HOSPITAL_CODE,1\:\:NUMERIC,A.GNUM_PATIENT_CAT_CODE,2\:\:NUMERIC,HBLNUM_TARIFF_ID,GDT_EFFECTIVE_FRM\:\:CHARACTER VARYING)))\:\:CHARACTER VARYING AS CHARGE, (SELECT    GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE \= A.GNUM_PATIENT_CAT_CODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= A.GNUM_ISVALID AND TRUNC (GDT_EFFECTIVE_FRM) <\= TRUNC (SYSDATE) AND TRUNC (NVL (GDT_EFFECTIVE_TO, SYSDATE)) >\= TRUNC (SYSDATE) LIMIT 1) PATCAT, 1 IPDCHARGETYPEID, 'GENERAL' IPDCHARGETYPE, DECODE ('2|1' , '1|0', 0, '2|1', 1, '2|2', 2, 3) INDEXID FROM HBLT_CHARGE_MST A WHERE GNUM_HOSPITAL_CODE \= ?    AND GNUM_ISVALID \= 1 AND SBLNUM_CHARGETYPE_ID\=1 AND SBLNUM_IPD_CHARGETYPE_ID\=0 AND TRUNC (GDT_EFFECTIVE_FRM) <\= TRUNC (SYSDATE) AND TRUNC (NVL (GDT_EFFECTIVE_TO, SYSDATE)) >\= TRUNC (SYSDATE) union SELECT HBLSTR_TARIFF_NAME TARIFFNAME,SBLNUM_SERVICE_ID TARIFFSERVICEID,'ALL' CHARGETYPE,NVL(ROUND(MAX(HSTNUM_SALEPRICE)),0)\:\:CHARACTER VARYING CHARGE, 'ALL' PATCAT,1,'ALL' IPDCHARGETYPE,0 INDEXID FROM HSTT_DRUG_CURRSTOCK_DTL A,HBLT_TARIFF_MST B WHERE A.GNUM_HOSPITAL_CODE \= ?   AND A.GNUM_ISVALID \= 1 AND HBLNUM_TARIFF_ID \= A.HSTNUM_ITEMBRAND_ID AND B.GNUM_HOSPITAL_CODE \= ? AND B.GNUM_ISVALID \= 1 GROUP BY HBLSTR_TARIFF_NAME,A.HSTNUM_ITEMBRAND_ID,SBLNUM_SERVICE_ID )  WHERE CHARGE<>0 ORDER BY 1,3,2
# TARIFF_QUERY_END