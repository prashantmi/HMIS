INSERT.HRGT_DAILY_PATIENT_DTL_NEW_REGISTRATION =   INSERT INTO HRGT_DAILY_PATIENT_DTL(hrgnum_puk,hrgnum_visit_no, \
								  hgnum_patient_cat_code, hgnum_treatment_cat_code,hrgstr_prev_puk, hrgnum_id_no, \
								  hrgdt_dob, hrgnum_is_mlc,hrgnum_is_actual_dob, hrgnum_is_old, hrgstr_fname, \
								  hrgstr_mname,hrgstr_lname, gnum_gender_code, gnum_marital_status_code, \
								  gnum_religion_code, hgnum_pat_status_code, hrgstr_father_name,hrgstr_momname, \
								  gnum_reg_cat_code,hrgdt_register_date, gnum_dept_code,hgnum_deptunitcode, \
								  hrgnum_que_no, hrgnum_isunknown,hrgnum_month_income, hrgnum_amt_collected, \
								  hrgnum_is_urban,hrgnum_is_ref, hrgnum_ext_hospital_code,hrgstr_ext_hosp_doct_name, \
								  HRGNUM_IS_LOCAL, hrgstr_house_no,gnum_city_loc_code, hrgstr_district, NUM_DIST_ID, hrgstr_city, \
								  gnum_statecode,HRGSTR_STATE_NAME, gnum_countrycode, hrgnum_pin,hrgnum_episode_code, \
								  hrgnum_episode_type_code,hrgdt_episode_date, gnum_isvalid, hrgnum_patient_allowed,\
								  hgnum_room_code, gdt_entry_date, hrgstr_ip_add,hrgstr_contact_no, hrgstr_ext_hospital_name, \
								  hrgnum_add_type_code, hrgstr_city_location, gnum_seat_id,gnum_nationality_code, \
								  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dep, hrgnum_ext_hospital_dept_unit,HRGSTR_SPOUSENAME, \
								  hrgstr_national_id, HRGSTR_PAT_OCCUPATION ,HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME, \
								  HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_FILE_NO,HRGSTR_IDMARK1,HRGSTR_IDMARK2,HRGNUM_ISREG_FREE,HRGNUM_IS_BROUGHTDEAD,HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE) \
								  VALUES (?, ?,?,?,?,?, TO_DATE (?, 'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,\
								  ?,?,?,?,?,NVL (TO_DATE (?, 'dd/mm/yyyy hh24:mi:ss'), SYSDATE), ?,?, ?,?,? , ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,\
								  ?,?,SYSDATE,?,?,?, SYSDATE, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd-MM-yyyy'))
								  
INSERT.HRGT_DAILY_PATIENT_DTL =   INSERT INTO HRGT_DAILY_PATIENT_DTL(hrgnum_puk,hrgnum_visit_no, \
								  hgnum_patient_cat_code, hgnum_treatment_cat_code,hrgstr_prev_puk, hrgnum_id_no, \
								  hrgdt_dob, hrgnum_is_mlc,hrgnum_is_actual_dob, hrgnum_is_old, hrgstr_fname, \
								  hrgstr_mname,hrgstr_lname, gnum_gender_code, gnum_marital_status_code, \
								  gnum_religion_code, hgnum_pat_status_code, hrgstr_father_name,hrgstr_momname, \
								  gnum_reg_cat_code,hrgdt_register_date, gnum_dept_code,hgnum_deptunitcode, \
								  hrgnum_que_no, hrgnum_isunknown,hrgnum_month_income, hrgnum_amt_collected, \
								  hrgnum_is_urban,hrgnum_is_ref, hrgnum_ext_hospital_code,hrgstr_ext_hosp_doct_name, \
								  HRGNUM_IS_LOCAL, hrgstr_house_no,gnum_city_loc_code, hrgstr_district, NUM_DIST_ID, hrgstr_city, \
								  gnum_statecode,HRGSTR_STATE_NAME, gnum_countrycode, hrgnum_pin,hrgnum_episode_code, \
								  hrgnum_episode_type_code,hrgdt_episode_date, gnum_isvalid, hrgnum_patient_allowed,\
								  hgnum_room_code, gdt_entry_date, hrgstr_ip_add,hrgstr_contact_no, hrgstr_ext_hospital_name, \
								  hrgnum_add_type_code, hrgstr_city_location, gnum_seat_id,gnum_nationality_code, \
								  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dep, hrgnum_ext_hospital_dept_unit,HRGSTR_SPOUSENAME, \
								  hrgstr_national_id, HRGSTR_PAT_OCCUPATION ,HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME, \
								  HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_FILE_NO,HRGSTR_IDMARK1,HRGSTR_IDMARK2,HRGNUM_ISREG_FREE,HRGNUM_IS_BROUGHTDEAD,HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE) \
								  VALUES (?,?,?,?,?,?, TO_DATE (?, 'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,\
								  ?,?,?,?,?,NVL (TO_DATE (?, 'dd-Mon-yyyy hh24:mi:ss'), SYSDATE), ?,?, ?,?,? , ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,\
								  ?,?,SYSDATE,?,?,?, SYSDATE, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,coalesce(TO_DATE (?, 'dd-Mon-yyyy'),null))
								  
INSERT.HRGT_DAILY_PATIENT_DTL_SL_NO_REMOVED300ct09 =   INSERT INTO HRGT_DAILY_PATIENT_DTL(hrgnum_puk, hrgnum_s_no,hrgnum_visit_no, \
								  hgnum_patient_cat_code, hgnum_treatment_cat_code,hrgstr_prev_puk, hrgnum_id_no, \
								  hrgdt_dob, hrgnum_is_mlc,hrgnum_is_actual_dob, hrgnum_is_old, hrgstr_fname, \
								  hrgstr_mname,hrgstr_lname, gnum_gender_code, gnum_marital_status_code, \
								  gnum_religion_code, hgnum_pat_status_code, hrgstr_father_name,hrgstr_momname, \
								  gnum_reg_cat_code,hrgdt_register_date, gnum_dept_code,hgnum_deptunitcode, \
								  hrgnum_que_no, hrgnum_isunknown,hrgnum_month_income, hrgnum_amt_collected, \
								  hrgnum_is_urban,hrgnum_is_ref, hrgnum_ext_hospital_code,hrgstr_ext_hosp_doct_name, \
								  HRGNUM_IS_LOCAL, hrgstr_house_no,gnum_city_loc_code, hrgstr_district, NUM_DIST_ID, hrgstr_city, \
								  gnum_statecode,HRGSTR_STATE_NAME, gnum_countrycode, hrgnum_pin,hrgnum_episode_code, \
								  hrgnum_episode_type_code,hrgdt_episode_date, gnum_isvalid, hrgnum_patient_allowed,\
								  hgnum_room_code, gdt_entry_date, hrgstr_ip_add,hrgstr_contact_no, hrgstr_ext_hospital_name, \
								  hrgnum_add_type_code, hrgstr_city_location, gnum_seat_id,gnum_nationality_code, \
								  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dep, hrgnum_ext_hospital_dept_unit,HRGSTR_SPOUSENAME, \
								  hrgstr_national_id, HRGSTR_PAT_OCCUPATION ,HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME,HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_FILE_NO,HRGSTR_IDMARK1,HRGSTR_IDMARK2,HRGNUM_ISREG_FREE,HRGNUM_IS_BROUGHTDEAD) \
								  VALUES (?, (SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM HRGT_DAILY_PATIENT_DTL \
								  WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND hrgnum_visit_no = (SELECT NVL (MAX (hrgnum_visit_no), 0) + 1 \
								  FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND gnum_hospital_code = ?) \
								  AND GNUM_HOSPITAL_CODE=?),(SELECT NVL (MAX (hrgnum_visit_no), 0) + 1  FROM HRGT_EPISODE_DTL \
								  WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND GNUM_HOSPITAL_CODE=?),?,?,?,?, TO_DATE (?, 'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,\
								  ?,?,?,?,?,NVL (TO_DATE (?, 'dd/mm/yyyy hh24:mi:ss'), SYSDATE), ?,?, ?,?,? , ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,\
								  ?,?,SYSDATE,?,?,?, SYSDATE, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)



INSERT.HRGT_DAILY_PATIENT_DTL_1Jan09 =   INSERT INTO HRGT_DAILY_PATIENT_DTL(hrgnum_puk, hrgnum_s_no,hrgnum_visit_no, \
								  hgnum_patient_cat_code, hgnum_treatment_cat_code,hrgstr_prev_puk, hrgnum_id_no, \
								  hrgdt_dob, hrgnum_is_mlc,hrgnum_is_actual_dob, hrgnum_is_old, hrgstr_fname, \
								  hrgstr_mname,hrgstr_lname, gnum_gender_code, gnum_marital_status_code, \
								  gnum_religion_code, hgnum_pat_status_code, hrgstr_father_name,hrgstr_momname, \
								  gnum_reg_cat_code,hrgdt_register_date, gnum_dept_code,hgnum_deptunitcode, \
								  hrgnum_que_no, hrgnum_isunknown,hrgnum_month_income, hrgnum_amt_collected, \
								  hrgnum_is_urban,hrgnum_is_ref, hrgnum_ext_hospital_code,hrgstr_ext_hosp_doct_name, \
								  HRGNUM_IS_LOCAL, hrgstr_house_no,gnum_city_loc_code, hrgstr_district, NUM_DIST_ID, hrgstr_city, \
								  gnum_statecode,HRGSTR_STATE_NAME, gnum_countrycode, hrgnum_pin,hrgnum_episode_code, \
								  hrgnum_episode_type_code,hrgdt_episode_date, gnum_isvalid, hrgnum_patient_allowed,\
								  hgnum_room_code, gdt_entry_date, hrgstr_ip_add,hrgstr_contact_no, hrgstr_ext_hospital_name, \
								  hrgnum_add_type_code, hrgstr_city_location, gnum_seat_id,gnum_nationality_code, \
								  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dep, hrgnum_ext_hospital_dept_unit,HRGSTR_SPOUSENAME, \
								  hrgstr_national_id, HRGSTR_PAT_OCCUPATION ,HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME,HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_FILE_NO,HRGSTR_IDMARK1,HRGSTR_IDMARK2,HRGNUM_ISREG_FREE,HRGNUM_IS_BROUGHTDEAD) \
								  VALUES (?, (SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM HRGT_DAILY_PATIENT_DTL \
								  WHERE hrgnum_puk = ? AND GNUM_HOSPITAL_CODE=?), \
								  ahis_reg.EpisodeNewVisitNo(?,?,?),?,?,?,?, TO_DATE (?, 'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,\
								  ?,?,?,?,?,NVL (TO_DATE (?, 'dd/mm/yyyy hh24:mi:ss'), SYSDATE), ?,?, ?,?,? , ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,\
								  ?,?,SYSDATE,?,?,?, SYSDATE, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

SELECT.HRGT_DAILY_PATIENT_DTL.RETRIEVE_BY_CRNO= SELECT hgnum_treatment_cat_code AS patSecondaryCatCode ,hrgstr_prev_puk \
												AS prevCrNo,hrgnum_id_no AS patIdNo,hrgdt_dob AS patDOB,HRGNUM_IS_MLC AS isMLC,\
												hrgnum_is_actual_dob AS isActualDob, hrgnum_is_old AS patIsOld, \
												hrgstr_fname AS patFirstName,hrgstr_mname AS patMiddleName, hrgstr_lname AS patLastName,\
												gnum_gender_code AS patGenderCode, gnum_marital_status_code AS patMaritalStatusCode,\
												gnum_religion_code AS patReligionCode, hgnum_pat_status_code AS patStatusCode, \
												hrgstr_father_name AS patGuardianName,hrgstr_momname AS patMotherName, \
												gnum_reg_cat_code AS patRegCatCode, hrgdt_register_date AS registerDate,\
												gnum_dept_code AS departmentCode,hgnum_deptunitcode AS departmentUnitCode, \
												hrgnum_que_no AS queNo, hrgnum_isunknown AS isUnknown,hrgnum_month_income AS patMonthlyIncome,\
												hrgnum_amt_collected AS patAmountCollected, hrgnum_is_urban AS patIsUrban,\
												hrgnum_is_ref AS isReferred, hrgnum_ext_hospital_code AS patRefGnctdHospitalCode, \
												hrgstr_ext_hosp_doct_name AS patRefDoctor,HRGNUM_IS_LOCAL AS isAddressDelhi, \
												hrgstr_house_no AS patAddHNo, gnum_city_loc_code AS patAddCityLocCode, \
												hrgstr_district AS patAddDistrict,NUM_DIST_ID as patAddDistrictCode,hrgstr_city AS patAddCity, \
												gnum_statecode AS patAddStateCode,HRGSTR_STATE_NAME AS patAddStateName, gnum_countrycode AS patAddCountryCode, \
												hrgnum_pin AS patAddPIN,hrgnum_episode_code AS episodeCode, \
												hrgnum_episode_type_code AS episodeTypeCode, hrgdt_episode_date AS episodeDate,\
												gnum_isvalid AS isValid, hrgnum_patient_allowed AS patientAllowed, \
												hgnum_room_code AS roomCode, gdt_entry_date AS entryDate,hrgstr_ip_add AS systemIPAddress, \
												hrgstr_contact_no AS patAddContactNo, hrgstr_ext_hospital_name AS patRefHospitalName,\
												hrgnum_add_type_code as isCurrentAddress, hgnum_patient_cat_code as patPrimaryCatCode, hrgstr_city_location as pataddcityloc,gnum_seat_id AS seatId,\
												gnum_nationality_code AS patNationalityCode, hrgnum_ext_hospital_crno AS patRefGnctdHospitalCrno,\
												hrgnum_ext_hospital_dep AS patRefGnctdHospitalDept,HRGSTR_IDMARK1 as patIdMark1,HRGSTR_IDMARK2 as patIdMark2,HRGNUM_ISREG_FREE as isFree, \
												hrgnum_ext_hospital_dept_unit AS patRefGnctdHospitalDeptUnit, HRGSTR_SPOUSENAME AS patHusbandName,\
												hrgstr_national_id AS patNationalId, HBNUM_BLDGRP_CODE AS patBloodGroup,HRGNUM_VISIT_NO as episodeVisitNo, \
												hrgnum_isnewborn AS isNewBorn,hrgnum_mother_puk AS patMotherCrNo, HRGSTR_PAT_OCCUPATION as patOccupation,HRGSTR_FAT_OCCUPATION as patFatherOccupation,HRGSTR_HUS_OCCUPATION as patHusbandOccupation,HRGSTR_NICKNAME as patNickName,HRGSTR_CARD_NO as patCardNo FROM HRGT_DAILY_PATIENT_DTL \
												WHERE hrgnum_puk = ? AND  GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE=?
											
INSERT.HRGT_PATIENT_DTL=	INSERT INTO HRGT_PATIENT_DTL (HRGNUM_PUK, HRGSTR_PREV_PUK, HRGDT_DOB, HRGBL_IS_ACTUAL_DOB, HRGSTR_FNAME, HRGSTR_MNAME, HRGSTR_LNAME, GNUM_GENDER_CODE, \
								GNUM_MARITAL_STATUS_CODE, HGNUM_PAT_STATUS_CODE, HRGSTR_IDMARK1, HRGSTR_FATHER_NAME, HRGSTR_MOMNAME, HRGNUM_REG_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGDT_REGISTER_DATE, \
								GDT_ENTRY_DATE, GNUM_SEAT_ID, HRGNUM_IS_MLC, GNUM_ISVALID, HRGNUM_ISUNKNOWN, HRGNUM_MONTH_INCOME, HRGNUM_IS_URBAN, HRGNUM_ISREG_FREE, GNUM_DESIG_SEMESTER, \
								HRGNUM_DEPT_STAFF_STUD, HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGNUM_ID_NO, HRGNUM_IS_REF, GNUM_RELIGION_CODE, HRGSTR_AGE, GNUM_NATIONALITY_CODE, HRGNUM_IS_IMAGEUPLOADED, \
								HRGSTR_SPOUSENAME, HRGSTR_NATIONAL_ID, HBNUM_BLDGRP_CODE, HRGNUM_ISNEWBORN, HRGNUM_MOTHER_PUK,HRGSTR_PAT_OCCUPATION ,HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME,HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_IDMARK2,HRGNUM_IS_BROUGHTDEAD,HDSNUM_DISASTER_ID) \
								VALUES (?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
								
INSERT.HRGT_PATIENT_DTL_MONTH=	INSERT INTO HRGT_PATIENT_DTL (HRGNUM_PUK, HRGSTR_PREV_PUK, HRGDT_DOB, HRGBL_IS_ACTUAL_DOB, HRGSTR_FNAME, HRGSTR_MNAME, HRGSTR_LNAME, GNUM_GENDER_CODE, \
								GNUM_MARITAL_STATUS_CODE, HGNUM_PAT_STATUS_CODE, HRGSTR_IDMARK1, HRGSTR_FATHER_NAME, HRGSTR_MOMNAME, HRGNUM_REG_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGDT_REGISTER_DATE, \
								GDT_ENTRY_DATE, GNUM_SEAT_ID, HRGNUM_IS_MLC, GNUM_ISVALID, HRGNUM_ISUNKNOWN, HRGNUM_MONTH_INCOME, HRGNUM_IS_URBAN, HRGNUM_ISREG_FREE, GNUM_DESIG_SEMESTER, \
								HRGNUM_DEPT_STAFF_STUD, HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGNUM_ID_NO, HRGNUM_IS_REF, GNUM_RELIGION_CODE, HRGSTR_AGE, GNUM_NATIONALITY_CODE, HRGNUM_IS_IMAGEUPLOADED, \
								HRGSTR_SPOUSENAME, HRGSTR_NATIONAL_ID, HBNUM_BLDGRP_CODE, HRGNUM_ISNEWBORN, HRGNUM_MOTHER_PUK,HRGDT_EXP_DATE,GNUM_HOSPITAL_CODE,HRGSTR_IDMARK2,HRGNUM_IS_BROUGHTDEAD,HDSNUM_DISASTER_ID) \
								VALUES (?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')),?,?,?,?)
								
INSERT.HRGT_PATIENT_DTL_DAY=	INSERT INTO HRGT_PATIENT_DTL (HRGNUM_PUK, HRGSTR_PREV_PUK, HRGDT_DOB, HRGBL_IS_ACTUAL_DOB, HRGSTR_FNAME, HRGSTR_MNAME, HRGSTR_LNAME, GNUM_GENDER_CODE, \
								GNUM_MARITAL_STATUS_CODE, HGNUM_PAT_STATUS_CODE, HRGSTR_IDMARK1, HRGSTR_FATHER_NAME, HRGSTR_MOMNAME, HRGNUM_REG_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGDT_REGISTER_DATE, \
								GDT_ENTRY_DATE, GNUM_SEAT_ID, HRGNUM_IS_MLC, GNUM_ISVALID, HRGNUM_ISUNKNOWN, HRGNUM_MONTH_INCOME, HRGNUM_IS_URBAN, HRGNUM_ISREG_FREE, GNUM_DESIG_SEMESTER, \
								HRGNUM_DEPT_STAFF_STUD, HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGNUM_ID_NO, HRGNUM_IS_REF, GNUM_RELIGION_CODE, HRGSTR_AGE, GNUM_NATIONALITY_CODE, HRGNUM_IS_IMAGEUPLOADED, \
								HRGSTR_SPOUSENAME, HRGSTR_NATIONAL_ID, HBNUM_BLDGRP_CODE, HRGNUM_ISNEWBORN, HRGNUM_MOTHER_PUK,HRGDT_EXP_DATE,GNUM_HOSPITAL_CODE,HRGSTR_IDMARK2,HRGNUM_IS_BROUGHTDEAD,HDSNUM_DISASTER_ID) \
								VALUES (?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,trunc(SYSDATE+?),?,?,?,?)



SELECT.VISIT.BY.DATE.HRGT_EPISODE_DTL=SELECT HRGNUM_PUK as patCrNo,HRGNUM_EPISODE_CODE as episodeCode,HRGNUM_VISIT_NO as episodeVisitNo,TO_CHAR(HRGDT_EPISODE_DATE,'dd-Mon-yyyy') as episodeDate ,HRGNUM_EPISODE_TYPE_CODE as episodeTypeCode, \
										HRGNUM_VISIT_TYPE as episodeVisitTypeCode,HRGNUM_IS_EPISODE_OPEN as episodeIsOpen ,(SELECT count(*)   FROM hrgt_yellowslip_entry_dtl where hrgnum_puk=a.hrgnum_puk and hrgnum_episode_code =a.hrgnum_episode_code and \
										hrgnum_visit_no=a.hrgnum_visit_no and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=a.gnum_isvalid) ifExists  FROM hrgt_episode_dtl a WHERE hrgnum_puk = ? AND hgnum_deptunitcode = ?  AND TRUNC (hrgdt_episode_date) = TO_DATE (?, 'dd-Mon-yyyy') and gnum_hospital_code=?

Update.DIAGNOSISDETAILS.HRGT_EPISODE_DTL=UPDATE HRGT_EPISODE_DTL SET  HRGSTR_COMPLAINED_DTL= ?,HRGNUM_IS_EPISODE_OPEN=?,HRGDT_NEXT_VISIT_DATE=?, \
										 HGNUM_NEXT_VISIT_DEPTUNITCODE=?, PSRSTR_EMP_NO=?, PSRSTR_EMP_NAME=? WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?
										 
										 
SELECT.OPD_VISIT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO=SELECT INITCAP(A.HRGSTR_FNAME) AS patFirstName, INITCAP(A.HRGSTR_MNAME) AS patMiddleName, INITCAP(A.HRGSTR_LNAME) AS patLastName, \
													INITCAP(A.HRGSTR_FATHER_NAME) AS patGuardianName, A.HRGSTR_AGE AS patAge, \
													(SELECT INITCAP(B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) patGender, \
													(SELECT INITCAP(C.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST C WHERE C.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) patCat \
													FROM HRGT_PATIENT_DTL A WHERE (A.HRGNUM_PUK = ?)

#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'DD-MON-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
											A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
											A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
											TO_CHAR(a.HRGDT_EXP_DATE,'dd-Mon-yyyy') as EXPIRYDATE, TO_CHAR(a.hrgdt_register_date,'dd-Mon-yyyy') AS REGISTERDATE, \
											to_char(a.gdt_entry_date,'dd-Mon-yyyy hh12:mi:ss AM') AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
											A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, \
											A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, \
											(SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code \
           									AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = ? )	AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
											A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO,\
											A.HRGNUM_IS_REF AS ISREFERRED,A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, ahis_util.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, \
											A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, \
											A.HRGSTR_FATHER_NAME AS PATFATHERNAME, A.HRGSTR_MOMNAME AS PATMOTHERNAME, INITCAP(A.HRGSTR_SPOUSENAME) AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
											 A.HRGSTR_PAT_OCCUPATION as patOccupation,A.HRGSTR_FAT_OCCUPATION as patFatherOccupation,A.HRGSTR_HUS_OCCUPATION as patHusbandOccupation,A.HRGSTR_NICKNAME as patNickName,A.HRGSTR_CARD_NO as patCardNo, \
											(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATGENDER, \
											(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATMARITALSTATUS, \
											sysdate AS systemdate, \
											(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND \
											GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE) AND I.GNUM_HOSPITAL_CODE=? ) PATPRIMARYCAT, \
											(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE AND M.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATRELIGION, \
											(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE AND T.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATNATIONALITY, \
											DECODE (SIGN (TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY') - TO_DATE (SYSDATE, 'DD-MM-YYYY') ),1, 0,-1, 1,0) regRenewalRequired, \
											(SELECT '(Invalid Category) '||INITCAP (gstr_patient_cat_name)  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code and rownum=1) PATOLDPRIMARYCAT,HRGNUM_IS_BROUGHTDEAD as isBroughtDead \
											FROM HRGT_PATIENT_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?)	AND (A.GNUM_HOSPITAL_CODE = ?) 
											
 
UPDATE.HRGT_PATIENT_DTL=	UPDATE HRGT_PATIENT_DTL SET  HRGSTR_PREV_PUK=?, HRGDT_DOB=?, HRGBL_IS_ACTUAL_DOB=?, HRGSTR_FNAME=?, \
						 	HRGSTR_MNAME=?, HRGSTR_LNAME=?, GNUM_GENDER_CODE=?, GNUM_MARITAL_STATUS_CODE=?, HRGSTR_IDMARK1=?, \
						 	HRGSTR_FATHER_NAME=?, HRGSTR_MOMNAME=?, HRGNUM_REG_CAT_CODE=?, HGNUM_PATIENT_CAT_CODE=?, \
						 	HRGNUM_IS_MLC=?, GNUM_ISVALID=?, HRGNUM_ISUNKNOWN=?, HRGNUM_MONTH_INCOME=?, HRGNUM_IS_URBAN=?, HRGNUM_ISREG_FREE=?, \
						 	GNUM_DESIG_SEMESTER=?, HRGNUM_DEPT_STAFF_STUD=?, HRGSTR_IP_ADD=?, HRGSTR_CONTACT_NO=?, HRGNUM_ID_NO=?, HRGNUM_IS_REF=?, \
						 	GNUM_RELIGION_CODE=?, HRGSTR_AGE=?, GNUM_NATIONALITY_CODE=?, HRGNUM_IS_IMAGEUPLOADED=?, HRGSTR_SPOUSENAME=?, \
						 	HRGSTR_NATIONAL_ID=?, HBNUM_BLDGRP_CODE=?, HRGNUM_ISNEWBORN=?, HRGNUM_MOTHER_PUK=?,HRGSTR_PAT_OCCUPATION=? ,\
						 	HRGSTR_FAT_OCCUPATION=?,HRGSTR_HUS_OCCUPATION=?,HRGSTR_NICKNAME=?,HRGSTR_CARD_NO=?,HRGSTR_IDMARK2 =? ,HRGNUM_VERIFICATION_SLNO = ? ,\
						 	HRGNUM_IS_BROUGHTDEAD=?,HGNUM_PAT_STATUS_CODE=? WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?  
									
UPDATE.WITHOUT_AGE.HRGT_PATIENT_DTL =	UPDATE HRGT_PATIENT_DTL SET  HRGSTR_PREV_PUK=?, HRGBL_IS_ACTUAL_DOB=?, HRGSTR_FNAME=?, \
						 	HRGSTR_MNAME=?, HRGSTR_LNAME=?, GNUM_GENDER_CODE=?, GNUM_MARITAL_STATUS_CODE=?, HRGSTR_IDMARK1=?, \
						 	HRGSTR_FATHER_NAME=?, HRGSTR_MOMNAME=?, HRGNUM_REG_CAT_CODE=?, HGNUM_PATIENT_CAT_CODE=?, \
						 	HRGNUM_IS_MLC=?, GNUM_ISVALID=?, HRGNUM_ISUNKNOWN=?, HRGNUM_MONTH_INCOME=?, HRGNUM_IS_URBAN=?, HRGNUM_ISREG_FREE=?, \
						 	GNUM_DESIG_SEMESTER=?, HRGNUM_DEPT_STAFF_STUD=?, HRGSTR_IP_ADD=?, HRGSTR_CONTACT_NO=?, HRGNUM_ID_NO=?, HRGNUM_IS_REF=?, \
						 	GNUM_RELIGION_CODE=?, GNUM_NATIONALITY_CODE=?, HRGNUM_IS_IMAGEUPLOADED=?, HRGSTR_SPOUSENAME=?, \
						 	HRGSTR_NATIONAL_ID=?, HBNUM_BLDGRP_CODE=?, HRGNUM_ISNEWBORN=?, HRGNUM_MOTHER_PUK=?,HRGSTR_PAT_OCCUPATION=? ,\
						 	HRGSTR_FAT_OCCUPATION=?,HRGSTR_HUS_OCCUPATION=?,HRGSTR_NICKNAME=?,HRGSTR_CARD_NO=?,HRGSTR_IDMARK2 =? ,\
						 	HRGNUM_VERIFICATION_SLNO = ?,HRGNUM_IS_BROUGHTDEAD=?, HGNUM_PAT_STATUS_CODE=? WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?  
									
TIMESTAMP.HRGT_PATIENT_DTL=		SELECT (SYSDATE - GDT_ENTRY_DATE)*24*60 FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK = ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=?


SELECT.HRGT_PATIENT_DTL.CR_NO=	SELECT HRGNUM_PUK AS PATCRNO FROM HRGT_PATIENT_DTL WHERE ((SYSDATE - GDT_ENTRY_DATE) * 24 * 60) < ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=?


#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.CR_NO1_15-jul-09=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
									INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
									A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
									A.HRGSTR_IDMARK1 AS PATIDMARK,A.HRGSTR_IDMARK2 AS PATIDMARK2,INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
									A.HRGDT_REGISTER_DATE AS REGISTERDATE, \
									A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
									A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, \
									A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
									A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
									A.HRGNUM_IS_REF AS ISREFERRED, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, A.HRGSTR_AGE AS PATAGE, \
									A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, \
									(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATGENDER, \
									(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATMARITALSTATUS, \
									(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND I.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND 	I.GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(I.GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) PATPRIMARYCAT, \
									(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE AND M.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATRELIGION, \
									(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE AND T.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATNATIONALITY \
									FROM HRGT_PATIENT_DTL A WHERE ((SYSDATE - GDT_ENTRY_DATE) * 24 * 60) < ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? \
									AND ((SELECT DISTINCT N.HRGNUM_VISIT_TYPE FROM HRGT_EPISODE_DTL N WHERE N.HRGNUM_PUK = A.HRGNUM_PUK AND N.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND ((SYSDATE - A.GDT_ENTRY_DATE) * 24 * 60) < ? \
									AND A.GNUM_SEAT_ID = ? AND A.GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE=?) = ? ) AND HRGNUM_ISUNKNOWN=?

#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.CR_NO1=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
									INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
									A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
									A.HRGSTR_IDMARK1 AS PATIDMARK,A.HRGSTR_IDMARK2 AS PATIDMARK2,INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
									A.HRGDT_REGISTER_DATE AS REGISTERDATE, \
									A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
									A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, \
									A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
									A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
									A.HRGNUM_IS_REF AS ISREFERRED, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, A.HRGSTR_AGE AS PATAGE, \
									A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, \
									(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATGENDER, \
									(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATMARITALSTATUS, \
									(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND I.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND 	I.GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(I.GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) PATPRIMARYCAT, \
									(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE AND M.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATRELIGION, \
									(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE AND T.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) PATNATIONALITY \
									FROM HRGT_PATIENT_DTL A WHERE ((SYSDATE - GDT_ENTRY_DATE) * 24 * 60) < ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? \
									AND a.hrgnum_puk in (SELECT DISTINCT n.hrgnum_puk FROM hrgt_episode_dtl n WHERE n.hrgnum_puk = a.hrgnum_puk and n.HRGNUM_IS_OLD=0 \
									AND n.gnum_hospital_code = a.gnum_hospital_code AND n.gnum_isvalid = a.gnum_isvalid and n.hrgnum_visit_type=? ) AND hrgnum_isunknown = ?
									
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_NAME1=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
											A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE  AS PATSTATUSCODE, \
											A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
											A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, A.HRGDT_REGISTER_DATE AS REGISTERDATE,\
											A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
											A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, \
											A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
											A.HRGNUM_ID_NO AS PATIDNO, A.HRGNUM_IS_REF AS ISREFERRED, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE,  ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, \
											A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, A.HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
											A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP, A.HRGNUM_ISNEWBORN AS ISNEWBORN, A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO,\
											(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
											(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
											(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE) PATREGCAT, \
											(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
											(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATPRIMARYCAT, \
											(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
											(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
											FROM HRGT_PATIENT_DTL A WHERE (A.HRGSTR_FNAME like ?) AND (A.GNUM_ISVALID = ?)	


SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_NAME=	SELECT A.HRGNUM_PUK AS PATCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
											A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
											A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
											ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
											A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP,A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO FROM HRGT_PATIENT_DTL A WHERE (UPPER(A.HRGSTR_FNAME) like UPPER(?)) AND (A.GNUM_ISVALID = ?)	


SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_NATIONALID=	SELECT A.HRGNUM_PUK AS PATCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
												A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
												ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
												A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP,A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO FROM HRGT_PATIENT_DTL A WHERE (UPPER(A.HRGSTR_NATIONAL_ID) like UPPER(?)) AND (A.GNUM_ISVALID = ?)	
												
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_EMPLOYEEID=	SELECT A.HRGNUM_PUK AS PATCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
												A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
												ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
												A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP,A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO FROM HRGT_PATIENT_DTL A WHERE (UPPER(A.HRGNUM_ID_NO) like UPPER(?)) AND (A.GNUM_ISVALID = ?)

SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_NATIONALID1=SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE  AS PATSTATUSCODE, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
												A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, A.HRGDT_REGISTER_DATE AS REGISTERDATE,\
												A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
												A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, \
												A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
												A.HRGNUM_ID_NO AS PATIDNO, A.HRGNUM_IS_REF AS ISREFERRED, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE,  ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, \
												A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, A.HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
												A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP, A.HRGNUM_ISNEWBORN AS ISNEWBORN, A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO,\
												(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
												(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
												(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE) PATREGCAT, \
												(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND \
												GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) PATPRIMARYCAT, \
												(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
												(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
												FROM HRGT_PATIENT_DTL A WHERE (A.HRGSTR_NATIONAL_ID like ?) AND (A.GNUM_ISVALID = ?)	


SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CONTACT_NUMBER=	SELECT A.HRGNUM_PUK AS PATCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
												A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO, \
												ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
												A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP,A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO FROM HRGT_PATIENT_DTL A WHERE (UPPER(A.HRGSTR_CONTACT_NO) like UPPER(?)) AND (A.GNUM_ISVALID = ?)	
				
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CONTACT_NUMBER1=SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
													INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
													A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE  AS PATSTATUSCODE, \
													A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, \
													A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, A.HRGDT_REGISTER_DATE AS REGISTERDATE,\
													A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
													A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, \
													A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
													A.HRGNUM_ID_NO AS PATIDNO, A.HRGNUM_IS_REF AS ISREFERRED, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE,  ahis_util.puk_age_on(a.hrgnum_puk,SYSDATE) AS PATAGE, \
													A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, A.HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, A.HRGSTR_SPOUSENAME AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
													A.HBNUM_BLDGRP_CODE AS PATBLOODGROUP, A.HRGNUM_ISNEWBORN AS ISNEWBORN, A.HRGNUM_MOTHER_PUK AS PATMOTHERCRNO,\
													(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
													(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
													(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE) PATREGCAT, \
													(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
													(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATPRIMARYCAT, \
													(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
													(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
													FROM HRGT_PATIENT_DTL A WHERE (A.HRGSTR_CONTACT_NO like ?) AND (A.GNUM_ISVALID = ?)	
				

													
INSERT.HRGT_EPISODE_DTL24jun09=  	  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT ) \
								VALUES (?,?,(select NVL(MAX(HRGNUM_VISIT_NO), 0)+1 from  HRGT_EPISODE_DTL where HRGNUM_EPISODE_CODE = ? AND HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
								?,?,?,?,?,?,?,?,?,sysdate,TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE (?, 'dd-MM-YYYY'),?,?,?)
		
				
INSERT.HRGT_EPISODE_DTL=  	  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT,hrgdt_treatmentcat_validupto, HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE) \
								VALUES (?,?,?, \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE (?, 'dd-MM-YYYY'),?,?,?,?,?,?,to_date(?,'dd-MM-yyyy'))
		
INSERT.HRGT_EPISODE_DTL_NEW_REGISTRATION=  	  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT,HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE ) \
								VALUES (?,?,?, \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE (?, 'dd-MM-YYYY'),?,?,?,?,?,to_date(?,'dd-MM-yyyy'))
								
	
INSERT.HRGT_EPISODE_DTL_MONTH=  INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT ,HDSNUM_DISASTER_ID) \
								VALUES (?,?,(select NVL(MAX(HRGNUM_VISIT_NO), 0)+1 from  HRGT_EPISODE_DTL where HRGNUM_EPISODE_CODE = ? AND HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')),?,?,?,?)
	
INSERT.HRGT_EPISODE_DTL_MONTH_NEW_REGISTRATION=  INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								 HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT ,HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE) \
								VALUES (?,?,?, \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,\
								ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')),?,?,?,?,?,to_date(?,'dd-MM-yyyy'))
	
	
INSERT.HRGT_EPISODE_DTL_MONTH1-jan-09=  INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT ) \
								VALUES (?,?,ahis_reg.EpisodeNewVisitNo(?,?,?), \
								?,?,?,?,?,?,?,?,?,sysdate,TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')),?,?,?)
								
								
							
INSERT.HRGT_EPISODE_DTL_DAY=  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT,HDSNUM_DISASTER_ID ) \
								VALUES (?,?,(select NVL(MAX(HRGNUM_VISIT_NO), 0)+1 from  HRGT_EPISODE_DTL where HRGNUM_EPISODE_CODE = ? AND HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,trunc(SYSDATE+?),?,?,?,?)
	
INSERT.HRGT_EPISODE_DTL_DAY_NEW_REGISTRATION=  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, \
								HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT,HDSNUM_DISASTER_ID,HRGSTR_DEPTUNIT_OLDPUK,HRGDT_DEPTUNIT_OLDREGDATE ) \
								VALUES (?,?,?, \
								?,?,?,?,?,?,?,?,?,trunc(sysdate),TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,trunc(SYSDATE+?),?,?,?,?,?,to_date(?,'dd-MM-yyyy'))
									
							
INSERT.HRGT_EPISODE_DTL_DAY1-jan-09=  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, \
								HRGNUM_ADMISSION_NO, HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_OLD, HRGDT_EPISODE_DATE, \
								HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, \
								HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE, GDT_REFERRAL_ACCEPTANCE_DATE, HGNUM_TREATMENT_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGNUM_IS_REF,HRGSTR_FILE_NO,HRGDT_EXP_DATE,HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE,HRGNUM_ISCARDPRINT ) \
								VALUES (?,?,ahis_reg.EpisodeNewVisitNo(?,?,?), \
								?,?,?,?,?,?,?,?,?,sysdate,TO_CHAR(SYSDATE, 'hh24:mi'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,trunc(SYSDATE+?),?,?,?)
										
INSERT.HRGT_DATATYPE_TEST=      INSERT INTO HRGT_DATATYPE_TEST (NUM,STR,FLG,DTE,GNUM_HOSPITAL_CODE) VALUES (?,?,?,nvl(to_date(?,'dd-MON-YYYY'),sysdate,?))
                           
                           
INSERT.HRGT_PATIENT_ADD_DTL=    INSERT INTO HRGT_PATIENT_ADD_DTL \
								(HRGNUM_PUK, HRGNUM_S_NO, GNUM_ADD_TYPE_CODE, HRGSTR_CITY, HRGSTR_DISTRICT, NUM_DIST_ID, \
								GNUM_STATE_CODE,HRGSTR_STATE_NAME, HRGNUM_PINCODE, GNUM_COUNTRY_CODE, GNUM_ISVALID, GNUM_SEAT_ID, \
								GDT_ENTRY_DATE, HRGNUM_IS_LOCAL, HRGSTR_HOUSE_NO, HRGSTR_STREET_NO, \
								HRGSTR_CONTACT_NO, GNUM_CITY_LOC_CODE, IS_CURRENT_ADDRESSS, HRGSTR_CITY_LOCATION,HRGSTR_IP_ADD, \
								GNUM_HOSPITAL_CODE,HRGNUM_VERIFICATION_SLNO,HRGSTR_MOBILE_NO,HRGSTR_FAX_NO,HRGSTR_EMAIL_ID, \
								HRGNUM_CHANGE_REQ_BY, HRGSTR_CHANGE_REQBY_NAME, HRGSTR_CHANGE_REQBY_ADD, GNUM_RELATION_CODE, HRGSTR_CONSTABLE_BADGENO, HRGSTR_CONSTABLE_DESIG,HRGNUM_IS_URBAN ) \
								VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_ADD_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
								?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)			


		
INSERT.HRGT_PATIENT_MLC_DTL=	INSERT INTO HRGT_PATIENT_MLC_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HRGNUM_VISIT_NO, HRGSTR_MLC_NO, \
									HRGDT_MLC_DATE, PSSTR_CMO_CODE, HRGSTR_MLC_BOOKNO, HRGNUM_MLC_PAGENO, HRGNUM_ISTRANSFER, GNUM_SEAT_ID, GDT_ENTRY_DATE, \
									HRGNUM_ISBROUGHTDEAD, HRGSTR_PATIENT_CONDITION, HRGSTR_DAIGNOSIS, HRGSTR_MLC_REMARKS, HRGNUM_ISFIT, GNUM_ISVALID, \
									HRGSTR_FNAME, HRGSTR_MNAME, HRGSTR_LNAME, HRGDT_DOB, GNUM_GENDER_CODE, GNUM_MARITAL_STATUS_CODE, GNUM_RELIGION_CODE, \
									HRGSTR_FATHER_NAME, HRGSTR_MOMNAME, HRGNUM_IS_REF, HRGNUM_EXT_HOSPITAL_CODE, HRGSTR_EXT_HOSP_DOCT_NAME, HGNUM_ISUNKNOWN, \
									HRGNUM_IS_LOCAL, HRGSTR_HOUSE_NO, GNUM_CITY_LOC_CODE, HRGSTR_DISTRICT, HRGSTR_CITY, GNUM_STATECODE, GNUM_COUNTRYCODE, \
									HRGNUM_PIN, HRGSTR_CONTACT_NO, HRGNUM_ADD_TYPE_CODE, HRGSTR_CITY_LOCATION, HRGSTR_IP_ADD, GNUM_NATIONALITY_CODE, \
									HRGNUM_EXT_HOSPITAL_CRNO, HRGNUM_EXT_HOSPITAL_DEPT, HRGNUM_EXT_HOSPITAL_DEPT_UNIT, HRGNUM_IS_IMAGEUPLOADED, \
									HRGSTR_SPOUSENAME, HRGSTR_NATIONAL_ID, GNUM_HOSPITAL_CODE, HRGTM_MLC_TIME, HRGNUM_INJURY_TYPE_CODE, HRGNUM_STATUS_CODE, \
									HRGDT_HANDOVER_DATETIME, HRGNUM_MLC_TYPE, HRGSTR_OFFICER_NAME, HRGNUM_INJURY_NATURE_CODE, HRGSTR_OFFICER_DESIG, \
									PSSTR_REFER_DOC_CODE, HRGSTR_OFFICER_BADGENO, HRGSTR_REFER_DOC_REMARKS,HRGSTR_WEAPON_TYPE, HRGSTR_INJURY_SIZE, HRGSTR_INJURY_DEPTH, HGNUM_DISEASE_SITE_ID,HRGNUM_BURN_PERCENTAGE,HRGSTR_POISION_REMARK,HRGNUM_INJURY_AGE) \
									VALUES(?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_MLC_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? \
									AND HRGNUM_VISIT_NO = ?),?,?,TO_DATE(?,'dd-Mon-yyyy'),?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?, \
									?,?,?,?,?,?,TO_DATE(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?)


INSERT.HRGT_DUP_RENEW_DTL=		INSERT INTO HRGT_DUP_RENEW_DTL (HRGNUM_PUK, HRGNUM_S_NO, HRGDT_DUP_RENEW_DATE, HRGNUM_COST, HRGSTR_REMARKS, HRGSTR_DUP_RENEW_FLAG, GBL_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGSTR_IP_ADD,GNUM_HOSPITAL_CODE) \
								VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_DUP_RENEW_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=? AND HRGDT_DUP_RENEW_DATE LIKE SYSDATE ),SYSDATE,?,?,?,?,?,SYSDATE,?,?,?,?)


INSERT.HRGT_UNIT_CHANGE_DTL=	INSERT INTO HRGT_UNIT_CHANGE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, GNUM_DEPT_CODE, HRGNUM_VISIT_NO, HGNUM_FROM_DEPTUNITCODE, HGNUM_TO_DEPTUNITCODE, \
										HRGSTR_CHANGE_REASON, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID,GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?,?)


INSERT.HRGT_PATIENT_STATUS_CHANGE_DTL=	INSERT INTO HRGT_PATIENT_STATUS_CHANGE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HGNUM_PAT_STATUS_CODE_OLD, HGNUM_PAT_STATUS_CODE_NEW, \
										GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_PAT_STATUS_CHANGE_DATE,GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,?,SYSDATE,?,?,TO_DATE(?,'dd-Mon-yyyy'),?)


SELECT.OPD_VISIT.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO=		SELECT A.HRGNUM_PUK AS patCrNo, \
														(SELECT INITCAP(B.GSTR_DEPT_NAME)  FROM GBLT_DEPARTMENT_MST B WHERE B.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) department, \
														(SELECT INITCAP(C.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST C WHERE C.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) room, \
														(SELECT INITCAP(D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE D.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) departmentUnit \
														FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?)
												
												

SELECT.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO_OLD=SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype, \
											a.hrgnum_episode_type_code AS episodetypecode,a.hrgstr_episode_action_code AS episodeactioncode,a.hrgnum_admission_no AS admissionno, a.hrgstr_mlc_no AS mlcno, \
											a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,\
											TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime, \
											TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY') AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,\
											a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname,\
											a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,\
											a.hrgnum_next_visit_type AS episodenextvisittype,a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,\
											hgnum_treatment_cat_code AS patsecondarycatcode,hgnum_patient_cat_code AS patprimarycatcode,\
											(SELECT INITCAP (d.gstr_episode_action_name) FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,\
											(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code and e.gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department,\
											(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
											and g.gnum_hospital_code=a.gnum_hospital_code  and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ) departmentunit,\
											(SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code = a.hrgstr_next_visit_dept_code and f.gnum_hospital_code=a.gnum_hospital_code  and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) )episodenextvisitdept,\
											(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and i.gnum_hospital_code=a.gnum_hospital_code) room,\
											(SELECT INITCAP (j.hgstr_unitname) FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode = a.hgnum_next_visit_deptunitcode and j.gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) episodenextvisitdeptunit,\
											(DECODE ( (SELECT hopnum_deptunitcode   FROM hopt_dept_unit_roster_dtl \
											WHERE hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (   hopnum_deptunitcode = a.hgnum_next_visit_deptunitcode \
											OR hopnum_deptunitcode=a.hgnum_deptunitcode ) and gnum_hospital_code=a.gnum_hospital_code),NULL, 0,1)) deptunitisonduty,\
											(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code),\
											0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,\
											(DECODE ((SELECT m.gdt_entry_date FROM hrgt_episode_dtl m WHERE TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') =TO_CHAR (SYSDATE, 'dd-mon-yyyy') \
											AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk and m.gnum_hospital_code=a.gnum_hospital_code \
											AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM hrgt_episode_dtl k WHERE (k.hrgnum_puk = a.hrgnum_puk) and (k.gnum_hospital_code=a.gnum_hospital_code) \
											AND (k.hrgnum_episode_code = a.hrgnum_episode_code ) AND (k.gnum_isvalid = ?))),NULL, 0,1)) visitedtoday \
											FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.hrgnum_is_episode_open = ?) AND (a.gnum_isvalid = ?) and (a.gnum_hospital_code=?) \
											AND a.hrgnum_episode_code NOT IN (SELECT n.hrgnum_episode_code FROM hrgt_episode_dtl n WHERE (n.hrgnum_puk = ?) AND (n.hrgnum_is_episode_open = ?) \
											AND (n.gnum_isvalid = ?) and (n.gnum_hospital_code=?)) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
											FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (z.gnum_isvalid = ?) and  (z.gnum_hospital_code=?)) ORDER BY a.hrgnum_episode_code


SELECT.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO=SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype, \
											a.hrgnum_episode_type_code AS episodetypecode,a.hrgstr_episode_action_code AS episodeactioncode,a.hrgnum_admission_no AS admissionno, a.hrgstr_mlc_no AS mlcno, \
											a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,\
											TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime, \
											TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY') AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,\
											a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname,\
											a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,\
											a.hrgnum_next_visit_type AS episodenextvisittype,a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,\
											hgnum_treatment_cat_code AS patsecondarycatcode,hgnum_patient_cat_code AS patprimarycatcode,\
											(SELECT INITCAP (d.gstr_episode_action_name) FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,\
											(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code and e.gnum_hospital_code=a.gnum_hospital_code \
											AND e.gnum_isvalid=a.gnum_isvalid) department,\
											(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
											and g.gnum_hospital_code=a.gnum_hospital_code  AND g.gnum_isvalid=a.gnum_isvalid) departmentunit,\
											(SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code = a.hrgstr_next_visit_dept_code and f.gnum_hospital_code=a.gnum_hospital_code  \
											 AND f.gnum_isvalid=a.gnum_isvalid)episodenextvisitdept,\
											(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and i.gnum_hospital_code=a.gnum_hospital_code) room,\
											(SELECT INITCAP (j.hgstr_unitname) FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode = a.hgnum_next_visit_deptunitcode and j.gnum_hospital_code=a.gnum_hospital_code \
											AND j.gnum_isvalid=a.gnum_isvalid) episodenextvisitdeptunit,\
											(DECODE ( (SELECT hopnum_deptunitcode   FROM hopt_dept_unit_roster_dtl \
											WHERE hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (   hopnum_deptunitcode = a.hgnum_next_visit_deptunitcode \
											OR hopnum_deptunitcode=a.hgnum_deptunitcode ) and gnum_hospital_code=a.gnum_hospital_code and rownum=1),NULL, 0,1)) deptunitisonduty,\
											(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
											AND gnum_isvalid=a.gnum_isvalid),\
											0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,\
											(DECODE ((SELECT m.gdt_entry_date FROM hrgt_episode_dtl m WHERE TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') =TO_CHAR (SYSDATE, 'dd-mon-yyyy') \
											AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk and m.gnum_hospital_code=a.gnum_hospital_code \
											AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM hrgt_episode_dtl k WHERE (k.hrgnum_puk = a.hrgnum_puk) and (k.gnum_hospital_code=a.gnum_hospital_code) \
											AND (k.hrgnum_episode_code = a.hrgnum_episode_code ) AND (k.gnum_isvalid = ?))),NULL, 0,1)) visitedtoday \
											FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.hrgnum_is_episode_open = ?) AND (a.gnum_isvalid = ?) and (a.gnum_hospital_code=?) \
											AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
											FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (z.gnum_isvalid = ?) and  (z.gnum_hospital_code=?)) ORDER BY a.hrgnum_episode_code



SELECT.OPEN.EPISODE.VISITED.TODAY.HRGT_EPISODE_DTL=	SELECT HRGNUM_PUK as patcrno, hrgnum_episode_code AS episodecode,HRGNUM_VISIT_NO as episodevisitno, a.gnum_dept_code AS departmentcode, (SELECT gstr_dept_name FROM gblt_department_mst \
													WHERE gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_dept_code = a.gnum_dept_code \
													AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=1) AS department, a.hgnum_deptunitcode AS departmentunitcode, (SELECT hgstr_unitname \
													FROM hgbt_unit_mst WHERE gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND \
													hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=1) AS departmentunit, hgnum_treatment_cat_code \
													AS patsecondarycatcode,TO_CHAR ((SELECT hrgdt_valid_upto FROM hrgt_seccat_change_dtl b WHERE b.hrgnum_puk = a.hrgnum_puk AND \
													b.hrgnum_episode_code = a.hrgnum_episode_code AND b.hrgnum_s_no = (SELECT MAX (hrgnum_s_no) FROM hrgt_seccat_change_dtl WHERE \
													hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code) AND \
													gnum_hospital_code = a.gnum_hospital_code), 'dd-Mon-yyyy') AS validupto,hgnum_patient_cat_code AS patprimarycatcode,  (SELECT HGNUM_ISGENERAL  FROM HGBT_UNIT_MST x   WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode \
													AND x.gnum_hospital_code = a.gnum_hospital_code AND x.gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))  departmentunittype FROM \
													hrgt_episode_dtl a WHERE TRUNC (gdt_entry_date) = TRUNC (SYSDATE) AND hrgnum_is_episode_open = ? and HRGNUM_VISIT_TYPE<>0 \
													AND a.hrgnum_puk = ? AND a.gnum_hospital_code = ? AND a.gnum_isvalid=?											
												


SELECT.HRGT_EPISODE_DTL.EMG_EPISODE.RETRIEVE_BY_CRNO=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, \
														A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, \
														A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, \
														A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY') AS EPISODENEXTVISITDATE, A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, \
														A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, \
														A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, \
														A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, \
														HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, GDT_REFERRAL_ACCEPTANCE_DATE AS EPISODEREFERACCEPTDATE, HGNUM_TREATMENT_CAT_CODE AS PatSecondaryCatCode,  HGNUM_PATIENT_CAT_CODEAS AS PatPrimaryCatCode,\
														(SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
														(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
														(SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
														(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, \
														(SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, \
														(SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT, \
														(DECODE ((SELECT HOPNUM_DEPTUNITCODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPDT_START_DT < SYSDATE AND HOPDT_END_DT > SYSDATE AND (SUBSTR(HOPNUM_DEPTUNITCODE,1,8 )= SUBSTR (A.HGNUM_NEXT_VISIT_DEPTUNITCODE, 1,8) or SUBSTR(HOPNUM_DEPTUNITCODE ,1,8)= SUBSTR (A.HGNUM_DEPTUNITCODE, 1,8))), NULL, 0, 1 ) ) DEPTUNITISONDUTY \
														FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?) AND (A.GNUM_ISVALID = ?) AND (A.HRGNUM_VISIT_TYPE=?) \
														AND A.HRGNUM_EPISODE_CODE NOT IN (SELECT N.HRGNUM_EPISODE_CODE FROM HRGT_EPISODE_DTL N WHERE (N.HRGNUM_PUK = ?)AND (N.HRGNUM_IS_EPISODE_OPEN = ?) AND (N.GNUM_ISVALID = ?)) \
														AND A.HRGNUM_VISIT_NO >= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))


 SELECT.HRGT_EPISODE_DTL.CHECK_OPEN_EMG_EPISODE.BY_CRNO=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE \
															FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?) AND (A.GNUM_ISVALID = ?) AND (A.HRGNUM_VISIT_TYPE=?) \
															AND A.HRGNUM_EPISODE_CODE NOT IN (SELECT N.HRGNUM_EPISODE_CODE FROM HRGT_EPISODE_DTL N WHERE (N.HRGNUM_PUK = ?)AND (N.HRGNUM_IS_EPISODE_OPEN = ?) AND (N.GNUM_ISVALID = ?)) \
															AND A.HRGNUM_VISIT_NO >= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))


SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CRNO.ADD_TYPE=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_S_NO AS SERIALNO, A.GNUM_ADD_TYPE_CODE AS PATADDTYPECODE, A.HRGSTR_CITY AS PATADDCITY, INITCAP (DECODE (a.hrgstr_district, NULL, (SELECT str_dist_name FROM \
														gblt_district_mst WHERE num_dist_id = a.num_dist_id and GNUM_ISVALID=1 and GNUM_HOSPITAL_CODE=a.gnum_hospital_code AND (SYSDATE BETWEEN gdt_effective_frm AND NVL (gdt_effective_to, SYSDATE)) ), a.hrgstr_district)) AS patadddistrict,A.NUM_DIST_ID as patAddDistrictCode, A.GNUM_STATE_CODE AS PATADDSTATECODE, A.HRGSTR_STATE_NAME AS PATADDSTATENAME, \
														A.HRGNUM_PINCODE AS PATADDPIN, A.GNUM_COUNTRY_CODE AS PATADDCOUNTRYCODE, A.GNUM_ISVALID AS ISVALID, A.GNUM_SEAT_ID AS SEATID, A.GDT_ENTRY_DATE AS ENTRYDATE, A.HRGNUM_IS_LOCAL AS ISADDRESSDELHI, \
														A.HRGSTR_HOUSE_NO AS PATADDHNO, A.HRGSTR_STREET_NO AS PATADDSTREET, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, A.IS_CURRENT_ADDRESSS AS ISCURRENTADDRESS, \
														(DECODE (A.HRGNUM_IS_LOCAL, 1, (SELECT INITCAP (E.GSTR_CITY_LOC_NAME) \
														FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE AND E.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1), A.HRGSTR_CITY_LOCATION ) ) PATADDCITYLOC, \
														(SELECT INITCAP (B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATADDTYPE, (SELECT INITCAP (C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATADDSTATE, \
														(SELECT INITCAP (D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE AND D.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATADDCOUNTRY, HRGNUM_IS_URBAN patIsUrban FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ADD_TYPE_CODE = ?) AND (A.GNUM_ISVALID = ?) AND (A.GNUM_HOSPITAL_CODE=?)
																	 
SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CRNO.ADD_TYPE1=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
														INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.NUM_DIST_ID as patAddDistrictCode, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
														A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_LOCAL AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
														(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
														FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?)  AND (A.GNUM_ADD_TYPE_CODE=?) AND (A.GNUM_ISVALID = ?)											 


SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CRNO.ALL=		SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, A.NUM_DIST_ID as patAddDistrictCode, \
														INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
														A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_LOCAL AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo,A.HRGSTR_PHONE_NO as patAddPhoneNo, HRGSTR_MOBILE_NO as patAddMobileNo, HRGSTR_FAX_NO as patAddFaxNo, HRGSTR_EMAIL_ID as patAddEmailId, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress,A.HRGSTR_STATE_NAME  as patAddStateName,HRGSTR_CITY_LOCATION as patAddCityLoc,\
														(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) patAddType, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE AND D.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE AND E.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) patAddCityLocMstValue, \
														(SELECT INITCAP(F.STR_DIST_NAME) FROM GBLT_DISTRICT_MST F WHERE F.NUM_DIST_ID = A.NUM_DIST_ID AND F.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND F.GNUM_ISVALID = 1 AND F.GDT_EFFECTIVE_FRM<= sysdate and (TO_DATE(NVL(F.GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>=TO_DATE(SYSDATE,'DD-MM-YY'))) patAddDistrictMstValue, \
														HRGNUM_IS_URBAN as patisurban FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) AND (GNUM_HOSPITAL_CODE=?)											 

SELECT.PREVIOUS_SYSTEM.HRGT_PREV_PATIENT_DTL1=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, A.GNUM_SALUTATION_CODE AS PATSALUTATIONCODE, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
												A.HRGDT_REGISTER_DATE AS REGISTERDATE, TO_CHAR (A.HRGDT_EXP_DATE, 'dd-Mon-YYYY') AS EXPIRYDATE, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HRGBL_ISLOCK AS ISLOCK, \
												INITCAP (A.HRGSTR_LOCK_REASON) AS ISLOCKREASON, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
												A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISNPROGRAM AS ISNPROGRAM, A.HRGNUM_ISREG_FREE AS ISFREE, A.GNUM_CURRENT_DEPT_CODE AS CURRENTDEPARTMENTCODE, \
												A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODEAS PATPRIMARYCATCODE, A.HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
												A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_REF_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP (A.HRGSTR_EXT_HOSPITAL_NAME) AS PATREFHOSPITALNAME, A.HRGNUM_ID_NO AS PATIDNO, A.HRGNUM_AMT_COLLECTED AS PATAMOUNTCOLLECTED, \
												A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EMERGENCY_TYPE AS EMERGENCYTYPE, A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP (A.HRGSTR_REF_DOCTOR_NAME) AS PATREFDOCTOR, A.HRGSTR_AGE AS PATAGE, \
												A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT, \
												(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
												(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
												(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE) PATREGCAT, \
												(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
												(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
												(SELECT INITCAP (H.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST H WHERE H.GNUM_DEPT_CODE = A.GNUM_CURRENT_DEPT_CODE) CURRENTDEPARTMENT, \
												(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATPRIMARYCAT, \
												(SELECT INITCAP (J.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST J WHERE J.GNUM_PATIENT_CAT_CODE = A.HGNUM_TREATMENT_CAT_CODE) PATSECONDARYCAT, \
												(SELECT INITCAP (K.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST K WHERE K.GNUM_HOSPITAL_CODE = A.HRGNUM_REF_HOSPITAL_CODE) PATREFHOSPITALNAME,\
												(SELECT INITCAP (L.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST L WHERE L.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
												(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
												(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY, \
												(SELECT DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 1 / 24), -1, ROUND (24 * 60 * (HRGDT_REGISTER_DATE - HRGDT_DOB)) || ' Min', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 1), -1, ROUND (24 * (HRGDT_REGISTER_DATE - HRGDT_DOB)) || ' Hr', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 14), -1, TRUNC (HRGDT_REGISTER_DATE - HRGDT_DOB) || ' Dy', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 60), -1, TRUNC (  (HRGDT_REGISTER_DATE - HRGDT_DOB ) / 7 ) || ' Wk', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 365), -1, ROUND (MONTHS_BETWEEN (HRGDT_REGISTER_DATE, HRGDT_DOB ) ) || ' Mth', \
												FLOOR (  MONTHS_BETWEEN (HRGDT_REGISTER_DATE,  HRGDT_DOB) / 12 )  || DECODE (HRGDT_DOB, '', 'N/A', ' Yr') ) ) ) ) ) FROM HRGT_PREV_PATIENT_DTL WHERE HRGNUM_PUK = ?) PATAGE \
												FROM HRGT_PREV_PATIENT_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) 	


SELECT.PREVIOUS_SYSTEM.HRGT_PREV_PATIENT_DTL2=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
												INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, A.GNUM_SALUTATION_CODE AS PATSALUTATIONCODE, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
												A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
												A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
												A.HRGDT_REGISTER_DATE AS REGISTERDATE, TO_CHAR (A.HRGDT_EXP_DATE, 'dd-Mon-YYYY') AS EXPIRYDATE, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HRGBL_ISLOCK AS ISLOCK, \
												INITCAP (A.HRGSTR_LOCK_REASON) AS ISLOCKREASON, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
												A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISNPROGRAM AS ISNPROGRAM, A.HRGNUM_ISREG_FREE AS ISFREE, A.GNUM_CURRENT_DEPT_CODE AS CURRENTDEPARTMENTCODE, \
												A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HGNUM_PATIENT_CAT_CODEAS PATPRIMARYCATCODE, A.HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
												A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_REF_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP (A.HRGSTR_EXT_HOSPITAL_NAME) AS PATREFHOSPITALNAME, A.HRGNUM_ID_NO AS PATIDNO, A.HRGNUM_AMT_COLLECTED AS PATAMOUNTCOLLECTED, \
												A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EMERGENCY_TYPE AS EMERGENCYTYPE, A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP (A.HRGSTR_REF_DOCTOR_NAME) AS PATREFDOCTOR, \
												(SELECT DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 1 / 24), -1, ROUND (24 * 60 * (HRGDT_REGISTER_DATE - HRGDT_DOB)) || ' Min', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 1), -1, ROUND (24 * (HRGDT_REGISTER_DATE - HRGDT_DOB)) || ' Hr', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 14), -1, TRUNC (HRGDT_REGISTER_DATE - HRGDT_DOB) || ' Dy', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 60), -1, TRUNC (  (HRGDT_REGISTER_DATE - HRGDT_DOB ) / 7 ) || ' Wk', \
												DECODE (SIGN (HRGDT_REGISTER_DATE - HRGDT_DOB - 365), -1, ROUND (MONTHS_BETWEEN (HRGDT_REGISTER_DATE, HRGDT_DOB ) ) || ' Mth', \
												FLOOR (  MONTHS_BETWEEN (HRGDT_REGISTER_DATE,  HRGDT_DOB) / 12 )  || DECODE (HRGDT_DOB, '', 'N/A', ' Yr') ) ) ) ) ) FROM HRGT_PREV_PATIENT_DTL WHERE HRGNUM_PUK = ?) PATAGE, \
												A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT, \
												(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
												(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
												(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE) PATREGCAT, \
												(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
												(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
												(SELECT INITCAP (H.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST H WHERE H.GNUM_DEPT_CODE = A.GNUM_CURRENT_DEPT_CODE) CURRENTDEPARTMENT, \
												(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATPRIMARYCAT, \
												(SELECT INITCAP (J.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST J WHERE J.GNUM_PATIENT_CAT_CODE = A.HGNUM_TREATMENT_CAT_CODE) PATSECONDARYCAT, \
												(SELECT INITCAP (K.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST K WHERE K.GNUM_HOSPITAL_CODE = A.HRGNUM_REF_HOSPITAL_CODE) PATREFHOSPITALNAME,\
												(SELECT INITCAP (L.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST L WHERE L.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
												(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
												(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
												FROM HRGT_PREV_PATIENT_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) 	

SELECT.PREVIOUS_SYSTEM.HRGT_PREV_PATIENT_DTL= SELECT a.hrgnum_puk AS patcrno, a.hrgstr_prev_puk AS prevcrno,TO_CHAR (a.hrgdt_dob, 'dd-Mon-YYYY') AS patdob,a.hrgbl_is_actual_dob AS isactualdob, \
											  INITCAP (a.hrgstr_fname) AS patfirstname,a.gnum_salutation_code AS patsalutationcode,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname, \
											  a.gnum_gender_code AS patgendercode,a.gnum_marital_status_code AS patmaritalstatuscode,a.hgnum_pat_status_code AS patstatuscode, a.hrgstr_idmark1 AS patidmark1,A.HRGSTR_IDMARK2 AS PATIDMARK2, \
											  INITCAP (a.HRGSTR_FHNAME) AS patguardianname,INITCAP (a.hrgstr_momname) AS patmomname,a.hrgnum_reg_cat_code AS patregcatcode,a.hgnum_patient_cat_code AS patcatcode, \
											  a.hrgdt_register_date AS registerdate,TO_CHAR (a.hrgdt_exp_date, 'dd-Mon-YYYY') AS expirydate,a.gnum_dept_code AS departmentcode, a.hrgbl_islock AS islock,INITCAP (a.hrgstr_lock_reason) AS islockreason, \
											  a.gdt_entry_date AS entrydate, a.gnum_seat_id AS seatid,a.hrgnum_is_mlc AS ismlc, a.gnum_isvalid AS isvalid,a.hrgnum_isunknown AS isunknown,a.hrgnum_month_income AS patmonthlyincome,a.hrgnum_is_urban AS patisurban, a.hrgnum_isnprogram AS isnprogram, \
											  a.HRGNUM_ISCMO_FREE AS iscmofree,a.gnum_current_dept_code AS currentdepartmentcode,a.gnum_desig_semester AS desigsemester,a.hrgnum_dept_staff_stud AS deptstaffstudent,a.HRGNUM_PAT_PRI_CAT_CODE as patprimarycatcode, \
											  a.HRGNUM_PAT_SEC_CAT_CODE AS patsecondarycatcode,a.hrgstr_ip_add AS systemipaddress,a.hrgstr_contact_no AS pataddcontactno,a.hrgnum_ref_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.HRGSTR_REF_HOSPITAL_NAME) AS patrefhospitalname, \
											  a.hrgnum_id_no AS patidno,a.hrgnum_amt_collected AS patamountcollected,a.hrgnum_is_ref AS isreferred,a.hrgnum_emergency_type AS emergencytype,a.hrgnum_add_type_code AS pataddtypecode,a.gnum_religion_code AS patreligioncode, \
											  INITCAP (a.hrgstr_ref_doctor_name) AS patrefdoctor,(SELECT DECODE (SIGN (hrgdt_register_date - hrgdt_dob - 1 / 24), -1, ROUND (24 * 60 * (hrgdt_register_date - hrgdt_dob)) || ' Min',DECODE(SIGN (hrgdt_register_date - hrgdt_dob - 1),-1, ROUND (24 * (hrgdt_register_date - hrgdt_dob)) \
											  || ' Hr',DECODE(SIGN (hrgdt_register_date - hrgdt_dob - 14),-1, TRUNC (hrgdt_register_date - hrgdt_dob) || ' Dy',DECODE(SIGN (hrgdt_register_date - hrgdt_dob - 60),-1, TRUNC (  (hrgdt_register_date - hrgdt_dob)/ 7) \
											  || ' Wk',DECODE(SIGN (hrgdt_register_date - hrgdt_dob - 365),-1, ROUND(MONTHS_BETWEEN(hrgdt_register_date,hrgdt_dob)) || ' Mth', FLOOR(  MONTHS_BETWEEN(hrgdt_register_date, \
											  hrgdt_dob)/ 12) || DECODE (hrgdt_dob, '', 'N/A', ' Yr'))))))  FROM hrgt_prev_patient_dtl WHERE hrgnum_puk = ? and gnum_hospital_code=?) patage,a.gnum_nationality_code AS patnationalitycode, \
											  a.HRGNUM_REF_HOSPITAL_CRNO AS patrefgnctdhospitalcrno,a.HRGNUM_REF_HOSPITAL_DEPT AS patrefgnctdhospitaldept,a.HRGNUM_REF_HOSPITAL_DEPT_UNIT AS patrefgnctdhospitaldeptunit, \
											  (SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b  WHERE b.gnum_gender_code = a.gnum_gender_code AND b.GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE) patgender,(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c \
											  WHERE c.gnum_marital_status_code =a.gnum_marital_status_code  AND c.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patmaritalstatus,(SELECT INITCAP (e.gstr_reg_cat_name) FROM gblt_reg_cat_mst e \
											  WHERE e.gnum_reg_cat_code = a.hrgnum_reg_cat_code AND e.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patregcat,(SELECT INITCAP (f.gstr_patient_cat_name) FROM gblt_patient_cat_mst f \
											  WHERE f.gnum_patient_cat_code = a.hgnum_patient_cat_code AND f.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patcat,(SELECT INITCAP (g.gstr_dept_name) FROM gblt_department_mst g  \
											  WHERE g.gnum_dept_code = a.gnum_dept_code AND g.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) department,(SELECT INITCAP (h.gstr_dept_name) FROM gblt_department_mst h \
											  WHERE h.gnum_dept_code = a.gnum_current_dept_code AND h.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) currentdepartment,(SELECT INITCAP (i.gstr_patient_cat_name) FROM gblt_patient_cat_mst i \
											  WHERE i.gnum_patient_cat_code =a.HRGNUM_PAT_PRI_CAT_CODE AND i.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patprimarycat,(SELECT INITCAP (j.gstr_patient_cat_name) FROM gblt_patient_cat_mst j \
											  WHERE j.gnum_patient_cat_code =a.HRGNUM_PAT_SEC_CAT_CODE AND j.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patsecondarycat,(SELECT INITCAP (k.GSTR_INSTITUTE_NAME)  FROM GBLT_EXT_INSTITUTE_MST k \
											  WHERE k.GNUM_INSTITUTE_CODE =a.hrgnum_ref_hospital_code and k.gnum_hospital_code=a.gnum_hospital_code) patrefhospitalname,(SELECT INITCAP (l.gstr_address_type)  FROM gblt_address_type_mst l \
											  WHERE l.gnum_address_type_code = a.hrgnum_add_type_code) pataddtype,(SELECT INITCAP (m.gstr_religion_name) FROM gblt_religion_mst m \
											  WHERE m.gnum_religion_code = a.gnum_religion_code) patreligion,(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t \
											  WHERE t.gnum_countrycode = a.gnum_nationality_code) patnationality  FROM hrgt_prev_patient_dtl a \
											  WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) AND (a.GNUM_HOSPITAL_CODE=?)
											  						 
SELECT.PREVIOUS_SYSTEM.HRGT_PATIENT_DTL_MGIMS=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_PREV_PUK AS prevCrNo, A.HRGDT_DOB AS patDOB, A.HRGBL_IS_ACTUAL_DOB AS isActualDob, INITCAP(A.HRGSTR_FNAME) AS patFirstName, \
												A.GNUM_SALUTATION_CODE AS patSalutationCode, INITCAP(A.HRGSTR_MNAME) AS patMiddleName, INITCAP(A.HRGSTR_LNAME) AS patLastName, A.GNUM_GENDER_CODE AS patGenderCode, \
												A.GNUM_MARITAL_STATUS_CODE AS patMaritalStatusCode, A.HGNUM_PAT_STATUS_CODE AS patStatusCode, INITCAP(A.HRGSTR_IDMARK1) AS patIdMark1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP(A.HRGSTR_FATHER_NAME) AS patGuardianName, \
												INITCAP(A.HRGSTR_MOMNAME) AS patMomName, A.HRGNUM_REG_CAT_CODE AS patRegCatCode, A.HGNUM_PATIENT_CAT_CODE AS patCatcode, A.HRGDT_REGISTER_DATE AS registerDate, A.HRGDT_EXP_DATE AS expiryDate, \
												A.GNUM_DEPT_CODE AS departmentCode, A.HRGBL_ISLOCK AS isLock, INITCAP(A.HRGSTR_LOCK_REASON) AS isLockReason, A.GDT_ENTRY_DATE AS entryDate, A.GNUM_SEAT_ID AS seatId, A.HRGNUM_ISMLC AS isMLC, \
												A.GBL_ISVALID AS isValid, A.HRGNUM_ISUNKNOWN AS isUnknown, A.HRGNUM_MONTH_INCOME AS patMonthlyIncome, A.HRGNUM_ISRURAL AS patIsUrban, A.HRGNUM_ISNPROGRAM AS isNProgram, \
												A.HRGNUM_ISREG_FREE AS isFree, A.GNUM_CURRENT_DEPT_CODE AS currentDepartmentCode, A.PNUM_RELIGION_CODE AS patReligionCode, A.GNUM_DESIG_SEMESTER AS desigSemester, A.HRGNUM_DEPT_STAFF_STUD AS deptStaffStudent, \
												(SELECT INITCAP(B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE=A.GNUM_GENDER_CODE) patGender, \
												(SELECT INITCAP(C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE=A.GNUM_MARITAL_STATUS_CODE) patMaritalStatus, \
												(SELECT INITCAP(E.HRGSTR_REG_CAT_NAME) FROM HRGT_REG_CAT_MST E WHERE E.HRGNUM_REG_CAT_CODE=A.HRGNUM_REG_CAT_CODE) patRegCat, \
												(SELECT INITCAP(G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE=A.GNUM_DEPT_CODE ) department, \
												(SELECT INITCAP(H.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST H WHERE H.GNUM_DEPT_CODE=A.GNUM_CURRENT_DEPT_CODE) currentDepartment, \
												(SELECT INITCAP(J.PSTR_RELIGION_NAME) FROM PIST_RELIGION_MST J WHERE J.PNUM_RELIGION_CODE=A.PNUM_RELIGION_CODE) patReligion \
												FROM HRGT_PATIENT_DTL A WHERE HRGNUM_PUK=? AND GBL_ISVALID=?									 
											 
SELECT.PREVIOUS_SYSTEM.HRGT_PREV_PATIENT_ADD_DTL=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
													INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
													A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_DELHI AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
													A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
													(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patAddType, \
													(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patAddState, \
													(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE AND D.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patAddCountry, \
													(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE AND E.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) patAddCityLoc \
													FROM HRGT_PREV_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?)  AND (A.GNUM_ADD_TYPE_CODE=?) AND (A.GNUM_ISVALID = ?) AND (A.GNUM_HOSPITAL_CODE=?) 											 
												 
											 
SELECT.PREVIOUS_SYSTEM.HRGT_PATIENT_ADD_DTL_MGIMS=	SELECT A.HRGNUM_PUK as patCrNo, A.HRGNUM_SNO as serialNo, INITCAP(A.HRGSTR_ADD1), A.GNUM_ADDRESS_TYPE_CODE as patAddTypeCode, INITCAP(A.HRGSTR_LOCATION_PO), INITCAP(A.HRGSTR_CITY) as patAddCity, \
													INITCAP(A.HRGSTR_DISTRICT) as patAddDistrict, A.GNUM_STATE_CODE as patAddStateCode, A.HRGNUM_PINCODE as patAddPIN, A.GNUM_COUNTRY_CODE as patAddCountryCode, \
													A.HRGBL_ISCURRENT_ADDRESS as isCurrentAddress, A.GBL_ISVALID as isValid, A.GNUM_SEAT_ID as seatId, A.GDT_ENTRY_DATE as entryDate, A.HRGSTR_CONTACT_NUM as patAddContactNo, \
													(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE=A.GNUM_ADDRESS_TYPE_CODE) patAddType, \
													(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE=A.GNUM_STATE_CODE) patAddState, \
													(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE=A.GNUM_COUNTRY_CODE) patAddCountry \
													FROM HRGT_PATIENT_ADD_DTL A WHERE A.HRGNUM_PUK=? AND A.GBL_ISVALID=?



SELECT.HRGT_DAILY_PATIENT_DTL.OPD_UNITS=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_S_NO AS SERIALNO, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HGNUM_PATIENT_CAT_CODEAS PATPRIMARYCATCODE, \
												A.HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, A.HRGSTR_PREV_PUK AS PREVCRNO, A.HRGNUM_ID_NO AS PATIDNO, A.HRGDT_DOB AS PATDOB, A.HRGNUM_IS_MLC AS ISMLC, \
												A.HRGNUM_IS_ACTUAL_DOB AS ISACTUALDOB, A.HRGNUM_IS_OLD AS PATISOLD, A.HRGSTR_FNAME AS PATFIRSTNAME, A.HRGSTR_MNAME AS PATMIDDLENAME, A.HRGSTR_LNAME AS PATLASTNAME, \
												A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
												A.HRGSTR_FATHER_NAME AS PATGUARDIANNAME, A.HRGSTR_MOMNAME AS PATMOMNAME, A.GNUM_REG_CAT_CODE AS PATREGCATCODE, A.HRGDT_REGISTER_DATE AS REGISTERDATE, \
												A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, DECODE (A.HRGNUM_QUE_NO, A.HRGNUM_QUE_NO, A.HRGNUM_QUE_NO + 1, A.HRGNUM_QUE_NO) AS QUENO, \
												A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_AMT_COLLECTED AS PATAMOUNTCOLLECTED, A.HRGNUM_IS_URBAN AS PATISURBAN, \
												A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EXT_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, A.HRGSTR_EXT_HOSP_DOCT_NAME AS PATREFDOCTOR,\
												A.HRGNUM_IS_LOCAL AS ISADDRESSDELHI, A.HRGSTR_HOUSE_NO AS PATADDHNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, A.HRGSTR_DISTRICT AS PATADDDISTRICT, A.HRGSTR_CITY AS PATADDCITY, \
												A.GNUM_STATECODE AS PATADDSTATECODE, A.GNUM_COUNTRYCODE AS PATADDCOUNTRYCODE, A.HRGNUM_PIN AS PATADDPIN, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, \
												A.HRGDT_EPISODE_DATE AS EPISODEDATE, A.GNUM_ISVALID AS ISVALID, DECODE (A.HRGNUM_PATIENT_ALLOWED, '0', '0', A.HRGNUM_PATIENT_ALLOWED - 1)  AS PATIENTALLOWED, A.HGNUM_ROOM_CODE AS ROOMCODE, \
												A.GDT_ENTRY_DATE AS ENTRYDATE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGSTR_EXT_HOSPITAL_NAME AS PATREFHOSPITALNAME, \
												A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, A.HRGSTR_CITY_LOCATION AS PATADDCITYLOC, A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, \
												A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT, \
												(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
												(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
												(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.GNUM_REG_CAT_CODE) PATREGCAT, \
												(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
												(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
												(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATPRIMARYCAT, \
												(SELECT INITCAP (J.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST J WHERE J.GNUM_PATIENT_CAT_CODE = A.HGNUM_TREATMENT_CAT_CODE) PATSECONDARYCAT, \
												(SELECT INITCAP (K.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST K WHERE K.GNUM_HOSPITAL_CODE = A.HRGNUM_EXT_HOSPITAL_CODE) PATREFHOSPITALNAME, \
												(SELECT INITCAP (L.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST L WHERE L.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
												(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
												(SELECT INITCAP (N.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST N WHERE N.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, \
												(SELECT INITCAP (O.HGSTR_UNITNAME) FROM HGBT_UNIT_MST O WHERE O.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
												(SELECT INITCAP (R.GSTR_STATENAME) FROM GBLT_STATE_MST R WHERE R.GNUM_STATECODE = A.GNUM_STATECODE) PATADDSTATE, \
												(SELECT INITCAP (D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRYCODE) PATADDCOUNTRY, \
												(SELECT INITCAP (S.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST S WHERE S.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) PATADDCITYLOC, \
												(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
												FROM HRGT_DAILY_PATIENT_DTL A WHERE (GNUM_DEPT_CODE = ? AND HGNUM_DEPTUNITCODE = ?) \
												AND GDT_ENTRY_DATE >= ALL (SELECT GDT_ENTRY_DATE FROM HRGT_DAILY_PATIENT_DTL A WHERE GNUM_DEPT_CODE = ? AND HGNUM_DEPTUNITCODE = ?)
												


SELECT.HRGT_DAILY_PATIENT_DTL.OPD_UNITS_TOKEN_DTLS=		SELECT a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode,DECODE (a.hrgnum_que_no,a.hrgnum_que_no, a.hrgnum_que_no + 1,a.hrgnum_que_no \
														) AS queno,a.gnum_isvalid AS isvalid,DECODE (a.hrgnum_patient_allowed,'0', '0',a.hrgnum_patient_allowed - 1) AS patientallowed,a.hgnum_room_code AS roomcode, a.gdt_entry_date AS entrydate, \
														(SELECT INITCAP (g.gstr_dept_name) FROM gblt_department_mst g WHERE g.gnum_dept_code = a.gnum_dept_code and g.gnum_hospital_code=a.gnum_hospital_code and GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) department,(SELECT INITCAP (n.hgstr_room_name) \
														FROM hgbt_room_mst n WHERE n.hgnum_room_code = a.hgnum_room_code and n.gnum_hospital_code=a.gnum_hospital_code ) room,(SELECT INITCAP (o.hgstr_unitname) \
														FROM hgbt_unit_mst o WHERE o.hgnum_deptunitcode = a.hgnum_deptunitcode and o.gnum_hospital_code=a.gnum_hospital_code and GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) departmentunit \
														FROM hrgt_daily_patient_dtl a WHERE (gnum_dept_code = ? AND hgnum_deptunitcode = ? and gnum_hospital_code=? and HGNUM_ROOM_CODE =?) AND gdt_entry_date >=ALL (SELECT gdt_entry_date \
														FROM hrgt_daily_patient_dtl a WHERE gnum_dept_code = ? AND hgnum_deptunitcode = ? and gnum_hospital_code=? and HGNUM_ROOM_CODE =?)
												
																								

SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO_06_jun-09=		SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode, a.hrgstr_case_no AS caseno,INITCAP (a.hrgstr_police_name) AS policename, \
													INITCAP (a.hrgstr_police_desig) AS policedesignation,INITCAP (a.hrgstr_police_station) AS policestation,INITCAP (a.hrgstr_officer_incharge) AS officerincharge, \
													TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid, \
													TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate,a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition, \
													INITCAP (a.psrstr_doctor_name) AS doctorname,INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid,a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname, \
													INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob,a.gnum_gender_code AS patgendercode, \
													a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname,INITCAP (a.hrgstr_momname) AS patmomname, \
													a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor,a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi, \
													a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict,INITCAP (a.hrgstr_city) AS pataddcity, \
													a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno,a.hrgnum_add_type_code AS pataddtypecode, \
													INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress,a.hrgstr_brought_by_name AS broughtbyname,a.hrgstr_brought_by_address AS broughtbyaddress, \
													a.hrgstr_brought_by_phone AS broughtbyphone,a.hrgstr_batch_no AS batchno,a.gnum_nationality_code AS patnationalitycode,a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno, \
													a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.GSTR_INSTITUTE_NAME) FROM GBLT_EXT_INSTITUTE_MST e WHERE e.GNUM_INSTITUTE_CODE = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code AND f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode AND g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode AND h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code AND i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code AND t.gnum_hospital_code = a.gnum_hospital_code) patnationality \
													FROM hrgt_patient_mlc_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid =? AND a.gnum_hospital_code = ? AND ((a.hrgnum_s_no) = \
													ALL (SELECT MAX (j.hrgnum_s_no) FROM hrgt_patient_mlc_dtl j WHERE j.hrgnum_puk = ? AND j.gnum_isvalid = ? AND j.gnum_hospital_code = a.gnum_hospital_code)) \
													AND gdt_entry_date = (SELECT MAX (p.gdt_entry_date) FROM hrgt_patient_mlc_dtl p WHERE p.hrgnum_puk = ? AND p.gnum_isvalid = ? AND p.gnum_hospital_code = a.gnum_hospital_code) 

SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO=		SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode,a.HRGNUM_VISIT_NO  as episodevisitno, c.hrgstr_case_no AS caseno, INITCAP (c.HRGSTR_CONSTABLE_NAME) AS policename, \
       												INITCAP (c.HRGSTR_CONSTABLE_DESIG) AS policedesignation,INITCAP (c.hrgstr_police_station) AS policestation, INITCAP (c.HRGSTR_IO_NAME) AS officerincharge, TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate, \
       												a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid, \
													TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate,a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition, \
													INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid,a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname, \
													INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob,a.gnum_gender_code AS patgendercode, \
													a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname,INITCAP (a.hrgstr_momname) AS patmomname, \
													a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor,a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi, \
													a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict,INITCAP (a.hrgstr_city) AS pataddcity, \
													a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno,a.hrgnum_add_type_code AS pataddtypecode, \
													INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress, b.hrgstr_brought_by_name AS broughtbyname, b.hrgstr_brought_by_address AS broughtbyaddress, \
      												b.hrgstr_brought_by_phone AS broughtbyphone,c.HRGSTR_CONSTABLE_BADGENO AS batchno, a.gnum_nationality_code AS patnationalitycode,a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno, \
													a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.GSTR_INSTITUTE_NAME) FROM GBLT_EXT_INSTITUTE_MST e WHERE e.GNUM_INSTITUTE_CODE = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code AND f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode AND g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode AND h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code AND i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code AND t.gnum_hospital_code = a.gnum_hospital_code) patnationality \
													FROM hrgt_patient_mlc_dtl a , HRGT_PATIENT_BROUGHTBY_DTL b,HRGT_POLICE_VERIFICATION_DTL c WHERE a.hrgnum_puk = ? and a.hrgnum_puk=b.hrgnum_puk and b.hrgnum_puk=c.hrgnum_puk \
   													and b.gnum_isvalid=a.gnum_isvalid  and b.gnum_isvalid=c.gnum_isvalid and a.HRGNUM_EPISODE_CODE=b.HRGNUM_EPISODE_CODE  and c.HRGNUM_EPISODE_CODE=b.HRGNUM_EPISODE_CODE \
   													AND ((c.hrgnum_s_no) = ALL (SELECT MAX (hrgnum_s_no) FROM HRGT_POLICE_VERIFICATION_DTL WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) \
       												) AND ((b.HRGNUM_SLNO) = ALL (SELECT MAX (HRGNUM_SLNO) FROM HRGT_PATIENT_BROUGHTBY_DTL WHERE hrgnum_puk = b.hrgnum_puk AND gnum_isvalid = b.gnum_isvalid AND gnum_hospital_code = b.gnum_hospital_code)) \
       												AND a.gnum_isvalid =? AND a.gnum_hospital_code = ? AND ((a.hrgnum_s_no) = \
													ALL (SELECT MAX (j.hrgnum_s_no) FROM hrgt_patient_mlc_dtl j WHERE j.hrgnum_puk = ? AND j.gnum_isvalid = ? AND j.gnum_hospital_code = a.gnum_hospital_code)) \
													AND a.gdt_entry_date = (SELECT MAX (p.gdt_entry_date) FROM hrgt_patient_mlc_dtl p WHERE p.hrgnum_puk = ? AND p.gnum_isvalid = ? AND p.gnum_hospital_code = a.gnum_hospital_code)
 


SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_MLCNO=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_MLC_NO AS MLCNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGSTR_CASE_NO AS CASENO, INITCAP(A.HRGSTR_POLICE_NAME) AS POLICENAME, \
													INITCAP(A.HRGSTR_POLICE_DESIG) AS POLICEDESIGNATION, INITCAP(A.HRGSTR_POLICE_STATION) AS POLICESTATION, INITCAP(A.HRGSTR_OFFICER_INCHARGE) AS OFFICERINCHARGE, \
													TO_CHAR(A.HRGDT_MLC_DATE , 'dd-mon-yyyy') AS MLCDATE, A.PSSTR_CMO_CODE AS CMOCODE, A.HRGNUM_ISTRANSFER AS ISTRANSFER, A.GNUM_SEAT_ID AS SEATID, \
													TO_CHAR(A.GDT_ENTRY_DATE, 'dd-mon-yyyy') AS ENTRYDATE, A.HRGNUM_ISBROUGHTDEAD AS ISBROUGHTDEAD, INITCAP(A.HRGSTR_PATIENT_CONDITION) AS PATCONDITION, \
													INITCAP(A.PSRSTR_DOCTOR_NAME) AS DOCTORNAME, INITCAP(A.HRGSTR_MLC_REMARKS) AS MLCREMARK, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_S_NO AS SERIALNO, \
													INITCAP(A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP(A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP(A.HRGSTR_LNAME) AS PATLASTNAME, TO_CHAR(A.HRGDT_DOB, 'dd-mon-yyyy') AS PATDOB, \
													A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP(A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, \
													INITCAP(A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EXT_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP(A.HRGSTR_EXT_HOSP_DOCT_NAME) AS PATREFDOCTOR, \
													A.HGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_IS_LOCAL AS ISADDRESSDELHI, A.HRGSTR_HOUSE_NO AS PATADDHNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, INITCAP(A.HRGSTR_DISTRICT) AS PATADDDISTRICT, \
													INITCAP(A.HRGSTR_CITY) AS PATADDCITY, A.GNUM_STATECODE AS PATADDSTATECODE, A.GNUM_COUNTRYCODE AS PATADDCOUNTRYCODE, A.HRGNUM_PIN AS PATADDPIN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
													A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, INITCAP(A.HRGSTR_CITY_LOCATION) AS PATADDCITYLOC, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_BROUGHT_BY_NAME AS BROUGHTBYNAME, \
													A.HRGSTR_BROUGHT_BY_ADDRESS AS BROUGHTBYADDRESS,A.HRGSTR_BROUGHT_BY_PHONE AS BROUGHTBYPHONE,A.HRGSTR_BATCH_NO AS BATCHNO, A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, \
													A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT,HRGNUM_IS_IMAGEUPLOADED as isImageUploaded, \
													(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
													(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
													(SELECT INITCAP (D.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST D WHERE D.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
													(SELECT INITCAP (E.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST E WHERE E.GNUM_HOSPITAL_CODE = A.HRGNUM_EXT_HOSPITAL_CODE) PATREFHOSPITALNAME, \
													(SELECT INITCAP (F.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST F WHERE F.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
													(SELECT INITCAP (G.GSTR_STATENAME) FROM GBLT_STATE_MST G WHERE G.GNUM_STATECODE = A.GNUM_STATECODE) PATADDSTATE, \
													(SELECT INITCAP (H.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST H WHERE H.GNUM_COUNTRYCODE = A.GNUM_COUNTRYCODE) PATADDCOUNTRY, \
													(SELECT INITCAP (I.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST I WHERE I.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) PATADDCITYLOC, \
													(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
													FROM HRGT_PATIENT_MLC_DTL A WHERE A.HRGSTR_MLC_NO= ? AND A.GNUM_ISVALID = ? \
													AND ((A.HRGNUM_S_NO) = ALL (SELECT max(J.HRGNUM_S_NO) FROM HRGT_PATIENT_MLC_DTL J WHERE J.HRGSTR_MLC_NO = ? AND J.GNUM_ISVALID = ?)) 
												    													

													
SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO_ME =    SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_MLC_NO AS MLCNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE \
 													 FROM HRGT_PATIENT_MLC_DTL A WHERE A.HRGNUM_PUK = ? AND A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE=?
 													 
SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO_FOR_MAX_SNO23-10-09 = SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_s_no AS serialno, a.hrgnum_episode_code AS episodecode FROM hrgt_patient_mlc_dtl a \
															WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? AND hrgnum_s_no = (SELECT MAX (hrgnum_s_no) FROM hrgt_patient_mlc_dtl a WHERE hrgnum_puk = ? \
															AND gnum_isvalid = ? AND gnum_hospital_code = a.gnum_hospital_code) AND a.gnum_hospital_code = ?
													 
SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO_FOR_MAX_SNO=	SELECT a.hrgnum_puk AS patcrno, TO_CHAR (a.hrgdt_mlc_date, 'dd-Mon-yyyy') mlcdate, a.hrgstr_mlc_no AS mlcno, a.hrgnum_s_no AS serialno, a.hrgnum_episode_code AS episodecode, \
															hrgnum_visit_no episodevisitno FROM hrgt_patient_mlc_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ? AND hrgnum_episode_code IN ( SELECT \
															DISTINCT hrgnum_episode_code FROM hrgt_episode_dtl j WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
															AND hrgnum_is_episode_open = ? AND (hrgnum_visit_no = ALL ( SELECT MAX (k.hrgnum_visit_no) FROM hrgt_episode_dtl k WHERE k.hrgnum_puk = j.hrgnum_puk AND \
															k.gnum_isvalid = j.gnum_isvalid AND k.gnum_hospital_code = j.gnum_hospital_code AND k.hrgnum_episode_code = j.hrgnum_episode_code)))
 													 
SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO.WITHNOIMAGE = SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_MLC_NO AS MLCNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGSTR_CASE_NO AS CASENO, INITCAP(A.HRGSTR_POLICE_NAME) AS POLICENAME, \
													INITCAP(A.HRGSTR_POLICE_DESIG) AS POLICEDESIGNATION, INITCAP(A.HRGSTR_POLICE_STATION) AS POLICESTATION, INITCAP(A.HRGSTR_OFFICER_INCHARGE) AS OFFICERINCHARGE, \
													TO_CHAR(A.HRGDT_MLC_DATE , 'dd-mon-yyyy') AS MLCDATE, A.PSSTR_CMO_CODE AS CMOCODE, A.HRGNUM_ISTRANSFER AS ISTRANSFER, A.GNUM_SEAT_ID AS SEATID, \
													TO_CHAR(A.GDT_ENTRY_DATE, 'dd-mon-yyyy') AS ENTRYDATE, A.HRGNUM_ISBROUGHTDEAD AS ISBROUGHTDEAD, INITCAP(A.HRGSTR_PATIENT_CONDITION) AS PATCONDITION, \
													INITCAP(A.PSRSTR_DOCTOR_NAME) AS DOCTORNAME, INITCAP(A.HRGSTR_MLC_REMARKS) AS MLCREMARK, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_S_NO AS SERIALNO, \
													INITCAP(A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP(A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP(A.HRGSTR_LNAME) AS PATLASTNAME, TO_CHAR(A.HRGDT_DOB, 'dd-mon-yyyy') AS PATDOB, \
													A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP(A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, \
													INITCAP(A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EXT_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP(A.HRGSTR_EXT_HOSP_DOCT_NAME) AS PATREFDOCTOR, \
													A.HGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_IS_LOCAL AS ISADDRESSDELHI, A.HRGSTR_HOUSE_NO AS PATADDHNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, INITCAP(A.HRGSTR_DISTRICT) AS PATADDDISTRICT, \
													INITCAP(A.HRGSTR_CITY) AS PATADDCITY, A.GNUM_STATECODE AS PATADDSTATECODE, A.GNUM_COUNTRYCODE AS PATADDCOUNTRYCODE, A.HRGNUM_PIN AS PATADDPIN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
													A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, INITCAP(A.HRGSTR_CITY_LOCATION) AS PATADDCITYLOC, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_BROUGHT_BY_NAME AS BROUGHTBYNAME, \
													A.HRGSTR_BROUGHT_BY_ADDRESS AS BROUGHTBYADDRESS,A.HRGSTR_BROUGHT_BY_PHONE AS BROUGHTBYPHONE,A.HRGSTR_BATCH_NO AS BATCHNO, A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, \
													A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT, A.HRGNUM_IS_IMAGEUPLOADED AS isImageUploaded, \
													(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
													(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
													(SELECT INITCAP (D.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST D WHERE D.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
													(SELECT INITCAP (E.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST E WHERE E.GNUM_HOSPITAL_CODE = A.HRGNUM_EXT_HOSPITAL_CODE) PATREFHOSPITALNAME, \
													(SELECT INITCAP (F.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST F WHERE F.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
													(SELECT INITCAP (G.GSTR_STATENAME) FROM GBLT_STATE_MST G WHERE G.GNUM_STATECODE = A.GNUM_STATECODE) PATADDSTATE, \
													(SELECT INITCAP (H.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST H WHERE H.GNUM_COUNTRYCODE = A.GNUM_COUNTRYCODE) PATADDCOUNTRY, \
													(SELECT INITCAP (I.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST I WHERE I.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) PATADDCITYLOC, \
													(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE) PATNATIONALITY \
													FROM HRGT_PATIENT_MLC_DTL A where hrgnum_puk = ? AND gnum_isvalid = ? \
													and HRGNUM_S_NO =(select max(HRGNUM_S_NO) from hrgt_patient_mlc_dtl \
													where hrgnum_puk = ? AND gnum_isvalid = ? and HRGSTR_MLC_NO=a.HRGSTR_MLC_NO)\
													and HRGNUM_IS_IMAGEUPLOADED=?


SELECT.HRGT_PATIENT_STATUS_CHANGE_DTL.RETRIEVE_BY_CRNO=		SELECT HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HGNUM_PAT_STATUS_CODE_OLD, HGNUM_PAT_STATUS_CODE_NEW, GDT_ENTRY_DATE, \
															GNUM_ISVALID, GNUM_SEAT_ID, GDT_PAT_STATUS_CHANGE_DATE FROM HRGT_PATIENT_STATUS_CHANGE_DTL WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? \
															AND (SYSDATE - GDT_ENTRY_DATE) <= ALL (SELECT (SYSDATE - GDT_ENTRY_DATE) FROM HRGT_PATIENT_STATUS_CHANGE_DTL WHERE HRGNUM_PUK = ? AND GNUM_ISVALID = ?)

													
UPDATE.PRIMARY_CATEGORY.HRGT_PATIENT_DTL1=	UPDATE HRGT_PATIENT_DTL A SET A.HGNUM_PATIENT_CAT_CODE= ?, A.HRGNUM_ID_NO=?	WHERE A.HRGNUM_PUK = ? AND GNUM_HOSPITAL_CODE=?
												
UPDATE.PRIMARY_CATEGORY.HRGT_PATIENT_DTL=	UPDATE HRGT_PATIENT_DTL A SET A.HGNUM_PATIENT_CAT_CODE= ?, A.HRGNUM_ID_NO=?	WHERE A.HRGNUM_PUK = ?						
												
									
													

UPDATE.HRGT_PATIENT_ADD_DTL=		UPDATE HRGT_PATIENT_ADD_DTL SET HRGSTR_CITY = ?, HRGSTR_DISTRICT = ?, NUM_DIST_ID= ?, GNUM_STATE_CODE = ?, HRGSTR_STATE_NAME=?, HRGNUM_PINCODE = ?, GNUM_COUNTRY_CODE = ?, GNUM_ISVALID = ?, HRGNUM_IS_LOCAL = ?, \
									HRGSTR_HOUSE_NO = ?, HRGSTR_STREET_NO = ?, HRGSTR_CONTACT_NO = ?, GNUM_CITY_LOC_CODE = ?, IS_CURRENT_ADDRESSS = ?, HRGSTR_CITY_LOCATION=?, HRGNUM_VERIFICATION_SLNO = ? , HRGSTR_MOBILE_NO = ?,HRGSTR_FAX_NO=?,HRGSTR_EMAIL_ID=?,HRGSTR_PHONE_NO=?   WHERE (HRGNUM_PUK = ?) AND (GNUM_ADD_TYPE_CODE = ?) AND (GNUM_HOSPITAL_CODE=?)
 									 										
												
UPDATE.HRGT_PATIENT_MLC_DTL=		UPDATE HRGT_PATIENT_MLC_DTL SET HRGSTR_CASE_NO = ?, HRGSTR_POLICE_NAME = ?, HRGSTR_POLICE_DESIG = ?, HRGSTR_POLICE_STATION = ?, HRGSTR_OFFICER_INCHARGE = ?, \
									HRGDT_MLC_DATE = ?, HRGNUM_ISTRANSFER = ?, GNUM_SEAT_ID = ?, HRGNUM_ISBROUGHTDEAD = ?, HRGSTR_PATIENT_CONDITION = ?, PSRSTR_DOCTOR_NAME = ?, HRGSTR_MLC_REMARKS = ?, \
									HRGSTR_BROUGHT_BY_NAME=?, HRGSTR_BROUGHT_BY_ADDRESS =?, HRGSTR_BROUGHT_BY_PHONE=? GNUM_NATIONALITY_CODE=?, HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEPT=?, \
									HRGNUM_EXT_HOSPITAL_DEPT_UNIT=? WHERE HRGNUM_PUK = ? AND HRGSTR_MLC_NO = ? AND HRGNUM_EPISODE_CODE = ? AND GNUM_ISVALID = ?

UPDATE.HRGT_PATIENT_MLC_DTL.FILESYSPATH= UPDATE HRGT_PATIENT_MLC_DTL SET HRGSTR_FILE_SYSTEM_PATH = ? \
									    WHERE HRGNUM_PUK = ? AND HRGSTR_MLC_NO = ? AND HRGNUM_EPISODE_CODE = ? HRGNUM_S_NO=? AND GNUM_ISVALID = ?

UPDATE.MLC_N0.HRGT_EPISODE_DTL=		UPDATE HRGT_EPISODE_DTL SET HRGSTR_MLC_NO = ? , HRGNUM_EPISODE_TYPE_CODE=? WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND GNUM_HOSPITAL_CODE= ? AND HRGNUM_VISIT_NO = ?


UPDATE.HRGT_PATIENT_ADD_DTL1=		UPDATE HRGT_PATIENT_ADD_DTL SET GNUM_ADD_TYPE_CODE = (SELECT GNUM_ADDRESS_TYPE_CODE FROM GBLT_ADDRESS_TYPE_MST WHERE UPPER(GSTR_ADDRESS_TYPE) LIKE UPPER(?)), HRGSTR_CITY = ?, HRGSTR_DISTRICT = ?, \
									GNUM_STATE_CODE = (SELECT GNUM_STATECODE FROM GBLT_STATE_MST WHERE UPPER(GSTR_STATENAME) LIKE UPPER(?)), HRGNUM_PINCODE = ?, \
									GNUM_COUNTRY_CODE = (SELECT GNUM_COUNTRYCODE FROM GBLT_COUNTRY_MST WHERE UPPER(GSTR_COUNTRYNAME) LIKE UPPER(?)), GNUM_ISVALID = ?, HRGNUM_IS_LOCAL = ?, HRGSTR_HOUSE_NO = ?, HRGSTR_STREET_NO = ?, \
									HRGSTR_CONTACT_NO = ?, GNUM_CITY_LOC_CODE = (SELECT GNUM_CITY_LOC_CODE FROM GBLT_CITY_LOCATION_MST WHERE UPPER(GSTR_CITY_LOC_NAME) LIKE UPPER(?)), IS_CURRENT_ADDRESSS = ? WHERE HRGNUM_PUK = ?
 
UPDATE.HRGT_EPISODE_DTL=		    UPDATE HRGT_EPISODE_DTL SET HRGNUM_VISIT_TYPE=?, HRGNUM_EPISODE_TYPE_CODE=?, HRGSTR_EPISODE_ACTION_CODE=?, HRGNUM_ADMISSION_NO=?, HRGSTR_MLC_NO=?, GNUM_DEPT_CODE=?, HGNUM_DEPTUNITCODE=?, \
									HRGNUM_QUE_NO=?, HRGNUM_IS_OLD=?, HRGDT_EPISODE_DATE=?, HRGTM_EPISODE_TIME=?, HRGDT_NEXT_VISIT_DATE=?, HRGSTR_NEXT_VISIT_DEPT_CODE=?, HRGNUM_IS_EPISODE_OPEN=?, HRGSTR_COMPLAINED_DTL=?, \
									PSRSTR_EMP_NO=?, PSRSTR_EMP_NAME=?, GNUM_SEAT_ID=?, GDT_ENTRY_DATE=?, HRGNUM_IS_CONFIRMED=?, GNUM_ISVALID=?, HGNUM_ROOM_CODE=?, HGNUM_WARD_CODE=?, HRGNUM_NEXT_VISIT_TYPE=?, \
									HGNUM_NEXT_VISIT_DEPTUNITCODE=?, HRGNUM_REFERRAL_ACCEPTANCE =?, GDT_REFERRAL_ACCEPTANCE_DATE=?  WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? 								   
 
 
UPDATE.HRGT_EPISODE_DTL_FOR_CMO=    UPDATE HRGT_EPISODE_DTL SET HRGNUM_IS_EPISODE_OPEN=?, HRGNUM_IS_CONFIRMED=? \
									WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND GNUM_HOSPITAL_CODE=? 								   
 


SELECT.GET_AGE_ON=		SELECT TO_CHAR (HRGNUM_PUK), ahis_util.PUK_AGE_ON (HRGNUM_PUK, SYSDATE) AGE FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK=?

 	
SELECT.PREVIOUS_SYSTEM.GET_AGE_ON=		SELECT TO_CHAR (HRGNUM_PUK), ahis_util.PUK_AGE_ON (HRGNUM_PUK, SYSDATE) AGE FROM HRGT_PREV_PATIENT_DTL WHERE HRGNUM_PUK=?


INSERT.HRGT_EPISODE_CLOSE_DTL=		INSERT INTO HRGT_EPISODE_CLOSE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_EPISODE_TYPE_CODE, HRGNUM_ADMISSION_NO, HRGDT_EPISODE_OPEN_DATE, HRGDT_EPISODE_CLOSE_DATE, \
									HRGNUM_EPISODE_CLOSE_TYPE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_ISAUTO_CLOSE, GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,TO_DATE(?,'dd-Mon-yyyy'),TO_DATE(SYSDATE,'dd-Mon-yyyy'),?,?,?,SYSDATE,?,?)

UPDATE.HRGT_EPISODE_CLOSE_DTL	=	Update HRGT_EPISODE_CLOSE_DTL set GNUM_ISVALID=?  where HRGNUM_PUK=? and HRGNUM_EPISODE_CODE=? and GNUM_HOSPITAL_CODE=? 


INSERT.HRGT_EPISODE_DEATH_DTL	=	INSERT INTO HRGT_EPISODE_DEATH_DTL \
									(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, \
									HRGNUM_ADMISSION_NO, HRGNUM_CURRENT_DEPT_CODE, \
									HRGNUM_CURRENT_UNIT_CODE, HRGNUM_CURRENT_WARD_CODE, \
									HRGNUM_CURRENT_BED_CODE, HRGDT_DEATH_DATE, HRGDT_DEATH_TIME, \
									HRGSTR_DEATH_CAUSE, HRGSTR_ATTEND_CONSULTANT_ID, \
									HRGSTR_CONSULTANT_REMARK, HRGSTR_BODY_HANDOVER_TO, \
									HRGDT_BODY_HANDOVER_DATE, HRGSTR_BODY_HANDOVER_TIME, \
									HRGSTR_RELATIVE_NAME, HRGSTR_RELATIVE_ADDRESS, \
									GNUM_RELATIVECODE, GNUM_ISVALID, GNUM_SEAT_ID, HRGSTR_FNAME, \
									HRGSTR_MNAME, HRGSTR_LNAME, HRGSTR_AGE, GNUM_GENDER_CODE, \
									HGNUM_PATIENT_CAT_CODE, HGNUM_TREATMENT_CAT_CODE, \
									HRGT_EPISODE_DATE, HRGSTR_FATHER_NAME, HRGNUM_MANNER_OF_DEATH, \
									HRGDT_DEATH_VERIFICATION_DATE, GNUM_HOSPITAL_CODE) \
									VALUES(?,?,?,?,?,?,?,?,TO_DATE (?, 'dd-Mon-yyyy'),?,INITCAP(?),?,?,?,TO_DATE (?, 'dd-Mon-yyyy'),?,INITCAP(?),?,?,?,?,INITCAP(?),INITCAP(?),INITCAP(?),?,?,?,?,TO_DATE (?, 'dd-Mon-yyyy'),INITCAP(?),?,TO_DATE (?, 'dd-Mon-yyyy'),?)                                

INSERT.HRGT_EPISODE_ACTION_DTL=		INSERT INTO HRGT_EPISODE_ACTION_DTL (HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_PUK, HRGSTR_EPISODE_ACTION_CODE, GNUM_DIAGNOSTIC_TYPE_CODE, HRGSTR_DIAGNOSTIC_DESC, \
									HRGSTR_COMPLAINED_DTL, HRGSTR_REMARKS, HRGDT_EPISODE_DATE, HRGTM_EPISODE_TIME, GNUM_DEPT_CODE, HGNUM_WARD_CODE,  \
									GDT_ENTRY_DATE,GNUM_ISVALID, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE) VALUES (?,?,?,?,?,?,?,?,to_date(?,'dd-MM-yyyy'),?,?,?,sysdate,?,?,?)
									
																	    
INSERT.HRGT_EPISODE_DIAGNOSIS_DTL=	INSERT INTO HRGT_EPISODE_DIAGNOSIS_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HRGNUM_ADMISSION_NO, HRGNUM_VISIT_NO, GNUM_DIAGNOSTIC_TYPE_CODE, HRGNUM_DIAGNOSTIC_CODE, \
									GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID,HRGT_EPISODE_DATE, HRGSTR_REMARKS,HRGNUM_DIAGNOSIS_CODE_TYPE,GNUM_HOSPITAL_CODE,HBNUM_ISREPEAT,HGNUM_DISEASE_SITE_ID) VALUES(?,?,(select NVL (MAX (HRGNUM_S_NO),0)+1 from HRGT_EPISODE_DIAGNOSIS_DTL where HRGNUM_EPISODE_CODE=? and HRGNUM_PUK=? AND HRGNUM_VISIT_NO=?),?,?,?,?,?,sysdate,?,TO_DATE(?,'dd-Mon-yyyy'),?,?,?,?,?)

                 		                                												
ESSENTIAL.DIAGNOSIS_TREE=		SELECT A.HGBSTR_ICD_GROUP_CODE || ' '|| INITCAP (A.HGBSTR_ICD_GROUP) ICDGROUP, B.HGBSTR_ICD_SUBGRP_CODE ||' '||INITCAP (B.HGBSTR_ICD_SUBGROUP) ICDSUBGROUP, \
								TRIM(C.HGBSTR_DISEASE_CODE)|| '|'|| TRIM(INITCAP(C.HGBSTR_DISEASE)) ICDDISEASE FROM HGBT_ICD_DISEASE_MST C, HGBT_ICD_GROUP_MST A,HGBT_ICD_SUBGROUP_MST B \
								WHERE A.HGBSTR_ICD_GROUP_CODE = B.HGBSTR_ICD_GROUP_CODE AND B.HGBSTR_ICD_SUBGRP_CODE = C.HGBSTR_ICD_SUBGRP_CODE ORDER BY ICDGROUP, ICDSUBGROUP, ICDDISEASE
					                 

//----------------query-Changed----------	
SELECT.HRGT_DEPT_UNIT_ROOM_MST.OPD_VISIT_11Apr_09 = SELECT a.hgnum_deptunitcode AS departmentunitcode,a.gnum_dept_code AS departmentcode, a.hgnum_room_code AS roomcode,(1) AS queno, a.hrgnum_capacity - 1 AS patientallowed, (SELECT INITCAP (n.hgstr_room_name) FROM hgbt_room_mst n WHERE n.hgnum_room_code = a.hgnum_room_code and n.gnum_hospital_code=a.gnum_hospital_code) room, \
												   (SELECT INITCAP (o.hgstr_unitname) FROM hgbt_unit_mst o WHERE o.hgnum_deptunitcode = a.hgnum_deptunitcode  and o.gnum_hospital_code=a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentunit FROM hrgt_dept_unit_room_mst a WHERE a.hgnum_deptunitcode = ? \
												   AND a.gnum_isvalid = ? AND a.gnum_hospital_code=? and a.HGNUM_ROOM_CODE =? AND a.hrgnum_sequence <= ALL (SELECT b.hrgnum_sequence FROM hrgt_dept_unit_room_mst b WHERE b.gnum_hospital_code=a.gnum_hospital_code and b.hgnum_deptunitcode = ? AND b.gnum_isvalid = ? and b.HGNUM_ROOM_CODE =?)
				                 
SELECT.HRGT_DEPT_UNIT_ROOM_MST.OPD_VISIT=	SELECT a.hgnum_deptunitcode AS departmentunitcode,a.gnum_dept_code AS departmentcode, a.hgnum_room_code AS roomcode,(1) AS queno, a.hrgnum_capacity - 1 AS patientallowed, \
											(SELECT INITCAP (n.hgstr_room_name) FROM hgbt_room_mst n WHERE n.hgnum_room_code = a.hgnum_room_code and n.gnum_hospital_code=a.gnum_hospital_code) room, \
											(SELECT INITCAP (o.hgstr_unitname) FROM hgbt_unit_mst o WHERE o.hgnum_deptunitcode = a.hgnum_deptunitcode  and o.gnum_hospital_code=a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
											AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentunit FROM hrgt_dept_unit_room_mst a WHERE a.hgnum_deptunitcode = ? AND a.gnum_isvalid = ? \
											AND a.gnum_hospital_code=? AND a.hrgnum_sequence <= ALL (SELECT b.hrgnum_sequence FROM hrgt_dept_unit_room_mst b WHERE b.gnum_hospital_code=a.gnum_hospital_code and b.hgnum_deptunitcode = ? AND b.gnum_isvalid = ? and b.HGNUM_ROOM_CODE =?)
					                 											

INSERT.HRGT_EPISODE_REFFER_DTL=		INSERT INTO HRGT_EPISODE_REFFER_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_S_NO, HRGNUM_ADMISSION_NO, HRGSTR_IS_REFF_IN_OUT, \
									HRGNUM_REFF_DEPT_CODE, HRGNUM_REFF_WARD_CODE, HRGNUM_REFF_HOSPITAL_CODE, HRGSTR_REFF_HOSPITAL_NAME, HRGDT_REFF_DATE_TIME, GNUM_SEAT_ID, GDT_ENTRY_DATE, \
									GNUM_ISVALID, HRGSTR_EXT_HOSP_DOCT_NAME, HRGSTR_IP_ADD, HRGSTR_PREV_EPISODE_CODE, HRGNUM_PREV_VISIT_NO, HRGNUM_EXT_HOSPITAL_CRNO, HRGNUM_EXT_HOSPITAL_DEPT, \
									HRGNUM_EXT_HOSPITAL_DEPT_UNIT,HRGSTR_REF_DOCT_CODE,GNUM_HOSPITAL_CODE) VALUES (?,?,(SELECT NVL (MAX (HRGNUM_VISIT_NO),0) FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?), \
									(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_EPISODE_REFFER_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE = ?),?,?,?,?,?,?,sysdate,?,sysdate,?,?,?,?,?,?,?,?,?,?)



UPDATE.HRGT_EPISODE_REFFER_DTL=		UPDATE HRGT_EPISODE_REFFER_DTL SET HRGNUM_ADMISSION_NO=?, HRGSTR_IS_REFF_IN_OUT=?, HRGNUM_REFF_DEPT_CODE=?, HRGNUM_REFF_WARD_CODE=?, HRGNUM_REFF_HOSPITAL_CODE=?, \
									HRGSTR_REFF_HOSPITAL_NAME=?, HRGDT_REFF_DATE_TIME=?, GNUM_ISVALID=?, HRGSTR_EXT_HOSP_DOCT_NAME=? HRGSTR_PREV_EPISODE_CODE=?, HRGNUM_PREV_VISIT_NO=? , \
									HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEPT=?, HRGNUM_EXT_HOSPITAL_DEPT_UNIT=? WHERE  HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?
									
									
UPDATE.REFERRAL_ACEEPT_DATE.HRGT_EPISODE_DTL=	UPDATE HRGT_EPISODE_DTL SET GDT_REFERRAL_ACCEPTANCE_DATE = sysdate WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO=?									 

SELECT.SYSDATE=		SELECT to_char(SYSDATE,'dd-mon-yyyy') FROM DUAL


UPDATE.HRGT_DAILY_PATIENT_DTL=	UPDATE HRGT_DAILY_PATIENT_DTL SET HRGSTR_PREV_PUK=?, HRGNUM_ID_NO=?, HRGDT_DOB=?, HRGNUM_IS_MLC=?, HRGNUM_IS_ACTUAL_DOB=?, HRGSTR_FNAME=?, HRGSTR_MNAME=?, HRGSTR_LNAME=?, GNUM_GENDER_CODE=?, GNUM_MARITAL_STATUS_CODE=?, \
								GNUM_RELIGION_CODE=?, HRGSTR_FATHER_NAME=?, HRGSTR_MOMNAME=?, HRGNUM_ISUNKNOWN=?, HRGNUM_MONTH_INCOME=?, HRGNUM_IS_URBAN=?, HRGNUM_IS_REF=?, HRGNUM_EXT_HOSPITAL_CODE=?, HRGSTR_EXT_HOSP_DOCT_NAME=?, \
								HRGNUM_IS_LOCAL=?, HRGSTR_HOUSE_NO=?, GNUM_CITY_LOC_CODE=?, HRGSTR_DISTRICT=?, NUM_DIST_ID=?, HRGSTR_CITY=?, GNUM_STATECODE=?,HRGSTR_STATE_NAME=?, GNUM_COUNTRYCODE=?, HRGNUM_PIN=?, HRGSTR_IP_ADD=?, HRGSTR_CONTACT_NO=?, HRGSTR_EXT_HOSPITAL_NAME=?, \
								HRGNUM_ADD_TYPE_CODE=?, HGNUM_PATIENT_CAT_CODE=?, HRGSTR_CITY_LOCATION=?,GNUM_NATIONALITY_CODE=?, HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEP=?, HRGNUM_EXT_HOSPITAL_DEPT_UNIT=?, HRGSTR_SPOUSENAME=?, HRGSTR_NATIONAL_ID=?, \
								HBNUM_BLDGRP_CODE=?, HRGNUM_ISNEWBORN=?,HRGSTR_PAT_OCCUPATION=?,HRGSTR_FAT_OCCUPATION=?,HRGSTR_HUS_OCCUPATION=?,HRGSTR_NICKNAME=?,HRGSTR_CARD_NO=?, HRGNUM_MOTHER_PUK=?, HRGNUM_IS_BROUGHTDEAD=?, HGNUM_PAT_STATUS_CODE=? WHERE HRGNUM_PUK=? AND TO_CHAR(GDT_ENTRY_DATE, 'dd/mm/yyyy')=TO_CHAR(SYSDATE, 'dd/mm/yyyy')	AND GNUM_HOSPITAL_CODE=?								
		
INSERT_FOR_ALL.HRGT_CATEGORY_CHANGE_DTL=	INSERT INTO HRGT_CATEGORY_CHANGE_DTL (HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_PREV_PAT_PRI_CAT_CODE, HRGNUM_PREV_PAT_SEC_CAT_CODE, HRGNUM_NEW_PAT_PRI_CAT_CODE, HRGNUM_NEW_PAT_SEC_CAT_CODE, GDT_CHANGE_DATE, \
											HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, HRGSTR_IP_ADD, HRGNUM_EPISODE_CODE,GNUM_HOSPITAL_CODE) VALUES (?,(SELECT NVL (MAX (HRGNUM_S_NO),0)+1 FROM HRGT_CATEGORY_CHANGE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?),?,?,?,?,sysdate,?,sysdate,?,?,?,?,?)
											
INSERT.HRGT_CATEGORY_CHANGE_DTL=	INSERT INTO HRGT_CATEGORY_CHANGE_DTL (HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_PREV_PAT_PRI_CAT_CODE, HRGNUM_PREV_PAT_SEC_CAT_CODE, HRGNUM_NEW_PAT_PRI_CAT_CODE, HRGNUM_NEW_PAT_SEC_CAT_CODE, GDT_CHANGE_DATE, \
									HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, HRGSTR_IP_ADD, HRGNUM_EPISODE_CODE,GNUM_HOSPITAL_CODE) VALUES (?,(SELECT NVL (MAX (HRGNUM_S_NO),0)+1 FROM HRGT_CATEGORY_CHANGE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?),?,?,?,?,sysdate,?,sysdate,?,?,?,?,?)
											

INSERT.HRGT_UNKNOWN_CHANGE_DTL=		INSERT INTO HRGT_UNKNOWN_CHANGE_DTL (HRGNUM_PUK, GDT_UNKNOWN_CONVERSION_DATE, PSRSTR_EMP_NO, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, HRGSTR_IP_ADD, HRGSTR_FNAME, HRGSTR_MNAME, \
									HRGSTR_LNAME, HRGSTR_AGE, HRGDT_DOB, GNUM_GENDER_CODE, HGNUM_PATIENT_CAT_CODE, HGNUM_TREATMENT_CAT_CODE, HRGSTR_FHNAME, HRGSTR_HOUSE_NO, HRGSTR_STREET_NO, HRGSTR_CITY, GNUM_STATE_CODE, \
									GNUM_NATIONALITY_CODE,GNUM_HOSPITAL_CODE,HRGNUM_VERIFICATION_SLNO,HRGNUM_CHANGE_REQ_BY, HRGSTR_CHANGE_REQBY_NAME, HRGSTR_CHANGE_REQBY_ADD, GNUM_RELATION_CODE, HRGSTR_CONSTABLE_BADGENO, HRGSTR_CONSTABLE_DESIG) \
									VALUES (?,sysdate,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)


SELECT.BY_EPISODE_NO.HRGT_EPISODE_DTL=	SELECT a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode,a.hrgnum_admission_no AS admissionno, \
										a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-yyyy' ) AS episodenextvisitdate, \
       									a.hrgnum_is_episode_open AS episodeisopen, a.psrstr_doc_emp_no AS empno,a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') AS entrydate, a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid, \
       									a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode, a.hrgnum_is_ref AS episodereferaccept, a.hgnum_treatment_cat_code AS patsecondarycatcode, a.hgnum_patient_cat_code AS patprimarycatcode, \
       									(SELECT INITCAP (g.gstr_dept_name) FROM gblt_department_mst g  WHERE g.gnum_dept_code = a.gnum_dept_code AND g.gnum_hospital_code = a.gnum_hospital_code  AND g.gnum_isvalid = 1) department \
  										FROM hrgt_episode_dtl a WHERE a.HRGNUM_PUK = ? AND a.HRGNUM_EPISODE_CODE = ? AND a.GNUM_HOSPITAL_CODE=? AND a.HRGNUM_VISIT_NO = ALL ( SELECT MIN (HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND GNUM_HOSPITAL_CODE=?)

UPDATE.REFER_DTL_MRD.HRGT_EPISODE_REFFER_DTL=	UPDATE HRGT_EPISODE_REFFER_DTL SET HRGNUM_REFF_HOSPITAL_CODE=?, HRGSTR_REFF_HOSPITAL_NAME=?, HRGDT_REFF_DATE_TIME=?, HRGSTR_EXT_HOSP_DOCT_NAME=?, HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEPT=?, \
												HRGNUM_EXT_HOSPITAL_DEPT_UNIT=? WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ?

												
UPDATE.REF_DTL_MRD.HRGT_PATIENT_DTL=	UPDATE HRGT_PATIENT_DTL SET HRGNUM_REF_HOSPITAL_CODE=?, HRGSTR_EXT_HOSPITAL_NAME=?, HRGSTR_REF_DOCTOR_NAME=?, HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEPT=?, HRGNUM_EXT_HOSPITAL_DEPT_UNIT=? WHERE HRGNUM_PUK = ?

UPDATE.REF_DTL_REG.HRGT_EPISODE_REFFER_DTL=		UPDATE HRGT_EPISODE_REFFER_DTL SET HRGNUM_REFF_HOSPITAL_CODE=?, HRGSTR_REFF_HOSPITAL_NAME=?, HRGDT_REFF_DATE_TIME=?, HRGSTR_EXT_HOSP_DOCT_NAME=?, HRGNUM_EXT_HOSPITAL_CRNO=?, HRGNUM_EXT_HOSPITAL_DEPT=?, \
												HRGNUM_EXT_HOSPITAL_DEPT_UNIT=? WHERE HRGNUM_PUK = ? AND TO_CHAR(GDT_ENTRY_DATE, 'dd-mon-yyyy') LIKE TO_CHAR( SYSDATE, 'dd-mon-yyyy')


UPDATE.REF_DTL_REG.HRGT_EPISODE_DTL=	UPDATE HRGT_EPISODE_DTL SET HRGNUM_REFERRAL_ACCEPTANCE=?, HGNUM_TREATMENT_CAT_CODE=?, HGNUM_PATIENT_CAT_CODE=? WHERE HRGNUM_PUK = ? AND TO_CHAR(GDT_ENTRY_DATE, 'dd-mon-yyyy') LIKE TO_CHAR( SYSDATE, 'dd-mon-yyyy') AND GNUM_HOSPITAL_CODE=?


SELECT.BY_EPISODE_NO.HRGT_EPISODE_REFFER_DTL=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_S_NO AS SERIALNO, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, \
												A.HRGSTR_IS_REFF_IN_OUT AS ISREFFERINOUT, A.HRGNUM_REFF_DEPT_CODE AS DEPTCODE, A.HRGNUM_REFF_WARD_CODE AS WARDCODE, A.HRGNUM_REFF_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, \
												A.HRGSTR_REFF_HOSPITAL_NAME AS PATREFHOSPITALNAME, A.HRGDT_REFF_DATE_TIME AS REFFDATETIME, A.GNUM_SEAT_ID AS SEATID, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_ISVALID AS ISVALID, \
												A.HRGSTR_EXT_HOSP_DOCT_NAME AS PATREFDOCTOR, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_PREV_EPISODE_CODE AS PREVEPISODECODE, A.HRGNUM_PREV_VISIT_NO AS PREVEPISODEVISITNO, \
												A.HRGT_EPISODE_DATE AS EPISODEDATE, A.HRGNUM_EXT_HOSPITAL_CRNO AS PATREFGNCTDHOSPITALCRNO, A.HRGNUM_EXT_HOSPITAL_DEPT AS PATREFGNCTDHOSPITALDEPT, \
												A.HRGNUM_EXT_HOSPITAL_DEPT_UNIT AS PATREFGNCTDHOSPITALDEPTUNIT, (SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.HRGNUM_REFF_DEPT_CODE) DEPTNAME \
												FROM HRGT_EPISODE_REFFER_DTL A WHERE A.HRGNUM_PUK = ? AND A.HRGNUM_EPISODE_CODE = ? AND \
												A.HRGNUM_VISIT_NO = ALL ( SELECT MIN (HRGNUM_VISIT_NO) FROM HRGT_EPISODE_REFFER_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ?)


SELECT.REFERRED_TO_DEPT.HRGT_EPISODE_REFFER_DTL=	SELECT DISTINCT A.GNUM_DEPT_CODE, INITCAP (A.GSTR_DEPT_NAME), B.HRGNUM_REFF_DEPT_CODE FROM GBLT_DEPARTMENT_MST A, HRGT_EPISODE_REFFER_DTL B WHERE A.GNUM_ISVALID = ? \
													AND A.GNUM_DEPT_CODE = B.HRGNUM_REFF_DEPT_CODE AND B.HRGSTR_IS_REFF_IN_OUT = ? AND B.HRGNUM_PUK = ?
													

SELECT.LIST.OPEN_EPISODE_DEPT.HRGT_EPISODE_DTL=		SELECT A.GNUM_DEPT_CODE AS DEPARTMENTCODE, (SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT \
													FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?) AND (A.GNUM_ISVALID = ?) AND A.HRGNUM_EPISODE_CODE NOT IN \
													(SELECT N.HRGNUM_EPISODE_CODE FROM HRGT_EPISODE_DTL N WHERE (N.HRGNUM_PUK = ?) AND (N.HRGNUM_IS_EPISODE_OPEN = ?) AND (N.GNUM_ISVALID = ?)) \
													AND A.HRGNUM_VISIT_NO >= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))

UPDATE.REFERRAL_ACCEPTANCE_DATE.HRGT_EPISODE_DTL=	UPDATE HRGT_EPISODE_DTL SET GDT_REFERRAL_ACCEPTANCE_DATE=SYSDATE WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?


SELECT.HRGT_UNKNOWN_CHANGE_DTL= 		  Select HRGNUM_PUK as patCrNo, GDT_UNKNOWN_CONVERSION_DATE as unknownConversionDate, PSRSTR_EMP_NO as empNo, GDT_ENTRY_DATE as entryDate, GNUM_ISVALID as isValid, \
			                              GNUM_SEAT_ID as seatId, HRGSTR_IP_ADD as systemIPAddress , HRGSTR_FNAME as patFirstName, HRGSTR_MNAME as patMiddleName, HRGSTR_LNAME as patLastName, \
			                              HRGSTR_AGE as patAge, HRGDT_DOB as patDOB, GNUM_GENDER_CODE as patGenderCode, HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, \
			                              HGNUM_TREATMENT_CAT_CODE as patSecondaryCatCode, HRGSTR_FHNAME as patGuardianName, \
			                              HRGSTR_HOUSE_NO as patAddHNo, HRGSTR_STREET_NO as patAddStreet, HRGSTR_CITY as patAddCity, GNUM_STATE_CODE as patAddState, GNUM_NATIONALITY_CODE as patNationalityCode \
			                              from HRGT_UNKNOWN_CHANGE_DTL where HRGNUM_PUK =? and GNUM_ISVALID =? AND GNUM_HOSPITAL_CODE=?


SELECT.REFERRED_FROM_DEPT.HRGT_EPISODE_REFFER_DTL=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_S_NO AS SERIALNO, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_IS_REFF_IN_OUT AS ISREFFERINOUT, \
													A.HRGNUM_REFF_DEPT_CODE AS DEPARTMENTCODE, A.HRGNUM_REFF_WARD_CODE AS WARDCODE, A.HRGNUM_REFF_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, A.HRGSTR_REFF_HOSPITAL_NAME AS PATREFHOSPITALNAME, A.HRGDT_REFF_DATE_TIME AS REFFDATETIME, \
													A.GNUM_SEAT_ID AS SEATID, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_ISVALID AS ISVALID, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_PREV_EPISODE_CODE AS PREVEPISODECODE, \
													A.HRGNUM_PREV_VISIT_NO AS PREVEPISODEVISITNO, A.HRGT_EPISODE_DATE AS EPISODEDATE, \
													(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.HRGNUM_REFF_DEPT_CODE) DEPARTMENT, \
													(DECODE ((SELECT HOPNUM_DEPTUNITCODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPDT_START_DT < SYSDATE AND HOPDT_END_DT > SYSDATE AND (SUBSTR(HOPNUM_DEPTUNITCODE,1,8) = SUBSTR ((SELECT HGNUM_DEPTUNITCODE FROM HRGT_EPISODE_DTL \
													WHERE HRGNUM_PUK = A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE AND HRGNUM_VISIT_NO >= ALL ( SELECT HRGNUM_VISIT_NO FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK = A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE)), 1,8 ) )), NULL, 0, 1 ) ) DEPTUNITISONDUTY, \
													(DECODE ((SELECT M.GDT_ENTRY_DATE FROM HRGT_EPISODE_DTL M WHERE TO_CHAR (M.GDT_ENTRY_DATE, 'dd-mon-yyyy') = TO_CHAR (SYSDATE, 'dd-mon-yyyy') AND M.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE AND M.HRGNUM_PUK = A.HRGNUM_PUK), NULL, 0, 1 ) ) VISITEDTODAY \
													FROM HRGT_EPISODE_REFFER_DTL A WHERE A.HRGNUM_PUK = ? AND A.HRGNUM_EPISODE_CODE IN ( SELECT HRGNUM_EPISODE_CODE FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_IS_EPISODE_OPEN = ?) AND A.GNUM_ISVALID = ? AND HRGSTR_IS_REFF_IN_OUT = ?


UPDATE_ALL.PRIMARY_CATEGORY.HRGT_EPISODE_DTL=	UPDATE HRGT_EPISODE_DTL SET HGNUM_PATIENT_CAT_CODE=? WHERE HRGNUM_PUK=? AND HRGNUM_IS_EPISODE_OPEN = ?


UPDATE.HRGT_PATIENT_MLC_DTL.IMAGEUPLOAD=UPDATE HRGT_PATIENT_MLC_DTL SET HRGNUM_IS_IMAGEUPLOADED =?\
										WHERE HRGNUM_PUK = ? AND HRGSTR_MLC_NO = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_S_NO =? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ? 												

UPDATE.SECONDARY_CATEGORY.HRGT_EPISODE_DTL=	UPDATE HRGT_EPISODE_DTL SET HGNUM_TREATMENT_CAT_CODE=? WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=(SELECT MAX(HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?) 												

												

SELECT.RETRIEVE_ALL_BY_CRNO.HRGT_EPISODE_DTL=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, \
												A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY') AS EPISODENEXTVISITDATE, \
												A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, \
												A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, \
												GDT_REFERRAL_ACCEPTANCE_DATE AS EPISODEREFERACCEPTDATE, HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, HGNUM_PATIENT_CAT_CODEAS PATPRIMARYCATCODE, (SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
												(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, (SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
												(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, (SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, (SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT \
												FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) AND A.HRGNUM_VISIT_NO >= ALL ( SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))
												
//-------------------Query-Changed-----------
SELECT.PATIENT_IS_MLC_22_apr_09	 =  	SELECT  distinct nvl(HRGSTR_MLC_NO,'Yet TO Be Alloted') FROM hrgt_episode_dtl WHERE hrgnum_episode_type_code = ? AND gnum_isvalid = ? AND gnum_hospital_code = ? and  HRGNUM_IS_EPISODE_OPEN=? AND hrgnum_puk = ?
	
---------------------------------	
											  
SELECT.PATIENT_IS_MLC17-11-09 =         SELECT DISTINCT NVL (hrgstr_mlc_no, 'Yet TO Be Alloted')||' ('||decode(hrgstr_mlc_no,null,' ',(select to_char(HRGDT_MLC_DATE,'DD-Mon-YYYY') from HRGT_PATIENT_MLC_DTL where HRGNUM_PUK=a.hrgnum_puk and HRGNUM_EPISODE_CODE=a.HRGNUM_EPISODE_CODE and HRGNUM_VISIT_NO=HRGNUM_VISIT_NO and gnum_isvalid=1 and GNUM_HOSPITAL_CODE=a.gnum_hospital_code ))||')' \
								FROM hrgt_episode_dtl a  WHERE a.hrgnum_episode_type_code = ?  AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ? AND a.hrgnum_is_episode_open = ? AND a.hrgnum_puk = ?  

SELECT.PATIENT_IS_MLC=	SELECT DISTINCT    NVL (hrgstr_mlc_no, 'Yet TO Be Alloted') || ' (' || DECODE (hrgstr_mlc_no, NULL, ' ', (SELECT TO_CHAR (hrgdt_mlc_date, 'DD-Mon-YYYY') FROM hrgt_patient_mlc_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgstr_mlc_no = a.hrgstr_mlc_no \
						AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)) || ')' FROM hrgt_episode_dtl a WHERE a.hrgnum_episode_type_code = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ? AND a.hrgnum_is_episode_open = ? \
						AND a.hrgnum_puk = ? AND a.hrgnum_visit_no IN ( SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl b WHERE hrgnum_episode_code = a.hrgnum_episode_code AND b.gnum_isvalid =a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code AND b.hrgnum_puk = a.hrgnum_puk)								
										  
SELECT.LASTEPISODE.EMERGENCY.HRGT_EPISODE_DTL18-11-09=select HRGNUM_EPISODE_CODE as EPISODECODE,HRGNUM_REFERRAL_ACCEPTANCE as episodeReferAccept,HRGNUM_VISIT_NO as episodeVisitNo, to_char(HRGDT_EPISODE_DATE,'dd-Mon-yyyy hh24:mi') as episodeDate \
 											  from HRGT_EPISODE_DTL A where GDT_ENTRY_DATE=(select max(GDT_ENTRY_DATE) from HRGT_EPISODE_DTL \
											  where HRGNUM_PUK=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? and(HRGNUM_EPISODE_TYPE_CODE=? or HRGNUM_EPISODE_TYPE_CODE=?))\
											  and HRGNUM_PUK=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? \
											  AND (SELECT HGNUM_ISGENERAL FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE=A.HGNUM_DEPTUNITCODE AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ? \
											  AND gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) = ?									
														
SELECT.LASTEPISODE.EMERGENCY.HRGT_EPISODE_DTL=	SELECT hrgnum_episode_code AS episodecode, hrgnum_referral_acceptance AS episodereferaccept, hrgnum_visit_no AS episodevisitno, \
												TO_CHAR (GDT_ENTRY_DATE, 'dd-Mon-yyyy hh24:mi') AS episodedate FROM hrgt_episode_dtl a  where  a.hrgnum_puk = ? AND a.gnum_isvalid = ? \
												AND a.gnum_hospital_code = ? and a.HRGSTR_MLC_NO is null AND (a.hrgnum_episode_type_code = ?  OR a.hrgnum_episode_type_code = ? ) \
												and gdt_entry_date = (SELECT MAX (gdt_entry_date) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid \
												AND gnum_hospital_code = a.gnum_hospital_code AND (hrgnum_episode_type_code = ? OR hrgnum_episode_type_code = ? ))
																							

SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_NAME.ADD_TYPE=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_CITY AS patAddCity, INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, \
														A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, A.HRGSTR_HOUSE_NO AS patAddHNo, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
														FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE UPPER(F.HRGSTR_FNAME) LIKE UPPER(?))) AND (A.GNUM_ISVALID = ?)								

SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_NAME.ADD_TYPE1=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
														INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
														A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_LOCAL AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
														(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
														FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE F.HRGSTR_FNAME LIKE ?))   AND (A.GNUM_ISVALID = ?)								



SELECT.DEPT_UNIT_SHIFT_WISE.HOPT_DEPT_UNIT_ROSTER_MST=	SELECT a.hgnum_deptunitcode AS departmentunitcode, a.hopnum_week_of_month AS weekofmonth, a.hopnum_day_of_week AS dayofweek, a.hgnum_shift_code AS shiftcode, \
														a.hgnum_unit_seq_no AS unitsequenceno, a.hopstr_opd_name AS opdname, a.gnum_isvalid AS isvalid, TO_CHAR (a.hgdt_effect_date, 'dd-Mon-yyyy') AS effectdate, \
														a.hopdt_inactive_from_date AS inactivefromdate, a.hopdt_inactive_till_date AS inactivetilldate, SUBSTR (a.hgnum_deptunitcode, 1, 3) AS departmentcode, \
														a.gdt_entry_date AS entrydate, a.gnum_seat_id AS seatid, (SELECT INITCAP (b.gstr_dept_name) FROM gblt_department_mst b WHERE gnum_isvalid=1 and b.gnum_dept_code = SUBSTR (a.hgnum_deptunitcode, 1, 3) \
														AND (    gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ) AND b.gnum_hospital_code = ?) department, \
														(SELECT INITCAP (d.hgstr_unitname) FROM hgbt_unit_mst d WHERE gnum_isvalid=1 and d.hgnum_deptunitcode = a.hgnum_deptunitcode AND (    gdt_effective_frm <= TRUNC (SYSDATE) \
														AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ) AND d.gnum_hospital_code = ?) departmentunit, (SELECT INITCAP (c.hrgstr_shift_desc) FROM gblt_shift_mst c \
														WHERE c.hgnum_shift_code = a.hgnum_shift_code AND c.gnum_hospital_code = ? AND c.GBLT_SHIFT_TYPE=?) shift ,HRGNUM_ROOM_USABILITY  roomUsability , \
													    hrgnum_capacity as  roomCapcity,(SELECT hrgnum_capacity    FROM hrgt_dept_unit_room_mst   WHERE hgnum_deptunitcode =a.hgnum_deptunitcode  AND hgnum_room_code = a.HGNUM_ROOM_CODE    AND gnum_isvalid = a.gnum_isvalid \
													    AND gnum_hospital_code = a.gnum_hospital_code)  AS roomCapacityInUnitRoomMst FROM hopt_dept_unit_roster_mst a \
													   	WHERE a.hgnum_deptunitcode = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ?  and hgnum_shift_code in (SELECT hgnum_shift_code \
         												FROM gblt_shift_mst WHERE hgnum_shift_code = a.hgnum_shift_code AND gnum_hospital_code = a.gnum_hospital_code AND gblt_shift_type = 1 and gnum_isvalid=a.gnum_isvalid) \
         												and HGNUM_ROOM_CODE=? 
   
													

SELECT.DEPT_SHIFT_UNIT_WISE.HOPT_DEPT_UNIT_ROSTER_MST=	SELECT A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HOPNUM_WEEK_OF_MONTH AS WEEKOFMONTH, \
														A.HOPNUM_DAY_OF_WEEK AS DAYOFWEEK, A.HGNUM_SHIFT_CODE AS SHIFTCODE, A.HGNUM_UNIT_SEQ_NO AS \
														UNITSEQUENCENO, A.HOPSTR_OPD_NAME AS OPDNAME, A.GNUM_ISVALID AS ISVALID, A.HGDT_EFFECT_DATE \
														AS EFFECTDATE, A.HOPDT_INACTIVE_FROM_DATE AS INACTIVEFROMDATE, A.HOPDT_INACTIVE_TILL_DATE AS \
														INACTIVETILLDATE, SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AS DEPARTMENTCODE, A.GDT_ENTRY_DATE AS \
														ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, (SELECT INITCAP (B.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST B \
														WHERE B.GNUM_DEPT_CODE = SUBSTR(A.HGNUM_DEPTUNITCODE, 1, 3) AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code   AND gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ) DEPARTMENT, \
														(SELECT INITCAP (D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE D.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE \
														AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code   AND gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) DEPARTMENTUNIT, \
														(SELECT INITCAP (C.HRGSTR_SHIFT_DESC) FROM GBLT_SHIFT_MST C \
														WHERE C.HGNUM_SHIFT_CODE = A.HGNUM_SHIFT_CODE AND C.GNUM_HOSPITAL_CODE=a.gnum_hospital_code ) SHIFT \
														FROM HOPT_DEPT_UNIT_ROSTER_MST A WHERE SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) = ? AND A.GNUM_HOSPITAL_CODE=? AND a.gnum_isvalid = ?


INSERT.HOPT_DEPT_UNIT_ROSTER_MST_OlD	=	INSERT INTO HOPT_DEPT_UNIT_ROSTER_MST (HGNUM_DEPTUNITCODE, HOPNUM_WEEK_OF_MONTH, \
									HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_UNIT_SEQ_NO, HOPSTR_OPD_NAME, GNUM_ISVALID,HGNUM_ROOM_CODE,HRGNUM_ROOM_SEQUENCE, \
									HGDT_EFFECT_DATE, HOPDT_INACTIVE_FROM_DATE, HOPDT_INACTIVE_TILL_DATE, \
									GDT_ENTRY_DATE, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE) \
									VALUES (?,?,?,?,(SELECT NVL(MAX(HGNUM_UNIT_SEQ_NO),0)+1 FROM \
									HOPT_DEPT_UNIT_ROSTER_MST WHERE substr(hgnum_deptunitcode,1,3)=? \
									AND HOPNUM_WEEK_OF_MONTH=? AND HOPNUM_DAY_OF_WEEK=? AND HGNUM_SHIFT_CODE=? \
									AND GNUM_HOSPITAL_CODE=? and hgnum_deptunitcode<> ?),?,?,?,?, to_date(?,'dd-Mon-yyyy HH24:Mi'), \
									to_date(?,'dd-Mon-yyyy HH24:Mi'),to_date(?,'dd-Mon-yyyy HH24:Mi'),SYSDATE,?,?)																												

INSERT.HOPT_DEPT_UNIT_ROSTER_MST	=	INSERT INTO HOPT_DEPT_UNIT_ROSTER_MST (HGNUM_DEPTUNITCODE, HOPNUM_WEEK_OF_MONTH, \
									HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_UNIT_SEQ_NO, HOPSTR_OPD_NAME, GNUM_ISVALID,HGNUM_ROOM_CODE,HRGNUM_ROOM_SEQUENCE, \
									HGDT_EFFECT_DATE, HOPDT_INACTIVE_FROM_DATE, HOPDT_INACTIVE_TILL_DATE, \
									GDT_ENTRY_DATE, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE,HRGNUM_CAPACITY) \
									VALUES (?,?,?,?,((substr(?,4,2)::integer)-10),?,?,?,?, to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'), \
									to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'),to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'),SYSDATE,?,?,?)																												


UPDATE.HOPT_DEPT_UNIT_ROSTER_MST=	UPDATE HOPT_DEPT_UNIT_ROSTER_MST SET  HOPSTR_OPD_NAME=?, HGDT_EFFECT_DATE=to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'), HOPDT_INACTIVE_FROM_DATE=to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'), \
									HOPDT_INACTIVE_TILL_DATE=to_date(to_char(?::timestamp,'dd-Mon-yyyy HH24:Mi'),'dd-Mon-yyyy HH24:Mi'), GNUM_ISVALID=1 WHERE HGNUM_DEPTUNITCODE=? AND HOPNUM_WEEK_OF_MONTH=? AND HOPNUM_DAY_OF_WEEK=? AND \
									HGNUM_SHIFT_CODE=? AND GNUM_HOSPITAL_CODE=?	 AND HGNUM_ROOM_CODE=?	 																								


UPDATE.SEQUENCE.HOPT_DEPT_UNIT_ROSTER_MST=	UPDATE HOPT_DEPT_UNIT_ROSTER_MST SET HGNUM_UNIT_SEQ_NO=? WHERE HGNUM_DEPTUNITCODE=? AND HOPNUM_WEEK_OF_MONTH=? AND HOPNUM_DAY_OF_WEEK=? AND HGNUM_SHIFT_CODE=? and GNUM_HOSPITAL_CODE=? 													

SET_ISVALID.HOPT_DEPT_UNIT_ROSTER_MST=		UPDATE HOPT_DEPT_UNIT_ROSTER_MST SET GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=?	AND GNUM_HOSPITAL_CODE=? AND HGNUM_ROOM_CODE=? 																												




SELECT_ALL.DEPT_UNIT_SHIFT_WISE.HOPT_DEPT_UNIT_ROSTER_MST_OLD_24-DEC_09	=	SELECT A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HOPNUM_WEEK_OF_MONTH AS WEEKOFMONTH, \
															A.HOPNUM_DAY_OF_WEEK AS DAYOFWEEK, A.HGNUM_SHIFT_CODE AS SHIFTCODE, A.HGNUM_UNIT_SEQ_NO AS UNITSEQUENCENO, \
															A.HOPSTR_OPD_NAME AS OPDNAME, A.GNUM_ISVALID AS ISVALID, to_char(A.HGDT_EFFECT_DATE, 'dd-Mon-yyyy') AS EFFECTDATE, \
															A.HOPDT_INACTIVE_FROM_DATE AS INACTIVEFROMDATE, A.HOPDT_INACTIVE_TILL_DATE AS INACTIVETILLDATE, \
															SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AS departmentCode, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, \
															(SELECT INITCAP (B.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST B WHERE B.GNUM_DEPT_CODE = SUBSTR(A.HGNUM_DEPTUNITCODE, 1, 3) \
															and b.GNUM_HOSPITAL_CODE = ?) DEPARTMENT,(SELECT INITCAP (D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D \
															WHERE D.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE and d.GNUM_HOSPITAL_CODE = ?) DEPARTMENTUNIT, \
															(SELECT INITCAP (C.HRGSTR_SHIFT_DESC) FROM GBLT_SHIFT_MST C WHERE C.HGNUM_SHIFT_CODE = A.HGNUM_SHIFT_CODE \
															and c.GNUM_HOSPITAL_CODE = ?) SHIFT FROM HOPT_DEPT_UNIT_ROSTER_MST A WHERE A.HGNUM_DEPTUNITCODE=? and a.GNUM_HOSPITAL_CODE = ? AND HGNUM_ROOM_CODE=?	

SELECT_ALL.DEPT_UNIT_SHIFT_WISE.HOPT_DEPT_UNIT_ROSTER_MST=	SELECT A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HOPNUM_WEEK_OF_MONTH AS WEEKOFMONTH, \
															A.HOPNUM_DAY_OF_WEEK AS DAYOFWEEK, A.HGNUM_SHIFT_CODE AS SHIFTCODE, A.HGNUM_UNIT_SEQ_NO AS UNITSEQUENCENO, \
															A.HOPSTR_OPD_NAME AS OPDNAME, A.GNUM_ISVALID AS ISVALID, to_char(A.HGDT_EFFECT_DATE, 'dd-Mon-yyyy') AS EFFECTDATE, \
															A.HOPDT_INACTIVE_FROM_DATE AS INACTIVEFROMDATE, A.HOPDT_INACTIVE_TILL_DATE AS INACTIVETILLDATE, \
															SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AS departmentCode, A.GDT_ENTRY_DATE AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, \
															(SELECT INITCAP (C.HRGSTR_SHIFT_DESC) FROM GBLT_SHIFT_MST C WHERE C.HGNUM_SHIFT_CODE = A.HGNUM_SHIFT_CODE \
															and c.GNUM_HOSPITAL_CODE = ? and gnum_isvalid=?) SHIFT FROM HOPT_DEPT_UNIT_ROSTER_MST A WHERE A.HGNUM_DEPTUNITCODE=? and a.GNUM_HOSPITAL_CODE = ? AND HGNUM_ROOM_CODE=?	



INSERT.HRGT_VERIFICATION_DOC_USED_DTL=		INSERT INTO HRGT_VERIFICATION_DOC_USED_DTL (GNUM_MENU_ID, HRGNUM_PUK, HRGNUM_S_NO, GDT_SUBMISSION_DATE, HRGSTR_VERIFICATION_DOCUMENTS, HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_SEAT_ID, GNUM_ISVALID,GNUM_HOSPITAL_CODE) \
											VALUES (?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_VERIFICATION_DOC_USED_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), SYSDATE, ?,?,SYSDATE,?,?,?)



UPDATE.WITH_ADDRESS_TYPE.HRGT_PATIENT_ADD_DTL=		UPDATE HRGT_PATIENT_ADD_DTL SET GNUM_ADD_TYPE_CODE=?, HRGSTR_CITY = ?, HRGSTR_DISTRICT = ?, GNUM_STATE_CODE = ?, HRGNUM_PINCODE = ?, GNUM_COUNTRY_CODE = ?, GNUM_ISVALID = ?, HRGNUM_IS_LOCAL = ?, \
													HRGSTR_HOUSE_NO = ?, HRGSTR_STREET_NO = ?, HRGSTR_CONTACT_NO = ?, GNUM_CITY_LOC_CODE = ?, IS_CURRENT_ADDRESSS = ?, HRGSTR_CITY_LOCATION=?, HRGNUM_VERIFICATION_SLNO = ?, HRGSTR_MOBILE_NO=?,HRGSTR_FAX_NO=?,HRGSTR_EMAIL_ID=?,HRGSTR_PHONE_NO=?   WHERE (HRGNUM_PUK = ?) AND (HRGNUM_S_NO = ?) AND (GNUM_HOSPITAL_CODE=?)


SELECT.RETRIEVE_REFERRED_ALL_BY_CRNO.HRGT_EPISODE_DTL=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, \
														A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY') AS EPISODENEXTVISITDATE, \
														A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, \
														A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, \
														GDT_REFERRAL_ACCEPTANCE_DATE AS EPISODEREFERACCEPTDATE, HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, (SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
														(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, (SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
														(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, (SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, (SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT \
														FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) AND A.HRGNUM_VISIT_NO >= ALL ( SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?)) AND HRGNUM_IS_REF=? ORDER BY A.HRGNUM_EPISODE_CODE 

														
														
SELECT.RETRIEVE_ALL_OPEN_OPD_EPISODES_BY_CRNO.HRGT_EPISODE_DTL=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, \
																A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY' ) AS EPISODENEXTVISITDATE, \
																A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, \
																A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, \
																GDT_REFERRAL_ACCEPTANCE_DATE AS EPISODEREFERACCEPTDATE, HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, (SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
																(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, (SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, (SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F \
																WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, (SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, (SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT \
																FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) AND (A.HRGNUM_IS_EPISODE_OPEN=?) AND (A.HRGNUM_VISIT_TYPE=?) AND A.HRGNUM_VISIT_NO >= ALL ( SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?)) ORDER BY A.HRGNUM_EPISODE_CODE

																
INSERT.HRGT_PRICAT_CHANGE_DTL=	INSERT INTO HRGT_PRICAT_CHANGE_DTL (HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_PREV_PATIENT_CAT_CODE, HRGNUM_NEW_PATIENT_CAT_CODE, HRGSTR_REMARKS, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,HRGSTR_CARD_NO, \
								HRGNUM_VERIFICATION_SLNO,HRGSTR_ISSUING_AUTHORITY,HRGDT_VALID_UPTO) VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PRICAT_CHANGE_DTL WHERE HRGNUM_PUK=?), ?,?,?,?,SYSDATE,?,?,?,?,?,?,decode(?,0,null,sysdate+?)::timestamp) 


INSERT.HRGT_SECCAT_CHANGE_DTL=	INSERT INTO HRGT_SECCAT_CHANGE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HGNUM_PATIENT_CAT_CODE, HRGNUM_PREV_TREATMENT_CAT_CODE, HRGNUM_NEW_TREATMENT_CAT_CODE, HRGSTR_REMARKS, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,HRGDT_VALID_UPTO) VALUES (?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_SECCAT_CHANGE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?),?,?,?,?,?,SYSDATE,?,?,?,decode(?,0,null,sysdate+to_number(nvl(?,0)::numeric))::timestamp)


SELECT.GET_FILE_NO.HRGT_EPISODE_DTL=	SELECT DISTINCT GNUM_DEPT_CODE, HRGSTR_FILE_NO FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK = ? AND GNUM_ISVALID = ?

SELECT.GET_FILE_NO_CHANGE.HRGT_EPISODE_DTL_OLD=	SELECT DISTINCT hrgnum_episode_code as episodeCode,HRGNUM_PUK as patCrNo, hrgnum_visit_no as episodeVisitNo, a.gnum_dept_code AS departmentcode, (SELECT INITCAP (gstr_dept_name) FROM gblt_department_mst \
											WHERE gnum_dept_code = a.gnum_dept_code AND gnum_isvalid = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) \
											AND gnum_hospital_code = a.gnum_hospital_code) AS department, hgnum_deptunitcode as departmentUnitCode, (SELECT INITCAP (hgstr_unitname) FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode \
											AND gnum_isvalid = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code) \AS departmentUnit, \
											hrgstr_file_no AS fileno FROM hrgt_episode_dtl a WHERE hrgnum_puk = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ? AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) \
											AND hrgnum_is_episode_open = ?
											
SELECT.GET_FILE_NO_CHANGE.HRGT_EPISODE_DTL=	SELECT DISTINCT hrgnum_episode_code as episodeCode,HRGNUM_PUK as patCrNo, hrgnum_visit_no as episodeVisitNo, a.gnum_dept_code AS departmentcode, (SELECT INITCAP (gstr_dept_name) FROM gblt_department_mst \
											WHERE gnum_dept_code = a.gnum_dept_code AND gnum_isvalid = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) \
											AND gnum_hospital_code = a.gnum_hospital_code) AS department, hgnum_deptunitcode as departmentUnitCode, (SELECT INITCAP (hgstr_unitname) FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode \
											AND gnum_isvalid = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code) \AS departmentUnit, \
											hrgstr_file_no AS fileno, hgnum_room_code roomcode,(SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code and gnum_hospital_code = a.gnum_hospital_code \
				   							AND gnum_isvalid = a.gnum_isvalid) room,HRGNUM_QUE_NO queNo,to_char(GDT_ENTRY_DATE,'dd/mm/yyyy hh24:mi')episodeDate, (SELECT ahis_reg.unit_room_time (a.gnum_hospital_code, \
                                            NULL,NULL,a.hgnum_room_code, a.hgnum_deptunitcode) FROM DUAL)unitWorkingDays,(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code \
             								AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') \
             								AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant,nvl((select HRGNUM_AMT_COLLECTED from hrgt_reg_charge_dtl where  hrgnum_puk=a.hrgnum_puk \
                    						and HRGNUM_EPISODE_CODE=a.HRGNUM_EPISODE_CODE AND gnum_hospital_code = a.gnum_hospital_code \
                    						and HRGNUM_VISIT_NO=a.HRGNUM_VISIT_NO ),'0' )  patAmountCollected, \
                    						(SELECT HGSTR_FILEPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) fileprintsetting, \
                    						DECODE (hrgnum_referral_acceptance, 1, (SELECT (SELECT e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code \
                    						AND gnum_isvalid = 1) FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgstr_to_episode_code = a.hrgnum_episode_code AND hrgnum_to_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND \
                    						gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid), 2, (SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk \
                    						AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (0,2) AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) ) referfromdepartment \
                    						FROM hrgt_episode_dtl a WHERE hrgnum_puk = ? AND a.gnum_isvalid = ? \
				   							AND a.gnum_hospital_code = ? AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) \
											AND hrgnum_is_episode_open = ? AND hgnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst WHERE hgnum_isfilerequired in (1,2) AND gnum_hospital_code = a.gnum_hospital_code \
                      						AND gnum_isvalid = a.gnum_isvalid AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE))
											
UPDATE.FILENO.HRGT_EPISODE_DTL=update HRGT_EPISODE_DTL set HRGSTR_FILE_NO=? where HRGNUM_PUK=? and HRGNUM_EPISODE_CODE = ? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? and HRGNUM_VISIT_NO=?

SELECT.GET_RENEWAL_DTL.HRGT_EPISODE_DTL.GBLT_DEPARTMENT_MST=select a.deptcode as departmentCode,(select GSTR_DEPT_NAME from gblt_department_mst \
															where GNUM_DEPT_CODE=a.deptcode) as department,a.epidate as lastVisitDate \
															from (select GNUM_DEPT_CODE deptcode,max(HRGDT_EPISODE_DATE) epidate \
															from hrgt_episode_dtl where (HRGNUM_PUK= ?) and \
															HRGDT_EPISODE_DATE<trunc(sysdate,'yyyy') group by GNUM_DEPT_CODE) a
															
SELECT.GET_RENEWAL_DTL.HRGT_EPISODE_DTL.GBLT_DEPARTMENT_MST_NEW=SELECT a.episodecode AS episodecode, a.deptcode AS departmentcode, \
       															a.hrgnum_visit_no AS episodevisitno, a.hrgnum_admission_no AS admissionno, \
       															a.deptunitcode AS departmentunitcode, a.hrgnum_puk AS patcrno, a.gdt_entry_date AS entrydate, \
       															a.hgnum_patient_cat_code AS patprimarycatcode, a.hgnum_treatment_cat_code AS patsecondarycatcode, \
          														(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.deptcode) || '(' \
       															|| (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.deptunitcode) \
       															|| ')' AS department, a.expdate AS expirydate FROM (SELECT   gnum_dept_code deptcode, \
       															hgnum_deptunitcode deptunitcode, hrgnum_visit_no, hrgnum_episode_code episodecode, \
                 												hrgnum_admission_no, hrgnum_puk, gdt_entry_date, hgnum_patient_cat_code, \
                 												hgnum_treatment_cat_code, TO_CHAR (MAX (hrgdt_exp_date), 'dd-Mon-yyyy') expdate \
            													FROM hrgt_episode_dtl b WHERE (b.hrgnum_puk = ?) AND b.hrgdt_exp_date < TRUNC (SYSDATE) \
             													AND b.hrgnum_visit_no >= ALL (SELECT hrgnum_visit_no FROM hrgt_episode_dtl \
                     											WHERE hrgnum_puk = ? AND hrgnum_episode_code = b.hrgnum_episode_code) \
        														GROUP BY gnum_dept_code, hgnum_deptunitcode, hrgnum_episode_code, hrgnum_visit_no, \
                 												hrgnum_admission_no, hrgnum_puk,  gdt_entry_date,  hgnum_patient_cat_code, hgnum_treatment_cat_code) a
        														
        														
SELECT.GET_RENEWAL_CHARGES.HBLT_CHARGE_MST=SELECT hblnum_opd_charge FROM hblt_charge_mst WHERE hblstr_service_id = ? AND hblstr_tariff_id = ? \
										   AND hblnum_category_code = ? AND hgbl_isvalid =?		
										   
										   
												
															
															
SELECT.DEPT_NO_AMOUNT_COLLECTION_FOR_NEW_DEPT_VISIT=	SELECT A.DEPTCODE AS DEPARTMENTCODE, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE = A.DEPTCODE) AS DEPARTMENT, A.EPIDATE AS LASTVISITDATE FROM \
														(SELECT GNUM_DEPT_CODE DEPTCODE, MAX (HRGDT_EPISODE_DATE) EPIDATE FROM HRGT_EPISODE_DTL WHERE (HRGNUM_PUK = ?) AND TRUNC  (HRGDT_EPISODE_DATE, 'yyyy') =TRUNC  (SYSDATE, 'yyyy') GROUP BY GNUM_DEPT_CODE) A
																																												
INSERT.AMOUNTCOLLECTION.HRGT_REG_CHARGE_DTL=	INSERT INTO HRGT_REG_CHARGE_DTL (hrgnum_puk, gnum_dept_code, hgnum_deptunitcode, hrgnum_episode_code, hrgnum_visit_no, hrgnum_admission_no, \
												hblstr_service_id, hblstr_tariff_id, hgnum_patient_cat_code, hgnum_treatment_cat_code, hrgnum_amt_collected, hrgstr_ip_add, gnum_seat_id, \
												gdt_entry_date, gnum_isvalid,GNUM_HOSPITAL_CODE,HRGNUM_ISREG_FREE ) VALUES (?, ?, ?, ?, (SELECT MAX(hrgnum_visit_no) FROM HRGT_EPISODE_DTL WHERE hrgnum_episode_code = ? AND hrgnum_puk = ? AND GNUM_HOSPITAL_CODE=?),?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?,? ,?)
											
INSERT.AMOUNTCOLLECTION_FOR_RENEWAL.HRGT_REG_CHARGE_DTL=	INSERT INTO HRGT_REG_CHARGE_DTL (hrgnum_puk, gnum_dept_code, hgnum_deptunitcode, hrgnum_episode_code, hrgnum_visit_no, hrgnum_admission_no, \
												hblstr_service_id, hblstr_tariff_id, hgnum_patient_cat_code, hgnum_treatment_cat_code, hrgnum_amt_collected, hrgstr_ip_add, gnum_seat_id, \
												gdt_entry_date, gnum_isvalid,GNUM_HOSPITAL_CODE,HRGNUM_ISREG_FREE ) VALUES (?, ?, ?, ?, ?,?, ?, ?, ?, ?, ?, ?, ?, sysdate, ?,? ,?)
											
SELECT.EPICODE.HRGT_EPISODE_DTL=select HRGNUM_EPISODE_CODE,HRGNUM_VISIT_NO,HRGNUM_VISIT_TYPE from HRGT_EPISODE_DTL where HRGNUM_PUK=? and HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?



												
SELECT.OLD_PATIENT_EPISODES.HRGT_EPISODE_DTL1-sep-2010=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, a.hrgnum_visit_type AS episodevisittype, a.hrgnum_episode_type_code AS episodetypecode, a.hrgstr_episode_action_code AS episodeactioncode, a.hrgstr_file_no AS fileno, a.hrgstr_file_no AS filenoview, \
												a.hrgnum_admission_no AS admissionno, a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold, TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate, a.hrgtm_episode_time AS episodetime, \
												TO_CHAR (a.hrgdt_next_visit_date, 'dd-Mon-YYYY') AS episodenextvisitdate, a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode, a.hrgnum_is_episode_open AS episodeisopen, INITCAP (a.hrgstr_complained_dtl) AS complaindetail, a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate, a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid, a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode, a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode, hrgnum_referral_acceptance AS episodereferaccept, gdt_referral_acceptance_date AS episodereferacceptdate, DECODE (  TO_DATE (hrgdt_treatmentcat_validupto, 'DD-MM-YYYY') - TO_DATE (SYSDATE, 'DD-MM-YYYY'), -1,null, \
												hgnum_treatment_cat_code ) AS patsecondarycatcode, to_char(hrgdt_treatmentcat_validupto,'dd-Mon-yyyy') AS seccatexpdate, (SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) \
												AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode, (SELECT INITCAP (d.gstr_episode_action_name) FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code = \
												a.hrgstr_episode_action_code AND d.gnum_hospital_code = a.gnum_hospital_code) episodeaction, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND \
												NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND e.gnum_hospital_code = a.gnum_hospital_code) department, (SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) \
												AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) departmentunit, TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f \
												WHERE f.gnum_dept_code = a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) episodenextvisitdept, \
												(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode = \
												a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) episodenextvisitdeptunit, \
												(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code AND hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (hopnum_deptunitcode = a.hgnum_deptunitcode) AND ROWNUM = 1), \
												NULL, 0,1 )) deptunitisonduty, (DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (sysdate) AND NVL \
												(gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) and gnum_isvalid=1), 0, 1,1, 0, 2, 1, NULL, 3 )) deptunitisclosed, DECODE (TRUNC (gdt_entry_date) - TRUNC (SYSDATE), 0, 1, 0 ) visitedtoday, (SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab \
												WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) isgeneral, \
												DECODE (SIGN (  TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY') - TO_DATE (SYSDATE, 'DD-MM-YYYY') ), 1, 0, -1, 1, 0) renewalrequired, gdt_entry_date,(SELECT count(*) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
    	                  					        AND hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND gnum_dept_code = a.gnum_dept_code and HOPNUM_DEPTUNITCODE <> a.hgnum_deptunitcode AND HGNUM_ROSTER_TYPE=1) as isOtherUnitWorking, \
												(SELECT HGSTR_CARDPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) cardprintsetting, \
												(SELECT DISTINCT NVL(hrgnum_amt_collected,0) FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = A.hrgnum_visit_no) patamountcollected, \
												 (SELECT DECODE (hrgnum_ext_hospital_dept,NULL, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = \
											    r.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_isvalid=r.gnum_isvalid),hrgnum_ext_hospital_dept) \
        										FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no AND gnum_hospital_code = a.gnum_hospital_code \
         										AND gnum_isvalid = a.gnum_isvalid) referFromDepartment \
												FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) AND (a.gnum_hospital_code = ?) \
												AND a.hrgnum_visit_type IN (1, 4) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code = a.gnum_hospital_code) \
												AND (z.gnum_isvalid = ?) AND z.hrgnum_visit_type = a.hrgnum_visit_type) AND a.gdt_entry_date >= ALL ( SELECT z.gdt_entry_date FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) AND (gnum_hospital_code = a.gnum_hospital_code) \
												AND z.hrgnum_visit_type = a.hrgnum_visit_type AND (z.gnum_isvalid = ?)) AND a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e WHERE d.gnum_metatable_id = e.gnum_metatable_id AND d.gnum_hospital_code = ? \
												AND d.gnum_hospital_code = e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = pkg_usermgmt.fun_getseatid (?, e.gnum_hospital_code)) ORDER BY department, departmentunit

SELECT.OLD_PATIENT_EPISODES.HRGT_EPISODE_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, a.hrgnum_visit_type AS episodevisittype, a.hrgnum_episode_type_code AS episodetypecode, a.hrgstr_episode_action_code AS episodeactioncode, a.hrgstr_file_no AS fileno, a.hrgstr_file_no AS filenoview, \
												a.hrgnum_admission_no AS admissionno, a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold, TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate, a.hrgtm_episode_time AS episodetime, \
												TO_CHAR (a.hrgdt_next_visit_date, 'dd-Mon-YYYY') AS episodenextvisitdate, a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode, a.hrgnum_is_episode_open AS episodeisopen, INITCAP (a.hrgstr_complained_dtl) AS complaindetail, a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate, a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid, a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode, a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode, hrgnum_referral_acceptance AS episodereferaccept, gdt_referral_acceptance_date AS episodereferacceptdate, DECODE (  DATE_PART('day',TO_DATE (TO_CHAR(hrgdt_treatmentcat_validupto::timestamp,'dd-mm-yyyy'), 'DD-MM-YYYY') - TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')), -1,null, \
												hgnum_treatment_cat_code ) AS patsecondarycatcode, to_char(hrgdt_treatmentcat_validupto,'dd-Mon-yyyy') AS seccatexpdate, (SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) \
												AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode, (SELECT INITCAP (d.gstr_episode_action_name) FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code = \
												a.hrgstr_episode_action_code AND d.gnum_hospital_code = a.gnum_hospital_code) episodeaction, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (sysdate) AND \
												NVL (gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) AND e.gnum_hospital_code = a.gnum_hospital_code) department, (SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (sysdate) \
												AND NVL (gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) AND gnum_hospital_code = a.gnum_hospital_code) departmentunit, TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f \
												WHERE f.gnum_dept_code = a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (sysdate) AND NVL (gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) AND gnum_hospital_code = a.gnum_hospital_code) episodenextvisitdept, \
												(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode = \
												a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (sysdate) AND NVL (gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) AND gnum_hospital_code = a.gnum_hospital_code) episodenextvisitdeptunit, \
												(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code AND hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (hopnum_deptunitcode = a.hgnum_deptunitcode) AND gnum_isvalid=1 AND ROWNUM = 1), \
												NULL, 0,1 )) deptunitisonduty, (DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (sysdate) AND NVL \
												(gdt_effective_to, sysdate + 1) >= TRUNC (sysdate) and gnum_isvalid=1), 0, 1,1, 0, 2, 1, NULL, 3 )) deptunitisclosed, DECODE (TRUNC (gdt_entry_date) - TRUNC (SYSDATE), 0, 1, 0 ) visitedtoday, (SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab \
												WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) isgeneral, \
												DECODE (SIGN (  DATE_PART('day',TO_DATE (to_CHAR(hrgdt_exp_date::timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') - TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) renewalrequired, gdt_entry_date,(SELECT count(*) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
    	                  					        AND hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND gnum_dept_code = a.gnum_dept_code and HOPNUM_DEPTUNITCODE <> a.hgnum_deptunitcode AND HGNUM_ROSTER_TYPE=1) as isOtherUnitWorking, \
												(SELECT HGSTR_CARDPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) cardprintsetting, \
												(SELECT DISTINCT NVL(hrgnum_amt_collected,0) FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = A.hrgnum_visit_no) patamountcollected, \
												(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant, \
												decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code AND gnum_isvalid = 1) \
												FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (1,3)  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) ,2, \
												(SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (0,2) AND gnum_hospital_code = a.gnum_hospital_code \
												AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment,HRGSTR_DEPTUNIT_OLDPUK oldCrNo ,to_char(HRGDT_DEPTUNIT_OLDREGDATE,'dd-mm-yyyy') oldRegDate \
												FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) AND (a.gnum_hospital_code = ?) \
												AND a.hrgnum_visit_type IN (1, 4) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code = a.gnum_hospital_code) \
												AND (z.gnum_isvalid = ?) AND z.hrgnum_visit_type = a.hrgnum_visit_type) AND a.gdt_entry_date >= ALL ( SELECT z.gdt_entry_date FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) AND (gnum_hospital_code = a.gnum_hospital_code) \
												AND z.hrgnum_visit_type = a.hrgnum_visit_type AND (z.gnum_isvalid = ?)) AND a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e WHERE d.gnum_metatable_id = e.gnum_metatable_id AND d.gnum_hospital_code = ? \
												AND d.gnum_hospital_code = e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = pkg_usermgmt.fun_getseatid (?, e.gnum_hospital_code)) ORDER BY department, departmentunit



SELECT.OLDEMR_PATIENT_EPISODES.HRGT_EPISODE_DTL17jun09=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
												AND ( hopnum_deptunitcode =a.hgnum_deptunitcode)),NULL, 0,1)) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,check_visited_today (a.hrgnum_puk,a.hgnum_deptunitcode,a.hrgnum_episode_code,a.gnum_hospital_code) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code) isgeneral, \
												DECODE(SIGN ((SELECT   TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY')- TO_DATE (SYSDATE, 'DD-MM-YYYY') FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = a.hrgnum_episode_code and gnum_hospital_code=a.gnum_hospital_code AND (gnum_isvalid = ?) AND hrgnum_visit_no >=ALL (SELECT az.hrgnum_visit_no \
												AS episodevisitno FROM hrgt_episode_dtl az WHERE (az.hrgnum_puk = ?) AND (az.hrgnum_episode_code = a.hrgnum_episode_code ) AND (az.gnum_isvalid = ?) and ( gnum_hospital_code=a.gnum_hospital_code))) \
												),1, 0,-1, 1,0) renewalrequired FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_type IN (2, 3) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = ?) AND z.hrgnum_visit_type = a.hrgnum_visit_type ) AND a.gdt_entry_date >= ALL (SELECT z.gdt_entry_date FROM hrgt_episode_dtl z \
												WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) and (gnum_hospital_code=a.gnum_hospital_code) AND z.hrgnum_visit_type = a.hrgnum_visit_type  AND (z.gnum_isvalid = ?))   \
												and  a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e \
												WHERE d.gnum_metatable_id = e.gnum_metatable_id and d.gnum_hospital_code=? and  d.gnum_hospital_code=e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' \
												AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,e.GNUM_HOSPITAL_CODE)) \
												ORDER BY department, departmentunit

SELECT.OLDEMR_PATIENT_EPISODES.HRGT_EPISODE_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,DECODE(SIGN( TRUNC(a.gdt_entry_date)-TRUNC(SYSDATE)),-1,0,0,DECODE (a.hrgnum_is_confirmed, 1, 1,0,1, 2, 0)) AS isconfirmed , \
												a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and gnum_hospital_code=a.gnum_hospital_code) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
												AND ( hopnum_deptunitcode =a.hgnum_deptunitcode) and gnum_isvalid=1 and rownum=1),NULL, 0,1)) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
												AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,\
												 DECODE ((SELECT COUNT (*) FROM HRGT_TRIAGE_DTL WHERE hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no AND gnum_isvalid = a.gnum_isvalid \
												 AND gnum_hospital_code = a.gnum_hospital_code AND   hrgnum_puk=a.hrgnum_puk),0,0,DECODE ((SELECT COUNT (*) FROM HRGT_TRIAGE_DTL WHERE hrgnum_episode_code = a.hrgnum_episode_code \
												 AND hrgnum_visit_no = a.hrgnum_visit_no AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND   hrgnum_puk=a.hrgnum_puk AND   hrgdt_out_date IS  NULL \
												 AND hrgtm_out_time IS  NULL ),1,1,0,0)) visitedtoday, \
												(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
												AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isgeneral, \
												DECODE(SIGN ((SELECT   TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY')- TO_DATE (SYSDATE, 'DD-MM-YYYY') FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = a.hrgnum_episode_code and gnum_hospital_code=a.gnum_hospital_code AND (gnum_isvalid = ?) AND hrgnum_visit_no >=ALL (SELECT az.hrgnum_visit_no \
												AS episodevisitno FROM hrgt_episode_dtl az WHERE (az.hrgnum_puk = ?) AND (az.hrgnum_episode_code = a.hrgnum_episode_code ) AND (az.gnum_isvalid = ?) and ( gnum_hospital_code=a.gnum_hospital_code))) \
												),1, 0,-1, 1,0) renewalrequired FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_type IN (2, 3) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = ?) AND z.hrgnum_visit_type = a.hrgnum_visit_type ) AND a.gdt_entry_date >= ALL (SELECT z.gdt_entry_date FROM hrgt_episode_dtl z \
												WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) and (gnum_hospital_code=a.gnum_hospital_code) AND z.hrgnum_visit_type = a.hrgnum_visit_type  AND (z.gnum_isvalid = ?))   \
												and  a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e \
												WHERE d.gnum_metatable_id = e.gnum_metatable_id and d.gnum_hospital_code=? and  d.gnum_hospital_code=e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' \
												AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,e.GNUM_HOSPITAL_CODE)) \
												ORDER BY department, departmentunit

INSERT.REFER_DTL.HRGT_EPISODE_REF_DTL=INSERT INTO hrgt_episode_ref_dtl(hrgnum_puk, HRGNUM_EPISODE_CODE, hrgnum_visit_no, hrgnum_s_no,\
									  hrgnum_admission_no, hrgnum_from_dept_code,hgnum_from_deptunitcode, hrgstr_from_doct_code,hrgnum_from_ward_code,\
									  hrgnum_to_dept_code,hgnum_to_deptunitcode, hrgstr_to_doct_code, hrgnum_to_ward_code,hrgstr_to_episode_code, \
									  hrgnum_to_visit_no,hrgnum_ext_hospital_code, hrgstr_ext_hospital_name,hrgstr_ext_hosp_doct_name, \
									  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dept, hrgnum_ext_hospital_dept_unit,hrgstr_is_reff_in_out, \
									  hrgdt_reff_date_time,gdt_acceptance_date, hrgstr_ip_add, gnum_seat_id,gdt_entry_date, gnum_isvalid, \
									  gdt_lstmod_date,gnum_lstmod_seatid, gstr_remarks,GNUM_HOSPITAL_CODE) VALUES (?,?,?,(SELECT nvl(MAX (hrgnum_s_no),0) + 1 \
									  FROM hrgt_episode_ref_dtl WHERE HRGNUM_PUK =? AND HRGNUM_EPISODE_CODE =? AND HRGNUM_VISIT_NO =? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,\
									  ?,?,?,?,?,?,?,?,?,?,?,?,?,?,DECODE( (?/1)::integer, ?,SYSDATE, ?,SYSDATE, NULL)::timestamp, DECODE( (?/1)::integer, ?, SYSDATE, ?,SYSDATE, NULL)::timestamp,?,?, SYSDATE,?,To_date(To_char(?::timestamp,'dd-mm-yyyy'),'dd-mm-yyyy'),?,?,?)
									  
INSERT.REFER_DTL.HRGT_EPISODE_REF_DTL_NEW_REGISTRATION=	INSERT INTO hrgt_episode_ref_dtl(hrgnum_puk, HRGNUM_EPISODE_CODE, hrgnum_visit_no, hrgnum_s_no,\
												  hrgnum_admission_no, hrgnum_from_dept_code,hgnum_from_deptunitcode, hrgstr_from_doct_code,hrgnum_from_ward_code,\
												  hrgnum_to_dept_code,hgnum_to_deptunitcode, hrgstr_to_doct_code, hrgnum_to_ward_code,hrgstr_to_episode_code, \
												  hrgnum_to_visit_no,hrgnum_ext_hospital_code, hrgstr_ext_hospital_name,hrgstr_ext_hosp_doct_name, \
												  hrgnum_ext_hospital_crno,hrgnum_ext_hospital_dept, hrgnum_ext_hospital_dept_unit,hrgstr_is_reff_in_out, \
												  hrgdt_reff_date_time,gdt_acceptance_date, hrgstr_ip_add, gnum_seat_id,gdt_entry_date, gnum_isvalid, \
												  gdt_lstmod_date,gnum_lstmod_seatid, gstr_remarks,GNUM_HOSPITAL_CODE) VALUES (?,?,?,1,?,?,?,?,\
												  ?,?,?,?,?,?,?,?,?,?,?,?,?,?,DECODE( (?/1)::integer, ?, SYSDATE, ?,SYSDATE, NULL)::timestamp, DECODE( (?/1)::integer, ?, SYSDATE, ?,SYSDATE, NULL)::timestamp,?,?, SYSDATE,?,?,?,?,?)
									  
									  
SELECT.ALL_OPEN_EPISODES.HRGT_EPISODE_DTL=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, \
												A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, \
												A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY' ) AS EPISODENEXTVISITDATE, A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, \
												A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, \
												A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, GDT_REFERRAL_ACCEPTANCE_DATE AS EPISODEREFERACCEPTDATE, HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, \
												HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, (SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, (SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE \
												E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE AND GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE)) DEPARTMENT, (SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
												(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) \
												EPISODENEXTVISITDEPT, (SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, (SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT, \
												(DECODE ((SELECT HOPNUM_DEPTUNITCODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPDT_START_DT <= SYSDATE AND HOPDT_END_DT > SYSDATE AND (   SUBSTR (HOPNUM_DEPTUNITCODE, 1, 8) = SUBSTR (A.HGNUM_NEXT_VISIT_DEPTUNITCODE, 1, 8) OR SUBSTR (HOPNUM_DEPTUNITCODE, 1, 8) = SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 8)  )),NULL, 0, 1 ) ) DEPTUNITISONDUTY, \
												(DECODE ((SELECT GNUM_ISVALID FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE), 0, 1, 1, 0, 2, 1, NULL, 3 ) ) DEPTUNITISCLOSED, Check_Visited_Today (A.HRGNUM_PUK, A.HGNUM_DEPTUNITCODE, A.HRGNUM_EPISODE_CODE,a.gnum_hospital_code ) VISITEDTODAY, (SELECT AB.HGNUM_ISGENERAL FROM HGBT_UNIT_MST AB \
												WHERE AB.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) ISGENERAL FROM HRGT_EPISODE_DTL A, HGBT_UNIT_MST Abc WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?) AND A.HRGNUM_VISIT_NO >= ALL ( SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) \
												AND (Z.HRGNUM_EPISODE_CODE = A.HRGNUM_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?)) AND A.GDT_ENTRY_DATE >= ALL ( SELECT Z.GDT_ENTRY_DATE FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) AND (Z.GNUM_ISVALID = ?)) AND \
												((Abc.HGNUM_ISGENERAL = ? OR Abc.HGNUM_ISGENERAL = ? OR Abc.HGNUM_ISGENERAL = ?) AND Abc.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE ) ORDER BY DEPARTMENT, DEPARTMENTUNIT 
									  
									  
SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CONTACT_NO.ADD_TYPE	=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_CITY AS patAddCity, INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, \
																A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, A.HRGSTR_HOUSE_NO AS patAddHNo, \
																A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, \
																(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
																(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
																(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
																FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE UPPER(F.HRGSTR_CONTACT_NO) LIKE UPPER(?)))   AND (A.GNUM_ISVALID = ?)								

SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CONTACT_NO.ADD_TYPE1=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
																INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
																A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_LOCAL AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
																A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
																(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
																(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
																(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
																(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
																FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE F.HRGSTR_CONTACT_NO LIKE ?))   AND (A.GNUM_ISVALID = ?)								

SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_NATIONAL_ID.ADD_TYPE=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_CITY AS patAddCity, INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, \
																A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, A.HRGSTR_HOUSE_NO AS patAddHNo, \
																A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, \
																(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
																(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
																(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
																FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE UPPER(F.HRGSTR_NATIONAL_ID) LIKE UPPER(?)))   AND (A.GNUM_ISVALID = ?)
																
SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_EMPLOYEE_ID.ADD_TYPE=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_CITY AS patAddCity, INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, \
																A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, A.HRGSTR_HOUSE_NO AS patAddHNo, \
																A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, \
																(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
																(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
																(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
																FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE UPPER(F.HRGNUM_ID_NO) LIKE UPPER(?)))   AND (A.GNUM_ISVALID = ?)								

SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_NATIONAL_ID.ADD_TYPE1=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
																INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
																A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_LOCAL AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
																A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
																(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
																(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
																(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
																(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
																FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK IN (SELECT F.HRGNUM_PUK FROM HRGT_PATIENT_DTL F WHERE F.HRGSTR_NATIONAL_ID LIKE ?))   AND (A.GNUM_ISVALID = ?)								

Update.EXPIRYDATE.HRGT_EPISODE_DTL = update hrgt_episode_dtl set HRGDT_EXP_DATE=ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')) \
									 where HRGNUM_PUK= ? and HRGNUM_EPISODE_CODE= ? and HRGNUM_VISIT_NO=? AND GNUM_HOSPITAL_CODE=?
									 
									 
Update.HRGT_EPISODE_REF_DTL = UPDATE HRGT_EPISODE_REF_DTL  set hrgnum_to_dept_code=?,hgnum_to_deptunitcode=?, \
							  hrgnum_ext_hospital_code=?, hrgstr_ext_hospital_name=?, hrgstr_ext_hosp_doct_name=?, hrgnum_ext_hospital_crno=?, \
							  hrgnum_ext_hospital_dept=?, hrgnum_ext_hospital_dept_unit=?, \
							  hrgstr_ip_add=?, gdt_entry_date=sysdate where HRGNUM_PUK=? and HRGNUM_EPISODE_CODE=? AND GNUM_HOSPITAL_CODE=? 



SELECT.HRGT_VERIFICATION_DOC_USED_DTL=SELECT gnum_menu_id AS menuid, hrgnum_puk AS patcrno, hrgnum_s_no AS serialno, \
									  gdt_submission_date AS submissiondate, hrgstr_verification_documents as verificationDocuments, \
									  hrgstr_remarks as remarks, gdt_entry_date as entryDate, gnum_seat_id as seatId, gnum_isvalid as isValid \
									  FROM hrgt_verification_doc_used_dtl WHERE gnum_menu_id = ? AND hrgnum_puk = ? AND gnum_hospital_code=?

SELECT_MAX_SNO.HRGT_VERIFICATION_DOC_USED_DTL=SELECT gnum_menu_id AS menuid, hrgnum_puk AS patcrno, hrgnum_s_no AS serialno, \
									  gdt_submission_date AS submissiondate, hrgstr_verification_documents as verificationDocuments, \
									  hrgstr_remarks as remarks, gdt_entry_date as entryDate, gnum_seat_id as seatId, gnum_isvalid as isValid \
									  FROM hrgt_verification_doc_used_dtl WHERE gnum_menu_id = ? AND hrgnum_puk = ?  and \
									  hrgnum_s_no =(select max( hrgnum_s_no ) from hrgt_verification_doc_used_dtl WHERE gnum_menu_id = ? AND hrgnum_puk = ? AND gnum_hospital_code = ? ) AND gnum_hospital_code = ?


UPDATE.SET.EXPIRYDATE.HRGT_PATIENT_DTL= UPDATE HRGT_PATIENT_DTL SET HRGDT_EXP_DATE=ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')) \
										WHERE HRGNUM_PUK = ? AND GNUM_HOSPITAL_CODE=?

CLIENT_GNCTD=0


SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO.NEW19-11-09=	SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode, a.hrgstr_mlc_no AS patMlcNo,\
													TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate, \
													a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition,INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid, \
													a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob, \
													a.gnum_gender_code AS patgendercode,a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname, \
													INITCAP (a.hrgstr_momname) AS patmomname,a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor, \
													a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi,a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict, \
													INITCAP (a.hrgstr_city) AS pataddcity,a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno, \
													a.hrgnum_add_type_code AS pataddtypecode,INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress,a.gnum_nationality_code AS patnationalitycode, \
													a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno,a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													HRGTM_MLC_TIME as mlcTime, HRGNUM_INJURY_TYPE_CODE as injuryTypeCode, HRGNUM_STATUS_CODE as patStatusCode, to_char(HRGDT_HANDOVER_DATETIME,'dd-Mon-yyyy') as handoverDateTime, HRGNUM_MLC_TYPE as mlcType, \
													HRGSTR_OFFICER_NAME as handoverOffName, HRGNUM_INJURY_NATURE_CODE as injuryNatureCode, HRGSTR_OFFICER_DESIG as handoverOffDesg, PSSTR_REFER_DOC_CODE as referDoctorCode, HRGSTR_OFFICER_BADGENO as handoverOffBadgeNo, \
													HRGSTR_REFER_DOC_REMARKS as referDocotorRemarks, HRGNUM_VISIT_NO as episodeVisitNo, HRGSTR_MLC_BOOKNO as bookNo, HRGNUM_MLC_PAGENO as pageNo, HRGSTR_DAIGNOSIS as diagnosis,HRGNUM_ISFIT as fitnessStatus, to_char(HRGDT_FIT_DATETIME,'dd-Mon-yyyy') as fitDateTime, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.gstr_institute_name) FROM gblt_ext_institute_mst e WHERE e.gnum_institute_code = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code and f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode and g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode and h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code and i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code and t.gnum_hospital_code = a.gnum_hospital_code) patnationality \
													FROM hrgt_patient_mlc_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? AND ((a.hrgnum_s_no) = ALL (SELECT MAX (j.hrgnum_s_no) FROM hrgt_patient_mlc_dtl j WHERE j.hrgnum_puk = ? \
													AND j.gnum_isvalid = ? AND j.gnum_hospital_code=a.gnum_hospital_code AND j.hrgstr_mlc_no = a.hrgstr_mlc_no) ) AND a.gnum_hospital_code = ?  
       
SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO.NEW=	SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode, a.hrgstr_mlc_no AS patMlcNo,\
													TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate, \
													a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition,INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid, \
													a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob, \
													a.gnum_gender_code AS patgendercode,a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname, \
													INITCAP (a.hrgstr_momname) AS patmomname,a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor, \
													a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi,a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict, \
													INITCAP (a.hrgstr_city) AS pataddcity,a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno, \
													a.hrgnum_add_type_code AS pataddtypecode,INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress,a.gnum_nationality_code AS patnationalitycode, \
													a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno,a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													HRGTM_MLC_TIME as mlcTime, HRGNUM_INJURY_TYPE_CODE as injuryTypeCode, HRGNUM_STATUS_CODE as patStatusCode, to_char(HRGDT_HANDOVER_DATETIME,'dd-Mon-yyyy') as handoverDateTime, HRGNUM_MLC_TYPE as mlcType, \
													HRGSTR_OFFICER_NAME as handoverOffName, HRGNUM_INJURY_NATURE_CODE as injuryNatureCode, HRGSTR_OFFICER_DESIG as handoverOffDesg, PSSTR_REFER_DOC_CODE as referDoctorCode, HRGSTR_OFFICER_BADGENO as handoverOffBadgeNo, \
													HRGSTR_REFER_DOC_REMARKS as referDocotorRemarks, HRGNUM_VISIT_NO as episodeVisitNo, HRGSTR_MLC_BOOKNO as bookNo, HRGNUM_MLC_PAGENO as pageNo, HRGSTR_DAIGNOSIS as diagnosis,HRGNUM_ISFIT as fitnessStatus, to_char(HRGDT_FIT_DATETIME,'dd-Mon-yyyy') as fitDateTime, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.gstr_institute_name) FROM gblt_ext_institute_mst e WHERE e.gnum_institute_code = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code and f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode and g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode and h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code and i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code and t.gnum_hospital_code = a.gnum_hospital_code) patnationality, \
													(select hrgnum_referral_acceptance from hrgt_episode_dtl where hrgnum_puk=a.hrgnum_puk and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=a.gnum_isvalid and \
													HRGNUM_EPISODE_CODE=A.HRGNUM_EPISODE_CODE AND HRGNUM_VISIT_NO=A.HRGNUM_VISIT_NO) AS episodereferaccept , \
													HRGNUM_BURN_PERCENTAGE as burnPercentage, HRGSTR_WEAPON_TYPE as typeOfWeapon, HRGSTR_INJURY_SIZE as injurySize, HRGSTR_INJURY_DEPTH as injuryDepth, HGNUM_DISEASE_SITE_ID as injurySide, HRGSTR_POISION_REMARK as poisonRemarks,HRGNUM_INJURY_AGE as ageOfInjury \
													FROM hrgt_patient_mlc_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ?  AND a.gnum_hospital_code = ?  
       

SELECT.HRGT_PATIENT_MLC_DTL_ARRAY.RETRIEVE_BY_MLCNO19-11-09=SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode, a.hrgstr_mlc_no AS patMlcNo,\
													TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate, \
													a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition,INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid, \
													a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob, \
													a.gnum_gender_code AS patgendercode,a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname, \
													INITCAP (a.hrgstr_momname) AS patmomname,a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor, \
													a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi,a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict, \
													INITCAP (a.hrgstr_city) AS pataddcity,a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno, \
													a.hrgnum_add_type_code AS pataddtypecode,INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress,a.gnum_nationality_code AS patnationalitycode, \
													a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno,a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													HRGTM_MLC_TIME as mlcTime, HRGNUM_INJURY_TYPE_CODE as injuryTypeCode, HRGNUM_STATUS_CODE as patStatusCode, to_char(HRGDT_HANDOVER_DATETIME,'dd-Mon-yyyy') as handoverDateTime, HRGNUM_MLC_TYPE as mlcType, \
													HRGSTR_OFFICER_NAME as handoverOffName, HRGNUM_INJURY_NATURE_CODE as injuryNatureCode, HRGSTR_OFFICER_DESIG as handoverOffDesg, PSSTR_REFER_DOC_CODE as referDoctorCode, HRGSTR_OFFICER_BADGENO as handoverOffBadgeNo, \
													HRGSTR_REFER_DOC_REMARKS as referDocotorRemarks, HRGNUM_VISIT_NO as episodeVisitNo, HRGSTR_MLC_BOOKNO as bookNo, HRGNUM_MLC_PAGENO as pageNo, HRGSTR_DAIGNOSIS as diagnosis,HRGNUM_ISFIT as fitnessStatus, to_char(HRGDT_FIT_DATETIME,'dd-Mon-yyyy') as fitDateTime, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.gstr_institute_name) FROM gblt_ext_institute_mst e WHERE e.gnum_institute_code = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code and f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode and g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode and h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code and i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code and t.gnum_hospital_code = a.gnum_hospital_code) patnationality \
													FROM hrgt_patient_mlc_dtl a WHERE a.hrgstr_mlc_no = ? AND a.gnum_isvalid = ? \
													AND ((a.hrgnum_s_no) = ALL (SELECT MAX (j.hrgnum_s_no) FROM hrgt_patient_mlc_dtl j WHERE j.hrgstr_mlc_no = ? AND j.gnum_isvalid = ? AND j.hrgnum_puk = a.hrgnum_puk AND j.gnum_hospital_code = a.gnum_hospital_code)) \
													AND a.gnum_hospital_code = ?

SELECT.HRGT_PATIENT_MLC_DTL_ARRAY.RETRIEVE_BY_MLCNO=SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,a.hrgnum_episode_code AS episodecode, a.hrgstr_mlc_no AS patMlcNo,\
													TO_CHAR (a.hrgdt_mlc_date, 'dd-mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-mon-yyyy') AS entrydate, \
													a.hrgnum_isbroughtdead AS isbroughtdead,INITCAP (a.hrgstr_patient_condition) AS patcondition,INITCAP (a.hrgstr_mlc_remarks) AS mlcremark, a.gnum_isvalid AS isvalid, \
													a.hrgnum_s_no AS serialno, INITCAP (a.hrgstr_fname) AS patfirstname,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,TO_CHAR (a.hrgdt_dob, 'dd-mon-yyyy') AS patdob, \
													a.gnum_gender_code AS patgendercode,a.gnum_marital_status_code AS patmaritalstatuscode,a.gnum_religion_code AS patreligioncode,INITCAP (a.hrgstr_father_name) AS patguardianname, \
													INITCAP (a.hrgstr_momname) AS patmomname,a.hrgnum_is_ref AS isreferred,a.hrgnum_ext_hospital_code AS patrefgnctdhospitalcode,INITCAP (a.hrgstr_ext_hosp_doct_name) AS patrefdoctor, \
													a.hgnum_isunknown AS isunknown, a.hrgnum_is_local AS isaddressdelhi,a.hrgstr_house_no AS pataddhno,a.gnum_city_loc_code AS pataddcityloccode,INITCAP (a.hrgstr_district) AS patadddistrict, \
													INITCAP (a.hrgstr_city) AS pataddcity,a.gnum_statecode AS pataddstatecode,a.gnum_countrycode AS pataddcountrycode, a.hrgnum_pin AS pataddpin,a.hrgstr_contact_no AS pataddcontactno, \
													a.hrgnum_add_type_code AS pataddtypecode,INITCAP (a.hrgstr_city_location) AS pataddcityloc,a.hrgstr_ip_add AS systemipaddress,a.gnum_nationality_code AS patnationalitycode, \
													a.hrgnum_ext_hospital_crno AS patrefgnctdhospitalcrno,a.hrgnum_ext_hospital_dept AS patrefgnctdhospitaldept,a.hrgnum_ext_hospital_dept_unit AS patrefgnctdhospitaldeptunit,hrgnum_is_imageuploaded AS isimageuploaded, \
													HRGTM_MLC_TIME as mlcTime, HRGNUM_INJURY_TYPE_CODE as injuryTypeCode, HRGNUM_STATUS_CODE as patStatusCode, to_char(HRGDT_HANDOVER_DATETIME,'dd-Mon-yyyy') as handoverDateTime, HRGNUM_MLC_TYPE as mlcType, \
													HRGSTR_OFFICER_NAME as handoverOffName, HRGNUM_INJURY_NATURE_CODE as injuryNatureCode, HRGSTR_OFFICER_DESIG as handoverOffDesg, PSSTR_REFER_DOC_CODE as referDoctorCode, HRGSTR_OFFICER_BADGENO as handoverOffBadgeNo, \
													HRGSTR_REFER_DOC_REMARKS as referDocotorRemarks, HRGNUM_VISIT_NO as episodeVisitNo, HRGSTR_MLC_BOOKNO as bookNo, HRGNUM_MLC_PAGENO as pageNo, HRGSTR_DAIGNOSIS as diagnosis,HRGNUM_ISFIT as fitnessStatus, to_char(HRGDT_FIT_DATETIME,'dd-Mon-yyyy') as fitDateTime, \
													(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code) patgender, \
													(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c WHERE c.gnum_marital_status_code = a.gnum_marital_status_code AND c.gnum_hospital_code = a.gnum_hospital_code) patmaritalstatus, \
													(SELECT INITCAP (d.gstr_religion_name) FROM gblt_religion_mst d WHERE d.gnum_religion_code = a.gnum_religion_code AND d.gnum_hospital_code = a.gnum_hospital_code) patreligion, \
													(SELECT INITCAP (e.gstr_institute_name) FROM gblt_ext_institute_mst e WHERE e.gnum_institute_code = a.hrgnum_ext_hospital_code AND e.gnum_hospital_code = a.gnum_hospital_code) patrefhospitalname, \
													(SELECT INITCAP (f.gstr_address_type) FROM gblt_address_type_mst f WHERE f.gnum_address_type_code = a.hrgnum_add_type_code and f.gnum_hospital_code = a.gnum_hospital_code) pataddtype, \
													(SELECT INITCAP (g.gstr_statename) FROM gblt_state_mst g WHERE g.gnum_statecode = a.gnum_statecode and g.gnum_hospital_code = a.gnum_hospital_code) pataddstate, \
													(SELECT INITCAP (h.gstr_countryname) FROM gblt_country_mst h WHERE h.gnum_countrycode = a.gnum_countrycode and h.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, \
													(SELECT INITCAP (i.gstr_city_loc_name) FROM gblt_city_location_mst i WHERE i.gnum_city_loc_code = a.gnum_city_loc_code and i.gnum_hospital_code = a.gnum_hospital_code) pataddcityloc, \
													(SELECT INITCAP (t.gstr_nationality) FROM gblt_country_mst t WHERE t.gnum_countrycode = a.gnum_nationality_code and t.gnum_hospital_code = a.gnum_hospital_code) patnationality, \
													(select hrgnum_referral_acceptance from hrgt_episode_dtl where hrgnum_puk=a.hrgnum_puk and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=a.gnum_isvalid and \
													HRGNUM_EPISODE_CODE=A.HRGNUM_EPISODE_CODE AND HRGNUM_VISIT_NO=A.HRGNUM_VISIT_NO) AS episodereferaccept FROM hrgt_patient_mlc_dtl a WHERE a.hrgstr_mlc_no = ? AND a.gnum_isvalid = ? \
													AND a.gnum_hospital_code = ?
        
					

SELECT.HRGT_EPISODE_REF_DTL16jun09 =   SELECT a.hrgnum_puk AS patcrno,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, \
								(SELECT gstr_dept_name  FROM gblt_department_mst  WHERE gnum_dept_code = a.hrgnum_from_dept_code and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS fromdepartment, \
								(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_from_deptunitcode 	and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) fromdepartmentunit, \
								TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime,INITCAP (a.gstr_remarks) AS remarks,\
								hrgnum_to_dept_code AS todepartmentcode,\
								(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartment,\
								hgnum_to_deptunitcode AS todepartmentunitcode,\
								a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno,\
								(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_to_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartmentunit, a.hrgnum_from_dept_code as fromDepartmentCode, \
								(DECODE ((SELECT  distinct substr(hopnum_deptunitcode,1,3) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
								AND HGNUM_ROSTER_TYPE=1 AND hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE AND (SUBSTR (hopnum_deptunitcode, 1, 3) = a.hrgnum_to_dept_code )), \
								NULL, 0, 1) ) deptunitisonduty FROM hrgt_episode_ref_dtl a,hrgt_daily_patient_dtl b \
								WHERE b.hrgnum_puk = a.hrgnum_puk  AND b.hrgnum_episode_code = a.hrgnum_episode_code \
								AND b.hrgnum_visit_no = a.hrgnum_visit_no  AND b.gnum_dept_code = a.hrgnum_from_dept_code \
								AND a.gdt_acceptance_date IS NULL  AND a.hrgnum_to_dept_code IS NOT NULL and a.hgnum_to_deptunitcode is null \
								and b.gnum_hospital_code=a.gnum_hospital_code  and a.gnum_hospital_code=? \
								AND a.hrgnum_to_dept_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl e, gblt_metatable_column_mst f \
								WHERE e.gnum_metatable_id = f.gnum_metatable_id  AND f.gstr_table_name = 'GBLT_DEPARTMENT_MST' \
								AND gstr_column_name = 'GNUM_DEPT_CODE' and e.gnum_hospital_code=f.gnum_hospital_code and e.gnum_hospital_code=a.gnum_hospital_code AND  e.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,f.GNUM_HOSPITAL_CODE) ) \
								AND a.hrgnum_to_dept_code not in( SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE \
								GNUM_DEPT_CODE=a.hrgnum_to_dept_code AND HRGNUM_VISIT_TYPE=1 and  HRGNUM_PUK=a.hrgnum_puk AND HRGNUM_IS_EPISODE_OPEN=1)

SELECT.HRGT_EPISODE_REF_DTL =   SELECT a.hrgnum_puk AS patcrno,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, \
								(SELECT gstr_dept_name  FROM gblt_department_mst  WHERE gnum_dept_code = a.hrgnum_from_dept_code and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS fromdepartment, \
								(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_from_deptunitcode 	and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) fromdepartmentunit, \
								TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime,INITCAP (a.gstr_remarks) AS remarks,\
								hrgnum_to_dept_code AS todepartmentcode,\
								(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS todepartment,\
								hgnum_to_deptunitcode AS todepartmentunitcode,\
								a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno,\
								(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_to_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
								and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE)  AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS todepartmentunit, a.hrgnum_from_dept_code as fromDepartmentCode, \
								(DECODE ((SELECT  distinct substr(hopnum_deptunitcode,1,3) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
								AND HGNUM_ROSTER_TYPE=1 AND hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (SUBSTR (hopnum_deptunitcode, 1, 3) = a.hrgnum_to_dept_code and rownum=1 )), \
								NULL, 0, 1) ) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM gblt_department_mst WHERE GNUM_DEPT_CODE = a.HRGNUM_TO_DEPT_CODE AND \
								gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)), \
								 0, 1, 1, 0, 2, 1, NULL, 1 ) ) deptunitisclosed,(select c.HRGSTR_MLC_NO from HRGT_EPISODE_DTL c where c.hrgnum_puk = a.hrgnum_puk AND \
								 c.hrgnum_episode_code = a.hrgnum_episode_code AND c.hrgnum_visit_no = a.hrgnum_visit_no AND c.gnum_hospital_code = a.gnum_hospital_code) as mlcno, \
								 to_char(b.GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate FROM hrgt_episode_ref_dtl a,hrgt_daily_patient_dtl b \
								WHERE b.hrgnum_puk = a.hrgnum_puk  AND b.hrgnum_episode_code = a.hrgnum_episode_code \
								AND b.hrgnum_visit_no = a.hrgnum_visit_no  AND b.gnum_dept_code = a.hrgnum_from_dept_code \
								AND a.gdt_acceptance_date IS NULL  AND a.hrgnum_to_dept_code IS NOT NULL and a.hgnum_to_deptunitcode is null \
								and b.gnum_hospital_code=a.gnum_hospital_code  and a.gnum_hospital_code=? \
								AND a.hrgnum_to_dept_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl e, gblt_metatable_column_mst f \
								WHERE e.gnum_metatable_id = f.gnum_metatable_id  AND f.gstr_table_name = 'GBLT_DEPARTMENT_MST' \
								AND gstr_column_name = 'GNUM_DEPT_CODE' and e.gnum_hospital_code=f.gnum_hospital_code and e.gnum_hospital_code=a.gnum_hospital_code AND  e.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,f.GNUM_HOSPITAL_CODE) ) \
								AND a.hrgnum_to_dept_code not in( SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE \
								GNUM_DEPT_CODE=a.hrgnum_to_dept_code AND HRGNUM_VISIT_TYPE=1 and  HRGNUM_PUK=a.hrgnum_puk AND HRGNUM_IS_EPISODE_OPEN=1) and ((SYSDATE - HRGDT_REFF_DATE_TIME) ) < ? order by patname

													

                             
							  


UPDATE.ACCEPTANCEDATE.HRGT_EPISODE_REF_DTL = UPDATE  HRGT_EPISODE_REF_DTL SET GDT_ACCEPTANCE_DATE = SYSDATE, HGNUM_TO_DEPTUNITCODE = ?,HRGSTR_IS_REFF_IN_OUT = ?,HRGSTR_TO_EPISODE_CODE=?,HRGNUM_TO_VISIT_NO=? \
											 WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ? AND HRGNUM_S_NO = ? AND GNUM_HOSPITAL_CODE=?
											 
											 
											 
SELECT.SPECIAL_CLINIC.HRGT_EPISODE_REF_DTL16july09 =  SELECT a.hrgnum_puk AS patcrno,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, \
											(SELECT gstr_dept_name  FROM gblt_department_mst  WHERE gnum_dept_code = a.hrgnum_from_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS fromdepartment, \
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_from_deptunitcode 	and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) fromdepartmentunit, \
											TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime,INITCAP (a.gstr_remarks) AS remarks,\
											hrgnum_to_dept_code AS todepartmentcode,\
											(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartment,\
											hgnum_to_deptunitcode AS todepartmentunitcode,\
											a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno,\
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_to_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartmentunit,a.HGNUM_FROM_DEPTUNITCODE as fromDepartmentUnitCode, \
											(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
											AND hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE AND (hopnum_deptunitcode = a.hgnum_to_deptunitcode)), NULL,0,1)) deptunitisonduty \
											FROM hrgt_episode_ref_dtl a,hrgt_daily_patient_dtl b \
											WHERE b.hrgnum_puk = a.hrgnum_puk  AND b.hrgnum_episode_code = a.hrgnum_episode_code \
											AND b.hrgnum_visit_no = a.hrgnum_visit_no  AND b.gnum_dept_code = a.hrgnum_from_dept_code \
											AND a.gdt_acceptance_date IS NULL  AND A.HGNUM_TO_DEPTUNITCODE  IS NOT NULL \
											and b.gnum_hospital_code=a.gnum_hospital_code  and a.gnum_hospital_code=? \
											AND A.HGNUM_TO_DEPTUNITCODE IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl e, gblt_metatable_column_mst f \
											WHERE e.gnum_metatable_id = f.gnum_metatable_id  AND f.gstr_table_name = 'HGBT_UNIT_MST' \
											AND gstr_column_name = 'HGNUM_DEPTUNITCODE' and e.gnum_hospital_code=f.gnum_hospital_code and e.gnum_hospital_code=a.gnum_hospital_code AND  e.gnum_seatid =Pkg_Usermgmt.fun_getseatid(?,a.GNUM_HOSPITAL_CODE) ) \
											AND a.HGNUM_TO_DEPTUNITCODE not in ( SELECT DISTINCT hgnum_deptunitcode FROM HRGT_EPISODE_DTL WHERE \
											hgnum_deptunitcode=a.HGNUM_TO_DEPTUNITCODE AND HRGNUM_VISIT_TYPE = 4 AND HRGNUM_IS_EPISODE_OPEN=1 and HRGNUM_PUK=a.hrgnum_puk)											

			 
			   
SELECT.SPECIAL_CLINIC.HRGT_EPISODE_REF_DTL=	SELECT a.hrgnum_puk AS patcrno,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, \
											(SELECT gstr_dept_name  FROM gblt_department_mst  WHERE gnum_dept_code = a.hrgnum_from_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS fromdepartment, \
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_from_deptunitcode 	and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) fromdepartmentunit, \
											TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime,INITCAP (a.gstr_remarks) AS remarks,\
											hrgnum_to_dept_code AS todepartmentcode,\
											(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE) AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS todepartment,\
											hgnum_to_deptunitcode AS todepartmentunitcode,\
											a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno,\
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_to_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (a.GDT_ENTRY_DATE)  AND NVL (gdt_effective_to, a.GDT_ENTRY_DATE + 1) >= TRUNC (a.GDT_ENTRY_DATE)) AS todepartmentunit,a.HGNUM_FROM_DEPTUNITCODE as fromDepartmentUnitCode, \
											(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code = a.gnum_hospital_code \
											AND hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE AND (hopnum_deptunitcode = a.hgnum_to_deptunitcode) and rownum=1), NULL,0,1)) deptunitisonduty, \
											(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_to_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
											AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_isvalid!=0), 0, 1, 1, 0, 2, 1, NULL, 1 ) ) deptunitisclosed,(select c.HRGSTR_MLC_NO from HRGT_EPISODE_DTL c where \
											c.hrgnum_puk = a.hrgnum_puk AND c.hrgnum_episode_code = a.hrgnum_episode_code AND c.hrgnum_visit_no = a.hrgnum_visit_no AND c.gnum_hospital_code = a.gnum_hospital_code ) as mlcno \
											FROM hrgt_episode_ref_dtl a,hrgt_daily_patient_dtl b \
											WHERE b.hrgnum_puk = a.hrgnum_puk  AND b.hrgnum_episode_code = a.hrgnum_episode_code \
											AND b.hrgnum_visit_no = a.hrgnum_visit_no  AND b.gnum_dept_code = a.hrgnum_from_dept_code \
											AND a.gdt_acceptance_date IS NULL  AND A.HGNUM_TO_DEPTUNITCODE  IS NOT NULL \
											and b.gnum_hospital_code=a.gnum_hospital_code  and a.gnum_hospital_code=? \
											AND A.HGNUM_TO_DEPTUNITCODE IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl e, gblt_metatable_column_mst f \
											WHERE e.gnum_metatable_id = f.gnum_metatable_id  AND f.gstr_table_name = 'HGBT_UNIT_MST' \
											AND gstr_column_name = 'HGNUM_DEPTUNITCODE' and e.gnum_hospital_code=f.gnum_hospital_code and e.gnum_hospital_code=a.gnum_hospital_code AND  e.gnum_seatid =Pkg_Usermgmt.fun_getseatid(?,a.GNUM_HOSPITAL_CODE) ) \
											AND a.HGNUM_TO_DEPTUNITCODE not in ( SELECT DISTINCT hgnum_deptunitcode FROM HRGT_EPISODE_DTL WHERE \
											hgnum_deptunitcode=a.HGNUM_TO_DEPTUNITCODE AND HRGNUM_VISIT_TYPE = 4 AND HRGNUM_IS_EPISODE_OPEN=1 and HRGNUM_PUK=a.hrgnum_puk) AND ((SYSDATE - hrgdt_reff_date_time)) < ? order by patname										

											 											 

					
UPDATE.SC_ACCEPTANCEDATE.HRGT_EPISODE_REF_DTL = UPDATE  HRGT_EPISODE_REF_DTL SET GDT_ACCEPTANCE_DATE = SYSDATE, HRGNUM_TO_DEPT_CODE = ?,HRGSTR_IS_REFF_IN_OUT = ?,HRGSTR_TO_EPISODE_CODE=?,HRGNUM_TO_VISIT_NO=? \
												WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ? AND HRGNUM_S_NO = ? AND GNUM_HOSPITAL_CODE=?												    													
				
UPDATE.SECONDARY_CATEGORY.HRGT_DAILY_PATIENT_DTL=	UPDATE hrgt_daily_patient_dtl SET hgnum_treatment_cat_code = ? WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? \
													AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) AND gnum_hospital_code = ? AND hrgnum_s_no = (SELECT MAX (hrgnum_s_no) \
													FROM hrgt_daily_patient_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) \
													AND gnum_hospital_code = ?)									

SELECT.PREVIOUS.PRIMARY.CATEGORY.HRGT_PRICAT_CHANGE_DTL=	SELECT a.hrgnum_puk AS patcrno, a.hrgnum_s_no AS serialno, a.hrgnum_prev_patient_cat_code AS patprevprimarycatcode, \
															(SELECT gstr_patient_cat_name FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hrgnum_prev_patient_cat_code \
															AND gnum_hospital_code = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= \
															TRUNC (SYSDATE) and gnum_isvalid=1) AS patprevprimarycat, a.hrgnum_new_patient_cat_code AS patnewprimarycatcode, (SELECT gstr_patient_cat_name \
															FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hrgnum_new_patient_cat_code AND gnum_hospital_code = ? \
															AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_isvalid=1) AS patnewprimarycat, \
															a.hrgstr_remarks AS remarks, a.hrgstr_ip_add AS systemipaddress, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') AS effectivefrom, \
															a.gnum_seat_id AS seatid, (SELECT TO_CHAR (b.gdt_entry_date, 'dd-Mon-yyyy') FROM hrgt_pricat_change_dtl b WHERE b.hrgnum_puk = \
															a.hrgnum_puk AND b.gnum_hospital_code = b.gnum_hospital_code AND b.gnum_isvalid = ? AND b.hrgnum_s_no = a.hrgnum_s_no + 1) AS \
															effectiveto    FROM hrgt_pricat_change_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? ORDER BY a.hrgnum_s_no
															
SELECT_NEXT_SNO.HRGT_VERIFICATION_DOC_USED_DTL=	SELECT to_char(NVL(MAX (hrgnum_s_no),0)+1) FROM hrgt_verification_doc_used_dtl WHERE hrgnum_puk = ? AND gnum_menu_id = ? AND gnum_hospital_code = ?		

INSERT.NEXT.SERIAL.NO.HRGT_VERIFICATION_DOC_USED_DTL=	INSERT INTO HRGT_VERIFICATION_DOC_USED_DTL (GNUM_MENU_ID, HRGNUM_PUK, HRGNUM_S_NO, GDT_SUBMISSION_DATE, HRGSTR_VERIFICATION_DOCUMENTS, HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_SEAT_ID, GNUM_ISVALID,GNUM_HOSPITAL_CODE) \
														VALUES (?,?,?, SYSDATE, ?,?,SYSDATE,?,?,?)													
														
UPDATE.PRIMARY_CATEGORY.HRGT_DAILY_PATIENT_DTL1=	update  HRGT_DAILY_PATIENT_DTL set HGNUM_PATIENT_CAT_CODE=? where HRGNUM_PUK=? and gnum_hospital_code=? and trunc(GDT_ENTRY_DATE)=trunc(sysdate)

UPDATE.PRIMARY_CATEGORY.HRGT_DAILY_PATIENT_DTL=	update  HRGT_DAILY_PATIENT_DTL set HGNUM_PATIENT_CAT_CODE=? where HRGNUM_PUK=? and trunc(GDT_ENTRY_DATE)=trunc(sysdate)														
														

SELECT.HRGT_PATIENT_DTL.SEARCH.PATIENT1=	SELECT a.hrgnum_puk AS patcrno, TO_CHAR (a.hrgdt_dob, 'dd-Mon-YYYY') AS patdob, a.hrgbl_is_actual_dob AS isactualdob, INITCAP (a.hrgstr_fname) AS patfirstname, \
										INITCAP (a.hrgstr_mname) AS patmiddlename, INITCAP (a.hrgstr_lname) AS patlastname, a.gnum_gender_code,(SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code = \
										a.gnum_gender_code AND gnum_hospital_code = a.gnum_hospital_code) AS patgender, a.hrgstr_idmark1 AS patidmark, INITCAP (a.hrgstr_father_name) AS patguardianname, \
										INITCAP (a.hrgstr_momname) AS patmomname, a.hrgnum_isunknown AS isunknown, a.hrgstr_contact_no AS pataddcontactno, a.hrgnum_id_no AS patidno, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, \
										a.hrgstr_spousename AS pathusbandname, a.hrgstr_national_id AS patnationalid, a.hbnum_bldgrp_code AS patbloodgroup, a.hrgnum_mother_puk AS patmothercrno, b.hrgstr_city AS pataddcity, \
										INITCAP (b.hrgstr_district) AS patadddistrict, b.gnum_state_code AS pataddstatecode, b.hrgnum_pincode AS pataddpin, b.gnum_country_code AS pataddcountrycode, \
										b.hrgstr_house_no AS pataddhno, b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, b.gnum_city_loc_code AS pataddcityloccode, (SELECT INITCAP \
										(c.gstr_statename) FROM gblt_state_mst c WHERE c.gnum_statecode = b.gnum_state_code AND c.gnum_hospital_code = a.gnum_hospital_code) pataddstate, (SELECT INITCAP \
										(d.gstr_countryname) FROM gblt_country_mst d WHERE d.gnum_countrycode = b.gnum_country_code AND d.gnum_hospital_code = a.gnum_hospital_code) pataddcountry, (DECODE (b.hrgnum_is_local, \
										1, (SELECT INITCAP (e.gstr_city_loc_name) FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = b.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code \
										AND gnum_isvalid = 1), b.hrgstr_city_location ) ) pataddcityloc \
										FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ? AND a.gnum_hospital_code = b.gnum_hospital_code(+) AND NVL (b.gnum_add_type_code, 1) = 1 AND a.gnum_isvalid = b.gnum_isvalid(+)

#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.SEARCH.PATIENT=	SELECT a.hrgnum_puk AS patcrno, TO_CHAR (a.hrgdt_dob, 'dd-Mon-YYYY') AS patdob, a.hrgbl_is_actual_dob AS isactualdob, INITCAP (a.hrgstr_fname) AS patfirstname, \
										INITCAP (a.hrgstr_mname) AS patmiddlename, INITCAP (a.hrgstr_lname) AS patlastname, a.gstr_gender_code,(SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code = \
										a.gstr_gender_code ) AS patgender, a.hrgstr_idmark1 AS patidmark, INITCAP (a.hrgstr_father_name) AS patguardianname, \
										INITCAP (a.hrgstr_momname) AS patmomname, a.hrgnum_isunknown AS isunknown,  a.hrgnum_id_no AS patidno, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, \
										a.hrgstr_spousename AS pathusbandname, a.hrgstr_national_id AS patnationalid, a.hbnum_bldgrp_code AS patbloodgroup, a.hrgnum_mother_puk AS patmothercrno, b.hrgstr_city AS pataddcity, \
										INITCAP (b.hrgstr_district) AS patadddistrict, b.gnum_state_code AS pataddstatecode, b.hrgnum_pincode AS pataddpin, b.GSTR_country_code AS pataddcountrycode, \
										 b.hrgstr_address_line1 AS pataddhno, b.hrgstr_sub_locality1 AS pataddstreet, b.hrgstr_phone_no AS pataddcontactno,  b.hrgstr_city AS pataddcityloccode,b.hrgstr_state_name AS pataddstate, b.gstr_country_code AS pataddcountry, b.hrgstr_city_location AS pataddcityloc,(SELECT INITCAP (h.gstr_hospital_name) FROM gblt_hospital_mst h WHERE h.gnum_hospital_code = a.gnum_hospital_code and h.gnum_isvalid=1) patRefHospitalName \
										FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND a.gnum_isvalid = ? AND a.gnum_hospital_code = b.gnum_hospital_code(+) AND NVL (b.gnum_add_type_code, 1) = 1 AND a.gnum_isvalid = b.gnum_isvalid(+)
							
INSERT.HRGT_PATIENT_IMAGE_DTL = INSERT INTO hrgt_patient_image_dtl (hrgnum_puk, hrgnum_slno, hrgnum_episode_code, hrgnum_is_default,hrgstr_ip_add, gnum_seat_id, gdt_entry_date, gnum_isvalid, \
								gnum_hospital_code, gdt_lstmod_date, gnum_lstmod_seatid,hrgstr_fileno, hrgstr_path) VALUES (?, (SELECT NVL (MAX (hrgnum_slno), 0) + 1 FROM hrgt_patient_image_dtl where hrgnum_puk = ? ), \
								?,?,?,?,SYSDATE,?,?,?,?,?,?)
										
INSERT.WITH.EXPIRY.DATE.HRGT_SECCAT_CHANGE_DTL=		INSERT INTO HRGT_SECCAT_CHANGE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HGNUM_PATIENT_CAT_CODE, HRGNUM_PREV_TREATMENT_CAT_CODE, HRGNUM_NEW_TREATMENT_CAT_CODE, HRGSTR_REMARKS, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,HRGDT_VALID_UPTO) VALUES (?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_SECCAT_CHANGE_DTL WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=?),?,?,?,?,?,SYSDATE,?,?,?,?)									

INSERT.HRGT_PATIENT_BROUGHTBY_DTL = INSERT INTO HRGT_PATIENT_BROUGHTBY_DTL (HRGNUM_PUK, HRGNUM_SLNO, HRGNUM_EPISODE_CODE, HRGSTR_BROUGHT_BY_NAME, \
										HRGSTR_BROUGHT_BY_ADDRESS, HRGSTR_BROUGHT_BY_PHONE, GNUM_GENDER_CODE, GNUM_ISRELATIVE, GNUM_RELATION_CODE, \
										HRGSTR_IP_ADD, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_HOSPITAL_CODE,HRGSTR_BROUGHT_LOCATION, \
										HRGNUM_VISIT_NO, HRGSTR_CONSTABLE_DESIG, HRGSTR_CONSTABLE_BADGENO) \
										VALUES (?, (SELECT NVL (MAX (HRGNUM_SLNO), 0) + 1 FROM HRGT_PATIENT_BROUGHTBY_DTL WHERE HRGNUM_PUK=? \
										AND HRGNUM_EPISODE_CODE =? AND HRGNUM_VISIT_NO = ?),?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?,?,?,? ) 


UPDATE.HRGT_PATIENT_BROUGHTBY_DTL	=	update hrgt_patient_broughtby_dtl set GNUM_ISVALID=?  WHERE hrgnum_puk = ? AND hrgnum_slno = (SELECT MAX (hrgnum_slno) from hrgt_patient_broughtby_dtl  WHERE hrgnum_puk = ?)

SELECT.MAX_SNO.HRGT_PATIENT_IMAGE_DTL = SELECT NVL (MAX (hrgnum_slno), 0) + 1   FROM HRGT_PATIENT_IMAGE_DTL  WHERE hrgnum_puk = ?  AND gnum_hospital_code = ?						

GENRATE_ROOM_CODE.EMERGENCY = select ahis_reg.EmrRoomNo(?,?) from dual									

INSERT.HRGT_FILENO_CHANGE_DTL=	INSERT INTO hrgt_fileno_change_dtl a (hrgnum_puk, hrgnum_episode_code, hrgnum_s_no, hrgnum_visit_no, hrgstr_old_file_no, hrgstr_new_file_no, hrgstr_remarks, hrgstr_ip_add, gdt_entry_date, gnum_isvalid, gnum_seat_id, gnum_hospital_code,HRGNUM_ENTRY_MODE ) \
								VALUES (?, ?, (SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM hrgt_fileno_change_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND gnum_hospital_code = ? ), ?, ?, ?, ?, ?, SYSDATE, ?, ?, ? ,?)
								
UPDATE.FILE_NUMBER.HRGT_DAILY_PATIENT_DTL=	update HRGT_DAILY_PATIENT_DTL set HRGSTR_FILE_NO=? where HRGNUM_PUK=? and HRGNUM_EPISODE_CODE = ? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? AND HRGNUM_VISIT_NO=?								

GENERATE.FILE_NUMBER.AHIS_REG_GenerateFileNo=	select AHIS_REG.Generatefileno(?,?) from dual



INSERT.HRGT_RENEW_DTL=	INSERT INTO hrgt_renew_dtl (hrgnum_puk, hrgnum_s_no, hrgnum_renewal_type, hrgdt_old_expiry, hrgdt_new_expiry, gbl_isvalid, gnum_seat_id, gdt_entry_date, gnum_dept_code, hgnum_deptunitcode, hrgstr_ip_add, gnum_hospital_code ) \
						VALUES (?,(SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM hrgt_renew_dtl WHERE hrgnum_puk = ? AND gnum_hospital_code = ?), ?, TO_DATE (?, 'dd-mm-yyyy'), ROUND (TO_DATE (?|| '-'  || DECODE (SIGN (  TO_CHAR (TO_DATE (SUBSTR (?, \
						4, 3 ), 'MM' ), 'MM' ) - TO_CHAR (SYSDATE, 'MM') ), -1, TO_CHAR (SYSDATE, 'YYYY') + 1, TO_CHAR (SYSDATE, 'YYYY') ), 'dd-mm-yyyy') ), ?,?, SYSDATE,?, ?,?,?)
						
INSERT_OLD_PATIENT.HRGT_RENEW_DTL=	INSERT INTO hrgt_renew_dtl (hrgnum_puk, hrgnum_s_no, hrgnum_renewal_type, hrgdt_old_expiry, hrgdt_new_expiry, gbl_isvalid, gnum_seat_id, gdt_entry_date, gnum_dept_code, hgnum_deptunitcode, hrgstr_ip_add, gnum_hospital_code ) \
							VALUES (?,(SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM hrgt_renew_dtl WHERE hrgnum_puk = ? AND gnum_hospital_code = ?), ?, TO_DATE (?, 'dd-mm-yyyy'), TO_DATE ( ?,'dd-mm-yyyy'), ?,?, SYSDATE,?, ?,?,?)


SELECT.BROUGHT_DETAIL_BY_CRNO.HRGT_PATIENT_BROUGHTBY_DTL = SELECT hrgnum_episode_code as episodeCode, hrgstr_brought_by_name as broughtByName, hrgstr_brought_by_address as broughtByAddress,hrgstr_brought_by_phone as broughtByPhone, gnum_gender_code as broughtByGenderCode, gnum_isrelative as isRelative , \
															gnum_relation_code as broughtByRelationCode, hrgstr_ip_add as systemIPAddress, gnum_seat_id as seatId,TO_CHAR(gdt_entry_date,'dd-Mon-yyyy') as entryDate, hrgstr_brought_location as broughtByLocation \
															FROM hrgt_patient_broughtby_dtl WHERE hrgnum_puk = ? AND hrgnum_slno = (SELECT MAX (hrgnum_slno) FROM hrgt_patient_broughtby_dtl WHERE hrgnum_puk = ?) AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?

															
INSERT.HRGT_MLCDOC_UPLOAD_DTL = INSERT INTO hrgt_mlcdoc_upload_dtl (hrgstr_mlc_no, hrgnum_puk, hrgnum_s_no, hrgstr_verification_documents, hrgstr_file_name, hrgstr_remarks, \
								gdt_entry_date, gnum_seat_id, gnum_isvalid, gnum_hospital_code ) VALUES (?, ?, (SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM hrgt_mlcdoc_upload_dtl \
								WHERE hrgnum_puk = ? AND gnum_hospital_code = ?), ?, ?, ?, SYSDATE, ?, ?, ? )
								
SELECT.MAX_SNO.HRGT_MLCDOC_UPLOAD_DTL = SELECT TO_CHAR (NVL (MAX (hrgnum_s_no), 0) + 1)   FROM hrgt_mlcdoc_upload_dtl  WHERE hrgnum_puk = ? AND hrgstr_mlc_no = ? AND gnum_hospital_code = ?
								


GENRATE_ROOM_CODE.EMERGENCY = select ahis_reg.EmrRoomNo(?,?) from dual




SELECT.REPRINT_CARD.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO = SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,hrgstr_file_no AS filenoview,hrgstr_file_no AS fileno, a.hrgnum_visit_no AS episodevisitno,TO_CHAR(HRGDT_EPISODE_DATE,'dd-Mon-yyyy') AS episodedate, \
													a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno,a.hrgnum_is_episode_open AS episodeisopen, \
													(SELECT INITCAP (e.gstr_dept_name) FROM GBLT_DEPARTMENT_MST e WHERE e.gnum_dept_code = a.gnum_dept_code AND e.gnum_hospital_code = a.gnum_hospital_code AND e.gnum_isvalid=1 \
													AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department, \
													(SELECT INITCAP (g.hgstr_unitname) FROM HGBT_UNIT_MST g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND g.gnum_hospital_code = a.gnum_hospital_code AND g.gnum_isvalid=1 \
													AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentunit, \
													(DECODE ((SELECT hopnum_deptunitcode FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
													AND (   hopnum_deptunitcode = a.hgnum_next_visit_deptunitcode OR hopnum_deptunitcode = a.hgnum_deptunitcode) \
													AND gnum_hospital_code = a.gnum_hospital_code and rownum=1),NULL, 'Unit Closed','Unit Working')) deptunitisonduty, \
													(DECODE ((SELECT gnum_isvalid FROM HGBT_UNIT_MST WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND \
													gnum_hospital_code = a.gnum_hospital_code  AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)), \
													0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,TO_CHAR(GDT_ENTRY_DATE,'dd/mm/yyyy hh24:mi') AS entrydate, \
													(DECODE ((SELECT m.gdt_entry_date FROM HRGT_EPISODE_DTL m WHERE TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') = TO_CHAR (SYSDATE, 'dd-mon-yyyy') \
													AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk AND m.gnum_hospital_code = a.gnum_hospital_code \
													AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM HRGT_EPISODE_DTL k WHERE (k.hrgnum_puk = a.hrgnum_puk) \
													AND (k.gnum_hospital_code = a.gnum_hospital_code ) AND (k.hrgnum_episode_code = a.hrgnum_episode_code) AND (k.gnum_isvalid = 1))),NULL, 0,1)) visitedtoday, \
													(SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code \
													AND gnum_isvalid = a.gnum_isvalid) room,(SELECT DISTINCT hrgnum_amt_collected FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code \
													AND hrgnum_visit_no = 1 and rownum=1)patAmountCollected, \
												    (select HGSTR_INITIAL  from hgbt_consultant_initial_mst  where GNUM_ISVALID=1 and  GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and HOPNUM_DAY_OF_WEEK=TO_CHAR(a.GDT_ENTRY_DATE,'d') and   HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE   ) AS unitconsultant,  \
												    (SELECT HGNUM_ISGENERAL FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isGeneral, \
												    (SELECT HGSTR_CARDPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) cardprintsetting, \
												    decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code \
												    AND gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = r.gnum_isvalid) FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk \
										            AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) ,2, \
										            (SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (0,2) \
										            AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment, \
												    A.HRGNUM_ISCARDPRINT AS isCardPrint \
												    FROM HRGT_EPISODE_DTL a WHERE  (a.gnum_isvalid = ?) and HRGNUM_VISIT_TYPE<>0 AND (a.gnum_hospital_code = ?) \
													AND TRUNC(GDT_ENTRY_DATE)=TRUNC(SYSDATE) AND (a.hrgnum_puk = ?)  ORDER BY a.hrgnum_episode_code 



SELECT.RENEWAL_CARD.UNIT.WISE.HRGT_RENEW_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, hrgstr_file_no AS filenoview, hrgstr_file_no AS fileno, TO_CHAR (a.gdt_entry_date, 'dd/mm/yyyy hh24:mi') AS entrydate, a.hrgnum_visit_no AS episodevisitno, TO_CHAR (hrgdt_episode_date, 'dd-Mon-yyyy') AS episodedate, \
												a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_episode_open AS episodeisopen, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND e.gnum_hospital_code = a.gnum_hospital_code \
												AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) department, (SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND g.gnum_hospital_code = a.gnum_hospital_code \
												AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) departmentunit, (DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE AND (   hopnum_deptunitcode = \
												a.hgnum_next_visit_deptunitcode OR hopnum_deptunitcode = a.hgnum_deptunitcode) AND gnum_hospital_code = a.gnum_hospital_code AND ROWNUM = 1), NULL, 'Unit Closed', 'Unit Working')) deptunitisonduty, (DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode \
												AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)), 0, 1, 1, 0, 2, 1, NULL, 3)) deptunitisclosed, (DECODE ((SELECT m.gdt_entry_date FROM hrgt_episode_dtl m WHERE \
												TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') = TO_CHAR (SYSDATE, 'dd-mon-yyyy') AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk AND m.gnum_hospital_code = a.gnum_hospital_code AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM hrgt_episode_dtl k \
												WHERE (k.hrgnum_puk = a.hrgnum_puk) AND (k.gnum_hospital_code = a.gnum_hospital_code) AND (k.hrgnum_episode_code = a.hrgnum_episode_code) AND (k.gnum_isvalid = 1))), NULL, 0, 1)) visitedtoday, (SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code AND \
												gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) room, (SELECT DISTINCT hrgnum_amt_collected FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no and rownum=1) patamountcollected, \
												(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant, \
												(SELECT HGNUM_ISGENERAL FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isGeneral, \
												(SELECT HGSTR_CARDPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) cardprintsetting, \
												decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code AND gnum_isvalid = 1) FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk \
												AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) ,2, (SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk \
												AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (0,2) AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment \
												FROM hrgt_episode_dtl a, hrgt_renew_dtl b \
												WHERE (b.hrgnum_puk = ?) and b.hrgnum_puk=a.hrgnum_puk AND (b.gbl_isvalid = ?) and b.gbl_isvalid=a.gnum_isvalid AND (b.gnum_hospital_code = ?) and b.gnum_hospital_code=a.gnum_hospital_code AND TRUNC (b.gdt_entry_date) = TRUNC (SYSDATE)  AND TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE) \
												and a.hgnum_deptunitcode=B.HGNUM_DEPTUNITCODE AND hrgnum_renewal_type IN (3, 4, 5) ORDER BY a.hrgnum_episode_code

												
SELECT.RENEWAL_CARD.HOSPITAL.WISE.HRGT_RENEW_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, TO_CHAR (hrgdt_episode_date, 'dd-Mon-yyyy') AS episodedate, a.gnum_dept_code AS departmentcode,TO_CHAR (gdt_entry_date, 'dd/mm/yyyy hh24:mi') AS entrydate \
													a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_episode_open AS episodeisopen, (SELECT INITCAP (e.gstr_dept_name) FROM GBLT_DEPARTMENT_MST e WHERE e.gnum_dept_code = a.gnum_dept_code \
													AND e.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department, (SELECT INITCAP (g.hgstr_unitname) FROM \
													HGBT_UNIT_MST g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND g.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) \
													departmentunit, (DECODE ((SELECT hopnum_deptunitcode FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE AND (hopnum_deptunitcode = a.hgnum_next_visit_deptunitcode OR \
													hopnum_deptunitcode = a.hgnum_deptunitcode ) AND gnum_hospital_code = a.gnum_hospital_code and rownum=1), NULL, 'Unit Closed', 'Unit Working' ) ) deptunitisonduty, (DECODE ((SELECT gnum_isvalid FROM HGBT_UNIT_MST WHERE \
													hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code), 0, 1, 1, 0,  2, 1, NULL, 3)) deptunitisclosed, (DECODE ((SELECT m.gdt_entry_date FROM HRGT_EPISODE_DTL m WHERE \
													TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') = TO_CHAR (SYSDATE, 'dd-mon-yyyy') AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk AND m.gnum_hospital_code = a.gnum_hospital_code \
													AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM HRGT_EPISODE_DTL k WHERE (k.hrgnum_puk = a.hrgnum_puk) AND (k.gnum_hospital_code = a.gnum_hospital_code ) AND (k.hrgnum_episode_code = a.hrgnum_episode_code) \
													AND (k.gnum_isvalid = ?))), NULL, 0, 1) ) visitedtoday , (SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code \
             										AND gnum_isvalid = a.gnum_isvalid) room,(SELECT DISTINCT hrgnum_amt_collected FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code \
                      								AND hrgnum_visit_no = (SELECT max(hrgnum_visit_no) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk)AND (hrgnum_episode_code = a.hrgnum_episode_code)AND (gnum_isvalid = a.gnum_isvalid) \
					 								AND (gnum_hospital_code = a.gnum_hospital_code))patAmountCollected FROM HRGT_EPISODE_DTL a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) AND (a.gnum_hospital_code = ?) AND TO_CHAR(HRGDT_EPISODE_DATE,'dd-mm-yyyy')= (SELECT \
													TO_CHAR( MAX(HRGDT_EPISODE_DATE),'dd-mm-yyyy') FROM HRGT_EPISODE_DTL  WHERE  TO_CHAR(HRGDT_EPISODE_DATE,'yyyy')<= TO_CHAR(SYSDATE-365,'yyyy') AND hrgnum_puk=a.hrgnum_puk AND hgnum_deptunitcode = a.hgnum_deptunitcode) \
													AND  a.hgnum_deptunitcode NOT  IN (SELECT DISTINCT  hgnum_deptunitcode FROM HRGT_CARD_PRINT_DTL   WHERE  TO_CHAR(GDT_ENTRY_DATE,'yyyy')= TO_CHAR(SYSDATE,'yyyy') AND HRGSTR_CARD_PRINT_FLAG=4 AND hrgnum_puk=a.hrgnum_puk) \
													AND a.hrgnum_puk IN  (SELECT a.hrgnum_puk FROM HRGT_RENEW_DTL WHERE   TO_CHAR(GDT_ENTRY_DATE,'yyyy')= TO_CHAR(SYSDATE,'yyyy')  AND (HRGNUM_RENEWAL_TYPE=1 OR HRGNUM_RENEWAL_TYPE=2) AND hrgnum_puk=a.hrgnum_puk) 

INSERT.REPRINT_DUPLICATE_CARD.HRGT_CARD_PRINT_DTL29-Jun-2010 = INSERT INTO HRGT_CARD_PRINT_DTL \
													(HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGSTR_REMARKS, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, \
													HRGSTR_CARD_PRINT_FLAG, GBL_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGSTR_IP_ADD, GNUM_HOSPITAL_CODE) \
													VALUES(?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_CARD_PRINT_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,?,?,?,?,SYSDATE,?,?)

INSERT.REPRINT_DUPLICATE_CARD.HRGT_CARD_PRINT_DTL = INSERT INTO HRGT_CARD_PRINT_DTL \
													(HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGSTR_REMARKS, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, \
													HRGSTR_CARD_PRINT_FLAG, GBL_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGSTR_IP_ADD, GNUM_HOSPITAL_CODE) \
													VALUES(?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_CARD_PRINT_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=? and HRGNUM_EPISODE_CODE=? and HRGNUM_VISIT_NO=?),?,?,?,?,?,?,?,?,SYSDATE,?,?)
									


														
SELECT.DUPLICATE_CARD.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO = SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode, hrgstr_file_no AS filenoview,hrgstr_file_no AS fileno, to_char(gdt_entry_date,'dd/mm/yyyy hh24:mi') AS entryDate, \
														a.hrgnum_visit_no AS episodevisitno,TO_CHAR(HRGDT_EPISODE_DATE,'dd-Mon-yyyy') AS episodedate, a.gnum_dept_code AS departmentcode, \
														a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno,a.hrgnum_is_episode_open AS episodeisopen, \
														(SELECT INITCAP (e.gstr_dept_name) FROM GBLT_DEPARTMENT_MST e WHERE e.gnum_dept_code = a.gnum_dept_code AND e.gnum_hospital_code = a.gnum_hospital_code \
														AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) department, \
														(SELECT INITCAP (g.hgstr_unitname) FROM HGBT_UNIT_MST g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND g.gnum_hospital_code = a.gnum_hospital_code \
														AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)) departmentunit, \
														(DECODE ((SELECT hopnum_deptunitcode FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
														AND (   hopnum_deptunitcode = a.hgnum_next_visit_deptunitcode OR hopnum_deptunitcode = a.hgnum_deptunitcode) \
														AND gnum_hospital_code = a.gnum_hospital_code and rownum=1),NULL, 'Unit Closed','Unit Working')) deptunitisonduty, \
														(DECODE ((SELECT gnum_isvalid FROM HGBT_UNIT_MST WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code \
														 AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date)), \
														0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed, \
														(DECODE ((SELECT m.gdt_entry_date FROM HRGT_EPISODE_DTL m WHERE TO_CHAR (m.gdt_entry_date, 'dd-mon-yyyy') = TO_CHAR (SYSDATE, 'dd-mon-yyyy') \
														AND m.hrgnum_episode_code = a.hrgnum_episode_code AND m.hrgnum_puk = a.hrgnum_puk AND m.gnum_hospital_code = a.gnum_hospital_code \
														AND m.hrgnum_visit_no >= ALL (SELECT k.hrgnum_visit_no FROM HRGT_EPISODE_DTL k WHERE (k.hrgnum_puk = a.hrgnum_puk) \
														AND (k.gnum_hospital_code = a.gnum_hospital_code) AND (k.hrgnum_episode_code = a.hrgnum_episode_code) \
														AND (k.gnum_isvalid = 1))),NULL, 0,1) ) visitedtoday,  (SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code \
														AND gnum_isvalid = a.gnum_isvalid) room,(SELECT DISTINCT hrgnum_amt_collected FROM hrgt_reg_charge_dtl WHERE hrgnum_puk = a.hrgnum_puk \
														AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = 1 and ROWNUM=1)patAmountCollected , \
														(select HGSTR_INITIAL  from hgbt_consultant_initial_mst  where GNUM_ISVALID=1 and  GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and HOPNUM_DAY_OF_WEEK=TO_CHAR(a.GDT_ENTRY_DATE,'d') and   HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE   ) AS unitconsultant,  \
														(SELECT HGNUM_ISGENERAL FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isGeneral, \
														(SELECT HGSTR_CARDPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) cardprintsetting, \
														decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code AND gnum_isvalid = 1) \
														FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND gnum_hospital_code = a.gnum_hospital_code AND \
														gnum_isvalid = a.gnum_isvalid) ,2,(SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no  AND HRGSTR_IS_REFF_IN_OUT in (0,2)\
														AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment, \
														A.HRGNUM_ISCARDPRINT AS isCardPrint \
														FROM HRGT_EPISODE_DTL a  WHERE  (a.gnum_isvalid = 1)AND (a.gnum_hospital_code = ?) AND HRGNUM_VISIT_NO = (SELECT MAX (HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL WHERE    gnum_isvalid = a.gnum_isvalid \
														AND gnum_hospital_code = a.gnum_hospital_code    AND hrgnum_episode_code = a.hrgnum_episode_code  AND hrgnum_puk = a.hrgnum_puk) AND (a.hrgnum_puk = ?)  \
														ORDER BY a.hrgnum_episode_code



SELECT.OLD_PAT_REFER.HRGT_EPISODE_REF_DTL = SELECT a.hrgnum_puk AS patcrno,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, \
											(SELECT gstr_dept_name  FROM gblt_department_mst  WHERE gnum_dept_code = a.hrgnum_from_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS fromdepartment, \
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_from_deptunitcode 	and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) fromdepartmentunit, \
											TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime,INITCAP (a.gstr_remarks) AS remarks,\
											hrgnum_to_dept_code AS todepartmentcode,\
											(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartment,\
											hgnum_to_deptunitcode AS todepartmentunitcode,\
											a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno,\
											(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode =a.hgnum_to_deptunitcode and gnum_hospital_code=a.gnum_hospital_code \
											and gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) AS todepartmentunit,( select \
											c.HRGSTR_MLC_NO from HRGT_EPISODE_DTL c where c.hrgnum_puk = a.hrgnum_puk AND c.hrgnum_episode_code = a.hrgnum_episode_code AND \
											c.hrgnum_visit_no = a.hrgnum_visit_no AND c.gnum_hospital_code = a.gnum_hospital_code) as mlcno \
											FROM hrgt_episode_ref_dtl a,hrgt_daily_patient_dtl b \
											WHERE b.hrgnum_puk = a.hrgnum_puk  AND b.hrgnum_episode_code = a.hrgnum_episode_code \
											AND b.hrgnum_visit_no = a.hrgnum_visit_no  AND b.gnum_dept_code = a.hrgnum_from_dept_code \
											AND a.gdt_acceptance_date IS NULL  AND a.hrgnum_to_dept_code IS NOT NULL  \
											and b.gnum_hospital_code=a.gnum_hospital_code  and a.gnum_hospital_code=? \
											AND a.hrgnum_to_dept_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl e, gblt_metatable_column_mst f \
											WHERE e.gnum_metatable_id = f.gnum_metatable_id  AND f.gstr_table_name = 'GBLT_DEPARTMENT_MST' \
											AND gstr_column_name = 'GNUM_DEPT_CODE' and e.gnum_hospital_code=f.gnum_hospital_code and e.gnum_hospital_code=a.gnum_hospital_code AND  e.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,a.GNUM_HOSPITAL_CODE) ) \
											AND a.hrgnum_to_dept_code in( SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE \
											GNUM_DEPT_CODE=a.hrgnum_to_dept_code  and   HRGNUM_VISIT_TYPE IN (1, 4) AND  HRGNUM_IS_EPISODE_OPEN=1 AND HRGNUM_PUK=a.hrgnum_puk)    AND ((SYSDATE - hrgdt_reff_date_time)) < ?	order by patname
											
											
SELECT.OLD_PATIENT_DEPT_EPISODES.HRGT_EPISODE_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno,a.hrgstr_file_no as fileNoView, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE \
												AND (   hopnum_deptunitcode=a.hgnum_next_visit_deptunitcode OR hopnum_deptunitcode =a.hgnum_deptunitcode) and rownum=1),NULL, 0,1)) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,check_visited_today (a.hrgnum_puk,a.hgnum_deptunitcode,a.hrgnum_episode_code,a.gnum_hospital_code) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isgeneral, \
												DECODE(SIGN ((SELECT   TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY')- TO_DATE (SYSDATE, 'DD-MM-YYYY') FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = a.hrgnum_episode_code and gnum_hospital_code=a.gnum_hospital_code AND (gnum_isvalid = ?) AND hrgnum_visit_no >=ALL (SELECT az.hrgnum_visit_no \
												AS episodevisitno FROM hrgt_episode_dtl az WHERE (az.hrgnum_puk = ?) AND (az.hrgnum_episode_code = a.hrgnum_episode_code ) AND (az.gnum_isvalid = ?) and ( gnum_hospital_code=a.gnum_hospital_code))) \
												),1, 0,-1, 1,0) renewalrequired FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = ?) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = ?)) AND a.gdt_entry_date >= ALL (SELECT z.gdt_entry_date FROM hrgt_episode_dtl z \
												WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) and (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = ?))   \
												and  a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e \
												WHERE d.gnum_metatable_id = e.gnum_metatable_id and d.gnum_hospital_code=? and  d.gnum_hospital_code=e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' \
												AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,e.GNUM_HOSPITAL_CODE))  AND a.GNUM_DEPT_CODE=? \
												ORDER BY department, departmentunit
																								
SELECT.OLD_PATIENT_UNIT_EPISODES.HRGT_EPISODE_DTL=	SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno,AHIS_REG.FileNoView(a.hrgstr_file_no,a.gnum_hospital_code) as fileNoView, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt < = SYSDATE AND hopdt_end_dt > SYSDATE \
												AND (   hopnum_deptunitcode=a.hgnum_next_visit_deptunitcode OR hopnum_deptunitcode =a.hgnum_deptunitcode) and rownum=1),NULL, 0,1)) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,check_visited_today (a.hrgnum_puk,a.hgnum_deptunitcode,a.hrgnum_episode_code,a.gnum_hospital_code) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) isgeneral, \
												DECODE(SIGN ((SELECT   TO_DATE (hrgdt_exp_date, 'DD-MM-YYYY')- TO_DATE (SYSDATE, 'DD-MM-YYYY') FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = a.hrgnum_episode_code and gnum_hospital_code=a.gnum_hospital_code AND (gnum_isvalid = ?) AND hrgnum_visit_no >=ALL (SELECT az.hrgnum_visit_no \
												AS episodevisitno FROM hrgt_episode_dtl az WHERE (az.hrgnum_puk = ?) AND (az.hrgnum_episode_code = a.hrgnum_episode_code ) AND (az.gnum_isvalid = ?) and ( gnum_hospital_code=a.gnum_hospital_code))) \
												),1, 0,-1, 1,0) renewalrequired FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_no >= ALL (SELECT zz.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl zz WHERE (zz.hrgnum_puk = ?) AND (zz.hrgnum_episode_code = a.hrgnum_episode_code) AND (zz.gnum_hospital_code=a.gnum_hospital_code) AND (zz.gnum_isvalid = ?)) AND a.gdt_entry_date >= ALL (SELECT z.gdt_entry_date FROM hrgt_episode_dtl z \
												WHERE (z.hrgnum_puk = ?) AND (z.hgnum_deptunitcode = a.hgnum_deptunitcode) and (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = ?))   \
												and  a.hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl d, gblt_metatable_column_mst e \
												WHERE d.gnum_metatable_id = e.gnum_metatable_id and d.gnum_hospital_code=? and  d.gnum_hospital_code=e.gnum_hospital_code AND e.gstr_table_name = 'HGBT_UNIT_MST' \
												AND gstr_column_name = 'HGNUM_DEPTUNITCODE' AND d.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,e.GNUM_HOSPITAL_CODE))  AND a.hgnum_deptunitcode=? \
												ORDER BY department, departmentunit
												

UPDATE.OLD_PAT_ACCEPTANCEDATE.HRGT_EPISODE_REF_DTL = UPDATE HRGT_EPISODE_REF_DTL \
														SET HRGNUM_TO_DEPT_CODE=?, HGNUM_TO_DEPTUNITCODE=?, HRGSTR_TO_EPISODE_CODE=?, HRGSTR_IS_REFF_IN_OUT=?, GDT_ACCEPTANCE_DATE=SYSDATE \
														WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND HRGNUM_S_NO=? AND GNUM_HOSPITAL_CODE=?


INSERT.HRGT_PATIENT_PARICHIT_DTL=	insert into hrgt_patient_parichit_dtl (HRGNUM_PUK,HRGNUM_PARICHITVISIT_NO,HRGDT_VISIT_DATE,PSRSTR_DOC_VISITED,HRGSTR_VISIT_TIME, \
									GNUM_EPISODE_ACTION_CODE,HRGSTR_REMARKS,GNUM_ISVALID,HRGNUM_EPISODE_CODE,GNUM_SEAT_ID,GDT_ENTRY_DATE,HRGNUM_VISIT_NO,GNUM_HOSPITAL_CODE) \
									values(?,(SELECT NVL (MAX (HRGNUM_PARICHITVISIT_NO), 0) + 1  FROM hrgt_patient_parichit_dtl WHERE hrgnum_puk = ?  AND GNUM_HOSPITAL_CODE=?),\
									?,?,?,?,?,?,?,?,sysdate,?,?) 												
																																																
SELECT_PAT_CAT_LIST_EXCEPT_SELECTED_PAT_CAT.GBLT_PATIENT_CAT_MST=SELECT gnum_patient_cat_code||'#'||GNUM_IS_ID_REQ, gstr_patient_cat_name \
																FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_type = ? AND GNUM_HOSPITAL_CODE=? AND gnum_patient_cat_code != ? AND GDT_EFFECTIVE_FRM <= sysdate and (TO_DATE(TO_CHAR(NVL(GDT_EFFECTIVE_TO,SYSDATE)::timestamp,'DD-MM-YYYY'),'DD-MM-YYYY'))>=TO_DATE(TO_CHAR(SYSDATE,'DD-MM-YYYY'),'dd-mm-yyyy') and (GNUM_ISVALID =? OR GNUM_ISVALID =?) \
																AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b \
																WHERE a.gnum_metatable_id = b.gnum_metatable_id AND b.gstr_table_name = 'GBLT_PATIENT_CAT_MST' AND gstr_column_name = 'GNUM_PATIENT_CAT_CODE' \
																AND a.gnum_seatid = Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE=? AND a.GNUM_MODULE_ID =?) \
																ORDER BY gstr_patient_cat_name
																
																
UPDATE.PREVIOUS_ROW.HRGT_PATIENT_ADD_DTL_OLD = UPDATE HRGT_PATIENT_ADD_DTL SET GNUM_ISVALID=?, GDT_EFFECTIVE_TO=SYSDATE, HRGNUM_CHANGE_REQ_BY=?, HRGSTR_CHANGE_REQBY_NAME=?, HRGSTR_CHANGE_REQBY_ADD=?, \
											GNUM_RELATION_CODE=?, HRGSTR_CONSTABLE_BADGENO=?, HRGSTR_CONSTABLE_DESIG=? WHERE HRGNUM_PUK = ? AND HRGNUM_S_NO = ? AND GNUM_HOSPITAL_CODE = ?															


UPDATE.PREVIOUS_ROW.HRGT_PATIENT_ADD_DTL = UPDATE HRGT_PATIENT_ADD_DTL SET GNUM_ISVALID=?, GDT_EFFECTIVE_TO=SYSDATE  WHERE HRGNUM_PUK = ? AND HRGNUM_S_NO = ? AND GNUM_HOSPITAL_CODE = ?															



INSERT_NEW_ROW.HRGT_PATIENT_ADD_DTL_OLD = INSERT INTO HRGT_PATIENT_ADD_DTL \
										(HRGNUM_PUK, HRGNUM_S_NO, GNUM_ADD_TYPE_CODE, HRGSTR_CITY, HRGSTR_DISTRICT, NUM_DIST_ID, GNUM_STATE_CODE, HRGNUM_PINCODE, \
										GNUM_COUNTRY_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_LOCAL, HRGSTR_HOUSE_NO, HRGSTR_STREET_NO, \
										HRGSTR_CONTACT_NO, GNUM_CITY_LOC_CODE, IS_CURRENT_ADDRESSS, HRGSTR_CITY_LOCATION, HRGSTR_MOBILE_NO, \
										HRGSTR_FAX_NO, HRGSTR_EMAIL_ID, HRGSTR_STATE_NAME, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD, HRGNUM_VERIFICATION_SLNO,HRGNUM_IS_URBAN ) \
										VALUES(?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_ADD_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
										?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

INSERT_NEW_ROW.HRGT_PATIENT_ADD_DTL = INSERT INTO HRGT_PATIENT_ADD_DTL \
										(HRGNUM_PUK, HRGNUM_S_NO, GNUM_ADD_TYPE_CODE, HRGSTR_CITY, HRGSTR_DISTRICT, NUM_DIST_ID, GNUM_STATE_CODE, HRGNUM_PINCODE, \
										GNUM_COUNTRY_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_LOCAL, HRGSTR_HOUSE_NO, HRGSTR_STREET_NO, \
										HRGSTR_CONTACT_NO, GNUM_CITY_LOC_CODE, IS_CURRENT_ADDRESSS, HRGSTR_CITY_LOCATION, HRGSTR_MOBILE_NO, \
										HRGSTR_FAX_NO, HRGSTR_EMAIL_ID, HRGSTR_STATE_NAME, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD, HRGNUM_VERIFICATION_SLNO,HRGNUM_IS_URBAN,HRGNUM_CHANGE_REQ_BY, HRGSTR_CHANGE_REQBY_NAME, HRGSTR_CHANGE_REQBY_ADD, GNUM_RELATION_CODE,HRGSTR_CONSTABLE_BADGENO, HRGSTR_CONSTABLE_DESIG ) \
										VALUES(?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_ADD_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?), \
										?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

	
INSERT.HRGT_PATIENT_AUDIT_DTL=	insert into HRGT_PATIENT_AUDIT_DTL(HRGNUM_PUK,HRGSTR_PREV_PUK,HRGDT_DOB,HRGBL_IS_ACTUAL_DOB,HRGSTR_FNAME,HRGSTR_MNAME, \
								HRGSTR_LNAME,GNUM_GENDER_CODE,GNUM_MARITAL_STATUS_CODE,HGNUM_PAT_STATUS_CODE,HRGSTR_IDMARK1,HRGSTR_FATHER_NAME,HRGSTR_MOMNAME, \
								HRGNUM_REG_CAT_CODE,HGNUM_PATIENT_CAT_CODE,HRGDT_REGISTER_DATE,GDT_ENTRY_DATE,GNUM_SEAT_ID,HRGNUM_IS_MLC,GNUM_ISVALID, \
								HRGNUM_ISUNKNOWN,HRGNUM_MONTH_INCOME,HRGNUM_IS_URBAN,HRGNUM_ISREG_FREE,GNUM_DESIG_SEMESTER,HRGNUM_DEPT_STAFF_STUD, \
								HRGSTR_IP_ADD,HRGSTR_CONTACT_NO,HRGNUM_ID_NO,HRGNUM_IS_REF,GNUM_RELIGION_CODE,HRGSTR_AGE,GNUM_NATIONALITY_CODE,HRGNUM_IS_IMAGEUPLOADED, \
								HRGSTR_SPOUSENAME,HRGSTR_NATIONAL_ID,HBNUM_BLDGRP_CODE,HRGNUM_ISNEWBORN,HRGNUM_MOTHER_PUK,HRGDT_EXP_DATE,HRGSTR_PAT_OCCUPATION, \
								HRGSTR_FAT_OCCUPATION,HRGSTR_HUS_OCCUPATION,HRGSTR_NICKNAME,HRGSTR_CARD_NO,GNUM_HOSPITAL_CODE,HRGSTR_IDMARK2,HRGNUM_VERIFICATION_SLNO, \
								HRGNUM_IS_BROUGHTDEAD,GDT_LSTMOD_DATE,GNUM_LSTMOD_SEATID,HRGNUM_CHANGE_REQ_BY, HRGSTR_CHANGE_REQBY_NAME, HRGSTR_CHANGE_REQBY_ADD, \
								GNUM_RELATION_CODE, HRGSTR_CONSTABLE_BADGENO, HRGSTR_CONSTABLE_DESIG) \
								values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd-Mon-yyyy hh:mi:ss am'),to_date(?,'dd-Mon-yyyy hh:mi:ss am'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?)	



SELECT.RETRIEVE_ALL_OPEN_MLC_EPISODES_BY_CRNO.HRGT_EPISODE_DTL17-11-09 =	SELECT A.HRGNUM_EPISODE_CODE AS episodeCode, A.HRGNUM_VISIT_NO AS episodeVisitNo, \
																	NVL(A.HRGSTR_MLC_NO,'Yet To Be Alloted') AS mlcNo, \
																	A.HGNUM_DEPTUNITCODE AS departmentUnitCode, \
																	( SELECT INITCAP(GSTR_DEPT_NAME)||' ('||INITCAP(HGSTR_UNITNAME)||')' FROM GBLT_DEPARTMENT_MST B, HGBT_UNIT_MST C \
																	WHERE B.GNUM_DEPT_CODE=C.HGNUM_DEPT_CODE AND B.GNUM_HOSPITAL_CODE=C.GNUM_HOSPITAL_CODE \
																	AND C.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE \
																	AND B.GNUM_ISVALID=? AND C.GNUM_ISVALID=? \
																	AND TRUNC(B.GDT_EFFECTIVE_FRM)<=TRUNC(SYSDATE) AND TRUNC(NVL(B.GDT_EFFECTIVE_TO,SYSDATE+1))>=TRUNC(SYSDATE) \
																	AND TRUNC(C.GDT_EFFECTIVE_FRM)<=TRUNC(SYSDATE) AND TRUNC(NVL(C.GDT_EFFECTIVE_TO,SYSDATE+1))>=TRUNC(SYSDATE) ) AS departmentUnit \
																	FROM HRGT_EPISODE_DTL A \
																	WHERE A.HRGNUM_PUK = ? AND A.GNUM_ISVALID = ? AND A.HRGNUM_IS_EPISODE_OPEN=? AND A.HRGNUM_EPISODE_TYPE_CODE=? \
																	AND GNUM_HOSPITAL_CODE = ? AND TRUNC(to_date(a.hrgdt_episode_date)) = TRUNC(SYSDATE) ORDER BY A.HRGNUM_EPISODE_CODE

SELECT.RETRIEVE_ALL_OPEN_MLC_EPISODES_BY_CRNO.HRGT_EPISODE_DTL_06-06-09=	SELECT a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, NVL (a.hrgstr_mlc_no, 'Yet To Be Alloted') AS mlcno, a.hgnum_deptunitcode AS departmentunitcode, \
																(SELECT INITCAP (gstr_dept_name) FROM gblt_department_mst b WHERE b.gnum_dept_code =a.GNUM_DEPT_CODE AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_isvalid =? \
																AND TRUNC (b.gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (b.gdt_effective_to, SYSDATE + 1)) >= TRUNC (SYSDATE)) ||'( '|| (SELECT INITCAP (hgstr_unitname) from \
																hgbt_unit_mst c WHERE c.hgnum_deptunitcode = a.hgnum_deptunitcode AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_isvalid = ? AND TRUNC (c.gdt_effective_frm) <= TRUNC \
																(SYSDATE) AND TRUNC (NVL (c.gdt_effective_to, SYSDATE + 1)) >= TRUNC (SYSDATE))||' )' AS departmentunit FROM hrgt_episode_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? \
																AND a.hrgnum_is_episode_open = ? AND a.hrgnum_episode_type_code = ? AND a.gnum_hospital_code = ? and a.hrgstr_mlc_no is null AND a.hrgnum_visit_no = (SELECT max(hrgnum_visit_no) \
																FROM hrgt_episode_dtl d WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code) AND TRUNC \
																(TO_DATE (a.hrgdt_episode_date)) = TRUNC (SYSDATE) ORDER BY departmentunit

SELECT.RETRIEVE_ALL_OPEN_MLC_EPISODES_BY_CRNO.HRGT_EPISODE_DTL=	SELECT a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, a.hrgstr_mlc_no AS mlcno, a.hgnum_deptunitcode AS departmentunitcode, \
																(SELECT INITCAP (gstr_dept_name) FROM gblt_department_mst b WHERE b.gnum_dept_code =a.GNUM_DEPT_CODE AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_isvalid =? \
																AND TRUNC (b.gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (b.gdt_effective_to, SYSDATE + 1)) >= TRUNC (SYSDATE)) ||'( '|| (SELECT INITCAP (hgstr_unitname) from \
																hgbt_unit_mst c WHERE c.hgnum_deptunitcode = a.hgnum_deptunitcode AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_isvalid = ? AND TRUNC (c.gdt_effective_frm) <= TRUNC \
																(SYSDATE) AND TRUNC (NVL (c.gdt_effective_to, SYSDATE + 1)) >= TRUNC (SYSDATE))||' )' AS departmentunit,A.HRGNUM_EPISODE_TYPE_CODE episodeTypeCode FROM hrgt_episode_dtl a WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? \
																AND a.hrgnum_is_episode_open = ? AND a.gnum_hospital_code = ?  AND a.hrgnum_visit_no = (SELECT max(hrgnum_visit_no) \
																FROM hrgt_episode_dtl d WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code) AND TRUNC \
																(TO_DATE (a.hrgdt_episode_date)) = TRUNC (SYSDATE) ORDER BY departmentunit


UPDATE.REVOKE_MLC_EPISODE.HRGT_EPISODE_DTL	=	UPDATE HRGT_EPISODE_DTL SET HRGNUM_EPISODE_TYPE_CODE=? WHERE HRGNUM_PUK=? \
												AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND GNUM_HOSPITAL_CODE = ? 												

UPDATE.MLCEPI_TO_NONMLC.HRGT_DAILY_PATIENT_DTL =	UPDATE hrgt_daily_patient_dtl SET HRGNUM_EPISODE_TYPE_CODE = ? WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? \
													AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) AND gnum_hospital_code = ? AND hrgnum_s_no = (SELECT MAX (hrgnum_s_no) \
													FROM hrgt_daily_patient_dtl WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND TRUNC (gdt_entry_date) = TRUNC (SYSDATE) \
													AND gnum_hospital_code = ?)									

INSERT.HRGT_MLC_REVOKE_DTL	=	INSERT INTO HRGT_MLC_REVOKE_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HRGNUM_VISIT_NO, HRGSTR_MLC_NO, HRGSTR_REMARKS, HRGSTR_IP_ADD, \
								GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE) VALUES (?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_MLC_REVOKE_DTL \
								WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,SYSDATE,?,?,?)
																	
#Changed By Amit Garg as OPD G5 Changes
UPDATE.NEXT_VISIT_DETAIL.HRGT_EPISODE_DTL	=	UPDATE HRGT_EPISODE_DTL SET HRGNUM_IS_EPISODE_OPEN=?, HRGNUM_IS_CONFIRMED=?, hrgstr_visit_reason=? , \
												 HRGSTR_VISIT_NOTES=?,HRGDT_NEXT_VISIT_DATE=?::timestamp without time zone,HRGNUM_NEXTVISIT_CRITERIA=?,PSRSTR_DOC_EMP_NO=?,HRGNUM_NEXTVISIT_DURATION=?, \
												 GNUM_DOC_SEAT_ID=?,HRGSTR_KEYWORDS=?,HRGSTR_KEYWORDS_IDS=? ,hrgstr_episode_summary=?,HRGDT_EPISODE_CLOSE_DATE=?::timestamp without time zone WHERE	HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND GNUM_HOSPITAL_CODE=?  
												 
																	
SELECT.BY_EPISODE_VISIT.HRGT_EPISODE_DTL	=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, \
												A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_OLD AS PATISOLD, TO_CHAR(A.HRGDT_EPISODE_DATE,'dd-Mon-yyyy') AS EPISODEDATE, A.HRGTM_EPISODE_TIME AS EPISODETIME, \
												TO_CHAR(A.HRGDT_NEXT_VISIT_DATE,'dd-Mon-yyyy') AS EPISODENEXTVISITDATE, A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, A.HRGSTR_COMPLAINED_DTL AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP(A.PSRSTR_EMP_NAME) AS EMPNAME, A.GNUM_SEAT_ID AS SEATID, \
												TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, \
												A.HRGNUM_REFERRAL_ACCEPTANCE AS EPISODEREFERACCEPT, TO_CHAR(A.GDT_REFERRAL_ACCEPTANCE_DATE,'dd-Mon-yyyy') AS EPISODEREFERACCEPTDATE, A.HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, \
												(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE AND G.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) DEPARTMENT \
												FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK = ? AND A.HRGNUM_EPISODE_CODE = ? AND A.HRGNUM_VISIT_NO=? AND A.GNUM_HOSPITAL_CODE=?
												
SELECT.QUE_NO.HRGT_DAILY_PATIENT_DTL=SELECT COUNT (*) + 1   FROM hrgt_daily_patient_dtl \
									 WHERE gdt_entry_date >= TRUNC (SYSDATE)    AND hgnum_room_code =? \
								     AND hgnum_deptunitcode =?    AND GNUM_HOSPITAL_CODE=?  AND GNUM_ISVALID=?


UPDATE.QUE_NO_ROOM_NO_HRGT_DAILY_PATIENT_DTL1=update HRGT_DAILY_PATIENT_DTL  SET HRGNUM_QUE_NO=? ,HGNUM_ROOM_CODE=? \
						where HRGNUM_PUK=? and  HRGNUM_EPISODE_CODE=? and  HRGNUM_VISIT_NO=?	

UPDATE.QUE_NO_ROOM_NO_HRGT_DAILY_PATIENT_DTL=update HRGT_DAILY_PATIENT_DTL  SET HRGNUM_QUE_NO=? ,HGNUM_ROOM_CODE=? ,\
 						hgstr_room_name=(SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = ? AND gnum_hospital_code = ? AND gnum_isvalid = 1  )\
						where HRGNUM_PUK=? and  HRGNUM_EPISODE_CODE=? and  HRGNUM_VISIT_NO=?						

UPDATE.QUE_NO_ROOM_NO_HRGT_EPISODE_DTL=update HRGT_EPISODE_DTL  SET HRGNUM_QUE_NO=? ,HGNUM_ROOM_CODE=? \
						where HRGNUM_PUK=? and  HRGNUM_EPISODE_CODE=? and  HRGNUM_VISIT_NO=?  
												
												
UPDATE.SET.IS_URBAN.HRGT_PATIENT_DTL=	update hrgt_patient_dtl set HRGNUM_IS_URBAN=? where HRGNUM_PUK=?


SELECT_PAT_AUDIT_TRAIL.HRGT_PATIENT_DTL=SELECT hrgnum_puk AS patcrno, hrgstr_prev_puk AS prevcrno, to_char(hrgdt_dob,'dd-Mon-yyyy') AS patdob, hrgstr_fname AS patfirstname,hrgstr_mname AS patmiddlename, hrgstr_lname AS patlastname,gnum_gender_code AS patgendercode, \
				     (SELECT NVL (gstr_gender_name, 'NA') FROM gblt_gender_mst  WHERE gnum_gender_code = a.gnum_gender_code  AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = ?) AS patgender,  gnum_marital_status_code AS patmaritalstatuscode, \
			         (SELECT NVL (gstr_marital_status, 'NA')  FROM gblt_marital_status_mst WHERE gnum_marital_status_code =a.gnum_marital_status_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS patmaritalstatus, \
			           hrgstr_idmark1 AS patidmark1, hrgstr_father_name AS patguardianname,hrgstr_momname AS patmothername,  TO_CHAR (hrgdt_register_date, 'dd-Mon-yyyy hh24:mi') AS registerdate,\
			          (SELECT NVL (gstr_usr_name || '(' || GSTR_USER_NAME || ')', 'NA') FROM gblt_user_mst  WHERE gnum_userid = a.gnum_seat_id  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS seatid, hrgnum_month_income AS patmonthlyincome, \
			            DECODE (hrgnum_is_urban,0, 'Urban',1, 'Semi-Urban',2, 'Rural','NA') AS patisurban,hrgstr_ip_add AS systemipaddress, hrgstr_contact_no AS pataddcontactno,hrgnum_id_no AS patidno, gnum_religion_code AS patreligioncode, \
			           (SELECT NVL (gstr_religion_name, 'NA')  FROM gblt_religion_mst  WHERE gnum_religion_code = a.gnum_religion_code   AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = ?) AS patreligion,gnum_nationality_code AS patnationalitycode,\
			           (SELECT NVL (gstr_countryname, 'NA') FROM gblt_country_mst   WHERE gnum_countrycode = a.gnum_nationality_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS patnationality, hrgnum_is_imageuploaded, hrgstr_spousename AS pathusbandname,hrgstr_national_id AS patnationalid, \
			            DECODE (hrgnum_isnewborn, 1, 'Yes', 0, 'No', 'No') AS isnewborn,hrgnum_mother_puk AS patmothercrno, hrgstr_card_no AS patcardno,hrgstr_idmark2 AS patidmark2, \
			           (SELECT hrgnum_change_req_by  FROM hrgt_patient_audit_dtl  WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code AND gdt_lstmod_date = (SELECT MAX (gdt_lstmod_date)  FROM hrgt_patient_audit_dtl   WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code )) as requestBy, \
			           (SELECT DECODE (hrgnum_change_req_by,0, 'Self/Patient',1, 'Relative(' || hrgstr_change_reqby_name || ')',2, 'Police(' || hrgstr_change_reqby_name || ')','' )   FROM hrgt_patient_audit_dtl    WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code AND gdt_lstmod_date = (SELECT MAX (gdt_lstmod_date)      FROM hrgt_patient_audit_dtl    WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code )) as requestByName \
			            FROM hrgt_patient_dtl a  WHERE hrgnum_puk = ?     AND gnum_isvalid = ?    AND gnum_hospital_code = ? 
			            
			            
SELECT_PAT_AUDIT_TRAIL.HRGT_PATIENT_AUDIT_DTL=SELECT hrgnum_puk AS patcrno, hrgstr_prev_puk AS prevcrno, to_char(hrgdt_dob,'dd-Mon-yyyy') AS patdob, hrgstr_fname AS patfirstname,hrgstr_mname AS patmiddlename, hrgstr_lname AS patlastname,gnum_gender_code AS patgendercode, \
				     (SELECT NVL (gstr_gender_name, 'NA') FROM gblt_gender_mst  WHERE gnum_gender_code = a.gnum_gender_code  AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = ?) AS patgender,  gnum_marital_status_code AS patmaritalstatuscode, \
			         (SELECT NVL (gstr_marital_status, 'NA')  FROM gblt_marital_status_mst WHERE gnum_marital_status_code =a.gnum_marital_status_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS patmaritalstatus, \
			           hrgstr_idmark1 AS patidmark1, hrgstr_father_name AS patguardianname,hrgstr_momname AS patmothername,  TO_CHAR (HRGDT_REGISTER_DATE, 'dd-Mon-yyyy hh24:mi') AS registerdate,\
			          (SELECT NVL (gstr_usr_name || '(' || GSTR_USER_NAME || ')', 'NA') FROM gblt_user_mst  WHERE gnum_userid = a.GNUM_SEAT_ID  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS seatid, hrgnum_month_income AS patmonthlyincome, \
			            DECODE (hrgnum_is_urban,0, 'Urban',1, 'Semi-Urban',2, 'Rural','NA') AS patisurban,hrgstr_ip_add AS systemipaddress, hrgstr_contact_no AS pataddcontactno,hrgnum_id_no AS patidno, gnum_religion_code AS patreligioncode, \
			           (SELECT NVL (gstr_religion_name, 'NA')  FROM gblt_religion_mst  WHERE gnum_religion_code = a.gnum_religion_code   AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = ?) AS patreligion,gnum_nationality_code AS patnationalitycode,\
			           (SELECT NVL (gstr_countryname, 'NA') FROM gblt_country_mst   WHERE gnum_countrycode = a.gnum_nationality_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS patnationality, hrgnum_is_imageuploaded, hrgstr_spousename AS pathusbandname,hrgstr_national_id AS patnationalid, \
			            DECODE (hrgnum_isnewborn, 1, 'Yes', 0, 'No', 'No') AS isnewborn,hrgnum_mother_puk AS patmothercrno, hrgstr_card_no AS patcardno,hrgstr_idmark2 AS patidmark2 , \
			            hrgnum_change_req_by as requestBy,DECODE (hrgnum_change_req_by,0, 'Self/Patient',1, 'Relative(' || hrgstr_change_reqby_name || ')',2, 'Police(' || hrgstr_change_reqby_name || ')','' ) as requestByName,TO_CHAR (GDT_LSTMOD_DATE, 'dd-Mon-yyyy hh24:mi') AS lastModifyDate, \
			            (SELECT NVL (gstr_usr_name || '(' || GSTR_USER_NAME || ')', 'NA') FROM gblt_user_mst  WHERE gnum_userid = a.GNUM_LSTMOD_SEATID  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid ) AS lastModifySeatId \
			             FROM HRGT_PATIENT_AUDIT_DTL a  WHERE hrgnum_puk = ?     AND gnum_isvalid = ?    AND gnum_hospital_code = ?  order by GDT_LSTMOD_DATE desc,rownum desc
			            
			            
SELECT_PAT_AUDIT_TRAIL.HRGT_PATIENT_ADD_DTL=SELECT   hrgnum_puk AS patcrno, hrgnum_s_no AS serialno,gnum_add_type_code AS pataddtypecode, \
						  (SELECT gstr_address_type FROM gblt_address_type_mst WHERE gnum_address_type_code = a.gnum_add_type_code  AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = ?) AS pataddtype, hrgstr_city AS pataddcitylocmstvalue, gnum_state_code AS pataddstatecode,\
				          (SELECT gstr_statename  FROM gblt_state_mst  WHERE gnum_statecode = a.gnum_state_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS pataddstate,hrgnum_pincode AS pataddpin, gnum_country_code AS pataddcountrycode,\
				          (SELECT gstr_countryname  FROM gblt_country_mst  WHERE gnum_countrycode = a.gnum_country_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = ?) AS pataddcountry, \
				          (SELECT gstr_user_name || '(' || gstr_usr_name || ')'  FROM gblt_user_mst  WHERE gnum_userid = a.gnum_seat_id  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = ?) AS seatid,TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy hh24:mi') AS entrydate,hrgnum_is_local AS isaddressdelhi, hrgstr_house_no AS pataddhno,hrgstr_street_no AS pataddstreet,hrgstr_contact_no AS pataddcontactno,gnum_city_loc_code AS pataddcityloccode, \
				          (SELECT gstr_city_loc_name  FROM gblt_city_location_mst  WHERE gnum_city_loc_code = a.gnum_city_loc_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = ?) AS pataddcityloc,is_current_addresss AS iscurrentaddress,hrgstr_city_location AS pataddcity, hrgstr_phone_no AS pataddphoneno,hrgstr_mobile_no AS pataddmobileno, hrgstr_fax_no AS pataddfaxno,hrgstr_email_id AS pataddemailid,hrgstr_state_name AS pataddstatename,hrgstr_ip_add AS systemipaddress, num_dist_id AS patadddistrictcode,\
				          (SELECT str_dist_name  FROM gblt_district_mst  WHERE num_dist_id = a.num_dist_id   AND gnum_hospital_code = a.gnum_hospital_code  AND gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)) AS patadddistrict,hrgstr_district AS patadddistrictmstvalue , \
				          hrgnum_change_req_by as requestBy, DECODE (hrgnum_change_req_by,0, 'Self/Patient',1,  NVL ((SELECT gstr_relation_name  FROM gblt_relation_mst WHERE gnum_relation_code = a.gnum_relation_code AND gnum_isvalid = ? AND gnum_hospital_code = a.gnum_hospital_code),'Relation')  || '(' || hrgstr_change_reqby_name  || ')', 2, 'Police(' || hrgstr_change_reqby_name || ')', ''  ) AS requestbyName \
				          FROM hrgt_patient_add_dtl a   WHERE hrgnum_puk = ?  and  GNUM_HOSPITAL_CODE=? ORDER BY gnum_add_type_code, hrgnum_s_no  desc		 	            


			            
			            
SELECT_PAT_AUDIT_TRAIL.HRGT_PRICAT_CHANGE_DTL=SELECT hrgnum_puk AS patcrno, hrgnum_s_no AS serialno, to_char(gdt_entry_date,'dd-Mon-yyyy hh24:mi') AS entrydate,\
				      (SELECT gstr_user_name || '(' || gstr_usr_name || ')'  FROM gblt_user_mst   WHERE gnum_userid = a.gnum_seat_id   AND gnum_hospital_code = a.gnum_hospital_code  and GNUM_ISVALID= ?) AS seatid,hrgnum_new_patient_cat_code AS patnewprimarycatcode, \
			    	   (SELECT gstr_patient_cat_name   FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code =a.hrgnum_new_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  and GNUM_ISVALID= ? \
   AND gnum_cat_slno =(SELECT MAX (gnum_cat_slno) FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code =a.hrgnum_new_patient_cat_code   AND gnum_hospital_code = a.gnum_hospital_code  and GNUM_ISVALID= ? )) AS patnewprimarycat,hrgnum_prev_patient_cat_code AS patprevprimarycatcode, \
				       (SELECT gstr_patient_cat_name  FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code =a.hrgnum_prev_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code   and GNUM_ISVALID= ? \
    AND gnum_cat_slno =(SELECT MAX (gnum_cat_slno)  FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hrgnum_prev_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  and GNUM_ISVALID= ? )) AS patprevprimarycat,hrgstr_card_no AS cardno, hrgstr_ip_add AS systemipaddress,\
  					     hrgstr_issuing_authority AS issuingauthority,hrgstr_remarks AS remarks,\
  				        (SELECT substr(hrgstr_verification_documents,5)  FROM hrgt_verification_doc_used_dtl  WHERE gnum_menu_id = ?    AND hrgnum_puk =a.hrgnum_puk   AND hrgnum_s_no = a.hrgnum_verification_slno and GNUM_ISVALID= ?) as verificationdocumentid   FROM hrgt_pricat_change_dtl a  WHERE  gnum_isvalid =?  and hrgnum_puk = ?  and gnum_hospital_code = ?   order by entrydate desc ,rownum desc
  				        
  				        

SELECT_PAT_AUDIT_TRAIL.HRGT_SECCAT_CHANGE_DTL=SELECT   hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode,hrgnum_s_no AS serialno, hgnum_patient_cat_code AS patprimarycatcode,\
		         (SELECT gstr_patient_cat_name  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid   AND gnum_cat_slno = \
                 (SELECT MAX (gnum_cat_slno)   FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid)) AS patprimarycat,hrgnum_prev_treatment_cat_code AS patprevsecondarycatcode,\
                 (SELECT gstr_patient_cat_name  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code =a.HGNUM_PATIENT_CAT_CODE  AND gnum_hospital_code = a.gnum_hospital_code   AND gnum_isvalid = a.gnum_isvalid    AND gnum_cat_slno = \
                 (SELECT MAX (gnum_cat_slno) FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.HGNUM_PATIENT_CAT_CODE  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid))  AS patnewprimarycat, \
                 (SELECT gstr_patient_cat_name   FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.hrgnum_new_treatment_cat_code   AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid     AND gnum_cat_slno = \
                 (SELECT MAX (gnum_cat_slno) FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.hrgnum_new_treatment_cat_code AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid))  AS patnewsecondarycat, \
                 (SELECT gstr_patient_cat_name FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hrgnum_prev_treatment_cat_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND gnum_cat_slno =(SELECT MAX (gnum_cat_slno) \
				 FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hrgnum_prev_treatment_cat_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) AS patprevsecondarycat,hrgstr_remarks AS remarks, hrgstr_ip_add AS systemipaddress,  TO_CHAR(gdt_entry_date,'DD-Mon-yyyy hh24:mi') AS entrydate,\
                 (SELECT gstr_user_name || '(' || gstr_usr_name || ')' FROM gblt_user_mst  WHERE gnum_userid = a.gnum_seat_id  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid) AS seatid,to_char(hrgdt_valid_upto,'dd-Mon-yyyy') AS validupto  FROM hrgt_seccat_change_dtl a    WHERE hrgnum_puk = ?  AND gnum_isvalid =?   AND gnum_hospital_code =?  ORDER BY entrydate DESC ,rownum desc
                 
                  				        
SELECT_PAT_AUDIT_TRAIL.HRGT_UNKNOWN_CHANGE_DTL=SELECT hrgnum_puk AS patcrno,TO_CHAR (gdt_unknown_conversion_date,'dd-Mon-yyyy') AS unknownconversiondate,psrstr_emp_no AS empno,to_char(gdt_entry_date,'dd-Mon-yyyy') AS entrydate, \
 			   (SELECT gstr_user_name || '(' || gstr_usr_name || ')'  FROM gblt_user_mst  WHERE gnum_userid = a.gnum_seat_id  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid) AS seatid, hrgstr_ip_add AS systemipaddress,hrgstr_fname AS patfirstname, hrgstr_mname AS patmiddlename,hrgstr_lname AS patlastname, hrgstr_age AS patage, to_char(hrgdt_dob,'dd-Mon-yyyy') AS patdob, gnum_gender_code AS patgendercode, \
 			   (SELECT NVL (gstr_gender_name, 'NA') FROM gblt_gender_mst   WHERE gnum_gender_code = a.gnum_gender_code   AND gnum_hospital_code = a.gnum_hospital_code    AND gnum_isvalid = a.gnum_isvalid) AS patgender,hgnum_patient_cat_code AS patprimarycatcode,\
		       (SELECT gstr_patient_cat_name   FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid  AND gnum_cat_slno = \
		       (SELECT MAX (gnum_cat_slno)  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid)) AS patprimarycat,hgnum_treatment_cat_code AS patsecondarycatcode,\
	           (SELECT gstr_patient_cat_name  FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.hgnum_treatment_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid  AND gnum_cat_slno = \
	           (SELECT MAX (gnum_cat_slno)  FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_code = a.hgnum_treatment_cat_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid)) AS patsecondarycat,hrgstr_fhname AS patguardianname, hrgstr_house_no AS pataddhno,hrgstr_street_no AS pataddstreet, hrgstr_city AS pataddcity, gnum_state_code AS pataddstatecode, \
	           (SELECT gstr_statename  FROM gblt_state_mst  WHERE gnum_statecode = a.gnum_state_code  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid) AS pataddstate,gnum_nationality_code AS patnationalitycode, \
	           (SELECT NVL (gstr_countryname, 'NA')  FROM gblt_country_mst   WHERE gnum_countrycode = a.gnum_nationality_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) AS patnationality,hrgnum_verification_slno , \
	           hrgnum_change_req_by as requestBy,DECODE (hrgnum_change_req_by  ,0, 'Self/Patient',1, 'Relative(' || hrgstr_change_reqby_name || ')', 2, 'Police(' || hrgstr_change_reqby_name || ')','' )  as requestByName	  FROM hrgt_unknown_change_dtl a  WHERE hrgnum_puk =?    AND gnum_isvalid = ?    AND gnum_hospital_code =? 			        
  				        
       

		       
SELECT_PAT_AUDIT_TRAIL.HRGT_PATIENT_MLC_OLD=SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,hrgstr_case_no AS caseno, a.HRGSTR_OFFICER_NAME AS policename, a.HRGSTR_OFFICER_DESIG AS policedesignation,hrgstr_police_station AS policestation, b.HRGSTR_IO_NAME AS officerincharge,\
	        TO_CHAR (hrgdt_mlc_date, 'dd-Mon-yyyy') AS mlcdate,psstr_cmo_code AS cmocode, hrgnum_istransfer AS istransfer,(SELECT gstr_user_name || '(' || gstr_usr_name || ')'  FROM gblt_user_mst   WHERE gnum_userid = a.gnum_seat_id   AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid) AS seatid, \
	        a.gdt_entry_date AS entrydate, a.hrgnum_isbroughtdead AS isbroughtdead,hrgstr_patient_condition AS patcondition,hrgstr_mlc_remarks AS mlcremark, a.hrgstr_ip_add AS systemipaddress,hrgstr_brought_by_name AS broughtbyname,hrgstr_brought_by_address AS broughtbyaddress,hrgstr_brought_by_phone AS broughtbyphone, b.HRGSTR_IO_BADGENO AS batchno \
	        FROM hrgt_patient_mlc_dtl a, hrgt_police_verification_dtl b,hrgt_patient_broughtby_dtl c  \
	        WHERE a.hrgnum_puk = ?    AND a.gnum_isvalid = ?   AND a.gnum_hospital_code = ?    AND b.hrgnum_puk = a.hrgnum_puk    AND b.hrgnum_episode_code = a.hrgnum_episode_code    AND b.hrgnum_s_no = a.hrgnum_s_no    AND b.hrgnum_visit_no = a.hrgnum_visit_no    AND c.hrgnum_puk = a.hrgnum_puk    AND c.hrgnum_episode_code = a.hrgnum_episode_code    AND c.HRGNUM_SLNO= a.hrgnum_s_no    AND c.hrgnum_visit_no = a.hrgnum_visit_no
	        
		
SELECT_PAT_AUDIT_TRAIL.HRGT_PATIENT_MLC_DTL=SELECT a.hrgnum_puk AS patcrno, a.hrgstr_mlc_no AS mlcno,\
       (SELECT NVL(hrgstr_case_no,'')    FROM hrgt_police_verification_dtl   WHERE hrgnum_puk = a.hrgnum_puk        AND hrgnum_episode_code = a.hrgnum_episode_code   AND hrgnum_s_no = a.hrgnum_s_no  AND hrgnum_visit_no = a.hrgnum_visit_no) AS caseno, \
       a.hrgstr_officer_name AS policename,a.hrgstr_officer_desig AS policedesignation,\
      (SELECT NVL(hrgstr_police_station,'')   FROM hrgt_police_verification_dtl   WHERE hrgnum_puk = a.hrgnum_puk   AND hrgnum_episode_code = a.hrgnum_episode_code   AND hrgnum_s_no = a.hrgnum_s_no  AND hrgnum_visit_no = a.hrgnum_visit_no) AS policestation, \
      (SELECT NVL(hrgstr_io_name,'')   FROM hrgt_police_verification_dtl  WHERE hrgnum_puk = a.hrgnum_puk   AND hrgnum_episode_code = a.hrgnum_episode_code    AND hrgnum_s_no = a.hrgnum_s_no   AND hrgnum_visit_no = a.hrgnum_visit_no) AS officerincharge, \
       TO_CHAR (a.hrgdt_mlc_date, 'dd-Mon-yyyy') AS mlcdate,a.psstr_cmo_code AS cmocode, a.hrgnum_istransfer AS istransfer,  \
      (SELECT gstr_user_name || '(' || gstr_usr_name || ')'     FROM gblt_user_mst   WHERE gnum_userid = a.gnum_seat_id   AND gnum_hospital_code = a.gnum_hospital_code    AND gnum_isvalid = a.gnum_isvalid) AS seatid,a.gdt_entry_date AS entrydate, a.hrgnum_isbroughtdead AS isbroughtdead,\
      a.hrgstr_patient_condition AS patcondition,a.hrgstr_mlc_remarks AS mlcremark, a.hrgstr_ip_add AS systemipaddress, \
     (SELECT NVL(hrgstr_brought_by_name,'')   FROM hrgt_patient_broughtby_dtl  WHERE hrgnum_puk = a.hrgnum_puk    AND hrgnum_episode_code = a.hrgnum_episode_code     AND HRGNUM_SLNO = a.hrgnum_s_no   AND hrgnum_visit_no = a.hrgnum_visit_no) AS broughtbyname, \
     (SELECT NVL(hrgstr_brought_by_address,'')  FROM hrgt_patient_broughtby_dtl  WHERE hrgnum_puk = a.hrgnum_puk  AND hrgnum_episode_code = a.hrgnum_episode_code     AND HRGNUM_SLNO = a.hrgnum_s_no   AND hrgnum_visit_no = a.hrgnum_visit_no) AS broughtbyaddress, \
     (SELECT NVL(hrgstr_brought_by_phone,'')   FROM hrgt_patient_broughtby_dtl  WHERE hrgnum_puk = a.hrgnum_puk  AND hrgnum_episode_code = a.hrgnum_episode_code      AND HRGNUM_SLNO = a.hrgnum_s_no   AND hrgnum_visit_no = a.hrgnum_visit_no) AS broughtbyphone, \
     (SELECT NVL(hrgstr_io_badgeno,'')  FROM hrgt_police_verification_dtl   WHERE hrgnum_puk = a.hrgnum_puk   AND hrgnum_episode_code = a.hrgnum_episode_code    AND hrgnum_s_no = a.hrgnum_s_no  AND hrgnum_visit_no = a.hrgnum_visit_no) AS batchno \
	 FROM hrgt_patient_mlc_dtl a  WHERE a.hrgnum_puk = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code =?  order by entryDate desc,rownum desc	  
   
   
  


				       
SELECT.HRGT_DAILY_PATIENT_DTL.RETRIEVE_FOR_CMO    =			SELECT a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) AS patfirstname, INITCAP (a.hrgstr_mname) AS patmiddlename,(SELECT HGNUM_ISGENERAL \
			            									FROM hgbt_unit_mst x WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode AND x.gnum_hospital_code = a.gnum_hospital_code AND x.gdt_effective_frm <= TRUNC (SYSDATE) \
			             									AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentUnitType, \
															INITCAP (a.hrgstr_lname) AS patlastname, a.gnum_marital_status_code AS patmaritalstatuscode, DECODE (a.gnum_gender_code, 1, 'M', 2, 'F', 'O') \
															|| '/' || ahis_util.puk_age (a.hrgnum_puk) patgenderage, INITCAP (a.hrgstr_father_name) AS patguardianname, INITCAP (a.hrgstr_momname) AS patmomname, \
															a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no || '^' || a.hrgnum_is_confirmed AS episodevisitno, a.hrgnum_s_no AS serialno, \
															a.hrgnum_episode_type_code AS episodetypecode, a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, \
															a.gnum_dept_code AS departmentcode, a.hrgnum_isreg_free AS isfree, a.hrgnum_is_old AS patisold, TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate, \
															a.hgnum_patient_cat_code || '^' || (SELECT y.gnum_cat_priority FROM gblt_patient_cat_mst y WHERE y.gnum_patient_cat_code = a.hgnum_patient_cat_code \
															AND y.gnum_hospital_code = a.gnum_hospital_code AND y.gnum_isvalid = ? AND TRUNC (SYSDATE) BETWEEN TRUNC (gdt_effective_frm) \
															AND TRUNC (NVL (gdt_effective_to, SYSDATE))) AS patprimarycatcode, (SELECT INITCAP (gstr_patient_cat_name) FROM gblt_patient_cat_mst \
															WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
															AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))patprimarycat, (SELECT INITCAP (gstr_patient_cat_name) \
															FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_treatment_cat_code AND gnum_hospital_code = a.gnum_hospital_code \
															AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) patsecondarycat, \
															(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND a.gnum_hospital_code = e.gnum_hospital_code \
															AND e.gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (e.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department, \
															(SELECT INITCAP (x.hgstr_unitname) FROM hgbt_unit_mst x WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode AND x.gnum_hospital_code = a.gnum_hospital_code \
															AND x.gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))departmentunit, \
															a.hrgnum_is_mlc AS ismlc, a.hrgnum_is_broughtdead AS isbroughtdead, a.hrgnum_isunknown AS isunknown,a.HRGNUM_IS_CONFIRMED as isconfirmed FROM hrgt_daily_patient_dtl a \
															WHERE ( TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE) AND (SELECT hrgnum_is_confirmed FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk \
															AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no AND gnum_hospital_code = a.gnum_hospital_code \
															AND gnum_isvalid = a.gnum_isvalid)<>?) AND a.hgnum_deptunitcode = ?  AND a.gnum_hospital_code = ? \
															AND a.gnum_isvalid = ? ORDER BY patfirstname || ' ' || patmiddlename || ' ' || patlastname
 
SELECT.HRGT_DAILY_PATIENT_DTL.COUNT_CMO_TOTAL_PATIENT=	SELECT COUNT (*) FROM hrgt_daily_patient_dtl a WHERE a.hgnum_deptunitcode = ? AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? \
														AND (   TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE) AND (SELECT hrgnum_is_confirmed FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk \
														AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no)<>? ) 

SELECT.ALL_PATIENT_FOR_SEARCHING.HRGT_DAILY_PATIENT_DTL24-12-09	=	select distinct(HRGNUM_PUK) patCrNo, UPPER(HRGSTR_FNAME) patFirstName,GNUM_GENDER_CODE patGenderCode,ahis_util.dob_age_on(HRGDT_DOB,sysdate)patAge,nvl(to_char(HRGDT_DOB,'dd-Mon-yyyy'),'-')patDOB ,HGNUM_PATIENT_CAT_CODE,nvl(HRGSTR_MNAME, ' ')patMiddleName, nvl(HRGSTR_LNAME,' ' )patLastName, \
 														 	to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') registerDate,nvl((select GSTR_GENDER_NAME from gblt_gender_mst where GNUM_GENDER_CODE=a.GNUM_GENDER_CODE and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code),' ')patGender  from HRGT_PATIENT_DTL a

SELECT.ALL_PATIENT_FOR_SEARCHING.HRGT_DAILY_PATIENT_DTL_30-07-2010	=	SELECT DISTINCT (a.hrgnum_puk) patcrno, UPPER(hrgstr_fname) patfirstname, gnum_gender_code patgendercode, ahis_util.dob_age_on (hrgdt_dob, SYSDATE) patage, TO_CHAR (hrgdt_dob, 'dd-Mon-yyyy') patdob, \
															hgnum_patient_cat_code, hrgstr_mname patmiddlename, hrgstr_lname patlastname, upper(nvl(hrgstr_father_name,'-')) patguardianname, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') registerdate, \
															(SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code = a.gnum_gender_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) patgender, \
															b.hrgstr_city AS pataddcity, INITCAP (b.hrgstr_district) AS patadddistrict, b.gnum_state_code AS pataddstatecode, b.hrgnum_pincode AS pataddpin, b.gnum_country_code AS pataddcountrycode, \
															b.hrgstr_house_no AS pataddhno, b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, b.gnum_city_loc_code AS pataddcityloccode, (SELECT INITCAP (c.gstr_statename) \
															FROM gblt_state_mst c WHERE c.gnum_statecode = b.gnum_state_code AND c.gnum_hospital_code = a.gnum_hospital_code) pataddstate, (SELECT INITCAP (d.gstr_countryname) FROM gblt_country_mst d \
															WHERE d.gnum_countrycode = b.gnum_country_code AND d.gnum_hospital_code = a.gnum_hospital_code) pataddcountry,  (DECODE (b.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) \
															FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = b.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1), b.hrgstr_city_location ) ) pataddcityloc \
															FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b where (b.hrgnum_puk IN a.hrgnum_puk) \
															AND a.gnum_isvalid = 1 AND b.gnum_add_type_code = 1 AND a.gnum_isvalid = b.gnum_isvalid
															
SELECT.ALL_PATIENT_FOR_SEARCHING.HRGT_DAILY_PATIENT_DTL=	SELECT DISTINCT (a.hrgnum_puk) patcrno, UPPER (hrgstr_fname) patfirstname, hrgstr_mname patmiddlename, hrgstr_lname patlastname, gnum_gender_code patgendercode, (SELECT gstr_gender_short FROM gblt_gender_mst WHERE gnum_gender_code = a.gnum_gender_code \
															AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) patgender, ahis_util.dob_age_on (hrgdt_dob, SYSDATE) patage, TO_CHAR (hrgdt_dob, 'dd-Mon-yyyy') patdob, hgnum_patient_cat_code, UPPER (NVL (hrgstr_father_name, '-')) patguardianname, \
															TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') registerdate, ( b.hrgstr_house_no || ' ' || (DECODE (b.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = b.gnum_city_loc_code AND e.gnum_hospital_code = \
															a.gnum_hospital_code AND gnum_isvalid = 1), b.hrgstr_city_location ) ) || ' ' || b.hrgstr_city || ' ' || ( select STR_DIST_NAME from gblt_district_mst where NUM_DIST_ID=b.NUM_DIST_ID and gnum_hospital_code = a.gnum_hospital_code AND GDT_EFFECTIVE_FRM <= sysdate and \
															(TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>=TO_DATE(SYSDATE,'DD-MM-YY'))) || ' ' || (SELECT INITCAP (c.gstr_statename) FROM gblt_state_mst c WHERE c.gnum_statecode = b.gnum_state_code AND c.gnum_hospital_code = a.gnum_hospital_code) || ' ' ||  (SELECT INITCAP (d.gstr_countryname) \
															FROM gblt_country_mst d WHERE d.gnum_countrycode = b.gnum_country_code AND d.gnum_hospital_code = a.gnum_hospital_code)) address FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b WHERE (b.hrgnum_puk IN a.hrgnum_puk) AND a.gnum_isvalid = 1 AND b.gnum_add_type_code = 1 AND a.gnum_isvalid = b.gnum_isvalid  

SELECT.BROUGHT_DETAIL_BY_CRNO.HRGT_PATIENT_BROUGHTBY_DTL_NEW = SELECT hrgnum_episode_code as episodeCode, hrgstr_brought_by_name as broughtByName, hrgstr_brought_by_address as broughtByAddress,hrgstr_brought_by_phone as broughtByPhone, gnum_gender_code as broughtByGenderCode, gnum_isrelative as isRelative , \
																gnum_relation_code as broughtByRelationCode, hrgstr_ip_add as systemIPAddress, gnum_seat_id as seatId,TO_CHAR(gdt_entry_date,'dd-Mon-yyyy') as entryDate, hrgstr_brought_location as broughtByLocation,HRGSTR_CONSTABLE_DESIG as constableDesig, HRGSTR_CONSTABLE_BADGENO as constableBadgeNo \
																FROM hrgt_patient_broughtby_dtl WHERE hrgnum_puk = ? AND HRGNUM_EPISODE_CODE= ? AND HRGNUM_VISIT_NO = ? AND hrgnum_slno = (SELECT MAX (hrgnum_slno) FROM hrgt_patient_broughtby_dtl WHERE hrgnum_puk = ? \
																AND HRGNUM_EPISODE_CODE= ? AND HRGNUM_VISIT_NO = ?) AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?
 														 	

INSERT.HRGT_POLICE_VERIFICATION_DTL = INSERT INTO HRGT_POLICE_VERIFICATION_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_S_NO, HRGNUM_VISIT_NO, HRGSTR_MLC_NO, \
										HRGSTR_CASE_NO, HRGSTR_POLICE_STATION, HRGSTR_DD_NO, HRGSTR_IO_NAME, HRGSTR_IO_DESIG, HRGSTR_IO_BADGENO, \
										HRGSTR_CONSTABLE_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGSTR_CONSTABLE_DESIG, HRGSTR_CONSTABLE_BADGENO, \
										HRGNUM_ISBROUGHTDEAD, HRGSTR_CASE_REMARKS, GNUM_ISVALID, GNUM_HOSPITAL_CODE) \
										VALUES(?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_POLICE_VERIFICATION_DTL WHERE HRGNUM_PUK = ? \
										AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ?),?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?) 														 	
										

CHECK_EXISTING_MLC_NO.HRGT_PATIENT_MLC_DTL = SELECT HRGSTR_MLC_NO FROM HRGT_PATIENT_MLC_DTL WHERE TRIM(UPPER(HRGSTR_MLC_NO)) = TRIM(UPPER(?)) AND GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID = ?



SELECT.HRGT_POLICE_VERIFICATION_DTL = SELECT HRGSTR_CASE_NO as caseNo, HRGSTR_POLICE_STATION as policeStation, HRGSTR_DD_NO as docketNo, \
											HRGSTR_IO_NAME as officerIncharge, HRGSTR_IO_DESIG as ioDesignation, HRGSTR_IO_BADGENO as ioBatchNo, \
											HRGSTR_CONSTABLE_NAME as dutyOffName, HRGSTR_CONSTABLE_DESIG as dutyOffDesignation, \
											HRGSTR_CONSTABLE_BADGENO as dutyOffBatchNo, HRGNUM_ISBROUGHTDEAD as isBroughtDead, HRGSTR_CASE_REMARKS as caseRemarks \
											FROM HRGT_POLICE_VERIFICATION_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ? \
											AND GNUM_ISVALID = ? AND HRGNUM_S_NO = (SELECT MAX(HRGNUM_S_NO) FROM HRGT_POLICE_VERIFICATION_DTL WHERE HRGNUM_PUK= ? \
											AND HRGNUM_EPISODE_CODE= ? AND HRGNUM_VISIT_NO = ?) AND GNUM_HOSPITAL_CODE = ?

SELECT.HRGT_PATIENT_BROUGHTBY_DTL = SELECT HRGSTR_BROUGHT_BY_NAME as broughtByName, HRGSTR_BROUGHT_BY_ADDRESS as broughtByAddress, HRGSTR_BROUGHT_BY_PHONE as broughtByPhone, \
										GNUM_GENDER_CODE as broughtByGenderCode, GNUM_ISRELATIVE as isRelative, HRGSTR_CONSTABLE_DESIG as constableDesig, \
										GNUM_RELATION_CODE as broughtByRelationCode, HRGSTR_CONSTABLE_BADGENO as constableBadgeNo, HRGSTR_BROUGHT_LOCATION as broughtByLocation \
										FROM HRGT_PATIENT_BROUGHTBY_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ? \
										AND GNUM_ISVALID = ? AND HRGNUM_SLNO = (SELECT MAX(HRGNUM_SLNO) FROM HRGT_PATIENT_BROUGHTBY_DTL WHERE HRGNUM_PUK= ? \
										AND HRGNUM_EPISODE_CODE= ? AND HRGNUM_VISIT_NO = ?) AND GNUM_HOSPITAL_CODE = ?



INSERT.HPMRT_PAT_DEATH_DTL = INSERT INTO HPMRT_PAT_DEATH_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, \
								GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HIPNUM_WARD_CODE, HPMRDT_DEATH_DATETIME, HIPNUM_ROOM_NO, \
								HGNUM_BED_CODE, HRGSTR_ATTEND_CONSULTANT_ID, HRGSTR_MLC_NO, HPMRSTR_CONSULTANT_REMARK, HRGNUM_IS_BROUGHTDEAD, \
								HPMRNUM_BODY_HANDOVER_TO, HPMRDT_BODY_HANDOVER_DATETIME, HPMRDT_ONSET_DATE, HPMRSTR_RELATIVE_NAME, \
								HPMRSTR_IMMEDIATE_CAUSE1, HPMRSTR_IMMEDIATE_CAUSE2, HPMRSTR_RELATIVE_ADDRESS, HPMRSTR_IMMEDIATE_CAUSE3, \
								GNUM_RELATIVECODE, HPMRSTR_PREGNANCY_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, HPMRSTR_OTHER_CAUSE, HPMRNUM_ISPREGNANT, \
								HPMRNUM_ISDELIVERY, HRGNUM_INJURY_NATURE_CODE, HPMRSTR_INJURY_REMARKS, \
								HGNUM_DEATH_MANNER_CODE, HPMRDT_VERIFICATION_DATETIME, GNUM_HOSPITAL_CODE, HPMRSTR_OFFICER_NAME, \
								HPMRSTR_OFFICER_DESIG, GNUM_HANDOVER_BY, HPMRSTR_OFFICER_BADGENO, GDT_ENTRY_DATE, HPMRSTR_HANDOVERTO_EMPID, HPMRNUM_CERTIFICATE_ID) \
								VALUES(?,?,?,?,?,?,?, \
								TO_DATE(?,'dd-Mon-yyyy hh24:mi'),?,?,?,?,?,?,?,TO_DATE(?,'dd-Mon-yyyy hh24:mi'),TO_DATE(?,'dd-Mon-yyyy'), \
								?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd-Mon-yyyy HH24:MI'),?,?,?,?,?,SYSDATE,?,?)


UPDATE.HRGT_PATIENT_DTL.PAT_STATUS = UPDATE HRGT_PATIENT_DTL SET HRGNUM_IS_DEAD = ? WHERE HRGNUM_PUK = ? AND GNUM_HOSPITAL_CODE = ?

#Added by AKASH SINGH as per Death process change on IPD Doctor Desk
UPDATE.HIPT_PATADMISSION_DTL.PAT_STATUS = UPDATE HIPT_PATADMISSION_DTL SET HIPNUM_IS_DEAD = ? WHERE HIPNUM_ADMNO = ? AND GNUM_HOSPITAL_CODE = ?				

#Changed By Amit Garg as OPD G5 Changes
SELECT_ONSETDATE_N_RECENTVISITDATE.HRGT_DAILY_PATIENT_DTL = SELECT TO_CHAR (hrgdt_episode_start_date, 'dd-Mon-yyyy') || '@'|| TO_CHAR(gdt_entry_date, 'dd-Mon-yyyy') \
															FROM hrgt_episode_dtl a WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND gnum_hospital_code=? \
															AND hrgnum_visit_no =(SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl WHERE hrgnum_puk=a.hrgnum_puk \
															AND hrgnum_episode_code=a.hrgnum_episode_code AND gnum_hospital_code=a.gnum_hospital_code)
										
EXIST.HPMRT_PAT_DEATH_DTL = SELECT * FROM HPMRT_PAT_DEATH_DTL where HRGNUM_PUK = ?



UPDATE.HRGT_DAILY_PATIENT_DTL.PAT_STATUS_ISCOFIRMED = UPDATE HRGT_DAILY_PATIENT_DTL SET HRGNUM_IS_DEAD = ?, HRGNUM_IS_CONFIRMED = ?, GNUM_DOC_SEAT_ID = ? WHERE HRGNUM_PUK = ? \
														AND HRGNUM_VISIT_NO = ? AND HRGNUM_EPISODE_CODE = ? AND GNUM_HOSPITAL_CODE=?

SELECT_ADDITIONAL_PAT_INFORMATION.HRGT_PATIENT_DTL	=	SELECT HRGDT_DOB AS patDOB, INITCAP(HRGSTR_FATHER_NAME) AS patGuardianName, INITCAP(HRGSTR_MOMNAME) AS patMotherName, INITCAP(HRGSTR_SPOUSENAME) AS patHusbandName, HBNUM_BLDGRP_CODE AS patBloodGroup, HBNUM_HUSBAND_BLDGRP_CODE AS patHusbandBloodGroup, HRGSTR_PAT_OCCUPATION AS patOccupation, HRGSTR_FAT_OCCUPATION AS patFatherOccupation, \
														HRGSTR_HUS_OCCUPATION AS patHusbandOccupation, NUM_CASTE_ID AS patCaste, GNUM_FAMILY_TYPE AS patFamilyType, GNUM_PAT_EDUSTATUS_CODE AS patEducationStatus, GNUM_SPOUSE_EDUSTATUS_CODE AS patSpouseEducationStatus, GNUM_MOM_EDUSTATUS_CODE AS patMotherEducationStatus, \
														GNUM_FAT_EDUSTATUS_CODE AS patFatherEducationStatus, HRGSTR_MOM_OCCUPATION AS patMotherOccupation, HRGDT_DOM AS patDateOfMarriage, DECODE(HRGDT_DOM,null,'',FLOOR(MONTHS_BETWEEN(HRGDT_DOM,HRGDT_DOB)/ 12)) AS patAgeOfMarriage, HRGDT_MENARCHE_AGE AS patDateOfMenarche, \
														DECODE(HRGDT_MENARCHE_AGE,null,'',FLOOR(MONTHS_BETWEEN(HRGDT_MENARCHE_AGE,HRGDT_DOB)/ 12)) AS patAgeOfMenarche FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE =?	       		         

														
UPDATE.SET_ADDITIONAL_PAT_INFORMATION.HRGT_PATIENT_DTL	=	UPDATE HRGT_PATIENT_DTL SET HRGSTR_FATHER_NAME=INITCAP(?), HRGSTR_MOMNAME=INITCAP(?), HRGSTR_SPOUSENAME=INITCAP(?), HBNUM_BLDGRP_CODE=?, HBNUM_HUSBAND_BLDGRP_CODE=?, HRGSTR_PAT_OCCUPATION=?, \
															HRGSTR_FAT_OCCUPATION=?, HRGSTR_HUS_OCCUPATION=?, NUM_CASTE_ID=?, GNUM_FAMILY_TYPE=?, GNUM_PAT_EDUSTATUS_CODE=?, GNUM_SPOUSE_EDUSTATUS_CODE=?, GNUM_MOM_EDUSTATUS_CODE=?, \
															GNUM_FAT_EDUSTATUS_CODE=?, HRGSTR_MOM_OCCUPATION=?, HRGDT_DOM=DECODE(?,?,ADD_MONTHS(HRGDT_DOB,(DECODE(?,0,null,?))*12),TO_DATE(?,'DD-Mon-YYYY'))::timestamp, HRGDT_MENARCHE_AGE=ADD_MONTHS(HRGDT_DOB,(DECODE(?,0,null,?)*12)) WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?															


#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_EPISODE_DTL.EMR=SELECT HRGNUM_EPISODE_CODE as episodeCode, HRGNUM_VISIT_NO as episodeVisitNo, hrgnum_visit_type AS episodevisittype, HRGNUM_EPISODE_TYPE_CODE as episodeVisitTypeCode, \
							GNUM_DEPT_CODE as departmentCode, HGNUM_DEPTUNITCODE as departmentUnitCode,(SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE = a.GNUM_DEPT_CODE  AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) \
							 || '(' || \
							(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE =a.HGNUM_DEPTUNITCODE AND GNUM_ISVALID =a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE) \
							 || ')' as departmentUnit,TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, HRGNUM_IS_EPISODE_OPEN AS episodeIsOpen,HRGNUM_EPISODE_TYPE_CODE AS episodeTypeCode, \
							 round(DATE_PART('day',(sysdate-gdt_entry_date))) episodeDate,HRGNUM_IS_REF isReferred, \
							(SELECT GSTR_HOSPITAL_NAME FROM GBLT_HOSPITAL_MST WHERE GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=a.gnum_isvalid) as hospitalName, \
         					(SELECT GNUM_HOSPITAL_CODE FROM GBLT_HOSPITAL_MST WHERE GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=a.gnum_isvalid) as hospitalCode  \
							FROM HRGT_EPISODE_DTL a WHERE HRGNUM_PUK=? AND GNUM_ISVALID=?  AND HRGNUM_VISIT_TYPE in (?,?,?,?) ORDER BY departmentunit, episodecode desc, episodevisitno desc  
															
#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.BY_CRNO_EMR=SELECT a.hrgnum_puk AS patcrno, a.hrgstr_prev_puk AS prevcrno,TO_CHAR (a.hrgdt_dob, 'DD-MON-YYYY') AS patdob,a.hrgbl_is_actual_dob AS isactualdob, \
									INITCAP (a.hrgstr_fname) AS patfirstname,a.hgnum_pat_status_code AS patstatuscode,INITCAP (a.hrgstr_mname) AS patmiddlename,INITCAP (a.hrgstr_lname) AS patlastname,a.gSTR_gender_code AS patgendercode, \
									a.gnum_marital_status_code AS patmaritalstatuscode,a.hrgstr_idmark1 AS patidmark1, a.hrgstr_idmark2 AS patidmark2,INITCAP (a.hrgstr_father_name) AS patguardianname, \
									INITCAP (a.hrgstr_momname) AS patmomname,a.hgnum_patient_cat_code AS patcatcode,TO_CHAR (a.hrgdt_general_expdate, 'dd-Mon-yyyy') AS expirydate, \
									a.gdt_entry_date AS entrydate, a.gnum_seat_id AS seatid,a.hrgnum_is_mlc AS ismlc, a.gnum_isvalid AS isvalid,a.hrgnum_isunknown AS isunknown,a.hrgnum_month_income AS patmonthlyincome, \
									a.hrgnum_is_urban AS patisurban, \
									(SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code  \
									 AND gnum_hospital_code = 100 AND ROWNUM = 1) AS patprimarycatcode,a.hrgstr_ip_add AS systemipaddress, \
									a.hrgstr_PHONE_no AS pataddcontactno, a.hrgnum_id_no AS patidno,a.hrgnum_is_ref AS isreferred, a.gnum_religion_code AS patreligioncode,ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage, \
									a.HRGSTR_national_ID AS patnationalitycode,hrgnum_is_imageuploaded AS isimageuploaded,a.hrgstr_father_name AS patfathername,a.hrgstr_momname AS patmothername, \
									INITCAP (a.hrgstr_spousename) AS pathusbandname,a.hrgstr_national_id AS patnationalid,(select GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where  \
									 gnum_isvalid=a.gnum_isvalid AND gnum_hospital_code=a.gnum_hospital_code AND ROWNUM = 1) as patoccupationdesc,(select GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where  \
									 gnum_isvalid=a.gnum_isvalid AND gnum_hospital_code=a.gnum_hospital_code AND ROWNUM = 1) as patfatheroccupationdesc, \
									(select GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where  gnum_isvalid=a.gnum_isvalid AND gnum_hospital_code=a.gnum_hospital_code AND ROWNUM = 1) as pathusbandoccupationdesc, \
									a.hrgstr_nickname AS patnickname, a.hrgstr_card_no AS patcardno,(SELECT INITCAP (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gSTR_gender_code = a.gSTR_gender_code AND ROWNUM = 1 \
									) patgender,(SELECT INITCAP (c.gstr_marital_status) FROM gblt_marital_status_mst c  WHERE c.gnum_marital_status_code = \
									a.gnum_marital_status_code  AND ROWNUM = 1) patmaritalstatus,(SELECT SYSDATE AS systemdate FROM DUAL),('') patregcat,(SELECT INITCAP (i.gstr_patient_cat_name) FROM gblt_patient_cat_mst i WHERE i.gnum_patient_cat_code = \
									a.hgnum_patient_cat_code  AND i.gnum_hospital_code = a.gnum_hospital_code) patprimarycat, \
									(SELECT INITCAP (m.gstr_religion_name) FROM gblt_religion_mst m WHERE m.gnum_religion_code = a.gnum_religion_code AND ROWNUM = 1) patreligion, \
									(SELECT INITCAP (t.gstr_COUNTRY_NAME) FROM gblt_country_mst t WHERE t.gSTR_country_code = a.hrgstr_national_id AND ROWNUM = 1) patnationality, \
									(SELECT    '(Invalid Category) ' || INITCAP (gstr_patient_cat_name) FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code AND ROWNUM = 1) \
									patoldprimarycat FROM hrgt_patient_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) 															
									
#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_IMAGE_DTL.IMAGE_BY_CRNO_EMR=SELECT ' ' as fileNo, ' ' as filePath,HRGNUM_IS_DEFAULT as isImageDefault FROM HRGT_PATIENT_IMAGE_DTL WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?									

SELECT.HRGT_EPISODE_DTL.NEXT_VISIT_DETAIL_EMR=SELECT TO_CHAR(HRGDT_NEXT_VISIT_DATE,'dd-Mon-yyyy') AS episodeNextVisitDate, GNUM_DEPT_CODE AS episodeNextVisitDeptCode, HGNUM_DEPTUNITCODE AS episodeNextVisitDeptUnitCode,(SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE = a.GNUM_DEPT_CODE  AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
												AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) || '(' || (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE =a.HGNUM_DEPTUNITCODE AND GNUM_ISVALID =a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE  \
												AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ) || ')' as episodeNextVisitDeptUnit FROM HRGT_EPISODE_DTL A WHERE HRGNUM_PUK=?  AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? AND HRGDT_NEXT_VISIT_DATE IS NOT NULL AND HRGDT_NEXT_VISIT_DATE>=TRUNC(SYSDATE) ORDER BY hrgdt_next_visit_date

SELECT.DEFAULT_IMAGE.HRGT_PATIENT_IMAGE_DTL.IMAGE_BY_CRNO =	SELECT HRGSTR_FILENO as fileNo, HRGSTR_PATH as filePath,HRGNUM_IS_DEFAULT as isImageDefault FROM HRGT_PATIENT_IMAGE_DTL WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND HRGNUM_IS_DEFAULT=? AND GNUM_HOSPITAL_CODE=?

//---------------------------------------------Patient_Image_Upload----------------------------------------------------------

SELECT.ALL_IMAGES_BY_CRNO.HRGT_PATIENT_IMAGE_DTL	=	SELECT hrgnum_puk patCrNo, hrgnum_s_no serialNo, hrgnum_episode_code episodeCode, hrgnum_is_default isImageDefault, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate,  gst_file_name fileNo \
													FROM hrgt_patient_image_dtl where hrgnum_puk=? and gnum_isvalid=? and gnum_hospital_code=? order by hrgnum_s_no
  
															
DELETE.HRGT_PATIENT_IMAGE_DTL	=	update HRGT_PATIENT_IMAGE_DTL set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? \
									where HRGNUM_PUK=? and HRGNUM_SLNO=?	
																							
MODIFY.HRGT_PATIENT_IMAGE_DTL	=	update HRGT_PATIENT_IMAGE_DTL set HRGNUM_IS_DEFAULT=? where HRGNUM_PUK=? and HRGNUM_SLNO=?		


GENERATE_DEATH_CERTIFICATE_ID = SELECT PKG_MRD_DTL.GENERATECERTIFICATEID(?,?,?,?,?) FROM DUAL

#Added by:	Akash Singh
#Date:		07-01-2015
#Reason:	Removing Hospital Code
#Logs:		SELECT.DETAIL_BY_CRNO.HPMRT_PAT_DEATH_DTL,DOVER_DETAIL.HPMRT_PAT_DEATH_DTL, UPDATE_CERTIFICAREID_DETAIL.HPMRT_PAT_DEATH_DTL, SELECT.DEAD_PATIENT_LIST.HPMRT_PAT_DEATH_DTL

SELECT.DETAIL_BY_CRNO.HPMRT_PAT_DEATH_DTL = SELECT HRGNUM_PUK as patCrNo, HRGNUM_ADMISSION_NO as patAdmNo, HIPNUM_WARD_CODE as wardCode, TO_CHAR(HPMRDT_DEATH_DATETIME,'dd-Mon-yyyy') as deathDate, TO_CHAR(HPMRDT_DEATH_DATETIME,'HH:MI AM ') AS deathTime, \
												(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST C WHERE C.HIPNUM_WARD_CODE = A.HIPNUM_WARD_CODE AND C.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE \
												AND C.GNUM_ISVALID = 1) as wardName, TO_CHAR(hpmrdt_verification_date,'dd-Mon-yyyy') as verificationDate, TO_CHAR(hpmrdt_verification_date,'HH:MI AM') AS verificationTime, \
												TO_CHAR(A.HPMRDT_ONSET_DATE,'dd-Mon-yyyy') as onSetDate, A.HPMRSTR_IMMEDIATE_CAUSE1 as immediateCause1, A.HPMRSTR_IMMEDIATE_CAUSE2 as immediateCause2, \
												A.HPMRSTR_IMMEDIATE_CAUSE3 as immediateCause3, HPMRSTR_OTHER_CAUSE as otherCause, DECODE(A.HPMRNUM_ISPREGNANT,'1','Yes','0','No',null,'No') as isPregnant, DECODE(A.HPMRNUM_ISDELIVERY,'1','Yes','0','No',null,'No') as isDelivery, A.HRGNUM_INJURY_NATURE_CODE as injuryNatureCode, A.HRGNUM_INJURY_TYPE_CODE as injuryTypeCode, \
												(SELECT INITCAP(D.HRGSTR_INJURY_NATURE) FROM HRGT_INJURY_NATURE_MST D WHERE D.HRGNUM_INJURY_NATURE_CODE = A.HRGNUM_INJURY_NATURE_CODE AND D.GNUM_ISVALID = A.GNUM_ISVALID) as injuryNatureName, \
												(SELECT INITCAP(E.HRGSTR_INJURY_TYPE) FROM HRGT_INJURY_TYPE_MST E WHERE E.HRGNUM_INJURY_TYPE_CODE = A.HRGNUM_INJURY_TYPE_CODE AND E.GNUM_ISVALID = A.GNUM_ISVALID) as injuryTypeName, \
												A.HPMRSTR_INJURY_REMARKS as injuryRemarks, A.HGNUM_DEATH_MANNER_CODE as deathMannerCode, \
												(SELECT INITCAP(F.HGSTR_DEATH_MANNER_NAME) FROM HGBT_DEATH_MANNER_MST F WHERE F.HGNUM_DEATH_MANNER_CODE = A.HGNUM_DEATH_MANNER_CODE AND F.GNUM_ISVALID = A.GNUM_ISVALID) as deathMannerName, \
												(SELECT INITCAP(G.HRGSTR_FNAME)||' '||INITCAP(G.HRGSTR_MNAME)||' '||INITCAP(G.HRGSTR_LNAME) FROM HRGT_PATIENT_DTL G WHERE G.HRGNUM_PUK = A.HRGNUM_PUK) as patName, \
												(SELECT H.GSTR_GENDER_NAME FROM GBLT_GENDER_MST H WHERE H.gstr_gender_code=(select j.gstr_gender_code from HRGT_PATIENT_DTL j where j.HRGNUM_PUK = a.HRGNUM_PUK) AND H.GNUM_ISVALID = 1) as patGender, \
												ahis_util.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, \
												(SELECT decode(j.gstr_gender_code,'F',decode(HRGSTR_SPOUSENAME,NULL,DECODE(HRGSTR_FATHER_NAME,NULL,'','D/o '||initcap(HRGSTR_FATHER_NAME)),'W/o '||initcap(HRGSTR_SPOUSENAME)),DECODE(HRGSTR_FATHER_NAME,NULL,'','S/o '||initcap(HRGSTR_FATHER_NAME))) FROM hrgt_patient_dtl j WHERE j.hrgnum_puk = a.hrgnum_puk)  AS husbandName, \
												DATE_PART('day',(A.HPMRDT_DEATH_DATETIME-A.HPMRDT_ONSET_DATE)) AS daysInterval,  \
												DECODE(HRGNUM_ADMISSION_NO,NULL,'',(SELECT TO_CHAR(hipdt_admdatetime,'dd-Mon-yyyy hh24:mi') FROM HIPT_PATADMDISC_DTL b WHERE b.HIPNUM_ADMNO=a.HRGNUM_ADMISSION_NO AND b.GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE)) AS patAdmDate \
												FROM HPMRT_PAT_DEATH_DTL A WHERE A.HRGNUM_PUK = ? AND \
												A.GNUM_ISVALID = ?


SELECT_HANDOVER_DETAIL.HPMRT_PAT_DEATH_DTL =    SELECT A.HPMRNUM_BODY_HANDOVER_TO AS bodyHandoverTo,A.HPMRNUM_CERTIFICATE_ID AS deathCertificateId,HGNUM_DEPTUNITCODE AS departmentUnitCode,TO_char(HPMRDT_BODY_HANDOVER_DATETIME,'dd-Mon-yyyy HH24:MI') AS bodyHandoverDateTime,HPMRSTR_RELATIVE_NAME AS relativeName, \
                                                HPMRSTR_RELATIVE_ADDRESS AS relativeAddress,GNUM_RELATIVECODE AS relativeCode,HPMRSTR_OFFICER_NAME officerName,GNUM_HANDOVER_BY AS handoverBy,HPMRSTR_OFFICER_DESIG AS officerDesignation,HPMRSTR_OFFICER_BADGENO AS officerBadgeNo,hpmrdt_verification_datetime||' '||hpmrdt_verification_datetime AS verificationDate  \
                                                FROM HPMRT_PAT_DEATH_DTL A WHERE A.HRGNUM_PUK=? AND A.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=? 
 


UPDATE_HANDOVER_DETAIL.HPMRT_PAT_DEATH_DTL=	   UPDATE HPMRT_PAT_DEATH_DTL SET HPMRNUM_BODY_HANDOVER_TO=?,HPMRDT_BODY_HANDOVER_DATETIME=TO_DATE(?,'dd-Mon-yyyy HH24:MI'),HPMRSTR_RELATIVE_NAME=?,HPMRSTR_RELATIVE_ADDRESS=?,GNUM_RELATIVECODE=?,HPMRSTR_OFFICER_NAME=?, \
                                               HPMRSTR_OFFICER_DESIG=?,GNUM_HANDOVER_BY=?,HPMRSTR_OFFICER_BADGENO=?,HPMRSTR_HANDOVERTO_EMPID=?,HPMRNUM_CERTIFICATE_ID=? WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? 
								
					
UPDATE_CERTIFICAREID_DETAIL.HPMRT_PAT_DEATH_DTL=	  UPDATE HPMRT_PAT_DEATH_DTL SET HPMRNUM_CERTIFICATE_ID=? WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? \
                                                      AND GNUM_HOSPITAL_CODE=? 
								
							
SELECT.DEAD_PATIENT_LIST.HPMRT_PAT_DEATH_DTL=    SELECT HRGNUM_PUK AS patCrNo, TO_CHAR (HPMRDT_DEATH_DATETIME, 'DD-MON-YYYY HH24:MI') AS deathDate, DECODE (HPMRNUM_BODY_HANDOVER_TO, NULL, 'No', 'Yes') AS bodyHandoverTo, \
        										DECODE (HPMRNUM_CERTIFICATE_ID, NULL, 'No', 'Yes') AS deathCertificateId, (INITCAP (HRGSTR_FNAME) || ' ' || INITCAP (HRGSTR_MNAME) || ' ' || INITCAP (HRGSTR_LNAME)) AS patName, \
           		 								DECODE (gstr_gender_code, 1, 'M', 2, 'F', 'O') || ' / ' || hrgstr_age as patAge  FROM HPMRT_PAT_DEATH_DTL A \
   												WHERE GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ? AND (HPMRNUM_CERTIFICATE_ID IS NULL OR HPMRNUM_BODY_HANDOVER_TO IS NULL) ORDER BY patname							
													
GET_MLC_NO.HRGT_PATIENT_MLC_DTL = SELECT HRGSTR_MLC_NO FROM HRGT_PATIENT_MLC_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ? AND GNUM_ISVALID =? \
									AND HRGNUM_S_NO = (SELECT MAX(HRGNUM_S_NO) FROM HRGT_PATIENT_MLC_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_VISIT_NO = ?)


SELECT.CLINICAL_DEPT.GBLT_DEPARTMENT_MST	=	SELECT  gnum_dept_code, gstr_dept_name FROM gblt_department_mst a  WHERE (gnum_isvalid = ? or gnum_isvalid=?) AND gnum_hospital_code = ? AND gnum_dept_type = ? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_dept_code IN ( \
            									SELECT HGNUM_DEPT_CODE  FROM hgbt_unit_mst WHERE HGNUM_DEPT_CODE = a.gnum_dept_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code   AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) ORDER BY gstr_dept_name 

GENERATE.FILENOVIEW	=	Select ahis_reg.FileNoView(?,?) from dual            									

//--------------------------------------------------YellowSlip_Entry_Dtl-----------------------------------------------------------------------------------            									

INSERT.HRGT_YELLOWSLIP_ENTRY_DTL	=	INSERT INTO HRGT_YELLOWSLIP_ENTRY_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO,HRGNUM_SLNO, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, PSRSTR_EMP_NO, HRGDT_NEXT_VISIT_DATE, GNUM_DIAGNOSTIC_TYPE_CODE, HRGNUM_DIAGNOSTIC_CODE, HRGNUM_ENTRY_MODE, HRGSTR_IP_ADD, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GNUM_ISVALID) \
 										VALUES(?,?,?,(select nvl(max(HRGNUM_SLNO),0)+1 from HRGT_YELLOWSLIP_ENTRY_DTL where HRGNUM_PUK=? and HRGNUM_EPISODE_CODE=? and HRGNUM_VISIT_NO=?),?,?,?,?,?,?,?,?,?,SYSDATE,?,?)            									

UPDATE.IS_VALID.HRGT_YELLOWSLIP_ENTRY_DTL	=	UPDATE HRGT_YELLOWSLIP_ENTRY_DTL set GNUM_ISVALID=? WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND hrgnum_visit_no = ?  and HRGNUM_SLNO=? AND gnum_hospital_code = ?  

SELECT.YELLOW_SLIP_ENTRY_USER.BY_DATE	=	SELECT DISTINCT gnum_seat_id seatId,(SELECT gstr_user_name || ' (' || gstr_usr_name || ')' FROM gblt_user_mst WHERE gnum_userid = a.gnum_seat_id AND gnum_isvalid = ? AND gnum_hospital_code = ?) userName,(SELECT SUM (DECODE (hrgnum_monitoring_flag, ?, 1, 0)) FROM hrgt_yellowslip_monitoring_dtl \
                  							WHERE gnum_enter_by = a.gnum_seat_id) minor,(SELECT SUM (DECODE (hrgnum_monitoring_flag, ?, 1, 0)) FROM hrgt_yellowslip_monitoring_dtl WHERE gnum_enter_by = a.gnum_seat_id) major FROM hrgt_yellowslip_entry_dtl a  WHERE TRUNC (gdt_entry_date) BETWEEN TRUNC (TO_DATE (?,'dd-Mon-yyyy')) \
                                            AND TRUNC (TO_DATE (?,'dd-Mon-yyyy')) and GNUM_HOSPITAL_CODE=? GROUP BY gnum_seat_id            									
                                            
INSERT.HRGT_YELLOWSLIP_MONITORING_DTL	=	INSERT INTO HRGT_YELLOWSLIP_MONITORING_DTL (GNUM_ENTER_BY, HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_MONITORING_FLAG, HRGSTR_REMARKS, HRGSTR_ACTION, HRGSTR_IP_ADD, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GNUM_ISVALID) VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,?,?)                                            
                                            
SELECT.YELLOW_SLIP_ENTRY_BY_USER.HRGT_YELLOWSLIP_ENTRY_DTL	=	SELECT a.hrgnum_puk patCrNo,(SELECT hrgstr_fname||' '||HRGSTR_MNAME||' '||HRGSTR_LNAME FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = b.gnum_hospital_code) patname, a.gnum_seat_id seatid,(SELECT gstr_user_name || ' (' || gstr_usr_name || ')' FROM gblt_user_mst \
         													WHERE gnum_userid = a.gnum_seat_id  AND gnum_isvalid = ?  AND gnum_hospital_code = a.gnum_hospital_code) username, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = b.gnum_dept_code AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) \
         													AND gnum_hospital_code = b.gnum_hospital_code) department, gnum_dept_code departmentCode,(SELECT hgstr_unitname FROM hgbt_unit_mst  WHERE hgnum_deptunitcode = b.hgnum_deptunitcode AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) \
         													AND gnum_hospital_code = b.gnum_hospital_code) departmentunit,hgnum_deptunitcode departmentUnitCode, to_char(hrgdt_episode_date,'dd-Mon-yyyy') visitDate,to_char(a.gdt_entry_date,'dd-Mon-yyyy hh24:mi') entryDate,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,HRGNUM_SLNO serialNo FROM hrgt_yellowslip_entry_dtl a, \
         													hrgt_episode_dtl b WHERE TRUNC (a.gdt_entry_date) BETWEEN TRUNC (TO_DATE (?,'dd-Mon-yyyy')) AND TRUNC (TO_DATE (?,'dd-Mon-yyyy')) AND a.hrgnum_puk = b.hrgnum_puk  AND a.hrgnum_episode_code = b.hrgnum_episode_code  AND a.hrgnum_visit_no = b.hrgnum_visit_no AND a.gnum_hospital_code = b.gnum_hospital_code AND a.gnum_hospital_code = ?  \
         													and a.GNUM_SEAT_ID like ? and a.gnum_isvalid=?  AND a.hrgnum_visit_no = (SELECT MAX (hrgnum_visit_no) FROM hrgt_yellowslip_entry_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND HRGNUM_SLNO = a.HRGNUM_SLNO) order by entryDate
         													
SELECT.YELLOW_SLIP_ENTRY.BY_CRNO_EPISODE_NO		=	SELECT b.hrgnum_puk patcrno,TO_CHAR (hrgdt_next_visit_date, 'dd-Mon-yyyy') episodenextvisitdate, hrgstr_next_visit_dept_code episodenextvisitdeptcode, psrstr_emp_no empno, hrgstr_complained_dtl complaindetail, hrgnum_is_episode_open episodeisopen, b.hgnum_deptunitcode departmentunitcode, TO_CHAR (hrgdt_episode_date, 'dd-Mon-yyyy') episodedate, b.hgnum_next_visit_deptunitcode episodenextvisitdeptunitcode, \
											  hrgnum_episode_type_code episodetypecode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = b.gnum_dept_code AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND gnum_hospital_code = b.gnum_hospital_code) department, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = b.hgnum_deptunitcode \
									          AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND gnum_hospital_code = b.gnum_hospital_code) departmentunit, b.hrgnum_episode_code episodecode, b.hrgnum_visit_no episodevisitno,(SELECT gnum_diagnosis_code_type FROM hgbt_unit_mst WHERE hgnum_deptunitcode =b.hgnum_deptunitcode AND gnum_hospital_code = b.gnum_hospital_code \
											  AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (gnum_isvalid = 1 OR gnum_isvalid = 2) )diagnosisCodeType FROM hrgt_episode_dtl b WHERE b.hrgnum_puk = ? AND b.hrgnum_episode_code = ? AND b.hrgnum_visit_no = ? AND b.gnum_hospital_code = ?  AND b.gnum_isvalid = ? 
 
										
SELECT.YELLOW_SLIP_DIAGNOSIS_DTL.BY_CRNO_EPISODE_NO	=	SELECT a.hrgnum_puk patcrno, gnum_diagnostic_type_code diagnostictypecode,hrgnum_diagnostic_code diagnosticcode, hrgnum_diagnosis_code_type diagnosiscodetype, DECODE (hrgnum_diagnosis_code_type, 0, (SELECT hgbstr_disease FROM hgbt_icd_disease_mst WHERE TRIM (hgbstr_disease_code) = TRIM (a.hrgnum_diagnostic_code)), 1, (SELECT hgbstr_disease_desc \
                     								FROM hgbt_hospital_disease_mst WHERE hgbstr_hospital_disease_code = a.hrgnum_diagnostic_code)) dignosisname, a.hrgnum_s_no serialno, (SELECT hgbstr_diagnostic_type_name FROM hgbt_diagnosis_type_mst WHERE hgbnum_diagnostic_type_code =  a.gnum_diagnostic_type_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) diagnostictypename, \
												    a.hrgnum_episode_code episodecode, a.hrgnum_visit_no episodevisitno FROM hrgt_episode_diagnosis_dtl a where hrgnum_puk = ? AND hrgnum_episode_code = ? AND hrgnum_visit_no = ? AND gnum_hospital_code = ?  AND gnum_isvalid = ?										
										

SELECT.PREVIOUS_DIAGNOSIS.HRGT_EPISODE_DIAGNOSIS_DTL	=	SELECT hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode, hrgnum_diagnostic_code AS diagnosticcode,DECODE(hrgnum_diagnosis_code_type, 0, (SELECT hgbstr_disease FROM hgbt_icd_disease_mst WHERE TRIM (hgbstr_disease_code) =TRIM (a.hrgnum_diagnostic_code)), 1, (SELECT hgbstr_disease_desc FROM hgbt_hospital_disease_mst WHERE TRIM (hgbstr_hospital_disease_code) = \
                                               				TRIM (a.hrgnum_diagnostic_code) AND gnum_hospital_code = a.gnum_hospital_code)) AS dignosisname, gnum_diagnostic_type_code AS diagnostictypecode, (SELECT hgbstr_diagnostic_type_name FROM hgbt_diagnosis_type_mst WHERE a.gnum_diagnostic_type_code =  hgbnum_diagnostic_type_code AND gnum_hospital_code = a.gnum_hospital_code) AS diagnostictypename, \
         													hrgstr_remarks AS remarks,hrgnum_diagnosis_code_type AS diagnosiscodetype, hrgnum_episode_code AS episodecode, hrgnum_s_no AS serialno, hrgnum_admission_no AS admissionno, hrgnum_visit_no AS episodevisitno, gnum_seat_id AS seatid,TO_CHAR (hrgt_episode_date, 'dd-Mon-yyyy') AS episodedate, TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy') AS entrydate,hbnum_isrepeat AS isrepeat \
    														FROM hrgt_episode_diagnosis_dtl a WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND gnum_hospital_code = ?  AND a.hrgnum_visit_no =(SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_diagnosis_dtl WHERE hrgnum_puk = a.hrgnum_puk  AND hrgnum_episode_code = a.hrgnum_episode_code) and HBNUM_ISREPEAT in(?,?) ORDER BY hrgnum_s_no 


UPDATE_PREV_RECORD.HRGT_PATIENT_MLC_DTL = UPDATE HRGT_PATIENT_MLC_DTL SET GNUM_ISVALID = ?::numeric WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND HRGNUM_S_NO = ?


#Changed By Amit Garg as OPD G5 Changes
SELECT.EPISODE_REF_DTL.HRGT_EPISODE_REF_DTL		=	SELECT a.hrgnum_puk AS patcrno, INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, (SELECT gstr_dept_name  FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_from_dept_code AND gnum_hospital_code = a.gnum_hospital_code ) AS fromdepartment, \
                                                   (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_from_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code ) fromdepartmentunit,TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime, \
   													INITCAP (a.gstr_remarks) AS remarks, hrgnum_to_dept_code AS todepartmentcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code AND gnum_hospital_code = a.gnum_hospital_code ) AS todepartment, hgnum_to_deptunitcode AS todepartmentunitcode, \
       												a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_to_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code ) \
                                          			AS todepartmentunit,a.hrgnum_from_dept_code AS fromdepartmentcode, to_char(a.gdt_acceptance_date,'dd-Mon-yyyy') episodeReferAcceptDate,coalesce(a.gdt_acceptance_date::character varying,'1','0')isAccepted FROM hrgt_episode_ref_dtl a, hrgt_daily_patient_dtl b WHERE b.hrgnum_puk = a.hrgnum_puk AND b.hrgnum_episode_code = a.hrgnum_episode_code AND b.hrgnum_visit_no = a.hrgnum_visit_no AND b.gnum_dept_code = a.hrgnum_from_dept_code AND a.hrgnum_to_dept_code IS NOT NULL \
   													AND b.gnum_hospital_code = a.gnum_hospital_code and a.HRGNUM_PUK = ? AND a.HRGNUM_EPISODE_CODE = ?  and a.HRGNUM_VISIT_NO=? AND a.gnum_hospital_code = ?  


SELECT.HRGT_PATIENT_DOCUMENT_DTL.COUNT_CR_NO_WISE=SELECT COUNT(*) FROM HRGT_PATIENT_DOCUMENT_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?

UPDATE.HRGT_PATIENT_DOCUMENT_DTL.REVOKE_DOCUMENT=UPDATE HRGT_PATIENT_DOCUMENT_DTL SET GNUM_ISVALID=?, HRGSTR_REMOVE_REASON=?, GDT_REMOVE_DATE=SYSDATE, GNUM_REMOVE_SEATID=? WHERE HRGSTR_DOCUMENT_ID=? AND GNUM_HOSPITAL_CODE=?										                                             

SELECT.MLC_DOCUMENT_BY_MLC_EPISODE.HRGT_PATIENT_DOCUMENT_DTL=	SELECT a.hrgstr_doc_title AS documenttitle, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy hh24:mi') AS entrydate, hrgstr_document_id AS documentname, a.hrgstr_dir_path AS documentdirectorypath \
																FROM hrgt_patient_document_dtl a  WHERE hrgnum_puk = ? AND hrgnum_episode_code = ? AND gnum_isvalid = ? AND gnum_file_type = ? 


UPDATE.ROOM_USABILITY.HOPT_DEPT_UNIT_ROSTER_MST=UPDATE hopt_dept_unit_roster_mst   SET hrgnum_room_usability = ?  WHERE hgnum_deptunitcode =?   AND hgnum_room_code = ?  AND hrgnum_room_sequence = ?  AND hopnum_week_of_month = ?    AND hopnum_day_of_week = ?    AND hgnum_shift_code = ?    AND hgnum_unit_seq_no = ?   AND gnum_hospital_code = ?    AND gnum_isvalid = ?

																


SELECT_ADMITTED_EPISODE.HRGT_EPISODE_DTL = SELECT HRGNUM_PUK as patcrno, hrgnum_episode_code AS episodecode,HRGNUM_VISIT_NO as episodevisitno, a.gnum_dept_code AS departmentcode, (SELECT gstr_dept_name FROM gblt_department_mst \
													WHERE gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_dept_code = a.gnum_dept_code \
													AND gnum_hospital_code = a.gnum_hospital_code) AS department, a.hgnum_deptunitcode AS departmentunitcode, (SELECT hgstr_unitname \
													FROM hgbt_unit_mst WHERE gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND \
													hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code) AS departmentunit, hgnum_treatment_cat_code \
													AS patsecondarycatcode,TO_CHAR ((SELECT hrgdt_valid_upto FROM hrgt_seccat_change_dtl b WHERE b.hrgnum_puk = a.hrgnum_puk AND \
													b.hrgnum_episode_code = a.hrgnum_episode_code AND b.hrgnum_s_no = (SELECT MAX (hrgnum_s_no) FROM hrgt_seccat_change_dtl WHERE \
													hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code) AND \
													gnum_hospital_code = a.gnum_hospital_code), 'dd-Mon-yyyy') AS validupto,hgnum_patient_cat_code AS patprimarycatcode FROM \
													hrgt_episode_dtl a WHERE HRGNUM_ADMISSION_NO IS NOT NULL \
													AND a.hrgnum_puk = ? AND a.gnum_hospital_code = ? AND a.gnum_isvalid=?	\
													AND a.hrgnum_admission_no IN(SELECT b.HIPNUM_ADMNO FROM HIPT_PATADMDISC_DTL b WHERE b.HRGNUM_PUK=a.HRGNUM_PUK AND  b.HRGNUM_EPISODE_CODE =a.HRGNUM_EPISODE_CODE AND b.HRGNUM_VISIT_NO= a.HRGNUM_VISIT_NO and b.HIPDT_ADMSTATUS_CODE = ?)										


UPDATE.SECONDARY_CAT_N_VALIDUPTO.HRGT_EPISODE_DTL = UPDATE HRGT_EPISODE_DTL SET HGNUM_TREATMENT_CAT_CODE=?, HRGDT_TREATMENTCAT_VALIDUPTO =SYSDATE+ to_number(nvl(?,0)::numeric)  \
													WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?


UPDATE.TREATMENT_CATEGORY.HRGT_DAILY_PATIENT_DTL = UPDATE HRGT_DAILY_PATIENT_DTL SET hgnum_treatment_cat_code = ?  WHERE hrgnum_puk = ?  AND hrgnum_episode_code = ? AND HRGNUM_VISIT_NO =?


UPDATE.SECONDARY_CAT_N_EXPIRY_DATE.HRGT_EPISODE_DTL = UPDATE HRGT_EPISODE_DTL SET HRGDT_TREATMENTCAT_VALIDUPTO =to_date(?,'dd-Mon-yyyy') WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?


UPDATE.SECONDARY_CAT_REVOKE.HRGT_EPISODE_DTL = UPDATE HRGT_EPISODE_DTL SET HRGDT_TREATMENTCAT_VALIDUPTO =TO_DATE(?,'dd-Mon-yyyy'), HGNUM_TREATMENT_CAT_CODE = ? WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?


UPDATE.PAT_PRIMARY_CAT.HRGT_EPISODE_DTL = UPDATE HRGT_EPISODE_DTL SET HGNUM_PATIENT_CAT_CODE =? WHERE HRGNUM_PUK =? AND GNUM_HOSPITAL_CODE=? AND TRUNC(GDT_ENTRY_DATE)=TRUNC(SYSDATE)


INSERT.HGBT_UNITCONSULTANT_ROSTER_MST=insert into HGBT_UNITCONSULTANT_ROSTER_MST(HGNUM_DEPTUNITCODE, PSRSTR_EMP_NO, HOPNUM_WEEK_OF_MONTH, HOPNUM_DAY_OF_WEEK, HGNUM_SHIFT_CODE, HGNUM_ROOM_CODE, GNUM_ISVALID, GDT_ENTRY_DATE, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE) \
									  values(?,?,?,?,?,?,?,SYSDATE,?,?)

UPDATE.HGBT_UNITCONSULTANT_ROSTER_MST=update HGBT_UNITCONSULTANT_ROSTER_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=SYSDATE, GNUM_LSTMOD_SEATID=? WHERE  hgnum_deptunitcode = ? AND psrstr_emp_no = ? AND hgnum_room_code = ?  AND gnum_isvalid = ?  AND gnum_hospital_code = ? 												


SELECT.CONSULTANT_ROSTER_UNIT_ROOM_SHIFT_WISE.HGBT_UNITCONSULTANT_ROSTER_MST=SELECT hgnum_deptunitcode as departmentUnitCode, psrstr_emp_no as consultantEmpId, hopnum_week_of_month as weekOfMonth,hopnum_day_of_week as dayOfWeek, hgnum_shift_code as shiftCode, hgnum_room_code as roomCode, gnum_isvalid as isValid,gdt_entry_date as entryDate, gdt_lstmod_date as lastModifyDate, gnum_lstmod_seatid as lastModifySeatID, gnum_seat_id as seatID,gnum_hospital_code as hospitalCode \
								FROM hgbt_unitconsultant_roster_mst WHERE hgnum_deptunitcode = ?  AND psrstr_emp_no = ? AND hgnum_room_code = ?  AND gnum_isvalid = ?  AND gnum_hospital_code = ?    ORDER BY WEEKOFMONTH ,DAYOFWEEK,SHIFTCODE

SELECT_ALL_EXCEPT_SELECTED_UNIT_ROOM.CONSULTANT_ROSTER_UNIT_SHIFT_WISE.HGBT_UNITCONSULTANT_ROSTER_MST=SELECT hgnum_deptunitcode as departmentUnitCode, psrstr_emp_no as consultantEmpId, hopnum_week_of_month as weekOfMonth,hopnum_day_of_week as dayOfWeek, hgnum_shift_code as shiftCode, hgnum_room_code as roomCode, gnum_isvalid as isValid,gdt_entry_date as entryDate, gdt_lstmod_date as lastModifyDate, gnum_lstmod_seatid as lastModifySeatID, gnum_seat_id as seatID,gnum_hospital_code as hospitalCode \
						  FROM hgbt_unitconsultant_roster_mst   WHERE (   hgnum_deptunitcode != ?    OR (    hgnum_deptunitcode = ?  \
						  AND hgnum_room_code IN (SELECT a.hgnum_room_code AS roomcode  FROM hrgt_dept_unit_room_mst a   WHERE a.hgnum_deptunitcode =? AND a.hgnum_room_code !=?  AND a.gnum_isvalid > ?  AND (TO_CHAR (NVL (a.gdt_effective_to, SYSDATE),'DD-MM-YY') >= TO_CHAR (SYSDATE, 'DD-MM-YY') )   AND a.gnum_hospital_code =? ) ) )    AND psrstr_emp_no = ?     AND gnum_isvalid = ?    AND gnum_hospital_code =?

																												
#Changed By Amit Garg as OPD G5 Changes
INSERT.NEW.HRGT_EPISODE_SUMMARY_DTL	=	INSERT INTO HRGT_EPISODE_SUMMARY_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO,  HRGSTR_VISIT_NOTES, HRGDT_NEXT_VISIT_DATE, \
										 HRGSTR_EPISODE_SUMMARY, HRGNUM_NEXTVISIT_CRITERIA, PSRSTR_EMP_NO, HRGNUM_NEXTVISIT_DURATION, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD,hrgstr_visit_reason,hrgstr_visit_reason_ids) \
										VALUES (?,?,?,?,?::timestamp without time zone,?,?,?,?,?,SYSDATE,?,?,?,?,?)

#Changed By Amit Garg as OPD G5 Changes
UPDATE.OLD.HRGT_EPISODE_SUMMARY_DTL	=	UPDATE HRGT_EPISODE_SUMMARY_DTL SET GNUM_ISVALID=? WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?

#Changed By Amit Garg as OPD G5 Changes
SELECT.ALL_VISITS_BY_EPISODE_NO.HRGT_EPISODE_DTL	=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_EPISODE_CODE AS episodeCode, A.HRGNUM_VISIT_NO AS episodeVisitNo, A.HRGNUM_VISIT_TYPE AS episodeVisitType, A.HRGNUM_EPISODE_TYPE_CODE AS episodeTypeCode, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, \
														 A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, \
														 A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN,A.GNUM_SEAT_ID AS SEATID, \
														TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, A.HGNUM_WARD_CODE AS WARDCODE, \
														 A.HGNUM_TREATMENT_CAT_CODE AS PATSECONDARYCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATPRIMARYCATCODE, \
														A.HRGNUM_IS_REF AS isReferred, A.HRGDT_EXP_DATE AS expiryDate,  A.GNUM_HOSPITAL_CODE AS hospitalCode, A.HRGSTR_IP_ADD AS systemIPAddress, A.HRGNUM_ISCARDPRINT AS isCardPrint, \
														 A.HRGDT_TREATMENTCAT_VALIDUPTO AS validUpto, TO_CHAR(A.HRGDT_EPISODE_START_DATE,'dd-Mon-yyyy') AS EPISODEDATE ,\
														 TO_CHAR(hrgdt_next_visit_date,'dd-Mon-yyyy') as episodeNextVisitDate,hrgstr_visit_notes as complainDetail,hrgstr_visit_reason as visitReason,hrgnum_nextvisit_duration as nextVisitDuration,hrgnum_nextvisit_criteria as nextVisitCriteria FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK = ? AND A.HRGNUM_EPISODE_CODE = ? ORDER BY A.HRGNUM_VISIT_NO DESC														 
														

#Changed By Amit Garg as OPD G5 Changes
SELECT.ALL_SUMMARY.HRGT_EPISODE_DTL	=	SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_EPISODE_CODE AS episodeCode, X.HRGNUM_VISIT_NO AS episodeVisitNo, X.HRGSTR_VISIT_NOTES AS visitNotes, TO_CHAR(X.HRGDT_NEXT_VISIT_DATE,'dd-Mon-yyyy') AS episodeNextVisitDate, \
												 X.HRGNUM_NEXTVISIT_CRITERIA AS nextVisitCriteria, X. PSRSTR_DOC_EMP_NO AS empNo, X.HRGNUM_NEXTVISIT_DURATION AS nextVisitDuration, X.GNUM_DOC_SEAT_ID AS seatId,HRGNUM_IS_EPISODE_OPEN AS episodeIsOpen, hrgstr_episode_summary as episodeSummary,\
												TO_CHAR(X.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, X.GNUM_ISVALID AS isValid, X.GNUM_HOSPITAL_CODE AS hospitalCode, X.HRGSTR_IP_ADD AS systemIPAddress,x.HRGSTR_KEYWORDS AS episodekeywords, \
                                                x.HRGSTR_KEYWORDS_IDS AS episodekeywordsId, hrgstr_visit_reason AS visitReason  FROM HRGT_EPISODE_DTL X WHERE X.HRGNUM_PUK=? AND X.HRGNUM_EPISODE_CODE=? and x.HRGNUM_VISIT_NO=? and x.GNUM_HOSPITAL_CODE=?  \
												AND GNUM_ISVALID=? ORDER BY X.HRGNUM_VISIT_NO DESC


UPDATE.UNKNOWN_CONVERSION.HRGT_DAILY_PATIENT_DTL = UPDATE HRGT_DAILY_PATIENT_DTL SET HRGSTR_PREV_PUK=?, HRGNUM_ID_NO=?, HRGDT_DOB=?, HRGNUM_IS_MLC=?, HRGNUM_IS_ACTUAL_DOB=?, \
													HRGSTR_FNAME=?, HRGSTR_MNAME=?, HRGSTR_LNAME=?, GNUM_GENDER_CODE=?, GNUM_MARITAL_STATUS_CODE=?, \
													GNUM_RELIGION_CODE=?, HRGSTR_FATHER_NAME=?, HRGSTR_MOMNAME=?, HRGNUM_ISUNKNOWN=?, HRGNUM_MONTH_INCOME=?, \
													HRGNUM_IS_URBAN=?, HRGNUM_IS_REF=?,  HRGNUM_IS_LOCAL=?, HRGSTR_HOUSE_NO=?, GNUM_CITY_LOC_CODE=?, HRGSTR_DISTRICT=?, \
													NUM_DIST_ID=?, HRGSTR_CITY=?, GNUM_STATECODE=?,HRGSTR_STATE_NAME=?, GNUM_COUNTRYCODE=?, HRGNUM_PIN=?, \
													HRGSTR_IP_ADD=?, HRGSTR_CONTACT_NO=?, HRGNUM_ADD_TYPE_CODE=?, HGNUM_PATIENT_CAT_CODE=?, HRGSTR_CITY_LOCATION=?, \
													GNUM_NATIONALITY_CODE=?, HRGSTR_SPOUSENAME=?, HRGSTR_NATIONAL_ID=?, HBNUM_BLDGRP_CODE=?, HRGNUM_ISNEWBORN=?, \
													HRGSTR_PAT_OCCUPATION=?,HRGSTR_FAT_OCCUPATION=?,HRGSTR_HUS_OCCUPATION=?, HRGSTR_NICKNAME=?,HRGSTR_CARD_NO=?, \
													HRGNUM_IS_BROUGHTDEAD=?, HGNUM_PAT_STATUS_CODE=? WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?


SELECT_REPORTQUERY_HOSPATSTAT_REPORT=    a.nma as newMaleAdult,a.nfa as newFemaleAdult,a.noa as newOtherAdult,a.nmc as newMaleChild,a.nfc as newFemaleChild,a.noc as newOtherChild, \
										 a.oma as oldMaleAdult,a.ofa as oldFemaleAdult,a.ooa as oldOtherAdult,a.omc as oldMaleChild,a.ofc as oldFemaleChild,a.ooc as oldOtherChild, (SELECT gstr_dept_name FROM GBLT_DEPARTMENT_MST WHERE gnum_hospital_code = ?  AND gnum_dept_code = SUBSTR (a.deptUnitcode, 1, 3) AND gnum_isvalid = ?  AND gdt_effective_frm <= TRUNC (SYSDATE) \
           						AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))||'-'|| (SELECT u.HGSTR_UNITNAME FROM HGBT_UNIT_MST u WHERE u.GNUM_ISVALID=?   AND u.GNUM_HOSPITAL_CODE=? \
   									AND u.hgnum_deptunitcode= a.deptUnitcode    AND u.gdt_effective_frm <= TRUNC (SYSDATE)   AND NVL (u.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) unit  FROM ( \
										SELECT trunc(@) epi_date, a.HGNUM_DEPTUNITCODE deptUnitcode, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),10,1,0),0)),0) nma, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),20,1,0),0)),0) nfa, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),30,1,0),0)),0) noa, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),11,1,0),0)),0) nmc,  \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),21,1,0),0)),0) nfc, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,0,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),31,1,0),0)),0) noc, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),10,1,0),0)),0) oma, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),20,1,0),0)),0) ofa, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),30,1,0),0)),0) ooa, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),11,1,0),0)),0) omc, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),21,1,0),0)),0) ofc, \
							NVL(SUM(DECODE(HRGNUM_IS_OLD,1,DECODE(ahis_util.PUK_TYPE(a.HRGNUM_PUK,12),31,1,0),0)),0) ooc \
							FROM HRGT_EPISODE_DTL a WHERE a.gnum_hospital_code=? AND HRGDT_EPISODE_DATE >= TRUNC(TO_DATE(?,'DD-Mon-yyyy')) \
							AND HRGDT_EPISODE_DATE <= TRUNC(TO_DATE(?,'DD-Mon-yyyy')) AND a.HGNUM_DEPTUNITCODE LIKE ? \
							GROUP BY trunc(@),a.HGNUM_DEPTUNITCODE) a ORDER BY unit, a.epi_date



 																									
SELECT_REPORTQUERY_AGE_WISE_REPORT_OLD_20_JAN_10 =  unit, SUM(DECODE(agerange,'0-13',DECODE(gender,1,1,0),0)) as m_0_13, SUM(DECODE(agerange,'0-13',DECODE(gender,2,1,0),0)) as f_0_13, \
SUM(DECODE(agerange,'14-25',DECODE(gender,1,1,0),0)) as  m_14_25, \
SUM(DECODE(agerange,'14-25',DECODE(gender,2,1,0),0)) as f_14_25, \
SUM(DECODE(agerange,'26-35',DECODE(gender,1,1,0),0)) as m_26_35, \
SUM(DECODE(agerange,'26-35',DECODE(gender,2,1,0),0)) as f_26_35, \
SUM(DECODE(agerange,'36-45',DECODE(gender,1,1,0),0)) as m_36_45, \
SUM(DECODE(agerange,'36-45',DECODE(gender,2,1,0),0)) as f_36_45, \
SUM(DECODE(agerange,'46-55',DECODE(gender,1,1,0),0)) as m_46_55, \
SUM(DECODE(agerange,'46-55',DECODE(gender,2,1,0),0)) as f_46_55, \
SUM(DECODE(agerange,'56-65',DECODE(gender,1,1,0),0)) as m_56_65, \
SUM(DECODE(agerange,'56-65',DECODE(gender,2,1,0),0)) as f_56_65, \
SUM(DECODE(agerange,'66+',DECODE(gender,1,1,0),0)) as m_66, \
SUM(DECODE(agerange,'66+',DECODE(gender,1,2,0),0)) as f_66 \
FROM  \
( \
	SELECT CASE WHEN ((hrgdt_episode_date - hrgdt_dob) / (30 * 12) <=1 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <13 \
	) THEN '0-13' \
	WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=14 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <25 \
	) THEN '14-25' \
	WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=26 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) < 35) \
	THEN '26-35'  \
	WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=36 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <45 \
	)THEN '36-45' \
	WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=46 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <55 \
	)THEN '46-55' \
	WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=56 \
	AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <65 \
	)THEN '56-65' \
	ELSE '66+'  \
	END agerange, \
	( \
		SELECT d.gstr_dept_name FROM GBLT_DEPARTMENT_MST d \
		WHERE gnum_dept_code = e.gnum_dept_code \
		AND gnum_hospital_code = e.gnum_hospital_code \
		AND gdt_effective_frm <= TRUNC (e.gdt_entry_date) \
		AND NVL (gdt_effective_to, e.gdt_entry_date + 1) >= \
		TRUNC (e.gdt_entry_date) \
	)||'-'|| \
	( \
		SELECT u.HGSTR_UNITNAME FROM HGBT_UNIT_MST u WHERE  u.GNUM_ISVALID=? \
		AND u.GNUM_HOSPITAL_CODE=? \
		AND u.hgnum_deptunitcode= e.HGNUM_DEPTUNITCODE \
		AND u.gdt_effective_frm <= TRUNC (SYSDATE) \
		AND NVL (u.gdt_effective_to, SYSDATE + 1) >= TRUNC (e.gdt_entry_date) \
	) \
	unit, \
	gnum_gender_code gender, \
	TRUNC (hrgdt_episode_date) episodedate \
	FROM HRGT_EPISODE_DTL e, HRGT_PATIENT_DTL P \
	WHERE hrgnum_visit_type = 1 \
		AND hrgnum_visit_no = 1 \
		AND hrgnum_is_old = ? \
		AND e.gnum_isvalid = ? \
		AND e.gnum_isvalid = P.gnum_isvalid \
		AND e.gnum_hospital_code = P.gnum_hospital_code \
		AND P.gnum_hospital_code = ? \
		AND e.hgnum_deptunitcode LIKE ? \
		AND trunc(P.hrgdt_register_date) >= \
		TO_DATE (?, 'dd-Mon-yyyy') \
		AND trunc(P.hrgdt_register_date) <= \
		TRUNC (TO_DATE (?, 'dd-Mon-yyyy') ) \
		AND P.hrgnum_puk = e.hrgnum_puk \
) \
GROUP BY  (@),  unit \
ORDER BY  unit,epiDate

								
SELECT_REPORTQUERY_AGE_WISE_REPORT=unit, \
	        SUM (DECODE (agerange, '0-13', DECODE (gender, 1, 1, 0), 0)) AS m_0_13,\
	        SUM (DECODE (agerange, '0-13', DECODE (gender, 2, 1, 0), 0)) AS f_0_13, \
	        SUM (DECODE (agerange, '0-13', DECODE (gender, 3, 1, 0), 0)) AS o_0_13,  \
	        SUM (DECODE (agerange, '14-25', DECODE (gender, 1, 1, 0), 0)) AS m_14_25, \
	        SUM (DECODE (agerange, '14-25', DECODE (gender, 2, 1, 0), 0)) AS f_14_25,  \
	        SUM (DECODE (agerange, '14-25', DECODE (gender, 3, 1, 0), 0)) AS o_14_25,   \
	        SUM (DECODE (agerange, '26-35', DECODE (gender, 1, 1, 0), 0)) AS m_26_35,    \
	        SUM (DECODE (agerange, '26-35', DECODE (gender, 2, 1, 0), 0)) AS f_26_35,    \
	        SUM (DECODE (agerange, '26-35', DECODE (gender, 3, 1, 0), 0)) AS o_26_35,    \
	        SUM (DECODE (agerange, '36-45', DECODE (gender, 1, 1, 0), 0)) AS m_36_45,  \
	        SUM (DECODE (agerange, '36-45', DECODE (gender, 2, 1, 0), 0)) AS f_36_45,  \
	        SUM (DECODE (agerange, '36-45', DECODE (gender, 3, 1, 0), 0)) AS o_36_45, \
	        SUM (DECODE (agerange, '46-55', DECODE (gender, 1, 1, 0), 0)) AS m_46_55, \
	        SUM (DECODE (agerange, '46-55', DECODE (gender, 2, 1, 0), 0)) AS f_46_55, \
	        SUM (DECODE (agerange, '46-55', DECODE (gender, 3, 1, 0), 0)) AS o_46_55, \
	        SUM (DECODE (agerange, '56-65', DECODE (gender, 1, 1, 0), 0)) AS m_56_65, \
	        SUM (DECODE (agerange, '56-65', DECODE (gender, 2, 1, 0), 0)) AS f_56_65, \
	        SUM (DECODE (agerange, '56-65', DECODE (gender, 3, 1, 0), 0)) AS o_56_65, \
	        SUM (DECODE (agerange, '66+', DECODE (gender, 1, 1, 0), 0)) AS m_66, \
	        SUM (DECODE (agerange, '66+', DECODE (gender, 2, 1, 0), 0)) AS f_66, \
	        SUM (DECODE (agerange, '66+', DECODE (gender, 3, 1, 0), 0)) AS o_66 \
	        FROM (SELECT CASE  WHEN (TRUNC ((hrgdt_episode_date - hrgdt_dob) / (30 * 12)) <=13 )   THEN '0-13' \
	                           WHEN (    TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) >= 14 \
	                                 AND TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) <= 25  )   THEN '14-25' \
	                           WHEN (    TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) >= 26 \
	                                 AND TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) <= 35 )    THEN '26-35'   \
	                           WHEN (    TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) >= 36 \
	                            	 AND TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) <= 45 )    THEN '36-45'  \
	                           WHEN (    TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) >= 46  \
	                           		 AND TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) <= 55 )    THEN '46-55'  \
	                           WHEN (    TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) >= 56 \
	                           		 AND TRUNC (  (hrgdt_episode_date - hrgdt_dob)/ (30 * 12) ) <= 65 )    THEN '56-65'  \
	                           WHEN (TRUNC ((hrgdt_episode_date - hrgdt_dob) / (30 * 12)) >=66 ) THEN '66+'  END agerange, \
(SELECT d.gstr_dept_name     FROM gblt_department_mst d  WHERE gnum_dept_code = e.gnum_dept_code  AND gnum_hospital_code = e.gnum_hospital_code   AND gdt_effective_frm <= TRUNC (e.gdt_entry_date) \
 AND NVL (gdt_effective_to, e.gdt_entry_date + 1) >=TRUNC (e.gdt_entry_date)) || '-' || (SELECT u.hgstr_unitname  FROM hgbt_unit_mst u  WHERE u.gnum_isvalid = ?    AND u.gnum_hospital_code = ?  \
 AND u.hgnum_deptunitcode = e.hgnum_deptunitcode   AND u.gdt_effective_frm <= TRUNC (SYSDATE)     AND NVL (u.gdt_effective_to, SYSDATE + 1) >=TRUNC (e.gdt_entry_date)) unit,gnum_gender_code gender, \
 TRUNC (hrgdt_episode_date) episodedate   FROM hrgt_episode_dtl e, hrgt_patient_dtl p   WHERE   hrgnum_is_old IN (?,?)  AND e.gnum_isvalid =?   AND e.gnum_isvalid = p.gnum_isvalid   AND e.gnum_hospital_code = p.gnum_hospital_code \
 AND p.gnum_hospital_code = ?  AND e.hgnum_deptunitcode LIKE ?  AND TRUNC (e.hrgdt_episode_date) >=TO_DATE (?, 'dd-Mon-yyyy') AND TRUNC (e.hrgdt_episode_date) <=TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) \
 AND p.hrgnum_puk = e.hrgnum_puk)  GROUP BY (@), unit ORDER BY unit,epidate
 
 
 
 
SELECT_REPORTQUERY_HOSPATSTATSTATE_REPORT =   (SELECT gstr_dept_name FROM GBLT_DEPARTMENT_MST WHERE gnum_hospital_code = ?  AND gnum_dept_code = SUBSTR (m.deptunitcode, 1, 3) AND gnum_isvalid = ? \
                						AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) \
        							 || '-' || (SELECT u.hgstr_unitname FROM HGBT_UNIT_MST u WHERE u.gnum_isvalid = ? AND u.gnum_hospital_code = ? \
                						AND u.hgnum_deptunitcode = m.deptunitcode AND u.gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (u.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) \
										unit, \
NVL(SUM(DECODE(m.state_code,11,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleChandigarh, \
NVL(SUM(DECODE(m.state_code,11,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleChandigarh, \
NVL(SUM(DECODE(m.state_code,11,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherChandigarh, \
NVL(SUM(DECODE(m.state_code,71,DECODE(m.puk_typ,10,1,11,1,0),0)),0) malePunjab, \
NVL(SUM(DECODE(m.state_code,71,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femalePunjab, \
NVL(SUM(DECODE(m.state_code,71,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherPunjab, \
NVL(SUM(DECODE(m.state_code,16,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleHaryana, \
NVL(SUM(DECODE(m.state_code,16,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleHaryana, \
NVL(SUM(DECODE(m.state_code,16,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherHaryana, \
NVL(SUM(DECODE(m.state_code,17,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleHp, \
NVL(SUM(DECODE(m.state_code,17,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleHp, \
NVL(SUM(DECODE(m.state_code,17,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherHp, \
NVL(SUM(DECODE(m.state_code,47,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleUp, \
NVL(SUM(DECODE(m.state_code,47,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleUp, \
NVL(SUM(DECODE(m.state_code,47,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherUp, \
NVL(SUM(DECODE(m.state_code,76,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleUttrakhand, \
NVL(SUM(DECODE(m.state_code,76,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleUttrakhand, \
NVL(SUM(DECODE(m.state_code,76,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherUttrakhand, \
NVL(SUM(DECODE(m.state_code,58,DECODE(m.puk_typ,10,1,11,1,0),0)),0) maleJk, \
NVL(SUM(DECODE(m.state_code,58,DECODE(m.puk_typ,20,1,21,1,0),0)),0) femaleJk, \
NVL(SUM(DECODE(m.state_code,58,DECODE(m.puk_typ,30,1,31,1,0),0)),0) otherJk, \
NVL(SUM(DECODE(m.state_code,11,0,71,0,16,0,17,0,47,0,76,0,58,0,DECODE(m.puk_typ,10,1,11,1,0))),0) maleOthers, \
NVL(SUM(DECODE(m.state_code,11,0,71,0,16,0,17,0,47,0,76,0,58,0,DECODE(m.puk_typ,20,1,21,1,0))),0) femaleOthers, \
NVL(SUM(DECODE(m.state_code,11,0,71,0,16,0,17,0,47,0,76,0,58,0,DECODE(m.puk_typ,30,1,31,1,0))),0) otherOthers \
FROM ( SELECT (@) epi_date, a.hrgnum_puk crno, a.hgnum_deptunitcode deptunitcode, \
(SELECT gnum_state_code FROM HRGT_PATIENT_ADD_DTL P WHERE P.gnum_isvalid = ? AND \
P.gnum_hospital_code = ? AND \
p.GNUM_ADD_TYPE_CODE=1 and \
P.hrgnum_puk = a.hrgnum_puk ) state_code,hrgnum_is_old, ahis_util.puk_type(a.hrgnum_puk,12) puk_typ  FROM HRGT_EPISODE_DTL a \
WHERE a.gnum_hospital_code = ? AND hrgnum_is_old in (?,?)  AND TRUNC(hrgdt_episode_date) >=TRUNC (TO_DATE (?, 'DD-Mon-yyyy')) AND TRUNC(hrgdt_episode_date) <=TRUNC (TO_DATE (?, 'DD-Mon-yyyy')) \
AND a.hgnum_deptunitcode LIKE ?  ) m GROUP BY m.epi_date ,m.deptunitcode ORDER BY unit,epiDate     
					     

SELECT_REPORTQUERY_AGE_WISE_REPORT_NOT_IN_USED= agerange, deptname,SUM (DECODE (gender, 1, 1, 0)) male,SUM (DECODE (gender, 2, 1, 0)) female   FROM \
						(SELECT CASE  \
							 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <=1   AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  13 )   THEN '0-13' \
						 	 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=14  AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  25 )   THEN '14-25' \
						 	 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=26  AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  35 )   THEN '26-35'  \
						 	 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=36  AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  45 )   THEN '36-45'   \
						 	 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=46  AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  55 )   THEN '46-55'    \
						 	 WHEN (    (hrgdt_episode_date - hrgdt_dob) / (30 * 12) >=56  AND (hrgdt_episode_date - hrgdt_dob) / (30 * 12) <  65 )   THEN '56-65'     \
						     ELSE '60+'    END agerange, \
					    (SELECT d.gstr_dept_name  FROM gblt_department_mst d  WHERE gnum_dept_code = e.gnum_dept_code   AND gnum_hospital_code = e.gnum_hospital_code    AND gdt_effective_frm <= TRUNC (e.gdt_entry_date) \
					     AND NVL (gdt_effective_to, e.gdt_entry_date + 1) >=TRUNC (e.gdt_entry_date))  deptname,gnum_gender_code gender, TRUNC (hrgdt_episode_date) episodeDate  FROM hrgt_episode_dtl e, hrgt_patient_dtl p  \
					     WHERE hrgnum_visit_type = 1   AND hrgnum_visit_no = 1  AND hrgnum_is_old = 0  and e.GNUM_ISVALID=?  and e.GNUM_ISVALID=p.GNUM_ISVALID AND e.gnum_hospital_code = p.gnum_hospital_code    AND p.gnum_hospital_code = ?  AND e.hgnum_deptunitcode LIKE ?  \
					     AND p.hrgdt_register_date >=TO_DATE (?, 'dd-Mon-yyyy')  AND p.hrgdt_register_date <= TRUNC (TO_DATE (?, 'dd-Mon-yyyy') + 1)  AND p.hrgnum_puk = e.hrgnum_puk) \
					     GROUP BY  @, agerange, deptname  ORDER BY @, agerange, deptname
					     
INSERT.AMOUNTCOLLECTION.HBLT_DIRECT_CHARGE_DTL=	insert into hblt_direct_charge_dtl (HRGNUM_PUK, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, \
												HBLSTR_SERVICE_ID, HBLSTR_TARIFF_ID, HGNUM_PATIENT_CAT_CODE, HGNUM_TREATMENT_CAT_CODE, HRGNUM_AMT_COLLECTED, HRGSTR_IP_ADD, GNUM_SEAT_ID, \
												GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_HOSPITAL_CODE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?)

					     
ESSENTIAL.RETRIEVE_UNITS.HOPT_DEPT_UNIT_ROSTER_DTL	=	SELECT   distinct  x.hopnum_deptunitcode,(SELECT a.gstr_dept_name FROM gblt_department_mst a WHERE a.gnum_dept_code = \
															         SUBSTR (x.hopnum_deptunitcode, 1, 3) AND SYSDATE BETWEEN a.gdt_effective_frm AND NVL (a.gdt_effective_to, SYSDATE) \
															         AND a.gnum_hospital_code = x.gnum_hospital_code AND a.gnum_isvalid = ?) || ' (' || (SELECT b.hgstr_unitname \
															         FROM hgbt_unit_mst b WHERE b.hgnum_deptunitcode = x.hopnum_deptunitcode AND SYSDATE BETWEEN b.gdt_effective_frm \
															         AND NVL (b.gdt_effective_to, SYSDATE) AND b.gnum_hospital_code = x.gnum_hospital_code AND b.gnum_isvalid = ?) \
															         || ')' AS unitname FROM hopt_dept_unit_roster_dtl x \
															   		 WHERE TRUNC (x.hopdt_start_dt) = TRUNC (SYSDATE) AND x.gnum_hospital_code = ? AND x.gnum_isvalid IN (?, ?) AND x.hgnum_roster_type IN (?,?) \
																	 ORDER BY unitname

ESSENTIAL.RETRIEVE_ALL_ACTIVE_UNITS.HOPT_DEPT_UNIT_ROSTER_DTL = SELECT   distinct  x.hopnum_deptunitcode,(SELECT a.gstr_dept_name FROM gblt_department_mst a WHERE a.gnum_dept_code = \
															         SUBSTR (x.hopnum_deptunitcode, 1, 3) AND SYSDATE BETWEEN a.gdt_effective_frm AND NVL (a.gdt_effective_to, SYSDATE) \
															         AND a.gnum_hospital_code = x.gnum_hospital_code AND a.gnum_isvalid = ?) || ' (' || (SELECT b.hgstr_unitname \
															         FROM hgbt_unit_mst b WHERE b.hgnum_deptunitcode = x.hopnum_deptunitcode AND SYSDATE BETWEEN b.gdt_effective_frm \
															         AND NVL (b.gdt_effective_to, SYSDATE) AND b.gnum_hospital_code = x.gnum_hospital_code AND b.gnum_isvalid = ?) \
															         || ')' AS unitname FROM hopt_dept_unit_roster_dtl x \
															   		 WHERE TRUNC (x.hopdt_start_dt) = TRUNC (SYSDATE) AND x.gnum_hospital_code = ? AND x.gnum_isvalid=? AND x.hgnum_roster_type IN (?,?) \
																	 ORDER BY unitname																	 
		
ESSENTIAL.HGBT_ROOM_MST.RETRIEVE_BY_DEPTUNITCODE	=	SELECT DISTINCT hgnum_room_code,(SELECT c.hgstr_room_name FROM hgbt_room_mst c WHERE c.hgnum_room_code = x.hgnum_room_code \
														AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = ?) AS roomname FROM hopt_dept_unit_roster_dtl x \
														WHERE TRUNC (x.hopdt_start_dt) = TRUNC (SYSDATE) AND x.gnum_hospital_code = ? AND x.gnum_isvalid IN (?, ?) AND x.hgnum_roster_type IN (?, ?) and HOPNUM_DEPTUNITCODE=? \
														ORDER BY roomname		
																
SELECT.ROOM_DETAIL.HOPT_DEPT_UNIT_ROSTER_DTL = SELECT to_char(HOPDT_START_DT,'hh24:mi') as startDate,to_char(HOPDT_START_DT,'dd-Mon-yyyy hh24:mi') as startDateTime, to_char(HOPDT_END_DT,'hh24:mi') as endDate,to_char(HOPDT_END_DT,'dd-Mon-yyyy hh24:mi') as endDateTime,DECODE (GNUM_ISVALID, 1, 'Active', 2, 'Deactive') as status,hgnum_room_code, \
								                (SELECT c.hgstr_room_name FROM hgbt_room_mst c WHERE c.hgnum_room_code = x.hgnum_room_code \
								                AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = ?) AS roomName \
								           		FROM hopt_dept_unit_roster_dtl x WHERE TRUNC (x.hopdt_start_dt) = TRUNC (SYSDATE) \
								            	AND x.gnum_hospital_code = ? AND x.gnum_isvalid IN (?, ?) \
								            	AND x.hgnum_roster_type IN (?, ?) and HOPNUM_DEPTUNITCODE=? \
												and HGNUM_ROOM_CODE=? \
								       			ORDER BY startDate
								       			
SELECT.TODAY_VISIT_PAT_LIST.HRGT_DAILY_PATIENT_DTL = SELECT   a.hrgnum_puk AS patCrNo, INITCAP (a.hrgstr_fname) ||' '|| INITCAP (a.hrgstr_mname) ||' '|| INITCAP (a.hrgstr_lname) AS patName, \
										         	DECODE (a.gnum_gender_code, 1, 'M', 2, 'F', 'O') || '/'|| ahis_util.puk_age (a.hrgnum_puk) patgenderage, TO_CHAR(a.hrgnum_que_no) AS queno, hgnum_patient_cat_code AS patprimarycatcode, \
										            (SELECT INITCAP (gstr_patient_cat_name) FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code \
             										AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
             										AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) as patPrimaryCat,a.hrgnum_is_confirmed isconfirmed,HRGNUM_VISIT_NO as episodeVisitNo, HRGNUM_EPISODE_CODE as episodeCode,HGNUM_CHNAGETO_ROOM_CODE as chnageToRoomCode \
										    		FROM hrgt_daily_patient_dtl a  \
													WHERE TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE) \
										     		AND a.hrgnum_is_confirmed =? \
										     		AND a.hgnum_deptunitcode = ? \
										     		AND a.hgnum_room_code = ? \
										     		AND a.gnum_hospital_code = ? \
										     		AND a.gnum_isvalid =? AND a.HGNUM_CHNAGETO_DEPTUNITCODE is null \
										     		UNION \
										     		SELECT   a.hrgnum_puk AS patCrNo, INITCAP (a.hrgstr_fname) ||' '|| INITCAP (a.hrgstr_mname) ||' '|| INITCAP (a.hrgstr_lname) AS patName, \
										         	DECODE (a.gnum_gender_code, 1, 'M', 2, 'F', 'O') || '/'|| ahis_util.puk_age (a.hrgnum_puk) patgenderage, a.HRGSTR_DISPLAY_QUENO AS queno, hgnum_patient_cat_code AS patprimarycatcode, \
										            (SELECT INITCAP (gstr_patient_cat_name) FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code \
             										AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
             										AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) as patPrimaryCat,a.hrgnum_is_confirmed isconfirmed,HRGNUM_VISIT_NO as episodeVisitNo, HRGNUM_EPISODE_CODE as episodeCode,HGNUM_CHNAGETO_ROOM_CODE as chnageToRoomCode \
										    		FROM hrgt_daily_patient_dtl a  \
													WHERE TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE) \
										     		AND a.hrgnum_is_confirmed =? \
										     		AND a.HGNUM_CHNAGETO_DEPTUNITCODE = ? \
										     		AND a.HGNUM_CHNAGETO_ROOM_CODE = ? \
										     		AND a.gnum_hospital_code = ? \
										     		AND a.gnum_isvalid =? \
													ORDER BY patName								       								     
					     								

ESSENTIAL.ACTIVE_ROOM_BY_DEPTUNITCODE.HGBT_ROOM_MST = 	SELECT DISTINCT hgnum_room_code,(SELECT c.hgstr_room_name FROM hgbt_room_mst c WHERE c.hgnum_room_code = x.hgnum_room_code \
														AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = ?) AS roomname FROM hopt_dept_unit_roster_dtl x \
														WHERE TRUNC (x.hopdt_start_dt) = TRUNC (SYSDATE) AND x.gnum_hospital_code = ? AND x.gnum_isvalid=? AND x.hgnum_roster_type IN (?, ?) and HOPNUM_DEPTUNITCODE=? \
														ORDER BY roomname	

INSERT.HOPT_DEPT_UNIT_ROSTERMOD_DTL = insert into HOPT_DEPT_UNIT_ROSTERMOD_DTL(HOPNUM_DEPTUNITCODE, HOPDT_START_DT, HOPDT_END_DT, GNUM_SEAT_ID, \
										HGNUM_ROOM_CODE, GNUM_ISVALID, GDT_ENTRY_DATE, HGSTR_REASON, GNUM_HOSPITAL_CODE) \
										values(?,to_date(?,'dd-Mon-yyyy hh24:mi'),to_date(?,'dd-Mon-yyyy hh24:mi'),?,?,?,sysdate,?,?)		
										
UPDATE.HRGT_DAILY_PATIENT_DTL.ROOM_CHANGE_DETAIL = update HRGT_DAILY_PATIENT_DTL set HRGNUM_CHANGE_TYPE=?, HRGSTR_DISPLAY_QUENO=?, \
													HGNUM_CHNAGETO_DEPTUNITCODE=?, HGNUM_CHNAGETO_ROOM_CODE=? \
													where HRGNUM_PUK=? and  HRGNUM_EPISODE_CODE=? and HRGNUM_VISIT_NO=?		
													
UPDATE.HOPT_DEPT_UNIT_ROSTER_DTL.CHANGE_ROOM = update HOPT_DEPT_UNIT_ROSTER_DTL set GNUM_ISVALID=?, HGSTR_REASON=? \
												where HOPNUM_DEPTUNITCODE=? and HOPDT_START_DT=to_date(?,'dd-Mon-yyyy hh24:mi')  \
												and HOPDT_END_DT=to_date(?,'dd-Mon-yyyy hh24:mi') and HGNUM_ROOM_CODE=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?																																																								

#Changed By Amit Garg as OPD G5 Changes
SELECT.PATIENT_IS_MLC_FOR_DEAD = SELECT hrgnum_puk,hrgnum_episode_code,hrgnum_visit_no,  NVL((SELECT hrgstr_mlc_no || '(' || TO_CHAR (hrgdt_mlc_date, 'DD-Mon-YYYY') || ')' FROM hrgt_patient_mlc_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code),'Yet not Alloted') FROM hrgt_episode_dtl a WHERE a.hrgnum_episode_type_code = ? AND a.gnum_isvalid = ? AND a.gnum_hospital_code = ?  \
									AND a.hrgnum_puk = ? and a.hrgnum_mlc_flag=1 AND a.hrgnum_visit_no IN ( SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl b WHERE hrgnum_episode_code = a.hrgnum_episode_code AND b.gnum_isvalid =a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code AND b.hrgnum_puk = a.hrgnum_puk)


SELECT.UNIT_DATE_ROOM_DETAIL.HOPT_DEPT_UNIT_ROSTER_DTL = SELECT to_char(HOPDT_START_DT,'hh24:mi') as startDate,to_char(HOPDT_START_DT,'dd-Mon-yyyy hh24:mi') as startDateTime, to_char(HOPDT_END_DT,'hh24:mi') as endDate,to_char(HOPDT_END_DT,'dd-Mon-yyyy hh24:mi') as endDateTime,hgnum_room_code as roomCode, \
								                (SELECT c.hgstr_room_name FROM hgbt_room_mst c WHERE c.hgnum_room_code = x.hgnum_room_code \
								                AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = ? ) AS roomName,GNUM_ISVALID as isValid \
								           		FROM hopt_dept_unit_roster_dtl x WHERE TRUNC(x.hopdt_start_dt) =TRUNC(TO_DATE(?,'dd-Mon-yyyy') )  \
								            	AND x.gnum_hospital_code = ? AND x.gnum_isvalid IN (?,?) \
								            	AND x.hgnum_roster_type IN (?, ?) and HOPNUM_DEPTUNITCODE=? \
												ORDER BY startDate										
												
SELECT.EXISTING_EPISODE_IN_DEPARTMENT.HRGT_ESPIDOE_DTL=	SELECT COUNT (*) FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND gnum_dept_code = ? AND gnum_hospital_code = ? AND HRGNUM_EPISODE_TYPE_CODE = ? and GNUM_ISVALID=?


UPDATE.ROOM_CAPACITY.HOPT_DEPT_UNIT_ROSTER_MST=UPDATE hopt_dept_unit_roster_mst   SET  HRGNUM_CAPACITY = ?  WHERE hgnum_deptunitcode =?   AND hgnum_room_code = ?  AND hrgnum_room_sequence = ?  AND hopnum_week_of_month = ?    AND hopnum_day_of_week = ?    AND hgnum_shift_code = ?    AND hgnum_unit_seq_no = ?   AND gnum_hospital_code = ?    AND gnum_isvalid = ?


UPDATE_ALL_ROOMS.ROOM_CAPACITY.HOPT_DEPT_UNIT_ROSTER_MST=UPDATE hopt_dept_unit_roster_mst   SET  HRGNUM_CAPACITY = ?  WHERE hgnum_deptunitcode =?   AND hgnum_room_code = ?    AND gnum_hospital_code = ?    AND gnum_isvalid = ?


SELECT.TODAY_PATIENT_FOR_FILE_NO_PRINTING.HRGT_DAILY_PATIENT_DTL1-sep-2010=	SELECT   a.hrgnum_puk AS patcrno, INITCAP(hrgstr_fname) patFirstName, INITCAP(hrgstr_mname) patMiddleName,INITCAP(hrgstr_lname) patLastName, \
 												  HRGSTR_FATHER_NAME patGuardianName, TO_CHAR \
												 (a.hrgdt_dob, 'DD-MON-YYYY') AS patdob,ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage,(SELECT INITCAP \
												 (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code \
												 AND gnum_isvalid = a.gnum_isvalid) patgender, gnum_gender_code, a.hrgnum_episode_code AS episodecode, \
												a.hrgnum_visit_no AS episodevisitno, a.hrgnum_episode_type_code AS episodetypecode, a.gnum_dept_code AS departmentcode, \
												a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold,TO_CHAR (HRGDT_EPISODE_DATE, \
												'dd-Mon-YYYY') AS episodedate, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed,\
												 a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, hgnum_treatment_cat_code AS patsecondarycatcode, \ hgnum_patient_cat_code \
												 AS patprimarycatcode,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND \
												 e.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) \
												 >= TRUNC (a.gdt_entry_date)) department,(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
												 AND g.gnum_hospital_code =  a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= \
												TRUNC (a.gdt_entry_date)) departmentunit,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND \
												i.gnum_hospital_code = a.gnum_hospital_code) room,HBNUM_FILE_PRINT fileNoPrint,HRGSTR_FILE_NO fileNo,HRGNUM_AMT_COLLECTED patAmountCollected, \
												(select unitdays(A.HGNUM_DEPTUNITCODE,a.gnum_hospital_code) from dual)unitWorkingDays, \
												(select GSTR_PATIENT_CAT_NAME from GBLT_PATIENT_CAT_MST  where GNUM_PATIENT_CAT_CODE=a.HGNUM_PATIENT_CAT_CODE \
 												and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code)patPrimaryCat,INITCAP (decode(a.hrgstr_district,null,(select STR_DIST_NAME from gblt_district_mst where \
												NUM_DIST_ID=b.num_dist_id),a.hrgstr_district)) AS patadddistrict,   b.num_dist_id AS patadddistrictcode, b.gnum_state_code AS pataddstatecode,b.hrgstr_state_name AS pataddstatename, \
												b.hrgnum_pincode AS pataddpin,b.gnum_country_code AS pataddcountrycode, a.gnum_isvalid AS isvalid,b.gnum_seat_id AS seatid, a.gdt_entry_date AS entrydate, \
											       b.hrgnum_is_local AS isaddressdelhi, a.hrgstr_house_no AS pataddhno,b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, \
											       b.gnum_city_loc_code AS pataddcityloccode,b.is_current_addresss AS iscurrentaddress,(DECODE (a.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) \
										               FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = a.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1), \
										                a.hrgstr_city_location)) pataddcityloc,(SELECT INITCAP (b.gstr_address_type) FROM gblt_address_type_mst b WHERE b.gnum_address_type_code = b.gnum_add_type_code \
										             	AND b.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddtype,(SELECT INITCAP (c.gstr_statename) FROM gblt_state_mst c  WHERE c.gnum_statecode = b.gnum_state_code \
										           	AND c.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddstate,(SELECT INITCAP (d.gstr_countryname) FROM gblt_country_mst d \
										         	WHERE d.gnum_countrycode = b.gnum_country_code  AND d.gnum_hospital_code = a.gnum_hospital_code \
										           	AND gnum_isvalid = 1) pataddcountry, b.HRGSTR_CITY patAddCity,HRGSTR_SPOUSENAME patHusbandName,(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 \
									             		AND gnum_hospital_code = a.gnum_hospital_code AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') \
									             		AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant, \
									              (SELECT HGSTR_FILEPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) fileprintsetting, \
									              (SELECT DECODE (hrgnum_ext_hospital_dept,NULL, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = \
												    r.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) and gnum_isvalid=r.gnum_isvalid),hrgnum_ext_hospital_dept) \
	        										FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no AND gnum_hospital_code = a.gnum_hospital_code \
	         										AND gnum_isvalid = a.gnum_isvalid) referFromDepartment \
									              FROM hrgt_daily_patient_dtl a, hrgt_patient_add_dtl b WHERE a.gnum_isvalid = ? AND a.gnum_hospital_code = ? \
												AND TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE)  and A.HGNUM_DEPTUNITCODE like ? and HRGNUM_IS_OLD=0  and A.HRGNUM_PUK=b.HRGNUM_PUK and a.gnum_isvalid=b.gnum_isvalid and HRGSTR_FILE_NO is not null \
												 ORDER BY a.gdt_entry_date desc

SELECT.TODAY_PATIENT_FOR_FILE_NO_PRINTING.HRGT_DAILY_PATIENT_DTL=	SELECT   a.hrgnum_puk AS patcrno, INITCAP(hrgstr_fname) patFirstName, INITCAP(hrgstr_mname) patMiddleName,INITCAP(hrgstr_lname) patLastName, \
 												  HRGSTR_FATHER_NAME patGuardianName, TO_CHAR \
												 (a.hrgdt_dob, 'DD-MON-YYYY') AS patdob,ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage,(SELECT INITCAP \
												 (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code \
												 AND gnum_isvalid = a.gnum_isvalid) patgender, gnum_gender_code, a.hrgnum_episode_code AS episodecode, \
												a.hrgnum_visit_no AS episodevisitno, a.hrgnum_episode_type_code AS episodetypecode, a.gnum_dept_code AS departmentcode, \
												a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold,TO_CHAR (a.HRGDT_EPISODE_DATE, \
												'dd-Mon-YYYY') AS episodedate, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed,\
												 a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_treatment_cat_code AS patsecondarycatcode,  a.hgnum_patient_cat_code \
												 AS patprimarycatcode,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND \
												 e.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) \
												 >= TRUNC (a.gdt_entry_date)) department,(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
												 AND g.gnum_hospital_code =  a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= \
												TRUNC (a.gdt_entry_date)) departmentunit,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND \
												i.gnum_hospital_code = a.gnum_hospital_code) room,HBNUM_FILE_PRINT fileNoPrint,a.HRGSTR_FILE_NO fileNo,HRGNUM_AMT_COLLECTED patAmountCollected, \
												(select unitdays(A.HGNUM_DEPTUNITCODE,a.gnum_hospital_code) from dual)unitWorkingDays, \
												(select GSTR_PATIENT_CAT_NAME from GBLT_PATIENT_CAT_MST  where GNUM_PATIENT_CAT_CODE=a.HGNUM_PATIENT_CAT_CODE \
 												and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code)patPrimaryCat,INITCAP (decode(a.hrgstr_district,null,(select STR_DIST_NAME from gblt_district_mst where \
												NUM_DIST_ID=b.num_dist_id),a.hrgstr_district)) AS patadddistrict,   b.num_dist_id AS patadddistrictcode, b.gnum_state_code AS pataddstatecode,b.hrgstr_state_name AS pataddstatename, \
												b.hrgnum_pincode AS pataddpin,b.gnum_country_code AS pataddcountrycode, a.gnum_isvalid AS isvalid,b.gnum_seat_id AS seatid, a.gdt_entry_date AS entrydate, \
											       b.hrgnum_is_local AS isaddressdelhi, a.hrgstr_house_no AS pataddhno,b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, \
											       b.gnum_city_loc_code AS pataddcityloccode,b.is_current_addresss AS iscurrentaddress,(DECODE (a.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) \
										               FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = a.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1), \
										                a.hrgstr_city_location)) pataddcityloc,(SELECT INITCAP (b.gstr_address_type) FROM gblt_address_type_mst b WHERE b.gnum_address_type_code = b.gnum_add_type_code \
										             	AND b.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddtype,(SELECT INITCAP (c.gstr_statename) FROM gblt_state_mst c  WHERE c.gnum_statecode = b.gnum_state_code \
										           	AND c.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddstate,(SELECT INITCAP (d.gstr_countryname) FROM gblt_country_mst d \
										         	WHERE d.gnum_countrycode = b.gnum_country_code  AND d.gnum_hospital_code = a.gnum_hospital_code \
										           	AND gnum_isvalid = 1) pataddcountry, b.HRGSTR_CITY patAddCity,HRGSTR_SPOUSENAME patHusbandName,(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 \
									             		AND gnum_hospital_code = a.gnum_hospital_code AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') \
									             		AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant, \
									              (SELECT HGSTR_FILEPRINT_SETTING FROM hgbt_unit_mst h WHERE h.hgnum_deptunitcode = a.hgnum_deptunitcode AND h.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid=1) fileprintsetting, \
									              decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code AND e.gnum_hospital_code = r.gnum_hospital_code \
									              AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = r.gnum_isvalid) FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk \
									              AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) ,2, \
									              (SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (0,2)\
									              AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment \
									              FROM hrgt_daily_patient_dtl a, hrgt_patient_add_dtl b,hrgt_episode_dtl c WHERE a.gnum_isvalid = ? AND a.gnum_hospital_code = ? \
												AND TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE)  and A.HGNUM_DEPTUNITCODE like ? and a.HRGNUM_IS_OLD=0  and A.HRGNUM_PUK=b.HRGNUM_PUK and a.gnum_isvalid=b.gnum_isvalid and a.HRGSTR_FILE_NO is not null \
												and a.hrgnum_puk = c.hrgnum_puk and a.HRGNUM_EPISODE_CODE=c.HRGNUM_EPISODE_CODE and a.HRGNUM_VISIT_NO=c.HRGNUM_VISIT_NO and a.gnum_hospital_code=c.gnum_hospital_code and a.gnum_isvalid = c.gnum_isvalid \
												ORDER BY a.gdt_entry_date desc


SELECT.TODAY_PATIENT_FOR_SLIP_PRINTING.HRGT_DAILY_PATIENT_DTL1-sep-2010=	SELECT   a.hrgnum_puk AS patcrno, INITCAP(hrgstr_fname) patFirstName, INITCAP(hrgstr_mname) patMiddleName,INITCAP(hrgstr_lname) patLastName, \
 												  HRGSTR_FATHER_NAME patGuardianName, TO_CHAR \
												 (a.hrgdt_dob, 'DD-MON-YYYY') AS patdob,ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage,(SELECT INITCAP \
												 (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code \
												 AND gnum_isvalid = a.gnum_isvalid) patgender, gnum_gender_code, a.hrgnum_episode_code AS episodecode, \
												a.hrgnum_visit_no AS episodevisitno, a.hrgnum_episode_type_code AS episodetypecode, a.gnum_dept_code AS departmentcode, \
												a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold,TO_CHAR (HRGDT_EPISODE_DATE, \
												'dd-Mon-YYYY') AS episodedate, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed,\
												 a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, hgnum_treatment_cat_code AS patsecondarycatcode, \ hgnum_patient_cat_code \
												 AS patprimarycatcode,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND \
												 e.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) \
												 >= TRUNC (a.gdt_entry_date)) department,(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
												 AND g.gnum_hospital_code =  a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= \
												TRUNC (a.gdt_entry_date)) departmentunit,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND \
												i.gnum_hospital_code = a.gnum_hospital_code) room,HBNUM_FILE_PRINT fileNoPrint,HRGSTR_FILE_NO fileNo,HRGNUM_AMT_COLLECTED patAmountCollected, \
												(select unitdays(A.HGNUM_DEPTUNITCODE,a.gnum_hospital_code) from dual)unitWorkingDays, \
												(select GSTR_PATIENT_CAT_NAME from GBLT_PATIENT_CAT_MST  where GNUM_PATIENT_CAT_CODE=a.HGNUM_PATIENT_CAT_CODE \
 												and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code)patPrimaryCat,INITCAP (decode(a.hrgstr_district,null,(select STR_DIST_NAME from gblt_district_mst where \
												NUM_DIST_ID=b.num_dist_id),a.hrgstr_district)) AS patadddistrict,   b.num_dist_id AS patadddistrictcode, b.gnum_state_code AS pataddstatecode,b.hrgstr_state_name AS pataddstatename, \
												b.hrgnum_pincode AS pataddpin,b.gnum_country_code AS pataddcountrycode, a.gnum_isvalid AS isvalid,b.gnum_seat_id AS seatid, a.gdt_entry_date AS entrydate, \
											       b.hrgnum_is_local AS isaddressdelhi, a.hrgstr_house_no AS pataddhno,b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, \
											       b.gnum_city_loc_code AS pataddcityloccode,b.is_current_addresss AS iscurrentaddress,(DECODE (a.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) \
										               FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = a.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1), \
										                a.hrgstr_city_location)) pataddcityloc,(SELECT INITCAP (b.gstr_address_type) FROM gblt_address_type_mst b WHERE b.gnum_address_type_code = b.gnum_add_type_code \
										             	AND b.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddtype,(SELECT INITCAP (c.gstr_statename) FROM gblt_state_mst c  WHERE c.gnum_statecode = b.gnum_state_code \
										           	AND c.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddstate,(SELECT INITCAP (d.gstr_countryname) FROM gblt_country_mst d \
										         	WHERE d.gnum_countrycode = b.gnum_country_code  AND d.gnum_hospital_code = a.gnum_hospital_code \
										           	AND gnum_isvalid = 1) pataddcountry, b.HRGSTR_CITY patAddCity,HRGSTR_SPOUSENAME patHusbandName,(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 \
									             		AND gnum_hospital_code = a.gnum_hospital_code       AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') \
									             		AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant FROM hrgt_daily_patient_dtl a, hrgt_patient_add_dtl b  WHERE a.gnum_isvalid = ? AND a.gnum_hospital_code = ? \
												AND TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE)  and A.HGNUM_DEPTUNITCODE like ? and HRGNUM_IS_OLD=0  and A.HRGNUM_PUK=b.HRGNUM_PUK and a.gnum_isvalid=b.gnum_isvalid ORDER BY a.gdt_entry_date desc

SELECT.TODAY_PATIENT_FOR_SLIP_PRINTING.HRGT_DAILY_PATIENT_DTL=	SELECT   a.hrgnum_puk AS patcrno, INITCAP(hrgstr_fname) patFirstName, INITCAP(hrgstr_mname) patMiddleName,INITCAP(hrgstr_lname) patLastName, \
 												  HRGSTR_FATHER_NAME patGuardianName, TO_CHAR \
												 (a.hrgdt_dob, 'DD-MON-YYYY') AS patdob,ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patage,(SELECT INITCAP \
												 (b.gstr_gender_name) FROM gblt_gender_mst b WHERE b.gnum_gender_code = a.gnum_gender_code AND b.gnum_hospital_code = a.gnum_hospital_code \
												 AND gnum_isvalid = a.gnum_isvalid) patgender, gnum_gender_code, a.hrgnum_episode_code AS episodecode, \
												a.hrgnum_visit_no AS episodevisitno, a.hrgnum_episode_type_code AS episodetypecode, a.gnum_dept_code AS departmentcode, \
												a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, a.hrgnum_is_old AS patisold,TO_CHAR (a.HRGDT_EPISODE_DATE, \
												'dd-Mon-YYYY') AS episodedate, TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed,\
												 a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_treatment_cat_code AS patsecondarycatcode,  a.hgnum_patient_cat_code \
												 AS patprimarycatcode,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND \
												 e.gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) \
												 >= TRUNC (a.gdt_entry_date)) department,(SELECT INITCAP (g.hgstr_unitname) FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode \
												 AND g.gnum_hospital_code =  a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= \
												TRUNC (a.gdt_entry_date)) departmentunit,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code AND \
												i.gnum_hospital_code = a.gnum_hospital_code) room,HBNUM_FILE_PRINT fileNoPrint,a.HRGSTR_FILE_NO fileNo,HRGNUM_AMT_COLLECTED patAmountCollected, \
												(select unitdays(A.HGNUM_DEPTUNITCODE,a.gnum_hospital_code) from dual)unitWorkingDays, \
												(select GSTR_PATIENT_CAT_NAME from GBLT_PATIENT_CAT_MST  where GNUM_PATIENT_CAT_CODE=a.HGNUM_PATIENT_CAT_CODE \
 												and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code)patPrimaryCat,INITCAP (decode(a.hrgstr_district,null,(select STR_DIST_NAME from gblt_district_mst where \
												NUM_DIST_ID=b.num_dist_id),a.hrgstr_district)) AS patadddistrict,   b.num_dist_id AS patadddistrictcode, b.gnum_state_code AS pataddstatecode,b.hrgstr_state_name AS pataddstatename, \
												b.hrgnum_pincode AS pataddpin,b.gnum_country_code AS pataddcountrycode, a.gnum_isvalid AS isvalid,b.gnum_seat_id AS seatid, a.gdt_entry_date AS entrydate, \
											       b.hrgnum_is_local AS isaddressdelhi, a.hrgstr_house_no AS pataddhno,b.hrgstr_street_no AS pataddstreet, b.hrgstr_contact_no AS pataddcontactno, \
											       b.gnum_city_loc_code AS pataddcityloccode,b.is_current_addresss AS iscurrentaddress,(DECODE (a.hrgnum_is_local, 1, (SELECT INITCAP (e.gstr_city_loc_name) \
										               FROM gblt_city_location_mst e WHERE e.gnum_city_loc_code = a.gnum_city_loc_code AND e.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1), \
										                a.hrgstr_city_location)) pataddcityloc,(SELECT INITCAP (b.gstr_address_type) FROM gblt_address_type_mst b WHERE b.gnum_address_type_code = b.gnum_add_type_code \
										             	AND b.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddtype,(SELECT INITCAP (c.gstr_statename) FROM gblt_state_mst c  WHERE c.gnum_statecode = b.gnum_state_code \
										           	AND c.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1) pataddstate,(SELECT INITCAP (d.gstr_countryname) FROM gblt_country_mst d \
										         	WHERE d.gnum_countrycode = b.gnum_country_code  AND d.gnum_hospital_code = a.gnum_hospital_code \
										           	AND gnum_isvalid = 1) pataddcountry, b.HRGSTR_CITY patAddCity,HRGSTR_SPOUSENAME patHusbandName,(SELECT hgstr_initial FROM hgbt_consultant_initial_mst WHERE gnum_isvalid = 1 \
									             		AND gnum_hospital_code = a.gnum_hospital_code       AND hopnum_day_of_week = TO_CHAR (a.gdt_entry_date, 'd') \
									             		AND hgnum_deptunitcode = a.hgnum_deptunitcode) AS unitconsultant, decode(HRGNUM_REFERRAL_ACCEPTANCE,1,(SELECT (select e.gstr_dept_name FROM gblt_department_mst e WHERE e.gnum_dept_code = r.hrgnum_from_dept_code \
									             		AND e.gnum_hospital_code = r.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = r.gnum_isvalid) \
									             		FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND HRGSTR_TO_EPISODE_CODE  = a.hrgnum_episode_code AND hrgnum_to_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (1,3) AND gnum_hospital_code = a.gnum_hospital_code \
									             		AND gnum_isvalid = a.gnum_isvalid) ,2, (SELECT hrgnum_ext_hospital_dept FROM hrgt_episode_ref_dtl r WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = 1  AND HRGSTR_IS_REFF_IN_OUT in (0,2) \
									             		AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) referfromdepartment FROM hrgt_daily_patient_dtl a, hrgt_patient_add_dtl b,hrgt_episode_dtl c  WHERE a.gnum_isvalid = ? AND a.gnum_hospital_code = ? \
												AND TRUNC (a.gdt_entry_date) = TRUNC (SYSDATE)  and A.HGNUM_DEPTUNITCODE like ? and a.HRGNUM_IS_OLD=0  and A.HRGNUM_PUK=b.HRGNUM_PUK and a.gnum_isvalid=b.gnum_isvalid and a.hrgnum_puk = c.hrgnum_puk \
												and a.HRGNUM_EPISODE_CODE=c.HRGNUM_EPISODE_CODE and a.HRGNUM_VISIT_NO=c.HRGNUM_VISIT_NO and a.gnum_hospital_code=c.gnum_hospital_code and a.gnum_isvalid = c.gnum_isvalid ORDER BY a.gdt_entry_date desc 


UPDATE.FILE_PRINT_FLAG.HRGT_DAILY_PATIENT_DTL=	update hrgt_daily_patient_dtl set HBNUM_FILE_PRINT=? where HRGNUM_PUK= ? and HRGNUM_EPISODE_CODE =? and HRGNUM_VISIT_NO=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?												

SELECT.ALL_SUMMARY.HRGT_EPISODE_SUMMARY_DTL.EMR	=	SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_EPISODE_CODE AS episodeCode, X.HRGNUM_VISIT_NO AS episodeVisitNo, X.HRGNUM_VISIT_SLNO AS episodeVisitSlNo, X.HRGSTR_EPISODE_ACTION_CODE AS episodeActionCode, X.HRGSTR_VISIT_NOTES AS visitNotes, TO_CHAR(X.HRGDT_NEXT_VISIT_DATE,'dd-Mon-yyyy') AS episodeNextVisitDate, \
												X.HRGSTR_NEXT_VISIT_DEPT_CODE AS episodeNextVisitDeptCode, X.HRGNUM_IS_EPISODE_OPEN AS episodeIsOpen, X.HRGSTR_VISIT_SUMMARY AS visitSummary, X.HRGNUM_NEXTVISIT_CRITERIA AS nextVisitCriteria, X. PSRSTR_EMP_NO AS empNo, X.HRGNUM_NEXTVISIT_DURATION AS nextVisitDuration, X.GNUM_SEAT_ID AS seatId, \
												TO_CHAR(X.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, X.GNUM_ISVALID AS isValid, X.HGNUM_NEXT_VISIT_DEPTUNITCODE AS episodeNextVisitDeptUnitCode, X.GNUM_HOSPITAL_CODE AS hospitalCode, X.HRGSTR_IP_ADD AS systemIPAddress, X.HGSTR_EPISODE_KEYWORD AS episodeKeywords FROM HRGT_EPISODE_SUMMARY_DTL X WHERE X.HRGNUM_PUK=? AND \
												GNUM_ISVALID=? 

SELECT.BY_CR_NO.HRGT_EPISODE_REF_DTL	=	SELECT HRGNUM_PUK PATCRNO, HRGNUM_EPISODE_CODE EPISODECODE, HRGNUM_VISIT_NO EPISODEVISITNO, HGNUM_TO_DEPTUNITCODE TODEPARTMENTUNITCODE, HGNUM_FROM_DEPTUNITCODE DEPARTMENTUNIT,decode(HRGSTR_IS_REFF_IN_OUT,0,'External Hosptial',(SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST \
         									WHERE GNUM_DEPT_CODE = A.HRGNUM_TO_DEPT_CODE AND GNUM_ISVALID = a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE)) TODEPARTMENT,(SELECT HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE = A.HGNUM_TO_DEPTUNITCODE \
		   									AND GNUM_ISVALID = a.GNUM_ISVALID  AND GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE) TODEPARTMENTUNIT,DECODE (hrgstr_is_reff_in_out,0, 'External Hosptial',(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.HRGNUM_FROM_DEPT_CODE \
                   							AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)) fromdepartment,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.HGNUM_FROM_DEPTUNITCODE AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = \
                   							a.gnum_hospital_code) fromdepartmentunit FROM HRGT_EPISODE_REF_DTL A WHERE HRGNUM_PUK = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?  and  HRGSTR_IS_REFF_IN_OUT not in (?,?) 
		   									
SELECT.EXISTING_EPISODE_IN_DEPARTMENT_UNIT.HRGT_ESPIDOE_DTL =	SELECT COUNT (*) FROM hrgt_episode_dtl WHERE hrgnum_puk = ? AND gnum_dept_code = ? AND gnum_hospital_code = ? AND HGNUM_DEPTUNITCODE=? and GNUM_ISVALID=?		   									

INSERT.HRGT_PAT_ADHAAR_DTL = INSERT INTO hrgt_pat_adhaar_dtl (hrgnum_puk, GNUM_ADHAAR_ID, gdt_entry_date, gnum_isvalid, gnum_seat_id, gnum_hospital_code,HRGSTR_FNAME,HRGSTR_MNAME,HRGSTR_LNAME) VALUES (?, ?, SYSDATE, ?, ?, ? ,?,?,?)

SELECT.HRGT_PAT_ADHAAR_DTL = select HRGNUM_PUK patCrNo,INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patFirstName from HRGT_PAT_ADHAAR_DTL where upper(GNUM_ADHAAR_ID) like upper(?) and GNUM_HOSPITAL_CODE = ? and GNUM_ISVALID=?

UPDATE.HRGT_PAT_ADHAAR_DTL= UPDATE hrgt_pat_adhaar_dtl a SET gnum_adhaar_id = ?,  a.gnum_isvalid = ? ,gnum_seat_id = ?, hrgstr_fname = ?, hrgstr_mname = ?, hrgstr_lname = ? WHERE hrgnum_puk = ? AND gnum_hospital_code = ?

SELECT.HRGT_PAT_ADHAAR_DTL.BYCRNO =  select HRGNUM_PUK patCrNo from HRGT_PAT_ADHAAR_DTL where HRGNUM_PUK = ? and GNUM_HOSPITAL_CODE = ? 

SELECT.HRGT_DAILY_PATIENT_DTL.RETRIEVE_FOR_POLICE_EXAM_REQT	= SELECT (SELECT hrgstr_mlc_no \
													            FROM hrgt_patient_mlc_dtl \
													           WHERE hrgnum_puk = a.hrgnum_puk \
													             AND hrgnum_episode_code = a.hrgnum_episode_code \
													             AND hrgnum_visit_no = a.hrgnum_visit_no \
													             AND gnum_isvalid = a.gnum_isvalid \
													             AND gnum_hospital_code = a.gnum_hospital_code) AS mlcno, \
													         a.hrgnum_puk AS patcrno, INITCAP (a.hrgstr_fname) AS patfirstname, \
													         INITCAP (a.hrgstr_mname) AS patmiddlename, \
													         INITCAP (a.hrgstr_lname) AS patlastname, \
													         a.gnum_marital_status_code AS patmaritalstatuscode, \
													         DECODE (a.gnum_gender_code, 1, 'M', 2, 'F', 'O')|| '/'||'20 Yrs' as patgenderage, \
													         INITCAP (a.hrgstr_father_name) AS patguardianname, \
													         INITCAP (a.hrgstr_momname) AS patmomname, \
													         a.hrgnum_episode_code AS episodecode, \
													         a.hrgnum_visit_no AS episodevisitno, \
													         a.hrgnum_s_no AS serialno, \
													         a.hrgnum_episode_type_code AS episodetypecode, \
													         a.hgnum_deptunitcode AS departmentunitcode, a.hrgnum_que_no AS queno, \
													         a.gnum_dept_code AS departmentcode, a.hrgnum_isreg_free AS isfree, \
													         a.hrgnum_is_old AS patisold, \
													         TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate, \
													            a.hgnum_patient_cat_code AS patprimarycatcode, \
													         (SELECT INITCAP (gstr_patient_cat_name) \
													            FROM gblt_patient_cat_mst \
													           WHERE gnum_patient_cat_code = a.hgnum_patient_cat_code \
													             AND gnum_hospital_code = 100 \
													             AND gdt_effective_frm <= TRUNC (SYSDATE) \
													             AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) patprimarycat, \
													         (SELECT INITCAP (gstr_patient_cat_name) \
													            FROM gblt_patient_cat_mst \
													           WHERE gnum_patient_cat_code = a.hgnum_treatment_cat_code \
													             AND gnum_hospital_code = 100 \
													             AND gdt_effective_frm <= TRUNC (SYSDATE) \
													             AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))  patsecondarycat, \
													         (SELECT INITCAP (e.gstr_dept_name) \
													            FROM gblt_department_mst e \
													           WHERE e.gnum_dept_code = a.gnum_dept_code \
													             AND a.gnum_hospital_code = e.gnum_hospital_code \
													             AND e.gdt_effective_frm <= TRUNC (SYSDATE) \
													             AND NVL (e.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department, \
													         (SELECT INITCAP (x.hgstr_unitname) \
													            FROM hgbt_unit_mst x \
													           WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode \
													             AND x.gnum_hospital_code = a.gnum_hospital_code \
													             AND x.gdt_effective_frm <= TRUNC (SYSDATE) \
													             AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentunit, \
													         a.hrgnum_is_mlc AS ismlc, a.hrgnum_is_broughtdead AS isbroughtdead, \
													         a.hrgnum_isunknown AS isunknown, \
													         hgnum_pat_status_code AS patstatuscode, \
													         a.hrgnum_is_confirmed AS isconfirmed, gdt_entry_date, \
													         (SELECT hgnum_isgeneral \
													            FROM hgbt_unit_mst x \
													           WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode \
													             AND x.gnum_hospital_code = a.gnum_hospital_code \
													             AND x.gdt_effective_frm <= TRUNC (SYSDATE) \
													             AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) departmentunittype \
													    FROM hrgt_daily_patient_dtl a \
													   WHERE TRUNC(a.gdt_entry_date) = TRUNC (SYSDATE) \
													     AND a.gnum_isvalid = ? \
													     AND a.gnum_hospital_code = ? \
													     AND a.hrgnum_puk = ? \
													ORDER BY gdt_entry_date
													
UPDATE.HRGT_PAT_ADHAAR_DTL.INACTIVE = UPDATE hrgt_pat_adhaar_dtl a SET gnum_isvalid = ?, gnum_seat_id = ?, hrgstr_fname = ?, hrgstr_mname = ?, hrgstr_lname = ? WHERE hrgnum_puk = ? AND a.gnum_isvalid = ? AND gnum_hospital_code = ?

SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO.FROMMCTS_OLD =  SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'DD-MON-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
											A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
											A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
											TO_CHAR(a.HRGDT_EXP_DATE,'dd-Mon-yyyy') as EXPIRYDATE, TO_CHAR(a.hrgdt_register_date,'dd-Mon-yyyy') AS REGISTERDATE, \
											to_char(a.gdt_entry_date,'dd-Mon-yyyy hh12:mi:ss AM') AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
											A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, \
											A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, \
											(SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_isvalid=1 and gnum_patient_cat_code = a.hgnum_patient_cat_code \
           									AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = a.gnum_hospital_code )	AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
											A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO,\
											A.HRGNUM_IS_REF AS ISREFERRED,A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, \
											A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, \
											A.HRGSTR_FATHER_NAME AS PATFATHERNAME, A.HRGSTR_MOMNAME AS PATMOTHERNAME, INITCAP(A.HRGSTR_SPOUSENAME) AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
											 A.HRGSTR_PAT_OCCUPATION as patOccupation,A.HRGSTR_FAT_OCCUPATION as patFatherOccupation,A.HRGSTR_HUS_OCCUPATION as patHusbandOccupation,A.HRGSTR_NICKNAME as patNickName,A.HRGSTR_CARD_NO as patCardNo, \
											(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATGENDER, \
											(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATMARITALSTATUS, \
											sysdate AS systemdate, \
											(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE AND E.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND 	E.GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(E.GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE) AND GNUM_ISVALID=1) PATREGCAT, \
											(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE gnum_isvalid=1 and I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND \
											GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE) AND I.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE ) PATPRIMARYCAT, \
											(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE AND M.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATRELIGION, \
											(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE AND T.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) PATNATIONALITY, \
											DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_exp_date::timestamp,'dd-mm-yyyy'), 'DD-MM-YYYY') - TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ),1, 0,-1, 1,0) AS regRenewalRequired, \
											(SELECT '(Invalid Category) '||INITCAP (gstr_patient_cat_name)  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code and rownum=1) PATOLDPRIMARYCAT,HRGNUM_IS_BROUGHTDEAD as isBroughtDead, \
											(SELECT GBSTR_CAT_POSTFIX FROM gblt_patient_cat_mst WHERE gnum_isvalid = 1 AND gnum_patient_cat_code = a.hgnum_patient_cat_code AND gnum_hospital_code = a.gnum_hospital_code) catPostFix , HANCSTR_MCTS_NO strMctsNo \
											FROM HRGT_PATIENT_DTL A WHERE (A.GNUM_ISVALID = ?)	AND (A.GNUM_HOSPITAL_CODE = ?) and (A.HRGNUM_PUK = ?)
											
											
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO.FROMMCTS =  SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'DD-MON-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, \
											A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE,  A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
											A.HRGSTR_IDMARK1 AS PATIDMARK1,A.HRGSTR_IDMARK2 AS PATIDMARK2, INITCAP (A.HRGSTR_FATHER_NAME) AS PATGUARDIANNAME, INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
											TO_CHAR(a.HRGDT_EXP_DATE,'dd-Mon-yyyy') as EXPIRYDATE, TO_CHAR(a.hrgdt_register_date,'dd-Mon-yyyy') AS REGISTERDATE, \
											to_char(a.gdt_entry_date,'dd-Mon-yyyy hh12:mi:ss AM') AS ENTRYDATE, A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, \
											A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISREG_FREE AS ISFREE, \
											A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, \
											(SELECT hgnum_patient_cat_code FROM gblt_patient_cat_mst WHERE gnum_isvalid=1 and gnum_patient_cat_code = a.hgnum_patient_cat_code \
           									AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_hospital_code = 100 )	AS PATPRIMARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
											A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGNUM_ID_NO AS PATIDNO,\
											A.HRGNUM_IS_REF AS ISREFERRED,A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, \
											A.GNUM_NATIONALITY_CODE AS PATNATIONALITYCODE, HRGNUM_IS_IMAGEUPLOADED AS ISIMAGEUPLOADED, \
											A.HRGSTR_FATHER_NAME AS PATFATHERNAME, A.HRGSTR_MOMNAME AS PATMOTHERNAME, INITCAP(A.HRGSTR_SPOUSENAME) AS PATHUSBANDNAME, A.HRGSTR_NATIONAL_ID AS PATNATIONALID, \
											 A.HRGSTR_PAT_OCCUPATION as patOccupation,A.HRGSTR_FAT_OCCUPATION as patFatherOccupation,A.HRGSTR_HUS_OCCUPATION as patHusbandOccupation,A.HRGSTR_NICKNAME as patNickName,A.HRGSTR_CARD_NO as patCardNo, \
											(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE=100 AND GNUM_ISVALID=1) PATGENDER, \
											(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE=100 AND GNUM_ISVALID=1) PATMARITALSTATUS, \
											sysdate AS systemdate, \
											(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.HRGNUM_REG_CAT_CODE AND E.GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND 	E.GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(E.GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE) AND GNUM_ISVALID=1) PATREGCAT, \
											(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE gnum_isvalid=1 and I.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE AND \
											GDT_EFFECTIVE_FRM<=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>=TRUNC(SYSDATE) AND I.GNUM_HOSPITAL_CODE=100 ) PATPRIMARYCAT, \
											(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE AND M.GNUM_HOSPITAL_CODE=100 AND GNUM_ISVALID=1) PATRELIGION, \
											(SELECT INITCAP (T.GSTR_NATIONALITY) FROM GBLT_COUNTRY_MST T WHERE T.GNUM_COUNTRYCODE = A.GNUM_NATIONALITY_CODE AND T.GNUM_HOSPITAL_CODE=100 AND GNUM_ISVALID=1) PATNATIONALITY, \
											DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_exp_date::timestamp,'dd-mm-yyyy'), 'DD-MM-YYYY') - TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ),1, 0,-1, 1,0) AS regRenewalRequired, \
											(SELECT '(Invalid Category) '||INITCAP (gstr_patient_cat_name)  FROM gblt_patient_cat_mst   WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code and rownum=1) PATOLDPRIMARYCAT,HRGNUM_IS_BROUGHTDEAD as isBroughtDead, \
											HANCSTR_MCTS_NO strMctsNo \
											FROM HRGT_PATIENT_DTL A WHERE (A.GNUM_ISVALID = ?)	AND (A.GNUM_HOSPITAL_CODE = ?) and (A.HRGNUM_PUK = ?)
											
											
SELECT_REPORTQUERY_PAT_VISIT_WISE_DTL = SELECT    (SELECT d.gstr_dept_name \
						             FROM gblt_department_mst d  \
						            WHERE gnum_dept_code = e.gnum_dept_code \
						              AND gnum_hospital_code = e.gnum_hospital_code \
						              AND gdt_effective_frm <= TRUNC (e.gdt_entry_date) \
						              AND NVL (gdt_effective_to, e.gdt_entry_date + 1) >= \
						                                                      TRUNC (e.gdt_entry_date))  \
						       || '-' \
						       || (SELECT u.hgstr_unitname \
						             FROM hgbt_unit_mst u \
						            WHERE u.gnum_isvalid = 1 \
						              AND u.gnum_hospital_code =e.gnum_hospital_code \
						              AND u.hgnum_deptunitcode = e.hgnum_deptunitcode \
						              AND u.gdt_effective_frm <= TRUNC (SYSDATE) \
						              AND NVL (u.gdt_effective_to, SYSDATE + 1) >= \
						                                                      TRUNC (e.gdt_entry_date)) \
						                                                                         departmentunit, \
						        TO_CHAR(HRGDT_EPISODE_DATE,'dd-Mon-yyyy') episodedate,HRGNUM_VISIT_NO episodeVisitNo \
							  FROM hrgt_episode_dtl e \
							 WHERE gnum_hospital_code = ? \
							   AND hrgnum_puk = ? 
							      																						
											
UPDATE.MCTS.HRGT_PATIENT_DTL=UPDATE hrgt_patient_dtl  SET hancstr_mcts_no = ? WHERE hrgnum_puk = ? and GNUM_HOSPITAL_CODE = ? and GNUM_ISVALID = ?

SELECT.OPEN.EPISODE.VISITED.LATEST.HRGT_EPISODE_DTL= SELECT hrgnum_puk AS patcrno, hrgnum_episode_code AS episodecode, hrgnum_visit_no AS episodevisitno, a.gnum_dept_code AS departmentcode, (SELECT gstr_dept_name  \
 											         FROM gblt_department_mst WHERE gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_dept_code = a.gnum_dept_code \
											        AND gnum_hospital_code = a.gnum_hospital_code) AS department, a.hgnum_deptunitcode AS departmentunitcode, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE gdt_effective_frm <= TRUNC (SYSDATE) \
										            AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code) AS departmentunit, hgnum_treatment_cat_code AS patsecondarycatcode, \
												     TO_CHAR ((SELECT hrgdt_valid_upto FROM hrgt_seccat_change_dtl b WHERE b.hrgnum_puk = a.hrgnum_puk AND b.hrgnum_episode_code = a.hrgnum_episode_code AND b.hrgnum_s_no = (SELECT MAX (hrgnum_s_no)\
						                            FROM hrgt_seccat_change_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code) AND gnum_hospital_code = a.gnum_hospital_code),  \
									                'dd-Mon-yyyy' ) AS validupto, hgnum_patient_cat_code AS patprimarycatcode, (SELECT hgnum_isgeneral FROM hgbt_unit_mst x \
											         WHERE x.hgnum_deptunitcode = a.hgnum_deptunitcode  AND x.gnum_hospital_code = a.gnum_hospital_code  AND x.gdt_effective_frm <= TRUNC (SYSDATE)  AND NVL (x.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))  departmentunittype, \
											       (SELECT MAX (hrgnum_visit_no)  FROM hrgt_episode_dtl b  WHERE a.hrgnum_puk = ?  AND a.gnum_hospital_code = ?  AND a.gnum_isvalid = ? \
											           AND b.hgnum_deptunitcode = a.hgnum_deptunitcode) strvisitno,  TO_CHAR (hrgdt_episode_date, 'dd-Mon-yyyy') episodeDate FROM hrgt_episode_dtl a \
					         							 WHERE hrgnum_is_episode_open = ?  AND hrgnum_visit_type <> 0  AND a.hrgnum_puk = ?  AND a.gnum_hospital_code = ?  AND a.gnum_isvalid = ?		 \
												AND a.hrgnum_visit_no = (SELECT max(e.hrgnum_visit_no) FROM hrgt_episode_dtl e WHERE e.hrgnum_is_episode_open = ? AND e.hrgnum_episode_code = a.hrgnum_episode_code \
   														AND e.hrgnum_puk = a.hrgnum_puk AND e.gnum_hospital_code = a.gnum_hospital_code AND e.gnum_isvalid = ?)

SELECT.PATCRNO.FROM_MCTS_MO.HRGT_PATIENT_DTL = SELECT HRGNUM_PUK  FROM hrgt_patient_dtl e WHERE gnum_hospital_code = ? AND HANCSTR_MCTS_NO like ? and GNUM_ISVALID =  ?

INSERT.HANCT_MCTS_REGISTRATION_DTL = INSERT INTO hanct_mcts_registration_dtl (hrgnum_puk, hancstr_mcts_no, hrgnum_episode_code, hancnum_sl_no, hancdt_registration_date, hrgnum_visit_no, hgnum_deptunitcode, HANCSTR_REMARK,  gdt_entry_date, gnum_isvalid,  \
								 	gnum_seat_id, gnum_hospital_code ) VALUES (?, ?, ?, (SELECT NVL (MAX (hancnum_sl_no), 0) + 1 FROM hanct_mcts_registration_dtl WHERE hrgnum_puk = ? ), date(?), ?, ?,  ?, SYSDATE, ?, ?, ? )
								 	
								 	
update.mcts.chkduplicate = SELECT COUNT (1)  FROM HANCT_MCTS_REGISTRATION_DTL  WHERE UPPER (TRIM (HANCSTR_MCTS_NO)) = UPPER (TRIM (?)) AND GNUM_HOSPITAL_CODE = ? AND gnum_isvalid != 0


#Added By Amit Garg as OPD G5 Changes
SELECT.KEYWORDID.hgbt_episode_keyword_mst= SELECT hgnum_episode_keyword_id as episodeKeywordID FROM hgbt_episode_keyword_mst where hgstr_episode_keyword in (?) and gnum_isvalid=?;

UPDATE.NEW.HRGT_EPISODE_SUMMARY_DTL=UPDATE HRGT_EPISODE_SUMMARY_DTL SET   HRGSTR_VISIT_NOTES=?, HRGDT_NEXT_VISIT_DATE=?::timestamp without time zone, HRGSTR_EPISODE_SUMMARY=?, HRGNUM_NEXTVISIT_CRITERIA=?, PSRSTR_EMP_NO=?,  HRGNUM_NEXTVISIT_DURATION=?, GNUM_SEAT_ID=?, \
									GDT_ENTRY_DATE=SYSDATE,hrgstr_visit_reason=?,hrgstr_visit_reason_ids=? WHERE  GNUM_HOSPITAL_CODE=? AND HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=?

									
UPDATE.NEXT_VISIT_DETAIL.HRGT_DAILY_PATIENT_DTL	=	UPDATE HRGT_DAILY_PATIENT_DTL SET HRGNUM_IS_EPISODE_OPEN=?, HRGNUM_IS_CONFIRMED=?, hrgstr_visit_reason=? , \
												 HRGSTR_VISIT_NOTES=?,HRGDT_NEXT_VISIT_DATE=?::timestamp without time zone,HRGNUM_NEXTVISIT_CRITERIA=?,PSRSTR_DOC_EMP_NO=?,HRGNUM_NEXTVISIT_DURATION=?, \
												 GNUM_DOC_SEAT_ID=?,HRGSTR_KEYWORDS=?,HRGSTR_KEYWORDS_IDS=? ,hrgstr_episode_summary=? WHERE	HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND GNUM_HOSPITAL_CODE=?	
												 
SELECT.DEFAULT_IMAGES_BY_CRNO.HRGT_PATIENT_IMAGE_DTL	=	SELECT hrgnum_puk patCrNo, hrgnum_s_no serialNo, hrgnum_episode_code episodeCode, hrgnum_is_default isImageDefault, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate, gst_file_name fileNo \
													FROM hrgt_patient_image_dtl where hrgnum_puk=? and gnum_isvalid=? and gnum_hospital_code=? and HRGNUM_IS_DEFAULT=1

#End Added By Amit Garg as OPD G5 Changes