SELECT_OFFLINE_COMBO_LIST = select gstr_combotype_name, gnum_combo_code, gstr_combo_name from gblt_offline_combolist_mst where gnum_hospital_code\=? and gnum_combotype_id \=?

GET_BAGS_READY_TO_ISSUE = SELECT A.HBSTR_BLDBAG_NO ,A.HBNUM_BLDBAG_SEQNO ,DECODE(b.hbnum_bldgrp_code, NULL, (b.HBSTR_BLD_ABO || '' || DECODE(b.HBNUM_RH, 1, ' + ', 2, ' - ', ' ')), ( SELECT HBSTR_BLDGRP FROM HBBT_BLDGRP_MST WHERE HBNUM_BLDGRP_CODE \= B.HBNUM_BLDGRP_CODE AND GNUM_HOSPITAL_CODE \= 100 AND GNUM_ISVALID \= 1 )) BLDGRP_NAME ,( SELECT HBSTR_COMPONENT_NAME FROM HBBT_BLD_COMPONENT_MST D WHERE HBNUM_BLD_COMPONENT_ID \= A.HBNUM_BLD_COMPONENT_ID AND GNUM_HOSPITAL_CODE \= b.gnum_hospital_code AND GNUM_ISVALID \= 1 ) COMPNAME ,A.HBNUM_BLD_COMPONENT_ID ,B.HBNUM_BLDGRP_CODE ,pkg_blood_bank.BldABO(B.HBNUM_BLDGRP_CODE, 100) ,a.HBNUM_BAG_VOLUME ,2 AS reserveStatus ,B.hbstr_tubing_no AS tubingNo ,(to_char(A.hbdt_bldbag_expiry, 'YYYY-MM-DD')) AS expiryDate FROM HBBT_BLDBAG_COMPONENT_DTL A ,HBBT_BLDBAG_DTL B WHERE A.HBSTR_BLDBAG_NO \= B.HBSTR_BLDBAG_NO AND A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE AND a.HBNUM_BAG_VOLUME > 0 AND b.HBNUM_INVESTIGATION_STATUS \= 1 AND A.HBNUM_BAG_STATUS \= 2 AND B.HBNUM_BAG_STATUS \= 2 AND B.HBDT_DONATION_DATE IS NOT NULL AND B.GNUM_HOSPITAL_CODE \= ? AND A.HBNUM_RESERVE_STATUS \= 0 AND A.GNUM_ISVALID \= 1 AND B.GNUM_ISVALID \= 1 AND trunc(hbdt_bldbag_expiry) >\= trunc(SYSDATE) UNION SELECT A.HBSTR_BLDBAG_NO ,A.HBNUM_BLDBAG_SEQNO ,DECODE(b.hbnum_bldgrp_code, NULL, (b.HBSTR_BLD_ABO || '' || DECODE(b.HBNUM_RH, 1, ' + ', 2, ' - ', ' ')), ( SELECT HBSTR_BLDGRP FROM HBBT_BLDGRP_MST WHERE HBNUM_BLDGRP_CODE \= B.HBNUM_BLDGRP_CODE AND GNUM_HOSPITAL_CODE \= 100 AND GNUM_ISVALID \= 1 )) BLDGRP_NAME ,( SELECT HBSTR_COMPONENT_NAME FROM HBBT_BLD_COMPONENT_MST D WHERE HBNUM_BLD_COMPONENT_ID \= A.HBNUM_BLD_COMPONENT_ID AND GNUM_HOSPITAL_CODE \= 100 AND GNUM_ISVALID \= 1 ) COMPNAME ,A.HBNUM_BLD_COMPONENT_ID ,B.HBNUM_BLDGRP_CODE ,pkg_blood_bank.BldABO(B.HBNUM_BLDGRP_CODE, 100) ,a.HBNUM_BAG_VOLUME ,1 AS reserveStatus ,B.hbstr_tubing_no AS tubingNo ,(to_char(A.hbdt_bldbag_expiry, 'YYYY-MM-DD')) AS expiryDate FROM HBBT_BLDBAG_COMPONENT_DTL A ,HBBT_BLDBAG_DTL B WHERE A.HBSTR_BLDBAG_NO \= B.HBSTR_BLDBAG_NO AND A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE AND a.HBNUM_BAG_VOLUME > 0 AND b.HBNUM_INVESTIGATION_STATUS \= 1 AND A.HBNUM_BAG_STATUS \= 2 AND A.HBNUM_RESERVE_STATUS IN ( 1 ,2 ) AND B.HBNUM_BAG_STATUS \= 2 AND B.HBDT_DONATION_DATE IS NOT NULL AND B.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_ISVALID \= 1 AND B.GNUM_ISVALID \= 1 AND trunc(hbdt_bldbag_expiry) >\= trunc(SYSDATE) ORDER BY reserveStatus

GET_USERS_HOSPITAL_CODE_WISE = select gstr_usr_name, gnum_userid from gblt_user_mst where gnum_hospital_code \= ?

ESSENTIAL.HBBT_EXT_BLDBANK_MST_COMPONENTREQ = select hbnum_bldbank_code,hbstr_bldbank_name from hbbt_ext_bldbank_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? and gnum_type \= 4 order by hbstr_bldbank_name

ESSENTIAL.HBBT_EXT_BLDBANK_MST_NEW = select hbnum_bldbank_code,hbstr_bldbank_name from hbbt_ext_bldbank_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? order by hbstr_bldbank_name


ERAKT_OFFLINE_LOGIN_DTL = select gblt_user_mst.gstr_password, gblt_user_mst.gnum_hospital_code, gblt_user_mst.gstr_usr_name, gblt_user_mst.gnum_userid,gblt_user_mst.gnum_user_seatid, gblt_user_mst.gnum_seat_id, gblt_hospital_mst.gnum_hospital_subheader, gblt_hospital_mst.gstr_bldlicense_code, gblt_hospital_mst.gstr_city, gblt_hospital_mst.gstr_hospital_name, gblt_hospital_mst.gstr_phone, gblt_hospital_mst.gstr_email, gblt_hospital_mst.gnum_state_code, gblt_hospital_mst.gnum_hospital_type, gblt_hospital_mst.gnum_hospital_catg, gblt_hospital_mst.gnum_pin_code , gblt_hospital_mst.num_dist_id from gblt_user_mst LEFT JOIN gblt_hospital_mst ON gblt_user_mst.gnum_hospital_code \= gblt_hospital_mst.gnum_hospital_code where gblt_user_mst.gstr_user_name \= ? and gblt_user_mst.gnum_isvalid\=1

INSERT_OFFLINE_BLD_REQ_DTL = insert into HBBT_BLDREQ_DTL ( HBNUM_REQ_NO,HBDT_REQRAISED_DATE,HBNUM_REQ_TYPE,HBNUM_PRIORITY,HBNUM_ISONLINE,HBNUM_PRIORITY_NO, HBNUM_BLDGRP_CODE,HBNUM_REQ_STATUS, HBSTR_BLD_ABO,HBNUM_RH,HBNUM_UNIT_FREE_ACT,HBNUM_UNIT_CRDIT_BALANCE, HBNUM_UNIT_REPL_ACT,HBNUM_REQRAISED_BY,HBNUM_UNIT_SANC_ACT, HBNUM_REQACCEPTED_BY,HBNUM_UNIT_VOL_ACT,HBDT_REQACCEPTED_DATE, GNUM_ISVALID,HBNUM_UNIT_CASH_ACT,GNUM_HOSPITAL_CODE,HBNUM_ISSAMPLE,HBNUM_SEND_SAMPLE,GSTR_IP_ADD, HBNUM_BILLING_CAT_CODE,HBNUM_REQCAT_CODE,HBNUM_UNIT_ATL_ACT,HBNUM_UNIT_DD_ACT,HBNUM_UNIT_RGD_ACT,HBNUM_FREE_CREDIT_BALANCE,HBNUM_REASON_CODE,HBNUM_ANTIBODY_STATUS, HBNUM_ANTIBODY_RESULT,HBNUM_UNIT_RGD_CREDIT_BALANCE,HBSTR_CONSENT_ID,HRGSTR_NATIONAL_ID,gnum_iscross_req) values(?,TO_DATE(?,'DD-Mon-YYYY HH\:MI\:SS AM'),?,?,?,(select Pkg_Blood_Bank.RequisiotionPriorityNo(?,?) from dual),?,?,?,?,?,?,?,?,?,?,?, TO_DATE(?,'DD-Mon-YYYY HH\:MI\:SS AM'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)


INSERT_OFFLINE_BLD_REQ_COMPONENT_DTL = INSERT INTO HBBT_BLDREQ_COMPONENT_DTL ( HBNUM_REQ_NO,HBNUM_BLD_COMPONENT_ID,HBNUM_BLDREQ_SLNO,HBNUM_REQ_STATUS,HBNUM_NOOF_UNIT_ACCEPTED,HBNUM_NOOF_UNIT_DEMANDED, HBNUM_NOOF_UNIT_ISSUED,HBNUM_NOOF_UNIT_CROSSMATCHED, HBNUM_ISVOLUME_SPECIFIC,HBNUM_VOLUME,HBDT_REQUIREMENT_DATE,HBSTR_REQUIREMENT_TIME, HBDT_REQRAISED_DATE,HBDT_REQACCEPTED_DATE,GNUM_ISVALID,GNUM_HOSPITAL_CODE,HBNUM_REQRAISED_SEATID,HBNUM_REQACCEPTED_SEATID,GSTR_IP_ADD,HBNUM_REQ_CRDIT_BALANCE, HBNUM_BLDGRP_CODE,HBNUM_ISIRRADIATED,HBSTR_REMARKS,HBSTR_BLD_ABO,HBNUM_RH,HBNUM_CROSS_CRDIT_BALANCE) VALUES (?,?,(select NVL(max(HBNUM_BLDREQ_SLNO),0)+1 from HBBT_BLDREQ_COMPONENT_DTL where GNUM_HOSPITAL_CODE\=? AND HBNUM_REQ_NO\=? AND GNUM_ISVALID\=? ) , ?,?,?,?,?,?,?,NVL(TO_DATE (?),(SYSDATE)),?,TO_DATE (?),TO_DATE (?),?,?,?,?,?,?,?,?,?,?,?,?)\t\t\t\t


INSERT_OFFLINE_BLD_REQ_PATIENT_DTL = INSERT INTO HBBT_BLDREQ_PATIENT_DTL ( HBNUM_REQ_NO,HBNUM_BLDGRP_CODE,HBSTR_INITIALBLD_ABO,HBNUM_INITIAL_RH,HBSTR_FNAME,HBSTR_MNAME,HBSTR_LNAME,GNUM_GENDER_CODE,HBDT_DOB,HBNUM_ISACTUAL_DOB, GNUM_MARITAL_STATUS_CODE,HBSTR_FATHER_NAME,HBSTR_SPOUSE_NAME,HBSTR_ADD1,HBSTR_ADD2,HBSTR_CONTACT_NO,HBSTR_DAIGNOSIS,HBSTR_CLINICAL_HISTORY,HBNUM_ISPREGNANT,HBSTR_OBSTETRIC_HISTORY, HBSTR_TRASNFUSSION_REASON, HBSTR_HB,HBNUM_PLATELET_COUNT,HBSTR_WEIGHT,HBNUM_ISPRETRANSFUSION,HBSTR_PRETRANSFUSION_REACTION,HBDT_PRETRANSFUSION_DATE,HBSTR_PRETRANSFUSION_HISTORY, GNUM_INSTITUTE_CODE,HBSTR_HOSPITAL_NAME, HBSTR_DEPARTMENT_NAME,HBSTR_PATIENT_REGNO,HBSTR_PATEINT_ADMNO,HBSTR_UNIT_NAME,HBSTR_WARD_NAME,HBSTR_BED_NO,HBSTR_DOCTOR_CONTACTNO, HBSTR_DOCTOR_NAME,HBSTR_HOSPITAL_CONTACTNO,GNUM_ISVALID,GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HBNUM_IS_IMAGEUPLOADED,GSTR_IP_ADD,HBNUM_INDICATION_ID, HBNUM_PREBLDGRP_CODE,HBSTR_PREBAG_NO,HBSTR_CARD_ID,HBNUM_HDNB_FLAG, HBNUM_STILLBIRTH_FLAG, HBNUM_MISCARRIAGE_FLAG,HBSTR_INDICATION_REMARKS,HBSTR_PTI,HBSTR_PT, HBSTR_APTT,HBSTR_SERUM,HBNUM_ISPRETRANSFUSION_INHOUSE, HBDT_REQUIREMENT_DATE,hbnum_ict,hbnum_dct,hbnum_auto) VALUES(?,?,?,?,?,?,?,?,?\:\:timestamp,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD-MON-YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(to_char(?,'dd-Mon-yyyy hh24\:mm\:ss')),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD-MON-YYYY'),2,2,2)\t\t


INSERT_OFFLINE_BLD_REQ_SAMPLE_DTL = insert into HBBT_BLDREQ_SAMPLE_DTL ( HBSTR_SAMPLE_ID,HBNUM_REQ_NO,HBNUM_SAMPLE_SEQNO,HBNUM_SAMPLE_STATUS,HBNUM_GROUPING_STATUS,HBNUM_REGROUP_REASON_CODE,HBNUM_CANCELREASON_CODE, GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,GDT_LSTMOD_DATE,GNUM_LSTMOD_SEATID,HBNUM_CELL_STATUS,HBNUM_SERUM_STATUS,HBSTR_ABO,HBNUM_RH,GNUM_HOSPITAL_CODE,HBNUM_ANTIBODY_STATUS, HBNUM_ISSELF_SAMPLE,hbnum_sample_type) values (?,?,(select nvl(max(HBNUM_SAMPLE_SEQNO),0)+1 from HBBT_BLDREQ_SAMPLE_DTL where HBNUM_REQ_NO\=? and hbnum_sample_type\=? and GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,TO_DATE(to_char(?,'dd-Mon-yyyy hh24\:mm\:ss')),(to_date(?,'dd-mon-yyyy')),?,?,?,?,?,?,?,?,?)\t\t\t


INSERT_OFFLINE_PATIENT_GRPING_DTL = INSERT INTO HBBT_PATIENT_GROUPING_DTL( HBNUM_REQ_NO,HBSTR_SAMPLE_ID,HBNUM_SLNO,HBSTR_INITITAL_ABO,HBNUM_INITIAL_RH,HBSTR_FINAL_ABO, HBNUM_FINAL_RH,HBSTR_REMARKS,GNUM_ISVALID,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES(?,?,(select NVL(MAX(HBNUM_SLNO),0)+1 from HBBT_PATIENT_GROUPING_DTL where HBNUM_REQ_NO\=? and HBSTR_SAMPLE_ID\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?), ?,?,?,?,?,?,?,?,?)
	

INSERT_OFFLINE_CROSSMATCH_DTL = INSERT INTO HBBT_CROSSMATCH_DTL(HBNUM_REQ_NO,HBNUM_CROSS_SEQNO,HBSTR_BLDBAG_NO,HBNUM_BLDBAG_SEQNO,HBNUM_BLD_COMPONENT_ID, HBSTR_SAMPLE_ID,HBNUM_CROSSMATCHED_FLAG, HBNUM_ISCOMPATIBLE,HBNUM_METHOD_ID,HBNUM_MAJOR_IGM,HBNUM_MAJOR_IGG,HBNUM_MINOR_IGM, HBNUM_MINOR_IGG,HBSTR_REMARK,GDT_ENTRY_DATE,GNUM_SEAT_ID,GNUM_ISVALID,GNUM_HOSPITAL_CODE, GNUM_VERIFIEDSEAT_ID, GDT_VERIFICATION_DATE,HBNUM_ISFREE,HBNUM_BLDREQ_SLNO,HBNUM_TECHNIQUE_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(to_char(?,'dd-Mon-yyyy hh24\:mm\:ss')), ?,?,?,?,?,?,?,?)                         


INSERT_OFFLINE_BLDBAG_ISSUE_DTL = INSERT INTO HBBT_BLDBAG_ISSUE_DTL (hbdt_issue_date,HBNUM_REQ_NO,HBNUM_ISSUE_SEQNO,HBSTR_BLDBAG_NO,HBNUM_BLDBAG_SEQNO, HBNUM_BLD_COMPONENT_ID,HBLNUM_BILL_NO,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HBSTR_ISSUE_TO,HBNUM_ISSUE_TYPE_ID,HBSTR_REMARK1, HBSTR_REMARK2,HBNUM_ISSUE_MODE) VALUES(to_date(to_char(?\:\:timestamp,'dd-mon-yyyy hh24\:mi')),?,(SELECT NVL(MAX(HBNUM_ISSUE_SEQNO),0)+1 FROM HBBT_BLDBAG_ISSUE_DTL WHERE HBNUM_REQ_NO\=? AND GNUM_ISVALID in (?,1) AND GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,to_date(to_char(?\:\:timestamp,'dd-mon-yyyy hh24\:mi')),?,?,?,?,?)


UPDATE_OFFLINE_BLDBAG_COMPONENT_DTL = UPDATE HBBT_BLDBAG_COMPONENT_DTL set HBNUM_BAG_STATUS\=?, hbdt_stockout_date\=?, hbnum_req_no\=?, hbstr_issue_patname\=?  , hbstr_hospital_name\=? where HBSTR_BLDBAG_NO\=? and HBNUM_BLD_COMPONENT_ID\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?

INSERT_OFFLINE_ISSUE_DTL_SERVER = \
INSERT INTO hbbt_offline_issue_dtl (hbnum_temp_requisition_no, gnum_hospital_code, hbnum_requisition_type, hbnum_billing_category, hbdt_issue_date , \
hbstr_patient_firstname, hbstr_patient_middlename, hbstr_patient_lastname, hbstr_patient_age, gnum_gender_code, hbstr_father_name, hbstr_spouse_name, \
gnum_mobile_no, gnum_is_crossmatch, gnum_other_hospital_name, gnum_other_hospital_code, gnum_state_code, gnum_district_code, gnum_bloodabo, gnum_rhfactor, \
gnum_priority, gnum_sample_code, gnum_sample_qty, hbstr_ward_name, hbstr_dept_name, hbstr_bed_no, hbstr_cr_number, hbstr_billing_no, hbstr_doctor_incharge, \
hbnum_fin_ab, hbnum_fin_rh, hbstr_remarks, hbstr_issue_to, hbnum_is_compatible, hbnum_bld_component_id, hbstr_bldbag_no, gnum_bag_volume, gnum_tubing_no, \
hbstr_bld_grp, gnum_seat_id, hbstr_expiry_date, gnum_userid, gstr_ipaddress, gnum_bld_grpcode, hbstr_server_entry_time, hbstr_entry_date, hbnum_issue_mode, \
gnum_isvalid, hbstr_local_sync_time,hbnum_bldbag_seqno,hbdt_dob,hbnum_cross_seq_no,hbnum_issue_seqno,hbbt_pat_bldgrp_name,hbbt_pat_bldgrp_code) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

GET_VALID_OFFLINE_ISSUE_RECORDS = select * from hbbt_offline_issue_dtl where gnum_isvalid \= 1 and hbnum_is_sync_finished \=0 and gnum_hospital_code \=? and hbnum_is_conflict \= 0 and hbnum_isthalassemia \= 0 order by hbnum_temp_requisition_no

INSERT_OFFLINE_DONATION_DTL_HBBT_OFFLINE_DONATION_DTL = INSERT INTO hbbt_offline_donation_details( hbnum_donor_no, hbnum_seqno, gnum_hospital_code, hbstr_firstname, hbstr_middlename, hbstr_lastname, hbstr_fathername, gnum_mobile_no, hbstr_email, hbstr_age, hbstr_dob, gnum_gender_code, hbstr_donor_id_type, hbstr_donor_id_no, hbstr_houseno, hbstr_street, hbstr_city, hbnum_pincode, gnum_state_code, gnum_district_code, hbdt_visit_date, hbnum_donor_type, hbnum_donation_type, hbnum_donor_status, hbstr_bag_no, hbnum_donation_status, hbnum_component_id, hbnum_bag_type, hbnum_bag_volume, hbnum_storage, hbnum_phlebotomy_arm, hbnum_hiv12, hbnum_hbsag, hbnum_hepatitisc, hbnum_syphillis, hbnum_malaria, hbstr_grp_details_abo, hbnum_grp_details_rh, hbnum_examination_rh_factor, hbstr_examination_blood_abo, hbnum_examination_weight, hbnum_examination_haemoglobin, hbnum_examination_diastolic_bp, hbnum_examination_systolic_bp, hbnum_examination_pulse, hbnum_examination_temperatue, gnum_isvalid, gnum_tubing_no, hbnum_is_separation, hbstr_unfit_status, hbstr_unfit_upto, hbstr_unfit_reason, hbstr_unfit_remarks, gnum_seat_id, gnum_userid, hbstr_local_sync_time, gstr_ipaddress, hbnum_donation_mode, hbstr_server_entry_time) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, to_char(SYSDATE, 'dd-Mon-yyyy hh24\:mm\:ss'));

INSERT_OFFLINE_BAG_DTL_HBBT_OFFLINE_BAG_DTL = INSERT INTO hbbt_offline_bag_dtl(gnum_hospital_code, hbnum_seqno, hbnum_donor_id, hbnum_bag_type, hbstr_bag_no, hbnum_bag_seqno, hbnum_component_id, hbnum_bag_volume, hbstr_tubing_no, hbdt_expiry_date, gnum_isvalid, hbnum_is_issued, gnum_seat_id, gnum_userid, hbstr_local_sync_time, gstr_ipaddress, hbstr_server_entry_time) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, to_char(SYSDATE, 'dd-Mon-yyyy hh24\:mm\:ss'));

UPDATE_DOWNLOAD_BAG_STATUS = update hbbt_bldbag_component_dtl set hbnum_offline_entry_mode \= 2, hbdt_offline_download_time \= sysdate where hbstr_bldbag_no \= ? and hbnum_bldbag_seqno \= ? and hbnum_bld_component_id \= ? and gnum_hospital_code \= ? and gnum_isvalid  \= 1

GET_BAG_STATUS_IN_APPLICATION = select hbnum_bag_status from hbbt_bldbag_component_dtl where hbstr_bldbag_no \= ? and hbnum_bldbag_seqno \= ? and hbnum_bld_component_id \= ? and gnum_hospital_code \= ? and gnum_isvalid \= 1

UPDATE_BAG_STATUS_WHEN_CONFLICT = UPDATE hbbt_offline_issue_dtl SET hbnum_is_conflict \= 1 where hbnum_temp_requisition_no \= ? and hbstr_bldbag_no \= ? and hbnum_bldbag_seqno \= ? and hbnum_bld_component_id \= ? and gnum_hospital_code \= ? and gnum_isvalid \= 1

UPDATE_BAG_STATUS.APPLICATION_CONFLICT = UPDATE HBBT_BLDBAG_COMPONENT_DTL SET hbnum_offline_entry_mode \= 3 , hbdt_offline_upload_time \= sysdate WHERE HBSTR_BLDBAG_NO \= ? AND HBNUM_BLD_COMPONENT_ID \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= 1;

SELECT_THALASSEMIA_REQ_LIST = SELECT ( SELECT TO_CHAR(hbdt_requirement_date, 'dd-Mon-yyyy') FROM hbbt_bldreq_component_dtl WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND hbnum_req_no \= a.hbnum_req_no AND HBNUM_REQ_STATUS \!\= 7 AND rownum \= 1 ) requirementDate ,nvl(( SELECT z.hbstr_transfusion_cardno FROM hbbt_thalassemia_reg_dtl z WHERE z.hbnum_thala_regno \= b.hbnum_thala_regno AND z.gnum_hospital_code \= b.gnum_hospital_code AND z.gnum_isvalid \= 1 ), '-') thalCardNo ,A.HBNUM_REQ_NO AS requisitionNo ,TO_CHAR(A.HBDT_REQRAISED_DATE, 'dd-Mon-yyyy') AS requisitionRaisedDate ,INITCAP(B.HBSTR_FNAME) || ' ' || INITCAP(B.HBSTR_MNAME) || ' ' || INITCAP(B.HBSTR_LNAME) AS patientName ,( SELECT GSTR_GENDER_CODE FROM GBLT_GENDER_MST D WHERE D.GSTR_GENDER_CODE \= B.GNUM_GENDER_CODE AND D.GNUM_ISVALID \= B.GNUM_ISVALID ) || ' / ' || ( SELECT ahis_util.dob_age_on(TO_DATE(B.HBDT_DOB, 'DD-MON-YYYY'), sysdate) FROM dual ) AS ageSex ,b.HBSTR_PATIENT_REGNO AS patCrNo ,A.HBNUM_PRIORITY AS priority ,A.HBNUM_REQ_STATUS AS requisitionStatus ,A.HBNUM_ISSAMPLE AS isSample ,A.HBNUM_BILLING_CAT_CODE AS billingCategoryCode ,NVL(( ( SELECT t.HBNUM_REQ_CRDIT_BALANCE FROM HBBT_BLDREQ_COMPONENT_DTL t WHERE t.HBNUM_REQ_NO \= a.hbnum_req_no AND t.GNUM_HOSPITAL_CODE \= a.gnum_hospital_code AND GNUM_ISVALID \= 1 AND hbnum_req_status \!\= 7 ) - (a.hbnum_unit_sanc_act) ), 0) AS unitCreditBalance ,NVL(( SELECT SUM(hbnum_unit_rgd_act) FROM hbbt_hod_sanction_dtl WHERE hbnum_req_no \= a.hbnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code AND a.gnum_isvalid \= 1 ), 0) AS rgdaccount ,a.hbnum_reqcat_code AS requisitionCategoryCode FROM HBBT_BLDREQ_DTL A ,HBBT_BLDREQ_PATIENT_DTL B WHERE A.HBNUM_REQ_STATUS IN ( 2 ,3 ) AND B.HBNUM_REQ_NO \= A.HBNUM_REQ_NO AND A.GNUM_ISVALID \= 1 AND gnum_iscross_req IN ( 0 ,1 ) AND B.GNUM_ISVALID \= A.GNUM_ISVALID AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE \= ? AND a.hbnum_reqcat_code IN ( 12 ,19 ) AND ( SELECT decode(count(hbnum_bld_component_id), 0, NULL, 1) FROM hbbt_bldreq_component_dtl WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND hbnum_req_no \= a.hbnum_req_no AND TO_DATE(hbdt_requirement_date) >\= TO_DATE(SYSDATE) AND HBNUM_REQ_STATUS \!\= 7 ) IS NOT NULL ORDER BY A.HBNUM_REQ_NO

SELECT_ALL_THALASEMIA_REG_DIRECTORY = select * from hbbt_thalassemia_reg_dtl where gnum_hospital_code \= ? and gnum_isvalid \= 1


INSERT_OFFLINE_THALA_ISSUE_DTL_SERVER = \
INSERT INTO hbbt_offline_issue_dtl (hbnum_temp_requisition_no, gnum_hospital_code, hbnum_requisition_type, hbnum_billing_category, hbdt_issue_date , \
hbstr_patient_firstname, hbstr_patient_middlename, hbstr_patient_lastname, hbstr_patient_age, gnum_gender_code, hbstr_father_name, hbstr_spouse_name, \
gnum_mobile_no, gnum_is_crossmatch, gnum_other_hospital_name, gnum_other_hospital_code, gnum_state_code, gnum_district_code, gnum_bloodabo, gnum_rhfactor, \
gnum_priority, gnum_sample_code, gnum_sample_qty, hbstr_ward_name, hbstr_dept_name, hbstr_bed_no, hbstr_cr_number, hbstr_billing_no, hbstr_doctor_incharge, \
hbnum_fin_ab, hbnum_fin_rh, hbstr_remarks, hbstr_issue_to, hbnum_is_compatible, hbnum_bld_component_id, hbstr_bldbag_no, gnum_bag_volume, gnum_tubing_no, \
hbstr_bld_grp, gnum_seat_id, hbstr_expiry_date, gnum_userid, gstr_ipaddress, gnum_bld_grpcode, hbstr_server_entry_time, hbstr_entry_date, hbnum_issue_mode, \
gnum_isvalid, hbstr_local_sync_time,hbnum_bldbag_seqno,hbdt_dob,hbnum_cross_seq_no,hbnum_issue_seqno,hbbt_pat_bldgrp_name,hbbt_pat_bldgrp_code,hbnum_isThalassemia,hbdt_nxtRequirement_date) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)


GET_VALID_OFFLINE_THALA_ISSUE_RECORDS = select * from hbbt_offline_issue_dtl where gnum_isvalid \= 1 and hbnum_is_sync_finished \=0 and gnum_hospital_code \=? and hbnum_is_conflict \= 0 and hbnum_isthalassemia \= 1 order by hbnum_temp_requisition_no

SELECT_ALL_BIOMETRIC_DATA=select * from hbbt_biometric_donor_details  where hospital_code \= ? 

INSERT_OFFLINE_BIOMETRIC_DATA=INSERT INTO hbbt_biometric_donor_details (biomericid,donorid,donorname,donormobileno,fingerposition,fingerdata,entry_date,hospital_code,donor_image,middlename,lastname,age,mobileno,gender,state,district,houseadd) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)


SELECT_MOBILENO_CRNOBASED_HIVT_REQUISITION_HEADER=select  hrgstr_mobile_no as patCRNO  from hivt_requisition_header  where hrgnum_puk=? and gnum_isvalid=1 order by hivdt_entry_date desc limit 1


#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  hivnum_req_no as patrequisitioNo from hivt_requisition_header  where hrgnum_puk=? and gnum_isvalid=1 and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc ;
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  distinct(a.hivnum_req_no) as patrequisitioNo,(select string_agg(distinct(select distinct(gstr_lab_name) from hivt_laboratory_mst x where x.gnum_lab_code=gnum_lab_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as labs,(select String_agg((select gstr_test_name from hivt_test_mst y where y.gnum_test_code=b.gnum_test_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk=? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc ;
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  distinct(a.hivnum_req_no) as patrequisitioNo,(select String_agg(distinct(select distinct(gstr_lab_name) from hivt_laboratory_mst y where y.gnum_lab_code=gnum_lab_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as labs,(select String_agg((select gstr_test_name from hivt_test_mst y where y.gnum_test_code=b.gnum_test_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk=? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc 
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  distinct(a.hivnum_req_no) as patrequisitioNo,(select distinct(gstr_lab_name) from hivt_laboratory_mst y, hivt_requisition_dtl b where y.gnum_lab_code=b.gnum_lab_code and y.gnum_hospital_code=b.gnum_hospital_code) as labs,(select String_agg((select gstr_test_name from hivt_test_mst y where y.gnum_test_code=b.gnum_test_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk=961011800000181 and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  distinct(a.hivnum_req_no) as patrequisitioNo,(select String_agg(distinct(gstr_lab_name),',') from hivt_laboratory_mst y, hivt_requisition_dtl b where y.gnum_lab_code=b.gnum_lab_code and y.gnum_hospital_code=b.gnum_hospital_code and b.hivnum_req_no=q.hivnum_req_no) as labs,(select String_agg((select gstr_test_name from hivt_test_mst y where y.gnum_test_code=b.gnum_test_code),',') from hivt_requisition_dtl b where b.hivnum_req_no=a.hivnum_req_no) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk=? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  (a.hivnum_req_no) as patrequisitioNo,q.hgnum_group_code as groupcode,(select String_agg(distinct(gstr_lab_name),',') from hivt_laboratory_mst y, hivt_requisition_dtl b where y.gnum_lab_code=b.gnum_lab_code and y.gnum_hospital_code=b.gnum_hospital_code and b.hivnum_req_no=q.hivnum_req_no) as labs,q.gnum_test_code as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk= ? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc,q.hivnum_req_no 
#SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  (a.hivnum_req_no) as patrequisitioNo,(select hgstr_group_name from hivt_test_group_mst s where s.gnum_isvalid=1 and s.hgnum_group_code=q.hgnum_group_code and s.gnum_hospital_code=q.gnum_hospital_code) as groupcode,(select String_agg(distinct(gstr_lab_name),',') from hivt_laboratory_mst y, hivt_requisition_dtl b where y.gnum_lab_code=b.gnum_lab_code and y.gnum_hospital_code=b.gnum_hospital_code and b.hivnum_req_no=q.hivnum_req_no) as labs,(select gstr_test_name from hivt_test_mst z where z.gnum_isvalid=1 and z.gnum_test_code=q.gnum_test_code) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk= ? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy') > TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy') order by hivdt_entry_date desc,q.hivnum_req_no 

SELECT_REQUISITIONNO_HIVT_REQUISITION_HEADER=select  hivdt_entry_date ,(a.hivnum_req_no) as patrequisitioNo,(select hgstr_group_name from hivt_test_group_mst s where s.gnum_isvalid=1 and s.hgnum_group_code=q.hgnum_group_code and s.gnum_hospital_code=q.gnum_hospital_code) as groupcode,(select String_agg(distinct(gstr_lab_name),',') from hivt_laboratory_mst y, hivt_requisition_dtl b where y.gnum_lab_code=b.gnum_lab_code and y.gnum_hospital_code=b.gnum_hospital_code and b.hivnum_req_no=q.hivnum_req_no) as labs,(select gstr_test_name from hivt_test_mst z where z.gnum_isvalid=1 and z.gnum_test_code=q.gnum_test_code) as tests,a.hrgnum_puk as crno,a.hrgstr_patname as patname,a.hivstr_age as age,a.gstr_gender_code as gender,DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from hivt_requisition_header a , hivt_requisition_dtl q where a.hrgnum_puk= ? and a.hivnum_req_no=q.hivnum_req_no and q.hivnum_reqdtl_status in (26,14) and TO_DATE(TO_CHAR(hivdt_entry_date, 'dd-Mon-yyyy'), 'dd-Mon-yyyy') > TO_DATE(TO_CHAR(current_timestamp - interval '30 day', 'dd-Mon-yyyy'), 'dd-Mon-yyyy')  order by hivdt_entry_date desc,q.hivnum_req_no




SELECT_REPORT_HIVT_REQUISITION_DTL=select distinct(hivstr_report_url) as reportUrl,hivnum_isconfidential  as isConfidential from hivt_requisition_dtl where hivnum_req_no=? and  hivstr_report_url is not null;

SELECT_AUTH_DATA=select key,iswhitelistreq,whitelistip,source,isseckeyreq,seckey from aiims_patna_service_autherization where isvalid=1 and source=?

INSERT_LOG_DETAIL_=INSERT INTO aiims_patna_service_log (ipadress,requrl,source,key,type) VALUES(?,?,?,?,?)


SELECT.HIVT_REPORT_DB_MST_SERVICE=select ftp_url from hivt_report_db_mst where  gnum_isvalid=1 and gnum_parameter_id=1 