#SELECT_INV_RESULTVAL_TESTPARAM_ONREQDNO_HIVT_REQUISITION_DTL = select (select String_agg(k.gnum_parameter_code||'#'|| (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.gnum_parameter_code)||'#'|| decode (gstr_element_type,'D' , (select hgstr_value from hivt_test_param_combo_mst where gnum_parameter_code =k.gnum_parameter_code and gnum_test_code = a.gnum_test_code and gnum_is_valid = 1 and hgnum_seq_id=(select nvl(s.hivtstr_value,'') from hivt_parameter_dtl s where s.gnum_isvalid=1 and s.hivtnum_test_code=k.gnum_test_code and s.gnum_hospital_code=a.gnum_hospital_code and s.hivnum_parameter_code=k.gnum_parameter_code and s.hivtnum_req_dno=a.hivtnum_req_dno) ) ,(select nvl(s.hivtstr_value,'') from hivt_parameter_dtl s where s.gnum_isvalid=1 and s.hivtnum_test_code=k.gnum_test_code and s.gnum_hospital_code=a.gnum_hospital_code and s.hivnum_parameter_code=k.gnum_parameter_code and s.hivtnum_req_dno=a.hivtnum_req_dno ))||'#'||(select nvl(s.hivstr_referencerange,'') from hivt_parameter_dtl s where s.gnum_isvalid=1 and s.hivtnum_test_code=k.gnum_test_code and s.gnum_hospital_code=a.gnum_hospital_code and s.hivnum_parameter_code=k.gnum_parameter_code and s.hivtnum_req_dno=a.hivtnum_req_dno )||'#'||(select nvl(s.hivt_isinrefrange,'0') from hivt_parameter_dtl s where s.gnum_isvalid=1 and s.hivtnum_test_code=k.gnum_test_code and s.gnum_hospital_code=a.gnum_hospital_code and s.hivnum_parameter_code=k.gnum_parameter_code and s.hivtnum_req_dno=a.hivtnum_req_dno )||'#'|| decode((select gnum_machine_code from hivt_requisition_dtl_new where hgnum_group_type=1 and hivtnum_req_dno=a.hivtnum_req_dno and gnum_hospital_code=a.gnum_hospital_code),null,'0','0','0','-1','0','1') ||'#'|| a.hivnum_req_no||'#'||a.gnum_test_code ||'#'|| a.hivtnum_req_dno,',' order by  k.hivt_num_element_sequence ) from hivt_test_parameter_mst k where k.gnum_test_code=a.gnum_test_code and k.gnum_isvalid=1 limit 1)  from hivt_requisition_dtl_new a WHERE a.hivnum_req_no = ? AND hivtnum_req_dno = ? AND gnum_hospital_code = ? 

#from hivt_requisition_dtl
#SELECT_INV_RESULTVAL_TESTPARAM_ONREQDNO_HIVT_REQUISITION_DTL = SELECT concatstring('Select k.hivnum_parameter_code||''#''|| (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#''|| decode ( (select  gstr_element_type from hivt_test_parameter_mst where gnum_parameter_code = k.hivnum_parameter_code and gnum_test_code=''' || a.gnum_test_code || ''' ), ''D'' , (select hgstr_value from hivt_test_param_combo_mst where gnum_parameter_code =k.hivnum_parameter_code and gnum_test_code = ''' || a.gnum_test_code || ''' and gnum_is_valid = 1 and hgnum_seq_id=k.hivtstr_value ) ,k.hivtstr_value) ||''#''||nvl(hivstr_referencerange,'''')||''#''||nvl(hivt_isinrefrange,''0'') ||''#''|| decode((select gnum_machine_code from hivt_requisition_dtl where hgnum_group_type=1 and hivtnum_req_dno=k.hivtnum_req_dno and gnum_hospital_code=''' || a.gnum_hospital_code || '''),null,0,0,0,-1,0,1) ||''#''||''' || a.hivnum_req_no || '''||''#''||''' || a.gnum_test_code || '''||''#''||''' || a.hivtnum_req_dno || ''' from hivt_parameter_dtl k where k.gnum_isvalid=1 and k.hivtnum_test_code = ''' || a.gnum_test_code || ''' and k.hivtnum_req_dno=''' || a.hivtnum_req_dno || ''' and k.gnum_hospital_code=''' || a.gnum_hospital_code || '''', '&comma;') AS testParameterDetails FROM hivt_requisition_dtl a WHERE a.hivnum_req_no = ? AND hivtnum_req_dno = ? AND gnum_hospital_code = ?

#from hivt_requisition_dtl_new
SELECT_INV_RESULTVAL_TESTPARAM_ONREQDNO_HIVT_REQUISITION_DTL = SELECT concatstring('Select k.hivnum_parameter_code||''#''|| (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#''|| decode ( (select  gstr_element_type from hivt_test_parameter_mst where gnum_parameter_code = k.hivnum_parameter_code and gnum_test_code=''' || a.gnum_test_code || ''' ), ''D'' , (select hgstr_value from hivt_test_param_combo_mst where gnum_parameter_code =k.hivnum_parameter_code and gnum_test_code = ''' || a.gnum_test_code || ''' and gnum_is_valid = 1 and hgnum_seq_id=k.hivtstr_value ) ,k.hivtstr_value) ||''#''||nvl(hivstr_referencerange,'''')||''#''||nvl(hivt_isinrefrange,''0'') ||''#''|| decode((select gnum_machine_code from hivt_requisition_dtl_new where hgnum_group_type=1 and hivtnum_req_dno=k.hivtnum_req_dno and gnum_hospital_code=''' || a.gnum_hospital_code || '''),null,0,0,0,-1,0,1) ||''#''||''' || a.hivnum_req_no || '''||''#''||''' || a.gnum_test_code || '''||''#''||''' || a.hivtnum_req_dno || ''' from hivt_parameter_dtl k where k.gnum_isvalid=1 and k.hivtnum_test_code = ''' || a.gnum_test_code || ''' and k.hivtnum_req_dno=''' || a.hivtnum_req_dno || ''' and k.gnum_hospital_code=''' || a.gnum_hospital_code || '''', '&comma;') AS testParameterDetails FROM hivt_requisition_dtl_new a WHERE a.hivnum_req_no = ? AND hivtnum_req_dno = ? AND gnum_hospital_code = ?

SELECT.RESULT_VALIDATION_HIVT_REQUISITION_HEADER = SELECT ( SELECT CONCAT ( GSTR_TEST_NAME ,decode(hivstr_site, '1', '(NA)', '2', '(Both)', '3', '(Left)', '4', '(Right)') ) FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = a.gnum_test_code ) AS testName, (SELECT gstr_user_name FROM gblt_user_mst WHERE gnum_userid = a.hivnum_result_seatid AND gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code )as resultEnteredBy, ( SELECT hmistr_machine_name FROM hmit_machine_mst ss WHERE hminum_machine_id = gnum_machine_code AND ss.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1 ) AS machineCode ,decode(( SELECT nvl(gnum_ispidshow, 0) FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ), 0, NULL, 1, ( SELECT nvl(hivstr_pid_no, '') FROM hivt_ictc_dtl WHERE hivnum_isvalid = 1 AND hivnum_req_no = a.hivnum_req_no )) AS pidno ,( SELECT nvl(gnum_ispidshow, 0) FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ) AS ispidshow ,decode(( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = a.gnum_test_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = a.hgnum_group_code ), NULL, NULL, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = a.gnum_test_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = a.hgnum_group_code ))::NUMERIC AS grp ,a.hivnum_req_no AS requisitionNo ,hivnum_reqdtl_status AS reqDtlStatus ,a.hivtnum_req_dno AS requisitionDNo ,gbnum_priority_code AS priorityCode ,hivstr_dept_report_url AS deptReport ,hivstr_report_url AS reportUrl ,gnum_test_code AS testCode ,gnum_sample_code AS samplecode ,( SELECT HBNUM_REQUISITION_TYPE FROM hivt_requisition_header WHERE GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) AS requisitionTypeCode ,NVL(concatstring('Select k.hivnum_parameter_code||''#@''||  nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code),''NA'')||''#@''||hivstr_ref_range||''#@''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = ''' || a.gnum_test_code || '''   and k.hivtnum_req_dno=''' || a.hivtnum_req_dno || ''' and k.gnum_hospital_code=''' || a.gnum_hospital_code || ''' order by hivtnum_order asc', '`'), '-1#@-#@-#@-') AS testParameterName ,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName ,a.hivnum_req_no ,hgnum_group_code AS groupcode ,a.gnum_hospital_code AS hospitalcode ,CONCAT ( CONCAT ( hivnum_temp_sample_no ,'/' ) ,hgstr_daily_labno ) AS tempSampleNo ,hivnum_sample_no AS sampleNo ,hgstr_daily_labno AS labno ,hivnum_packing_list_no AS packinglistno ,a.gnum_lab_code AS labCode ,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) AS sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) AS testType ,hrgnum_puk_reqd AS patCRNo ,hgnum_visitno_reqd AS patVisitNo ,hrgstr_patname_reqd AS patName ,gstr_gender_code_reqd AS patGender ,hrgdt_dob_reqd ,hivnum_reqdtl_status ,gnum_episode_code_reqd AS episodeCode ,hbnum_requisition_type_reqd ,TO_CHAR(hgnum_visit_date_reqd, 'DD-Mon-YYYY') AS patvisitdat ,hivstr_address_reqd AS address ,hipnum_wardcode_reqd ,hipnum_admno_reqd ,hrgstr_mobile_no_reqd ,nvl(hrgstr_email_id_reqd, '-') AS emailId ,hipnum_room_code_reqd ,hipnum_bed_code_reqd ,hipstr_bed_name_reqd AS patBedName ,hrgstr_mlc_no_reqd ,hivstr_age_reqd AS patAge ,pkg_inv_fun.fun_patient_status(a.hivnum_req_no, a.gnum_hospital_code) AS patStatus ,( SELECT hivt_report_available_after FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ) AS reportAvailableAfter ,hgnum_dept_code_reqd AS departmentcode ,hgnum_deptunitcode_reqd AS patdeptunitcode ,hbnum_requisition_type_reqd AS requisitionTypeCode ,gstr_dept_name_reqd || '-' || hgstr_unit_name_reqd AS patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code, a.gnum_hospital_code) AS groupName ,hivnum_uom AS uomCode ,pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamicTemplatePrintedGroup ,pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup ,( SELECT gnum_finalremark_reqd FROM hivt_laboratory_mst WHERE gnum_isvalid = 1 AND gnum_lab_code = a.gnum_lab_code AND gnum_hospital_code = a.gnum_hospital_code ) AS finalRemarkReqd ,a.hivstr_final_remark AS finalRemarkString ,( SELECT gstr_instruction_tech FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ) AS instructionPat ,( SELECT gnum_isrequisitionform_needed FROM hivT_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ) AS isrequisitionformneeded ,( decode(hgnum_group_code, NULL, ( SELECT gnum_preference_order FROM hivT_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ), ( SELECT preference_order FROM hivt_test_group_mst u WHERE u.gnum_hospital_code = a.gnum_hospital_code AND u.gnum_isvalid = 1 AND u.hgnum_group_code = a.hgnum_group_code )) ) AS preferenceOrder ,( SELECT hivstr_addendum_remark FROM hivt_requisition_header WHERE gnum_isvalid = 1 AND hivnum_req_no = a.hivnum_req_no AND gnum_hospital_code = a.gnum_hospital_code ) AS addendumRemarkValue ,a.gnum_report_change AS reportChangeFlag ,DECODE(a.gnum_machine_code, - 1, 0, NULL, 0, 1) AS isMachineBasedTest ,a.hrgstr_visit_reason_reqd AS visitReason ,( SELECT nvl(hgnum_pat_test_type, '0') FROM hivt_laboratory_mst p WHERE p.gnum_isvalid = 1 AND p.gnum_hospital_code = a.gnum_hospital_code AND p.gnum_lab_code = a.gnum_lab_code ) AS labtype ,TO_CHAR(hivt_entry_date, 'DD-Mon-YYYY HH:MI:SS') AS requisitionDate ,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY HH:MI:SS') AS sampleCollDate ,TO_CHAR(hivdt_acceptance_date_time, 'DD-Mon-YYYY HH:MI:SS') AS sampleAccepDate ,TO_CHAR(hivtdt_pat_accpt_date_time, 'DD-Mon-YYYY HH:MI:SS') AS patAccepDate ,TO_CHAR(hivdt_result_date, 'DD-Mon-YYYY HH:MI:SS') AS resultEntryDate ,TO_CHAR(hivtdt_res_val_date, 'DD-Mon-YYYY HH:MI:SS') AS resultValidationDate ,('2') AS isRepeat ,nvl(hgstr_ordered_by_doc_reqd, '-') AS advisedByDocId ,nvl(hgstr_ordered_by_doc_name_reqd, '-') AS advisedByDocName ,nvl(hrgstr_visit_reason_reqd, '-') AS instructionGeneric ,nvl(hrgst_chiefcomplaints_code, '-') AS chiefComplaintsCode ,nvl(hrgst_chiefcomplaints_name, '-') AS chiefComplaintsName ,nvl(hrgst_daignosis_code, '-') AS diagnosisCode ,nvl(hrgst_daignosis_name, '-') AS diagnosisName ,nvl(hrgstr_visit_reason_reqd, '-') AS advisedNote FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code = ? AND a.gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid = 1 AND p.gnum_module_id = ? AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ? AND p.gnum_hospital_code = ? ) AND a.hivnum_validator_reqd IN ( 0 ,? )

SELECT.RESULT_ENTRY_HIVT_REQUISITION_HEADER = SELECT ( SELECT CONCAT ( GSTR_TEST_NAME ,decode(hivstr_site, '1', '(NA)', '2', '(Both)', '3', '(Left)', '4', '(Right)') ) FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = a.gnum_test_code ) AS testName, (SELECT gstr_user_name FROM gblt_user_mst WHERE gnum_userid = a.hivnum_result_seatid AND gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code )as resultEnteredBy, ( SELECT hmistr_machine_name FROM hmit_machine_mst ss WHERE hminum_machine_id = gnum_machine_code AND ss.gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = 1 ) AS machineCode ,decode(( SELECT nvl(gnum_ispidshow, 0) FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ), 0, NULL, 1, ( SELECT nvl(hivstr_pid_no, '') FROM hivt_ictc_dtl WHERE hivnum_isvalid = 1 AND hivnum_req_no = a.hivnum_req_no )) AS pidno ,( SELECT nvl(gnum_ispidshow, 0) FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ) AS ispidshow ,decode(( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = a.gnum_test_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = a.hgnum_group_code ), NULL, NULL, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = a.gnum_test_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = a.hgnum_group_code ))::NUMERIC AS grp ,a.hivnum_req_no AS requisitionNo ,( SELECT DISTINCT (istestmodify) FROM hivt_laboratory_mst q WHERE q.gnum_lab_code = a.gnum_lab_code AND q.gnum_hospital_code = a.gnum_hospital_code ) AS islabtestmodify ,is_addendum AS isAddendum ,hivnum_reqdtl_status AS reqDtlStatus ,a.hivtnum_req_dno AS requisitionDNo ,gbnum_priority_code AS priorityCode ,hivstr_dept_report_url AS deptReport ,gnum_test_code AS testCode ,gnum_sample_code AS samplecode ,( SELECT HBNUM_REQUISITION_TYPE FROM hivt_requisition_header WHERE GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) AS requisitionTypeCode ,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName ,a.hivnum_req_no ,hgnum_group_code AS groupcode ,a.gnum_hospital_code AS hospitalcode ,CONCAT ( CONCAT ( hivnum_temp_sample_no ,'/' ) ,hgstr_daily_labno ) AS tempSampleNo ,hivnum_sample_no AS sampleNo ,hgstr_daily_labno AS labno ,hivnum_packing_list_no AS packinglistno ,a.gnum_lab_code AS labCode ,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) AS sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) AS testType ,hrgnum_puk_reqd AS patCRNo ,hgnum_visitno_reqd AS patVisitNo ,hrgstr_patname_reqd AS patName ,gstr_gender_code_reqd AS patGender ,hrgdt_dob_reqd ,hivnum_reqdtl_status ,gnum_episode_code_reqd AS episodeCode ,hbnum_requisition_type_reqd ,TO_CHAR(hgnum_visit_date_reqd, 'DD-Mon-YYYY') AS patvisitdat ,hivstr_address_reqd AS address ,hipnum_wardcode_reqd ,hipnum_admno_reqd ,hrgstr_mobile_no_reqd ,nvl(hrgstr_email_id_reqd, '-') AS emailId ,hipnum_room_code_reqd ,hipnum_bed_code_reqd ,hipstr_bed_name_reqd AS patBedName ,hrgstr_mlc_no_reqd ,hivstr_age_reqd AS patAge ,pkg_inv_fun.fun_patient_status(a.hivnum_req_no, a.gnum_hospital_code) AS patStatus ,( SELECT hivt_report_available_after FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_test_code = a.gnum_test_code AND gnum_labcode = a.gnum_lab_code ) AS reportAvailableAfter ,hgnum_dept_code_reqd AS departmentcode ,hgnum_deptunitcode_reqd AS patdeptunitcode ,hbnum_requisition_type_reqd AS requisitionTypeCode ,gstr_dept_name_reqd || '-' || hgstr_unit_name_reqd AS patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code, a.gnum_hospital_code) AS groupName ,hivnum_uom AS uomCode ,pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamicTemplatePrintedGroup ,pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup ,( SELECT gnum_finalremark_reqd FROM hivt_laboratory_mst WHERE gnum_isvalid = 1 AND gnum_lab_code = a.gnum_lab_code AND gnum_hospital_code = a.gnum_hospital_code ) AS finalRemarkReqd ,a.hivstr_final_remark AS finalRemarkString ,( SELECT gstr_instruction_tech FROM hivt_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ) AS instructionPat ,( SELECT gnum_isrequisitionform_needed FROM hivT_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ) AS isrequisitionformneeded ,( decode(hgnum_group_code, NULL, ( SELECT gnum_preference_order FROM hivT_laboratory_test_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = a.gnum_hospital_code AND gnum_labcode = a.gnum_lab_code AND gnum_test_code = a.gnum_test_code ), ( SELECT preference_order FROM hivt_test_group_mst u WHERE u.gnum_hospital_code = a.gnum_hospital_code AND u.gnum_isvalid = 1 AND u.hgnum_group_code = a.hgnum_group_code )) ) AS preferenceOrder ,( SELECT hivstr_addendum_remark FROM hivt_requisition_header WHERE gnum_isvalid = 1 AND hivnum_req_no = a.hivnum_req_no AND gnum_hospital_code = a.gnum_hospital_code ) AS addendumRemarkValue ,a.gnum_report_change AS reportChangeFlag ,DECODE(a.gnum_machine_code, - 1, 0, NULL, 0, 1) AS isMachineBasedTest ,a.hrgstr_visit_reason_reqd AS visitReason ,( SELECT nvl(hgnum_pat_test_type, '0') FROM hivt_laboratory_mst p WHERE p.gnum_isvalid = 1 AND p.gnum_hospital_code = a.gnum_hospital_code AND p.gnum_lab_code = a.gnum_lab_code ) AS labtype ,TO_CHAR(hivt_entry_date, 'DD-Mon-YYYY HH:MI:SS') AS requisitionDate ,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY HH:MI:SS') AS sampleCollDate ,TO_CHAR(hivdt_acceptance_date_time, 'DD-Mon-YYYY HH:MI:SS') AS sampleAccepDate ,TO_CHAR(hivtdt_pat_accpt_date_time, 'DD-Mon-YYYY HH:MI:SS') AS patAccepDate ,TO_CHAR(hivdt_result_date, 'DD-Mon-YYYY HH:MI:SS') AS resultEntryDate ,TO_CHAR(hivtdt_res_val_date, 'DD-Mon-YYYY HH:MI:SS') AS resultValidationDate ,('2') AS isRepeat ,nvl(hgstr_ordered_by_doc_reqd, '-') AS advisedByDocId ,nvl(hgstr_ordered_by_doc_name_reqd, '-') AS advisedByDocName ,nvl(hrgstr_visit_reason_reqd, '-') AS instructionGeneric ,nvl(hrgst_chiefcomplaints_code, '-') AS chiefComplaintsCode ,nvl(hrgst_chiefcomplaints_name, '-') AS chiefComplaintsName ,nvl(hrgst_daignosis_code, '-') AS diagnosisCode ,nvl(hrgst_daignosis_name, '-') AS diagnosisName ,nvl(hrgstr_visit_reason_reqd, '-') AS advisedNote FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code = ? AND a.gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid = 1 AND p.gnum_module_id = ? AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ? AND p.gnum_hospital_code = ? ) AND a.has_permission IN ( 0 ,? )

SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE in(1,2) and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE ) as sampleAreaName,hgnum_pat_test_type as patientType  from HIVT_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_COLLECTION_AREA_MST' AND p.gstr_column_name \= 'GNUM_AREA_CODE'  AND p.gnum_column_VALUE \= a.GNUM_area_CODE   AND p.gnum_hospital_code \= ?  AND p.gnum_seatid \=?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type in (1,2) AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)  order by sampleAreaName asc                                           \t\t\t\t\t

SELECT.LAB.DTLS.HIVT_LABORATORY_MST= Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmentName, gstr_lab_name as labName, nvl(hgnum_pat_test_type,0) as labTypeCode, decode(hgnum_pat_test_type,null,'Sample/Patient Based Lab', 0,'Sample/Patient Based Lab' ,1, 'Only Sample Based Lab',2, 'Only Patient Based Lab') as labTypeName from hivt_laboratory_mst a where gnum_isvalid=1 and gnum_hospital_code=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p where p.gbl_isvalid=1 AND p.gnum_module_id =? AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ? AND p.gnum_hospital_code = ?) order by departmentName, labName