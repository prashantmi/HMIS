


/** Requsition Status -READY_APPOINTMENT\=1 READY_SAMPLECOLLECTION \=2 READY_PLISTGENERATION  \= 3 READY_SAMPLEACCEPTANCE \= 4 READY_PATIENTACCEPTANCE \=5 READY_RESULTENTRY \=6

#SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL=SELECT a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   
SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL=SELECT a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, NVL(initcap(a.hrgstr_father_name),'-') AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?

SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_DAILY=SELECT  a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS patdeptunitcode, pkg_clinical_util_fun.get_deptunit_name(a.gnum_hospital_code,a.hgnum_deptunitcode) AS patdeptunit,  pkg_clinical_util_fun.get_dept_name(a.gnum_hospital_code,a.gnum_dept_code) AS department, pkg_clinical_util_fun.get_room_name(a.gnum_hospital_code,a.hgnum_room_code) AS room, hrgnum_episode_type_code as patepisodetypecode,hrgnum_visit_type AS patvisittypecode, gnum_hospital_code AS hospitalcode , (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no \=a.hrgnum_visit_no and hrgnum_episode_code \=a.hrgnum_episode_code and  hrgnum_puk\=a.hrgnum_puk   and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE)  as patmlcno,NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''||  diagnosticTypeName ||'')''FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM(HGBSTR_HOSPITAL_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName FROM HRGT_EPISODE_DIAGNOSIS_DTL X  WHERE X.HRGNUM_EPISODE_CODE \='''|| a.hrgnum_episode_code ||'''  AND X.HRGNUM_PUK \='''||a.HRGNUM_PUK||'''   AND X.GNUM_HOSPITAL_CODE \= '''|| gnum_hospital_code||'''       and x.hrgnum_visit_no\='''||a.hrgnum_visit_no||''' AND X.HBNUM_ISREPEAT IN (0,1) AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,gnum_hospital_code AS hospitalcode,a.hrgstr_visit_reason as visitReason,a.hrgnum_episode_code AS patepisodecode, a.hrgnum_visit_no AS patvisitno,TO_CHAR( gdt_entry_date, 'dd-Mon-yyyy') AS patvisitdate, a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, NVL(initcap(a.hrgstr_father_name),'-') AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode,pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId FROM hrgt_daily_patient_dtl a WHERE gnum_isvalid\=1 and gnum_hospital_code = ? AND hrgnum_visit_no=? AND  hrgnum_episode_code = ? AND hrgnum_puk \= ?

      
 /**Query To get the Lab Test . Used for searching **/  
 // query for inv antibiotic process
    
/* SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL\=select hminum_machine_recordid as machineRecordId,hmistr_machine_test_code as machineTestParameterCode,hmistr_machine_sampleno as machineLabSampleNo,hmistr_result as machineResult, NVL(TO_CHAR(hmidt_resultentry_date,'dd-Mon-yyyy'),'') as machineResultEntryDate,hminum_machine_reqid as machineReqId,hminum_machine_id as machineCode,(select hminum_inv_reqdno from hmit_sample_dtl where hminum_machine_reqid\=a.hminum_machine_reqid and hminum_machine_id\=a.hminum_machine_id and gnum_hospital_code\=a.gnum_hospital_code   ) as reqDno,(select hminum_hmis_test_code from hmit_sample_dtl where hminum_machine_reqid\=a.hminum_machine_reqid and hminum_machine_id\=a.hminum_machine_id and gnum_hospital_code\=a.gnum_hospital_code   ) as testCode,(select HMISTR_HMIS_TESTPARA_CODE from hmit_machine_testpara_mst where GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and HMISTR_MACHINE_TEST_CODE\=a.HMISTR_MACHINE_TEST_CODE) as parameterCode,(select hmistr_machine_testpara_name from hmit_machine_testpara_mst where GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and HMISTR_MACHINE_TEST_CODE\=a.HMISTR_MACHINE_TEST_CODE) as machineTestParameterName from hmit_result_dtl a where hminum_status\=? and hminum_machine_id\=? and gnum_hospital_code\=?
                                        
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1\#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType, '1\#1\#1' as mandInfo,   '1\#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded    FROM hivt_laboratory_test_mst a      WHERE a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=? AND gnum_numof_test >\= (Select count(*) from hivt_requisition_dtl where GNUM_LAB_CODE \= a.GNUM_LABCODE and gnum_test_code \= a.gnum_test_code and     gnum_hospital_code \= a.gnum_hospital_code and HIVT_ENTRY_DATE \= sysdate)       \t\t\t                                 
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1\#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType, '1\#1\#1' as mandInfo,   '1\#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded    FROM hivt_laboratory_test_mst a      WHERE a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=?
SELECT.LAB_WISE_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1\#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType, '1\#1\#1' as mandInfo,   '1\#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=?                               

SELECT.TEST_AVAILABILITY.HIVT_TEST_MST = SELECT gnum_user_test_code,gstr_remarks from hivt_laboratory_test_mst a  WHERE a.gnum_is_test_available \= 0  AND  a.gnum_isvalid \= 1 AND a.gnum_hospital_code \=?

SELECT.PATIENT_ADMISSION_DTLS.HIPT_PATADMISSION_DTL= SELECT hrgnum_puk as patcrno,to_char(hipdt_admdatetime,'dd-Mon-yyyy') as admissionDate,gnum_deptunit_code as patdeptunitcode, hrgnum_visit_no as patvisitno, hrgnum_episode_code as  patepisodecode ,hpad.gnum_dept_code AS admitteddepartmentcode, hpad.hipnum_admno AS patadmissionno, pkg_clinical_util_fun.get_deptunit_name(hpad.gnum_hospital_code,hpad.gnum_deptunit_code) AS patdeptunit, pkg_clinical_util_fun.get_dept_name(hpad.gnum_hospital_code,hpad.gnum_dept_code) AS admitteddepartmentname,  hpad.hipnum_ward_code AS patwardcode, hpad.gnum_dept_code AS admitteddepartmentcode,(SELECT INITCAP(hipstr_ward_name) FROM hipt_ward_mst hwm WHERE gnum_isvalid \=1 and hipnum_ward_code \= hpad.hipnum_ward_code and GNUM_HOSPITAL_CODE\=hpad.GNUM_HOSPITAL_CODE) as patwardname, hpad.hipnum_room_code AS patroomno,(SELECT INITCAP(hipstr_room_desc) FROM hipt_room_config_mst  WHERE gnum_isvalid\=1 and hipnum_room_no \= hpad.hipnum_room_code and GNUM_HOSPITAL_CODE\=hpad.GNUM_HOSPITAL_CODE) as patroomname,hpad.hipnum_bed_code bedcode,ipd_mst.GETBEDNAME(hpad.hipnum_bed_code,gnum_hospital_code) AS bedname, gnum_hospital_code as hospitalcode,(SELECT INITCAP(str_emp_full_name) FROM PIST_EMP_registration_DTL WHERE gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= hpad.gnum_hospital_code  AND STR_EMP_NO \= hpad.hIPNUM_CONSULTANT_ID ) consultantName, (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no\=hpad.hrgnum_visit_no and hrgnum_episode_code \=hpad.hrgnum_episode_code  and  hrgnum_puk\=hpad.hrgnum_puk   and GNUM_HOSPITAL_CODE \= hpad.GNUM_HOSPITAL_CODE)  as patmlcno, NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''|| diagnosticTypeName ||'')'' FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM (HGBSTR_HOSPITAL_DISEASE_CODE)  \=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName  FROM HRGT_EPISODE_DIAGNOSIS_DTL X WHERE X.HRGNUM_EPISODE_CODE \='''||hpad.hrgnum_episode_code||'''  AND X.HRGNUM_PUK \='''||hpad.HRGNUM_PUK||''' AND X.GNUM_HOSPITAL_CODE \= '''||hpad.gnum_hospital_code||'''   and x.hrgnum_visit_no\='''||hpad.hrgnum_visit_no||'''  AND X.HBNUM_ISREPEAT IN (0,1)  AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,BILL_MST.GET_PAT_ACCOUNTNO(hpad.GNUM_HOSPITAL_CODE\:\:character varying,2\:\:character varying,hpad.HRGNUM_PUK\:\:character varying) as patAccNo FROM HIPT_PATADMISSION_DTL hpad WHERE GNUM_ISVALID \= 1 AND HIPDT_ADMSTATUS_CODE NOT IN (13,14,16) AND  GNUM_HOSPITAL_CODE \= ? AND HIPDT_DISDATETIME IS NULL AND HRGNUM_PUK \= ?                                        

#SELECT.PATIENT_EPISODE_DTLS.HRGT_EPISODE_DTL=SELECT   a.hrgnum_puk AS patcrno, NVL(hgnum_treatment_cat_code,hgnum_patient_cat_code) AS patCategoryCode ,a.hrgnum_episode_code AS patepisodecode, a.hrgnum_visit_no AS patvisitno, TO_CHAR( gdt_entry_date, 'dd-Mon-yyyy') AS patvisitdate, a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS patdeptunitcode, pkg_clinical_util_fun.get_deptunit_name(a.gnum_hospital_code,a.hgnum_deptunitcode) AS patdeptunit,  pkg_clinical_util_fun.get_dept_name(a.gnum_hospital_code,a.gnum_dept_code) AS department, pkg_clinical_util_fun.get_room_name(a.gnum_hospital_code,a.hgnum_room_code) AS room, hrgnum_episode_type_code as patepisodetypecode,hrgnum_visit_type AS patvisittypecode, gnum_hospital_code AS hospitalcode , (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no \=a.hrgnum_visit_no and hrgnum_episode_code \=a.hrgnum_episode_code and  hrgnum_puk\=a.hrgnum_puk   and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE)  as patmlcno,NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''||  diagnosticTypeName ||'')''FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM(HGBSTR_HOSPITAL_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName FROM HRGT_EPISODE_DIAGNOSIS_DTL X  WHERE X.HRGNUM_EPISODE_CODE \='''|| a.hrgnum_episode_code ||'''  AND X.HRGNUM_PUK \='''||a.HRGNUM_PUK||'''   AND X.GNUM_HOSPITAL_CODE \= '''|| gnum_hospital_code||'''       and x.hrgnum_visit_no\='''||a.hrgnum_visit_no||''' AND X.HBNUM_ISREPEAT IN (0,1) AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,gnum_hospital_code AS hospitalcode,a.hrgstr_visit_reason as visitReason from hrgt_episode_dtl a WHERE a.gnum_isvalid \= 1 AND a.gnum_hospital_code \=? AND hrgnum_visit_no \=(SELECT MAX (hrgnum_visit_no) FROM hrgt_daily_patient_dtl WHERE gnum_isvalid \= a.gnum_isvalid AND a.hrgnum_is_episode_open \=1 AND gnum_hospital_code \= a.gnum_hospital_code AND hrgnum_episode_code \= a.hrgnum_episode_code AND hrgnum_puk \= a.hrgnum_puk) AND a.hrgnum_puk \= ? ORDER BY a.gdt_entry_date desc 
SELECT.PATIENT_EPISODE_DTLS.HRGT_EPISODE_DTL=SELECT   a.hrgnum_puk AS patcrno, NVL(hgnum_treatment_cat_code,hgnum_patient_cat_code) AS patCategoryCode ,a.hrgnum_episode_code AS patepisodecode, a.hrgnum_visit_no AS patvisitno, TO_CHAR( gdt_entry_date, 'dd-Mon-yyyy') AS patvisitdate, a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS patdeptunitcode, pkg_clinical_util_fun.get_deptunit_name(a.gnum_hospital_code,a.hgnum_deptunitcode) AS patdeptunit,  pkg_clinical_util_fun.get_dept_name(a.gnum_hospital_code,a.gnum_dept_code) AS department, pkg_clinical_util_fun.get_room_name(a.gnum_hospital_code,a.hgnum_room_code) AS room, hrgnum_episode_type_code as patepisodetypecode,hrgnum_visit_type AS patvisittypecode, gnum_hospital_code AS hospitalcode , (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no \=a.hrgnum_visit_no and hrgnum_episode_code \=a.hrgnum_episode_code and  hrgnum_puk\=a.hrgnum_puk   and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE)  as patmlcno,NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''||  diagnosticTypeName ||'')''FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM(HGBSTR_HOSPITAL_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName FROM HRGT_EPISODE_DIAGNOSIS_DTL X  WHERE X.HRGNUM_EPISODE_CODE \='''|| a.hrgnum_episode_code ||'''  AND X.HRGNUM_PUK \='''||a.HRGNUM_PUK||'''   AND X.GNUM_HOSPITAL_CODE \= '''|| gnum_hospital_code||'''       and x.hrgnum_visit_no\='''||a.hrgnum_visit_no||''' AND X.HBNUM_ISREPEAT IN (0,1) AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,gnum_hospital_code AS hospitalcode,a.hrgstr_visit_reason as visitReason from hrgt_episode_dtl a WHERE a.gnum_isvalid \= 1 AND a.gnum_hospital_code \=? AND hrgnum_visit_no \=(SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl WHERE gnum_isvalid \= a.gnum_isvalid AND a.hrgnum_is_episode_open \=1 AND gnum_hospital_code \= a.gnum_hospital_code AND hrgnum_episode_code \= a.hrgnum_episode_code AND hrgnum_puk \= a.hrgnum_puk) AND a.hrgnum_puk \= ? ORDER BY a.gdt_entry_date desc 

SELECT.LABTESTSAMPLECOMBO.HIVT_LABTEST_SAMPLE_MST = select a.GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(GSTR_SAMPLE_NAME)  from hivt_sample_mst where gnum_isvalid\=1 and GNUM_SAMPLE_CODE \= a.GNUM_SAMPLE_CODE) as sampleName   from HIVT_LABTEST_SAMPLE_MST a  where GNUM_LAB_CODE \= ? AND GNUM_TEST_CODE \= ?   AND a.GNUM_HOSPITAL_CODE\=?  AND a.GNUM_ISVALID\=1  order by sampleName
SELECT.LAB_COMBO_NAMES.HIVT_LABORATORY_MST = Select GNUM_LAB_CODE,  INITCAP (gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and DECODE (SUBSTR(HIVNUM_LAB_WORKING_DAYS,TO_NUMBER(TO_CHAR(SYSDATE,'d')),1),1,'1','0')\=1 and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) order by labName
SELECT.TEST_COMBO_NAMES.HIVT_TEST_MST = select distinct(gnum_test_code), pkg_inv_fun.fun_test_name(gnum_test_code) as testName from hivt_laboratory_test_mst where gnum_isvalid\=1  and gnum_hospital_code \= ? order by testName
SELECT.TEST_COMBO_NAMES_AJAX.HIVT_TEST_MST = select gnum_test_code, pkg_inv_fun.fun_test_name(gnum_test_code) as testName from hivt_laboratory_test_mst where gnum_isvalid\=1  and gnum_hospital_code \= ?  

#SELECT.TEST_GROUP_NAMES.HIVT_TEST_GROUP_MST = SELECT   hgnum_group_code,hgstr_group_name AS testgroupname FROM hivt_test_group_mst a WHERE a.gnum_hospital_code \= ? AND gnum_isvalid \= 1 AND EXISTS(SELECT 1 from hivt_test_group_info_mst  WHERE hgnum_group_code \= a.hgnum_group_code AND gnum_is_valid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code) ORDER BY testgroupname
SELECT.TEST_GROUP_NAMES.HIVT_TEST_GROUP_MST = SELECT   hgnum_group_code,hgstr_group_name AS testgroupname FROM hivt_test_group_mst a WHERE a.gnum_hospital_code \= ? AND gnum_isvalid \= 1 AND EXISTS(SELECT 1 from hivt_test_group_info_mst  WHERE hgnum_group_code \= a.hgnum_group_code AND gnum_is_valid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code) and a.is_shown\=1 ORDER BY testgroupname

SELECT.TEST_GROUP_NAMES_AJAX.HIVT_TEST_GROUP_MST = SELECT   hgnum_group_code,hgstr_group_name AS testgroupname FROM hivt_test_group_mst a WHERE a.gnum_hospital_code \= ? AND gnum_isvalid \= 1 AND EXISTS(SELECT 1 from hivt_test_group_info_mst  WHERE hgnum_group_code \= a.hgnum_group_code AND gnum_is_valid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code   \t\t\t\t\t\t\t\t\t\t\t\t               \t\t\t   

#SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid \=1 and gnum_bookmark_type \= 1 and gnum_hospital_code \= ? and gnum_user_id \= ? and hivtnum_lab_code in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1   AND p.gnum_module_id \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  and gnum_hospital_code \= ? )  order by INITCAP(hivtstr_bookmark_name)  \t\t\t               \t\t\t   

SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid \=1 and gnum_bookmark_type \= 1 and gnum_hospital_code \= ?  and hivtnum_lab_code in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1   AND p.gnum_module_id \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  and gnum_hospital_code \= ? ) and gnum_user_id\=? order by INITCAP(hivtstr_bookmark_name)  \t\t\t               \t\t\t\t\t\t               \t\t\t   

#SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST_RAISING=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid =1 and gnum_bookmark_type = 1 and gnum_hospital_code = ?   and gnum_user_id=? 
SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST_RAISING=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid =1 and gnum_bookmark_type = 1 and gnum_hospital_code = ?   and gnum_user_id=?  and hivtnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1)

#SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST_RAISING_OPDDESK=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid =1 and gnum_bookmark_type = 1 and gnum_hospital_code = ?   and gnum_user_id=?  and hivtnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1 and is_hidefromopddsk=0)
SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST_RAISING_OPDDESK=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst c,hivt_laboratory_test_mst v where c.gnum_isvalid =1 and gnum_bookmark_type = 1 and c.gnum_hospital_code = ?   and gnum_user_id=?  and hivtnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1) and v.gnum_labcode=hivtnum_lab_code and v.gnum_hospital_code=c.gnum_hospital_code and is_hidefromopddesk=0 and c.hivtnum_test_code=v.gnum_test_code 


/**Generate Requsition No *//

SELECT.REQUISTIONNO.SYS_REQUISITION_MAINTAINER= Select NVL((Select  MAX(HIVTNUM_REQUISITION_SEQUENCE) from SYS_REQUISITION_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
 
INSERT.REQUISTIONNO.SYS_REQUISITION_MAINTAINER = INSERT INTO sys_requisition_maintainer( gnum_laboratory_code, gnum_hospital_code, hivtnum_requisition_sequence, gnum_yymmdd) \
    											VALUES (?, ?, ?, ?);
UPDATE.REQUISTIONNO.SYS_REQUISITION_MAINTAINER = UPDATE sys_requisition_maintainer SET  hivtnum_requisition_sequence\=? WHERE gnum_yymmdd\=TO_CHAR(SYSDATE,'YYMMDD') and  gnum_hospital_code\=? and gnum_laboratory_code\=? 
INSERT.HIVT_REQUISITION_HEADER_TEMP = INSERT INTO hivt_requisition_header( hivnum_req_no, hrgnum_puk, gnum_hospital_code, hgnum_visitno, gnum_lab_code, hivdt_requisition_date, hivdt_entry_date, gnum_isvalid) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, 1\:\:numeric,?\:\:numeric, SYSDATE, SYSDATE, 1\:\:numeric);
            					
 
 INSERT.HIVT_REQUISITION_HEADER = INSERT INTO hivt_requisition_header( hivnum_req_no, hrgnum_puk, gnum_hospital_code, hgnum_visitno, gnum_lab_code, hivdt_requisition_date, hivdt_entry_date, hivnum_isconfidential, hivnum_reqheader_status, gnum_seat_id, gnum_episode_code, hrgstr_patname, hbnum_requisition_type, hrgdt_dob, hgnum_visit_date, hivnum_isactual_dob, hgstr_ordered_by_doc, gstr_gender_code, hivnum_req_raised_through, hivstr_age, hipnum_admno, hivstr_address, hipnum_wardcode, hrgstr_mobile_no, hrgstr_email_id, hipnum_room_code, hipnum_bed_code, hrgstr_mlc_no, hipstr_bed_name, hipstr_room_name, hipstr_ward_name, gstr_dept_name, hgstr_unit_name, hgnum_dept_code, hgnum_deptunitcode, hivtnum_isautomated_request, hgstr_ordered_by_doc_name, gnum_reffered_hospital_code, gnum_reffered_dept_unit_name,gnum_reffered_lab_code, hivstr_ext_hosporlab_name, hivstr_ext_crnumber, gnum_bill_no, hivstr_delete_reason, gnum_isvalid  ) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, SYSDATE, SYSDATE, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:character varying, ?\:\:numeric, ?\:\:timestamp without time zone, ?\:\:timestamp without time zone, ?\:\:numeric,  ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:numeric, ?, ?\:\:numeric, ?\:\:numeric, ?, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?, ?\:\:numeric, ?, ?, ?, ?, ?\:\:numeric, ?, ?  );
            					
UPDATE.APPOITMENT.IN.REQUISITIONHEADER=UPDATE hivt_requisition_header SET   hivdt_requisition_date\=?\:\:timestamp without time zone WHERE  hivnum_req_no\=?
            					
/**Insert Requsition Dtl table **/
				    //READY_RESULTVALIDATION:=7 READY_RESULTREVALIDATION:=8 PATIENT_REJECTED =9 PATIENT_RESCHEDULED=10 SAMPLE_RESCHEDULED:=11 SAMPLE_CANCELLED =12 READY_RESULTPRINTING =13
					//READY_DUPRESULTPRINTING =14 TEST_CANCELLED =15 TEST_DELETED =16 TEST_SEND_TO_MACHINE=17 RESULT_RECEIVED_FROM MACHINE=18 READY_FOR_GROSSING  =19 READY_SLIDEENTRY  =20;
					//READY_FOR_PROCESSING =23 READY_FOR_CUTTING =24 READY_FOR_REPORTING =25 READY_ASSOCIATE LAB =99 READY_EXTERNAL LAB =98  **/
            					
INSERT.HIVT_REQUISITION_DTL= INSERT INTO hivt_requisition_dtl( gnum_hospital_code, hivtnum_req_dno, hivnum_isappointment, gnum_lab_code, gnum_test_code, hivnum_isconfidential, gnum_sample_code, hivt_entry_date,gnum_seat_id,hivnum_req_no,hivtnum_workordersequence,hivtnum_typeofcomponent,hivnum_reqdtl_status,gbnum_priority_code,hgnum_group_code,hgnum_group_type,hivdt_appointment_date,hivstr_appointment_time) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, SYSDATE,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?,?,?\:\:timestamp without time zone,?\:\:character varying)         \t\t\t\t\t
            					
            					
            					
            					

INSERT.HIVT_REQUISITION_DTL_TEMP= INSERT INTO hivt_requisition_dtl( gnum_hospital_code, hivtnum_req_dno, hivnum_isappointment, gnum_lab_code, gnum_test_code, hivnum_isconfidential, gbnum_priority_code, hivdt_result_date, hivnum_sample_no, hivnum_result_seatid, hivt_entry_date, hivnum_reqdtl_status, gnum_seat_id, hapnum_app_ref_no, hivnum_temp_sample_no, hgnum_group_code, hgnum_group_type, hivtnum_cancellation_seatid, gnum_bill_no,  gnum_sample_code, hgstr_daily_labno, hivnum_pat_rejection_reason, hivnum_pat_rejection_action, hivtnum_workordersequence, hivnum_sam_rejection_action, hivnum_sam_rejection_reason, hivtnum_typeofcomponent,hivnum_req_no, hivnum_isaccepted, hivnum_packing_list_no, gnum_machine_code, hivnum_collection_seatid, hivnum_sample_col_area_code, hivdt_appointment_date, hivstr_appointment_time) VALUES (?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,  ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?);            \t\t\t\t\t
SELECT_LAB_COMBO_HIVT_LABORATORY_MST=Select GNUM_LAB_CODE, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) || '-' || gstr_lab_name  as labName from  hivt_laboratory_mst where gnum_isvalid\=1 and gnum_hospital_code\=? and gnum_lab_code in (SELECT  gnum_column_value  FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  AND p.gnum_seatid \=?   AND p.gnum_hospital_code \=?)
			
			
			
			
			
#changed By PrashantMi
SELECT.HIVT_REQUISITION_HEADER=Select (select hapnum_apt_id from hapt_appointment_dtl  where hapnum_apt_no\= (select hapnum_app_ref_no  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) and hapnum_apt_id\=4) as apttype,(select hivstr_appointment_time  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) as apttime,HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory,(select  array_agg(gstr_test_name)  from  hivt_test_mst x, HIVT_REQUISITION_DTL y where x.gnum_test_code\=y.gnum_test_code and y.HIVNUM_REQDTL_STATUS IN (5,10) AND y.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND y.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and x.GNUM_ISVALID \= 1 ) as testName  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in(5,10)  AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO)and  TRUNC(HIVDT_REQUISITION_DATE) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY'))   and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=15  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)
SELECT.PATIENT_HIVT_REQUISITION_HEADER=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING,DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying,  (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail ,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE testCode,  (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL ,hivtnum_priority_all as priorityCode, decode(hivtnum_priority_all,1,'Normal',2,'Urgent') as priority, to_Char(HIVT_ENTRY_DATE,'DD-Mon-YYYY') as requisitionDate,HIVNUM_REQDTL_STATUS, HIVNUM_REQ_NO as requisitionNo,nvl(HGNUM_GROUP_CODE,'0') as groupCode,HGNUM_GROUP_TYPE, (Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as labNoConfiguration,(select 'Patient\#'||gstr_instruction_post from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select 'Technician\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionColl,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,( select bc.hivtstr_labno_format  ||'\#'|| bc.gdt_initialization_date ||'\#'|| bc.gnum_no_of_seq_digits  ||'\#'|| bc.gnum_from_series ||'\#'|| bc.gnum_to_series  ||'\#'|| bc.gnum_init_type  ||'\#'||bc.hivstr_running_lab_no  ||'\#'|| bc.gnum_lab_code  ||'\#'||bc.gnum_sq_no ||'\#'||bc.gnum_pat_type ||'\#'||bc.gnum_test_code||'\#'||nvl(bc.acceptance_area,'null')||'\#'||nvl((bc.islabnoareawise),'0')||'\#' from hivt_labno_conf_mst bc  where  bc.gnum_lab_code\=a.gnum_lab_code and bc.gnum_test_code in( -1 ,a.gnum_test_code) and bc.acceptance_area is null AND bc.gnum_is_valid\=1  and bc.gnum_hospital_code\=a.gnum_hospital_code LIMIT 1) as checkboxajaxvalues, hgstr_daily_labno as labNoConfiguration2,  TO_CHAR(date( hivtdt_pat_accpt_date_time), 'dd-Mon-YYYY') as acceptanceDate from HIVT_REQUISITION_DTL a where  HIVNUM_REQDTL_STATUS in(?,?) AND HIVNUM_REQ_NO\=?  and gnum_hospital_code\=?

                                          
SELECT.COMBO_hivt_rejectionreason_mst=select hgnum_rejectionreason_id as rejectionId, hgstr_rejectionreason as  rejectionReason From	hivt_rejectionreason_mst where gnum_isvalid=1   and HIVNUM_ACCEPTANCE_TYPE in (2,3)      

SELECT.PATIENT.SYS_REQUISITION_MAINTAINER= Select NVL((Select  MAX(HIVTNUM_PATACCNO_SEQUENCE) \tfrom SYS_PATIENTACC_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD')  and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
                                						
INSERT.PATIENTNO.SYS_PATIENTACC_MAINTAINER=INSERT INTO SYS_PATIENTACC_MAINTAINER( gnum_laboratory_code, gnum_hospital_code, HIVTNUM_PATACCNO_SEQUENCE, gnum_yymmdd) \
    										VALUES (?, ?, ?, ?);
UPDATE.PATIENT.REQUISTIONNO.SYS_SAMPLE_MAINTAINER= UPDATE SYS_PATIENTACC_MAINTAINER SET  HIVTNUM_PATACCNO_SEQUENCE\=?  WHERE gnum_yymmdd\=TO_CHAR(SYSDATE,'YYMMDD')and gnum_laboratory_code\=? and   gnum_hospital_code\=?

#Changed By Prashant
INSERT.PATIENTDTLSACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL= INSERT INTO hivt_patient_acceptance_dtl(hivtnum_req_dno, gnum_hospital_code, hivnum_pat_acc_no, hivdt_acceptance_date_time,hivtnum_isaccepted,   gnum_seatid,   hivtdt_entry_date, hgstr_daily_labno, hivnum_pat_acc_status_code, has_permission ) VALUES (?, ?, ?, to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'),?, ?, SYSDATE, ?, ?, ? )
#Changed By Prashant                                                               
INSERT.PATIENTDTLSNOTACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL= INSERT INTO hivt_patient_acceptance_dtl(hivtnum_req_dno, gnum_hospital_code, hivnum_pat_acc_no, hivtnum_isaccepted, hivnum_pat_rejection_reason, gnum_seatid, hivnum_pat_rejection_action, hivtdt_entry_date, hgstr_daily_labno, hivdt_rejection_date_time, hivnum_pat_acc_status_code, hivtnum_rejection_seatid) VALUES (?, ?, ?,?, ?, ?, ?, SYSDATE, ?, to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'), ?, ?)
                                                              
UPDATE.REQDTLS.PATIENT.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?,   HIVNUM_PAT_REJECTION_REASON\=?, HIVNUM_PAT_REJECTION_ACTION\=?, hivtnum_cancellation_seatid\=?,HIVNUM_ISACCEPTED\=?, hivtdt_cancellation_date\=SYSDATE  Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
                                
UPDATE.PATIENTDTLS.HIVT_REQUISITION_HEADER=UPDATE HIVT_REQUISITION_HEADER SET  HRGSTR_MOBILE_NO=?  , HRGSTR_EMAIL_ID= ? , HIVSTR_ADDRESS = ? where GNUM_ISVALID=1 and gnum_hospital_code = ? and HIVNUM_REQ_NO=?

#UPDATE.REQDTLS.PATIENT.ACCEPTED.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?, HIVTDT_PAT_ACCPT_DATE_TIME\=SYSDATE,   HIVNUM_ISACCEPTED\=?, HIVDT_ACCEPTANCE_DATE_TIME\=SYSDATE, HIVDT_ACCEPTANCE_SEATID\=? Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
#UPDATE.REQDTLS.PATIENT.ACCEPTED.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set hivnum_sample_col_area_code\=?,HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?, HIVTDT_PAT_ACCPT_DATE_TIME\=SYSDATE,   HIVNUM_ISACCEPTED\=?, HIVDT_ACCEPTANCE_DATE_TIME\=SYSDATE, HIVDT_ACCEPTANCE_SEATID\=? Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ?  

#Changed By PrashantMi
UPDATE.REQDTLS.PATIENT.ACCEPTED.HIVT_REQUISITION_DTLS= Update HIVT_REQUISITION_DTL set hivnum_sample_col_area_code\=?,HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?, HIVTDT_PAT_ACCPT_DATE_TIME\=to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'),   HIVNUM_ISACCEPTED\=?, HIVDT_ACCEPTANCE_DATE_TIME\=to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'), HIVDT_ACCEPTANCE_SEATID\= ?, GNUM_MACHINE_CODE \= ?, hivdt_coll_date_time\=to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'),  has_permission\=?,HRGSTR_MOBILE_NO_REQD\=?  , HRGSTR_EMAIL_ID_REQD\= ? , HIVSTR_ADDRESS_REQD \= ? Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ?  

                                        
UPDATE.REQDTLS.PATIENT.RESCHEDULED.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?,   HIVNUM_PAT_REJECTION_REASON\=?, HIVNUM_PAT_REJECTION_ACTION\=?, HIVNUM_RESHEDULE_SEATID\=?, HIVDT_RESHEDULE_DATE\=SYSDATE, HIVNUM_ISACCEPTED\=?   Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
                                                           
                                                           
SELECT.CHECKDAILYLABNODUPLICACY=select count(*) from hivt_patient_acceptance_dtl where trunc(hivtdt_entry_date)\=trunc(sysdate) and UPPER(hgstr_daily_labno) \= UPPER(?)\t\t\t\t                                             
                                                           
                                                           

 #SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE \=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE ) as sampleAreaName  from HIVT_LAB_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  AND p.gnum_column_VALUE \= a.GNUM_LAB_CODE   AND p.gnum_hospital_code \= ?  AND p.gnum_seatid \=? ) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)                                             \t\t\t\t\t
#SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE \=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE ) as sampleAreaName  from HIVT_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_COLLECTION_AREA_MST' AND p.gstr_column_name \= 'GNUM_AREA_CODE'  AND p.gnum_column_VALUE \= a.GNUM_area_CODE   AND p.gnum_hospital_code \= ?  AND p.gnum_seatid \=?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)  order by sampleAreaName asc                                           \t\t\t\t\t

SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE in(1,2) and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE ) as sampleAreaName,hgnum_pat_test_type as patientType  from HIVT_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_COLLECTION_AREA_MST' AND p.gstr_column_name \= 'GNUM_AREA_CODE'  AND p.gnum_column_VALUE \= a.GNUM_area_CODE   AND p.gnum_hospital_code \= ?  AND p.gnum_seatid \=?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type in (1,2) AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)  order by sampleAreaName asc                                           \t\t\t\t\t
#SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE \=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE ) as sampleAreaName, hgnum_pat_test_type as patientType from HIVT_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_COLLECTION_AREA_MST' AND p.gstr_column_name \= 'GNUM_AREA_CODE'  AND p.gnum_column_VALUE \= a.GNUM_area_CODE   AND p.gnum_hospital_code \= ?  AND p.gnum_seatid \=?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)  order by sampleAreaName asc                                           \t\t\t\t\t


#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY hh\:mm') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND p.gnum_module_id \= ? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ? AND p.gnum_hospital_code \= ? ) AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO )
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=SELECT HIVNUM_REQ_NO AS requisitionNo ,HRGNUM_PUK AS patCRNo ,HGNUM_VISITNO AS patVisitNo ,GNUM_LAB_CODE AS labCode ,DECODE(HBNUM_REQUISITION_TYPE, 2, 'IPD', 1, 'OPD', 3, 'Emergency', 4, 'Special') AS patStatus ,( SELECT GSTR_LAB_NAME FROM HIVT_LABORATORY_MST WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= a.GNUM_HOSPITAL_CODE AND GNUM_LAB_CODE  \= a.GNUM_LAB_CODE ) AS labName ,to_char(HIVDT_REQUISITION_DATE, 'DD-Mon-YYYY hh\:mm') AS requisitionDate ,HRGDT_DOB AS patDOB ,HIVNUM_REQHEADER_STATUS AS reqHeaderStatus ,GNUM_EPISODE_CODE AS episodeCode ,INITCAP(HRGSTR_PATNAME) AS patName ,GSTR_GENDER_CODE AS patGenderCode ,HBNUM_REQUISITION_TYPE AS reqType ,to_char(HGNUM_VISIT_DATE, 'DD-Mon-YYYY') AS patVisitDate ,HIVSTR_AGE AS patAge ,HIPNUM_ADMNO AS patAdmNo ,NVL(HIVSTR_ADDRESS, '-') AS patAddress ,HIPNUM_WARDCODE AS patWardCode ,NVL(HRGSTR_MOBILE_NO, '-') AS patMobile ,NVL(HRGSTR_EMAIL_ID, '-') AS patEmail ,HIPNUM_ROOM_CODE AS patRoomCode ,HIPNUM_BED_CODE AS patBedCode ,HRGSTR_MLC_NO AS patMlcNo ,NVL(HIPSTR_BED_NAME, '-') AS patBedName ,NVL(HIPSTR_ROOM_NAME, '-') AS patRoomName ,NVL(HIPSTR_WARD_NAME, '-') AS patWardName ,NVL(GSTR_DEPT_NAME, '-') AS patDeptName ,NVL(HGSTR_UNIT_NAME, '-') AS patUnitName ,HGNUM_DEPT_CODE AS patDeptCode ,HGNUM_DEPTUNITCODE AS patDeptUnitCode ,NVL(HGSTR_ORDERED_BY_DOC_NAME, '-') AS patOrderByDoc ,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE, a.hgnum_patient_cat_code) AS patCategory ,(select string_agg((Bill_Interface.func_online_bill_dtl(b.gnum_hospital_code\:\:VARCHAR, DECODE(NVL(b.HGNUM_GROUP_TYPE, 11), NULL, b.gnum_test_code, 11, b.gnum_test_code, 1, b.gnum_lab_code || b.HGNUM_GROUP_CODE, 2, b.gnum_lab_code || b.HGNUM_GROUP_CODE, 3, b.gnum_test_code)\:\:VARCHAR, HBNUM_REQUISITION_TYPE\:\:VARCHAR, DECODE(NVL(b.HGNUM_GROUP_TYPE, 11), 0, 1, NULL, 1, 11, 1, 1, 4, 2, 4, 3, 1)\:\:VARCHAR, (b.HIVNUM_REQ_NO || '\!')\:\:VARCHAR) ),'\#\#')from hivt_requisition_dtl b where b.hivnum_req_no \= a.hivnum_req_no) as isBilled FROM HIVT_REQUISITION_HEADER A WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= ? AND GNUM_LAB_CODE IN ( SELECT GNUM_LAB_CODE FROM HIVT_LAB_COLLECTION_AREA_MST WHERE GNUM_ISVALID \= 1 AND gnum_hospital_Code  \= ? AND GNUM_AREA_CODE \= ? ) AND gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id  \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name  \= 'GNUM_LAB_CODE' AND p.gnum_seatid  \= ? AND p.gnum_hospital_code  \= ? ) AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS IN (?) AND GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO )
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=SELECT HIVNUM_REQ_NO AS requisitionNo ,HRGNUM_PUK AS patCRNo ,HGNUM_VISITNO AS patVisitNo ,GNUM_LAB_CODE AS labCode ,DECODE(HBNUM_REQUISITION_TYPE, 2, 'IPD', 1, 'OPD', 3, 'Emergency', 4, 'Special') AS patStatus ,( SELECT GSTR_LAB_NAME FROM HIVT_LABORATORY_MST WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= a.GNUM_HOSPITAL_CODE AND GNUM_LAB_CODE  \= a.GNUM_LAB_CODE ) AS labName ,to_char(HIVDT_REQUISITION_DATE, 'DD-Mon-YYYY hh\:mm') AS requisitionDate ,HRGDT_DOB AS patDOB ,HIVNUM_REQHEADER_STATUS AS reqHeaderStatus ,GNUM_EPISODE_CODE AS episodeCode ,INITCAP(HRGSTR_PATNAME) AS patName ,GSTR_GENDER_CODE AS patGenderCode ,HBNUM_REQUISITION_TYPE AS reqType ,to_char(HGNUM_VISIT_DATE, 'DD-Mon-YYYY') AS patVisitDate ,HIVSTR_AGE AS patAge ,HIPNUM_ADMNO AS patAdmNo ,NVL(HIVSTR_ADDRESS, '-') AS patAddress ,HIPNUM_WARDCODE AS patWardCode ,NVL(HRGSTR_MOBILE_NO, '-') AS patMobile ,NVL(HRGSTR_EMAIL_ID, '-') AS patEmail ,HIPNUM_ROOM_CODE AS patRoomCode ,HIPNUM_BED_CODE AS patBedCode ,HRGSTR_MLC_NO AS patMlcNo ,NVL(HIPSTR_BED_NAME, '-') AS patBedName ,NVL(HIPSTR_ROOM_NAME, '-') AS patRoomName ,NVL(HIPSTR_WARD_NAME, '-') AS patWardName ,NVL(GSTR_DEPT_NAME, '-') AS patDeptName ,NVL(HGSTR_UNIT_NAME, '-') AS patUnitName ,HGNUM_DEPT_CODE AS patDeptCode ,HGNUM_DEPTUNITCODE AS patDeptUnitCode ,NVL(HGSTR_ORDERED_BY_DOC_NAME, '-') AS patOrderByDoc ,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE, a.hgnum_patient_cat_code) AS patCategory  FROM HIVT_REQUISITION_HEADER A WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= ? AND GNUM_LAB_CODE IN ( SELECT GNUM_LAB_CODE FROM HIVT_LAB_COLLECTION_AREA_MST WHERE GNUM_ISVALID \= 1 AND gnum_hospital_Code  \= ? AND GNUM_AREA_CODE \= ? ) AND gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id  \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name  \= 'GNUM_LAB_CODE' AND p.gnum_seatid  \= ? AND p.gnum_hospital_code  \= ? ) AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS IN (?) AND GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO )
SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=SELECT HIVNUM_REQ_NO AS requisitionNo ,HRGNUM_PUK AS patCRNo ,HGNUM_VISITNO AS patVisitNo ,GNUM_LAB_CODE AS labCode ,DECODE(HBNUM_REQUISITION_TYPE, 2, 'IPD', 1, 'OPD', 3, 'Emergency', 4, 'Special') AS patStatus ,( SELECT GSTR_LAB_NAME FROM HIVT_LABORATORY_MST WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= a.GNUM_HOSPITAL_CODE AND GNUM_LAB_CODE  \= a.GNUM_LAB_CODE ) AS labName ,to_char(HIVDT_REQUISITION_DATE, 'DD-Mon-YYYY hh\:mm') AS requisitionDate ,HRGDT_DOB AS patDOB ,HIVNUM_REQHEADER_STATUS AS reqHeaderStatus ,GNUM_EPISODE_CODE AS episodeCode ,INITCAP(HRGSTR_PATNAME) AS patName ,GSTR_GENDER_CODE AS patGenderCode ,HBNUM_REQUISITION_TYPE AS reqType ,to_char(HGNUM_VISIT_DATE, 'DD-Mon-YYYY') AS patVisitDate ,HIVSTR_AGE AS patAge ,HIPNUM_ADMNO AS patAdmNo ,NVL(HIVSTR_ADDRESS, '-') AS patAddress ,HIPNUM_WARDCODE AS patWardCode ,NVL(HRGSTR_MOBILE_NO, '-') AS patMobile ,NVL(HRGSTR_EMAIL_ID, '-') AS patEmail ,HIPNUM_ROOM_CODE AS patRoomCode ,HIPNUM_BED_CODE AS patBedCode ,HRGSTR_MLC_NO AS patMlcNo ,NVL(HIPSTR_BED_NAME, '-') AS patBedName ,NVL(HIPSTR_ROOM_NAME, '-') AS patRoomName ,NVL(HIPSTR_WARD_NAME, '-') AS patWardName ,NVL(GSTR_DEPT_NAME, '-') AS patDeptName ,NVL(HGSTR_UNIT_NAME, '-') AS patUnitName ,HGNUM_DEPT_CODE AS patDeptCode ,HGNUM_DEPTUNITCODE AS patDeptUnitCode ,NVL(HGSTR_ORDERED_BY_DOC_NAME, '-') AS patOrderByDoc ,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE, a.hgnum_patient_cat_code) AS patCategory, ( select array_to_string(array(select CONCAT(count(hivtnum_priority_all) || decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential','Normal')) from HIVT_REQUISITION_DTL where HIVNUM_REQ_NO\=A.HIVNUM_REQ_NO and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE group by  hivtnum_priority_all ),', ') from dual)as priorityOfReq  FROM HIVT_REQUISITION_HEADER A WHERE gnum_isvalid \= 1 AND GNUM_HOSPITAL_CODE  \= ? AND GNUM_LAB_CODE IN ( SELECT GNUM_LAB_CODE FROM HIVT_LAB_COLLECTION_AREA_MST WHERE GNUM_ISVALID \= 1 AND gnum_hospital_Code  \= ? AND GNUM_AREA_CODE \= ? ) AND gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id  \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name  \= 'GNUM_LAB_CODE' AND p.gnum_seatid  \= ? AND p.gnum_hospital_code  \= ? ) AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS IN (?) AND GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO )


#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )  
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?  and exists  ( SELECT 1 FROM gblt_role_seat_table_dtl p  where gnum_column_value\=? and p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_COLLECTION_AREA_MST'  AND p.gstr_column_name \= 'GNUM_AREA_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )  
  														
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and exists (SELECT 1 FROM gblt_role_seat_table_dtl p  where gnum_column_value=? and p.gbl_isvalid=1  AND  p.gnum_module_id = ?  AND p.gstr_table_name = 'HIVT_COLLECTION_AREA_MST'  AND p.gstr_column_name = 'GNUM_AREA_CODE'   AND p.gnum_hospital_code = ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )  
  																	  

# Sample Acceptance Process Added By Pathan Basha


SELECT_SAMPLE_ACCEPTANCE_LAB_COMBO_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \=?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
                                                        
                                                        
#SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL= SELECT (select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status \= ? AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY'))  
#SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL= SELECT nvl(gnum_machine_code,'-1') as defaultmachineCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id,(select hivtstr_labno_format from hivt_labno_conf_mst where gnum_is_valid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_lab_code\=a.gnum_lab_code and gnum_test_code in (-1,a.gnum_test_code) and gnum_pat_type in(3,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code))) as islabnoconfig FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status \= ? AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY'))  
SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL= SELECT gnum_machine_code as machineCode,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=((select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code)) and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code as groupCode, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id,(select hivtstr_labno_format from hivt_labno_conf_mst where gnum_is_valid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_lab_code\=a.gnum_lab_code and gnum_test_code in (-1,a.gnum_test_code) and gnum_pat_type in(3,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code))) as islabnoconfig FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status in (?) AND TRUNC (HIVDT_coll_DATE_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (HIVDT_coll_DATE_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY'))

#SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL_NON_ACC=SELECT (select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=a.gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code as groupCode, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id,(select hivtstr_labno_format from hivt_labno_conf_mst where gnum_is_valid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_lab_code\=a.gnum_lab_code and gnum_test_code in (-1,a.gnum_test_code) and gnum_pat_type in(3,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code))) as islabnoconfig FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status in (?,17) AND TRUNC (HIVDT_coll_DATE_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (HIVDT_coll_DATE_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and hivnum_packing_list_no is not null
SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL_NON_ACC=SELECT (select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=a.gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code as groupCode, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status in (?,17) AND TRUNC (HIVDT_coll_DATE_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (HIVDT_coll_DATE_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and hivnum_packing_list_no is not null

#SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL_NON_ACC=SELECT nvl(gnum_machine_code,'-1') as defaultmachineCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id,(select hivtstr_labno_format from hivt_labno_conf_mst where gnum_is_valid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_lab_code\=a.gnum_lab_code and gnum_test_code in (-1,a.gnum_test_code) and gnum_pat_type in(3,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code))) as islabnoconfig FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status in (?,17) AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY'))

                                
SELECT.CHECKDAILYLABNODUPLICACY.FORSAMPLEACCEPTANCE=select count(*) from hivt_requisition_dtl where gnum_hospital_code\=? and trunc(hivt_entry_date)\=trunc(sysdate) and UPPER(hgstr_daily_labno) \= UPPER(?)\t\t\t\t                                             
SELECT.SAMPLE_ACCCOMBO_HIVT_REJECTIONREASON_MST=Select hgnum_rejectionreason_id as rejectionId, hgstr_rejectionreason as rejectionReason from HIVT_REJECTIONREASON_MST where gnum_isvalid\=1 and HIVNUM_ACCEPTANCE_TYPE in (1,3)
        
UPDATE.SAMPLEACCDETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=?, hivnum_issample_received\=?, hivnum_isaccepted\=?, HIVDT_ACCEPTANCE_DATE_TIME\=SYSDATE,HIVDT_ACCEPTANCE_SEATID\=?,HGSTR_DAILY_LABNO\=?,gnum_machine_code\=?  WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
												   
UPDATE.SAMPLE_NOTACC_DETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=? ,hivnum_issample_received\=?, hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, hivtdt_cancellation_date\=SYSDATE, hivtnum_cancellation_seatid\=?, hivnum_isaccepted\=? WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
												   
UPDATE.SAMPLE_RESCHEDULED_ACCDETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=? ,hivnum_issample_received\=?, hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, HIVNUM_RESHEDULE_SEATID\=?,HIVDT_RESHEDULE_DATE\=SYSDATE, hivnum_isaccepted\=?  WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?\t\t\t\t\t\t\t\t\t\t\t\t   \t\t\t\t\t\t\t\t\t\t\t\t      

UPDATE.SAMPLEACCDETAIL.HIVT_SAMPLE_DTL=UPDATE hivt_sample_dtl    SET  hivdt_acceptance_date_time\=SYSDATE, hivdt_acceptance_seatid\=?, hgstr_daily_labno\=? WHERE hivnum_sample_no\=?  AND hivtnum_req_dno\=?


UPDATE.SAMPLE_NOTACC_DETAIL.HIVT_SAMPLE_DTL=UPDATE hivt_sample_dtl    SET  hivdt_rejection_date_time\=SYSDATE, hivnum_sam_rejection_seatid\=?, hivnum_sam_rejection_action\=?,  hivnum_sam_rejection_reason\=?  WHERE hivnum_sample_no\=?  AND hivtnum_req_dno\=?

UPDATE.SAMPLEACCDETAIL.HIVT_PACKING_LIST_DTL=UPDATE hivt_packing_list_dtl   SET   hivbl_list_status=?  WHERE hivnum_packing_list_no=?  

UPDATE.SAMPLE_RECIEVE_NO_DETAIL.HIVT_REQUISITION_DTL=UPDATE   hivt_requisition_dtl  SET hivnum_reqdtl_status\=? ,hivdt_acceptance_date_time\=SYSDATE, hivdt_acceptance_seatid\=?,    hivnum_issample_received\=?,hivnum_isaccepted\=?  WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
                                                      
                                                      
SELECT.SAMPLE_ACCEPTANCE_PACKING_LIST_ON_LOAD_HIVT_REQUISITION_DTL=SELECT gnum_machine_code as machineCode,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=((select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code)) and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,(select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code) as defaultmachineCode,nvl(hgnum_group_code,'0') as groupCode,(select hminum_machine_id from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as machineCode,(select gstr_sample_short_name from hivt_sample_mst b where b.gnum_sample_code\=a.gnum_sample_code)as shortSampleName,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender  ,hivtnum_req_dno as requisitionDNo, hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, TO_CHAR(hivdt_coll_date_time,'dd-Mon-yyyy') as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl  a WHERE gnum_hospital_code\=? and  hivnum_reqdtl_status \= 4 AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (SYSDATE, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (SYSDATE, 'DD-MON-YYYY')) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  order by groupcode,machinename ,hivtnum_req_dno  
 
SELECT.SAMPLE_ACCEPTANCE_PACKING_LIST_FOR_CHECK_PACKNO_HIVT_REQUISITION_DTL=SELECT count(*) FROM hivt_requisition_dtl a WHERE hivnum_packing_list_no\=? and gnum_hospital_code\=? and hivnum_reqdtl_status \= 4  
                                        
                                        
SELECT.SAMPLE_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select gnum_lab_code as labCode,gdt_initialization_date as initDate, gnum_pat_type as patType,gnum_sq_no as seqNo,gnum_sq_no as configSeq, gnum_hospital_code,gnum_no_of_seq_digits, nvl(gnum_machine_code,'-1') as machineCode, nvl(gnum_test_code,'-1') as testCode ,hivtstr_labno_format as labNoFormat,gdt_entry_date as entryDate, gdt_reinit_date as reInitDate,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_machine_code in( -1,?) and gnum_pat_type in(3,?\:\:numeric) AND gnum_is_valid\=1 and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   
															
SELECT.SAMPLEACC.LABNODATEGEN.FROM.DUAL=  select TO_CHAR(SYSDATE,?)  from dual;

UPDATE.SAMPLEACCDETAIL.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_test_code \=? and gnum_machine_code \=? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?

UPDATE.SAMPLEACCDETAIL.RESET_RUNNING_LABNO.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code \=? and gnum_machine_code \=? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?


															              
UPDATE.PATIENTACCDETAIL.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET gdt_initialization_date\=?\:\:timestamp without time zone,    hivstr_running_lab_no\=? where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code\=? AND gnum_hospital_code\=? and gnum_pat_type\=? and gnum_sq_no\=?     \t\t\t\t

UPDATE.PATIENTACCDETAIL.RESET_RUNNING_LABNO.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET      hivstr_running_lab_no\=null where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code\=? AND gnum_hospital_code\=? and gnum_pat_type\=? and gnum_sq_no\=?     \t\t

SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.AJAX.CHECK.HIVT_LABNO_CONF_MST=select   hivstr_running_lab_no as runningLabNo     from hivt_labno_conf_mst  where gnum_is_valid\=1  and  gnum_lab_code\=? and gnum_test_code\=? AND  gnum_hospital_code\=? and gnum_pat_type\=? and gnum_sq_no\=?    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                 
SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.AJAX.CHECK.HIVT_LABNO_CONF_MST_AREA_WISE=select   hivstr_running_lab_no as runningLabNo     from hivt_labno_conf_mst  where gnum_is_valid\=1  and  gnum_lab_code\=? and gnum_test_code\=? AND  gnum_hospital_code\=? and gnum_pat_type\=? and gnum_sq_no\=? and acceptance_area\=?   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t      
															

#SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select  gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest, hivtstr_labno_format as labNoFormat ,  gdt_initialization_date as initDate  ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1  and gnum_hospital_code=? order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                 
#SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient\#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (?,?) and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=? order by HIVTNUM_REQ_DNO  
#SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient\#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (?,?) and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=? and exists ((select 1 from hivT_laboratory_test_mst e where e.gnum_isvalid\=1 and e.gnum_hospital_code\=a.gnum_hospital_code and e.gnum_labcode\=a.gnum_lab_code and e.gnum_test_code\=a.gnum_test_code  )) and exists ((select 1 from hivT_test_mst l where l.gnum_isvalid\=1  and l.gnum_test_code\=a.gnum_test_code  )) order by HIVTNUM_REQ_DNO  
SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient\#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(Select nvl(gnum_isdept_print_barcode,'0') from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1) as is_dept_barcode_print from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (?,?) and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=? and exists ((select 1 from hivT_laboratory_test_mst e where e.gnum_isvalid\=1 and e.gnum_hospital_code\=a.gnum_hospital_code and e.gnum_labcode\=a.gnum_lab_code and e.gnum_test_code\=a.gnum_test_code  )) and exists ((select 1 from hivT_test_mst l where l.gnum_isvalid\=1  and l.gnum_test_code\=a.gnum_test_code  )) order by HIVTNUM_REQ_DNO  


#SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select  gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest, hivtstr_labno_format as labNoFormat ,  gdt_initialization_date as initDate  ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1  and gnum_hospital_code\=? order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                 
#SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (?,?) and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=? order by HIVTNUM_REQ_DNO  
SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select  nvl((islabnoareawise),'0') as islabNoAreaWise,gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest, hivtstr_labno_format as labNoFormat ,  gdt_initialization_date as initDate  ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo,acceptance_area as  sampleAreaCode from hivt_labno_conf_mst  where  gnum_lab_code\=? and gnum_test_code in( -1 ,?) and acceptance_area is null AND gnum_is_valid\=1  and gnum_hospital_code\=? order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST_AREA_WISE=select  nvl((islabnoareawise),'0') as islabNoAreaWise,gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest, hivtstr_labno_format as labNoFormat ,  gdt_initialization_date as initDate  ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo,acceptance_area as  sampleAreaCode from hivt_labno_conf_mst  where  acceptance_area\=? and gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1  and gnum_hospital_code\=? order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
									  
SELECT.UOM_COMBO.HIVT_UOM_MST= select GNUM_UOM_CODE as uomCode,INITCAP(gstr_uom) as uomName from HIVT_UOM_MST WHERE GNUM_ISVALID=1	

SELECT.CONTAINER_COMBO.HIVT_CONTAINER_MST= select GNUM_CONTAINER_CODE,INITCAP(GSTR_CONTAINER_NAME) from HIVT_CONTAINER_MST WHERE GNUM_ISVALID=1	

SELECT.SAMPLENO.SYS_SAMPLE_MAINTAINER=Select NVL((Select  MAX(HIVTNUM_SAMPLENO_SEQUENCE) from SYS_SAMPLE_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_SAMPLE_CODE \= ? and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual

INSERT.SAMPLENO.SYS_SAMPLE_MAINTAINER=INSERT INTO SYS_SAMPLE_MAINTAINER( gnum_laboratory_code,GNUM_SAMPLE_CODE, gnum_hospital_code, HIVTNUM_SAMPLENO_SEQUENCE, gnum_yymmdd) VALUES (?, ?, ?, ?,?);

UPDATE.SAMPLENO.SYS_SAMPLE_MAINTAINER= UPDATE SYS_SAMPLE_MAINTAINER SET  HIVTNUM_SAMPLENO_SEQUENCE=?   WHERE gnum_yymmdd=TO_CHAR(SYSDATE,'YYMMDD')and gnum_laboratory_code=? and gnum_sample_code=? and  gnum_hospital_code=?

UPDATE.PATDTLS.HIVT_REQUISITION_HEADER=UPDATE HIVT_REQUISITION_HEADER SET  HRGSTR_MOBILE_NO=?  , HRGSTR_EMAIL_ID= ? , HIVSTR_ADDRESS = ? where GNUM_ISVALID=1 and gnum_hospital_code = ? and HIVNUM_REQ_NO=?

UPDATE.REQDTLS.HIVT_REQUISITION_DTLS=UPDATE HIVT_REQUISITION_DTL SET HIVNUM_REQDTL_STATUS\=? , HIVNUM_SAMPLE_NO\= ? , GNUM_BILL_NO\=?, HIVNUM_TEMP_SAMPLE_NO\=? , HIVDT_COLL_DATE_TIME\=SYSDATE, HIVNUM_COLLECTION_SEATID\=? , HIVNUM_SAMPLE_COL_AREA_CODE\=?,hivnum_uom\=?,hivnum_containercode\=?,hivnum_collected_volume\=?  where GNUM_HOSPITAL_CODE\=? and  HIVTNUM_REQ_DNO\= ?
  
INSERT.SAMPLEDTLS.HIVT_SAMPLE_DTL=INSERT INTO hivt_sample_dtl(hivnum_sample_no, gnum_hospital_code, hivtnum_req_dno,  \
								  hivnum_sample_col_area_code, hivdt_coll_date_time, hivnum_collection_seatid, \
						            hivnum_print_status, hivnum_collected_volume, hgnum_sample_code, \
						            hivnum_uom, hivnum_containercode,  \
						            hivtnum_typeofcomponent, gnum_seat_id, hivnum_sam_status_code, \
						            hivdt_entry_date, hivnum_temp_sample_no) \
								    VALUES (?, ?, ?, ?,  \
								            SYSDATE, ?, ?,  \
								            ?, ?, ?,  \
								            ?, ?, ?,  \
								            ?, SYSDATE, ?  \
										);
										
SELECT.TEMP_SAMPLE_NO.HIVT_SAMPLE_DTL=select count(*)from hivt_sample_dtl where HIVNUM_SAMPLE_COL_AREA_CODE\=? and trunc(HIVDT_ENTRY_DATE)\=trunc(sysdate) and UPPER(HIVNUM_TEMP_SAMPLE_NO) \= UPPER(?)\t
SELECT.LAB_COMBO.HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in ( Select gnum_lab_code from HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= ?) and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m

SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL=Select (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND A.hivnum_sample_col_area_code \= ?  \t\t\t\t\t\t\t\t\t
#SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL_MACHINE=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND A.gnum_machine_code \= ?  \t\t\t\t\t\t\t\t\t
SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL_MACHINE=Select (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY'))  and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND A.gnum_machine_code \= ?  \t\t\t\t\t\t\t\t\t

#SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  \t\t\t\t\t\t\t\t\t
#SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) \t\t\t\t\t\t\t\t\t



SELECT.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER=Select NVL((Select  MAX(HIVTNUM_PACKINGLISTNO_SEQUENCE) from SYS_PACKINGLIST_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 1000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
 											
INSERT.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER=INSERT INTO SYS_PACKINGLIST_MAINTAINER( gnum_laboratory_code,gnum_hospital_code, HIVTNUM_PACKINGLISTNO_SEQUENCE, GNUM_YYMMDD) VALUES (?, ?, ?,?)

UPDATE.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER= UPDATE SYS_PACKINGLIST_MAINTAINER SET  HIVTNUM_PACKINGLISTNO_SEQUENCE=?   WHERE GNUM_YYMMDD=TO_CHAR(SYSDATE,'YYMMDD')and GNUM_LABORATORY_CODE=? and  GNUM_HOSPITAL_CODE=?

UPDATE.PACKINGLISTNO.HIVT_REQUISITION_DTLS= UPDATE HIVT_REQUISITION_DTL SET HIVNUM_REQDTL_STATUS=? , HIVNUM_PACKING_LIST_NO=?,HIVNUM_PACKING_LIST_SEAT_ID=?, HIVTDT_PACKINGLIST_DATE_TIME=SYSDATE where GNUM_HOSPITAL_CODE=? and  HIVTNUM_REQ_DNO= ?

UPDATE.PACKINGLISTNO.HIVT_SAMPLE_DTL=  UPDATE HIVT_SAMPLE_DTL SET HIVNUM_SAM_STATUS_CODE=?,HIVNUM_PACKING_LIST_NO=? WHERE HIVNUM_SAMPLE_NO= ? AND GNUM_HOSPITAL_CODE=?

INSERT.PACKINGLISTDTLS.HIVT_PACKING_LIST_DTL=INSERT INTO hivt_packing_list_dtl( \
            										hivnum_packing_list_no, hivbl_list_status, hivnum_seat_id, hivdt_entry_date, \
            										hivnum_ispackinglist_offline,gnum_hospital_code) \
    												VALUES (?, ?, ?, SYSDATE,  \
           											?,?)
           											
SELECT.HIVNUM_PACKING_LIST_NO.HIVT_REQUISITION_DTL=SELECT HIVNUM_PACKING_LIST_NO FROM HIVT_REQUISITION_DTL WHERE HIVTNUM_REQ_DNO=? AND GNUM_HOSPITAL_CODE=?           											

#modified to add hos code
#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1=select        gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest,hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType   from hivt_sampleno_conf_mst1  where  gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?)  and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1=select        gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest,hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType,(Select nvl(gnum_isdept_print_barcode,'0') from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1) as is_dept_barcode_print,INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,(Select gnum_dept_code from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1))) as departmentName   from hivt_sampleno_conf_mst1  a where  gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?)  and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc


#modified to add hos code
UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET   gdt_initialization_date\=?\:\:timestamp without time zone  ,hivstr_running_lab_no\=? where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code \=? and gnum_pat_type\=? and gnum_hospital_code\=? and gnum_sq_no\=?
#modified to add hos code
#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code in (-1,?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code\=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType,(Select nvl(gnum_isdept_print_barcode,'0') from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1) as is_dept_barcode_print,INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,(Select gnum_dept_code from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1))) as departmentName   from hivt_colarea_samno_config_mst a  where gnum_lab_code in (-1,?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code\=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc

#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_SAMPLENO_CONF_MST1=select   hivstr_running_lab_no as runningSampleNo from hivt_sampleno_conf_mst1  where gnum_lab_code\=? and gnum_test_code \=?\t and gnum_pat_type \=? AND gnum_is_valid\=1   and gnum_hospital_code\=? and gnum_sq_no\=?
#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_COLAREA_SAMNO_CONFIG_MST=select    hivstr_running_lab_no as runningSampleNo     from hivt_colarea_samno_config_mst  where gnum_lab_code\=?   and gnum_area_code\=?  and gnum_pat_type \=?  AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?    

#modified to add hos code
UPDATE.SAMPLECOllDETAIL.RESET.RUNNING.NO.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET    hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code \= ? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=? 

															
															
UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?  \t\t\t\t\t\t\t\t\t\t\t\t\t\t 



UPDATE.SAMPLECOLLDETAIL.RESET.RUNNING.NO.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=? \t\t\t\t\t\t\t\t\t\t\t\t\t\t 



#SELECT_LAB_COMBO_FOR_RESULT_ENTRY_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
SELECT_LAB_COMBO_FOR_RESULT_ENTRY_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName, m.patTestType FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name as labName, hgnum_pat_test_type as patTestType from hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ? AND p.gnum_hospital_code \= ?) order by departmenName,labName)m
SELECT.RESULT_ENTRY_HIVT_REQUISITION_HEADER_ALL=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,(select distinct(istestmodify) from hivt_laboratory_mst q where q.gnum_lab_code\=a.gnum_lab_code and q.gnum_hospital_code\=a.gnum_hospital_code)as islabtestmodify,is_addendum as isAddendum,hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,   pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder, to_char(hivdt_coll_date_time, 'DD-MM-YYYY hh\:mm') AS sampleColDate,(select hrgstr_visit_reason from hivt_requisition_header where hivnum_req_no \= a.hivnum_req_no and gnum_hospital_code \= a.gnum_hospital_code) as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and a.has_permission in (0,?)
SELECT.RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,(select distinct(istestmodify) from hivt_laboratory_mst q where q.gnum_lab_code\=a.gnum_lab_code and q.gnum_hospital_code\=a.gnum_hospital_code)as islabtestmodify,is_addendum as isAddendum,hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,    pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder, to_char(hivdt_coll_date_time, 'DD-MM-YYYY hh\:mm') AS sampleColDate,(select hrgstr_visit_reason from hivt_requisition_header where hivnum_req_no \= a.hivnum_req_no and gnum_hospital_code \= a.gnum_hospital_code) as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  AND A.hivnum_sample_col_area_code \= ?  and a.has_permission in (0,?)
SELECT.RESULT_ENTRY_COLL_DATE_HIVT_REQUISITION_HEADER=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,is_addendum as isAddendum,hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) , pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder, to_char(hivdt_coll_date_time, 'DD-MM-YYYY hh\:mm') AS sampleColDate,(select hrgstr_visit_reason from hivt_requisition_header where hivnum_req_no \= a.hivnum_req_no and gnum_hospital_code \= a.gnum_hospital_code) as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  AND A.hivnum_sample_col_area_code \= ? and a.has_permission in (0,?) \t\t\t\t\t\t\t\t
SELECT.RESULT_ENTRY_COLL_DATE_HIVT_REQUISITION_HEADER_ALL=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,is_addendum as isAddendum,hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,  pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder, to_char(hivdt_coll_date_time, 'DD-MM-YYYY hh\:mm') AS sampleColDate,(select hrgstr_visit_reason from hivt_requisition_header where hivnum_req_no \= a.hivnum_req_no and gnum_hospital_code \= a.gnum_hospital_code) as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   and a.has_permission in (0,?)

#SELECT.RESULT_ENTRY_COLL_DATE_HIVT_REQUISITION_HEADER=Select a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,NVL(concatstring(   'Select k.hivnum_parameter_code||''#@''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#@''||hivstr_ref_range||''#@''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||''' order by hivtnum_order asc' ,  '`' ),'-1#@-#@-#@-') AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid=1 and gnum_lab_code=a.gnum_lab_code and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkReqd,(select hivstr_final_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag  FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =?  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code = ?)   and  TRUNC (a.hivdt_coll_date_time) >= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivdt_coll_date_time) <= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no=b.hivnum_req_no AND a.gnum_hospital_code=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)

											                                                    
#UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?,hrgstr_visit_reason_reqd\=?,hivnum_validator_reqd\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?
UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?,  hivnum_reqdtl_status\=?,hrgstr_visit_reason_reqd\=?,hivnum_validator_reqd\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?

#UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?, hivnum_validator\=? WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?
												
INSERT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=INSERT INTO hivt_parameter_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    \
                                           hivnum_parameter_code, gnum_isvalid,hivstr_loinc_string,hivstr_ref_range,hivtnum_order,hivt_upload_filedata,hivt_upload_filename)    \
                                                 VALUES (?, ?, ?,?, SYSDATE, ?, ?,?, ?,?,?,?,?,?);
													 

SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL=Select (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and gnum_area_code\=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND A.hivnum_sample_col_area_code \= ?   \t\t\t\t\t\t\t\t\t\t\t\t

SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL_MACHINE=Select (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND A.gnum_machine_code \= ?   \t\t\t\t\t\t\t\t\t\t\t\t

#SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and gnum_area_code\=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )   \t\t\t\t\t\t\t\t\t
#SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and exists  ( SELECT 1 FROM gblt_role_seat_table_dtl p  where gnum_column_value=103 and p.gbl_isvalid=1  AND  p.gnum_module_id = ?  AND p.gstr_table_name = 'HIVT_COLLECTION_AREA_MST'  AND p.gstr_column_name = 'GNUM_AREA_CODE' AND p.gnum_seatid = ?  AND p.gnum_hospital_code = ? )  \t\t\t\t\t\t\t\t\t


SELECT.TEMPLATE_PROCESSING.LOINC_CODE = SELECT hivstr_loinc_string as loincCode FROM hivt_loinc_mapping_mst where gnum_isvalid\=1 and hivnum_test_code\=? and hivnum_parameter_code\=? and hivnum_sample_code \= ? and hivnum_uom_code \= ? 
 
 
 
 
 
 
 SELECT.HIVT_PARAMETER_DTL.WORKORDERRESULTENTRYDATA.RESULTVALIDATIONPROCESS = SELECT concat(HIVTNUM_TEST_CODE,hivnum_parameter_code), HIVTSTR_VALUE , hivtnum_parent_parameter_code FROM hivt_parameter_dtl hpd WHERE gnum_isvalid=1 and hpd.hivtnum_req_dno =? and gnum_hospital_code=?																		

# for requisition form 
 SELECT.HIVT_REQUISITIONFORM_DTL.WORKORDERRESULTENTRYDATA.RESULTVALIDATIONPROCESS = SELECT concat(HIVTNUM_TEST_CODE,hivnum_parameter_code), HIVTSTR_VALUE , hivtnum_parent_parameter_code FROM hivt_requisitionform_dtl hpd WHERE gnum_isvalid=1 and hpd.hivtnum_req_dno =? and hpd.hivtnum_lab_code =? and  hpd.hivtnum_test_code =? and gnum_hospital_code=?																		



UPDATE.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=update hivt_parameter_dtl set hivtstr_value=? , gnum_lstmod_seatid=?,gdt_lstmod_date=SYSDATE where gnum_isvalid=1 and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and hivtnum_parent_parameter_code = ? and gnum_hospital_code=?
SELECT.RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,NVL(concatstring(   'Select k.hivnum_parameter_code||''\#@''||  nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code),''NA'')||''\#@''||hivstr_ref_range||''\#@''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||''' order by hivtnum_order asc' ,  '`' ),'-1\#@-\#@-\#@-') AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag, DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,b.hrgstr_visit_reason as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate,decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  A.hivnum_sample_col_area_code \=? AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)

SELECT.RESULT_VALIDATION_HIVT_REQUISITION_HEADER_ALL=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,(select String_agg(gnum_parameter_code||'\#@'||nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.gnum_parameter_code),'NA')||'\#@'||(select decode(gnum_range_type,'4',gnum_range_type||'$'||hgstr_range_value_uom||'$'||hgstr_range_value||'$null',1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null',2,1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null',3,1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null') from hivt_test_mand_ref_val_mst o where o.gnum_test_code\=k.gnum_test_code and o.gnum_parameter_code\=k.gnum_parameter_code limit 1)||'\#@'||(select decode(hivtstr_value,'--','',hivtstr_value) from hivt_parameter_dtl p where  p.gnum_isvalid\=1 and p.hivtnum_test_code \=k.gnum_test_code   and p.hivtnum_req_dno\=a.hivtnum_req_dno and p.gnum_hospital_code\=a.gnum_hospital_code and p.hivnum_parameter_code\=gnum_parameter_code)||'\#@','`' ORDER BY hivt_num_element_sequence) from hivt_test_parameter_mst k where gnum_test_code\=a.gnum_test_code and gnum_isvalid\=1 ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,b.hrgstr_visit_reason as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)

SELECT.RESULT_VALIDATION_COLL_DATE_HIVT_REQUISITION_HEADER=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id=gnum_machine_code and ss.gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_is_valid=1 and hgnum_group_code=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_is_valid=1 and  hgnum_group_code=a.hgnum_group_code))::numeric as grp,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,NVL(concatstring(   'Select k.hivnum_parameter_code||''#@''||  nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code),''NA'')||''#@''||hivstr_ref_range||''#@''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||''' order by hivtnum_order asc' ,  '`' ),'-1#@-#@-#@-') AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid=1 and gnum_lab_code=a.gnum_lab_code and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code=a.gnum_hospital_code and u.gnum_isvalid=1 and u.hgnum_group_code=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,b.hrgstr_visit_reason as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid=1 and p.gnum_hospital_code=a.gnum_hospital_code and p.gnum_lab_code=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code=a.gnum_lab_code and gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid = 1 and hrgnum_puk=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid = 1 and hivnum_req_no=a.hivnum_req_no AND gnum_hospital_code = a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =?  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code = ?)   and  TRUNC (a.hivdt_coll_date_time) >= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivdt_coll_date_time) <= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  A.hivnum_sample_col_area_code =? AND a.hivnum_req_no=b.hivnum_req_no AND a.gnum_hospital_code=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)

SELECT.RESULT_VALIDATION_COLL_DATE_HIVT_REQUISITION_HEADER_ALL=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=a.hgnum_group_code))\:\:numeric as grp,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,NVL(concatstring(   'Select k.hivnum_parameter_code||''\#@''||  nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code),''NA'')||''\#@''||hivstr_ref_range||''\#@''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||''' order by hivtnum_order asc' ,  '`' ),'-1\#@-\#@-\#@-') AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code\=a.gnum_hospital_code and u.gnum_isvalid\=1 and u.hgnum_group_code\=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,b.hrgstr_visit_reason as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code\=a.gnum_lab_code and gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code\=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid \= 1 and hrgnum_puk\=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid \= 1 and hivnum_req_no\=a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and  TRUNC (a.hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)

#SELECT.APT_BASED_DETAIL.HAPT_APPOINTMENT_DTL= SELECT hapnum_apt_no as aptNo, hrgnum_puk as pukNo, hrgnum_episode_code as episodeCode, NVL(hapstr_pat_first_name,'-') as patFirstName, NVL(hapstr_pat_middle_name,'') as PatMiddleName, NVL(hapstr_pat_last_name,'') as patLastNAme, hapstr_patient_fname, NVL(gstr_gender_code,'-') as gender, hapdt_patient_dob as patDob,to_char(hapdt_appointment_date,'dd-Mon-yyyy') AS aptdate, hapstr_email as email, hapstr_mobile_no mobileNo, gnum_isvalid,  habnum_appt_queue_no as apptQueueNo,   NVL(hapstr_slot_time,'-') as slotTime, hapnum_apt_status as aptStatus, hapstr_statusremarks as statusRemarks, hapnum_slot_type as slotType,  hapstr_remarks as remarks, hapnum_appt_type_id as aptId,   hapnum_appt_mode as aptMode, hapstr_mod_specific_key_name as specificKeyName, NVL(hapstr_patage,'-') as patAge,  hapstr_spousename as spouseName, hapnum_shift_id as shiftId, NVL(hapstr_slot_start_time,'-') as slotSatrtTime, hapstr_slot_end_time,  hapstr_slot_duration, hapstr_old_start_time, hapdt_old_appt_date,  hapstr_old_duration,  hapnum_isbooked_by_vip,  hapnum_actual_para_refid, hrgnum_visit_no,hapstr_actual_para_id_1 as labCode,hapstr_actual_para_id_2 as testCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=hapstr_actual_para_id_2) as testName FROM hapt_appointment_dtl where gnum_isvalid \=1 and  hapnum_apt_id in (2,4)   and gnum_hospital_code\= ?  and hapnum_apt_status in(1,2)  AND hapstr_actual_para_id_1 IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \=?  AND gnum_hospital_code \=?)  and hapstr_actual_para_id_1 like '%' and hapstr_actual_para_id_2 like'%'  AND hapdt_appointment_date\=TO_DATE(SYSDATE,'dd-Mon-YYYY')
#SELECT.APT_BASED_DETAIL.HAPT_APPOINTMENT_DTL=SELECT (select gstr_lab_name from hivt_laboratory_mst s where gnum_lab_code=hapstr_actual_para_id_1 and s.gnum_hospital_code=aptdtl.gnum_hospital_code )as labName,(decode(hapnum_apt_id,4,'Investigation Lab Wise',2,'Investigation Lab Test Wise')) as aptTyp,hapnum_apt_no as aptNo, hrgnum_puk as pukNo, hrgnum_episode_code as episodeCode, NVL(hapstr_pat_first_name,'-') as patFirstName, NVL(hapstr_pat_middle_name,'') as PatMiddleName, NVL(hapstr_pat_last_name,'') as patLastNAme, hapstr_patient_fname, NVL(gstr_gender_code,'-') as gender, hapdt_patient_dob as patDob,to_char(hapdt_appointment_date,'dd-Mon-yyyy') AS aptdate, hapstr_email as email, hapstr_mobile_no mobileNo, gnum_isvalid,  habnum_appt_queue_no as apptQueueNo,   NVL(hapstr_slot_time,'-') as slotTime, hapnum_apt_status as aptStatus, hapstr_statusremarks as statusRemarks, hapnum_slot_type as slotType,  hapstr_remarks as remarks, hapnum_appt_type_id as aptId,   hapnum_appt_mode as aptMode, hapstr_mod_specific_key_name as specificKeyName, NVL(hapstr_patage,'-') as patAge,  hapstr_spousename as spouseName, hapnum_shift_id as shiftId, NVL(hapstr_slot_start_time,'-') as slotSatrtTime, hapstr_slot_end_time,  hapstr_slot_duration, hapstr_old_start_time, hapdt_old_appt_date,  hapstr_old_duration,  hapnum_isbooked_by_vip,  hapnum_actual_para_refid, hrgnum_visit_no,hapstr_actual_para_id_1 as labCode,hapstr_actual_para_id_2 as testCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=hapstr_actual_para_id_2) as testName FROM hapt_appointment_dtl aptdtl where gnum_isvalid =1 and  hapnum_apt_id in (2,4)   and gnum_hospital_code= 10911  and hapnum_apt_status in(1,2)  AND hapstr_actual_para_id_1 IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid = 1 AND p.gnum_module_id =15 AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid =10001  AND gnum_hospital_code =10911)  and hapstr_actual_para_id_1 like '%' and hapstr_actual_para_id_2 like'%'  AND hapdt_appointment_date=TO_DATE(SYSDATE,'dd-Mon-YYYY') and hrgnum_puk is not null
SELECT.APT_BASED_DETAIL.HAPT_APPOINTMENT_DTL= SELECT (select gstr_lab_name from hivt_laboratory_mst s where gnum_lab_code\=hapstr_actual_para_id_1 and s.gnum_hospital_code\=aptdtl.gnum_hospital_code )as labName,(decode(hapnum_apt_id,4,'Investigation Lab Wise',2,'Investigation Lab Test Wise')) as aptTyp,hapnum_apt_no as aptNo, hrgnum_puk as pukNo, hrgnum_episode_code as episodeCode, NVL(hapstr_pat_first_name,'-') as patFirstName, NVL(hapstr_pat_middle_name,'') as PatMiddleName, NVL(hapstr_pat_last_name,'') as patLastNAme, hapstr_patient_fname, NVL(gstr_gender_code,'-') as gender, hapdt_patient_dob as patDob,to_char(hapdt_appointment_date,'dd-Mon-yyyy') AS aptdate, hapstr_email as email, hapstr_mobile_no mobileNo, gnum_isvalid,  habnum_appt_queue_no as apptQueueNo,   NVL(hapstr_slot_time,'-') as slotTime, hapnum_apt_status as aptStatus, hapstr_statusremarks as statusRemarks, hapnum_slot_type as slotType,  hapstr_remarks as remarks, hapnum_appt_type_id as aptId,   hapnum_appt_mode as aptMode, hapstr_mod_specific_key_name as specificKeyName, NVL(hapstr_patage,'-') as patAge,  hapstr_spousename as spouseName, hapnum_shift_id as shiftId, NVL(hapstr_slot_start_time,'-') as slotSatrtTime, hapstr_slot_end_time,  hapstr_slot_duration, hapstr_old_start_time, hapdt_old_appt_date,  hapstr_old_duration,  hapnum_isbooked_by_vip,  hapnum_actual_para_refid, hrgnum_visit_no,hapstr_actual_para_id_1 as labCode,hapstr_actual_para_id_2 as testCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=hapstr_actual_para_id_2) as testName FROM hapt_appointment_dtl aptdtl where gnum_isvalid \=1 and  hapnum_apt_id in (2,4)   and gnum_hospital_code\= ?  and hapnum_apt_status in(1,2)  AND hapstr_actual_para_id_1 IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \=?  AND gnum_hospital_code \=?)  and hapstr_actual_para_id_1 like '%' and hapstr_actual_para_id_2 like'%'  AND hapdt_appointment_date\=TO_DATE(SYSDATE,'dd-Mon-YYYY') and hrgnum_puk is not null\t\t\t\t\t\t\t\t\t\t\t \t\t
											 		
											 		
INSERT.RESULT.ENTRY.DETAIL.HIVT_JOBWORKORDER_DATA=INSERT INTO hivt_jobworkorder_data(hivnum_reqorcr_no, hivnum_req_dno, hivnum_updation_type, gnum_status_code,  \
												            hivdt_entry_date,  gnum_hospital_code, hivnum_req_no,  \
												             hrgnum_puk, hivt_requisition_date,    gnum_test_code,   \
												              gnum_current_lab_code, hivnum_sample_code,  \
												            hivstr_pat_age, gnum_gender_code, hgnum_parameter_code, hgnum_reportgenerationafter,  \
												            hivtstr_result_value,hgnum_visit_date,hgnum_visitno,hgnum_lab_no,hrgnum_episode_code,hgnum_dept_code,hgnum_deptunitcode,hbnum_requisition_type,hgstr_testname,hgstr_labname,hgstr_samplename,hgnum_temp_sampleno, hgnum_group_code)  \
												           VALUES (?, ?, ?, ?, SYSDATE, ?,  ?,?, SYSDATE, ?,?, ?, ?,?, ?, ?, ?,TRUNC (TO_DATE (?, 'DD-Mon-YYYY')),?,?,?,?,?,?,?,?,?,?,?)
												           
									        
											 																							
INSERT.HIVT_REQUSITION_TEST_MANDATORY_DTL=INSERT INTO hivt_requsition_test_mandatory_dtl(hivtnum_req_dno, gnum_test_code, hgnum_mand_code, hivstr_value,  \
										            hivnum_seatid, hivnum_entry_date, gnum_hospital_code, gnum_isvalid)   \
										    VALUES (?, ?, ?, ?,?,SYSDATE, ?, ?);
										    
										    
										    
	
#Changed By Prashant
SELECT.ONLOAD_HIVT_REQUISITION_HEADER=Select (select hapnum_apt_id from hapt_appointment_dtl  where hapnum_apt_no\= (select hapnum_app_ref_no  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) and hapnum_apt_id\=4) as apttype,(select hivstr_appointment_time  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) as apttime,HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||'/'|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory,(select  array_agg(gstr_test_name)  from  hivt_test_mst x, HIVT_REQUISITION_DTL y where x.gnum_test_code\=y.gnum_test_code and y.HIVNUM_REQDTL_STATUS IN (5,10) AND y.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND y.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and x.GNUM_ISVALID \= 1 ) as testName  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in(5,10)  AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO) and TRUNC(HIVDT_REQUISITION_DATE) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=15  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)
 

#SELECT_LAB_COMBO_FOR_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
SELECT_LAB_COMBO_FOR_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName, m.patTestType FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name as labName,hgnum_pat_test_type as patTestType from hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ? AND p.gnum_hospital_code \= ?) order by departmenName,labName)m
   												    

   		 									    
 
SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? and  TRUNC (a.hivdt_report_date + INTERVAL '1 day') >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))
 														
														

#SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
# SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivdt_report_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivdt_report_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
 #SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_hst a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivdt_report_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivdt_report_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
 SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_hst a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
 																				
														
														
SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=13  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t
										
														
SELECT_PDF_NAME_HIVTSTR_PDF_URL=SELECT  hivtstr_pdf_url as pdfFileName FROM hivt_pdf_workorder_dtl  where hrgnum_puk\=?   AND gnum_isvalid\=1 and  hivtnum_req_dno\=? order  by gdt_entry_date desc\t
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
 
#SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) and TRUNC (a.hivdt_report_date + INTERVAL '1 day') >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))    


#SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender, pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge,  pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl_daily a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivdt_report_date) >\= TRUNC (SYSDATE) AND TRUNC (a.hivdt_report_date) <\= TRUNC (SYSDATE)      
#SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender, pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge,  pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_daily a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivdt_report_date) >\= TRUNC (SYSDATE) AND TRUNC (a.hivdt_report_date) <\= TRUNC (SYSDATE)      
SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender, pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge,  pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_daily a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (SYSDATE) AND TRUNC (a.hivt_entry_date) <\= TRUNC (SYSDATE)      


CHECK_COMBO_VALUE.HIVT_TEST_PARAMETER_COMBO_MST=select hgstr_value from hivt_test_param_combo_mst a, hivt_test_parameter_mst b where a.gnum_is_valid=? and b.gnum_isvalid=1 and a.gnum_parameter_code=b.gnum_parameter_code and a.gnum_test_code=b.gnum_test_code and  b.gstr_element_type in ('D','Z','P') and a.gnum_test_code=? and a.gnum_parameter_code=? and hgnum_seq_id=?

														
														
														
SELECT.ADVISEDBY_DOCTOR_NAMES.PIST_EMP_REGISTRATION_DTL=Select str_emp_no, str_emp_full_name from pist_emp_registration_dtl where gnum_isvalid =? and gnum_hospital_code = ? order by str_emp_full_name														

#SELECT_LAB_COMBO_FOR_DUPLICATE_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
SELECT_LAB_COMBO_FOR_DUPLICATE_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName, m.patTestType FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name as labName, hgnum_pat_test_type as patTestType from hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ? AND p.gnum_hospital_code \= ?) order by departmenName,labName)m
                                                        
                                                        
                                                        
                                                        		
SELECT.DUPLICATE_RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=14  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))      
#SELECT.DUPLICATE_RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''\\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_report_dtl_hst a WHERE  hivnum_reqdtl_status=14  and a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =?  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code = ?)   and TRUNC (a.hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))
														
UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl   SET hivnum_reqdtl_status\=?, hivtdt_res_print_date\=SYSDATE, hivtnum_res_print_seatid\=? WHERE hivtnum_req_dno\=?

																					
																					
SELECT_PDF_NAME_FOR_DUPLICATE_REPORT_HIVTSTR_PDF_URL=SELECT  hivtstr_pdf_url as pdfFileName FROM hivt_pdf_workorder_dtl  where hrgnum_puk\=?   AND gnum_isvalid\=1 and  hivtnum_req_dno\=? order  by gdt_entry_date desc\t
											
											
											
SELECT.DUPLICATE_RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=14  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
																																					                                                    


																																				         
	#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL=Select hivnum_req_no as reqNo,hivtnum_req_dno ,gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as prvTestCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName,    gbnum_priority_code, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,    to_char(hivt_entry_date,'dd-Mon-yyyy') as reqDate, decode(pkg_inv_fun.fun_test_type(gnum_test_code),'P','Patient Based','S', 'Sample Based', 'I','Slide Based') as sampleCode,     hivnum_reqdtl_status as prvReqStatus,    DECODE(hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted', 7,'Result Entered',    8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed',     15,'Test Cancelled',16,'Test Deleted',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing') status,    pkg_inv_fun.fun_sample_name(gnum_sample_code) sampleName, gnum_sample_code,to_char(hivt_entry_date,'MMddyyyy') as sortReqDate  from hivt_requisition_dtl   where       hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?)      and gnum_hospital_code\= ?  order by sortReqDate desc \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                    
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL=Select pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('||(select b.gstr_usr_name from gblt_user_mst b where b.gnum_userid \= a.gnum_seat_id) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?) and a.gnum_hospital_code\= ? order by sortReqDate desc,testGroupCode,reqno
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL=Select pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.gnum_seat_id ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.gnum_seat_id) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?) and a.gnum_hospital_code\= ? order by CAST(hivt_entry_date AS datetime) desc,testGroupCode,reqno
SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL=Select (Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.hivtnum_test_delete_seatid) ||')'||'('|| (to_char(a.hivtdt_test_delete_date,'dd-mm-yyyy HH24:MI:SS'))||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?) and a.gnum_hospital_code\= ? order by CAST(hivt_entry_date AS datetime) desc,testGroupCode,reqno
      
SELECT.hivt_test_mand_ref_val_mst = SELECT hgstr_range_value as range,decode(hgstr_range_value_uom,'-',' ',hgstr_range_value_uom) as rangeUom,gnum_range_type as rangeTyp,gnum_test_code as testCode, gnum_parameter_code as parameterCode, gstr_gender_code as gender, hgnum_low_age as lowAge, hgnum_high_age as highAge, hgstr_low_value_uom lowValueUom,     hgstr_high_value as highValue, hgstr_low_value as lowValue, hgstr_high_value_uom as highValueUom, hgstr_symbol as symbol,hgstr_low_age_uom as lowAgeUom, hgstr_high_age_uom as highAgeUom,gnum_sample_code as sampleCode, gnum_lab_code as labCode, hgnum_mand_code as mandCode FROM hivt_test_mand_ref_val_mst where gnum_isvalid\=1 and gnum_hospital_code \=?;\t\t\t\t\t\t\t                    

  																                    
 #SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?            
 #SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?     
 SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c \tWHERE b.gnum_is_valid\=1 and c.gnum_test_code\=b.gnum_test_code and c.gnum_isvalid\=1  and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?     
 
 
SELECT.HIVT_LABORATORY_TEST_MST.PRINT_WITH_STANDARD_RANGES = select hivtnum_test_printing_type from hivt_laboratory_test_mst where gnum_test_code\=? and gnum_labcode\=? and gnum_hospital_code\=? and gnum_isvalid\=1\t
															
SELECT.HIVT_PARAMETER_DTL.DEFAULTVALUES = SELECT concat(GNUM_TEST_CODE,gnum_parameter_code), HIVTSTR_DEFAULT_VALUE , gnum_parent_id FROM hivt_test_parameter_mst WHERE gnum_isvalid=1 and gnum_test_code=?

SELECT.CRITERIA_CODE= Select gnum_test_code as testCode, gnum_parameter_code as paramterCode , gnum_criteria_code as criteriaCode from hivt_test_parameter_mst where gnum_isvalid=1   

#Changed by PrashantMi
SELECT_CANNED_DETAILS_RESULT_ENTRY_HIVT_LAB_CANNED_MST=SELECT  UPPER(gstr_user_canned_code ||' ('||(SELECT u.gstr_usr_name||'-'|| u.gnum_designation  FROM gblt_user_mst u WHERE u.gnum_userid = a.gnum_seat_id  AND u.gnum_hospital_code = a.gnum_hospital_code)||')') as userCannedCode,(select  hstr_canned_content from hivt_canned_mst where gnum_isvalid=1 and a.hgnum_canned_code=hgnum_canned_code) as cannedContent  FROM hivt_lab_canned_mst a where gnum_isvalid=1 AND gnum_hospital_code=?  AND   gnum_lab_code=? and gnum_seat_id =? union all SELECT  UPPER(gstr_user_canned_code ||' ('||(SELECT u.gstr_usr_name||'-'|| u.gnum_designation  FROM gblt_user_mst u WHERE u.gnum_userid = a.gnum_seat_id  AND u.gnum_hospital_code = a.gnum_hospital_code)||')') as userCannedCode,(select  hstr_canned_content from hivt_canned_mst where gnum_isvalid=1 and a.hgnum_canned_code=hgnum_canned_code) as cannedContent  FROM hivt_lab_canned_mst a where gnum_isvalid=1 AND gnum_hospital_code=?  AND   gnum_lab_code=? and  gnum_seat_id not in (?); 
																																							                                													  												   
SELECT_MACRO_DETAILS_RESULT_ENTRY_HIVT_LAB_MACRO_MAPPING_MST=SELECT UPPER(gstr_user_macro_code) as userCannedCode ,(select  hgstr_macro_text from hivt_macro_mst where gnum_isvalid=1 and a.hgnum_macro_code=hgnum_macro_code) as macroText  FROM hivt_lab_macro_mapping_mst a where gnum_isvalid=1 AND gnum_hospital_code=?  AND   gnum_lab_code= ?
			
			
			
#SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL=SELECT gnum_machine_code as machineCode,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=((select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code)) and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,(select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code) as defaultmachineCode,(hgnum_group_code)\:\:numeric as groupCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCrNo,(select gstr_sample_short_name from hivt_sample_mst b where b.gnum_sample_code\=a.gnum_sample_code)as shortSampleName,hivtnum_req_dno as requisitionDNo,    hivnum_req_no as requisitionNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender,     hivnum_isappointment as isAppointment,         gnum_lab_code as labCode ,    pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName,     gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName ,     hivnum_isconfidential, gbnum_priority_code as priorityCode ,       DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority,       hivnum_sample_no as sampleNo, hivnum_reqdtl_status,      hivnum_temp_sample_no as tempSampleNo,      hgnum_group_code, hgnum_group_type,      gnum_bill_no, gnum_sample_code,       pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,     (Select gnum_labno_config from hivt_laboratory_mst      where GNUM_ISVALID\=1     and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE         and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration,     (hivnum_packing_list_no) as packingListNO,     TO_CHAR(hivdt_coll_date_time,'dd-mon-yyyy') as collDate,     hivnum_sample_col_area_code,     hivtdt_packinglist_date_time as packingListDate ,       hivnum_packing_list_seat_id FROM hivt_requisition_dtl     a WHERE gnum_hospital_code\=? and    hivnum_reqdtl_status \= 4 AND      hivnum_sample_no\=? \t  order by machinename,groupcode 
SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL=SELECT gnum_machine_code as machineCode,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id\=((select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code)) and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,(select hminum_machine_id from hivt_laboratory_test_mst  ss where ss.gnum_test_code\=a.gnum_test_code and ss.gnum_labcode\=a.gnum_lab_code and ss.gnum_hospital_code\=a.gnum_hospital_code) as defaultmachineCode,(hgnum_group_code)\:\:numeric as groupCode,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCrNo,(select gstr_sample_short_name from hivt_sample_mst b where b.gnum_sample_code\=a.gnum_sample_code)as shortSampleName,hivtnum_req_dno as requisitionDNo,    hivnum_req_no as requisitionNo,(select hbnum_requisition_type from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName, (select hivstr_age from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patAge,   (select gstr_gender_code from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patGender,     hivnum_isappointment as isAppointment,         gnum_lab_code as labCode ,    pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName,     gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName ,     hivnum_isconfidential, gbnum_priority_code as priorityCode ,       DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority,       hivnum_sample_no as sampleNo, hivnum_reqdtl_status,      hivnum_temp_sample_no as tempSampleNo,      hgnum_group_code, hgnum_group_type,      gnum_bill_no, gnum_sample_code,       pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,     (Select gnum_labno_config from hivt_laboratory_mst      where GNUM_ISVALID\=1     and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE         and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration,     (hivnum_packing_list_no) as packingListNO,     TO_CHAR(hivdt_coll_date_time,'dd-mon-yyyy') as collDate,     hivnum_sample_col_area_code,     hivtdt_packinglist_date_time as packingListDate ,       hivnum_packing_list_seat_id FROM hivt_requisition_dtl     a WHERE gnum_hospital_code\=? and    hivnum_reqdtl_status \= 4 AND      hivnum_sample_no\=? and hivnum_temp_sample_no=?  order by machinename,groupcode 

															        	
															           
															           
UPDATE.ACCEPTED_SAMPLE_RESCHEDULED_ACCDETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=? , hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, HIVNUM_RESHEDULE_SEATID\=?,HIVDT_RESHEDULE_DATE\=SYSDATE WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?\t\t\t\t\t\t\t\t\t\t\t\t   \t\t\t\t\t\t\t\t\t\t\t\t


UPDATE.ACCEPTED_SAMPLE_NOTACC_DETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=?, hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, hivtdt_cancellation_date\=SYSDATE, hivtnum_cancellation_seatid\=? WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?

SELECT.SAMPLE_ACCEPTANCE_PACKING_LIST_FOR_CHECK_PACKNO_HIVT_REQUISITION_DTL_TO_REJECT=SELECT hivtnum_req_dno as requisitionDNo, hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and hivnum_reqdtl_status \= 6
															      																																					                                													  												
															          	
															           
															           
															           
															           
															           
															           
SELECT.TESTWISE_COMBO_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  \t
SELECT.TESTWISE_COMBO_COLL_DATE_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  \t

SELECT.SAMPLENO_COMBO_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.SAMPLENO_COMBO_COLL_DATE_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t
			
			
SELECT.LABNO_COMBO_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.LABNO_COMBO_COLL_DATE_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t\t
		
SELECT.TESTGROUP_COMBO_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and gnum_hospital_code \=?    AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.TESTGROUP_COMBO_COLL_DATE_RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and gnum_hospital_code \=?    AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t
		
		
		
#SELECT.TESTWISE_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  \t\t
SELECT.TESTWISE_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?) \t\t
#SELECT.TESTWISE_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  \t\t
SELECT.TESTWISE_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?) \t\t

#SELECT.SAMPLENO_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))
SELECT.SAMPLENO_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a,hivt_requisition_header b  WHERE hivnum_temp_sample_no is not null and a.gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)
#SELECT.SAMPLENO_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=? AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.SAMPLENO_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a,hivt_requisition_header b  WHERE hivnum_temp_sample_no is not null and a.gnum_hospital_code \=? AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)
					
#SELECT.LABNO_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))
SELECT.LABNO_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE a.gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)
#SELECT.LABNO_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))        
SELECT.LABNO_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b       WHERE a.gnum_hospital_code \=?  AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)\t\t
		
#SELECT.TESTGROUP_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and  gnum_hospital_code \=?    AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))
SELECT.TESTGROUP_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE hgnum_group_code is not null and  a.gnum_hospital_code \=?    AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)
#SELECT.TESTGROUP_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and  gnum_hospital_code \=?    AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.TESTGROUP_COMBO_COLL_DATE_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a,hivt_requisition_header b WHERE hgnum_group_code is not null and  a.gnum_hospital_code \=?    AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND a.hivnum_req_no\=b.hivnum_req_no AND a.gnum_hospital_code\=b.gnum_hospital_code AND b.hivnum_validator IN (0,?)\t\t\t
			
			
SELECT.TESTWISE_COMBO_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?     AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   \t\t
SELECT.TESTWISE_COMBO_COLL_DATE_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?     AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   \t\t

SELECT.SAMPLENO_COMBO_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and  gnum_hospital_code \=?     AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.SAMPLENO_COMBO_COLL_DATE_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and  gnum_hospital_code \=?     AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t\t\t
			
SELECT.LABNO_COMBO_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?    AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     
SELECT.LABNO_COMBO_COLL_DATE_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?    AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t\t
		
SELECT.TESTGROUP_COMBO_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and  gnum_hospital_code \=?     AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))      
SELECT.TESTGROUP_COMBO_COLL_DATE_RESULT_REVALIDATION_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and  gnum_hospital_code \=?     AND TRUNC (hivdt_coll_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivdt_coll_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))\t
	
	
SELECT.TESTWISE_COMBO_RESULT_REPORT_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?     AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND gnum_lab_code  like ?\t  \t


SELECT.SAMPLENO_COMBO_RESULT_REPORT_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?      AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND gnum_lab_code like ?    
			
			
SELECT.LABNO_COMBO_RESULT_REPORT_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?       AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND gnum_lab_code like ?     
		
		
SELECT.TESTGROUP_COMBO_RESULT_REPORT_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a       WHERE  hgnum_group_code is not null and  gnum_hospital_code \=?      AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND gnum_lab_code  like ?     
	

SELECT.TESTWISE_COMBO_RESULT_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName FROM hivt_requisition_dtl a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status in (26,13,14)     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by testName


SELECT.SAMPLENO_COMBO_RESULT_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct hivnum_sample_no as sampleNo,hivnum_sample_no as sampleNo  FROM hivt_requisition_dtl a       WHERE hivnum_sample_no is not null and  gnum_hospital_code =? and hivnum_reqdtl_status in (26,13,14)     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   order by sampleNo
			
			
SELECT.LABNO_COMBO_RESULT_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo FROM hivt_requisition_dtl a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status in (26,13,14)     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))    order by labNo
		
		
SELECT.TESTGROUP_COMBO_RESULT_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and  gnum_hospital_code =? and hivnum_reqdtl_status=26     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by groupName





SELECT.TESTWISE_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName FROM hivt_requisition_dtl a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by testName
#SELECT.TESTWISE_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName FROM hivt_report_dtl_hst a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by testName


SELECT.SAMPLENO_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct hivnum_sample_no as sampleNo,hivnum_sample_no as sampleNo  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   order by sampleNo
#SELECT.SAMPLENO_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct hivnum_sample_no as sampleNo,hivnum_sample_no as sampleNo  FROM hivt_report_dtl_hst a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   order by sampleNo
			
			
SELECT.LABNO_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo FROM hivt_requisition_dtl a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))    order by labNo
#SELECT.LABNO_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo FROM hivt_report_dtl_hst a       WHERE gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))    order by labNo

		
		
SELECT.TESTGROUP_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a       WHERE  hgnum_group_code is not null and gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by groupName
#SELECT.TESTGROUP_COMBO_RESULT_DUPLICATE_REPORT_ONLOAD_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_hst a       WHERE  hgnum_group_code is not null and gnum_hospital_code =? and hivnum_reqdtl_status=14     AND TRUNC (hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))     order by groupName


SELECT.TEST_CODE_WISE.HIVT_LABORATORY_TEST_MST=select distinct(gnum_user_test_code),  gnum_user_test_code as testCodeWise from hivt_laboratory_test_mst where gnum_isvalid=1  and gnum_hospital_code = ? order by testCodeWise
 
UPDATE.REQDTLS.RESULT.ENTRY.MODIFY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_res_modify_date\=SYSDATE, hivnum_result_seatid\=?, hivnum_reqdtl_status\=?,hrgstr_visit_reason_reqd\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?
 
 SELECT.REQUISITON.PENDING.DTL.HIVT_REQUISITION_DTL=select count(*) from hivt_requisition_dtl a where gnum_lab_code=? and gnum_test_code=?  And gnum_hospital_code=? and trunc(hivt_entry_date)<=trunc(sysdate) and hivnum_reqdtl_status in (2,3,4,5,6) and exists(select 1 from hivt_requisition_header where gnum_isvalid=1 and hrgnum_puk=? and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=? and trunc(hivdt_requisition_date)<=(sysdate))

 
INSERT.RESULT.LOG.DETAIL.HIVT_RESULT_LOG_DTL=INSERT INTO hivt_result_log_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,hivnum_parameter_code, gnum_hospital_code, hrgnum_s_no, hivt_entry_date,gnum_seat_id, hivtstr_new_value, hivtstr_previous_value, gnum_isvalid,gnum_process_id,hivtstr_patient_name,hivtnum_lab_code,hivtstr_lab_name,hivtnum_age,hivtstr_gender,hivtstr_test_name,hivtnum_sample_no,hivtnum_lab_no,hivtstr_ref_range,hivtnum_deptunitcode,hivtnum_deptcode,hivtnum_requistiontype,hivstr_patunitname,hivtnum_cr_no,hivtnum_temp_sample_no,hivtstr_samplename) VALUES (?, ?, ?,?, ?, (Select NVL(MAX(hrgnum_s_no),0)+1 from hivt_result_log_dtl where gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=?) , SYSDATE,?, ?, ?, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
 


SELECT_CANNED_CODE_DETAILS_RESULT_ENTRY_HIVT_LAB_CANNED_MST=SELECT  UPPER(gstr_user_canned_code) as userCannedCode,(select  hstr_canned_content from hivt_canned_mst where gnum_isvalid=1 and a.hgnum_canned_code=hgnum_canned_code) as cannedContent  FROM hivt_lab_canned_mst a where gnum_isvalid=1 AND gnum_hospital_code=?  AND   gnum_lab_code=?;

SELECT_MACRO_CODE_DETAILS_RESULT_ENTRY_HIVT_LAB_MACRO_MAPPING_MST=SELECT UPPER(gstr_user_macro_code) as userMacroCode , (select  hgstr_macro_text from hivt_macro_mst where gnum_isvalid=1 and a.hgnum_macro_code=hgnum_macro_code) as macroText  FROM hivt_lab_macro_mapping_mst a where gnum_isvalid=1 AND gnum_hospital_code=?  AND   gnum_lab_code= ?
														           																																					                                													  												  
UPDATE.REQUISITIONSTATUS.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl  SET  hivnum_reqdtl_status=? , hivtnum_test_delete_seatid=?,  hivtdt_test_delete_date=SYSDATE  WHERE hivnum_reqdtl_status in(?,?) AND gnum_hospital_code=? And  gnum_lab_code=? And gnum_test_code=? and hivnum_req_no=?

SELECT.TEST.REQSTATUS.HIVT_REQUISITION_DTL=select  hivnum_reqdtl_status from hivt_requisition_dtl a where  gnum_hospital_code=? AND gnum_lab_code=? and gnum_test_code=?   and trunc(hivt_entry_date)<=trunc(sysdate)  and hivnum_reqdtl_status in (2,3,4,5,6) and exists(select 1 from hivt_requisition_header where gnum_isvalid=1 and hrgnum_puk=? and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=? and trunc(hivdt_requisition_date)<=(sysdate))
														           																																					                                													  												 
 
 
SELECT.APT_BY_DESK.HIVT_REQUISITION_HEADER=Select  nvl(concatstring('select t.gstr_test_name from hivt_test_mst t where t.gnum_isvalid\=1 and t.gnum_test_code in (select gnum_test_code from hivt_requisition_dtl r where  r.hivnum_reqdtl_status\=55 and r.gnum_hospital_code \='''||a.gnum_hospital_code||''' and r.HIVNUM_REQ_NO\='''||a.HIVNUM_REQ_NO||''' )   ',','),'-') as testName,HIVNUM_REQ_NO as reqNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,HBNUM_REQUISITION_TYPE as patStatusCode,hgnum_patient_cat_code AS patCategoryCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as reqDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc, (select gnum_sample_code from hivt_requisition_dtl where gnum_hospital_code\=a.gnum_hospital_code and hivnum_req_no\=a.hivnum_req_no and gnum_isvalid\=1 and rownum\=1) as sampleCode,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )   AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO)   

SELECT.GET_APPOINTMENT_DTL.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select gbl_is_appointment from hivt_laboratory_test_mst where gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as isAppointment,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_lab_code AND gnum_hospital_code \= a.gnum_hospital_code )  as islabappointmentbased from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS \= ? and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=?

UPDATE.SAVE_APPOINTMENT.HIVT_REQUISITION_DTL= UPDATE hivt_requisition_dtl set hivdt_appointment_date=TO_DATE(?),hivstr_appointment_time=?,hapnum_app_ref_no=?,hivnum_reqdtl_status=? where hivtnum_req_dno=? and gnum_hospital_code=?

SELECT.GET_APPOINTMENT_DTL_ON_CLICK_GO.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE,HIVTNUM_REQ_DNO as requisitionDNo,hivnum_req_no as reqNo,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select gbl_is_appointment from hivt_laboratory_test_mst where gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as isAppointment from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS \= ?  and gnum_hospital_code\=? and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where gnum_hospital_code\=? and hrgnum_puk\=?)

#SELECT.LABTEST_MACHINE.HIVT_LABTEST_MST=select HMINUM_MACHINE_ID as machineId,  HMISTR_MACHINE_NAME  as machineName,(select gnum_test_code from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_labcode=? and gnum_test_code=? and gnum_hospital_code=m.gnum_hospital_code and HMINUM_MACHINE_ID=m.HMINUM_MACHINE_ID) from HMIT_MACHINE_MST m where gnum_isvalid=1 and gnum_hospital_code=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code=? and gnum_location_code=m.gnum_location_code and gnum_hospital_code=m.gnum_hospital_code) order by machineName
	SELECT.LABTEST_MACHINE.HIVT_LABTEST_MST=select HMINUM_MACHINE_ID as machineId,  HMISTR_MACHINE_NAME  as machineName,(select string_agg(gnum_test_code,'$$') from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_labcode=?  and gnum_hospital_code=m.gnum_hospital_code and HMINUM_MACHINE_ID=m.HMINUM_MACHINE_ID) from HMIT_MACHINE_MST m where gnum_isvalid=1 and gnum_hospital_code=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code=? and gnum_location_code=m.gnum_location_code and gnum_hospital_code=m.gnum_hospital_code) order by machineName
									
INSERT_SAM_ACC_DTLS.HMIT_SAMPLE_DTL=INSERT INTO hmit_sample_dtl(hminum_machine_reqid, hminum_machine_id, hminum_inv_reqdno, gnum_hospital_code, hminum_hmis_test_code, hminum_hmis_sampleno, hminum_ispreserve, hminum_priority, hminum_para_count, hmistr_machine_sampleno, hmidt_collection_date, hmidt_samplefetched_date, hminum_samplefetched_by, hminum_test_status,hrgnum_patcr_no,hmistr_pat_name,hmistr_age,hmistr_sex)   VALUES ((SELECT NVL(MAX(HMINUM_MACHINE_REQID),TO_NUMBER(TO_CHAR(SYSDATE,'YYMM')||'000000'))+1 from hmit_machine_mst where HMINUM_MACHINE_ID=? and gnum_hospital_code=?), ?, ?, ?, ?,?, ?, ?, ?,?,TRUNC(TO_DATE(?,'dd-mon-yyyy')), sysdate,?, ?,?,?,?,?);

INSERT.HMIT_SAMPLE_DTL=INSERT INTO hmit_sample_dtl(hminum_machine_reqid, hminum_machine_id, hminum_inv_reqdno, gnum_hospital_code, hminum_hmis_test_code, hminum_hmis_sampleno, hminum_ispreserve, hminum_priority, hminum_para_count, hmistr_machine_sampleno, hmidt_collection_date, hmidt_samplefetched_date, hminum_samplefetched_by, hminum_test_status,hrgnum_patcr_no,hmistr_age,hmistr_pat_name,hmistr_sex)   VALUES ((SELECT NVL(MAX(HMINUM_MACHINE_REQID),TO_NUMBER(TO_CHAR(SYSDATE,'YYMM')||'000000'))+1 from hmit_machine_mst where HMINUM_MACHINE_ID=? and gnum_hospital_code=?), ?, ?, ?, ?,?, ?, ?, ?,?, sysdate, sysdate,?, ?,?,?,?,?);

#UPDATE.REQDTLS.MACHINE.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?  WHERE hivtnum_req_dno\=? and gnum_hospital_code\=?
UPDATE.REQDTLS.MACHINE.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?,  hivnum_reqdtl_status\=?  WHERE hivtnum_req_dno\=? and gnum_hospital_code\=?

													 
INSERT.MACHINE.ENTRY.DETAIL.HIVT_PARAMETER_DTL=INSERT INTO hivt_parameter_dtl(hivtnum_req_dno, hivtnum_test_code,hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    \
                                           hivnum_parameter_code, gnum_isvalid,hivstr_ref_range)    \
                                                 VALUES ( ?, ?,?,?, SYSDATE, ?, ?,?,?,?);
                                                 
                                                 
#(select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=?)                                                 
#Changed by prashant (hivt_requisition_dtl where gnum_lab_code=?) in 8 queries                                                 
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample \= ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )   and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample \= ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? And Rus.Hminum_Machine_Id=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? )  and hrgnum_patcr_no=? and hmistr_machine_sampleno=? AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? And Rus.Hminum_Machine_Id=? and ss.hminum_test_status IN (1,2 )  and ss.hminum_machine_id=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? )  and hrgnum_patcr_no=? and hmistr_machine_sampleno=? AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 ) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )   and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc


   
UPDATE_REQUEST_ID.HMIT_MACHINE_MST=UPDATE hmit_machine_mst set hminum_machine_reqid = (SELECT NVL(MAX(HMINUM_MACHINE_REQID),TO_NUMBER(TO_CHAR(SYSDATE,'YYMM')||'000000'))+1 from hmit_machine_mst where HMINUM_MACHINE_ID=? and gnum_hospital_code=?) where hminum_machine_id=? and gnum_hospital_code=?

UPDATE.HMIT_RESULT_DTL=UPDATE hmit_result_dtl set hminum_status=?,hminum_result_validated_by=?,hmidt_result_validation_date=sysdate, hminum_machine_reqid=? where hminum_status=? and hminum_machine_recordid=? and hminum_machine_id=? and gnum_hospital_code=?

UPDATE_STATUS.HMIT_SAMPLE_DTL=UPDATE hmit_sample_dtl set hminum_test_status=? , hminum_para_count=? where hminum_test_status in (1,2) and hminum_inv_reqdno=? and hminum_machine_reqid=? and hminum_machine_id=? and gnum_hospital_code=?

SELECT.PARA.COUNT.HMIT_SAMPLE_DTL=select HMINUM_PARA_COUNT as sampleDtlParaCount from hmit_sample_dtl where HMISTR_MACHINE_SAMPLENO =? and hminum_hmis_test_code = ? and HMINUM_MACHINE_ID =? and hminum_inv_reqdno=? and gnum_hospital_code=?

SELECT.LABTEST_MACHINE.HIVT_LABTEST_MST.MACHINE.RESULT.ENTRY=select HMINUM_MACHINE_ID as machineId,  HMISTR_MACHINE_NAME  as machineName from HMIT_MACHINE_MST m where gnum_isvalid=1 and gnum_hospital_code=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code=? and gnum_location_code=m.gnum_location_code and gnum_hospital_code=m.gnum_hospital_code) order by machineName

SELECT.MACHINE_MST.MACHINE_RESULT_ENQUIRY=select HMINUM_MACHINE_ID as machineCode,  HMISTR_MACHINE_NAME  as machineName from HMIT_MACHINE_MST where gnum_isvalid=1 and gnum_hospital_code=? order by machineName

SELECT.SAMPLE_NO.HMIT_SAMPLE_NO=select hmistr_machine_sampleno as machineSampleNo from hmit_sample_dtl where hminum_test_status like ? and hminum_machine_id=? and gnum_hospital_code=? and TRUNC(hmidt_collection_date)>=TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and TRUNC(hmidt_collection_date)<=TRUNC(TO_DATE(?,'DD-Mon-YYYY'))

SELECT.MACHINE_ENQUIRY_DETAILS.HMIT_RESULT_DTL_COMPLETED= Select Rus.Hmistr_Machine_Sampleno machineLabSampleNo,Rus.Hmistr_Machine_Test_Code machineTestParameterCode,(Select Hmistr_Hmis_Testpara_Code From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id) As parameterCode,(Select Hmistr_Machine_Testpara_Name From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id) As machineTestParameterName,Rus.Hmistr_Result as machineResult,To_Char (Rus.Hmidt_Resultentry_Date,'mm/dd/yyyy hh\:mi\:ss am' ) as machineResultEntryDate,Rus.Hminum_Machine_Recordid as machineRecordId,Rus.Hminum_Machine_Id machineCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=(SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id )) as testName,(SELECT hrgnum_patcr_no FROM hmit_sample_dtl WHERE hminum_test_status\=3 and gnum_hospital_code \= rus. gnum_hospital_code and hminum_machine_reqid \= rus.hminum_machine_reqid  )as patCrNo,(SELECT hmistr_pat_name FROM hmit_sample_dtl WHERE hminum_test_status\=3 and  gnum_hospital_code \= rus. gnum_hospital_code and hminum_machine_reqid \= rus.hminum_machine_reqid )as patName From Hmit_Result_Dtl Rus  Where Rus.Hminum_Status \=2  and Rus.Hminum_Machine_Id\=? and Rus.gnum_hospital_code\=? and Rus.hmistr_machine_sampleno like ? and exists ( select 1 from hmit_sample_dtl where gnum_hospital_code \= rus. gnum_hospital_code AND   hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status\=3 and TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_collection_date) <\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) and hminum_machine_reqid \= rus.hminum_machine_reqid ) Order By Rus.Hmistr_Machine_Sampleno
   
   
SELECT.MACHINE_ENQUIRY_DETAILS.HMIT_RESULT_DTL_PARTIAL_COMPLETE=Select Rus.Hmistr_Machine_Sampleno machineLabSampleNo,Rus.Hmistr_Machine_Test_Code machineTestParameterCode,(Select Hmistr_Hmis_Testpara_Code From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id) As parameterCode,(Select Hmistr_Machine_Testpara_Name From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id) As machineTestParameterName,Rus.Hmistr_Result as machineResult,To_Char (Rus.Hmidt_Resultentry_Date,'mm/dd/yyyy hh\:mi\:ss am' ) as machineResultEntryDate,Rus.Hminum_Machine_Recordid as machineRecordId,Rus.Hminum_Machine_Id machineCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=(SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id )) as testName,(SELECT hrgnum_patcr_no FROM hmit_sample_dtl WHERE hminum_test_status\=2 and gnum_hospital_code \= rus. gnum_hospital_code and hminum_machine_reqid \= rus.hminum_machine_reqid  )as patCrNo,(SELECT hmistr_pat_name FROM hmit_sample_dtl WHERE hminum_test_status\=2 and gnum_hospital_code \= rus. gnum_hospital_code and hminum_machine_reqid \= rus.hminum_machine_reqid )as patName   From Hmit_Result_Dtl Rus Where Rus.Hminum_Status \=2  and Rus.Hminum_Machine_Id\=?and Rus.gnum_hospital_code\=? and rus.hmistr_machine_sampleno like ? and exists ( select 1 from hmit_sample_dtl where gnum_hospital_code \= rus. gnum_hospital_code AND   hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status\=2 and TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_collection_date) <\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))  and hminum_machine_reqid \= rus.hminum_machine_reqid) Order By Rus.Hmistr_Machine_Sampleno

      															
SELECT.MACHINE_ENQUIRY_DETAILS.HMIT_RESULT_DTL_IN_PROCESS=Select Rus.Hmistr_Machine_Sampleno machineLabSampleNo,  '-' as machineResult,'-' as machineTestParameterCode,'-' as machineTestParameterName,'-' as machineResultEntryDate, Rus.Hminum_Machine_Id machineCode,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=(SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id and hminum_hmis_test_code\=rus.hminum_hmis_test_code)) as testName,(SELECT Hminum_Inv_Reqdno FROM hmit_sample_dtl WHERE hminum_para_count\=0 and gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status like '1' and hminum_hmis_test_code\=rus.hminum_hmis_test_code) AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE ('29-Sep-2015', 'dd-Mon-yyyy')) )as reqDNo,(SELECT hrgnum_patcr_no FROM hmit_sample_dtl WHERE hminum_para_count\=0 and gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code  AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status like '1' and hminum_hmis_test_code\=rus.hminum_hmis_test_code) AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE ('29-Sep-2015', 'dd-Mon-yyyy')) )as patCrNo,(SELECT hmistr_pat_name FROM hmit_sample_dtl WHERE hminum_para_count\=0 and gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code  AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status like '1' and hminum_hmis_test_code\=rus.hminum_hmis_test_code) AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE ('29-Sep-2015', 'dd-Mon-yyyy')) )as patName,(SELECT Hminum_Hmis_Sampleno FROM hmit_sample_dtl WHERE hminum_para_count\=0 and  gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status like '1' and hminum_hmis_test_code\=rus.hminum_hmis_test_code) AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE ('29-Sep-2015', 'dd-Mon-yyyy')) and hminum_test_status \=1                       ) as sampleNo,(SELECT Hminum_Machine_Reqid FROM hmit_sample_dtl WHERE hminum_para_count\=0 and gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status like '1' and hminum_hmis_test_code\=rus.hminum_hmis_test_code) AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE ('29-Sep-2015', 'dd-Mon-yyyy'))) as machineReqId,(SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id and hminum_hmis_test_code\=rus.hminum_hmis_test_code) as testCode From Hmit_sample_Dtl Rus Where hminum_test_status \= 1   and  rus.hmistr_machine_sampleno like ? and Rus.gnum_hospital_code\=? and  Rus.Hminum_Machine_Id\=?  AND TRUNC (hmidt_collection_date) >\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_collection_date) <\= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) Order By Rus.Hmistr_Machine_Sampleno
 															  
SELECT.MACHINE_ENQUIRY_DETAILS.HMIT_RESULT_DTL_NOT_FOUND=SELECT '-' AS patCrNo, '-' AS patName, rus.hmistr_result AS machineResult,TO_CHAR (rus.hmidt_resultentry_date,'mm/dd/yyyy hh\:mi\:ss am') as machineResultEntryDate,rus.hmistr_machine_sampleno AS machineLabSampleNo ,(select hmistr_machine_test_code from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code) as machineTestParameterCode,(select hmistr_machine_testpara_name from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code) as machineTestParameterName,(select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=(SELECT distinct(hminum_hmis_test_code) FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id and hmistr_MACHINE_test_code\=rus.hmistr_MACHINE_test_code)) as testName from hmit_result_dtl rus where hminum_status\=0 and hminum_machine_id\=? and gnum_hospital_code\=? and rus.hmistr_machine_sampleno like ? and TRUNC(hmidt_resultentry_date)>\=TRUNC(TO_DATE(?,'dd-mon-yyyy')) and TRUNC(hmidt_resultentry_date)<\=TRUNC(TO_DATE(?,'dd-mon-yyyy'))
SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL= select TO_CHAR(rus.hmidt_resultentry_date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate,hminum_machine_recordid AS machineRecordId ,ss.hminum_machine_id AS machineCode,rus.hmistr_result AS machineResult,( SELECT gstr_user_group_code FROM hivt_test_group_info_mst WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code =( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno)) and gnum_test_code=ss.hminum_hmis_test_code ) AS shortgrpcode, (SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename, ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_hmis_test_code ) ) AS grpcode, ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = ( tt.Hmistr_Hmis_Testpara_Code ) ) AS paraname, (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = ( ss.hminum_hmis_test_code ) ) AS testname, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = ( ss.hminum_hmis_test_code ) AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) )::NUMERIC AS preference , ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) ) AS grpname ,ss.hminum_inv_reqdno,hmistr_machine_testpara_name as machineTestParameterName,rus.hmistr_machine_test_code as machineTestParameterCode,ss.hmistr_machine_sampleno as machineLabSampleNo,'-' AS patCrNo,* FROM Hmit_Result_Dtl rus,hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE rus.Gnum_Hospital_Code = ? and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND rus.Hminum_Machine_Id  =? AND Hminum_Status = 1 AND rus.Hmistr_Machine_Sampleno NOT IN ( SELECT Hmistr_Machine_Sampleno FROM Hmit_Sample_Dtl WHERE Gnum_Hospital_Code = ? AND Hminum_Machine_Id =? )  AND TRUNC (hmidt_collection_date) = TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_resultentry_date) = TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))
 



#SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL=select (select gstr_user_group_code from hivt_test_group_info_mst where gnum_hospital_code\=rus.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ) limit 1) as shortgrpcode,(select hmistr_machine_name from hmit_machine_mst where gnum_isvalid\=1 and gnum_hospital_code\=rus.gnum_hospital_code and hminum_machine_id\=rus.hminum_machine_id) as machinename,(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ) as grpcode,(select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=(Select Hmistr_Hmis_Testpara_Code From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id)) as paraname,(select gstr_test_name from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id)) as testname,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=(SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id) and gnum_hospital_code\=rus.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ))\:\:numeric as preference,(select hgstr_group_name from hivt_test_group_mst where gnum_isvalid\=1 and gnum_hospital_code\=rus.gnum_hospital_code and hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) )) as grpname,'-' AS patCrNo, rus.hmistr_machine_sampleno AS machineLabSampleNo ,NVL((select hmistr_machine_test_code from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code),'-') as machineTestParameterCode,NVL((select hmistr_machine_testpara_name from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code),'-') as machineTestParameterName,rus.hmistr_result AS machineResult,hminum_machine_recordid as machineRecordId,hminum_machine_id as machineCode,TO_CHAR (rus.hmidt_resultentry_date,'mm/dd/yyyy hh\:mi\:ss am') as machineResultEntryDate From Hmit_Result_Dtl rus Where Gnum_Hospital_Code \= ? And Hminum_Machine_Id in ((select HMINUM_MACHINE_ID  from HMIT_MACHINE_MST m where gnum_isvalid\=1 and gnum_hospital_code\=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code\=? and gnum_location_code\=m.gnum_location_code and gnum_hospital_code\=m.gnum_hospital_code))) And Hminum_Status \= 1 and Hmistr_Machine_Sampleno  Not In (Select Hmistr_Machine_Sampleno From Hmit_Sample_Dtl where Gnum_Hospital_Code \= ? And Hminum_Machine_Id in ((select HMINUM_MACHINE_ID  from HMIT_MACHINE_MST m where gnum_isvalid\=1 and gnum_hospital_code\=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code\=? and gnum_location_code\=m.gnum_location_code and gnum_hospital_code\=m.gnum_hospital_code))))
SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL= select TO_CHAR(rus.hmidt_resultentry_date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate,hminum_machine_recordid AS machineRecordId ,ss.hminum_machine_id AS machineCode,rus.hmistr_result AS machineResult,( SELECT gstr_user_group_code FROM hivt_test_group_info_mst WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code =( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno)) and gnum_test_code=ss.hminum_hmis_test_code ) AS shortgrpcode, (SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename, ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_hmis_test_code ) ) AS grpcode, ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = ( tt.Hmistr_Hmis_Testpara_Code ) ) AS paraname, (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = ( ss.hminum_hmis_test_code ) ) AS testname, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = ( ss.hminum_hmis_test_code ) AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) )::NUMERIC AS preference , ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) ) AS grpname ,ss.hminum_inv_reqdno,hmistr_machine_testpara_name as machineTestParameterName,rus.hmistr_machine_test_code as machineTestParameterCode,ss.hmistr_machine_sampleno as machineLabSampleNo,'-' AS patCrNo,* FROM Hmit_Result_Dtl rus,hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE rus.Gnum_Hospital_Code = ? and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Hminum_Status = 1 AND rus.Hmistr_Machine_Sampleno NOT IN ( SELECT Hmistr_Machine_Sampleno FROM Hmit_Sample_Dtl WHERE Gnum_Hospital_Code = ? AND Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) )  AND TRUNC (hmidt_collection_date) = TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_resultentry_date) = TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))
  SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno=select TO_CHAR(rus.hmidt_resultentry_date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate,hminum_machine_recordid AS machineRecordId ,ss.hminum_machine_id AS machineCode,rus.hmistr_result AS machineResult,( SELECT gstr_user_group_code FROM hivt_test_group_info_mst WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \=( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno)) and gnum_test_code\=ss.hminum_hmis_test_code ) AS shortgrpcode, (SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename, ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_hmis_test_code ) ) AS grpcode, ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= ( tt.Hmistr_Hmis_Testpara_Code ) ) AS paraname, (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= ( ss.hminum_hmis_test_code ) ) AS testname, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \= ( ss.hminum_hmis_test_code ) AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) ) )\:\:NUMERIC AS preference , ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) ) ) AS grpname ,ss.hminum_inv_reqdno,hmistr_machine_testpara_name as machineTestParameterName,rus.hmistr_machine_test_code as machineTestParameterCode,ss.hmistr_machine_sampleno as machineLabSampleNo,'-' AS patCrNo,* FROM Hmit_Result_Dtl rus,hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE rus.Gnum_Hospital_Code \= ? and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND rus.Hminum_Machine_Id \=? AND Hminum_Status \= 1 AND rus.Hmistr_Machine_Sampleno NOT IN ( SELECT Hmistr_Machine_Sampleno FROM Hmit_Sample_Dtl WHERE Gnum_Hospital_Code \= ? AND Hminum_Machine_Id  \=?) and ss.hmistr_machine_sampleno\=?  AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_resultentry_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))
 
  
 
#SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select (select gstr_user_group_code from hivt_test_group_info_mst where gnum_hospital_code\=rus.gnum_hospital_code and gnum_is_valid\=1 and hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ) limit 1) as shortgrpcode,(select hmistr_machine_name from hmit_machine_mst where gnum_isvalid\=1 and gnum_hospital_code\=rus.gnum_hospital_code and hminum_machine_id\=rus.hminum_machine_id) as machinename,(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ) as grpcode,(select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=(Select Hmistr_Hmis_Testpara_Code From Hmit_Machine_Testpara_Mst Where Gnum_Isvalid \= 1 And Gnum_Hospital_Code \= Rus.Gnum_Hospital_Code And Hmistr_Machine_Test_Code \= Rus.Hmistr_Machine_Test_Code And Hminum_Machine_Id \= Rus.Hminum_Machine_Id)) as paraname,(select gstr_test_name from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id)) as testname,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code\=(SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id) and gnum_hospital_code\=rus.gnum_hospital_code and gnum_is_valid\=1 and  hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) ))\:\:numeric as preference,(select hgstr_group_name from hivt_test_group_mst where gnum_isvalid\=1 and gnum_hospital_code\=rus.gnum_hospital_code and hgnum_group_code\=(select hgnum_group_code from hivt_requisition_dtl where hivtnum_req_dno\=(SELECT hminum_inv_reqdno FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus. gnum_hospital_code AND hmistr_machine_sampleno \= rus.hmistr_machine_sampleno AND hminum_machine_id \= rus.hminum_machine_id  AND hminum_hmis_test_code \= (SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status in (1,2)) AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))) )) as grpname,'-' AS patCrNo, rus.hmistr_machine_sampleno AS machineLabSampleNo ,NVL((select hmistr_machine_test_code from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code),'-') as machineTestParameterCode,NVL((select hmistr_machine_testpara_name from hmit_machine_testpara_mst where gnum_isvalid\=1 and hminum_machine_id\=rus.hminum_machine_id and hmistr_machine_test_code\=rus.hmistr_machine_test_code),'-') as machineTestParameterName,rus.hmistr_result AS machineResult,hminum_machine_recordid as machineRecordId,hminum_machine_id as machineCode,TO_CHAR (rus.hmidt_resultentry_date,'mm/dd/yyyy hh\:mi\:ss am') as machineResultEntryDate From Hmit_Result_Dtl rus Where Gnum_Hospital_Code \= ? And Hminum_Machine_Id in ((select HMINUM_MACHINE_ID  from HMIT_MACHINE_MST m where gnum_isvalid\=1 and gnum_hospital_code\=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code\=? and gnum_location_code\=m.gnum_location_code and gnum_hospital_code\=m.gnum_hospital_code))) And Hminum_Status \= 1 and Hmistr_Machine_Sampleno  Not In (Select Hmistr_Machine_Sampleno From Hmit_Sample_Dtl where Gnum_Hospital_Code \= ? And Hminum_Machine_Id in ((select HMINUM_MACHINE_ID  from HMIT_MACHINE_MST m where gnum_isvalid\=1 and gnum_hospital_code\=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code\=? and gnum_location_code\=m.gnum_location_code and gnum_hospital_code\=m.gnum_hospital_code)))) and rus.hmistr_machine_sampleno\=?
 #SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select TO_CHAR(rus.hmidt_resultentry_date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate,hminum_machine_recordid AS machineRecordId ,ss.hminum_machine_id AS machineCode,rus.hmistr_result AS machineResult,( SELECT gstr_user_group_code FROM hivt_test_group_info_mst WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code =( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno)) and gnum_test_code=ss.hminum_hmis_test_code ) AS shortgrpcode, (SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename, ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_hmis_test_code ) ) AS grpcode, ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = ( tt.Hmistr_Hmis_Testpara_Code ) ) AS paraname, (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = ( ss.hminum_hmis_test_code ) ) AS testname, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code = ( ss.hminum_hmis_test_code ) AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) )::NUMERIC AS preference , ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) ) ) AS grpname ,ss.hminum_inv_reqdno,hmistr_machine_testpara_name as machineTestParameterName,rus.hmistr_machine_test_code as machineTestParameterCode,ss.hmistr_machine_sampleno as machineLabSampleNo,'-' AS patCrNo,* FROM Hmit_Result_Dtl rus,hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE rus.Gnum_Hospital_Code = ? and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Hminum_Status = 1 AND rus.Hmistr_Machine_Sampleno NOT IN ( SELECT Hmistr_Machine_Sampleno FROM Hmit_Sample_Dtl WHERE Gnum_Hospital_Code = ? AND Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) )
 SELECT.UNMAPPED.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select TO_CHAR(rus.hmidt_resultentry_date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate,hminum_machine_recordid AS machineRecordId ,ss.hminum_machine_id AS machineCode,rus.hmistr_result AS machineResult,( SELECT gstr_user_group_code FROM hivt_test_group_info_mst WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \=( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno)) and gnum_test_code\=ss.hminum_hmis_test_code ) AS shortgrpcode, (SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename, ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_hmis_test_code ) ) AS grpcode, ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= ( tt.Hmistr_Hmis_Testpara_Code ) ) AS paraname, (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= ( ss.hminum_hmis_test_code ) ) AS testname, ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \= ( ss.hminum_hmis_test_code ) AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) ) )\:\:NUMERIC AS preference , ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) ) ) AS grpname ,ss.hminum_inv_reqdno,hmistr_machine_testpara_name as machineTestParameterName,rus.hmistr_machine_test_code as machineTestParameterCode,ss.hmistr_machine_sampleno as machineLabSampleNo,'-' AS patCrNo,* FROM Hmit_Result_Dtl rus,hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE rus.Gnum_Hospital_Code \= ? and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Hminum_Status \= 1 AND rus.Hmistr_Machine_Sampleno NOT IN ( SELECT Hmistr_Machine_Sampleno FROM Hmit_Sample_Dtl WHERE Gnum_Hospital_Code \= ? AND Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) ) and ss.hmistr_machine_sampleno\=?  AND TRUNC (hmidt_collection_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND TRUNC (hmidt_resultentry_date) \= TRUNC (TO_DATE (?, 'dd-Mon-yyyy'))
 
 
															
UPDATE.HMIT_RESULT_DTL.UNMAPPED=UPDATE hmit_result_dtl set hminum_status=? where hminum_status=? and hminum_machine_recordid=? and hminum_machine_id=? and gnum_hospital_code=?

SELECT.LAB_TEST_SAMPLE=Select gnum_lab_code as labCode ,gnum_test_code as testCode ,gnum_sample_code as sCode,(select gstr_sample_name from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as sName,(select gstr_sample_short_name  from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as reqSampleShortName from hivt_labtest_sample_mst a where gnum_isvalid=1 and gnum_hospital_code =? and gnum_lab_code in ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid =?  AND p.gnum_module_id =?)  order by sName asc

#UPDATE.REQDTLS.RESULT.VALIDATION.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_res_val_date\=SYSDATE, hivtnum_res_val_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?,hrgstr_visit_reason_reqd\=?,hivnum_sms_flag_reqd\=0  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?
UPDATE.REQDTLS.RESULT.VALIDATION.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_res_val_date\=SYSDATE, hivtnum_res_val_seatid\=?,  hivnum_reqdtl_status\=?,hrgstr_visit_reason_reqd\=?,hivnum_sms_flag_reqd\=0  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?


#UPDATE.REQDTLS.RESULT.REVALIDATION.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_res_reval_date\=SYSDATE, hivtnum_res_reval_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?,hrgstr_visit_reason_reqd\=?,hivnum_sms_flag_reqd\=0  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?
UPDATE.REQDTLS.RESULT.REVALIDATION.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_res_reval_date\=SYSDATE, hivtnum_res_reval_seatid\=?,  hivnum_reqdtl_status\=?,hrgstr_visit_reason_reqd\=?,hivnum_sms_flag_reqd\=0  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?

SELECT.EXTERNAL_LAB_NAMES.HIVT_EXTERNAL_LABORATORY_MST=select gnum_lab_code, INITCAP(gstr_lab_name)  from HIVT_EXTERNAL_LABORATORY_MST where gnum_isvalid=1 order by gstr_lab_name

SELECT.SAMPLES_EXTERNAL.HIVT_SAMPLE_MST=select GNUM_SAMPLE_CODE as sampleCode,INITCAP(GSTR_SAMPLE_NAME)  from hivt_sample_mst where gnum_isvalid=1 order by gstr_sample_name

SELECT.PARAMETER_COMBO_NAMES.HIVT_PARAMETER_MST=select hgnum_parameter_id, hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 order by hgstr_parameter

SELECT.GLOBALLAB_NAMES_EXTERNALPROCESS.HIVT_LABORATORY_MST=Select GNUM_LAB_CODE,  INITCAP (gstr_lab_name) as labName from  hivt_laboratory_mst where gnum_isvalid\=1 and gnum_hospital_code\=? order by labName

SELECT.TEST_COMBO_NAMES_EXTERNALPROCESS.HIVT_TEST_MST=select gnum_test_code,INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid=1 order by gstr_test_name

INSERT.HIVT_EXTERNAL_INVESTIGATION_DTL=INSERT INTO hivt_external_investigation_dtl( \
       								   gnum_external_lab_code, gnum_lab_code, gstr_lab_name, hgnum_parameter_id, \
     								   hgstr_parameter, gnum_sample_code, gstr_sample_name, gnum_test_code, \
        							   gstr_test_name, gnum_hospital_code, hivtstr_value, hrgnum_puk, \
       								   gnum_seat_id, gdt_entry_date,hivtstr_file_nam) \
  									   VALUES (?, ?, ?, ?, \
            							?, ?, ?, ?, \
            							?, ?, ?, ?, \
            							?, sysdate,?)
            							
            							
#SELECT.PACKAGING_LIST_DETAILS.HIVT_REQUISITION_DTL= SELECT (select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) 
SELECT.PACKAGING_LIST_DETAILS.HIVT_REQUISITION_DTL= SELECT (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND a.hivnum_sample_col_area_code \= ?

SELECT.PACKAGING_LIST_DETAILS.HIVT_REQUISITION_DTL_MACHINE= SELECT (select gstr_user_group_code from  hivt_test_group_info_mst q where q.gnum_hospital_code\=A.gnum_hospital_code and q.hgnum_group_code\=A.hgnum_group_code limit 1) as groupName,hgnum_group_code as groupCode,(select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName,(SELECT hivstr_age FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAge,(SELECT gstr_gender_code FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patGender,(SELECT hipstr_ward_name FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patWardName,(SELECT hipdt_admstatus_code FROM  hipt_patadmission_dtl WHERE GNUM_ISVALID\=1 and hipnum_admno\=(select hipnum_admno from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  ) AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patAdmittedStatus,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND a.gnum_machine_code \= ?


SELECT.TEST_AVAILABILITY_DETAILS.HIVT_LABORATORY_TEST_MST= select gnum_labcode as labCode, gnum_test_code as testCode, (select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code) as testName, decode(gnum_is_test_available, 1,'Available',0,'Not Available') availableValue,NVL(TO_CHAR(hivdt_from_date,'dd-Mon-yyyy'),'') as fromDate,NVL(TO_CHAR(hivdt_to_date,'dd-Mon-yyyy'),'') as toDate,gnum_is_test_available as isAvailable from hivt_laboratory_test_mst a where gnum_isvalid=1 and gnum_hospital_code=? and gnum_labcode=?

UPDATE.TEST_AVAIALABILITY.HIVT_LABORATORY_TEST_MST= update hivt_laboratory_test_mst set gnum_is_test_available=? , hivdt_from_date= TO_DATE(?,'DD-Mon-YYYY'), hivdt_to_date= TO_DATE(?,'DD-Mon-YYYY'), gstr_remarks=? ,gdt_lstmod_date=sysdate, gnum_lstmod_seatid=?  where gnum_isvalid=1 and gnum_is_test_available=? and gnum_hospital_code=? and gnum_labcode=? and gnum_test_code=?
 
INSERT.TEST_LOG_DETAILS.HIVT_TEST_AVAILABILITY_LOG_DTL=INSERT INTO hivt_test_availability_log_dtl(gnum_test_code, gnum_lab_code, gnum_hospital_code, gnum_sq_no, gnum_is_test_available, gstr_remarks, gdt_lstmod_date, gnum_lstmod_seatid, hivdt_from_date, hivdt_to_date)VALUES (?, ?, ?, (Select NVL(MAX(gnum_sq_no),00)+1 from hivt_test_availability_log_dtl where gnum_test_code\=? and gnum_lab_code\=? and gnum_hospital_code\=?),?, ?, sysdate, ?,TO_DATE(?,'DD-Mon-YYYY'), TO_DATE(?,'DD-Mon-YYYY'));
 
UPDATE.FINALREMARK.HIVT_REQUISITION_HEADER=update hivt_requisition_header set hivstr_final_remark=?,hivnum_sms_flag=0 where gnum_isvalid=1 and hivnum_req_no=? and gnum_hospital_code=?

UPDATE.FINALREMARK.EMPCODE.HIVT_REQUISITION_HEADER=update hivt_requisition_header set hivstr_final_remark=?,hivnum_validator=?,hivnum_sms_flag=0 where gnum_isvalid=1 and hivnum_req_no=? and gnum_hospital_code=?

#SELECT.ONLOAD_HIVT_REQUISITION_HEADER.FILMDETAILSPATIENTS=Select hivnum_req_no AS reqNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode,( select pkg_clinical_util_fun.get_pat_category_name(GNUM_HOSPITAL_CODE,hgnum_patient_cat_code) from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) AS patCategory FROM hivt_requisition_dtl a       WHERE hivnum_reqdtl_status\=6  and gnum_sample_code\=-1 and gnum_film_flag\=0 and gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT.ONLOAD_HIVT_REQUISITION_HEADER.FILMDETAILSPATIENTS=Select nvl((select hivtnum_totalfilms_used||'$'||nvl(hivtnum_additional_films_used,'0')||'$'||nvl(hivtnum_films_wasted,'0') from hivt_filmused_dtl aa where aa.hivtnum_req_dno\=a.hivtnum_req_dno),'0') as filmdataused,gnum_film_flag as isfilmused,hivnum_req_no AS reqNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode,( select pkg_clinical_util_fun.get_pat_category_name(GNUM_HOSPITAL_CODE,hgnum_patient_cat_code) from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) AS patCategory FROM hivt_requisition_dtl a       WHERE  exists (Select 1 from hivt_laboratory_mst d where d.gnum_isvalid\=1 and d.gnum_hospital_code\=a.gnum_hospital_code   and d.gnum_lab_code\=a.gnum_lab_code and d.gnum_isfilmused\=1) and hivnum_reqdtl_status\=6  and gnum_sample_code\=-1 and  gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=15  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)


INSERT.FILMDETAIL.HIVT_WORKORDER_FILM_DTL=INSERT INTO hivt_workorder_film_dtl( \
            								gnum_batch_no,hivtnum_req_dno, hivtnum_film_id, hivtnum_film_no, hivtnum_film_size,\
            								hivtnum_films_used_type, gbnum_status_code, gnum_seat_id, gdt_entry_date,\
            								gnum_reason, gstr_film_remark,gnum_hospital_code)\
    										VALUES (?,?, ?, ?, ?,\
    										?, ?, ?, sysdate,\
    										?, ?,?);

    										
INSERT.FILMDETAIL.HIVT_FILMUSED_DTL=INSERT INTO hivt_filmused_dtl(\
          							  hivtnum_req_dno, hivtnum_totalfilms_used, \
      							      hivtnum_films_wasted, hivtnum_additional_films_used, gnum_seat_id, \
  							          hgstr_remarks, gdt_entry_date)\
  											  VALUES (?, ?, \
  										          ?, ?, ?, \
     										       ?, sysdate);

     										       

SELECT_FILM_SIZE.HIVT_FILM_DTL_MST=select gnum_film_id||'\#'||hstnum_item_id||'\#'||hstnum_store_id||'\#'||gnum_no_of_films_required,gnum_film_size_length||'x'||gnum_film_size_breadth as filmSize  from hivt_film_dtl_mst where gnum_isvalid\=1 and gnum_hospital_code\=? and gnum_test_code\=?
SELECT_LAB_COMBO_FOR_AUDIT_PROCESS_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
SELECT_ALL_TEST_COMBO_FOR_AUDIT_PROCESS_HIVT_LABORATORY_TEST_MST=select gnum_test_code,gstr_test_name from hivt_test_mst where gnum_isvalid=?

SELECT_TEST_COMBO_FOR_AUDIT_PROCESS_HIVT_LABORATORY_TEST_MST=select  a.gnum_test_code,(select gstr_test_name from hivt_test_mst b where b.gnum_test_code=a.gnum_test_code and b.gnum_isvalid=a.gnum_isvalid) from HIVT_LABORATORY_TEST_MST a where gnum_isvalid=? and gnum_hospital_code=?

SELECT_LIST_DATA_FOR_AUDIT_PROCESS_HIVT_RESULT_LOG_DTL=select distinct(hivtnum_req_dno) as requisitionDNo, hivtnum_test_code as testCode, hivtstr_patient_name as patName,hivtnum_lab_code as labCode,hivtstr_lab_name as patLabName,hivtnum_age as patAge,hivtnum_cr_no as patCRNo,hivtstr_gender as patGender, hivtstr_test_name as testName,hivtnum_temp_sample_no as tempsampleno,hivtnum_lab_no as labCode,hivstr_patunitname as patUnitName from hivt_result_log_dtl where gnum_hospital_code=? and trunc(hivt_entry_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(hivt_entry_date)<=trunc(to_date(?,'dd-mon-yyyy'))

SELECT_LIST_DATA_SHOW_FOR_AUDIT_PROCESS_HIVT_RESULT_LOG_DTL=select distinct(hivtnum_req_dno) as requisitionDNo,(select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=hivt_result_log_dtl.hivnum_parameter_code ) as paraName,hivtstr_samplename as sampleName,hivtnum_cr_no as patCRNo,hivtstr_patient_name as patName,hivtstr_lab_name as patLabName,hivtnum_age as patAge,hivtstr_gender as patGender,hivtstr_test_name as testName,hivtnum_temp_sample_no as tempsampleno,hivstr_patunitname as patUnitName,hivtstr_samplename as sampleName,hivtstr_new_value as newValue,hivtstr_previous_value as preValue,to_char(hivt_entry_date,'dd-mon-yyyy') as modifyDate,decode(gnum_process_id,1,'Result Entry',2,'Result Validation',3,'Result Revalidation',4,'Amendment Process') as processModify,To_Char(hivt_entry_date, 'HH24:MI:SS') as modifyTime,gnum_process_id as processId,pkg_inv_fun.fun_empname(gnum_seat_id, gnum_hospital_code) as modifiedBy,hivnum_parameter_code as paraCode,hivtnum_test_code as testCode	from hivt_result_log_dtl where gnum_hospital_code=? 

CHECK_COMBO_VALUE_AUDIT_NEW_VALUE.HIVT_TEST_PARAMETER_COMBO_MST=select hgstr_value from hivt_test_param_combo_mst a, hivt_test_parameter_mst b where a.gnum_is_valid=? and b.gnum_isvalid=1 and a.gnum_parameter_code=b.gnum_parameter_code and a.gnum_test_code=b.gnum_test_code and  b.gstr_element_type in ('D','Z','P') and a.gnum_test_code=? and a.gnum_parameter_code=? and hgnum_seq_id=?

CHECK_COMBO_VALUE_AUDIT_PRE_VALUE.HIVT_TEST_PARAMETER_COMBO_MST=select hgstr_value from hivt_test_param_combo_mst a, hivt_test_parameter_mst b where a.gnum_is_valid=? and b.gnum_isvalid=1 and a.gnum_parameter_code=b.gnum_parameter_code and a.gnum_test_code=b.gnum_test_code and  b.gstr_element_type in ('D','Z','P') and a.gnum_test_code=? and a.gnum_parameter_code=? and hgnum_seq_id=? 

SELECT.RAISING_CUM_COLLECTION.LAB_TEST_SAMPLE=Select gnum_lab_code as labCode ,gnum_test_code as testCode ,gnum_sample_code as sCode, gnum_sample_qty as defaultContainerVol, gnum_container_code as containerCode, gnum_uom_code as uomCode, (select gstr_sample_name from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as sName from hivt_labtest_sample_mst a where gnum_isvalid=1 and gnum_hospital_code = ? and gnum_lab_code in ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid =?  AND p.gnum_module_id =?)  order by gnum_lab_code,gnum_test_code


SELECT.BILLING_DETAILS.BILL_FUNCTION=Select Bill_Interface.func_online_bill_dtl (?\:\:character varying, DECODE (NVL(?,11),  NULL, ?,11, ?,  1,?||?,    2,      ?||?,     3,    ?)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:CHARACTER VARYING, DECODE (NVL(?,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:CHARACTER VARYING, (?||'\!')\:\:CHARACTER VARYING) as billDetail from dual

 SELECT.RAISING_CUM_COLLECTION.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LABCODE ) as sampleNoConfig, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup,'Patient$'||a.gstr_instruction_pat as instructionPat,'Sample Collection$'||a.gstr_instruction_Coll as instructionColl,'Technician$'||a.gstr_instruction_Tech as instructionTech               FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?    AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID\=1 AND GSTR_TEST_TYPE\='S' AND GNUM_TEST_CODE\=A.GNUM_TEST_CODE)      ORDER BY  TestGroupCode,labCode,gnum_test_seq_no\t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t
 
 SELECT.FILM_NO.HIVT_LABORATORY_TEST_MST=select nvl(max(hivtnum_film_no),gnum_lab_code||to_char(sysdate,'mmyy')||1000)+1 from hivt_laboratory_mst where gnum_isvalid=1 and gnum_hospital_code=? and gnum_lab_code=? group by gnum_lab_code
 
 UPDATE.FILM_NO.HIVT_LABORATORY_MST=update hivt_laboratory_mst set hivtnum_film_no=? , gdt_lstmod_date=sysdate, gnum_lstmod_seatid=? where gnum_isvalid=1 and gnum_hospital_code=? and gnum_lab_code=?
 
 UPDATE.FILM_FLAG.HIVT_REQUISITION_DTL=update hivt_requisition_dtl set gnum_film_flag=? where hivtnum_req_dno=? and gnum_hospital_code=?
 
 SELECT.BATCH_DETAILS.HSTT_ITEM_CURRSTOCK_DTL=SELECT HSTSTR_BATCH_NO||'#'||C.HSTNUM_ITEM_ID||'#'||C.HSTNUM_STORE_ID||'#'||hstnum_inhand_qty FROM HSTT_ITEM_CURRSTOCK_DTL C, HIVT_FILM_DTL_MST F WHERE F.GNUM_ISVALID=1 AND C.HSTNUM_ITEM_ID=F.HSTNUM_ITEM_ID AND C.HSTNUM_STORE_ID=F.HSTNUM_STORE_ID AND C.GNUM_HOSPITAL_CODE=F.GNUM_HOSPITAL_CODE AND trunc(HSTDT_EXPIRY_DATE)>=trunc(sysdate) AND hstnum_inhand_qty >=1 and f.gnum_hospital_code=? and gnum_test_code=?
 
 UPDATE.BATCH_DETAILS.HSTT_ITEM_CURRSTOCK_DTL=update hstt_item_currstock_dtl set hstnum_inhand_qty=? where gnum_isvalid=1 and hstnum_store_id=? and hstnum_item_id=? and hststr_batch_no=? and gnum_hospital_code=?
 
 SELECT.RAISE_CUM_COLL.GET_APPOINTMENT_DTL.HIVT_REQUISITION_DTLS=Select HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType, (Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,(select gbl_is_appointment from hivt_laboratory_test_mst where gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as isAppointment from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS \= ? and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=?

 SELECT.SAMPLE_ACC_AUTOGEN_.HIVT_LABNO_CONF_MST=select hivtstr_labno_format from hivt_labno_conf_mst where gnum_is_valid=? and gnum_hospital_code=? and gnum_lab_code=? and gnum_test_code in (-1,?) and gnum_pat_type in(3,?) order by gnum_test_code desc,gnum_pat_type
 
 #SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_COLLCUMACC=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,(select gnum_test_code from hivt_requisition_dtl where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO and gnum_lab_code\=a.gnum_lab_code and rownum\=1 ) as testCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )
 SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_COLLCUMACC=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,(select gnum_test_code from hivt_requisition_dtl where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO and gnum_lab_code\=a.gnum_lab_code and rownum\=1 ) as testCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL b,hivt_test_mst c,hivt_laboratory_test_mst d  WHERE HIVNUM_REQDTL_STATUS \=? AND b.GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO and b.gnum_test_code\=c.gnum_test_code and c.gnum_isvalid\=1 and d.gnum_test_code\=b.gnum_test_code and d.gnum_labcode\=a.gnum_lab_code and d.gnum_isvalid\=1 and d.gnum_hospital_code\=b.gnum_hospital_code)
 
 #SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_COLLCUMACC_ALL=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,(select gnum_test_code from hivt_requisition_dtl where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO and gnum_lab_code\=a.gnum_lab_code and rownum\=1 ) as testCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )
 SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_COLLCUMACC_ALL=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,(select gnum_test_code from hivt_requisition_dtl where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO and gnum_lab_code\=a.gnum_lab_code and rownum\=1 ) as testCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL b,hivt_test_mst c,hivt_laboratory_test_mst d  WHERE HIVNUM_REQDTL_STATUS \=? AND b.GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO and b.gnum_test_code\=c.gnum_test_code and c.gnum_isvalid\=1 and d.gnum_test_code\=b.gnum_test_code and d.gnum_labcode\=a.gnum_lab_code and d.gnum_isvalid\=1 and d.gnum_hospital_code\=b.gnum_hospital_code)
 
 #SELECT_LIST_DATA_SHOW_FOR_EXTERNAL_PROCESS_HIVT_REQUISiTION_DTL=SELECT distinct(hivnum_req_no) AS RequisitionNo,concatstring( 'select (select INITCAP(GSTR_TEST_NAME) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=r.gnum_test_code) from hivt_requisition_dtl r where r.hivnum_req_no= '''||a.hivnum_req_no ||''' ',',') AS testName,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) AS patCRNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) AS patName,TO_CHAR(hivt_entry_date, 'DD-Mon-YYYY') as reqDate FROM hivt_requisition_dtl a WHERE  gnum_hospital_code =?
 SELECT_LIST_DATA_SHOW_FOR_EXTERNAL_PROCESS_HIVT_REQUISiTION_DTL=SELECT distinct(hivnum_req_no) AS RequisitionNo,concatstring( 'select (select INITCAP(GSTR_TEST_NAME) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=r.gnum_test_code) from hivt_requisition_dtl r where r.hivnum_req_no= '''||a.hivnum_req_no ||''' ',',') AS testName,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) AS patCRNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) AS patName,TO_CHAR(hivt_entry_date, 'DD-Mon-YYYY') as reqDate, (select gstr_lab_name from hivt_laboratory_mst where gnum_lab_code = a.gnum_lab_code and gnum_isvalid=1 and gnum_hospital_code = a.gnum_hospital_code) as labName FROM hivt_requisition_dtl a WHERE gnum_hospital_code =?
 
 #to fetch user group codes
 SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null and gnum_lab_code in ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid =?  AND p.gnum_module_id =?)
 
 SELECT.USER_GROUP_CODE_CUM_COLL.HIVT_TEST_GROUP_INFO_MST=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst a where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID=1 AND GSTR_TEST_TYPE='S' AND GNUM_TEST_CODE=A.GNUM_TEST_CODE) and gnum_lab_code in ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid =?  AND p.gnum_module_id =?)
 

 SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable,a.gstr_instruction_pat as instructionPat, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup,a.gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and  UPPER(gstr_user_group_code) \=UPPER(?)  and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t

 


# SELECT.RAISING_CUM_COLLECTION.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID=1 and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE= a.GNUM_LABCODE ) as sampleNoConfig, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b	WHERE b.gnum_is_valid=1   and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and UPPER(TRIM(gstr_user_group_code)) =UPPER(TRIM(?))  and      a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?    AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID=1 AND GSTR_TEST_TYPE='S' AND GNUM_TEST_CODE=A.GNUM_TEST_CODE)      \t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t
# SELECT.RAISING_CUM_COLLECTION.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LABCODE ) as sampleNoConfig, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and UPPER(gstr_user_group_code) \=UPPER(?)  and      a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?    AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID\=1 AND GSTR_TEST_TYPE\='S' AND GNUM_TEST_CODE\=A.GNUM_TEST_CODE)      \t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t


SELECT.REPORT_ADDENDUM_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl, gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,NVL(concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||hivstr_ref_range||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  '`' ),'-1\#-\#-\#-') AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, gnum_hospital_code, gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, gnum_hospital_code, gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,(select hivstr_final_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkString FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT_PATIENT_DETAILS.HIVT_REQUISITION_HEADER=select hrgnum_puk as patCRNo,  hrgstr_patname as patName, hivstr_age as patAge, gstr_gender_code as patGender, hrgstr_mobile_no as patMobileNo  from hivt_requisition_header where gnum_hospital_code=? and hrgnum_puk=? order by hivdt_entry_date desc  limit 1

#update demographics in req header
UPDATE.DEMGRAPHICS.HIVT_REQUISITION_HEADER=update hivt_requisition_header set hrgstr_patname=?, gstr_gender_code=?, hivstr_age=?,hivnum_sms_flag=0 where hrgnum_puk=? and hivnum_req_no=? and gnum_hospital_code=?

#update values in req dtl table
#UPDATE.NEWVALUES.HIVT_REQUISITION_DTL=update hivt_requisition_dtl set gnum_report_change\=? , hivnum_reportchange_seatid\=? , hivdt_reportchange_date\=sysdate, hivnum_reqdtl_status\=? where hivtnum_req_dno\=? and gnum_hospital_code\=?
UPDATE.NEWVALUES.HIVT_REQUISITION_DTL=update hivt_requisition_dtl b set gnum_change_count\=(select NVL(Max(gnum_change_count)+1,1) from hivt_requisition_dtl s where s.hivtnum_req_dno\=b.hivtnum_req_dno and s.gnum_hospital_code\=b.gnum_hospital_code ),gnum_report_change\=? , hivnum_reportchange_seatid\=? , hivdt_reportchange_date\=sysdate, hivnum_reqdtl_status\=? where b.hivtnum_req_dno\=? and b.gnum_hospital_code\=?


#job work order dtl report change values
INSERT.REPORTCAHNGE.HIVT_JOBWORKORDER_DATA=INSERT INTO hivt_jobworkorder_data(hivnum_reqorcr_no, hivnum_req_dno, hivnum_updation_type, gnum_status_code,  \
												            hivdt_entry_date,  gnum_hospital_code, hivnum_req_no,  \
												             hrgnum_puk, hivt_requisition_date,    gnum_test_code,   \
												              gnum_current_lab_code, hivnum_sample_code,  \
												            hivstr_pat_age, gnum_gender_code, hgnum_parameter_code, hgnum_reportgenerationafter,  \
												            hivtstr_result_value,hgnum_visit_date,hgnum_visitno,hgnum_lab_no,hrgnum_episode_code,hgnum_dept_code,hgnum_deptunitcode,hbnum_requisition_type,hgstr_testname,hgstr_labname,hgstr_samplename,hgnum_temp_sampleno, hgnum_group_code,gnum_report_change,gstr_report_url)  \
												           VALUES (?, ?, ?, ?, SYSDATE, ?,  ?,?, SYSDATE, ?,?, ?, ?,?, ?, ?, ?,TRUNC (TO_DATE (?, 'DD-Mon-YYYY')),?,?,?,?,?,?,?,?,?,?,?,?,?)

UPDATE.ADDENDUMREMARK.HIVT_REQUISITION_HEADER=update hivt_requisition_header set hivstr_addendum_remark=? where gnum_isvalid=1 and hivnum_req_no=? and gnum_hospital_code=?

#INSERT.RESULT.LOG.DETAIL.ADDENDUM.HIVT_RESULT_LOG_DTL=INSERT INTO hivt_result_log_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,hivnum_parameter_code, gnum_hospital_code, hrgnum_s_no, hivt_entry_date,gnum_seat_id, hivtstr_new_value, hivtstr_previous_value, gnum_isvalid,gnum_process_id,hivtstr_patient_name,hivtnum_lab_code,hivtstr_lab_name,hivtnum_age,hivtstr_gender,hivtstr_test_name,hivtnum_sample_no,hivtnum_lab_no,hivtstr_ref_range,hivtnum_deptunitcode,hivtnum_deptcode,hivtnum_requistiontype,hivstr_patunitname,hivtnum_cr_no,hivtnum_temp_sample_no,hivtstr_samplename) VALUES (?, ?, ?,?, ?, (Select NVL(MAX(hrgnum_s_no),0)+1 from hivt_result_log_dtl where gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=?) , SYSDATE,?, ?, ?, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);

INSERT.HIVT_ADDENDUM_LOG_DTL=INSERT INTO hivt_addendum_log_dtl(hivtnum_req_dno, hivtnum_req_no,gnum_hospital_code, hrgnum_s_no, hivt_entry_date,gnum_seat_id, gstr_previous_url, gnum_process_id, hivtnum_lab_code,hivtnum_cr_no,gnum_test_code,hivtnum_reason_code)VALUES (?, ?,?, (Select NVL(MAX(hrgnum_s_no),0)+1 from hivt_addendum_log_dtl where gnum_hospital_code\=? and hivtnum_req_no\=?), sysdate,?, ?, ?, ?,?,?,?);


SELECT.RAISING_CUM_COLLECTION.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LABCODE ) as sampleNoConfig, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,    concatstring (' select s.gnum_sample_code||''\#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid\=1 and s.gnum_lab_code\='''||a.gnum_labcode||''' and  s.gnum_test_code\='''||a.gnum_test_code||''' and s.gnum_hospital_code\='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup ,'Patient$'||a.gstr_instruction_pat as instructionPat,'Sample Collection$'||a.gstr_instruction_Coll as instructionColl,'Technician$'||a.gstr_instruction_Tech as instructionTech            FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and UPPER(TRIM(gstr_user_group_code)) \=UPPER(TRIM(?))  and      a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?    AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID\=1 AND GSTR_TEST_TYPE\='S' AND GNUM_TEST_CODE\=A.GNUM_TEST_CODE)      \t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t

# check user code to save modify canned in result entry
CHECK_CANNED_CODE.HIVT_LAB_CANNED_MST=select count(*) from hivt_lab_canned_mst where gnum_isvalid=? and gnum_hospital_code=?  and UPPER(gstr_user_canned_code)=UPPER(?)

CHECK_CANNED_NAME.HIVT_CANNED_MST=select count(*) from hivt_canned_mst where gnum_isvalid=?  and UPPER(gstr_canned_name)=UPPER(?)

INSERT.MODIFT_CANNED.HIVT_CANNED_MST=INSERT INTO hivt_canned_mst(hgnum_canned_code,gnum_seat_id,hgdt_entry_date,gnum_isvalid,hstr_canned_content,gstr_canned_name) VALUES (NVL((Select  MAX(hgnum_canned_code) from hivt_canned_mst) , 1001) +1,?, SYSDATE,?,?,?);

SELECT.CODE.HIVT_LAB_CANNED_MST=select hgnum_canned_code from hivt_canned_mst where  gstr_canned_name=?


INSERT.USER_CODE.HIVT_LAB_CANNED_MST=INSERT INTO hivt_lab_canned_mst(hgnum_canned_code,gnum_hospital_code,gnum_lab_code,gnum_seat_id,hgdt_entry_date,gnum_isvalid,gstr_user_canned_code) VALUES (?,?,?,?,sysdate,?,?) 

#dept specific result entry
SELECT.DEPT.RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsTestPrintedWithDeptTemplate(a.gnum_test_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsTestResultEntryWithDeptTemplate(a.gnum_test_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,(select hivstr_final_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat, pkg_inv_fun.fun_getIsTestPrintedWithDeptTemplate(a.gnum_test_code) as deptTestTemplatePrinted, pkg_inv_fun.fun_getIsTestResultEntryWithDeptTemplate(a.gnum_test_code) as deptTestTemplateResultEntry  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))
#SELECT.DEPT.RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,(select hivstr_final_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat, pkg_inv_fun.fun_getIsTestPrintedWithDeptTemplate(a.gnum_test_code) as deptTestTemplatePrinted, pkg_inv_fun.fun_getIsTestResultEntryWithDeptTemplate(a.gnum_test_code) as deptTestTemplateResultEntry  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

INSERT.DEPT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=INSERT INTO hivt_dept_parameter_dtl(hivtnum_req_dno, hivtnum_test_code,gnum_seq_no, hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    hivnum_parameter_code, gnum_isvalid,hivstr_loinc_string,hivstr_ref_range)    VALUES (?, ?,(select  nvl(max(gnum_seq_no),0)+1 from hivt_dept_parameter_dtl where hivtnum_req_dno\=? and hivtnum_test_code\=? and hivtnum_parent_parameter_code\=? and gnum_hospital_code\=?    ) ,?,?, SYSDATE, ?, ?,?, ?,?,?);
                                                 
SELECT.HIVT_DEPT_PARAMETER_DTL.WORKORDERRESULTENTRYDATA.RESULTVALIDATIONPROCESS = SELECT concat(HIVTNUM_TEST_CODE,hivnum_parameter_code), HIVTSTR_VALUE , hivtnum_parent_parameter_code FROM hivt_dept_parameter_dtl hpd WHERE gnum_isvalid=1 and hpd.hivtnum_req_dno =? and gnum_hospital_code=?  order by gnum_seq_no                                                

INSERT.DEPT.RESULT.ENTRY.DETAIL.HIVT_JOBWORKORDER_DATA=INSERT INTO hivt_jobworkorder_data(hivnum_reqorcr_no, hivnum_req_dno, hivnum_updation_type, gnum_status_code,  \
												            hivdt_entry_date,  gnum_hospital_code, hivnum_req_no,  \
												             hrgnum_puk, hivt_requisition_date,    gnum_test_code,   \
												              gnum_current_lab_code, hivnum_sample_code,  \
												            hivstr_pat_age, gnum_gender_code, hgnum_parameter_code, hgnum_reportgenerationafter,  \
												            hivtstr_result_value,hgnum_visit_date,hgnum_visitno,hgnum_lab_no,hrgnum_episode_code,hgnum_dept_code,hgnum_deptunitcode,hbnum_requisition_type,hgstr_testname,hgstr_labname,hgstr_samplename,hgnum_temp_sampleno, hgnum_group_code,gnum_isdept_entry)  \
												           VALUES (?, ?, ?, ?, SYSDATE, ?,  ?,?, SYSDATE, ?,?, ?, ?,?, ?, ?, ?,TRUNC (TO_DATE (?, 'DD-Mon-YYYY')),?,?,?,?,?,?,?,?,?,?,?,1)
												           
UPDATE.DEPT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=update hivt_dept_parameter_dtl set hivtstr_value=? , gnum_lstmod_seatid=?,gdt_lstmod_date=SYSDATE where gnum_isvalid=1 and gnum_seq_no=? and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and hivtnum_parent_parameter_code = ? and gnum_hospital_code=?

CHECK.PARA.PARA_DTL=select hivnum_parameter_code from hivt_dept_parameter_dtl where gnum_isvalid=1 and gnum_seq_no=? and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and hivtnum_parent_parameter_code = ? and gnum_hospital_code=?		
COMBO.ORGANISM_NAME.HIVT_ORGANISM_MST=select  hgnum_organism_code as organismCode,INITCAP(hgstr_organism_name)as organismName from hivt_organism_mst where gnum_isvalid=? and gnum_type='0' order by organismName

#COMBO.ANTIBITIC_NAME.HIVT_ORGANISM_ANTIBIOTIC_MAPPING_MST=select  hgnum_antibiotic_code as antibioticCode,INITCAP(hgstr_antibiotic_name)as antibioticName from hivt_antibiotic_mst where gnum_isvalid=1 and hgnum_antibiotic_code  IN(select gnum_antibiotic_code from hivt_organism_antibiotic_mapping_mst where gnum_isvalid=? and gnum_hospital_code=? and hgnum_organism_code=? )
COMBO.ANTIBITIC_NAME.HIVT_ORGANISM_ANTIBIOTIC_MAPPING_MST=select  hgnum_antibiotic_code as antibioticCode,INITCAP(hgstr_antibiotic_name)as antibioticName,(select hivnum_preference_order from hivt_organism_antibiotic_mapping_mst ss  where gnum_isvalid=1 and ss.gnum_hospital_code=? and ss.hgnum_organism_code=? and ss.gnum_antibiotic_code=s.hgnum_antibiotic_code)::numeric as preferenceorder from hivt_antibiotic_mst s where gnum_isvalid=1 and hgnum_antibiotic_code  IN(select gnum_antibiotic_code from hivt_organism_antibiotic_mapping_mst where gnum_isvalid=? and gnum_hospital_code=? and hgnum_organism_code=? ) order by preferenceorder,antibioticName

#COMBO.ORGANISM_NAME.HIVT_ORGANISM_MST=select  hgnum_organism_code as organismCode,INITCAP(hgstr_organism_name)as organismName from hivt_organism_mst where gnum_isvalid=?  order by hgnum_organism_code

#COMBO.ANTIBITIC_NAME.HIVT_ORGANISM_ANTIBIOTIC_MAPPING_MST=select  hgnum_antibiotic_code as antibioticCode,INITCAP(hgstr_antibiotic_name)as antibioticName from hivt_antibiotic_mst where gnum_isvalid=1 and hgnum_antibiotic_code  IN(select gnum_antibiotic_code from hivt_organism_antibiotic_mapping_mst where gnum_isvalid=? and gnum_hospital_code=? and hgnum_organism_code=? )

#for result entry hyper link
GET_XML=select hivtclob_document from hivt_document_store_mst where hivtnum_document_id=1

#INSERT.RESULT.ENTRY.HYPERLINK.HIVT_WO_ORGAANTIBIOTICS_DTL=insert into HIVT_WO_ORGAANTIBIOTICS_DTL (HIVTNUM_REQ_DNO,HIVTNUM_REQ_NO,HIVTNUM_TESTPARAMETER_CODE,GNUM_HOSPITAL_CODE,HIVTNUM_ORGANISM_CODE,HIVTNUM_ANTIBIOTICS_CODE,HIVTSTR_ORGANTIBIOTICS_VALUE,GNUM_SEATID, HRGNUM_PUK ,GNUM_ISVALID,GDT_ENTRY_DATE) values (?,?,?,?,?,?,?,?,?,?,sysdate)
INSERT.RESULT.ENTRY.HYPERLINK.HIVT_WO_ORGAANTIBIOTICS_DTL=insert into HIVT_WO_ORGAANTIBIOTICS_DTL (HIVTNUM_REQ_DNO,HIVTNUM_REQ_NO,HIVTNUM_TESTPARAMETER_CODE,GNUM_HOSPITAL_CODE,HIVTNUM_ORGANISM_CODE,HIVTNUM_ANTIBIOTICS_CODE,HIVTSTR_ORGANTIBIOTICS_VALUE,GNUM_SEATID, HRGNUM_PUK ,GNUM_ISVALID,GDT_ENTRY_DATE,hivtnum_growth,hivtnum_growthname,hivtnum_remark) values (?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?)

#GET_HYPERLINK_DATA=select a.hivtnum_req_dno as requisitionDNo, a.hivtnum_testparameter_code as testParaMeterCode,(select  b.hgstr_organism_name from hivt_organism_mst b where b.hgnum_organism_code=a.hivtnum_organism_code) as organismname,a.hivtnum_organism_code as organismcode,(select  b.hgstr_antibiotic_name from hivt_antibiotic_mst b where b.hgnum_antibiotic_code=a.hivtnum_antibiotics_code) as antibioticname,a.hivtnum_antibiotics_code as antibioticcode,decode(a.hivtstr_organtibiotics_value,1,'R',2,'S',3,'IS') as diagnosis,a.hivtstr_organtibiotics_value as diagnosiscode from hivt_wo_orgaantibiotics_dtl a where gnum_isvalid=? and gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_req_no=? and hivtnum_testparameter_code=?
#GET_HYPERLINK_DATA=select a.hivtnum_req_dno as requisitionDNo, a.hivtnum_testparameter_code as testParaMeterCode,(select  b.hgstr_organism_name from hivt_organism_mst b where b.hgnum_organism_code=a.hivtnum_organism_code) as organismname,a.hivtnum_organism_code as organismcode,(select  b.hgstr_antibiotic_name from hivt_antibiotic_mst b where b.hgnum_antibiotic_code=a.hivtnum_antibiotics_code) as antibioticname,a.hivtnum_antibiotics_code as antibioticcode,decode(a.hivtstr_organtibiotics_value,1,'R',2,'S',3,'IS') as diagnosis,a.hivtstr_organtibiotics_value as diagnosiscode,a.hivtnum_growth as growth,a.hivtnum_growthname as growthname,a.hivtnum_remark as remark from hivt_wo_orgaantibiotics_dtl a where gnum_isvalid=? and gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_req_no=? and hivtnum_testparameter_code=?
GET_HYPERLINK_DATA=select (select decode(hivtstr_call_url,'-1','1','1','1',hivtstr_call_url)  from hivt_test_parameter_mst where gnum_parent_id=hivtnum_testparameter_code and gnum_isvalid=1) as organismType,a.hivtnum_req_dno as requisitionDNo, a.hivtnum_testparameter_code as testParaMeterCode,(select  b.hgstr_organism_name from hivt_organism_mst b where b.hgnum_organism_code=a.hivtnum_organism_code) as organismname,a.hivtnum_organism_code as organismcode,(select  b.hgstr_antibiotic_name from hivt_antibiotic_mst b where b.hgnum_antibiotic_code=a.hivtnum_antibiotics_code) as antibioticname,a.hivtnum_antibiotics_code as antibioticcode,decode(a.hivtstr_organtibiotics_value,1,'R',2,'S',3,'MS') as diagnosis,a.hivtstr_organtibiotics_value as diagnosiscode,a.hivtnum_growth as growthcode,a.hivtnum_growthname as growth,a.hivtnum_remark as remark from hivt_wo_orgaantibiotics_dtl a where gnum_isvalid=? and gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_req_no=? and hivtnum_testparameter_code=?

UPDATE.HIVT_WO_ORGAANTIBIOTICS_DTL=update HIVT_WO_ORGAANTIBIOTICS_DTL set gnum_isvalid=0 where HIVTNUM_REQ_DNO=? and HIVTNUM_REQ_NO=?  and GNUM_HOSPITAL_CODE=? 


INSERT.RESULT.VALIDATION.HYPERLINK.HIVT_WO_ORGAANTIBIOTICS_DTL=insert into HIVT_WO_ORGAANTIBIOTICS_DTL (HIVTNUM_REQ_DNO,HIVTNUM_REQ_NO,HIVTNUM_TESTPARAMETER_CODE,GNUM_HOSPITAL_CODE,HIVTNUM_ORGANISM_CODE,HIVTNUM_ANTIBIOTICS_CODE,HIVTSTR_ORGANTIBIOTICS_VALUE,GNUM_lstmod_SEATID, HRGNUM_PUK ,GNUM_ISVALID,GDT_lstmod_DATE)  values (?,?,?,?,?,?,?,?,?,?,sysdate)



INSERT.RESULT.FORM.DETAIL.HIVT_REQUISITIONFORM_DTL=INSERT INTO hivt_requisitionform_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    \
                                           hivnum_parameter_code, gnum_isvalid,hivstr_loinc_string,hivstr_ref_range,hivtnum_lab_code)    \
                                                 VALUES (?, ?, ?,?, SYSDATE, ?, ?,?, ?,?,?,?);



# consumption process





# consumption process



SELECT.HIVT_OTHER_ITEM_MST.ALL.CONSUMTION=select hbnum_other_item_code as otherItemID, hbstr_item_name  as itemName ,hivnum_unit as unitCode,hbnum_default_qty as defaultQuantity,(select gstr_uom  from hivt_uom_mst where gnum_uom_code=a.hivnum_unit and gnum_isvalid=a.gnum_isvalid) as unit ,(select hgstr_itemtype_name from hivt_itemtype_mst where hbnum_itemtype_code=a.hbnum_item_type) as itemType,(select count(*) from hivt_labitem_mst where hivnum_laboratory_code=? and hbnum_other_item_code=a.hbnum_other_item_code and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=?) as isMapped from hivt_other_item_mst a where gnum_isvalid=? and gnum_hospital_code=?

SELECT_LAB_COMBO_FOR_TEST_WISE_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m 

SELECT.TEST_WISE_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS requisitionNo,hivnum_reqdtl_status as reqDtlStatus,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.fun_getIsGroupPrintedWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamicTemplatePrintedGroup, pkg_inv_fun.fun_getIsGroupResultEntryWithDynamicTemplate(a.hgnum_group_code,gnum_hospital_code,gnum_lab_code) as dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid\=1 and gnum_lab_code\=a.gnum_lab_code and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkReqd,(select hivstr_final_remark from hivt_requisition_header where gnum_isvalid\=1 and hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT.LABNO_COMBO_TEST_WISE_HIVT_REQUISITION_HEADER=Select distinct  hgstr_daily_labno as labNo,  hgstr_daily_labno as labNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT.TESTWISE_COMBO_LAB_WISE_HIVT_REQUISITION_HEADER=Select distinct gnum_test_code as testCode ,   pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))  \t

SELECT.SAMPLENO_COMBO_TEST_WISE_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=?  AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT.TESTGROUP_COMBO_LAB_WISE_HIVT_REQUISITION_HEADER=Select distinct    hgnum_group_code as groupcode ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus FROM hivt_requisition_dtl a       WHERE hgnum_group_code is not null and gnum_hospital_code \=?    AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))

SELECT.HIVT_ITEM_CONSUMPTION_DTL.COUNT=select count(* ) from HIVT_ITEM_COMSUMPTION_DTL where hivtnum_req_dno=? and  HBNUM_OTHER_ITEM_CODE=? and GNUM_HOSPITAL_CODE=? and gnum_isvalid=? and hbnum_slno=?

INSERT.HIVT_ITEM_CONSUMPTION_DTL.CONSUMPTION_DTL=INSERT INTO HIVT_ITEM_COMSUMPTION_DTL (GNUM_HOSPITAL_CODE,hivtnum_req_dno,HBSTR_ITEM_NAME,HBNUM_OTHER_ITEM_CODE,HBNUM_SLNO,HIVNUM_LABORATORY_CODE,GNUM_ISVALID,HIVNUM_TEST_CODE,HBSTR_LOT_NO,GNUM_SEAT_ID,GDT_ENTRY_DATE,HBNUM_ITEM_TYPE,HBSTR_MANUFACTURE,HBDT_EXPIRY_DATE,HBSTR_REMARK,HSTNUM_STORE_ID,HSTNUM_ITEM_ID,HIVNUM_QUANTITY,HRGNUM_PUK,HIVNUM_UNIT,GNUM_LAST_MOD_SEAT_ID,GNUM_LAST_MOD_DATETIME)VALUES(?,?,?,?,(select NVL(Max(hbnum_slno)+1,0) from hivt_item_comsumption_dtl where hivtnum_req_dno=? and hbnum_other_item_code=? and gnum_hospital_code=?),?,?,?,?,?,SYSDATE,?,?,To_Date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,SYSDATE)

SELECT.HIVT_ITEM_USES_DTL.LOT=select  hbstr_lot_no||'#'||hbstr_manufacture||'#'||To_char(hbdt_expiry_date,'dd-Mon-yyyy')||'#'||hbnum_other_item_code||'#'||hstnum_store_id||'#'||hbnum_item_type||'#'||hstnum_item_id  as itemId,hbstr_lot_no as itemName from hivt_item_uses_dtl where hbnum_other_item_code=? and gnum_isvalid=? and hbnum_uses_stauts=?

SELECT.HIVT_ITEM_COMSUMPTION_DTL.LOT.QUANTITY=select  hbstr_lot_no||'#'||hbstr_manufacture||'#'||To_char(hbdt_expiry_date,'dd-Mon-yyyy')||'#'||hbnum_other_item_code||'#'||hstnum_store_id||'#'||hbnum_item_type||'#'||hstnum_item_id  as itemId,hivnum_quantity as itemName from hivt_item_comsumption_dtl where hivtnum_req_dno=? and hbnum_other_item_code=? and  gnum_hospital_code=? and gnum_isvalid=?

UPDATE.HIVT_ITEM_CONSUMPTION_DTL.CONSUMPTION_DTL=UPDATE HIVT_ITEM_COMSUMPTION_DTL SET GNUM_HOSPITAL_CODE=?, hivtnum_req_dno=?,HBSTR_ITEM_NAME=?,HBNUM_OTHER_ITEM_CODE=?,HIVNUM_LABORATORY_CODE=?,GNUM_ISVALID=?,HIVNUM_TEST_CODE=?,HBSTR_LOT_NO=?,HBNUM_ITEM_TYPE=?,HBSTR_MANUFACTURE=?,HBDT_EXPIRY_DATE=To_Date(?,'dd-Mon-yyyy'),HBSTR_REMARK=?,HSTNUM_STORE_ID=?,HSTNUM_ITEM_ID=?,HIVNUM_QUANTITY=?,HRGNUM_PUK=?,HIVNUM_UNIT=?,GNUM_LAST_MOD_SEAT_ID=?,GNUM_LAST_MOD_DATETIME=SYSDATE where hivtnum_req_dno=? and hbnum_other_item_code=? and  gnum_hospital_code=? and gnum_isvalid=? and hbnum_slno=?

SELECT.HIVT_REQUISITION_HEADER.PATIENT_DTL=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=? and GNUM_HOSPITAL_CODE \=? and HIVNUM_REQ_NO\=?

SELECT.HIVT_ITEM_COMSUMPTION_DTL.ITEM_LIST=select hivnum_unit as unitCode,hstnum_store_id as storeName,HBNUM_SLNO AS slno,hstnum_item_id as itemID,hbnum_item_type as itemTypeID, hbstr_manufacture as manufacture, hivnum_quantity as defaultQuantity,hbnum_other_item_code as otherItemID,hbstr_item_name as itemName,hbstr_lot_no as  lotNo,To_char(hbdt_expiry_date,'dd-Mon-yyyy') as expiryDate ,(select gstr_uom  from hivt_uom_mst where gnum_uom_code=a.hivnum_unit and gnum_isvalid=a.gnum_isvalid) as unitName,(select hgstr_itemtype_name from hivt_itemtype_mst where hbnum_itemtype_code=a.hbnum_item_type and gnum_isvalid=a.gnum_isvalid) as itemType from hivt_item_comsumption_dtl a where hivtnum_req_dno=? and gnum_hospital_code=? and gnum_isvalid=?
 
SELECT.HIVT_ITEM_USES_DTL.TEMP_ITEM_LIST=select hstnum_store_id as storeName,hstnum_item_id as itemID,hbnum_item_type as itemTypeID, hbstr_manufacture as manufacture ,hbnum_other_item_code as otherItemID,hbstr_item_name as itemName,hbstr_lot_no as  lotNo,To_char(hbdt_expiry_date,'dd-Mon-yyyy') as expiryDate ,(select gstr_uom  from hivt_uom_mst where gnum_uom_code=(select hivnum_unit from hivt_other_item_mst where hbnum_other_item_code=a.hbnum_other_item_code limit  1) and gnum_isvalid=a.gnum_isvalid) as unit,(select hgstr_itemtype_name from hivt_itemtype_mst where hbnum_itemtype_code=a.hbnum_item_type and gnum_isvalid=a.gnum_isvalid) as itemType,(select hivnum_unit from hivt_other_item_mst where hbnum_other_item_code=a.hbnum_other_item_code limit  1) as unitCode from hivt_item_uses_dtl a where gnum_isvalid=? and gnum_hospital_code=? AND HBDT_USES_START_DATE<=SYSDATE AND HBDT_USES_END_DATE>=SYSDATE AND HBDT_EXPIRY_DATE>SYSDATE AND hbstr_lot_no NOT IN (select  hbstr_lot_no from hivt_item_comsumption_dtl B where hivtnum_req_dno=? and gnum_hospital_code=? and gnum_isvalid=?) and hbnum_uses_stauts=?
DELETE.HIVT_ITEM_CONSUMPTION_DTL.CONSUMPTION_DTL=UPDATE HIVT_ITEM_COMSUMPTION_DTL SET GNUM_ISVALID=? WHERE hivtnum_req_dno=? AND hbnum_slno=? and hbnum_other_item_code=? and gnum_hospital_code=?


# addede by chandan  for addendum 
 SELECT_ADDENDUM.SAMPLENO_COMBO_RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select distinct hivnum_temp_sample_no as sampleNo,hivnum_temp_sample_no as sampleNo,(Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter,hivnum_reqdtl_status as reqDtlStatus  FROM hivt_requisition_dtl a       WHERE hivnum_temp_sample_no is not null and gnum_hospital_code \=? and hivnum_req_no in ( select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code\=? and hrgnum_puk\=?  ) AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))     

 # for addendum reason list 
 SELECT_REASON_LIST.HIVT_ADDENDUMDUM_REASON_MST=select hgnum_reason_code as reasonCode,gstr_reason as reason from hivt_addendum_reason_mst where gnum_isvalid=1
 
#update dept entry requisition dtl table sept 14,2016
UPDATE.REQDTLS.DEPT.RESULT.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_dept_result_date\=SYSDATE, hivnum_dept_result_seatid\=?,  hivnum_dept_reqdtl_status\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=? 
UPDATE.REQDTLS.DEPT.RESULT.ENTRY.MODIFY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivtdt_dept_res_modify_date\=SYSDATE, hivtnum_dept_res_modify_seatid\=?, hivnum_dept_reqdtl_status\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?


SELECT.DEPT_RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_dept_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_dept_reqdtl_status in (33,34)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? and  TRUNC (a.hivdt_dept_report_date + INTERVAL '1 day') >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))
SELECT.DEPT_RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_dept_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_dept_reqdtl_status\=32  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t
UPDATE.REQDTLS.DEPT.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl   SET hivnum_dept_reqdtl_status\=?, hivtdt_dept_res_print_date\=SYSDATE, hivtnum_dept_res_print_seatid\=? WHERE hivtnum_req_dno\=?

GET_HYPERLINK_DATA_OGANISM_CODE=select hivtnum_organism_code  from hivt_wo_orgaantibiotics_dtl where gnum_isvalid=? and gnum_hospital_code=? and hivtnum_req_dno=? and hivtnum_req_no=? and hivtnum_testparameter_code=?

COMBO.ANTIBITIC_NAME.HIVT_ORGANISM_ANTIBIOTIC_MAPPING_MST11=select  hgnum_antibiotic_code as antibioticCode,INITCAP(hgstr_antibiotic_name)as antibioticName from hivt_antibiotic_mst where gnum_isvalid=1 and hgnum_antibiotic_code  IN(select gnum_antibiotic_code from hivt_organism_antibiotic_mapping_mst where gnum_isvalid=? and hgnum_organism_code=? )


#inprocess report new form			

CHECK.RESULT.ENTRY.DETAIL.HIVT_JOBWORKORDER_DATA=select count(*) from hivt_jobworkorder_data where gnum_hospital_code=? and hivnum_req_dno=?

UPDATE.RESULT.ENTRY.DETAIL.HIVT_JOBWORKORDER_DATA=update hivt_jobworkorder_data set gnum_status_code=1 where gnum_hospital_code=? and hivnum_req_dno=?

#SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER_INPROCESS=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=13  and a.gnum_hospital_code \=?   and TRUNC (a.hivt_entry_date) >= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) 
SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER_INPROCESS=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=13  and a.gnum_hospital_code \=?   and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) 
											
UPDATE.HIVT_WO_ORGAANTIBIOTICS_DTL1=update HIVT_WO_ORGAANTIBIOTICS_DTL set gnum_isvalid=0 where HIVTNUM_REQ_DNO=? and HIVTNUM_REQ_NO=?   and GNUM_HOSPITAL_CODE=? 
						
						
											
#SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL_FETCH_SAMPLENO=Select  distinct(b.hivnum_req_no),nvl(gnum_machine_code,'-1') as defaultmachineCode,(select gstr_sample_short_name from hivt_sample_mst a where a.gnum_sample_code=b.gnum_sample_code)as shortSampleName,b.hivnum_sample_no as tempSampleNO, a.HRGNUM_PUK as patCRNo ,a.HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid=1 and GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName ,to_char(a.HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, a.HRGDT_DOB as patDOB ,a.HIVNUM_REQHEADER_STATUS as reqHeaderStatus,a.GNUM_EPISODE_CODE as episodeCode,INITCAP(a.HRGSTR_PATNAME) as patName, a.GSTR_GENDER_CODE as patGenderCode,a.HBNUM_REQUISITION_TYPE as reqType,to_char(a.HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,a.HIVSTR_AGE as patAge ,a.HIPNUM_ADMNO as patAdmNo, NVL(a.HIVSTR_ADDRESS,'-') as patAddress,a.HIPNUM_WARDCODE as patWardCode,NVL(a.HRGSTR_MOBILE_NO,'-') as patMobile, NVL(a.HRGSTR_EMAIL_ID,'-') as patEmail,a.HIPNUM_ROOM_CODE as patRoomCode,a.HIPNUM_BED_CODE as patBedCode,a.HRGSTR_MLC_NO as patMlcNo ,NVL(a.HIPSTR_BED_NAME,'-') as patBedName,NVL(a.HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(a.HIPSTR_WARD_NAME,'-') as patWardName,NVL(a.GSTR_DEPT_NAME,'-') as patDeptName, NVL(a.HGSTR_UNIT_NAME,'-') as patUnitName,a.HGNUM_DEPT_CODE as patDeptCode,a.HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(a.HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER a,hivt_requisition_dtl b where  b.hivnum_reqdtl_status = 4 and    b.hivnum_sample_no IS NOT NULL   and b.gnum_hospital_code=a.gnum_hospital_code and b.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO  and b.gnum_hospital_code=? and b.hivnum_temp_sample_no=? and TRUNC(b.hivt_entry_date) >= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(b.hivt_entry_date) <= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) 
#SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL_FETCH_SAMPLENO=Select  distinct(b.hivnum_req_no),(TO_CHAR(b.hivdt_coll_date_time,'DD-Mon-YYYY')) as collDate,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select gstr_sample_short_name from hivt_sample_mst a where a.gnum_sample_code=b.gnum_sample_code)as shortSampleName,b.hivnum_sample_no as tempSampleNO, a.HRGNUM_PUK as patCRNo ,a.HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid=1 and GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName ,to_char(a.HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, a.HRGDT_DOB as patDOB ,a.HIVNUM_REQHEADER_STATUS as reqHeaderStatus,a.GNUM_EPISODE_CODE as episodeCode,INITCAP(a.HRGSTR_PATNAME) as patName, a.GSTR_GENDER_CODE as patGenderCode,a.HBNUM_REQUISITION_TYPE as reqType,to_char(a.HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,a.HIVSTR_AGE as patAge ,a.HIPNUM_ADMNO as patAdmNo, NVL(a.HIVSTR_ADDRESS,'-') as patAddress,a.HIPNUM_WARDCODE as patWardCode,NVL(a.HRGSTR_MOBILE_NO,'-') as patMobile, NVL(a.HRGSTR_EMAIL_ID,'-') as patEmail,a.HIPNUM_ROOM_CODE as patRoomCode,a.HIPNUM_BED_CODE as patBedCode,a.HRGSTR_MLC_NO as patMlcNo ,NVL(a.HIPSTR_BED_NAME,'-') as patBedName,NVL(a.HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(a.HIPSTR_WARD_NAME,'-') as patWardName,NVL(a.GSTR_DEPT_NAME,'-') as patDeptName, NVL(a.HGSTR_UNIT_NAME,'-') as patUnitName,a.HGNUM_DEPT_CODE as patDeptCode,a.HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(a.HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER a,hivt_requisition_dtl b where  b.hivnum_reqdtl_status = 4 and    b.hivnum_sample_no IS NOT NULL   and b.gnum_hospital_code=a.gnum_hospital_code and b.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO  and b.gnum_hospital_code=? and b.hivnum_temp_sample_no=? and TRUNC(b.hivt_entry_date) >= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(b.hivt_entry_date) <= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and  b.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1  AND  p.gnum_module_id = 15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?  AND p.gnum_hospital_code = b.gnum_hospital_code )
#SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL_FETCH_SAMPLENO=Select  distinct(b.hivnum_req_no),(TO_CHAR(b.hivdt_coll_date_time,'DD-Mon-YYYY')) as collDate,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select gstr_sample_short_name from hivt_sample_mst a where a.gnum_sample_code=b.gnum_sample_code)as shortSampleName,b.hivnum_sample_no as tempSampleNO, a.HRGNUM_PUK as patCRNo ,a.HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid=1 and GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName ,to_char(a.HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, a.HRGDT_DOB as patDOB ,a.HIVNUM_REQHEADER_STATUS as reqHeaderStatus,a.GNUM_EPISODE_CODE as episodeCode,INITCAP(a.HRGSTR_PATNAME) as patName, a.GSTR_GENDER_CODE as patGenderCode,a.HBNUM_REQUISITION_TYPE as reqType,to_char(a.HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,a.HIVSTR_AGE as patAge ,a.HIPNUM_ADMNO as patAdmNo, NVL(a.HIVSTR_ADDRESS,'-') as patAddress,a.HIPNUM_WARDCODE as patWardCode,NVL(a.HRGSTR_MOBILE_NO,'-') as patMobile, NVL(a.HRGSTR_EMAIL_ID,'-') as patEmail,a.HIPNUM_ROOM_CODE as patRoomCode,a.HIPNUM_BED_CODE as patBedCode,a.HRGSTR_MLC_NO as patMlcNo ,NVL(a.HIPSTR_BED_NAME,'-') as patBedName,NVL(a.HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(a.HIPSTR_WARD_NAME,'-') as patWardName,NVL(a.GSTR_DEPT_NAME,'-') as patDeptName, NVL(a.HGSTR_UNIT_NAME,'-') as patUnitName,a.HGNUM_DEPT_CODE as patDeptCode,a.HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(a.HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER a,hivt_requisition_dtl b where  b.hivnum_reqdtl_status = 4 and    b.hivnum_sample_no IS NOT NULL   and b.gnum_hospital_code=a.gnum_hospital_code and b.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO  and b.gnum_hospital_code=? and b.hivnum_temp_sample_no=? and TRUNC(b.hivdt_coll_date_time) >= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(b.hivdt_coll_date_time) <= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and  b.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1  AND  p.gnum_module_id = 15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?  AND p.gnum_hospital_code = b.gnum_hospital_code )
SELECT.SAMPLE_ACCEPTANCE_TROUGH_BARCODE_HIVT_REQUISITION_DTL_FETCH_SAMPLENO=Select  distinct(b.hivnum_req_no),hivnum_temp_sample_no as sampleNo,(TO_CHAR(b.hivdt_coll_date_time,'DD-Mon-YYYY')) as collDate,nvl(gnum_machine_code,'-1') as defaultmachineCode,(select gstr_sample_short_name from hivt_sample_mst a where a.gnum_sample_code=b.gnum_sample_code)as shortSampleName,b.hivnum_sample_no as tempSampleNO, a.HRGNUM_PUK as patCRNo ,a.HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid=1 and GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName ,to_char(a.HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, a.HRGDT_DOB as patDOB ,a.HIVNUM_REQHEADER_STATUS as reqHeaderStatus,a.GNUM_EPISODE_CODE as episodeCode,INITCAP(a.HRGSTR_PATNAME) as patName, a.GSTR_GENDER_CODE as patGenderCode,a.HBNUM_REQUISITION_TYPE as reqType,to_char(a.HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,a.HIVSTR_AGE as patAge ,a.HIPNUM_ADMNO as patAdmNo, NVL(a.HIVSTR_ADDRESS,'-') as patAddress,a.HIPNUM_WARDCODE as patWardCode,NVL(a.HRGSTR_MOBILE_NO,'-') as patMobile, NVL(a.HRGSTR_EMAIL_ID,'-') as patEmail,a.HIPNUM_ROOM_CODE as patRoomCode,a.HIPNUM_BED_CODE as patBedCode,a.HRGSTR_MLC_NO as patMlcNo ,NVL(a.HIPSTR_BED_NAME,'-') as patBedName,NVL(a.HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(a.HIPSTR_WARD_NAME,'-') as patWardName,NVL(a.GSTR_DEPT_NAME,'-') as patDeptName, NVL(a.HGSTR_UNIT_NAME,'-') as patUnitName,a.HGNUM_DEPT_CODE as patDeptCode,a.HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(a.HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER a,hivt_requisition_dtl b where  b.hivnum_reqdtl_status = 4 and    b.hivnum_sample_no IS NOT NULL   and b.gnum_hospital_code=a.gnum_hospital_code and b.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO  and b.gnum_hospital_code=? and upper(b.hivnum_temp_sample_no)=upper(?) and TRUNC(b.hivdt_coll_date_time) >= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(b.hivdt_coll_date_time) <= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and  b.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1  AND  p.gnum_module_id = 15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?  AND p.gnum_hospital_code = b.gnum_hospital_code )
										
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_BARCODE=Select (select gstr_test_name from hivt_test_mst where gnum_test_code\=b.gnum_test_code and gnum_isvalid\=1) as testName,hrgstr_patname as patName,to_char(HIVDT_coll_DATE_time,'DD-Mon-YYYY') as sampleCollectionDate,(select gstr_sample_name  from hivt_sample_mst c where c.gnum_sample_code\=b.gnum_sample_code) as sampleName,b.gnum_sample_code as sampleCode,b.hivnum_sample_no as sampleNO,hivnum_temp_sample_no as tempSampleNO,a.HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A,HIVT_REQUISITION_DTL b where gnum_isvalid\=1 and a.HIVNUM_REQ_NO\=b.HIVNUM_REQ_NO and a.gnum_hospital_Code\=b.gnum_hospital_Code and a.GNUM_HOSPITAL_CODE \=?   and a.GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and a.gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and a.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL k WHERE k.HIVNUM_REQDTL_STATUS in (?,?) AND k.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND k.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and k.gnum_test_code\=b.gnum_test_code and k.gnum_lab_code\=b.gnum_lab_code )   
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_BARCODE=Select gnum_test_code as testCode,(select gstr_test_name from hivt_test_mst where gnum_test_code\=b.gnum_test_code and gnum_isvalid\=1) as testName,hrgstr_patname as patName,to_char(HIVDT_coll_DATE_time,'DD-Mon-YYYY') as sampleCollectionDate,(select gstr_sample_name  from hivt_sample_mst c where c.gnum_sample_code\=b.gnum_sample_code) as sampleName,b.gnum_sample_code as sampleCode,b.hivnum_sample_no as sampleNO,hivnum_temp_sample_no as tempSampleNO,a.HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A,HIVT_REQUISITION_DTL b where gnum_isvalid\=1 and a.HIVNUM_REQ_NO\=b.HIVNUM_REQ_NO and a.gnum_hospital_Code\=b.gnum_hospital_Code and a.GNUM_HOSPITAL_CODE \=?   and a.GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and a.gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and a.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL k WHERE k.HIVNUM_REQDTL_STATUS in (?,?,?,?) AND k.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND k.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and k.gnum_test_code\=b.gnum_test_code and k.gnum_lab_code\=b.gnum_lab_code )  
#SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_BARCODE=Select gnum_test_code as testCode,(select gstr_test_name from hivt_test_mst where gnum_test_code\=b.gnum_test_code and gnum_isvalid\=1) as testName,hrgstr_patname as patName,to_char(HIVDT_coll_DATE_time,'DD-Mon-YYYY') as sampleCollectionDate,(select gstr_sample_name  from hivt_sample_mst c where c.gnum_sample_code\=b.gnum_sample_code) as sampleName,b.gnum_sample_code as sampleCode,b.hivnum_sample_no as sampleNO,hivnum_temp_sample_no as tempSampleNO,a.HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A,HIVT_REQUISITION_DTL b where gnum_isvalid\=1 and a.HIVNUM_REQ_NO\=b.HIVNUM_REQ_NO and a.gnum_hospital_Code\=b.gnum_hospital_Code and a.GNUM_HOSPITAL_CODE \=?   and a.GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and a.gnum_hospital_Code \=?  ) and a.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL k WHERE k.HIVNUM_REQDTL_STATUS in (?,?,?,?) AND k.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND k.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and k.gnum_test_code\=b.gnum_test_code and k.gnum_lab_code\=b.gnum_lab_code )  
SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_BARCODE=Select INITCAP (pkg_clinical_util_fun.get_dept_name(a.gnum_hospital_code,(Select gnum_dept_code from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1))) as departmentName,(Select nvl(gnum_isdept_print_barcode,'0') from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1) as is_dept_barcode_print,gnum_test_code as testCode,(select gstr_test_name from hivt_test_mst where gnum_test_code\=b.gnum_test_code and gnum_isvalid\=1) as testName,hrgstr_patname as patName,to_char(HIVDT_coll_DATE_time,'DD-Mon-YYYY') as sampleCollectionDate,(select gstr_sample_name  from hivt_sample_mst c where c.gnum_sample_code\=b.gnum_sample_code) as sampleName,b.gnum_sample_code as sampleCode,b.hivnum_sample_no as sampleNO,hivnum_temp_sample_no as tempSampleNO,a.HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,a.GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A,HIVT_REQUISITION_DTL b where gnum_isvalid\=1 and a.HIVNUM_REQ_NO\=b.HIVNUM_REQ_NO and a.gnum_hospital_Code\=b.gnum_hospital_Code and a.GNUM_HOSPITAL_CODE \=?   and a.GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and a.gnum_hospital_Code \=?  ) and a.gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL k WHERE k.HIVNUM_REQDTL_STATUS in (?,?,?,?) AND k.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND k.HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO and k.gnum_test_code\=b.gnum_test_code and k.gnum_lab_code\=b.gnum_lab_code )
  
#sample acc
 SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_SAMPLE_ACC=SELECT hgnum_pat_status_code as patvisittypecode,a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId,hgnum_patient_cat_code as code ,bill_mst.getcatgrp(a.hgnum_patient_cat_code,?) as patCategoryGroup FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   
 
 
 
 # report hisotry 
 #SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY=select gnum_service_id as serviceId,to_char(gdt_entry_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,DATE_PART('minute', sysdate::time - gdt_entry_date::time) as activeTime from hivt_report_service_dtl where gnum_isvalid=1 order by (DATE_PART('minute', sysdate::time - gdt_entry_date::time)<=gnum_frequency) desc,gdt_entry_date desc
 
 #SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY_ALL=select gnum_service_id as serviceId,to_char(gdt_entry_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_insert_date,'dd-Mon-yyyy hh24:mi') as insertDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,DATE_PART('minute', sysdate::time - gdt_entry_date::time) as activeTime,gnum_isvalid as isValid,gstr_mongo_db_name as mongoDbNmae,gstr_mongo_uri as mongoUri,gstr_pg_uri as pgUri,gstr_pg_username as pgUsername,gstr_report_service_path as reportPath from hivt_report_service_dtl where   trunc(gdt_entry_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(gdt_entry_date)<=trunc(to_date(?,'dd-mon-yyyy')) order by (DATE_PART('minute', sysdate::time - gdt_entry_date::time)<=gnum_frequency) desc,gnum_isvalid asc,gdt_entry_date desc
 
 
 #SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY1=select gnum_service_id as serviceId,to_char(gdt_entry_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_insert_date,'dd-Mon-yyyy hh24:mi') as insertDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,((DATE_PART('day', sysdate::timestamp - gdt_entry_date::timestamp) * 24 + DATE_PART('hour', sysdate::timestamp - gdt_entry_date::timestamp)) * 60 + DATE_PART('minute', sysdate::timestamp - gdt_entry_date::timestamp)) as activeTime,gstr_mongo_db_name as mongoDbNmae,gstr_mongo_uri as mongoUri,gstr_pg_uri as pgUri,gstr_pg_username as pgUsername,gstr_report_service_path as reportPath,gnum_isvalid as isValid from hivt_report_service_dtl where gnum_isvalid=1 and  trunc(gdt_entry_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(gdt_entry_date)<=trunc(to_date(?,'dd-mon-yyyy')) order by gdt_entry_date desc 
 
 
 
 SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY=select gnum_service_id as serviceId,to_char(gdt_update_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,(EXTRACT( EPOCH from age( to_char(sysdate,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp)::INTERVAL)/60) as activeTime,(age( to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char((gdt_insert_date),'Mon-dd-yyyy hh24:mi')::timestamp)) as activeReportTime from hivt_report_service_dtl where gnum_isvalid=1 order by gdt_update_date desc
 
 SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY_ALL=select gnum_service_id as serviceId,to_char(gdt_update_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_insert_date,'dd-Mon-yyyy hh24:mi') as insertDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,(EXTRACT( EPOCH from age( to_char(sysdate,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp)::INTERVAL)/60) as activeTime,gnum_isvalid as isValid,gstr_mongo_db_name as mongoDbNmae,gstr_mongo_uri as mongoUri,gstr_pg_uri as pgUri,gstr_pg_username as pgUsername,gstr_report_service_path as reportPath,(age( to_char(gdt_lst_date,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char((gdt_insert_date),'Mon-dd-yyyy hh24:mi')::timestamp)) as activeReportTime from hivt_report_service_dtl where  gnum_isvalid=0 and   trunc(gdt_update_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(gdt_update_date)<=trunc(to_date(?,'dd-mon-yyyy')) order by gnum_isvalid desc,gdt_update_date desc
 
 SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY_ALL_INACTIVE=select gnum_service_id as serviceId,to_char(gdt_update_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_insert_date,'dd-Mon-yyyy hh24:mi') as insertDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,(EXTRACT( EPOCH from age( to_char(sysdate,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp)::INTERVAL)/60) as activeTime,gnum_isvalid as isValid,gstr_mongo_db_name as mongoDbNmae,gstr_mongo_uri as mongoUri,gstr_pg_uri as pgUri,gstr_pg_username as pgUsername,gstr_report_service_path as reportPath,(age( to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char((gdt_insert_date),'Mon-dd-yyyy hh24:mi')::timestamp)) as activeReportTime from hivt_report_service_dtl where gnum_isvalid=1 and  trunc(gdt_update_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(gdt_update_date)<=trunc(to_date(?,'dd-mon-yyyy')) order by gnum_isvalid desc,gdt_update_date desc
 
 SELECT_LIST_DATA_SHOW_FOR_ACTIVE_REPORT_HISTORY1=select gnum_service_id as serviceId,to_char(gdt_update_date,'dd-Mon-yyyy hh24:mi') as entryDate,to_char(gdt_insert_date,'dd-Mon-yyyy hh24:mi') as insertDate,to_char(gdt_lst_date,'dd-Mon-yyyy hh24:mi') as lastDate,gnum_frequency as frequency,(EXTRACT( EPOCH from age( to_char(sysdate,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp)::INTERVAL)/60) as activeTime,gstr_mongo_db_name as mongoDbNmae,gstr_mongo_uri as mongoUri,gstr_pg_uri as pgUri,gstr_pg_username as pgUsername,gstr_report_service_path as reportPath,gnum_isvalid as isValid,(age( to_char(gdt_update_date,'Mon-dd-yyyy hh24:mi')::timestamp ,  to_char((gdt_insert_date),'Mon-dd-yyyy hh24:mi')::timestamp)) as activeReportTime from hivt_report_service_dtl where gnum_isvalid=1 and  trunc(gdt_update_date)>=trunc(to_date(?,'dd-mon-yyyy')) and trunc(gdt_update_date)<=trunc(to_date(?,'dd-mon-yyyy')) order by gdt_update_date desc 
 
 #max reqdno for raising if addendum for same lab
 SELECT.FIND_MAX_REQDNO.HIVT_REQ_HEADER=select (max(hivtnum_req_dno)+1) from hivt_requisition_dtl where hivnum_req_no=? and gnum_hospital_code=?
 
 UPDATE.HIVT_REQ_HEADER_DIFF_LAB_ADDENDUM=update hivt_requisition_header set gnum_isassociated_test=1,gnum_associated_reqno=? where hivnum_req_no=? and gnum_hospital_code=?
 
 SELECT_LIST_DATA_FOR_ADDEDNDUM_TEST_ON_OLD_REQ_DNO_HIVT_REQUISITION_DTL=select hivdt_report_date as reportDate,hivstr_report_url as reportUrl,gnum_change_count as changeCount,gnum_report_change as reportChange,hivnum_reportchange_seatid as reportChangeSeatId,hivdt_reportchange_date as reportChangeDate,hivnum_temp_sample_no as tempSampleNo,hivdt_acceptance_date_time as strAcceptanceDateTime,hivdt_acceptance_seatid as strAcceptanceSeatId,hivdt_coll_date_time as strCollDateTime ,hivnum_collection_seatid as strCollectionSeatId,hivnum_sample_col_area_code  as strSampleCollectionAreaCode,hivnum_issample_received as is_Sample_Received,hivnum_sample_no as sampleNo,hivnum_uom as uomCode,hivnum_collected_volume as collectedVolume,hivnum_containercode as containerCode,hgstr_daily_labno as strDailyLabNo ,hivnum_isaccepted as strIsAccepted from hivt_requisition_dtl where hivtnum_req_dno=? and gnum_hospital_code=?

 UPDATE.HIVT_REQ_DTL_ADENDUM_TEST=UPDATE HIVT_REQUISITION_DTL b SET is_addendum=?,hivdt_report_date=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),hivstr_report_url=?,gnum_change_count=?,gnum_report_change=?,hivnum_reportchange_seatid=?,hivdt_reportchange_date=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),hivnum_reqdtl_status=?,HIVNUM_SAMPLE_NO=?,HIVNUM_TEMP_SAMPLE_NO=?,HIVDT_COLL_DATE_TIME=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),HIVNUM_COLLECTION_SEATID=?,HIVNUM_SAMPLE_COL_AREA_CODE=?,hivnum_issample_received=?,hivnum_isaccepted=?,HIVDT_ACCEPTANCE_DATE_TIME=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),HIVDT_ACCEPTANCE_SEATID=?,HGSTR_DAILY_LABNO=?,hivnum_uom=?,hivnum_collected_volume=?,hivnum_containercode=? where HIVTNUM_REQ_DNO=? and GNUM_HOSPITAL_CODE=? ;
 
 #SELECT.PATIENT_HIVT_REQUISITION_HEADER_ADDENDUM=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING,DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying,  (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail ,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE testCode, (Select GSTR_TEST_NAME from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL ,hivtnum_priority_all as priorityCode, decode(hivtnum_priority_all,1,'Normal',2,'Urgent') as priority, to_Char(HIVT_ENTRY_DATE,'DD-Mon-YYYY') as requisitionDate,HIVNUM_REQDTL_STATUS, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE,HGNUM_GROUP_TYPE, (Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as labNoConfiguration,(select 'Patient\#'||gstr_instruction_post from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select 'Technician\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionColl,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded  from HIVT_REQUISITION_DTL a where  HIVNUM_REQDTL_STATUS in(6) AND HIVNUM_REQ_NO\=?  and gnum_hospital_code\=?
 
 SELECT.PATIENT_HIVT_REQUISITION_HEADER_ADDENDUM=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING,DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying,  (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail ,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE testCode, (Select GSTR_TEST_NAME from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL ,hivtnum_priority_all as priorityCode, decode(hivtnum_priority_all,1,'Normal',2,'Urgent') as priority, to_Char(HIVT_ENTRY_DATE,'DD-Mon-YYYY') as requisitionDate,HIVNUM_REQDTL_STATUS, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE,HGNUM_GROUP_TYPE, (Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as labNoConfiguration,(select 'Patient\#'||gstr_instruction_post from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionPat,(select 'Technician\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as instructionColl,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded,( select bc.hivtstr_labno_format  ||'\#'|| bc.gdt_initialization_date ||'\#'|| bc.gnum_no_of_seq_digits  ||'\#'|| bc.gnum_from_series ||'\#'|| bc.gnum_to_series  ||'\#'|| bc.gnum_init_type  ||'\#'||bc.hivstr_running_lab_no  ||'\#'|| bc.gnum_lab_code  ||'\#'||bc.gnum_sq_no ||'\#'||bc.gnum_pat_type ||'\#'||bc.gnum_test_code||'\#'||nvl(bc.acceptance_area,'null')||'\#'||nvl((bc.islabnoareawise),'0')||'\#' from hivt_labno_conf_mst bc  where  bc.gnum_lab_code\=a.gnum_lab_code and bc.gnum_test_code in( -1 ,a.gnum_test_code) and bc.acceptance_area is null AND bc.gnum_is_valid\=1  and bc.gnum_hospital_code\=a.gnum_hospital_code) as checkboxajaxvalues  from HIVT_REQUISITION_DTL a where  HIVNUM_REQDTL_STATUS in(6) AND HIVNUM_REQ_NO\=?  and gnum_hospital_code\=?
 
 
 SELECT_PATSTATUS_ADDNDUM=select  DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus from HIVT_REQUISITION_HEADER A where gnum_isvalid=1 and gnum_hospital_code=? and HIVNUM_REQ_NO=?
 SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS_ADDENDUM=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient\#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code and gnum_labcode\=a.gnum_lab_code and gnum_test_code\=a.gnum_test_code  ) as isrequisitionformneeded from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (?,?) and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=?  
#added by chandan gupta
 SELECT_ALL_TETCODE_ADDENDUM=select array_to_string(array_agg(distinct gnum_test_code), ',')  from hivt_requisition_dtl where hivnum_req_no=? and gnum_hospital_code=? GROUP BY hivnum_req_no;
 
 SELECT.BILLINGSTATUS.HIVT_REQUISITION_DTL= Select Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail from HIVT_REQUISITION_DTL a where HIVNUM_REQ_NO\= ? and gnum_test_code\=? and gnum_hospital_code\=? order by HIVTNUM_REQ_DNO 
 
 
 
  #report download
 SELECT.FETCH_MOBILE_NO.HRGT_PATIENT_DTL=SELECT NVL(hrgstr_mobile_no,'-') as patMobileNo FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   
 
 SELECT.FETCH_USERNAME.HRGT_PATIENT_DTL=SELECT hrgstr_fname as patusername FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?
 
 #SELECT.LIST.HIVT_REQUISITION_DTL_PUBLIC_REPORT=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where hrgnum_puk\=? and gnum_isvalid\=1) and hivnum_reqdtl_status in (26,14)and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (sysdate - INTERVAL '15 day', 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (sysdate, 'DD-Mon-YYYY')) order by hivdt_report_date desc, hivdt_coll_date_time,hivdt_acceptance_date_time,tempSampleNo,labNo,hivtnum_req_dno 
 
 #SELECT.LIST.HIVT_REQUISITION_DTL_PUBLIC_REPORT=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(select to_char(hivdt_requisition_date,'DD-Mon-YYYY') from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as reqDate,to_char(hivdt_report_date,'DD-Mon-YYYY') as reportDate,(select to_char(hivdt_requisition_date,'YYYY-MM-DD') from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as reqDatee,to_char(hivdt_report_date,'YYYY-MM-DD') as reportDatee FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where hrgnum_puk\=? and gnum_isvalid\=1) and hivnum_reqdtl_status in (26,14)and TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (sysdate - INTERVAL '15 day', 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (sysdate, 'DD-Mon-YYYY')) order by hivdt_report_date desc, hivdt_coll_date_time,hivdt_acceptance_date_time,tempSampleNo,labNo,hivtnum_req_dno 
 
 SELECT.LIST.HIVT_REQUISITION_DTL_PUBLIC_REPORT=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName,(select to_char(hivdt_requisition_date,'DD-Mon-YYYY') from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as reqDate,to_char(hivdt_report_date,'DD-Mon-YYYY') as reportDate,(select to_char(hivdt_requisition_date,'YYYY-MM-DD') from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as reqDatee,to_char(hivdt_report_date,'YYYY-MM-DD') as reportDatee FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where hrgnum_puk\=? and gnum_isvalid\=1) and hivnum_reqdtl_status in (26,14) order by hivdt_report_date desc, hivdt_coll_date_time,hivdt_acceptance_date_time,tempSampleNo,labNo,hivtnum_req_dno 
 
 
 INSERT_REPORT_DTL_HIVT_PUBLIC_REPORT_DTL=insert into hivt_public_report_dtl (hrgnum_puk,hivnum_req_no,gnum_isvalid,gdt_entry_date,gdt_report_print_date,hrgnum_ip_address)  values (?,?,?,sysdate,sysdate,?)
 
 SELECT.VALIDATE_CRNO_.HRGT_PATIENT_DTL=select count(*) from hrgt_patient_dtl where hrgnum_puk = ?
 
 INSERT_REPORT_LOGIN_DTL_HIVT_PUBLIC_REPORT_LOGIN_DTL=insert into hivt_public_report_login_dtl (hrgnum_puk,hrgnum_ip_address,gnum_isvalid,gdt_entry_date,gnum_count)  values (?,?,?,sysdate,(Select NVL(MAX(gnum_count),0)+1 from hivt_public_report_login_dtl where hrgnum_puk=? and gnum_isvalid=1))
 
 SELECT.GETBILLING_CHECK=select NVL(gnum_module_id,'0') from gblt_seat_role_mst where gnum_hospital_code=?  and gnum_module_id=? and gnum_seatid=? and gbl_isvalid=1  
 #added by chandan for matching testcodes search by word
 SELECT_TEST_CODES_KEYWORD=SELECT string_agg(GNUM_TEST_CODE,',') FROM hivt_test_mst  WHERE gnum_isvalid=1  
 #added by ashu for getting employee name
 #SELECT.LIST.PIST_EMP_REGISTRATION_DTL_EMP_NAME = SELECT DISTINCT str_emp_full_name from pist_emp_registration_dtl,hgbt_unit_consultant_mst where hgbt_unit_consultant_mst.hgstr_emp_code = pist_emp_registration_dtl.str_emp_no
 #SELECT.LIST.PIST_EMP_REGISTRATION_DTL_EMP_NAME = SELECT DISTINCT hgstr_emp_code as empCode,str_emp_full_name as empName from pist_emp_registration_dtl,hgbt_unit_consultant_mst where hgbt_unit_consultant_mst.hgstr_emp_code = pist_emp_registration_dtl.str_emp_no
 #SELECT.LIST.PIST_EMP_REGISTRATION_DTL_EMP_NAME = SELECT DISTINCT hgstr_emp_code as empCode,str_emp_full_name as empName from pist_emp_registration_dtl,hgbt_unit_consultant_mst where hgbt_unit_consultant_mst.hgstr_emp_code = pist_emp_registration_dtl.str_emp_no and substring(hgbt_unit_consultant_mst.hgnum_deptunitcode,1,3) IN (select gnum_dept_code from hivt_laboratory_mst where
 #SELECT.LIST.PIST_EMP_REGISTRATION_DTL_EMP_NAME = SELECT DISTINCT hgstr_emp_code as empCode,str_emp_full_name as empName from pist_emp_registration_dtl as e,hgbt_unit_consultant_mst as u where u.hgstr_emp_code = e.str_emp_no and u.gnum_isvalid = 1 and u.gnum_hospital_code = ? and substring(u.hgnum_deptunitcode,1,3) IN (select gnum_dept_code from hivt_laboratory_mst where
 SELECT.LIST.PIST_EMP_REGISTRATION_DTL_EMP_NAME = SELECT DISTINCT hgstr_emp_code as empCode,str_emp_full_name as empName from pist_emp_registration_dtl as e,hgbt_unit_consultant_mst as u where u.hgstr_emp_code = e.str_emp_no and u.gnum_isvalid = 1 and u.gnum_hospital_code = ? and substring(u.hgnum_deptunitcode,1,3) IN (select gnum_dept_code from hivt_laboratory_mst where gnum_dept_code in (SELECT p.gnum_column_value FROM gblt_role_seat_table_dtl p WHERE  p.gbl_isvalid =1  AND p.gnum_module_id=15 AND gstr_table_name = trim('GBLT_DEPARTMENT_MST') AND gstr_column_name = trim('GNUM_DEPT_CODE') AND p.gnum_seatid = ? AND p.gnum_hospital_code = ?) AND
 SELECT.RESULT_ADDENDUM_HIVT_REQUISITION_HEADER=SELECT ( SELECT CONCAT ( GSTR_TEST_NAME ,decode(hivstr_site, '1', '(NA)', '2', '(Both)', '3', '(Left)', '4', '(Right)') ) FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= a.gnum_test_code ) AS testName ,hivnum_req_no AS RequisitionNo ,hivnum_reqdtl_status AS reqDtlStatus ,a.hivtnum_req_dno AS requisitionDNo ,gbnum_priority_code AS priorityCode ,hivstr_dept_report_url AS deptReport ,hivstr_report_url AS reportUrl ,gnum_test_code AS testCode ,gnum_sample_code AS samplecode ,( SELECT HBNUM_REQUISITION_TYPE FROM hivt_requisition_header WHERE GNUM_HOSPITAL_CODE  \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO  \= A.HIVNUM_REQ_NO ) AS requisitionTypeCode ,NVL(concatstring('Select k.hivnum_parameter_code||''\#@''|| (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#@''||hivstr_ref_range||''\#@''||k.hivtstr_value from hivt_parameter_dtl k where k.gnum_isvalid\=1 and k.hivtnum_test_code \= ''' || a.gnum_test_code || ''' and k.hivtnum_req_dno\=''' || a.hivtnum_req_dno || ''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code || ''' order by hivtnum_order asc', '`'), '-1\#@-\#@-\#@-') AS testParameterName ,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName ,hivnum_req_no ,hgnum_group_code AS groupcode ,a.gnum_hospital_code AS hospitalcode ,CONCAT ( CONCAT ( hivnum_temp_sample_no ,'/' ) ,hgstr_daily_labno ) AS tempSampleNo ,hivnum_sample_no AS sampleNo ,hgstr_daily_labno AS labno ,hivnum_packing_list_no AS packinglistno ,gnum_lab_code AS labCode ,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) AS sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) AS testType ,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patCRNo ,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patVisitNo ,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patName ,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patGender ,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_patvistdate(a.hivnum_req_no, a.gnum_hospital_code) patvisitdat ,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS emailId ,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patBedName ,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) ,pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patAge ,pkg_inv_fun.fun_patient_status(a.hivnum_req_no, a.gnum_hospital_code) AS patStatus ,( SELECT hivt_report_available_after FROM hivt_laboratory_test_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_test_code \= a.gnum_test_code AND gnum_labcode \= a.gnum_lab_code ) AS reportAvailableAfter ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS episodeCode ,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS departmentcode ,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS patdeptunitcode ,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) AS requisitionTypeCode ,pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) || '-' || pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no, gnum_hospital_code) AS patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code, gnum_hospital_code) AS groupName ,hivnum_uom AS uomCode ,pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, gnum_hospital_code, gnum_lab_code) AS dynamicTemplatePrintedGroup ,pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, gnum_hospital_code, gnum_lab_code) AS dynamnicTemplateResultEntryGroup ,( SELECT gnum_finalremark_reqd FROM hivt_laboratory_mst WHERE gnum_isvalid \= 1 AND gnum_lab_code \= a.gnum_lab_code AND gnum_hospital_code \= a.gnum_hospital_code ) AS finalRemarkReqd ,( SELECT hivstr_final_remark FROM hivt_requisition_header WHERE gnum_isvalid \= 1 AND hivnum_req_no \= a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) AS finalRemarkString ,( SELECT gstr_instruction_tech FROM hivt_laboratory_test_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_labcode \= a.gnum_lab_code AND gnum_test_code \= a.gnum_test_code ) AS instructionPat ,( SELECT gnum_isrequisitionform_needed FROM hivT_laboratory_test_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_labcode \= a.gnum_lab_code AND gnum_test_code \= a.gnum_test_code ) AS isrequisitionformneeded ,( SELECT gnum_preference_order FROM hivT_laboratory_test_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_labcode \= a.gnum_lab_code AND gnum_test_code \= a.gnum_test_code ) AS preferenceOrder ,( SELECT hivstr_addendum_remark FROM hivt_requisition_header WHERE gnum_isvalid \= 1 AND hivnum_req_no \= a.hivnum_req_no AND gnum_hospital_code \= a.gnum_hospital_code ) AS addendumRemarkValue ,a.gnum_report_change AS reportChangeFlag ,hivnum_result_seatid as resultEntrySeat, hivtnum_res_val_seatid as resultValSeat ,hivtnum_res_reval_seatid as resultRevalSeat, (select b.HBNUM_IS_ADDENDUM_TYPE from hivt_laboratory_mst b where b.gnum_lab_code \= a.gnum_lab_code and b.gnum_hospital_code \= a.gnum_hospital_code and gnum_isvalid \= 1) as addendumType ,(select b.hbnum_allow_entryuser from hivt_laboratory_mst b where b.gnum_lab_code \= a.gnum_lab_code and b.gnum_hospital_code \= a.gnum_hospital_code and gnum_isvalid \= 1) as isAddendumEntryUser ,(select b.hbnum_allow_validationuser from hivt_laboratory_mst b where b.gnum_lab_code \= a.gnum_lab_code and b.gnum_hospital_code \= a.gnum_hospital_code and gnum_isvalid \= 1) as isAddendumValidUser ,(select b.hbnum_allow_revalidationuser from hivt_laboratory_mst b where b.gnum_lab_code \= a.gnum_lab_code and b.gnum_hospital_code \= a.gnum_hospital_code and gnum_isvalid \= 1) as isAddendumRevalUser,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid\=1 and p.gnum_hospital_code\=a.gnum_hospital_code and p.gnum_lab_code\=a.gnum_lab_code) as labtype FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code  \= ? AND a.gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id  \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name  \= 'GNUM_LAB_CODE' AND p.gnum_seatid  \= ? AND p.gnum_hospital_code  \= ? ) AND TRUNC(a.hivt_entry_date) >\= TRUNC(TO_DATE(?, 'DD-Mon-YYYY')) AND TRUNC(a.hivt_entry_date) <\= TRUNC(TO_DATE(?, 'DD-Mon-YYYY'))
 SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER_INPROCESS_1=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status=13  and a.gnum_hospital_code =? and TRUNC (a.hivt_entry_date) >= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))
 
 SELECT.STAFF_DETAILS_LIST.HRGT_PATIENT_ID_DTL = SELECT hrgstr_patient_id,hrgnum_sl_no,gnum_hospital_code from hrgt_patient_id_dtl where gnum_isvalid = 1 and hrgnum_puk = ? and gnum_hospital_code = ?
 
 
 SELECT.DATA_REQUISITION_FORM_HIVT_REQFROM_TEST_PARA_MST = select distinct(gnum_test_code)||'#'||hivnum_form_type||'#'||(hivnum_mapped_test) from hivt_reqform_test_parameter_mst where gnum_test_code =? and gnum_isvalid=1
 
 UPDATE.HIVT_REQ_DTL_ADENDUM_TEST11=UPDATE HIVT_REQUISITION_DTL b SET hivnum_reqdtl_status=?,HIVNUM_SAMPLE_NO=?,HIVNUM_TEMP_SAMPLE_NO=?,HIVDT_COLL_DATE_TIME=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),HIVNUM_COLLECTION_SEATID=?,HIVNUM_SAMPLE_COL_AREA_CODE=?,hivnum_issample_received=?,hivnum_isaccepted=?,HIVDT_ACCEPTANCE_DATE_TIME=TO_TIMESTAMP(?,'yyyy-MM-DD HH24:MI:SS '),HIVDT_ACCEPTANCE_SEATID=?,HGSTR_DAILY_LABNO=?,hivnum_uom=?,hivnum_collected_volume=?,hivnum_containercode=? where HIVTNUM_REQ_DNO=? and GNUM_HOSPITAL_CODE=? ;
 
 
 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAILLLLL=Select pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,hivnum_req_no as reqNo,hivtnum_req_dno ,gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as prvTestCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName,    gbnum_priority_code, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,    to_char(hivt_entry_date,'dd-Mon-yyyy') as reqDate, decode(pkg_inv_fun.fun_test_type(gnum_test_code),'P','Patient Based','S', 'Sample Based', 'I','Slide Based') as sampleCode,     hivnum_reqdtl_status as prvReqStatus,    DECODE(hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted', 7,'Result Entered',    8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed',     15,'Test Cancelled',16,'Test Deleted',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,    pkg_inv_fun.fun_sample_name(gnum_sample_code) sampleName, gnum_sample_code,to_char(hivt_entry_date,'MMddyyyy') as sortReqDate  from hivt_requisition_dtl   where       hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hivnum_req_no \= ?)      and gnum_hospital_code\= ? and hivnum_reqdtl_status\=6 order by CAST(hivt_entry_date AS datetime) desc \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
 
 DELETE_RESULT_ENTRY_TEST_FROM_RAISING=UPDATE hivt_requisition_dtl  SET  hivnum_reqdtl_status=? , hivtnum_test_delete_seatid=?,  hivtdt_test_delete_date=SYSDATE  WHERE hivnum_reqdtl_status in(?) AND gnum_hospital_code=? And  gnum_lab_code=? And gnum_test_code=? and hivnum_req_no=? 
 
 #added by chandan gupta
 SELECT_ALL_TETCODE_ADDENDUM_RESULT_ENTRY=select array_to_string(array_agg(distinct gnum_test_code), ',')  from hivt_requisition_dtl where hivnum_req_no=? and gnum_hospital_code=? and hivnum_reqdtl_status=6  GROUP BY hivnum_req_no;
 
 SELECT.LABNAME_COMBO.TERIFFTEST=select gnum_lab_code,gstr_lab_name from hivt_laboratory_mst where gnum_hospital_code=? and gnum_isvalid=1 AND  gnum_lab_code in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =15  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND p.gnum_seatid =?  AND gnum_hospital_code = ?)
 
 SELECT.MACHINE_COMBO.HMIT_MACHINE_MST= select HMINUM_MACHINE_ID,HMISTR_MACHINE_NAME from hmit_machine_mst where gnum_isvalid=1 and gnum_hospital_code=?	
 
 
 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_TEST_TARIFF=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound\=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<\=CURRENT_TIMESTAMP\:\:time AND gstr_end_time>\=CURRENT_TIMESTAMP\:\:time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'\#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1\#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType, '1\#1\#1' as mandInfo,   '1\#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,BILL_MST.GETCHARGEDETAILS (10\:\:character varying,?\:\:character varying,?\:\:character varying,?\:\:character varying,?\:\:character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id\=a.gnum_test_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and sblnum_service_id\=1)\:\:character varying) as tariffTestRate,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 AND gnum_lab_code \= a.gnum_labcode AND gnum_hospital_code \= a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=?                               
 
 	SELECT.LABTEST_MACHINE.HIVT_LABTEST_MST_SAMPLEACCEPTANCE=select HMINUM_MACHINE_ID as machineId,  HMISTR_MACHINE_NAME  as machineName from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_labcode=?  and gnum_hospital_code=m.gnum_hospital_code and HMINUM_MACHINE_ID=m.HMINUM_MACHINE_ID) from HMIT_MACHINE_MST m where gnum_isvalid=1 and gnum_hospital_code=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code=? and gnum_location_code=m.gnum_location_code and gnum_hospital_code=m.gnum_hospital_code) order by machineName
 
 
 SELECT.WARDCODE.HIVT_COLLECTION_AREA_MST=SELECT gnum_collectionarea_type ||'#'||hipnum_ward_code as data FROM HIVT_COLLECTION_AREA_MST z WHERE z.gnum_area_code =? and z.gnum_hospital_code=? and gnum_isvalid=1 

  
  #SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_IPD_WARD=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )  
   SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER_IPD_WARD=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY hh\:mm') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in (?) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO  )

  
SELECT.COLLECTIONAREACODE.HIVT_COLLECTION_AREA_MST=SELECT gnum_area_code FROM HIVT_COLLECTION_AREA_MST z where gnum_hospital_code=? and hipnum_ward_code=? and gnum_collectionarea_type=2 and gnum_isvalid=1
 
  
  
 SELECT.GETBILLING_CHECK_TEST_CODE_GET=select BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=? and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=1)::character varying)
  
  
  SELECT_PARA_RESULT_ENTRY=select String_agg(decode(gstr_element_type,'A','Hyper Link')||'###'||gnum_parameter_code,'@@@') from HIVT_test_PARAMETER_MST where gnum_test_code=? and  gstr_element_type in ('A') and gnum_isvalid=1 group by  gstr_element_type order by gstr_element_type desc
  
  SELECT_MACHINE_COMBO_LOCATION_BASE = select hminum_machine_id AS machineId, hmistr_machine_name AS machineName from HMIT_MACHINE_MST a where a.gnum_hospital_code = ? and a.gnum_isvalid = 1 and a.gnum_location_code = (select b.gnum_location_code from hivt_collection_area_mst b where b.gnum_isvalid = 1 and b.gnum_hospital_code = a.gnum_hospital_code and b.gnum_area_code = ?) and hgnum_machine_type = ? order by machineName
  
  
  SELECT.IS_SUFFICIENT_AMOUNT.HIVT_REQUISITION_DTL= Select Bill_mst.get_pat_accountdetails_limit(?,?,?) 
 
  SELECT.AMOUNT_FOR_ONE_TEST.HIVT_REQUISITION_DTL= Select BILL_MST.GETCHARGEDETAILS (10\:\:character varying,?\:\:character varying,?\:\:character varying,?\:\:character varying,?\:\:character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id\=? and gnum_hospital_code\=? and gnum_isvalid\=1 and sblnum_service_id\=1)\:\:character varying) 
  
  SELECT.GET_TEST_CODE.HIVT_REQUISITION_DTL=select gnum_test_code from hivt_laboratory_test_mst where  upper(gnum_user_test_code)=upper(?) and gnum_isvalid=1 and gnum_hospital_code=?
  
  
  ##added by krishnan nema on 26/10/2018
  UPDATE_SAMPLE_ACC_MACHINE_DTL.HIVT_REQUISITION_DTL = update hivt_requisition_dtl set gnum_machine_code = ? where gnum_hospital_code = ? and hivtnum_req_dno = ?
  
  UPDATE_SAMPLE_ACC_MACHINE_DTL.HMIT_SAMPLE_DTL =   update hmit_sample_dtl set hminum_machine_id = ? where gnum_hospital_code = ? and hminum_inv_reqdno = ?
  
  UPDATE_SAMPLE_ACC_MACHINE_DTL_NO_MACHINE.HIVT_REQUISITION_DTL = update hivt_requisition_dtl set gnum_machine_code = ?, hivnum_reqdtl_status = ? where gnum_hospital_code = ? and hivtnum_req_dno = ?
  
   
 SELECT.COUNT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=select count(*) from hivt_parameter_dtl where gnum_isvalid=1 and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and hivtnum_parent_parameter_code = ? and gnum_hospital_code=?
 
 
 SELECT_IS_EXIST_REQUSITION_HMIT_SAMPLE_DTL=select count(*) from hmit_sample_dtl where hminum_inv_reqdno=? and gnum_hospital_code=?
 
 UPDATE.HIVT_WOORGANISM_TABLE=update hivt_wo_orgaantibiotics_dtl set gnum_isvalid=0 where hivtnum_req_dno=? and gnum_hospital_code=? and gnum_isvalid=1
 
 #SELECT_ISDUPLICATE_TEST_RAISED=select count(*) from hivt_requisition_dtl a where (hivnum_req_no ) in ((select hivnum_req_no from hivt_requisition_header where to_char(hivdt_entry_date,'dd-mm-yyyy')=to_char(sysdate,'dd-mm-yyyy') and hrgnum_puk=? and gnum_hospital_code=? and gnum_isvalid=1)) and gnum_lab_code=? and gnum_test_code=? and gnum_hospital_code=?
 
 #SELECT_ISDUPLICATE_TEST_RAISED_GROUP=select count(*) from hivt_requisition_dtl a where (hivnum_req_no ) in ((select hivnum_req_no from hivt_requisition_header where to_char(hivdt_entry_date,'dd-mm-yyyy')=to_char(sysdate,'dd-mm-yyyy') and hrgnum_puk=? and gnum_hospital_code=? and gnum_isvalid=1)) and gnum_lab_code=? and hgnum_group_code=? and gnum_hospital_code=?
 
 SELECT_ISDUPLICATE_TEST_RAISED=select count(*) from hivt_requisition_dtl_daily a where gnum_lab_code=? and gnum_test_code=? and gnum_hospital_code=? and to_char(hivt_entry_date,'dd-mm-yyyy')=to_char(sysdate,'dd-mm-yyyy') and hrgnum_puk_reqd=?
 
 SELECT_ISDUPLICATE_TEST_RAISED_GROUP=select count(*) from hivt_requisition_dtl_daily a where gnum_lab_code=? and hgnum_group_code=? and gnum_hospital_code=? and to_char(hivt_entry_date,'dd-mm-yyyy')=to_char(sysdate,'dd-mm-yyyy') and hrgnum_puk_reqd=? 
 
 
 
 SELECT_GRP_CODE_ISDUPLICATE=select distinct(hgnum_group_code)||'#'||gnum_lab_code from hivt_test_group_info_mst where upper(gstr_user_group_code)=upper(?) and gnum_is_valid=1 and gnum_hospital_code=?
 
 DELETE_GROUP_WISE_RAISING=UPDATE hivt_requisition_dtl  SET  hivnum_reqdtl_status=? , hivtnum_test_delete_seatid=?,  hivtdt_test_delete_date=SYSDATE  WHERE hivnum_reqdtl_status in(?,?) AND gnum_hospital_code=?  And hgnum_group_code=? and hivnum_req_no=?
 
 #INSERT.HIVT_ICTC_DTL=INSERT INTO hivt_ictc_dtl(hivnum_visit_no,hrgnum_puk, hivnum_req_no, hivnum_visit_type,hivnum_gender, hivstr_pat_name, hivstr_address, hivstr_city,hivstr_district, hivstr_age, hivstr_contact_no, hivnum_pregnancy,hivstr_pid_no, hivnum_hiv1_result, hivnum_hiv2_result, hivnum_isvalid,hivnum_entry_date, hivnum_seat_id)VALUES ((select (nvl(max(hivnum_visit_no),0))+1 from hivt_ictc_dtl where hrgnum_puk=?),?, ?, ?,?,?, ?, ?,?, ?, ?, ?,?, ?, ?, ?,sysdate, ?);
 #INSERT.HIVT_ICTC_DTL=INSERT INTO hivt_ictc_dtl( hivnum_visit_no, hrgnum_puk, hivnum_req_no, hivnum_visit_type, hivnum_gender, hivstr_pat_name, hivstr_address, hivstr_city, hivstr_district, hivstr_age, hivstr_contact_no, hivnum_pregnancy,hivstr_pid_no, hivnum_hiv1_result, hivnum_hiv2_result, hivnum_isvalid,hivnum_entry_date, hivnum_seat_id)VALUES ( (select (nvl(max(hivnum_visit_no),0))+1 from hivt_ictc_dtl where hrgnum_puk=?),?, ?, ?,?,?, ?, (select hrgstr_city from hrgt_patient_dtl where gnum_isvalid = 1 and hrgnum_puk = ?),(select hrgstr_district from hrgt_patient_dtl where gnum_isvalid = 1 and hrgnum_puk = ?), ?, ?, ?,?, ?, ?, ?,sysdate, ?);
 INSERT.HIVT_ICTC_DTL=INSERT INTO hivt_ictc_dtl( hivnum_visit_no, hrgnum_puk, hivnum_req_no, hivnum_visit_type, gnum_is_followup, hivnum_gender, hivstr_pat_name, hivstr_address, hivstr_city, hivstr_district, hivstr_age, hivstr_contact_no, hivnum_pregnancy,hivstr_pid_no, hivnum_hiv1_result, hivnum_hiv2_result, hivnum_isvalid,hivnum_entry_date, hivnum_seat_id)VALUES ( (select (nvl(max(hivnum_visit_no),0))+1 from hivt_ictc_dtl where hrgnum_puk=?),?, ?,?,?,?,?, ?, (select hrgstr_city from hrgt_patient_dtl where gnum_isvalid = 1 and hrgnum_puk = ?),(select hrgstr_district from hrgt_patient_dtl where gnum_isvalid = 1 and hrgnum_puk = ?), ?, ?, ?, ?, ?,?, ?,sysdate,?)
 
 #SELECT_ISPID_EXIST=select hrgnum_puk as patpuk,hivnum_gender as patgender,hivnum_pregnancy as ispregnant,hivstr_pid_no as pidno,hivnum_visit_type as intiatedtype from hivt_ictc_dtl where hrgnum_puk=?  and hivnum_isvalid=1  order by hivnum_entry_date desc limit 1
 SELECT_ISPID_EXIST=select hrgnum_puk as patpuk,hivnum_gender as patgender,hivnum_pregnancy as ispregnant,hivstr_pid_no as pidno,hivnum_visit_type as intiatedtype, gnum_is_followup as followup from hivt_ictc_dtl where hrgnum_puk=?  and hivnum_isvalid=1  order by hivnum_entry_date desc limit 1
 
 UPDATE_HGSTR_DAILY_LABNO.HIVT_REQUISITION_DTL = UPDATE hivt_requisition_dtl SET hgstr_daily_labno = ? where gnum_hospital_code = ? and hivtnum_req_dno = ?
 
 UPDATE_HGSTR_DAILY_LABNO.HIVT_SAMPLE_DTL = UPDATE hivt_sample_dtl SET hgstr_daily_labno = ? where gnum_hospital_code = ? and hivtnum_req_dno = ? 
 
 IS_PID_EXIST_=select count(*) from hivt_ictc_dtl where upper(hivstr_pid_no)=upper(?) and hivnum_isvalid=1 

 UPDATE_HIVT_ICTC_DTL_RESULT_VALUE_hiv1=update hivt_ictc_dtl set hivnum_hiv1_result=?,hivnum_reqdtl_status=? where  hivnum_req_no=? and hivnum_isvalid=1
 
 UPDATE_HIVT_ICTC_DTL_RESULT_VALUE_hiv2=update hivt_ictc_dtl set hivnum_hiv2_result=?,hivnum_reqdtl_status=? where  hivnum_req_no=? and hivnum_isvalid=1

 UPDATE_HIVT_ICTC_DTL_RESULT_VALUE_WITHOPUT_CHANGE=update hivt_ictc_dtl set  hivnum_reqdtl_status=? where hivnum_req_no=? and hivnum_isvalid=1
 
 SELECT_COUNT_TESTPARAMETER=select count(*)  from hivt_parameter_dtl where hivtnum_req_dno=? and gnum_hospital_code=? and hivtnum_test_code=? and hivtnum_parent_parameter_code=? and gnum_isvalid=1
 
  UPDATE_HIVT_PARAMETER_DTL=update hivt_parameter_dtl set hivtstr_value=? where hivtnum_req_dno=?  and gnum_hospital_code=?  and hivtnum_test_code=?  and hivtnum_parent_parameter_code=?  and gnum_isvalid=1

  #UPDATE.REQDTLS.RESULT.VALIDATION.HIVT_REQUISITION_DTLS_SEND_TO_MACHINE=UPDATE hivt_requisition_dtl  SET  hivt_is_repeat_sample=?, hivnum_repeat_request_seatid=?, hivdt_repeat_req_datetime=SYSDATE, hivt_retest_repeat_mode=?,  hivnum_reqdtl_status=?,hrgstr_visit_reason_reqd=?,hivnum_sms_flag_reqd=0 WHERE hivtnum_req_dno=?  AND gnum_test_code=? and gnum_hospital_code=?
  UPDATE.REQDTLS.RESULT.VALIDATION.HIVT_REQUISITION_DTLS_SEND_TO_MACHINE=UPDATE hivt_requisition_dtl  SET  hivt_is_repeat_sample=?, hivnum_repeat_request_seatid=?, hivdt_repeat_req_datetime=SYSDATE, hivt_retest_repeat_mode=?,  hivnum_reqdtl_status=?,hrgstr_visit_reason_reqd=?,hivnum_sms_flag_reqd=0 WHERE hivtnum_req_dno=?  AND gnum_test_code=? and gnum_hospital_code=?
  
  UPDATE.HMIT_SAMPLE_DTL_SEND_TO_MACHINE=update hmit_sample_dtl set hminum_para_count = ?, hminum_test_status = ?,hivt_is_repeat_sample = ?, hivt_retest_repeat_mode = ? where  gnum_hospital_code = ? and hminum_inv_reqdno = ? and hminum_machine_id = (select gnum_machine_code from hivt_requisition_dtl where hivtnum_req_dno = ? and gnum_hospital_code = ?)
  
  SELECT.LABTEST_MACHINE.HIVT_LABTEST_MST_NEW=select HMINUM_MACHINE_ID,HMISTR_MACHINE_NAME from HMIT_MACHINE_MST m where gnum_isvalid=1 and gnum_hospital_code=? and exists (select 1 from hivt_laboratory_mst where gnum_lab_code=? and gnum_location_code=m.gnum_location_code and gnum_hospital_code=m.gnum_hospital_code)
  
 COMBO.ANTIBITIC_NAME.HIVT_ORGANISM_ANTIBIOTIC_MAPPING_MST_PREFERRED_LIST =select  hgnum_antibiotic_code as antibioticCode,INITCAP(hgstr_antibiotic_name)as antibioticName,(select hivnum_preference_order from hivt_organism_antibiotic_mapping_mst ss  where gnum_isvalid=1 and ss.gnum_hospital_code=? and ss.hgnum_organism_code=? and ss.gnum_antibiotic_code=s.hgnum_antibiotic_code) as preferenceorder from hivt_antibiotic_mst s where gnum_isvalid=1 and hgnum_antibiotic_code  IN(select gnum_antibiotic_code from hivt_organism_antibiotic_mapping_mst where gnum_isvalid=? and gnum_hospital_code=? and hgnum_organism_code=? and hivnum_preference_order is not null) order by preferenceorder
  
UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS_COMMENTS=UPDATE hivt_requisition_dtl  SET  hivstr_final_remark\=?   WHERE hivnum_req_no\=?  AND hivnum_temp_sample_no\=? and gnum_hospital_code\=?
	
  UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS_COMMENTS_PATACC=UPDATE hivt_requisition_dtl  SET  hivstr_final_remark\=?   WHERE hivnum_req_no\=?   and gnum_hospital_code\=?
  
  SELECT_INV_STATUS_DASHBOARD_RECORD.HIVT_REQUISITION_DTL=
  
  SELECT_ISMANDATORY_LAB=select gnum_isapptmand||'#'||gnum_isapptlabbased from hivt_laboratory_mst where gnum_lab_code=? and gnum_hospital_code=? and gnum_isvalid=1
  		
  UPDATE.APPOINTMENT.LAB_BAISED.HEADER=update hivt_requisition_header set hivdt_requisition_date=TO_DATE(?) where hivnum_req_no=? and gnum_hospital_code=?
  		
  		
 #SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_SAMPLE_ACC_NEW=SELECT (select hrgnum_visit_type AS patvisittypecode  from hrgt_episode_dtl b WHERE b.gnum_isvalid =1 and b.hrgnum_is_episode_open=1 and b.hrgnum_episode_code=(select gnum_episode_code from hivt_requisition_header c where c.hivnum_req_no=? and  c.gnum_hospital_code=a.gnum_hospital_code and b.hrgnum_puk=a.hrgnum_puk) and b.gnum_hospital_code=a.gnum_hospital_code),hgnum_pat_status_code as patvisittypecode,a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId,hgnum_patient_cat_code as code ,bill_mst.getcatgrp(a.hgnum_patient_cat_code,?) as patCategoryGroup FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   
 #SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_SAMPLE_ACC_NEW=SELECT (select hrgnum_visit_type AS patvisittypecode  from hrgt_episode_dtl b WHERE b.gnum_isvalid =1 and b.hrgnum_is_episode_open=1 and b.hrgnum_episode_code=(select gnum_episode_code from hivt_requisition_header c where c.hivnum_req_no=? and  c.gnum_hospital_code=a.gnum_hospital_code and b.hrgnum_puk=a.hrgnum_puk) and b.gnum_hospital_code=a.gnum_hospital_code and hrgnum_visit_no = (select max(hrgnum_visit_no) from hrgt_episode_dtl e WHERE e.hrgnum_episode_code=(select gnum_episode_code from hivt_requisition_header cc where cc.hivnum_req_no=? and  cc.gnum_hospital_code=a.gnum_hospital_code and e.hrgnum_puk=a.hrgnum_puk) and e.hrgnum_puk = a.hrgnum_puk)),hgnum_pat_status_code as patvisittypecode,a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId,hgnum_patient_cat_code as code ,bill_mst.getcatgrp(a.hgnum_patient_cat_code,?) as patCategoryGroup FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   
 
 #SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_SAMPLE_ACC_NEW=SELECT (select hrgnum_visit_type AS patvisittypecode  from hrgt_episode_dtl b WHERE b.gnum_isvalid \=1 and b.hrgnum_is_episode_open\=1 and b.hrgnum_episode_code\=(select gnum_episode_code from hivt_requisition_header c where c.hivnum_req_no\=? and  c.gnum_hospital_code\=a.gnum_hospital_code and b.hrgnum_puk\=a.hrgnum_puk) and b.gnum_hospital_code\=a.gnum_hospital_code and b.hrgnum_visit_no\=(select hgnum_visitno from hivt_requisition_header cc where cc.hivnum_req_no\=? and  cc.gnum_hospital_code\=a.gnum_hospital_code and cc.hrgnum_puk\=b.hrgnum_puk)),hgnum_pat_status_code as patvisittypecode,a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId,hgnum_patient_cat_code as code ,bill_mst.getcatgrp(a.hgnum_patient_cat_code,?) as patCategoryGroup FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?
 
 SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_SAMPLE_ACC_NEW=SELECT  (select hbnum_requisition_type from hivt_requisition_header cc where cc.hivnum_req_no\=? and  cc.gnum_hospital_code\=a.gnum_hospital_code) as patvisittypecode,a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId,hgnum_patient_cat_code as code ,bill_mst.getcatgrp(a.hgnum_patient_cat_code,?) as patCategoryGroup FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?
 
 
SELECT_INV_STATUS_DASHBOARD_RECORD_LISITNG=select distinct (hivtnum_req_dno) as reqdno, (select gstr_test_name from hivt_test_mst where gnum_test_code = a.gnum_test_code) as testname, hivnum_temp_sample_no as sampleNo, (select gstr_sample_name from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code = a.gnum_sample_code) as sampleType, (select hrgnum_puk from hivt_requisition_header where hivnum_req_no = a.hivnum_req_no) as crno,nvl((select hgstr_group_name from hivt_test_group_mst where gnum_hospital_code = 10911 and hgnum_group_code = a.hgnum_group_code),'NA') as groupCode, nvl(to_char(hivtdt_res_val_date),'NA') as valDate, nvl(to_char(hivtdt_res_reval_date),'NA') as reValDate,nvl(to_char(hivdt_acceptance_date_time),'NA') as acceptDate, DECODE(gnum_machine_code,null,'NA',-1,'No Machine',(select hmistr_machine_name from hmit_machine_mst where gnum_hospital_code = 10911 and hminum_machine_id = a.gnum_machine_code)) as machineName from  hivt_requisition_dtl a where TRUNC (hivt_entry_date)>=TO_DATE (sysdate,'DD-Mon-YYYY') and TRUNC (hivt_entry_date)<=TO_DATE (sysdate,'DD-Mon-YYYY')  and gnum_lab_code = 10003 and hivnum_temp_sample_no is not null 
 		
SELECT_DATA_BILLING_REQUISITIONWISE=select DECODE(a.HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus,hbnum_requisition_type as patvisittypecode, (select hrgnum_visit_type AS visittypecode  from hrgt_episode_dtl b WHERE b.gnum_isvalid =1 and b.hrgnum_is_episode_open=1 and b.hrgnum_episode_code=a.gnum_episode_code and b.gnum_hospital_code=a.gnum_hospital_code and b.hrgnum_visit_no=a.hgnum_visitno and b.hrgnum_puk=a.hrgnum_puk ) from hivt_requisition_header a where a.hivnum_req_no=? and a.gnum_hospital_code=?
 		
SELECT.BILLINGSTATUS.HIVT_REQUISITION_DTL_BEFORE_DELETE= Select Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, ?\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character varying, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail from HIVT_REQUISITION_DTL a where HIVNUM_REQ_NO\= ? and gnum_test_code\=? and gnum_hospital_code\=? order by HIVTNUM_REQ_DNO
 		

#chnaged by chandan fro removing lab permission from raiaising process

#SELECT.LAB_TEST_SAMPLE_WITHOUT_LAB_PERMISSION=Select gnum_lab_code as labCode ,gnum_test_code as testCode ,gnum_sample_code as sCode,(select gstr_sample_name from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as sName,(select gstr_sample_short_name  from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as reqSampleShortName from hivt_labtest_sample_mst a where gnum_isvalid=1 and gnum_hospital_code =? and gnum_lab_code in ( SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND (p.gnum_seatid =? or 1=1)  AND p.gnum_module_id =? or 1=1)  order by sName asc

SELECT.LAB_TEST_SAMPLE_WITHOUT_LAB_PERMISSION=Select gnum_lab_code as labCode ,gnum_test_code as testCode ,gnum_sample_code as sCode,(select gstr_sample_name from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as sName,(select gstr_sample_short_name  from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as reqSampleShortName from hivt_labtest_sample_mst a where gnum_isvalid=1 and gnum_hospital_code =?   order by sName asc


#SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST_WITHOUT_LAB_PERMISSION=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null and gnum_lab_code in ( SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND (p.gnum_seatid =? or 1=1)  AND p.gnum_module_id =? or 1=1 ) and gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1) and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1)
SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST_WITHOUT_LAB_PERMISSION=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null  and gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1) and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1)
 
#SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST_WITHOUT_LAB_PERMISSION_OPDDESK=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null and gnum_lab_code in ( SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND (p.gnum_seatid =? or 1=1)  AND p.gnum_module_id =? or 1=1 ) and gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1 and is_hidefromopddsk=0) and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1 )
#SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST_WITHOUT_LAB_PERMISSION_OPDDESK=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null and gnum_lab_code in ( SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND gnum_hospital_code = ? AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE' AND (p.gnum_seatid =? or 1=1)  AND p.gnum_module_id =? or 1=1 ) and gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1) and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1 ) and gnum_test_code in (select gnum_test_code from hivt_laboratory_test_mst v where v.gnum_isvalid=1 and v.gnum_labcode=gnum_lab_code and v.gnum_hospital_code=gnum_hospital_code and is_hidefromopddesk=0 and v.gnum_test_code=gnum_test_code)
SELECT.USER_GROUP_CODE.HIVT_TEST_GROUP_INFO_MST_WITHOUT_LAB_PERMISSION_OPDDESK=select distinct(gstr_user_group_code),gstr_user_group_code from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=? and gstr_user_group_code is not null and gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1) and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1 ) and gnum_test_code in (select gnum_test_code from hivt_laboratory_test_mst v where v.gnum_isvalid=1 and v.gnum_labcode=gnum_lab_code and v.gnum_hospital_code=gnum_hospital_code and is_hidefromopddesk=0 and v.gnum_test_code=gnum_test_code)

 
 #SELECT.LABNAME_COMBO.TERIFFTEST_WITHOUT_LAB_PERMISSION=select gnum_lab_code,gstr_lab_name from hivt_laboratory_mst where gnum_hospital_code=? and gnum_isvalid=1 AND  gnum_lab_code in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =15  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)
  SELECT.LABNAME_COMBO.TERIFFTEST_WITHOUT_LAB_PERMISSION=select gnum_lab_code,gstr_lab_name from hivt_laboratory_mst where gnum_hospital_code=? and gnum_isvalid=1 
 
# SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?                               
 #SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and c.is_show=1 
 #SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1 
 #SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1 
  SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName,GSTR_TEST_NAME AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, GSTR_TEST_TYPE as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1 
  

#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and c.is_show=1 and c.is_hidefromopddsk=0
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and c.is_show=1 and a.is_hidefromopddesk=0
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?    AND a.gnum_hospital_code =?  and c.is_show=1 and a.is_hidefromopddesk=0
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?    AND a.gnum_hospital_code =?  and c.is_show=1 and a.is_hidefromopddesk=0
SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, GSTR_TEST_NAME AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,GSTR_TEST_TYPE as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?    AND a.gnum_hospital_code =?  and c.is_show=1 and a.is_hidefromopddesk=0



 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_TEST_TARIFF_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1 and sblnum_service_id=1)::character varying) as tariffTestRate,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and a.gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1)
 
  
# SELECT.LAB_WISE_TEST.HIVT_TEST_MST_TEST_TARIFF_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1 and sblnum_service_id=1)::character varying) as tariffTestRate,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and a.gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1  and is_hidefromopddsk=0)
 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_TEST_TARIFF_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1 and sblnum_service_id=1)::character varying) as tariffTestRate,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and a.gnum_test_code in (select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and is_show=1  ) and a.is_hidefromopddesk=0
                              
 
 # SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable,a.gstr_instruction_pat as instructionPat, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,a.gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b WHERE b.gnum_is_valid=1   and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and  UPPER(gstr_user_group_code) =UPPER(?)  and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =? 
#  SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable,a.gstr_instruction_pat as instructionPat, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,a.gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and  UPPER(gstr_user_group_code) =UPPER(?)  and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =?  and c.is_show=1
SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable,a.gstr_instruction_pat as instructionPat, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,a.gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and  UPPER(gstr_user_group_code) =UPPER(?)  and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =? and c.is_show=1
 # SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and c.is_show=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =?     and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1)

SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST2_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable,a.gstr_instruction_pat as instructionPat, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,a.gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and  UPPER(gstr_user_group_code) =UPPER(?)  and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =? and c.is_show=1 and a.is_hidefromopddesk=0




  
 #SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b WHERE b.gnum_is_valid=1   and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =?     
 SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =?  and c.is_show=1   and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1)
 
  SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_OPDDESK=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode     AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code)||' ('||gnum_user_test_code||')' AS testName,    concatstring (' select s.gnum_sample_code||''#''|| (select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=s.gnum_sample_code ) from hivt_labtest_sample_mst s where s.gnum_isvalid=1 and s.gnum_lab_code='''||a.gnum_labcode||''' and  s.gnum_test_code='''||a.gnum_test_code||''' and s.gnum_hospital_code='''||a.gnum_hospital_code||'''',',')   as sampleString     ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1     AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid=1 and HGNUM_MAND_CODE= k.HGNUM_MAND_CODE ) ||''#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid=1 and  HGNUM_MAND_CODE= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid=1 and k.gnum_test_code ='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code ='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE = '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid=1 and hgnum_group_code=b.hgnum_group_code                                              and gnum_hospital_code =b.gnum_hospital_code) as SearchTestGroup,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b,hivt_test_mst c WHERE b.gnum_is_valid=1  and c.gnum_test_code=b.gnum_test_code and c.gnum_isvalid=1 and b.gnum_test_code=a.gnum_test_code and b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and       a.gnum_is_test_available = 1  AND  a.gnum_isvalid = 1  AND a.gnum_hospital_code =?        AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?    AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'       AND p.gstr_column_name = 'GNUM_LAB_CODE'        AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)              AND a.gnum_hospital_code =?  and c.is_show=1 and a.is_hidefromopddesk=0  and hgnum_group_code in (select hgnum_group_code from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1)
 
 
 
 
 #end
  		
SELECT_LAB_COMBO_HIVT_LABORATORY_MST_FILMUSED=Select GNUM_LAB_CODE, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) || '-' || gstr_lab_name  as labName from  hivt_laboratory_mst where gnum_isvalid\=1 and gnum_hospital_code\=? and gnum_lab_code in (SELECT  gnum_column_value  FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  AND p.gnum_seatid \=?   AND p.gnum_hospital_code \=?) and gnum_isfilmused\=1
 
SELECT_IS_FILM_REQUISITION_EXIST=select hivtnum_totalfilms_used||'#'||nvl(hivtnum_additional_films_used,0)||'#'||nvl(hivtnum_films_wasted,0) from hivt_filmused_dtl  where hivtnum_req_dno=?
 
UPDATE_FILM_DATA=update hivt_filmused_dtl set 	hivtnum_totalfilms_used=?,hivtnum_films_wasted=?,hivtnum_additional_films_used=?,hgstr_remarks=? where hivtnum_req_dno=?

#SELECT.PATIENT_EPISODE_DTLS.HRGT_EPISODE_DTL_FILM_DATA=(select a.hivt_entry_date as requisitiondate,a.hivtnum_req_dno as requisitionDNo,nvl(b.hivtnum_totalfilms_used,'0') as totalused,nvl(b.hivtnum_films_wasted,'0') as wasteused,nvl(hivtnum_additional_films_used,'0') as additionalused,(select gstr_test_name as testName from hivt_test_mst vb where vb.gnum_test_code=a.gnum_test_code),(select gstr_lab_name as patLabName from hivt_laboratory_mst vv where vv.gnum_lab_code=a.gnum_lab_code and vv.gnum_hospital_code=a.gnum_hospital_code) from hivt_requisition_dtl a,hivt_filmused_dtl b where hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where hrgnum_puk=?) and a.hivtnum_req_dno=b.hivtnum_req_dno)
SELECT.PATIENT_EPISODE_DTLS.HRGT_EPISODE_DTL_FILM_DATA=select gnum_batch_no as batchNo,(select ((select gstr_test_name as testName from hivt_test_mst vb where vb.gnum_test_code=bb.gnum_test_code)) from hivt_film_dtl_mst bb where gnum_film_id=hivtnum_film_size and gnum_hospital_code=ma.gnum_hospital_code),hivtnum_film_no as tempFilmNo,(select gstr_film_type as filmtypename from hivt_film_dtl_mst bb where gnum_film_id=hivtnum_film_size and gnum_hospital_code=ma.gnum_hospital_code),decode(hivtnum_films_used_type,0,'Film Wasted',1,'Film used ',2,'Additional Film used') as filmUsedType,to_char(gdt_entry_date,'dd-mon-yyy hh:mm:ss') as entryDate,gnum_reason as filmReason from hivt_workorder_film_dtl ma where hivtnum_req_dno=?  order by entryDate desc

UPDATE_HIVT_REQUISITION_DTL_DRAFT_REQ_LOG=UPDATE hivt_requisition_dtl SET hivdt_draft_req_datetime=SYSDATE, hivnum_draft_req_seatid=?,  hivt_is_draft_req=1, hivt_draft_req_count= hivt_draft_req_count+1 WHERE hivtnum_req_dno=?  AND gnum_test_code=? and gnum_hospital_code=?

SELECT.FILE_UPLOAD_TESTWISE_REQ_DTL=select hivt_upload_filedata from hivt_parameter_dtl where hivtnum_req_dno=? and hivtnum_parent_parameter_code=? and gnum_hospital_code=?

UPDATE.REQDTLS.RESULT.VALIDATION.HIVT_REQUISITION_DTLS_FILEUPLOAD=UPDATE hivt_requisition_dtl  SET  hivtdt_res_val_date\=SYSDATE, hivtnum_res_val_seatid\=?,  hivnum_reqdtl_status\=?, gnum_seat_id\=?,hrgstr_visit_reason_reqd\=?,hivnum_sms_flag_reqd\=0  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?

UPDATE.REQDTLS.RESULT.ENTRY.MODIFY.HIVT_REQUISITION_DTLS_FILEUPLOAD=UPDATE hivt_requisition_dtl  SET  hivtdt_res_modify_date\=SYSDATE, hivnum_result_seatid\=?, hivnum_reqdtl_status\=?,hrgstr_visit_reason_reqd\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?

UPDATE.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL_FILEUPLOAD=update hivt_parameter_dtl set hivtstr_value\=? , gnum_lstmod_seatid\=?,gdt_lstmod_date\=SYSDATE,hivt_upload_filedata\=?,hivt_upload_filename\=? where gnum_isvalid\=1 and hivtnum_req_dno\=? and hivtnum_test_code\=? and hivnum_parameter_code\=? and hivtnum_parent_parameter_code \= ? and gnum_hospital_code\=?

COMBO.FUNGUS_NAME.HIVT_ORGANISM_MST=select  hgnum_organism_code as organismCode,INITCAP(hgstr_organism_name)as organismName from hivt_organism_mst where gnum_isvalid=? and gnum_type='1' order by organismName

SELECT.MAX.REASON.MST=SELECT NVL(MAX(hgnum_rejectionreason_id),10)+1 from hivt_rejectionreason_mst

INSERT.IN.REASON.MST=INSERT INTO hivt_rejectionreason_mst(hgnum_rejectionreason_id, hivnum_acceptance_type,hgstr_rejectionreason,gnum_isvalid,hgdt_entry_date,gnum_seat_id,gnum_savefromtransaction) VALUES (?, ?, ?, ?,SYSDATE,?,'1')

SELECT.HIVT_REPORT_DB_MST= select ftp_url from hivt_report_db_mst where gnum_hospital_code=? and gnum_isvalid=1 and gnum_parameter_id=1

#UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_GROUP_CASE = UPDATE hivt_requisition_dtl SET hivnum_reqdtl_status=?, hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=? WHERE hivnum_req_no=? and hgnum_group_code = ?

UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_GROUP_CASE = UPDATE hivt_requisition_dtl SET hivnum_reqdtl_status=?, hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=? WHERE hivnum_req_no=? and hgnum_group_code = ? and hivnum_reqdtl_status in (26,14)

#added by prashant
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=? limit 1) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?        
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?        
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and c.is_show=1
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1
SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1

#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA_OPDDESK=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?  and c.is_show=1 and is_hidefromopddesk=0
#SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA_OPDDESK=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1 and is_hidefromopddesk=0
SELECT.LAB_WISE_TEST.HIVT_TEST_MST_WITHOUT_LAB_PERMISSION_PRA_OPDDESK=SELECT  (select distinct b.hgnum_group_code from hivt_bookmark_mst b where b.gnum_bookmark_code =? and b.hivtnum_test_code=a.gnum_test_code and  a.gnum_labcode=b.hivtnum_lab_code and b.gnum_isvalid=1 and b.gnum_hospital_code=? and b.gnum_user_id=?) as testGroupCode, a.gnum_labcode AS labCode,'0#0' AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased     FROM hivt_laboratory_test_mst a,hivt_test_mst c      WHERE  a.gnum_isvalid = 1 and c.gnum_test_code=a.gnum_test_code and c.gnum_isvalid=1 AND a.gnum_hospital_code =?     AND a.gnum_hospital_code =?  and c.is_show=1 and is_hidefromopddesk=0


  

SELECT.FETCH.ISTEMPLATESHOWTESTWISEORNOT= select gnum_parameter_id from hivt_report_db_mst where gnum_parameter_id=2 and gnum_hospital_code=? and gnum_isvalid=1

#added by prashant for getting seq_id of default hgstr_value
SELECT.HIVT_PARAMETER_DTL.HGSTR_VALUES= select hgnum_seq_id, hgstr_value, gnum_isdefault from HIVT_TEST_PARAM_COMBO_MST where gnum_is_valid=1 and gnum_isdefault='1' and gnum_test_code=? and gnum_parameter_code=?


#added by prashant
UPDATE_HIVT_REQUISITION_HEADER_HRGSTR_VISIT_REASON= UPDATE hivt_requisition_header SET hrgstr_visit_reason=?, gnum_seat_id=? where hivnum_req_no=(select hivnum_req_no from hivt_requisition_dtl where hivtnum_req_dno=?)  and gnum_hospital_code=? and gnum_lab_code=?


INSERT.IN.HIVT_ECHO=insert into hivt_echo_data(hivtnum_req_dno,hivstr_value,hivdt_entry_date,gnum_isvalid) values (?,?,sysdate,1)


SELECT.ECHO.DATA=select nvl(hivstr_value,'') from hivt_echo_data where hivtnum_req_dno=? and gnum_isvalid=1

UPDATE.IN.HIVT_ECHO=update  hivt_echo_data set hivstr_value=?,hivdt_modify_date=sysdate where hivtnum_req_dno=? and gnum_isvalid=1

#Added By prashantMi
UPDATE.PATIENTDTLSNOTACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL= UPDATE hivt_patient_acceptance_dtl set hivtnum_isaccepted\=?, hivnum_pat_rejection_reason\=?, gnum_seatid\=?, hivnum_pat_rejection_action\=?, hivtdt_entry_date\=SYSDATE, hgstr_daily_labno\=?, hivdt_rejection_date_time\=to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'), hivnum_pat_acc_status_code\=?, hivtnum_rejection_seatid\=? where hivtnum_req_dno\=? and gnum_hospital_code\=? and hivnum_pat_acc_no\=?

#Added By prashantMi
#SELECT.ACCEPTED.HIVT_REQUISITION_HEADER=SELECT ( SELECT hapnum_apt_id FROM hapt_appointment_dtl WHERE hapnum_apt_no\ = ( SELECT hapnum_app_ref_no FROM hivt_requisition_dtl d WHERE d.HIVNUM_REQ_NO\ = a.HIVNUM_REQ_NO limit 1 ) AND hapnum_apt_id\ = 4 ) AS apttype ,( SELECT hivstr_appointment_time FROM hivt_requisition_dtl d WHERE d.HIVNUM_REQ_NO\ = a.HIVNUM_REQ_NO limit 1 ) AS apttime ,A.HIVNUM_REQ_NO AS patReqNo ,HRGNUM_PUK AS patPuk ,HGNUM_VISITNO ,A.GNUM_LAB_CODE AS labCode ,DECODE(HBNUM_REQUISITION_TYPE, 2, 'IPD', 1, 'OPD', 3, 'Emergency', 4, 'Special') AS patStatus ,( SELECT GSTR_LAB_NAME FROM HIVT_LABORATORY_MST WHERE gnum_isvalid\ = 1 AND GNUM_HOSPITAL_CODE \ = a.GNUM_HOSPITAL_CODE AND GNUM_LAB_CODE \ = a.GNUM_LAB_CODE ) AS patLabName ,to_char(HIVDT_REQUISITION_DATE, 'DD-Mon-YYYY') AS patReqDate ,HRGDT_DOB ,HIVNUM_REQHEADER_STATUS ,GNUM_EPISODE_CODE ,INITCAP(HRGSTR_PATNAME) AS patName ,GSTR_GENDER_CODE AS patGender ,HBNUM_REQUISITION_TYPE ,to_char(HGNUM_VISIT_DATE, 'DD-Mon-YYYY') AS patVisitDat ,LTRIM(RTRIM(HIVSTR_AGE)) AS patAge ,HIPNUM_ADMNO ,NVL(HIVSTR_ADDRESS, '-') AS address ,HIPNUM_WARDCODE ,NVL(HRGSTR_MOBILE_NO, '-') AS mobileNo ,NVL(HRGSTR_EMAIL_ID, '-') AS emailId ,HIPNUM_ROOM_CODE ,HIPNUM_BED_CODE ,HRGSTR_MLC_NO ,NVL(HIPSTR_BED_NAME, '-') AS patBedName ,NVL(HIPSTR_ROOM_NAME, '-') AS patRoomName ,NVL(HIPSTR_WARD_NAME, '-') AS patWardName ,GSTR_DEPT_NAME || '' || HGSTR_UNIT_NAME AS patUnitName ,HGNUM_DEPT_CODE ,HGNUM_DEPTUNITCODE ,NVL(HGSTR_ORDERED_BY_DOC_NAME, '-') AS patOrderByDoc ,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE, a.hgnum_patient_cat_code) AS patCategory FROM HIVT_REQUISITION_HEADER A ,hivt_requisition_dtl b WHERE gnum_isvalid\ = 1 AND b.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE \ = ? AND b.HIVNUM_REQ_NO = A.HIVNUM_REQ_NO AND b.HIVNUM_REQDTL_STATUS=6 AND TRUNC(HIVDT_REQUISITION_DATE) >= TRUNC(TO_DATE(?, 'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <= TRUNC(TO_DATE(?, 'DD-Mon-YYYY')) AND a.gnum_lab_code IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid\ = 1 AND p.gnum_module_id \ = 15 AND p.gstr_table_name \ = 'HIVT_LABORATORY_MST' AND p.gstr_column_name \ = 'GNUM_LAB_CODE' AND p.gnum_seatid \ = ? AND p.gnum_hospital_code \ = ? )
#SELECT.ACCEPTED.HIVT_REQUISITION_HEADER=Select (select hapnum_apt_id from hapt_appointment_dtl  where hapnum_apt_no\= (select hapnum_app_ref_no  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) and hapnum_apt_id\=4) as apttype,(select hivstr_appointment_time  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO\=a.HIVNUM_REQ_NO limit 1) as apttime,HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in(6)  AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO)and  TRUNC(HIVDT_REQUISITION_DATE) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY'))   and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=15  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)
SELECT.ACCEPTED.HIVT_REQUISITION_HEADER=Select (select hapnum_apt_id from hapt_appointment_dtl  where hapnum_apt_no= (select hapnum_app_ref_no  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO limit 1) and hapnum_apt_id=4) as apttype,(select hivstr_appointment_time  from hivt_requisition_dtl d where d.HIVNUM_REQ_NO=a.HIVNUM_REQ_NO limit 1) as apttime,HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid=1 and GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory,(select  array_agg(gstr_test_name)  from  hivt_test_mst x, HIVT_REQUISITION_DTL y where x.gnum_test_code=y.gnum_test_code and y.HIVNUM_REQDTL_STATUS IN (6) AND y.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND y.HIVNUM_REQ_NO = A.HIVNUM_REQ_NO and x.GNUM_ISVALID = 1) as testName  from HIVT_REQUISITION_HEADER A where gnum_isvalid=1 and GNUM_HOSPITAL_CODE =? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL b, HIVT_TEST_MST c WHERE HIVNUM_REQDTL_STATUS in(6)  AND b.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND b.HIVNUM_REQ_NO = A.HIVNUM_REQ_NO AND b.GNUM_TEST_CODE=c.GNUM_TEST_CODE AND c.GNUM_ISVALID=1 AND LOWER(c.GSTR_TeST_TYPE)='p')and  TRUNC(HIVDT_REQUISITION_DATE) >= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <= TRUNC(TO_DATE(?,'DD-Mon-YYYY'))   and   a.gnum_lab_code  in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code = ?)



#Added By prashantMi
UPDATE.PATIENTDTLSACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL= UPDATE hivt_patient_acceptance_dtl set hivtnum_isaccepted\=?, gnum_seatid\=?, hivtdt_entry_date\=SYSDATE, hgstr_daily_labno\=?, hivdt_acceptance_date_time\=to_timestamp(?,'yy-mm-dd hh24\:mi\:ss'), hivnum_pat_acc_status_code\=? has_permission\=? where hivtnum_req_dno\=? and gnum_hospital_code\=? and hivnum_pat_acc_no\=?


#Added By prashantMi
SELECT.PAT_ACC_NO.HIVT_PATIENT_ACCEPTANCE_DTL= select hivnum_pat_acc_no from hivt_patient_acceptance_dtl where hivtnum_req_dno\=? and gnum_hospital_code\=? limit 1

#Added By PrashantMi
SELECT.HIVT_LABBORATORY_TEST_MST.ECHOTEST=select nvl(gnum_isechotest,'0')  from hivt_laboratory_test_mst where gnum_is_test_available\=1 and gnum_test_code\=? and gnum_labcode\=? and gnum_hospital_code\=?

#Added By PrashantMi
SELECT.GNUM_USERID.GBLT_USER_MST=select gnum_userid, gstr_usr_name ||' ('|| psrstr_emp_no ||')', gstr_user_name from gblt_user_mst where gnum_hospital_code\=? and gnum_userid not in (?);



#SELECT.SEARCHINGTESTCODE.FOR.XRAYPRCOESS=select pkg_inv_fun.fun_test_name(c.gnum_test_code)||'('||(pkg_inv_fun.fun_lab_name(c.gnum_labcode,c.gnum_hospital_code))||')' as testName,gnum_user_test_code as userTestCode,c.gnum_test_code as testCode,c.gnum_labcode as labCode from hivt_laboratory_test_mst c where (select gnum_issearch from hivt_laboratory_mst b where b.gnum_lab_code=gnum_labcode and b.gnum_hospital_code=c.gnum_hospital_code and b.gnum_isvalid=1)=1 and c.gnum_hospital_code=? and c.gnum_isvalid=1
SELECT.SEARCHINGTESTCODE.FOR.XRAYPRCOESS=select INITCAP(pkg_inv_fun.fun_test_name(c.gnum_test_code))||'('||INITCAP((pkg_inv_fun.fun_lab_name(c.gnum_labcode,c.gnum_hospital_code)))||')' as testName,gnum_user_test_code as userTestCode,c.gnum_test_code as testCode,c.gnum_labcode as labCode from hivt_laboratory_test_mst c where (select gnum_issearch from hivt_laboratory_mst b where b.gnum_lab_code=gnum_labcode and b.gnum_hospital_code=c.gnum_hospital_code and b.gnum_isvalid=1)=1 and c.gnum_hospital_code=? and c.gnum_isvalid=1
														

SELECT.LAB_WISE_TEST.HIVT_TEST_MST_TEST_TARIFF_WITHOUT_LAB_PERMISSION_XRAYPROCESS=SELECT   a.gnum_labcode AS labCode,(SELECT Cast(Cast( CAST( CASE WHEN gnum_istime_bound=1 Then '1' Else '0' END As Bit ) And CAST( CASE When gstr_start_time<=CURRENT_TIMESTAMP::time AND gstr_end_time>=CURRENT_TIMESTAMP::time Then '1' ELSE '0' END AS bit) as bit) as varchar) ||'#'||gnum_istime_bound FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code ) AS isLabAvailable, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid=1 and gnum_lab_code = a.gnum_labcode  AND gnum_hospital_code = a.gnum_hospital_code) AS labName, (SELECT  INITCAP(gstr_test_name)    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE = a.GNUM_LABCODE  and   GNUM_TEST_CODE = a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE = 1  AND   gnum_hospital_code = a.gnum_hospital_code and GNUM_ISVALID=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid=1 and GNUM_TEST_CODE = a.GNUM_TEST_CODE) as testType, '1#1#1' as mandInfo,   '1#1' as mandCombo,gstr_instruction_pat as instructionPat,gnum_isrequisitionform_needed as isRequisitionFormNeeded,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1 and sblnum_service_id=1)::character varying) as tariffTestRate,gstr_desk_properties as deskcallingid,nvl(a.gnum_ispidshow,'0')  as ispidshow,(SELECT nvl(gnum_isapptlabbased,'0') FROM hivt_laboratory_mst WHERE gnum_isvalid=1 AND gnum_lab_code = a.gnum_labcode AND gnum_hospital_code = a.gnum_hospital_code )  islabappointmentbased    FROM hivt_laboratory_test_mst a      WHERE  a.gnum_isvalid = 1  AND a.gnum_hospital_code =? AND    gnum_labcode in (  SELECT distinct gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid = 1    AND p.gnum_module_id =?  AND p.gstr_table_name  = 'HIVT_LABORATORY_MST'  AND p.gstr_column_name = 'GNUM_LAB_CODE'   AND (p.gnum_seatid =? or 1=1)  AND gnum_hospital_code = ? or 1=1)    AND a.gnum_hospital_code =?    and (select gnum_issearch from hivt_laboratory_mst b where b.gnum_lab_code=a.gnum_labcode and b.gnum_hospital_code=a.gnum_hospital_code and b.gnum_isvalid=1)=1  and exists (select 1 from hivt_test_mst v where v.gnum_test_code=a.gnum_test_code and a.gnum_isvalid=1)                      
 
SELECT_VIEWS_TESTWISE=select a.gnum_test_code as testCode,a.gnum_viewcode as viewCode,(select INITCAP(b.hivstr_viewname) from hivt_view_master b where b.gnum_viewcode=a.gnum_viewcode and gnum_isvalid=1) as viewName from hivt_test_view a where gnum_isvalid=1 

SELECT_ADDDITIONCHARGETEST_XRAY=select gnum_test_code from hivt_test_mst where gnum_isvalid=1 and gnum_xray=1

SELECT_ADDDITIONCHARGENOTADDFORTEST_XRAY=select String_agg(gnum_test_code,'#') from hivt_test_mst where gnum_isvalid=1 and gnum_isextracharge=1


SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST_RAISING_XRAYPROCESS=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid =1 and gnum_bookmark_type = 1 and gnum_hospital_code = ?   and gnum_user_id=? 

SELECT_TEST_FOR_NOT_ADD_VIEWS_CHARGE=select string_agg(gnum_test_code,'^') from hivt_test_mst where gnum_isvalid=1 and gnum_isextracharge=1


GET_LAST_REQ_DATE=select to_char(hivt_entry_date,'dd-mon-yyyy') from hivt_requisition_dtl where gnum_test_code=? and gnum_lab_code=? and gnum_hospital_code=? and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where hrgnum_puk=?) order by hivt_entry_date desc limit 1


SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL_XRAY=Select  (select nvl(hivt_view_count,'0') from hivt_req_view_dtl q where gnum_isvalid\=1 and q.gnum_hospital_code\=a.gnum_hospital_code and q.hivt_req_no\=a.hivnum_req_no and q.hivt_test_code\=a.gnum_test_code ) as totalviewcount,(select nvl(hivt_total_view_count,'0') from hivt_req_view_dtl q where gnum_isvalid\=1 and q.gnum_hospital_code\=a.gnum_hospital_code and q.hivt_req_no\=a.hivnum_req_no and q.hivt_test_code\=a.gnum_test_code ) as totalreqviewcount,(select nvl(gnum_type,'0') from hivt_req_view_dtl q where gnum_isvalid\=1 and q.gnum_hospital_code\=a.gnum_hospital_code and q.hivt_req_no\=a.hivnum_req_no and q.hivt_test_code\=a.gnum_test_code ) as totalreqviewtyp,(Select CONCAT(INITCAP(GSTR_TEST_NAME),decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid \= a.hivtnum_test_delete_seatid) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?) and a.gnum_hospital_code\= ? and (select gnum_issearch from hivt_laboratory_mst b where b.gnum_lab_code\=a.gnum_lab_code and b.gnum_hospital_code\=a.gnum_hospital_code and b.gnum_isvalid\=1)\=1 order by CAST(hivt_entry_date AS datetime) desc,testGroupCode,reqno

INSERT_VIEW_DETAILS_HIVT_REQ_VIEW_DETAILS=insert into hivt_req_view_dtl(hivt_test_code,hivt_view_code,hivt_view_count,hivt_req_no,hivt_req_dno,gnum_hospital_code,hivt_total_view_count,gnum_type,gnum_isvalid,hivdt_entry_date) values(?,?,?,?,?,?,?,?,'1',sysdate)
 
 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAIL_XRAY_REQ_WISE=select hivt_view_count as totalviewcount,hivt_total_view_count as totalreqviewcount,gnum_type as totalreqviewtyp,hivt_test_code as testCode  from hivt_req_view_dtl where gnum_isvalid=1 and gnum_hospital_code=? and hivt_req_no=?
 
 
#By PrashantMi
SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_PATIENTACCPDATE_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=13  and a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)   and TRUNC (a.hivtdt_pat_accpt_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivtdt_pat_accpt_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and exists ( select 1 from hivt_test_mst where gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and gstr_test_type\='P' and gnum_test_code \=a.gnum_test_code ) and  gnum_lab_code  like ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t


 
#By PrashantMi
SELECT.DEPT_RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_PATIENTACCPDATE_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_dept_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \\\= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \\\= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\\\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\\\=1 and hgnum_parameter_id\\\=k.hivnum_parameter_code)||''\\\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\\\=1 and k.hivtnum_test_code \\\= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\\\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\\\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\\\=1 and gnum_hospital_code\\\=a.gnum_hospital_code  and gnum_test_code\\\=a.gnum_test_code and gnum_labcode\\\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_dept_reqdtl_status\\\=32  and a.gnum_hospital_code \\\=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\\\=1    AND  p.gnum_module_id \\\=?  AND p.gstr_table_name \\\= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \\\= 'GNUM_LAB_CODE' AND p.gnum_seatid \\\= ?   AND p.gnum_hospital_code \\\= ?)  and TRUNC (a.hivtdt_pat_accpt_date_time) >\\\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivtdt_pat_accpt_date_time) <\\\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and exists ( select 1 from hivt_test_mst where gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and gstr_test_type\='P' and gnum_test_code \=a.gnum_test_code ) and  gnum_lab_code  like ?\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t

#By PrashantMi
#SELECT.RESULT_REPORT_PRINTING_PATIENTACCPDATE_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivtdt_pat_accpt_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivtdt_pat_accpt_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and exists ( select 1 from hivt_test_mst where gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and gstr_test_type\='P' and gnum_test_code \=a.gnum_test_code ) and gnum_lab_code  like ?
SELECT.RESULT_REPORT_PRINTING_PATIENTACCPDATE_HIVT_REQUISITION_HEADER1=Select hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_report_dtl_hst a WHERE  hivnum_reqdtl_status in (26,14)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivtdt_pat_accpt_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivtdt_pat_accpt_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and exists ( select 1 from hivt_test_mst where gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and gstr_test_type\='P' and gnum_test_code \=a.gnum_test_code ) and gnum_lab_code  like ?

#By PrashantMi
SELECT.DEPT_RESULT_REPORT_PRINTING_PATIENTACCPDATE_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_dept_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select hgstr_parameter from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_dept_reqdtl_status in (33,34)  and a.gnum_hospital_code \=? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?)  and  TRUNC (a.hivtdt_pat_accpt_date_time) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivtdt_pat_accpt_date_time) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? and  TRUNC (a.hivdt_dept_report_date + INTERVAL '1 day') >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) and exists ( select 1 from hivt_test_mst where gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1 and gstr_test_type\='P' and gnum_test_code \=a.gnum_test_code )
 
 
 
 #SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAILLLLL_NEW=select  reqdatee,testName,testGroupName,testGroupCode,reqNo,prvLabCode,labName,prvTestCode,priority,reqDate,sampleCode,prvReqStatus,status,sampleName,sortReqDate from  (Select a.hivt_entry_date as reqdatee,(Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid \=1 and gnum_test_code \=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid \=1 and gnum_hospital_code  \= ? and hrgnum_puk  \= ?) and a.gnum_hospital_code \= ? union Select a.hivt_entry_date as reqdatee,(Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid \=1 and gnum_test_code \=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl_hst a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid \=1 and gnum_hospital_code  \= ? and hrgnum_puk  \= ?) and a.gnum_hospital_code \= ?) results order by reqdatee desc,testGroupCode,reqno
 SELECT.LAB_WISE_TEST.HIVT_TEST_MST_PRV_TEST_DETAILLLLL_NEW=select  reqdatee,testName,testGroupName,testGroupCode,reqNo,prvLabCode,labName,prvTestCode,priority,reqDate,sampleCode,prvReqStatus,status,sampleName,sortReqDate from  (Select a.hivt_entry_date as reqdatee,(Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid \=1 and gnum_test_code \=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid) ||')'||'('|| (to_char(a.hivtdt_test_delete_date,'dd-mm-yyyy HH24:MI:SS'))||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid \=1 and gnum_hospital_code  \= ? and hrgnum_puk  \= ?) and a.gnum_hospital_code \= ? union Select a.hivt_entry_date as reqdatee,(Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid \=1 and gnum_test_code \=a.gnum_test_code ) as testName,pkg_inv_fun.getgroupname(hgnum_group_code,gnum_hospital_code) as testGroupName,a.hgnum_group_code as testGroupCode,a.hivnum_req_no as reqNo,a.hivtnum_req_dno ,a.gnum_lab_code as prvLabCode, pkg_inv_fun.fun_lab_name(a.gnum_lab_code,a.gnum_hospital_code) as labName, a.gnum_test_code as prvTestCode, a.gbnum_priority_code,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,to_char(a.hivt_entry_date,'dd-Mon-yyyy hh\:mi\:ss') as reqDate,decode(pkg_inv_fun.fun_test_type(a.gnum_test_code),'P','Patient Based','S','Sample Based', 'I','Slide Based') as sampleCode, a.hivnum_reqdtl_status as prvReqStatus, DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid  \= a.hivtnum_test_delete_seatid) ||')'||'('|| (to_char(a.hivtdt_test_delete_date,'dd-mm-yyyy HH24:MI:SS'))||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') status,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) sampleName,a.gnum_sample_code,to_char(a.hivt_entry_date,'MMddyyyy') as sortReqDate from hivt_requisition_dtl_hst a where a.hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid \=1 and gnum_hospital_code  \= ? and hrgnum_puk  \= ?) and a.gnum_hospital_code \= ?) results order by reqdatee desc,testGroupCode,reqno
 
 
SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL_NEW=SELECT a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, NVL(initcap(a.hrgstr_father_name),'-') AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency OPD', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?

#SELECT_REPORT_DATA_CRNO_WISE_REQ_DTL=select TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24:mi') as sampleCollectionDate,hivnum_req_no as requistionNo,a.gnum_lab_code as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST c where c.gnum_isvalid=1 and c.GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and c.GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName,a.gnum_test_code as testCode,(SELECT  b.gstr_test_name    FROM hivt_test_mst b WHERE b.gnum_isvalid=1 and b.gnum_test_code = a.gnum_test_code) AS testName,hgnum_group_code as groupCode,decode(hgnum_group_code,null,'',pkg_inv_fun.getgroupname(a.hgnum_group_code::character varying,a.gnum_hospital_code)) as groupName,a.hivnum_reqdtl_status as reqStatusCode,DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid = a.gnum_seat_id ) || ',' || (SELECT d.gstr_user_name FROM gblt_user_mst d WHERE d.gnum_userid = a.gnum_seat_id) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing') as reqstatusName,a.hivnum_temp_sample_no as sampleNo,a.hgstr_daily_labno as LabNo,a.hivdt_report_date as reportGeneDate,a.hivdt_requisition_date_reqd as reportReqDate,a.gbnum_priority_code as prioirtyCode,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priorityName,a.gnum_bill_no as billNo,a.hivstr_report_url  as reportUrl from hivt_requisition_dtl a where a.hrgnum_puk_reqd=? order by a.hivnum_temp_sample_no,hivdt_requisition_date_reqd desc
 SELECT_REPORT_DATA_CRNO_WISE_REQ_DTL=select TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24:mi') as sampleCollectionDate,hivnum_req_no as requistionNo,a.gnum_lab_code as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST c where c.gnum_isvalid=1 and c.GNUM_HOSPITAL_CODE = a.GNUM_HOSPITAL_CODE and c.GNUM_LAB_CODE = a.GNUM_LAB_CODE ) as labName,a.gnum_test_code as testCode,(SELECT  b.gstr_test_name    FROM hivt_test_mst b WHERE b.gnum_isvalid=1 and b.gnum_test_code = a.gnum_test_code) AS testName,hgnum_group_code as groupCode,decode(hgnum_group_code,null,'',pkg_inv_fun.getgroupname(a.hgnum_group_code::character varying,a.gnum_hospital_code)) as groupName,a.hivnum_reqdtl_status as reqStatusCode,DECODE(a.hivnum_reqdtl_status,2,'Requisition Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid = a.hivtnum_test_delete_seatid ) || ',' || (SELECT d.gstr_user_name FROM gblt_user_mst d WHERE d.gnum_userid = a.hivtnum_test_delete_seatid) ||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') as reqstatusName,a.hivnum_temp_sample_no as sampleNo,a.hgstr_daily_labno as LabNo,TO_CHAR(a.hivdt_report_date, 'DD-Mon-YYYY hh24:mi') as reportGeneDate,TO_CHAR(a.hivdt_requisition_date_reqd, 'DD-Mon-YYYY hh24:mi') as reportReqDate,a.gbnum_priority_code as prioirtyCode,decode(a.GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priorityName,a.gnum_bill_no as billNo,a.hivstr_report_url  as reportUrl from hivt_requisition_dtl a where a.hrgnum_puk_reqd=? order by a.hivnum_temp_sample_no,hivdt_requisition_date_reqd desc
 
 
SELECT.SUGAR_TEST=select gnum_test_code as testCode,nvl(gnum_sugartestcode,'-') as sugartestcode from hivt_test_mst where is_sugartest=1 and gnum_isvalid=1
  
 SELECT.MACHINE_TEST=select gnum_test_code as testCode,nvl(gnum_sugartestcode,'-') as sugartestcode from hivt_test_mst where is_machinetest=1 and gnum_isvalid=1
 
 SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1_TESTWISE=select        gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest,hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType   from hivt_sampleno_conf_mst1  where  gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code in(?)\t and gnum_pat_type in(3,?)  and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc
 
 SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST_TESTWISE=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code in (?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code\=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc
 
 SELECT.DNO.REPORT_INPROCESSS=select  String_agg(hivtnum_req_dno,',') from hivt_requisition_header where hivnum_req_no=? and gnum_hospital_code=? and hivnum_reqdtl_status in (26,14,13)
  
 UPDATE.RESULT.ENTRY.DETAIL.HIVT_REQ_DTL= update hivt_requisition_dtl set hivstr_report_url=null,hivnum_reqdtl_status=13 where hivtnum_req_dno=? and gnum_hospital_code=?
 
 #UPDATE.RESULT.ENTRY.DETAIL.HIVT_REQ_DTL_DAILY= delete hivt_requisition_dtl_daily where hivtnum_req_dno=? and gnum_hospital_code=?
 UPDATE.RESULT.ENTRY.DETAIL.HIVT_REQ_DTL_DAILY= delete hivt_report_dtl_daily where hivtnum_req_dno=? and gnum_hospital_code=?
 
 
 #SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER_INPROCESS_DNO_WISE=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status=13  and a.gnum_hospital_code =?  and a.hivnum_req_no=?
 
 SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER_INPROCESS_DNO_WISE=Select hivnum_req_no AS requisitionNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.hivnum_parameter_code)||''#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid=1 and k.hivtnum_test_code = '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNO,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status in (13,26,14) and  HIVNUM_RESULT_SEATID is not null and a.gnum_hospital_code =?  and a.hivnum_req_no=?
 
 
 
 UPDATE.DEMGRAPHICS.HIVT_REQUISITION_HEADER_DTL=update hivt_requisition_dtl set hrgstr_patname_reqd=?, gstr_gender_code_reqd=?, hivstr_age_reqd=?,hivnum_sms_flag_reqd=0 where hrgnum_puk_reqd=? and hivnum_req_no=? and gnum_hospital_code=?

 
 UPDATE.FINALREMARK.HIVT_REQUISITION_HEADER_DTL=update hivt_requisition_dtl set hivstr_final_remark=?,hivnum_sms_flag_reqd=0 where gnum_isvalid_reqd=1 and hivnum_req_no=? and gnum_hospital_code=?
 
 UPDATE.ADDENDUMREMARK.HIVT_REQUISITION_HEADER_DTL=update hivt_requisition_dtl set hivstr_addendum_remark_reqd=? where gnum_isvalid_reqd=1 and hivnum_req_no=? and gnum_hospital_code=?
 
 UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_DAILYTBL=UPDATE hivt_report_dtl_daily   SET hivnum_reqdtl_status\=?, hivtdt_res_print_date\=SYSDATE, hivtnum_res_print_seatid\=? WHERE hivtnum_req_dno\=?
 
 #UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_GROUP_CASE_HSTBL = UPDATE hivt_report_dtl_hst SET hivnum_reqdtl_status=?, hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=? WHERE hivnum_req_no=? and hgnum_group_code = ?
 
 UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_GROUP_CASE_HSTBL = UPDATE hivt_report_dtl_hst SET hivnum_reqdtl_status=?, hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=? WHERE hivnum_req_no=? and hgnum_group_code = ? and hivnum_reqdtl_status in (26,14)
 
 UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_HSTTBL=UPDATE hivt_report_dtl_hst   SET hivnum_reqdtl_status\=?, hivtdt_res_print_date\=SYSDATE, hivtnum_res_print_seatid\=? WHERE hivtnum_req_dno\=?
 
 #SEELCT_CHARGE_TEST_LIST=select gnum_test_code as testCode ,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=b.gnum_test_code and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=1 )::character varying) as tariiff from hivt_laboratory_test_mst b where b.gnum_isvalid=1 and b.gnum_hospital_code=? ;
 
 SEELCT_CHARGE_TEST_LIST=select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying) as tariiff from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?
 
 
 
 
  SELECT_IS_GROUP_CODE_HIDE_NOT=select is_shown from hivt_test_group_mst where gnum_isvalid=1 and is_shown=1 and hgnum_group_code=? and gnum_hospital_code=100
  
  
  INSERT.hivt_report_start.DATA=insert into hivt_report_start (hivnum_report_start_flag,gdt_entry_date,gnum_isvalid) values (1,sysdate,1)
  
  SELECT.ISSAMPLEBARCODE.DUPLICATE.PRINT.HIVT_REPORT_DB_MST=select nvl(is_single_barcode_print,0) from hivt_report_db_mst where gnum_isvalid=1 and gnum_hospital_code=? and gnum_parameter_id=4
 
 
 #SELECT.TEST_CHARGES=select gnum_test_code as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=(a.gnum_test_code) and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=1)::character varying)||'@#'||initcap(nvl(a.gstr_test_name,'NA')) as testrate from hivt_test_mst a where gnum_isvalid=1
 
 #SELECT.TEST_CHARGES=select gnum_test_code as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||'aa' from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and  a.gnum_hospital_code=? and b.gnum_hospital_code=? and gstr_tariff_id=b.gnum_test_code
 #SELECT.TEST_CHARGES=select gnum_test_code as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code in  (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and  a.gnum_hospital_code=? and b.gnum_hospital_code=? and gstr_tariff_id=b.gnum_test_code
 #SELECT.TEST_CHARGES=SELECT testCode,testrate FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?)UNION select GNUM_TEST_CODE as testCode,'@#AA' FROM HIVT_TEST_MST WHERE GNUM_TEST_CODE NOT IN (SELECT testCode FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?))
 #SELECT.TEST_CHARGES=SELECT testCode,testrate FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?)UNION select GNUM_TEST_CODE as testCode,'0@#AA' FROM HIVT_TEST_MST WHERE GNUM_TEST_CODE NOT IN (SELECT testCode FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?))
 
# SELECT.TEST_CHARGES=SELECT testCode,testrate FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?)UNION select GNUM_TEST_CODE as testCode,'0@#AA' FROM HIVT_TEST_MST WHERE GNUM_TEST_CODE NOT IN (SELECT testCode FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?))
 #SELECT.TEST_CHARGES=SELECT testCode,testrate FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?)UNION select GNUM_TEST_CODE as testCode,'0@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (c.gnum_test_code)) FROM HIVT_TEST_MST c WHERE GNUM_TEST_CODE NOT IN (SELECT testCode FROM(select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?))
 #SELECT.TEST_CHARGES=select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?
 SELECT.TEST_CHARGES=select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying)||'@#'||(SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid=1 and gnum_test_code in (b.gnum_test_code)) as testrate from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?
 SEELCT_CHARGE_TEST_LIST=select (gnum_test_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying, hblnum_tariff_id::character varying) as tariiff from hblt_tariff_mst a,hivt_laboratory_test_mst b where a.gnum_isvalid=1 and b.gnum_isvalid=1 and sblnum_service_id=1 and gstr_tariff_id=b.gnum_test_code and a.gnum_hospital_code=? and b.gnum_hospital_code=?
 #SELECT.GROUP_CHARGES=select distinct(hgnum_group_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,0::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=((select distinct(gnum_lab_code)||''||(select distinct(hgnum_group_code) from hivt_test_group_mst c where gnum_hospital_code=? and c.hgnum_group_code=hgnum_group_code and gnum_is_valid=1) from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=?)) and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=4)::character varying) as testrate from hivt_test_group_info_mst a where gnum_is_valid=1 and gnum_hospital_code=?
 #SELECT.GROUP_CHARGES=select distinct(hgnum_group_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id=((select distinct(gnum_lab_code)||''||(select distinct(hgnum_group_code) from hivt_test_group_mst c where gnum_hospital_code=? and c.hgnum_group_code=hgnum_group_code and gnum_is_valid=1) from hivt_test_group_info_mst where gnum_is_valid=1 and gnum_hospital_code=?)) and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=4)::character varying) as testrate from hivt_test_group_info_mst a where gnum_is_valid=1 and gnum_hospital_code=?
# SELECT.GROUP_CHARGES=select distinct(hgnum_group_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id = ((select distinct(a.gnum_lab_code)||''||(select distinct(c.hgnum_group_code) from hivt_test_group_mst c where gnum_hospital_code=? and c.hgnum_group_code=a.hgnum_group_code and c.gnum_isvalid=1) )) and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=4)::character varying) as testrate from hivt_test_group_info_mst a where gnum_is_valid=1 and gnum_hospital_code=?
 SELECT.GROUP_CHARGES=select distinct(a.hgnum_group_code) as testCode,BILL_MST.GETCHARGEDETAILS (10::character varying,?::character varying,?::character varying,?::character varying,?::character varying,(select hblnum_tariff_id from hblt_tariff_mst where gstr_tariff_id = ((select distinct(a.gnum_lab_code)||''||(select distinct(c.hgnum_group_code) from hivt_test_group_mst c where gnum_hospital_code=? and c.hgnum_group_code=a.hgnum_group_code and c.gnum_isvalid=1) )) and gnum_hospital_code=? and gnum_isvalid=1 and sblnum_service_id=4)::character varying) ||'@#'||nvl(b.hgstr_group_name,'NA') as testrate from hivt_test_group_info_mst a,hivt_test_group_mst b where a.gnum_is_valid=1 and a.gnum_hospital_code=? and b.gnum_hospital_code=?and a.hgnum_group_code=b.hgnum_group_code and b.gnum_isvalid=1
 
 
 SELECT_DATA_UPDATE=Select c.hivtnum_parent_parameter_code as parantParaCode,(Select CONCAT(GSTR_TEST_NAME,decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code ) as testName,(select hmistr_machine_name from hmit_machine_mst ss where hminum_machine_id=gnum_machine_code and ss.gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) as machineCode,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no)) as pidno,(Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as ispidshow ,decode((select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_is_valid=1 and hgnum_group_code=a.hgnum_group_code),null,null,(select (gnum_test_seq_no) from hivt_test_group_info_mst where gnum_test_code=a.gnum_test_code and gnum_hospital_code=a.gnum_hospital_code and gnum_is_valid=1 and  hgnum_group_code=a.hgnum_group_code))::numeric as grp,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,(select String_agg(gnum_parameter_code||'#@'||nvl((select hgstr_parameter from hivt_parameter_mst where gnum_isvalid=1 and hgnum_parameter_id=k.gnum_parameter_code),'NA')||'#@'||(select decode(gnum_range_type,'4',gnum_range_type||'$'||hgstr_range_value_uom||'$'||hgstr_range_value||'$null',1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null',2,1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null',3,1,gnum_range_type||'$'||hgstr_high_value||'$'||hgstr_low_value||'$'||hgstr_high_value_uom||'$'||hgstr_low_value_uom||'$null') from hivt_test_mand_ref_val_mst o where o.gnum_test_code=k.gnum_test_code and o.gnum_parameter_code=k.gnum_parameter_code limit 1)||'#@'||(select decode(hivtstr_value,'--','',hivtstr_value) from hivt_parameter_dtl p where  p.gnum_isvalid=1 and p.hivtnum_test_code =k.gnum_test_code   and p.hivtnum_req_dno=a.hivtnum_req_dno and p.gnum_hospital_code=a.gnum_hospital_code and p.hivnum_parameter_code=gnum_parameter_code)||'#@','`' ORDER BY hivt_num_element_sequence) from hivt_test_parameter_mst k where gnum_test_code=a.gnum_test_code and gnum_isvalid=1 ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid=1 and gnum_lab_code=a.gnum_lab_code and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code=a.gnum_hospital_code and u.gnum_isvalid=1 and u.hgnum_group_code=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,b.hrgstr_visit_reason as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid=1 and p.gnum_hospital_code=a.gnum_hospital_code and p.gnum_lab_code=a.gnum_lab_code) as labtype, TO_CHAR (a.hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate, decode ((select showRepeat from hivt_laboratory_mst where gnum_lab_code=a.gnum_lab_code and gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code ), 0, 0, 1, (select count(*) from HIVT_REQUISITION_DTL where TRUNC(hivdt_coll_date_time)>TRUNC(to_date(a.hivdt_coll_date_time,'dd-Mon-YYYY')-15)  and gnum_test_code=a.gnum_test_code and hivnum_req_no in (select hivnum_req_no from hivt_requisition_header where  gnum_isvalid = 1 and hrgnum_puk=(select hrgnum_puk from hivt_requisition_header where  gnum_isvalid = 1 and hivnum_req_no=a.hivnum_req_no AND gnum_hospital_code = a.gnum_hospital_code ) )))  as isRepeat  FROM hivt_requisition_dtl a,hivt_requisition_header b,hivt_parameter_dtl c WHERE a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE'    AND p.gnum_hospital_code = ?)    AND a.hivnum_req_no=b.hivnum_req_no AND a.gnum_hospital_code=b.gnum_hospital_code  and a.gnum_lab_code like '%' and c.hivtnum_req_dno=a.hivtnum_req_dno order by hivnum_temp_sample_no,preferenceOrder,grp,hivdt_coll_date_time desc
 
 UPDATE.REF.RANGE=update hivt_parameter_dtl  set hivstr_referencerange=?,hivt_isinrefrange=?  where hivtnum_req_dno=? and hivtnum_test_code=? and hivtnum_parent_parameter_code=? and gnum_hospital_code=? and gnum_isvalid=1
 
 
 #modified to add hos code DATWISE
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1_DATEWISE=select  gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest,hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType   from hivt_sampleno_conf_mst1  where  gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?)  and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc

#modified to add hos code DATWISE

SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST_DATEWISE=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code in (-1,?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code\=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc
 
 
 #modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_SAMPLENO_CONF_MST1_ISSYNC=select   nvl(is_sync,'0') as runningSampleNo from hivt_sampleno_conf_mst1  where gnum_lab_code\=? and gnum_test_code \=?\t and gnum_pat_type \=? AND gnum_is_valid\=1   and gnum_hospital_code\=? and gnum_sq_no\=?
#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_COLAREA_SAMNO_CONFIG_MST_ISYSNC=select    nvl(is_sync,'0') as runningSampleNo     from hivt_colarea_samno_config_mst  where gnum_lab_code\=?   and gnum_area_code\=?  and gnum_pat_type \=?  AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?    
 
UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS_ISYSYNC=UPDATE hivt_sampleno_conf_mst1   SET   gdt_initialization_date\=?\:\:timestamp without time zone  ,hivstr_running_lab_no\=?,is_sync='0' where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code \=? and gnum_pat_type\=? and gnum_hospital_code\=? and gnum_sq_no\=?

UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST_ISYSYNC=UPDATE hivt_colarea_samno_config_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=?,is_sync='0' where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?  \t\t\t\t\t\t\t\t\t\t\t\t\t\t 

 
 SELECT.BYDEFAULT.CHECKSAMPLENO=select gnum_sample_code from hivt_labtest_sample_mst b where gnum_lab_code=? and gnum_test_code=? and gnum_isvalid=1 and gnum_hospital_code=? and gnum_is_default_sample=1  and exists (select 1 from hivt_test_mst a where gnum_isvalid=1 and a.gnum_test_code=b.gnum_test_code and GSTR_TEST_TYPE='S') limit 1
 
 
 UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS_ISYSYNC_SAMESAMPLENO=UPDATE hivt_sampleno_conf_mst1   SET   is_sync='0' where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code \=? and gnum_pat_type\=? and gnum_hospital_code\=? and gnum_sq_no\=?

UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST_ISYSYNC_SAMESAMPLENO=UPDATE hivt_colarea_samno_config_mst   SET  is_sync='0' where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?  \t\t\t\t\t\t\t\t\t\t\t\t\t\t 
 

SELECT.LABWISE.FORMAT.SAMPLENOGEN=select  count(gnum_lab_code) from  hivt_sampleno_conf_mst1    where gnum_is_valid=1 and gnum_lab_code=? and gnum_test_code =? and gnum_pat_type=? and gnum_hospital_code=? and gnum_sq_no=? gnum_isgenerate=1  and gnum_istestwise=0 or gnum_istestwise is null

SELECT.TESTWISE.FORMAT.SAMPLENOGEN=select  count(gnum_lab_code) from  hivt_sampleno_conf_mst1    where gnum_is_valid=1 and gnum_lab_code=? and gnum_test_code =? and gnum_pat_type=? and gnum_hospital_code=? and gnum_sq_no=? gnum_isgenerate=1  and gnum_istestwise=1 

SELECT.LABWISE.FORMAT.SAMPLENOGEN_COLLAREA=select count(gnum_lab_code) from  hivt_sampleno_conf_mst1    where gnum_is_valid=1 and gnum_lab_code=? and gnum_area_code =? and gnum_pat_type=? and gnum_hospital_code=? and gnum_sq_no=? gnum_isgenerate=1  and gnum_istestwise=0 or gnum_istestwise is null

UPDATE_HIVT_PARAMETER_DTL_NEWUPDATE=update hivt_parameter_dtl set hivtstr_value=?,hivstr_loinc_string=?,hivstr_ref_range=?,hivtnum_order=?,hivt_upload_filedata=?,hivt_upload_filename=? where hivtnum_req_dno=?  and gnum_hospital_code=?  and hivtnum_test_code=?  and hivtnum_parent_parameter_code=?  and gnum_isvalid=1


SELECT_COUNT_RESULT_ENTRY_DETAIL_HIVT_PARAMETER_DTL= select count(*) from hivt_parameter_dtl where gnum_isvalid=1 and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and hivtnum_parent_parameter_code = ? and gnum_hospital_code=? ;
    
SELECT_COUNT_PARAMETER_DTL_TEXTAREA= select count(*) from hivt_test_parameter_mst where gnum_isvalid=1 and gstr_element_type='H'  and gnum_parameter_code=? and gnum_test_code=? ;
    
SELECT_DEFAULT_PARAMETER_DTL_TEXTAREA= select nvl(HIVTSTR_DEFAULT_VALUE,'--') from hivt_test_parameter_mst where gnum_isvalid=1 and gnum_test_code=? and gnum_parameter_code=? and gstr_element_type='H' ;

INSERT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL_TEXTAREA=INSERT INTO hivt_parameter_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    \
                                           hivnum_parameter_code, gnum_isvalid,hivtnum_order)    \
                                                 VALUES (?, ?, ?,?, SYSDATE, ?, ?,?, ?,?);

SELECT.HIVT_PARAMETER_DTL.DEFAULTVALUES_VALI_TEXTEDIOTR = SELECT concat(GNUM_TEST_CODE,gnum_parameter_code), HIVTSTR_DEFAULT_VALUE , gnum_parent_id FROM hivt_test_parameter_mst WHERE  gnum_isvalid=1 and gstr_element_type='H' and gnum_test_code=? 
                                                 
                                                 
 #SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER_PIDD= Select pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential','Normal') as priority,DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid = a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid = a.hivtnum_test_delete_seatid) ||')'||'('|| (to_char(a.hivtdt_test_delete_date,'dd-mm-yyyy HH24:MI:SS'))||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') as reqDtlStatus,hipstr_ward_name_reqd as wardName,hipstr_bed_name_reqd as bedName,hrgstr_mobile_no_reqd as mobileNo,(Select CONCAT(INITCAP(GSTR_TEST_NAME),decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code ) as testName,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no)) as pidno,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid=1 and gnum_lab_code=a.gnum_lab_code and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code=a.gnum_hospital_code and u.gnum_isvalid=1 and u.hgnum_group_code=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,hrgstr_visit_reason_reqd as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid=1 and p.gnum_hospital_code=a.gnum_hospital_code and p.gnum_lab_code=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate  FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code =?)   and  TRUNC (a.hivt_entry_date) >= TRUNC (hivt_entry_date-90)  and gnum_test_code in (12762) and hrgnum_puk_reqd=? order by hivt_entry_date desc 
 SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER_PIDD= Select pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential','Normal') as priority,DECODE(a.hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted',7,'Result Entered', 8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed', 15,'Test Cancelled',16,'Test Deleted ('|| ( SELECT b.gstr_usr_name FROM gblt_user_mst b WHERE b.gnum_userid = a.hivtnum_test_delete_seatid ) || ',' || (SELECT b.gstr_user_name FROM gblt_user_mst b WHERE b.gnum_userid = a.hivtnum_test_delete_seatid) ||')'||'('|| (to_char(a.hivtdt_test_delete_date,'dd-mm-yyyy HH24:MI:SS'))||')',26,'Report Generated',55,'Test Advised',17,'Machine Processing',18,'Machine Processing',27, 'in Draft(Result Entry)',28, 'in Draft(Result Validation)') as reqDtlStatus,hipstr_ward_name_reqd as wardName,hipstr_bed_name_reqd as bedName,hrgstr_mobile_no_reqd as mobileNo,(Select CONCAT(INITCAP(GSTR_TEST_NAME),decode(hivstr_site,'1','(NA)','2','(Both)','3','(Left)','4','(Right)')) from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code ) as testName,decode((Select nvl(gnum_ispidshow,0) from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code),0,null,1,(Select nvl(hivstr_pid_no,'') from hivt_ictc_dtl where hivnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no)) as pidno,a.hivnum_req_no AS RequisitionNo,hivnum_reqdtl_status as reqDtlStatus,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,hivstr_dept_report_url as deptReport,hivstr_report_url as reportUrl,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO = A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,a.hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,a.gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code  and gnum_test_code=a.gnum_test_code and gnum_labcode=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,a.gnum_hospital_code) as groupName, hivnum_uom as uomCode, pkg_inv_fun.Fun_getisgroupprintedwithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code)     AS dynamicTemplatePrintedGroup, pkg_inv_fun.Fun_getisgroupresultentrywithdynamictemplate(a.hgnum_group_code, a.gnum_hospital_code, a.gnum_lab_code) AS dynamnicTemplateResultEntryGroup,(select gnum_finalremark_reqd from hivt_laboratory_mst where gnum_isvalid=1 and gnum_lab_code=a.gnum_lab_code and gnum_hospital_code=a.gnum_hospital_code) as finalRemarkReqd,a.hivstr_final_remark as finalRemarkString,(select gstr_instruction_tech from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as instructionPat,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded,(decode(hgnum_group_code,null,(select gnum_preference_order from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code),(select preference_order from hivt_test_group_mst u where u.gnum_hospital_code=a.gnum_hospital_code and u.gnum_isvalid=1 and u.hgnum_group_code=a.hgnum_group_code))) as preferenceOrder,(select hivstr_addendum_remark from hivt_requisition_header where gnum_isvalid=1 and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as addendumRemarkValue,a.gnum_report_change as reportChangeFlag,DECODE(a.gnum_machine_code,-1,0,null,0,1) As isMachineBasedTest,hrgstr_visit_reason_reqd as visitReason,(select nvl(hgnum_pat_test_type,'0') from hivt_laboratory_mst p where p.gnum_isvalid=1 and p.gnum_hospital_code=a.gnum_hospital_code and p.gnum_lab_code=a.gnum_lab_code) as labtype, TO_CHAR (hivt_entry_date, 'DD-Mon-YYYY') as requisitionDate,(hivt_entry_date) as patReqDate  FROM hivt_requisition_dtl a WHERE a.gnum_hospital_code =? AND   a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid=1    AND  p.gnum_module_id =15  AND p.gstr_table_name = 'HIVT_LABORATORY_MST' AND p.gstr_column_name = 'GNUM_LAB_CODE' AND p.gnum_seatid = ?   AND p.gnum_hospital_code =?)   and  TRUNC (a.hivt_entry_date) >= TRUNC (hivt_entry_date-90)  and gnum_test_code in (12762) and hrgnum_puk_reqd=? order by hivt_entry_date desc 
 
 SELECT_ISPID_EXIST_PIDFORM=select hrgnum_puk as patpuk,hivnum_gender as patgender,hivnum_pregnancy as ispregnant,hivstr_pid_no as pidno,hivnum_visit_type as intiatedtype, gnum_is_followup as followup from hivt_ictc_dtl where hrgnum_puk=?  and hivnum_isvalid=1  
 
 UPDATE_PID_INVALID= update hivt_ictc_dtl set hivnum_isvalid=0 where hivnum_req_no=? and hivnum_isvalid=1
 
 UPDATE_PID_DATA=update hivt_ictc_dtl set gnum_hospital_code=?,hivnum_hiv1_result=(select nvl(hivtstr_value,'') from hivt_parameter_dtl where hivtnum_parent_parameter_code in (127623590) and gnum_isvalid=1 and hivtnum_req_dno in (select hivtnum_req_dno from hivt_requisition_dtl where hivnum_req_no=? and gnum_hospital_code=?)),hivnum_hiv2_result=(select nvl(hivtstr_value,'') from hivt_parameter_dtl where hivtnum_parent_parameter_code in (127653598) and gnum_isvalid=1 and hivtnum_req_dno in (select hivtnum_req_dno from hivt_requisition_dtl where hivnum_req_no=? and gnum_hospital_code=?))  where  hivnum_req_no=? and hivnum_isvalid=1
 
 #INSERT.HIVT_ICTC_DTL_PIDFORM=INSERT INTO hivt_ictc_dtl( hivnum_visit_no, hrgnum_puk, hivnum_req_no, hivnum_visit_type, gnum_is_followup, hivnum_gender, hivstr_pat_name, hivstr_address, hivstr_city, hivstr_district, hivstr_age, hivstr_contact_no, hivnum_pregnancy,hivstr_pid_no, hivnum_hiv1_result, hivnum_hiv2_result, hivnum_isvalid,hivnum_entry_date, hivnum_seat_id)VALUES ( (select (nvl(max(hivnum_visit_no),0))+1 from hivt_ictc_dtl where hrgnum_puk=?),?, ?,?,?,?,?, ?,?,?, ?, ?, ?, ?, ?,?, ?,sysdate,?)
 
 INSERT.HIVT_ICTC_DTL_PIDFORM=INSERT INTO hivt_ictc_dtl( hivnum_visit_no, hrgnum_puk, hivnum_req_no, hivnum_visit_type, gnum_is_followup, hivnum_gender, hivstr_pat_name, hivstr_address, hivstr_city, hivstr_district, hivstr_age, hivstr_contact_no, hivnum_pregnancy,hivstr_pid_no, hivnum_hiv1_result, hivnum_hiv2_result, hivnum_isvalid,hivnum_entry_date, hivnum_seat_id,hivnum_modify_date)VALUES ( (select (nvl(max(hivnum_visit_no),0))+1 from hivt_ictc_dtl where hrgnum_puk=?),?, ?,?,?,?,?, ?,?,?, ?, ?, ?, ?, ?,?, ?,to_date(?),?,sysdate)
 
 
 
 
#aDDED BY PRACHI FOR BILLED AND UNBILLED LIST OF LAB TEST BASED ON CRNO USED IN SAMPLE COLLECTION NEW PROCESS
SELECT_INV_BILLED_UNBILLED_DTL_BASED_ON_CRNO =Select hrgnum_puk_reqd as patCRNo,pkg_inv_fun.fun_group_name(hgnum_group_code,gnum_hospital_code) as groupName,(SELECT  nvl(gnum_is_anyinstruction_req,'0')    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) as isanyInstruction,(SELECT (select hivstr_fastingtime from hivt_fasting_time_mst where gnum_fastingId=gnum_fasting_time and gnum_isvalid=1)    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) as fastingTime,(SELECT  (select hivstr_fastingtype from hivt_fasting_type_mst where gnum_fastingtypeId=gnum_fasting_type and gnum_isvalid=1)    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) as fastingType,(SELECT  gnum_bladder_ins    FROM hivt_test_mst  WHERE gnum_isvalid=1 and gnum_test_code = a.gnum_test_code) as bladderintr,GNUM_HOSPITAL_CODE,(select (NVL(initcap(b.hrgstr_fname),' ')||' '||NVL(initcap(b.hrgstr_mname),' ')||' '||NVL(initcap(b.hrgstr_lname),' ')) from hrgt_patient_dtl b  WHERE gnum_isvalid =1 and hrgnum_puk = a.hrgnum_puk_reqd )as patName, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code::character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)::character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )::character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )::character varying, (a.HIVNUM_REQ_NO||'!')::CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE = a.GNUM_LAB_CODE and gnum_hospital_code =a.gnum_hospital_code and gnum_isvalid=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid=1 and gnum_test_code=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid=1 and gnum_sample_code=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE= a.GNUM_LAB_CODE and GNUM_TEST_CODE=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and gnum_isvalid=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE= a.GNUM_LAB_CODE and GNUM_TEST_CODE=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and gnum_isvalid=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE= a.GNUM_LAB_CODE and GNUM_TEST_CODE=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and gnum_isvalid=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE= a.GNUM_LAB_CODE and GNUM_TEST_CODE=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and gnum_isvalid=1 and GNUM_IS_DEFAULT_SAMPLE=1 and rownum=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID=1 and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO= a.HIVNUM_REQ_NO and gnum_hospital_code=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and gnum_labcode=a.gnum_lab_code and gnum_test_code=a.gnum_test_code  ) as isrequisitionformneeded from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (2,11) and hrgnum_puk_reqd = ? and gnum_hospital_code=? and exists ((select 1 from hivT_laboratory_test_mst e where e.gnum_isvalid=1 and e.gnum_hospital_code=a.gnum_hospital_code and e.gnum_labcode=a.gnum_lab_code and e.gnum_test_code=a.gnum_test_code  )) and exists ((select 1 from hivT_test_mst l where l.gnum_isvalid=1  and l.gnum_test_code=a.gnum_test_code  ))   
#old query
#SELECT_INV_BILLED_UNBILLED_DTL_BASED_ON_CRNO = Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\\:\\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\\:\\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\\:\\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\\:\\:character varying, (a.HIVNUM_REQ_NO||'\\!')\\:\\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \\= a.GNUM_LAB_CODE and gnum_hospital_code \\=a.gnum_hospital_code and gnum_isvalid\\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\\=1 and gnum_test_code\\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Confidential') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\\=1 and gnum_sample_code\\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\\=1 and GNUM_IS_DEFAULT_SAMPLE\\=1 and rownum\\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\\=1 and GNUM_HOSPITAL_CODE\\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\\= a.HIVNUM_REQ_NO and gnum_hospital_code\\=a.gnum_hospital_code) as patType,decode(hivtnum_priority_all,1,'Normal',2,'Urgent',3,'Confidential') as priorityAll,hivtnum_priority_all as priorityAllCode,gnum_sample_code as sampleNo,(select 'Patient\\#'||gstr_instruction_post from hivT_laboratory_test_mst where gnum_isvalid\\=1 and gnum_hospital_code\\=a.gnum_hospital_code and gnum_labcode\\=a.gnum_lab_code and gnum_test_code\\=a.gnum_test_code  ) as patInstruct, (select 'Sample Collection\\#'||gstr_instruction_coll from hivt_laboratory_test_mst where gnum_isvalid\\=1 and gnum_hospital_code\\=a.gnum_hospital_code and gnum_labcode\\=a.gnum_lab_code and gnum_test_code\\=a.gnum_test_code  ) as collInstruct,(select gnum_isrequisitionform_needed from hivT_laboratory_test_mst where gnum_isvalid\\=1 and gnum_hospital_code\\=a.gnum_hospital_code and gnum_labcode\\=a.gnum_lab_code and gnum_test_code\\=a.gnum_test_code  ) as isrequisitionformneeded from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS in (2,11) and hrgnum_puk_reqd \\= ? and gnum_hospital_code\\=? and exists ((select 1 from hivT_laboratory_test_mst e where e.gnum_isvalid\\=1 and e.gnum_hospital_code\\=a.gnum_hospital_code and e.gnum_labcode\\=a.gnum_lab_code and e.gnum_test_code\\=a.gnum_test_code  )) and exists ((select 1 from hivT_test_mst l where l.gnum_isvalid\\=1  and l.gnum_test_code\\=a.gnum_test_code  )) order by HIVTNUM_REQ_DNO 

SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh\:mi\:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )   and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample \= ?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc

#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_MACHINEALL_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) AND hivt_is_repeat_sample = ?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh:mi:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? And Rus.Hminum_Machine_Id=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? )  and hrgnum_patcr_no=? and hmistr_machine_sampleno=? AND hivt_is_repeat_sample = ?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code=rus.gnum_hospital_code and aa.gnum_test_code=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hminum_machine_id = rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code =tt.hminum_hmis_test_code AND gnum_hospital_code = rus.gnum_hospital_code AND gnum_is_valid = 1 AND hgnum_group_code = ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno = ( ss.hminum_inv_reqdno ) and gnum_hospital_code=rus.gnum_hospital_code ) )::NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid = 1 AND gnum_test_code = tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid = 1 AND hgnum_parameter_id = Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status = 1 and tt.gnum_hospital_code = rus.gnum_hospital_code and tt.hmistr_machine_test_code = rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code=ss.hminum_hmis_test_code and tt.hminum_machine_id = rus.hminum_machine_id and tt.gnum_isvalid=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) = TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid = 1 AND gnum_hospital_code = ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code = ? AND gnum_location_code = m.gnum_location_code AND gnum_hospital_code = m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code = ? And Rus.Hminum_Machine_Id=? and ss.hminum_test_status IN (1,2 )  and ss.hminum_machine_id=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code = rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) = UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id = rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid = 1 AND gnum_hospital_code = rus.gnum_hospital_code AND hmistr_machine_test_code = rus.hmistr_machine_test_code AND hminum_machine_id = rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) = TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? )  and hrgnum_patcr_no=? and hmistr_machine_sampleno=? AND hivt_is_repeat_sample = ?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_all_MACHINEALL_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode , rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 ) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?)and hminum_inv_reqdno=kk.hivtnum_req_dno  ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_patcrno1_MACHINEALL_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus, NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and hrgnum_patcr_no\=? and hivt_is_repeat_sample\=?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ?  And Rus.Hminum_Machine_Id\=? and ss.hminum_test_status IN (1,2 )   and ss.hminum_machine_id\=? AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) and hminum_inv_reqdno=kk.hivtnum_req_dno ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
#SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL=select (SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'mm/dd/yyyy hh\:mi\:ss am') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy')) AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) ORDER BY grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc
SELECT.MACHINE_RESULT_ENTRY.HMIT_RESULT_DTL_sampleno_MACHINEALL_NEWMACHINE=select pkg_inv_fun.fun_patient_status(kk.hivnum_req_no,kk.gnum_hospital_code) as patStatus,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,kk.gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(kk.GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as pattype,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,(SELECT gstr_user_group_code FROM hivt_test_group_info_mst aa WHERE gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and aa.gnum_hospital_code\=rus.gnum_hospital_code and aa.gnum_test_code\=ss.hminum_hmis_test_code)) AS shortgrpcode , ( SELECT hmistr_machine_name FROM hmit_machine_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hminum_machine_id \= rus.hminum_machine_id ) AS machinename , ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code) AS grpcode , ss.hminum_hmis_test_code as testCode, Rus.Hminum_Machine_Id machineCode, Hbnum_Para_Count as machineTestParameterParaCount, Rus.Hminum_Machine_Recordid AS machineRecordId, To_Char(Rus.Hmidt_Resultentry_Date, 'dd-Mon-yy hh:mi:ss') AS machineResultEntryDate, Rus.Hmistr_Result AS machineResult, nvl(Hmistr_Machine_Testpara_Name,'') as machineTestParameterName , Hmistr_Hmis_Testpara_Code AS parameterCode, Rus.Hmistr_Machine_Sampleno machineLabSampleNo, ( SELECT hgstr_group_name FROM hivt_test_group_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) ) AS grpname , ( SELECT (gnum_test_seq_no) FROM hivt_test_group_info_mst WHERE gnum_test_code \=tt.hminum_hmis_test_code AND gnum_hospital_code \= rus.gnum_hospital_code AND gnum_is_valid \= 1 AND hgnum_group_code \= ( SELECT hgnum_group_code FROM hivt_requisition_dtl WHERE hivtnum_req_dno \= ( ss.hminum_inv_reqdno ) and gnum_hospital_code\=rus.gnum_hospital_code ) )\:\:NUMERIC AS preference , (SELECT gstr_test_name FROM hivt_test_mst WHERE gnum_isvalid \= 1 AND gnum_test_code \= tt.hminum_hmis_test_code) AS testname , ( SELECT hgstr_parameter FROM hivt_parameter_mst WHERE gnum_isvalid \= 1 AND hgnum_parameter_id \= Hmistr_Hmis_Testpara_Code )AS paraname, substr(ss.hrgnum_patcr_no, 8, 8) as cr, ss.hrgnum_patcr_no AS patCrNo,hmistr_sex AS patGender,ss.hmistr_age as patAge,hminum_hmis_sampleno as sampleNo,ss.Hminum_Machine_Reqid AS machineReqId, ss.hminum_inv_reqdno as reqDNo, tt.hminum_hmis_test_code , rus.hmistr_machine_test_code as machineTestParameterCode, rus.hminum_machine_id , tt.hminum_hmis_test_code , Rus.Hmidt_Resultentry_Date, TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) FROM Hmit_Result_Dtl Rus, hmit_machine_testpara_mst tt,hmit_sample_dtl ss,hivt_requisition_dtl kk WHERE Rus.Hminum_Status \= 1 and tt.gnum_hospital_code \= rus.gnum_hospital_code and tt.hmistr_machine_test_code \= rus.hmistr_machine_test_code AND UPPER(ss.hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) and tt.hminum_hmis_test_code\=ss.hminum_hmis_test_code and tt.hminum_machine_id \= rus.hminum_machine_id and tt.gnum_isvalid\=1 AND TRUNC(To_Date(Rus.Hmidt_Resultentry_Date)) \= TRUNC(To_Date(?)) AND Rus.Hminum_Machine_Id IN ( ( SELECT HMINUM_MACHINE_ID FROM HMIT_MACHINE_MST m WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= ? AND EXISTS ( SELECT 1 FROM hivt_laboratory_mst WHERE gnum_lab_code \= ? AND gnum_location_code \= m.gnum_location_code AND gnum_hospital_code \= m.gnum_hospital_code ) ) ) AND Rus.gnum_hospital_code \= ? and ss.hminum_test_status IN (1,2 )  AND exists ( SELECT 1 FROM hmit_sample_dtl WHERE gnum_hospital_code \= rus.gnum_hospital_code AND UPPER(hmistr_machine_sampleno) \= UPPER(rus.hmistr_machine_sampleno) AND hminum_machine_id \= rus.hminum_machine_id AND hminum_hmis_test_code IN ( SELECT hminum_hmis_test_code FROM hmit_machine_testpara_mst WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= rus.gnum_hospital_code AND hmistr_machine_test_code \= rus.hmistr_machine_test_code AND hminum_machine_id \= rus.hminum_machine_id AND hminum_test_status IN (1,2 ) ) AND TRUNC(hmidt_collection_date) \= TRUNC(TO_DATE(?, 'dd-Mon-yyyy'))  and hminum_inv_reqdno in (select hivtnum_req_dno from hivt_requisition_dtl where gnum_lab_code=? ) and  hmistr_machine_sampleno\=? and hivt_is_repeat_sample\=?) and hminum_inv_reqdno=kk.hivtnum_req_dno  ORDER BY emer desc,priority desc,grpcode ,preference ,testcode ,Rus.Hmistr_Machine_Sampleno ,Hmidt_Resultentry_Date DESC ,cr desc

SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER_NEW=Select (select nvl(hmistr_machine_name,'Manual') from hmit_machine_mst ss where hminum_machine_id\=a.gnum_machine_code and ss.gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) as machinename,NVL(HIPSTR_BED_NAME_reqd, '-') AS bedName,nvl(hrgstr_mobile_no_reqd,'-') as mobileNo,pkg_inv_fun.fun_admissionNo_fromreqno(hivnum_req_no,gnum_hospital_code) as admissionno ,hipstr_ward_name_reqd as wardName,pkg_clinical_util_fun.get_pat_category_name(GNUM_HOSPITAL_CODE,hgnum_patient_cat_code_reqd) AS patCategory,nvl(hivt_ispat_unknown,'0') as is_unknown,nvl(hivtnum_priority_all,'0') as priority,nvl(hivt_is_pat_dead,'0')  as is_patdead,nvl(hivt_is_pat_mlc,'0') as  as_patmlc,nvl(hivt_is_pat_pregnant,'0')  as is_pregnant,nvl(hivt_is_pat_newborn,'0')   as is_newborn,nvl(hivt_is_pat_vip,'0')     as is_vip,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, 'Admitted',1,'',3,'Emergency',4,'') as patType,DECODE(HBNUM_REQUISITION_TYPE_reqd,2, '1',1,'1',3,'2',4,'1') as emer,hrgstr_mlc_no_reqd as mlcno,To_Char(hivt_entry_date, 'dd-Mon-yyyy') as reqDate,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,hivnum_reqdtl_status as reqDtlStatus,hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,hivstr_report_url as reportUrl,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,concat(concat(hivnum_temp_sample_no, '/'), hgstr_daily_labno) as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender, pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge,  pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code)||'-'||pkg_inv_fun.fun_unitname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE   a.gnum_hospital_code \=? AND    a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) and hivnum_reqdtl_status not in (16)       

UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_NEWPROCESS=update hivt_requisition_dtl set hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=?,hivnum_reqdtl_status=? 

UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS_NEWPROCESS_NEW=update hivt_requisition_dtl_new set hivtdt_res_print_date=SYSDATE, hivtnum_res_print_seatid=?,hivnum_reqdtl_status=? 


 