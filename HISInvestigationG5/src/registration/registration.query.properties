INSERT.HRGT_DAILY_PATIENT_DTL =     INSERT INTO HRGT_DAILY_PATIENT_DTL  \
									(HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_VISIT_NO, HRGNUM_PAT_PRI_CAT_CODE, \
									HRGNUM_PAT_SEC_CAT_CODE, HRGSTR_PREV_PUK, HRGNUM_ID_NO, HRGDT_DOB, \
									HRGNUM_IS_MLC, HRGNUM_IS_ACTUAL_DOB, HRGNUM_IS_OLD, HRGSTR_FNAME, HRGSTR_MNAME, \
									HRGSTR_LNAME, GNUM_GENDER_CODE, GNUM_MARITAL_STATUS_CODE, GNUM_RELIGION_CODE, \
									HGNUM_PAT_STATUS_CODE, HRGSTR_FHNAME, HRGSTR_MOMNAME, GNUM_REG_CAT_CODE, \
									HRGDT_REGISTER_DATE, HRGDT_EXP_DATE, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, \
									HRGNUM_ISUNKNOWN, HRGNUM_MONTH_INCOME, HRGNUM_AMT_COLLECTED, HRGNUM_IS_URBAN, \
									HRGNUM_IS_REF, HRGNUM_REF_HOSP_CODE, HRGSTR_REF_HOSP_DOCT_NAME, HRGNUM_EMERGENCY_TYPE, \
									HRGNUM_IS_DELHI, HRGSTR_HOUSE_NO, GNUM_CITY_LOC_CODE, HRGSTR_DISTRICT, HRGSTR_CITY, \
									GNUM_STATECODE, GNUM_COUNTRYCODE, HRGNUM_PIN, HRGNUM_EPISODE_NO, HRGSTR_EPISODE_TYPE, \
									HRGDT_EPISODE_DATE, GNUM_ISVALID, HRGNUM_PATIENT_ALLOWED, HGNUM_ROOM_CODE, \
									GDT_ENTRY_DATE, HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGSTR_REF_HOSPITAL_NAME, \
									HRGNUM_ADD_TYPE_CODE, HGNUM_PATIENT_CAT_CODE, HRGNUM_EPISODE_TYPE_CODE, HRGSTR_CITY_LOCATION) \
									VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_DAILY_PATIENT_DTL WHERE HRGNUM_PUK=?), \
									(SELECT NVL (MAX (HRGNUM_VISIT_NO),0)+1 FROM HRGT_DAILY_PATIENT_DTL WHERE HRGNUM_PUK=?), \
									?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,nvl(to_date(?,'dd-MON-YYYY'),sysdate),to_date(?,'dd-Mon-yyyy'), \
									?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,SYSDATE,?,?,?,?,?,?,?)				
				
INSERT.HRGT_PATIENT_DTL =          	INSERT INTO HRGT_PATIENT_DTL \
									(HRGNUM_PUK, HRGSTR_PREV_PUK, HRGDT_DOB, HRGBL_IS_ACTUAL_DOB, HRGSTR_FNAME, \
									GNUM_SALUTATION_CODE, HRGSTR_MNAME, HRGSTR_LNAME, GNUM_GENDER_CODE, \
									GNUM_MARITAL_STATUS_CODE, HGNUM_PAT_STATUS_CODE, HRGSTR_IDMARK, HRGSTR_FHNAME, \
									HRGSTR_MOMNAME, HRGNUM_REG_CAT_CODE, HGNUM_PATIENT_CAT_CODE, HRGDT_REGISTER_DATE, \
									HRGDT_EXP_DATE, GNUM_DEPT_CODE, HRGBL_ISLOCK, HRGSTR_LOCK_REASON, GDT_ENTRY_DATE, \
									GNUM_SEAT_ID, HRGNUM_IS_MLC, GNUM_ISVALID, HRGNUM_ISUNKNOWN, HRGNUM_MONTH_INCOME, \
									HRGNUM_IS_URBAN, HRGNUM_ISNPROGRAM, HRGNUM_ISCMO_FREE, GNUM_CURRENT_DEPT_CODE, \
									GNUM_DESIG_SEMESTER, HRGNUM_DEPT_STAFF_STUD, HRGNUM_PAT_PRI_CAT_CODE, \
									HRGNUM_PAT_SEC_CAT_CODE, HRGSTR_IP_ADD, HRGSTR_CONTACT_NO, HRGNUM_REF_HOSPITAL_CODE, \
									HRGSTR_REF_HOSPITAL_NAME, HRGNUM_ID_NO, HRGNUM_AMT_COLLECTED, HRGNUM_IS_REF, \
									HRGNUM_EMERGENCY_TYPE, HRGNUM_ADD_TYPE_CODE, GNUM_RELIGION_CODE, HRGSTR_REF_DOCTOR_NAME, HRGNUM_AGE) \
									VALUES(?,?,to_date(?,'dd-mon-yyyy'),?,?,?,?,?,?,?,?,?,?, \
									?,?,?,SYSDATE,to_date(?,'dd-Mon-yyyy'),?,?,?,SYSDATE,?,?,?,?,?, \
									?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
				
INSERT.HRGT_EPISODE_DTL=  	  	INSERT INTO HRGT_EPISODE_DTL \
								(HRGNUM_PUK, HRGSTR_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_VISIT_TYPE, \
								HRGNUM_EPISODE_TYPE_CODE, HRGSTR_EPISODE_ACTION_CODE, HRGNUM_ADMISSION_NO, \
								HRGSTR_MLC_NO, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, HRGNUM_QUE_NO, HRGNUM_IS_NEW, \
								HRGDT_EPISODE_DATE, HRGTM_EPISODE_TIME, HRGDT_NEXT_VISIT_DATE, \
								HRGSTR_NEXT_VISIT_DEPT_CODE, HRGNUM_IS_EPISODE_OPEN, HRGSTR_COMPLAINED_DTL, \
								PSRSTR_EMP_NO, PSRSTR_EMP_NAME, GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_IS_CONFIRMED, \
								GNUM_ISVALID, HGNUM_ROOM_CODE, HGNUM_WARD_CODE, HRGNUM_NEXT_VISIT_TYPE, HGNUM_NEXT_VISIT_DEPTUNITCODE) \
								VALUES (?,?,(select NVL(MAX(HRGNUM_VISIT_NO), 0)+1 from  HRGT_EPISODE_DTL where HRGSTR_EPISODE_CODE = ?), \
								?,?,?,?,?,?,?,?,?,sysdate,TO_CHAR(SYSDATE, 'hh24:mm'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,sysdate,?,?,?,?,?,?)
								
INSERT.HRGT_DATATYPE_TEST=      INSERT INTO HRGT_DATATYPE_TEST \
		                            (NUM,STR,FLG,DTE) \ VALUES\
		                            (?,?,?,nvl(to_date(?,'dd-MON-YYYY'),sysdate))
                           
                           
INSERT.HRGT_PATIENT_ADD_DTL=    INSERT INTO HRGT_PATIENT_ADD_DTL \
								(HRGNUM_PUK, HRGNUM_S_NO, GNUM_ADD_TYPE_CODE, HRGSTR_CITY, HRGSTR_DISTRICT, \
								GNUM_STATE_CODE, HRGNUM_PINCODE, GNUM_COUNTRY_CODE, GNUM_ISVALID, GNUM_SEAT_ID, \
								GDT_ENTRY_DATE, HRGNUM_IS_DELHI, HRGSTR_HOUSE_NO, HRGSTR_STREET_NO, \
								HRGSTR_CONTACT_NO, GNUM_CITY_LOC_CODE, IS_CURRENT_ADDRESSS) \
								VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_ADD_DTL WHERE HRGNUM_PUK=?), \
								?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?)				


		
INSERT.HRGT_PATIENT_MLC_DTL=	INSERT INTO HRGT_PATIENT_MLC_DTL (HRGNUM_PUK, HRGSTR_MLC_NO, HRGSTR_EPISODE_CODE, HRGSTR_CASE_NO, HRGSTR_POLICE_NAME, \
								HRGSTR_POLICE_DESIG, HRGSTR_POLICE_STATION, HRGSTR_OFFICER_INCHARGE, HRGDT_MLC_DATE, PSSTR_CMO_CODE, HRGNUM_ISTRANSFER, \
								GNUM_SEAT_ID, GDT_ENTRY_DATE, HRGNUM_ISBROUGHTDEAD, HRGSTR_PATIENT_CONDITION, PSRSTR_DOCTOR_NAME, HRGSTR_MLC_REMARKS, \
								GNUM_ISVALID, HRGNUM_S_NO, HRGSTR_FNAME, HRGSTR_MNAME, HRGSTR_LNAME, HRGDT_DOB, GNUM_GENDER_CODE, GNUM_MARITAL_STATUS_CODE, \
								GNUM_RELIGION_CODE, HRGSTR_FHNAME, HRGSTR_MOMNAME, HRGNUM_IS_REF, HRGNUM_REF_HOSP_CODE, HRGSTR_REF_HOSP_DOCT_NAME, HGNUM_ISUNKNOWN, \
								HRGNUM_IS_DELHI, HRGSTR_HOUSE_NO, GNUM_CITY_LOC_CODE, HRGSTR_DISTRICT, HRGSTR_CITY, GNUM_STATECODE, GNUM_COUNTRYCODE, HRGNUM_PIN, \
								HRGSTR_CONTACT_NO, HRGNUM_ADD_TYPE_CODE, HRGSTR_CITY_LOCATION, HRGSTR_IP_ADD) \
								VALUES (?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PATIENT_MLC_DTL WHERE HRGNUM_PUK=?), \
								?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ) 


INSERT.HRGT_DUP_RENEW_DTL=		INSERT INTO HRGT_DUP_RENEW_DTL (HRGNUM_PUK, HRGDT_DUP_RENEW_DATE, HRGNUM_COST, HRGSTR_REMARKS, HRGSTR_DUP_RENEW_FLAG, \
								GBL_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES (?,TO_DATE(?,'DD-MON-YYYY'),?,?,?,?,?,SYSDATE)


INSERT.HRGT_UNIT_CHANGE_DTL=	INSERT INTO HRGT_UNIT_CHANGE_DTL (HRGNUM_PUK, HRGSTR_EPISODE_CODE, GNUM_DEPT_CODE, HRGNUM_VISIT_NO, HGNUM_FROM_DEPTUNITCODE, HGNUM_TO_DEPTUNITCODE, \
								HRGSTR_CHANGE_REASON, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID) VALUES (?,?,?,?,?,?,?,?,SYSDATE,?)



SELECT.OPD_VISIT.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO=		SELECT A.HRGNUM_PUK AS patCrNo, \
														(SELECT INITCAP(B.GSTR_DEPT_NAME)  FROM GBLT_DEPARTMENT_MST B WHERE B.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) department, \
														(SELECT INITCAP(C.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST C WHERE C.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) room, \
														(SELECT INITCAP(D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE D.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) departmentUnit \
														FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?)
												
												
SELECT.OPD_VISIT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO=		SELECT INITCAP(A.HRGSTR_FNAME) AS patFirstName, INITCAP(A.HRGSTR_MNAME) AS patMiddleName, INITCAP(A.HRGSTR_LNAME) AS patLastName, \
														INITCAP(A.HRGSTR_FHNAME) AS patGuardianName, A.HRGNUM_AGE AS patAge, \
														(SELECT INITCAP(B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) patGender, \
														(SELECT INITCAP(C.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST C WHERE C.GNUM_PATIENT_CAT_CODE = A.HRGNUM_PAT_PRI_CAT_CODE) patCat \
														FROM HRGT_PATIENT_DTL A WHERE (A.HRGNUM_PUK = ?)
								
												
#Changed By Amit Garg as OPD G5 Changes
SELECT.HRGT_PATIENT_DTL.RETRIEVE_BY_CRNO=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_PREV_PUK AS PREVCRNO, TO_CHAR (A.HRGDT_DOB, 'dd-Mon-YYYY') AS PATDOB, A.HRGBL_IS_ACTUAL_DOB AS ISACTUALDOB, \
											INITCAP (A.HRGSTR_FNAME) AS PATFIRSTNAME, A.GNUM_SALUTATION_CODE AS PATSALUTATIONCODE, INITCAP (A.HRGSTR_MNAME) AS PATMIDDLENAME, \
											INITCAP (A.HRGSTR_LNAME) AS PATLASTNAME, A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, \
											A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, A.HRGSTR_IDMARK AS PATIDMARK, INITCAP (A.HRGSTR_FHNAME) AS PATGUARDIANNAME, \
											INITCAP (A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_REG_CAT_CODE AS PATREGCATCODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, \
											TO_CHAR (A.HRGDT_REGISTER_DATE, 'dd-Mon-YYYY') AS REGISTERDATE, TO_CHAR (A.HRGDT_EXP_DATE, 'dd-Mon-YYYY') AS EXPIRYDATE, \
											A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HRGBL_ISLOCK AS ISLOCK, INITCAP (A.HRGSTR_LOCK_REASON) AS ISLOCKREASON, A.GDT_ENTRY_DATE AS ENTRYDATE, \
											A.GNUM_SEAT_ID AS SEATID, A.HRGNUM_IS_MLC AS ISMLC, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, \
											A.HRGNUM_IS_URBAN AS PATISURBAN, A.HRGNUM_ISNPROGRAM AS ISNPROGRAM, A.HRGNUM_ISCMO_FREE AS ISCMOFREE, A.GNUM_CURRENT_DEPT_CODE AS CURRENTDEPARTMENTCODE, \
											A.GNUM_DESIG_SEMESTER AS DESIGSEMESTER, A.HRGNUM_DEPT_STAFF_STUD AS DEPTSTAFFSTUDENT, A.HRGNUM_PAT_PRI_CAT_CODE AS PATPRIMARYCATCODE, \
											A.HRGNUM_PAT_SEC_CAT_CODE AS PATSECONDARYCATCODE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
											A.HRGNUM_REF_HOSPITAL_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP (A.HRGSTR_REF_HOSPITAL_NAME) AS PATREFHOSPITALNAME, A.HRGNUM_ID_NO AS PATIDNO, \
											A.HRGNUM_AMT_COLLECTED AS PATAMOUNTCOLLECTED, A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_EMERGENCY_TYPE AS EMERGENCYTYPE, A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, \
											A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP (A.HRGSTR_REF_DOCTOR_NAME) AS PATREFDOCTOR, A.HRGNUM_AGE AS PATAGE, \
											(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
											(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
											(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
											(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
											(SELECT INITCAP (H.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST H WHERE H.GNUM_DEPT_CODE = A.GNUM_CURRENT_DEPT_CODE) CURRENTDEPARTMENT, \
											(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HRGNUM_PAT_PRI_CAT_CODE) PATPRIMARYCAT, \
											(SELECT INITCAP (J.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST J WHERE J.GNUM_PATIENT_CAT_CODE = A.HRGNUM_PAT_SEC_CAT_CODE) PATSECONDARYCAT, \
											(SELECT INITCAP (K.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST K WHERE K.GNUM_HOSPITAL_CODE = A.HRGNUM_REF_HOSPITAL_CODE) PATREFHOSPITALNAME, \
											(SELECT INITCAP (L.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST L WHERE L.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
											(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION \
											FROM HRGT_PATIENT_DTL A WHERE (A.HRGNUM_PUK =?) AND (A.GNUM_ISVALID = ?)
												

SELECT.HRGT_EPISODE_DTL.RETRIEVE_BY_CRNO=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, \
												A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, \
												A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_NEW AS EPISODEISNEW, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, \
												A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY') AS EPISODENEXTVISITDATE, A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, \
												A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, \
												A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, \
												A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, \
												(SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
												(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
												(SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
												(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, \
												(SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, \
												(SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT, \
												(DECODE ((SELECT HOPNUM_DEPTUNITCODE FROM HOPT_ROSTER_DTL WHERE HOPDT_START_DT < SYSDATE AND HOPDT_END_DT > SYSDATE AND (HOPNUM_DEPTUNITCODE = SUBSTR (A.HGNUM_NEXT_VISIT_DEPTUNITCODE, 3) or HOPNUM_DEPTUNITCODE = SUBSTR (A.HGNUM_DEPTUNITCODE, 3))), NULL, 0, 1 ) ) DEPTUNITISONDUTY \
												FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?) AND (A.GNUM_ISVALID = ?) \
												AND A.HRGSTR_EPISODE_CODE NOT IN (SELECT N.HRGSTR_EPISODE_CODE FROM HRGT_EPISODE_DTL N WHERE (N.HRGNUM_PUK = ?)AND (N.HRGNUM_IS_EPISODE_OPEN = ?) AND (N.GNUM_ISVALID = ?)) \
												AND A.HRGNUM_VISIT_NO >= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGSTR_EPISODE_CODE = A.HRGSTR_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))


SELECT.HRGT_EPISODE_DTL.EMG_EPISODE.RETRIEVE_BY_CRNO=	SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_VISIT_TYPE AS EPISODEVISITTYPE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, \
														A.HRGSTR_EPISODE_ACTION_CODE AS EPISODEACTIONCODE, A.HRGNUM_ADMISSION_NO AS ADMISSIONNO, A.HRGSTR_MLC_NO AS MLCNO, A.GNUM_DEPT_CODE AS DEPARTMENTCODE, \
														A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, A.HRGNUM_QUE_NO AS QUENO, A.HRGNUM_IS_NEW AS EPISODEISNEW, TO_CHAR (A.HRGDT_EPISODE_DATE, 'dd-Mon-YYYY') AS EPISODEDATE, \
														A.HRGTM_EPISODE_TIME AS EPISODETIME, TO_CHAR (A.HRGDT_NEXT_VISIT_DATE, 'dd-Mon-YYYY') AS EPISODENEXTVISITDATE, A.HRGSTR_NEXT_VISIT_DEPT_CODE AS EPISODENEXTVISITDEPTCODE, \
														A.HRGNUM_IS_EPISODE_OPEN AS EPISODEISOPEN, INITCAP (A.HRGSTR_COMPLAINED_DTL) AS COMPLAINDETAIL, A.PSRSTR_EMP_NO AS EMPNO, INITCAP (A.PSRSTR_EMP_NAME) AS EMPNAME, \
														A.GNUM_SEAT_ID AS SEATID, TO_CHAR (A.GDT_ENTRY_DATE, 'dd-Mon-YYYY') AS ENTRYDATE, A.HRGNUM_IS_CONFIRMED AS ISCONFIRMED, A.GNUM_ISVALID AS ISVALID, A.HGNUM_ROOM_CODE AS ROOMCODE, \
														A.HGNUM_WARD_CODE AS WARDCODE, A.HRGNUM_NEXT_VISIT_TYPE AS EPISODENEXTVISITTYPE, A.HGNUM_NEXT_VISIT_DEPTUNITCODE AS EPISODENEXTVISITDEPTUNITCODE, \
														(SELECT INITCAP (D.GSTR_EPISODE_ACTION_NAME) FROM GBLT_EPISODE_ACTION_MST D WHERE D.GNUM_EPISODE_ACTION_CODE = A.HRGSTR_EPISODE_ACTION_CODE) EPISODEACTION, \
														(SELECT INITCAP (E.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST E WHERE E.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
														(SELECT INITCAP (G.HGSTR_UNITNAME) FROM HGBT_UNIT_MST G WHERE G.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
														(SELECT INITCAP (F.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST F WHERE F.GNUM_DEPT_CODE = A.HRGSTR_NEXT_VISIT_DEPT_CODE) EPISODENEXTVISITDEPT, \
														(SELECT INITCAP (I.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST I WHERE I.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, \
														(SELECT INITCAP (J.HGSTR_UNITNAME) FROM HGBT_UNIT_MST J WHERE J.HGNUM_DEPTUNITCODE = A.HGNUM_NEXT_VISIT_DEPTUNITCODE) EPISODENEXTVISITDEPTUNIT, \
														(DECODE ((SELECT HOPNUM_DEPTUNITCODE FROM HOPT_ROSTER_DTL WHERE HOPDT_START_DT < SYSDATE AND HOPDT_END_DT > SYSDATE AND (HOPNUM_DEPTUNITCODE = SUBSTR (A.HGNUM_NEXT_VISIT_DEPTUNITCODE, 3) or HOPNUM_DEPTUNITCODE = SUBSTR (A.HGNUM_DEPTUNITCODE, 3))), NULL, 0, 1 ) ) DEPTUNITISONDUTY \
														FROM HRGT_EPISODE_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.HRGNUM_IS_EPISODE_OPEN = ?) AND (A.GNUM_ISVALID = ?) AND (A.HRGNUM_VISIT_TYPE=?) \
														AND A.HRGSTR_EPISODE_CODE NOT IN (SELECT N.HRGSTR_EPISODE_CODE FROM HRGT_EPISODE_DTL N WHERE (N.HRGNUM_PUK = ?)AND (N.HRGNUM_IS_EPISODE_OPEN = ?) AND (N.GNUM_ISVALID = ?)) \
														AND A.HRGNUM_VISIT_NO >= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK = ?) AND (Z.HRGSTR_EPISODE_CODE = A.HRGSTR_EPISODE_CODE) AND (Z.GNUM_ISVALID = ?))

																	 
SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CRNO.ADD_TYPE=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
														INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
														A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_DELHI AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
														(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
														FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?)  AND (A.GNUM_ADD_TYPE_CODE=?) AND (A.GNUM_ISVALID = ?)											 


SELECT.HRGT_PATIENT_ADD_DTL.RETRIEVE_BY_CRNO.ALL=		SELECT A.HRGNUM_PUK AS patCrNo, A.HRGNUM_S_NO AS serialNo, A.GNUM_ADD_TYPE_CODE AS patAddTypeCode, A.HRGSTR_CITY AS patAddCity, \
														INITCAP(A.HRGSTR_DISTRICT) AS patAddDistrict, A.GNUM_STATE_CODE AS patAddStateCode, A.HRGNUM_PINCODE AS patAddPIN, A.GNUM_COUNTRY_CODE AS patAddCountryCode, \
														A.GNUM_ISVALID AS isValid, A.GNUM_SEAT_ID AS seatId, A.GDT_ENTRY_DATE AS entryDate, A.HRGNUM_IS_DELHI AS isAddressDelhi, A.HRGSTR_HOUSE_NO AS patAddHNo, \
														A.HRGSTR_STREET_NO AS patAddStreet, A.HRGSTR_CONTACT_NO AS patAddContactNo, A.GNUM_CITY_LOC_CODE AS patAddCityLocCode, A.IS_CURRENT_ADDRESSS AS isCurrentAddress, \
														(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE = A.GNUM_ADD_TYPE_CODE) patAddType, \
														(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE = A.GNUM_STATE_CODE) patAddState, \
														(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRY_CODE) patAddCountry, \
														(SELECT INITCAP(E.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST E WHERE E.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) patAddCityLoc \
														FROM HRGT_PATIENT_ADD_DTL A WHERE (A.HRGNUM_PUK = ?) AND (A.GNUM_ISVALID = ?)											 

	
											 
SELECT.PREVIOUS_SYSTEM.HRGT_PATIENT_DTL=	SELECT A.HRGNUM_PUK AS patCrNo, A.HRGSTR_PREV_PUK AS prevCrNo, A.HRGDT_DOB AS patDOB, A.HRGBL_IS_ACTUAL_DOB AS isActualDob, INITCAP(A.HRGSTR_FNAME) AS patFirstName, \
											A.GNUM_SALUTATION_CODE AS patSalutationCode, INITCAP(A.HRGSTR_MNAME) AS patMiddleName, INITCAP(A.HRGSTR_LNAME) AS patLastName, A.GNUM_GENDER_CODE AS patGenderCode, \
											A.GNUM_MARITAL_STATUS_CODE AS patMaritalStatusCode, A.HGNUM_PAT_STATUS_CODE AS patStatusCode, INITCAP(A.HRGSTR_IDMARK) AS patIdMark, INITCAP(A.HRGSTR_FHNAME) AS patGuardianName, \
											INITCAP(A.HRGSTR_MOMNAME) AS patMomName, A.HRGNUM_REG_CAT_CODE AS patRegCatCode, A.HGNUM_PATIENT_CAT_CODE AS patCatcode, A.HRGDT_REGISTER_DATE AS registerDate, A.HRGDT_EXP_DATE AS expiryDate, \
											A.GNUM_DEPT_CODE AS departmentCode, A.HRGBL_ISLOCK AS isLock, INITCAP(A.HRGSTR_LOCK_REASON) AS isLockReason, A.GDT_ENTRY_DATE AS entryDate, A.GNUM_SEAT_ID AS seatId, A.HRGNUM_ISMLC AS isMLC, \
											A.GBL_ISVALID AS isValid, A.HRGNUM_ISUNKNOWN AS isUnknown, A.HRGNUM_MONTH_INCOME AS patMonthlyIncome, A.HRGNUM_ISRURAL AS patIsUrban, A.HRGNUM_ISNPROGRAM AS isNProgram, \
											A.HRGNUM_ISCMO_FREE AS isCMOFree, A.GNUM_CURRENT_DEPT_CODE AS currentDepartmentCode, A.PNUM_RELIGION_CODE AS patReligionCode, A.GNUM_DESIG_SEMESTER AS desigSemester, \
											A.HRGNUM_DEPT_STAFF_STUD AS deptStaffStudent, \
											(SELECT INITCAP(B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE=A.GNUM_GENDER_CODE) patGender, \
											(SELECT INITCAP(C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE=A.GNUM_MARITAL_STATUS_CODE) patMaritalStatus, \
											(SELECT INITCAP(E.HRGSTR_REG_CAT_NAME) FROM HRGT_REG_CAT_MST E WHERE E.HRGNUM_REG_CAT_CODE=A.HRGNUM_REG_CAT_CODE) patRegCat, \
											(SELECT INITCAP(G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE=A.GNUM_DEPT_CODE ) department, \
											(SELECT INITCAP(H.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST H WHERE H.GNUM_DEPT_CODE=A.GNUM_CURRENT_DEPT_CODE) currentDepartment, \
											(SELECT INITCAP(J.PSTR_RELIGION_NAME) FROM PIST_RELIGION_MST J WHERE J.PNUM_RELIGION_CODE=A.PNUM_RELIGION_CODE) patReligion \
											FROM HRGT_PATIENT_DTL A WHERE HRGNUM_PUK=? AND GBL_ISVALID=?									 
											 
											 
SELECT.PREVIOUS_SYSTEM.HRGT_PATIENT_ADD_DTL=	SELECT A.HRGNUM_PUK as patCrNo, A.HRGNUM_SNO as serialNo, INITCAP(A.HRGSTR_ADD1), A.GNUM_ADDRESS_TYPE_CODE as patAddTypeCode, INITCAP(A.HRGSTR_LOCATION_PO), INITCAP(A.HRGSTR_CITY) as patAddCity, \
												INITCAP(A.HRGSTR_DISTRICT) as patAddDistrict, A.GNUM_STATE_CODE as patAddStateCode, A.HRGNUM_PINCODE as patAddPIN, A.GNUM_COUNTRY_CODE as patAddCountryCode, \
												A.HRGBL_ISCURRENT_ADDRESS as isCurrentAddress, A.GBL_ISVALID as isValid, A.GNUM_SEAT_ID as seatId, A.GDT_ENTRY_DATE as entryDate, A.HRGSTR_CONTACT_NUM as patAddContactNo, \
												(SELECT INITCAP(B.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST B WHERE B.GNUM_ADDRESS_TYPE_CODE=A.GNUM_ADDRESS_TYPE_CODE) patAddType, \
												(SELECT INITCAP(C.GSTR_STATENAME) FROM GBLT_STATE_MST C WHERE C.GNUM_STATECODE=A.GNUM_STATE_CODE) patAddState, \
												(SELECT INITCAP(D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE=A.GNUM_COUNTRY_CODE) patAddCountry \
												FROM HRGT_PATIENT_ADD_DTL A WHERE A.HRGNUM_PUK=? AND A.GBL_ISVALID=?



SELECT.HRGT_DAILY_PATIENT_DTL.OPD_UNITS=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_S_NO AS SERIALNO, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_PAT_PRI_CAT_CODE AS PATPRIMARYCATCODE, \
												A.HRGNUM_PAT_SEC_CAT_CODE AS PATSECONDARYCATCODE, A.HRGSTR_PREV_PUK AS PREVCRNO, A.HRGNUM_ID_NO AS PATIDNO, A.HRGDT_DOB AS PATDOB, A.HRGNUM_IS_MLC AS ISMLC, \
												A.HRGNUM_IS_ACTUAL_DOB AS ISACTUALDOB, A.HRGNUM_IS_OLD AS PATISOLD, A.HRGSTR_FNAME AS PATFIRSTNAME, A.HRGSTR_MNAME AS PATMIDDLENAME, A.HRGSTR_LNAME AS PATLASTNAME, \
												A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, A.HGNUM_PAT_STATUS_CODE AS PATSTATUSCODE, \
												A.HRGSTR_FHNAME AS PATGUARDIANNAME, A.HRGSTR_MOMNAME AS PATMOMNAME, A.GNUM_REG_CAT_CODE AS PATREGCATCODE, A.HRGDT_REGISTER_DATE AS REGISTERDATE, A.HRGDT_EXP_DATE AS EXPIRYDATE, \
												A.GNUM_DEPT_CODE AS DEPARTMENTCODE, A.HGNUM_DEPTUNITCODE AS DEPARTMENTUNITCODE, DECODE (A.HRGNUM_QUE_NO, A.HRGNUM_QUE_NO, A.HRGNUM_QUE_NO + 1, A.HRGNUM_QUE_NO) AS QUENO, \
												A.HRGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_MONTH_INCOME AS PATMONTHLYINCOME, A.HRGNUM_AMT_COLLECTED AS PATAMOUNTCOLLECTED, A.HRGNUM_IS_URBAN AS PATISURBAN, \
												A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_REF_HOSP_CODE AS PATREFGNCTDHOSPITALCODE, A.HRGSTR_REF_HOSP_DOCT_NAME AS PATREFDOCTOR, A.HRGNUM_EMERGENCY_TYPE AS EMERGENCYTYPE, \
												A.HRGNUM_IS_DELHI AS ISADDRESSDELHI, A.HRGSTR_HOUSE_NO AS PATADDHNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, A.HRGSTR_DISTRICT AS PATADDDISTRICT, A.HRGSTR_CITY AS PATADDCITY, \
												A.GNUM_STATECODE AS PATADDSTATECODE, A.GNUM_COUNTRYCODE AS PATADDCOUNTRYCODE, A.HRGNUM_PIN AS PATADDPIN, A.HRGNUM_EPISODE_NO AS EPISODECODE, A.HRGSTR_EPISODE_TYPE AS EPISODETYPE, \
												A.HRGDT_EPISODE_DATE AS EPISODEDATE, A.GNUM_ISVALID AS ISVALID, DECODE (A.HRGNUM_PATIENT_ALLOWED, '0', '0', A.HRGNUM_PATIENT_ALLOWED - 1)  AS PATIENTALLOWED, A.HGNUM_ROOM_CODE AS ROOMCODE, \
												A.GDT_ENTRY_DATE AS ENTRYDATE, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, A.HRGSTR_REF_HOSPITAL_NAME AS PATREFHOSPITALNAME, \
												A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, A.HGNUM_PATIENT_CAT_CODE AS PATCATCODE, A.HRGNUM_EPISODE_TYPE_CODE AS EPISODETYPECODE, A.HRGSTR_CITY_LOCATION AS PATADDCITYLOC, \
												(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
												(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
												(SELECT INITCAP (E.GSTR_REG_CAT_NAME) FROM GBLT_REG_CAT_MST E WHERE E.GNUM_REG_CAT_CODE = A.GNUM_REG_CAT_CODE) PATREGCAT, \
												(SELECT INITCAP (F.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST F WHERE F.GNUM_PATIENT_CAT_CODE = A.HGNUM_PATIENT_CAT_CODE) PATCAT, \
												(SELECT INITCAP (G.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST G WHERE G.GNUM_DEPT_CODE = A.GNUM_DEPT_CODE) DEPARTMENT, \
												(SELECT INITCAP (I.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST I WHERE I.GNUM_PATIENT_CAT_CODE = A.HRGNUM_PAT_PRI_CAT_CODE) PATPRIMARYCAT, \
												(SELECT INITCAP (J.GSTR_PATIENT_CAT_NAME) FROM GBLT_PATIENT_CAT_MST J WHERE J.GNUM_PATIENT_CAT_CODE = A.HRGNUM_PAT_SEC_CAT_CODE) PATSECONDARYCAT, \
												(SELECT INITCAP (K.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST K WHERE K.GNUM_HOSPITAL_CODE = A.HRGNUM_REF_HOSP_CODE) PATREFHOSPITALNAME, \
												(SELECT INITCAP (L.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST L WHERE L.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
												(SELECT INITCAP (M.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST M WHERE M.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
												(SELECT INITCAP (N.HGSTR_ROOM_NAME) FROM HGBT_ROOM_MST N WHERE N.HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE) ROOM, \
												(SELECT INITCAP (O.HGSTR_UNITNAME) FROM HGBT_UNIT_MST O WHERE O.HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE) DEPARTMENTUNIT, \
												(SELECT INITCAP (R.GSTR_STATENAME) FROM GBLT_STATE_MST R WHERE R.GNUM_STATECODE = A.GNUM_STATECODE) PATADDSTATE, \
												(SELECT INITCAP (D.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST D WHERE D.GNUM_COUNTRYCODE = A.GNUM_COUNTRYCODE) PATADDCOUNTRY, \
												(SELECT INITCAP (S.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST S WHERE S.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) PATADDCITYLOC \
												FROM HRGT_DAILY_PATIENT_DTL A WHERE (GNUM_DEPT_CODE = ? AND HGNUM_DEPTUNITCODE = ?) \
												AND GDT_ENTRY_DATE >= ALL (SELECT GDT_ENTRY_DATE FROM HRGT_DAILY_PATIENT_DTL A WHERE GNUM_DEPT_CODE = ? AND HGNUM_DEPTUNITCODE = ?)
												
												

SELECT.HRGT_PATIENT_MLC_DTL.RETRIEVE_BY_CRNO=		SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGSTR_MLC_NO AS MLCNO, A.HRGSTR_EPISODE_CODE AS EPISODECODE, A.HRGSTR_CASE_NO AS CASENO, INITCAP(A.HRGSTR_POLICE_NAME) AS POLICENAME, \
													INITCAP(A.HRGSTR_POLICE_DESIG) AS POLICEDESIGNATION, INITCAP(A.HRGSTR_POLICE_STATION) AS POLICESTATION, INITCAP(A.HRGSTR_OFFICER_INCHARGE) AS OFFICERINCHARGE, \
													TO_CHAR(A.HRGDT_MLC_DATE , 'dd-mon-yyyy') AS MLCDATE, A.PSSTR_CMO_CODE AS CMOCODE, A.HRGNUM_ISTRANSFER AS ISTRANSFER, A.GNUM_SEAT_ID AS SEATID, \
													TO_CHAR(A.GDT_ENTRY_DATE, 'dd-mon-yyyy') AS ENTRYDATE, A.HRGNUM_ISBROUGHTDEAD AS ISBROUGHTDEAD, INITCAP(A.HRGSTR_PATIENT_CONDITION) AS PATCONDITION, \
													INITCAP(A.PSRSTR_DOCTOR_NAME) AS DOCTORNAME, INITCAP(A.HRGSTR_MLC_REMARKS) AS MLCREMARK, A.GNUM_ISVALID AS ISVALID, A.HRGNUM_S_NO AS SERIALNO, \
													INITCAP(A.HRGSTR_FNAME) AS PATFIRSTNAME, INITCAP(A.HRGSTR_MNAME) AS PATMIDDLENAME, INITCAP(A.HRGSTR_LNAME) AS PATLASTNAME, TO_CHAR(A.HRGDT_DOB, 'dd-mon-yyyy') AS PATDOB, \
													A.GNUM_GENDER_CODE AS PATGENDERCODE, A.GNUM_MARITAL_STATUS_CODE AS PATMARITALSTATUSCODE, A.GNUM_RELIGION_CODE AS PATRELIGIONCODE, INITCAP(A.HRGSTR_FHNAME) AS PATGUARDIANNAME, \
													INITCAP(A.HRGSTR_MOMNAME) AS PATMOMNAME, A.HRGNUM_IS_REF AS ISREFERRED, A.HRGNUM_REF_HOSP_CODE AS PATREFGNCTDHOSPITALCODE, INITCAP(A.HRGSTR_REF_HOSP_DOCT_NAME) AS PATREFDOCTOR, \
													A.HGNUM_ISUNKNOWN AS ISUNKNOWN, A.HRGNUM_IS_DELHI AS ISADDRESSDELHI, A.HRGSTR_HOUSE_NO AS PATADDHNO, A.GNUM_CITY_LOC_CODE AS PATADDCITYLOCCODE, INITCAP(A.HRGSTR_DISTRICT) AS PATADDDISTRICT, \
													INITCAP(A.HRGSTR_CITY) AS PATADDCITY, A.GNUM_STATECODE AS PATADDSTATECODE, A.GNUM_COUNTRYCODE AS PATADDCOUNTRYCODE, A.HRGNUM_PIN AS PATADDPIN, A.HRGSTR_CONTACT_NO AS PATADDCONTACTNO, \
													A.HRGNUM_ADD_TYPE_CODE AS PATADDTYPECODE, INITCAP(A.HRGSTR_CITY_LOCATION) AS PATADDCITYLOC, A.HRGSTR_IP_ADD AS SYSTEMIPADDRESS, \
													(SELECT INITCAP (B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE = A.GNUM_GENDER_CODE) PATGENDER, \
													(SELECT INITCAP (C.GSTR_MARITAL_STATUS) FROM GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE = A.GNUM_MARITAL_STATUS_CODE) PATMARITALSTATUS, \
													(SELECT INITCAP (D.GSTR_RELIGION_NAME) FROM GBLT_RELIGION_MST D WHERE D.GNUM_RELIGION_CODE = A.GNUM_RELIGION_CODE) PATRELIGION, \
													(SELECT INITCAP (E.GSTR_HOSPITAL_NAME) FROM GBLT_HOSPITAL_MST E WHERE E.GNUM_HOSPITAL_CODE = A.HRGNUM_REF_HOSP_CODE) PATREFHOSPITALNAME, \
													(SELECT INITCAP (F.GSTR_ADDRESS_TYPE) FROM GBLT_ADDRESS_TYPE_MST F WHERE F.GNUM_ADDRESS_TYPE_CODE = A.HRGNUM_ADD_TYPE_CODE) PATADDTYPE, \
													(SELECT INITCAP (G.GSTR_STATENAME) FROM GBLT_STATE_MST G WHERE G.GNUM_STATECODE = A.GNUM_STATECODE) PATADDSTATE, \
													(SELECT INITCAP (H.GSTR_COUNTRYNAME) FROM GBLT_COUNTRY_MST H WHERE H.GNUM_COUNTRYCODE = A.GNUM_COUNTRYCODE) PATADDCOUNTRY, \
													(SELECT INITCAP (I.GSTR_CITY_LOC_NAME) FROM GBLT_CITY_LOCATION_MST I WHERE I.GNUM_CITY_LOC_CODE = A.GNUM_CITY_LOC_CODE) PATADDCITYLOC \
													FROM HRGT_PATIENT_MLC_DTL A WHERE A.HRGNUM_PUK = ? AND A.GNUM_ISVALID = ? AND \
													((SYSDATE - A.HRGDT_MLC_DATE) <= ALL (SELECT SYSDATE - J.HRGDT_MLC_DATE FROM HRGT_PATIENT_MLC_DTL J WHERE J.HRGNUM_PUK = ? AND J.GNUM_ISVALID = ?))
													

													
UPDATE.CHANGE_CATEGORY.HRGT_PATIENT_DTL=	UPDATE HRGT_PATIENT_DTL A SET A.HRGNUM_PAT_PRI_CAT_CODE = ?, A.HRGNUM_PAT_SEC_CAT_CODE = ? \
												WHERE A.HRGNUM_PUK = ? AND A.GNUM_ISVALID = ?
												
												
UPDATE.HRGT_PATIENT_DTL=			UPDATE HRGT_PATIENT_DTL SET HRGSTR_PREV_PUK = ?, HRGDT_DOB = ?, HRGBL_IS_ACTUAL_DOB = ?, \
									HRGSTR_FNAME = ?, GNUM_SALUTATION_CODE = ?, HRGSTR_MNAME = ?, HRGSTR_LNAME = ?, GNUM_GENDER_CODE = ?, \
									GNUM_MARITAL_STATUS_CODE =?, HGNUM_PAT_STATUS_CODE = ?, HRGSTR_IDMARK = ?, HRGSTR_FHNAME = ?, \
									HRGSTR_MOMNAME = ?, HRGNUM_REG_CAT_CODE = ?, HGNUM_PATIENT_CAT_CODE = ?, HRGDT_REGISTER_DATE = ?, \
									HRGDT_EXP_DATE = ?, GNUM_DEPT_CODE = ?, HRGBL_ISLOCK = ?, HRGSTR_LOCK_REASON = ?, HRGNUM_IS_MLC = ?, \
									GNUM_ISVALID = ?, HRGNUM_ISUNKNOWN = ?, HRGNUM_MONTH_INCOME = ?, HRGNUM_IS_URBAN = ?, \
									HRGNUM_ISNPROGRAM = ?,HRGNUM_ISCMO_FREE = ?, GNUM_CURRENT_DEPT_CODE = ?, GNUM_DESIG_SEMESTER = ?, \
									HRGNUM_DEPT_STAFF_STUD = ?, HRGNUM_PAT_PRI_CAT_CODE = ?, HRGNUM_PAT_SEC_CAT_CODE = ?, HRGSTR_IP_ADD = ?, \
									HRGSTR_CONTACT_NO = ?, HRGNUM_REF_HOSPITAL_CODE =?, HRGSTR_REF_HOSPITAL_NAME = ?, HRGNUM_ID_NO = ?, \
									HRGNUM_AMT_COLLECTED = ?, HRGNUM_IS_REF = ?, HRGNUM_EMERGENCY_TYPE = ?, HRGNUM_ADD_TYPE_CODE = ?, \
									GNUM_RELIGION_CODE = ?, HRGSTR_REF_DOCTOR_NAME = ?, HRGNUM_AGE = ? WHERE HRGNUM_PUK = ?
									
													

UPDATE.HRGT_PATIENT_ADD_DTL=		UPDATE HRGT_PATIENT_ADD_DTL SET HRGSTR_CITY = ?, HRGSTR_DISTRICT = ?, \
									GNUM_STATE_CODE = ?, HRGNUM_PINCODE = ?, GNUM_COUNTRY_CODE = ?, GNUM_ISVALID = ?, \
									HRGNUM_IS_DELHI = ?, HRGSTR_HOUSE_NO = ?, HRGSTR_STREET_NO = ?, HRGSTR_CONTACT_NO = ?, \
									GNUM_CITY_LOC_CODE = ?, IS_CURRENT_ADDRESSS = ? WHERE (HRGNUM_PUK = ?) AND (GNUM_ADD_TYPE_CODE = ?)
 												
												
UPDATE.HRGT_PATIENT_MLC_DTL=		UPDATE HRGT_PATIENT_MLC_DTL SET HRGSTR_CASE_NO = ?, HRGSTR_POLICE_NAME = ?, HRGSTR_POLICE_DESIG = ?, HRGSTR_POLICE_STATION = ?, HRGSTR_OFFICER_INCHARGE = ?, \
									HRGDT_MLC_DATE = ?, PSSTR_CMO_CODE = ?, HRGNUM_ISTRANSFER = ?, GNUM_SEAT_ID = ?, HRGNUM_ISBROUGHTDEAD = ?, HRGSTR_PATIENT_CONDITION = ?, \
									PSRSTR_DOCTOR_NAME = ?, HRGSTR_MLC_REMARKS = ? WHERE HRGNUM_PUK = ? AND HRGSTR_MLC_NO = ? AND HRGSTR_EPISODE_CODE = ? AND GNUM_ISVALID = ?


UPDATE.MLC_N0.HRGT_EPISODE_DTL=		UPDATE HRGT_EPISODE_DTL SET HRGSTR_MLC_NO = ?  WHERE HRGNUM_PUK = ? AND HRGSTR_EPISODE_CODE = ?


UPDATE.HRGT_PATIENT_ADD_DTL1=		UPDATE HRGT_PATIENT_ADD_DTL SET GNUM_ADD_TYPE_CODE = (SELECT GNUM_ADDRESS_TYPE_CODE FROM GBLT_ADDRESS_TYPE_MST WHERE UPPER(GSTR_ADDRESS_TYPE) LIKE UPPER(?)), \
									HRGSTR_CITY = ?, HRGSTR_DISTRICT = ?, GNUM_STATE_CODE = (SELECT GNUM_STATECODE FROM GBLT_STATE_MST WHERE UPPER(GSTR_STATENAME) LIKE UPPER(?)), \
									HRGNUM_PINCODE = ?, GNUM_COUNTRY_CODE = (SELECT GNUM_COUNTRYCODE FROM GBLT_COUNTRY_MST WHERE UPPER(GSTR_COUNTRYNAME) LIKE UPPER(?)), \
									GNUM_ISVALID = ?, HRGNUM_IS_DELHI = ?, HRGSTR_HOUSE_NO = ?, HRGSTR_STREET_NO = ?, HRGSTR_CONTACT_NO = ?, \
									GNUM_CITY_LOC_CODE = (SELECT GNUM_CITY_LOC_CODE FROM GBLT_CITY_LOCATION_MST WHERE UPPER(GSTR_CITY_LOC_NAME) LIKE UPPER(?)), IS_CURRENT_ADDRESSS = ? \
									WHERE HRGNUM_PUK = ?
 
UPDATE.HRGT_EPISODE_DTL=		    UPDATE HRGT_EPISODE_DTL \
									SET HRGNUM_VISIT_TYPE=?, HRGNUM_EPISODE_TYPE_CODE=?,\
									HRGSTR_EPISODE_ACTION_CODE=?, HRGNUM_ADMISSION_NO=?,\
									HRGSTR_MLC_NO=?, GNUM_DEPT_CODE=?, HGNUM_DEPTUNITCODE=?,\
									HRGNUM_QUE_NO=?, HRGNUM_IS_NEW=?, HRGDT_EPISODE_DATE=?, \
									HRGTM_EPISODE_TIME=?, HRGDT_NEXT_VISIT_DATE=?, \
									HRGSTR_NEXT_VISIT_DEPT_CODE=?, HRGNUM_IS_EPISODE_OPEN=?,\
									HRGSTR_COMPLAINED_DTL=?, PSRSTR_EMP_NO=?, PSRSTR_EMP_NAME=?,\
									GNUM_SEAT_ID=?, GDT_ENTRY_DATE=?, HRGNUM_IS_CONFIRMED=?,\
									GNUM_ISVALID=?, HGNUM_ROOM_CODE=?, HGNUM_WARD_CODE=?, \
									HRGNUM_NEXT_VISIT_TYPE=?, HGNUM_NEXT_VISIT_DEPTUNITCODE=? \
									WHERE HRGNUM_PUK=? AND HRGSTR_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? 								   
 

TIMESTAMP.HRGT_PATIENT_DTL=		SELECT (SYSDATE - GDT_ENTRY_DATE)*24*60 FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK = ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=?


SELECT.HRGT_PATIENT_DTL.CR_NO=	SELECT HRGNUM_PUK AS PATCRNO FROM HRGT_PATIENT_DTL WHERE ((SYSDATE - GDT_ENTRY_DATE) * 24 * 60) < ? AND GNUM_SEAT_ID=? AND GNUM_ISVALID=?


SELECT.GET_AGE_ON=		SELECT TO_CHAR (HRGNUM_PUK), ahis_util.PUK_AGE_ON (HRGNUM_PUK, SYSDATE) AGE FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK=?

 	
SELECT.PREVIOUS_SYSTEM.GET_AGE_ON=		SELECT TO_CHAR (HRGNUM_PUK), ahis_util.PUK_AGE_ON (HRGNUM_PUK, SYSDATE) AGE FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK=?


INSERT.HRGT_EPISODE_CLOSE_DTL=		INSERT INTO HRGT_EPISODE_CLOSE_DTL \
									(HRGNUM_PUK, HRGSTR_EPISODE_CODE, HRGNUM_EPISODE_TYPE_CODE, HRGNUM_ADMISSION_NO, HRGDT_EPISODE_OPEN_DATE, HRGDT_EPISODE_CLOSE_DATE, HRGNUM_EPISODE_CLOSE_TYPE, GNUM_ISVALID) VALUES \
									(?,?,?,?,to_date(?,'dd-Mon-yyyy'),sysdate,?,?)


INSERT.HRGT_EPISODE_DEATH_DTL=		INSERT INTO HRGT_EPISODE_DEATH_DTL \
									(HRGNUM_PUK, HRGSTR_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HRGNUM_CURRENT_DEPT_CODE, \
									HRGNUM_CURRENT_UNIT_CODE, HRGNUM_CURRENT_WARD_CODE, HRGNUM_CURRENT_BED_CODE, HRGDT_DEATH_DATE, HRGDT_DEATH_TIME,\
									HRGSTR_DEATH_CAUSE, HRGSTR_ATTEND_CONSULTANT_ID, HRGSTR_CONSULTANT_REMARK, HRGSTR_BODY_HANDOVER_TO, HRGDT_BODY_HANDOVER_DATE, \
									HRGSTR_BODY_HANDOVER_TIME, HRGSTR_RELATIVE_NAME, HRGSTR_RELATIVE_ADDRESS, GNUM_RELATIVECODE, GNUM_ISVALID) \
									VALUES(?,?,?,?,?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,?,?)
                                 

INSERT.HRGT_EPISODE_ACTION_DTL=		INSERT INTO HRGT_EPISODE_ACTION_DTL \
									(HRGSTR_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_PUK, HRGSTR_EPISODE_ACTION_CODE, GNUM_DIAGNOSTIC_TYPE_CODE, \
									HRGSTR_DIAGNOSTIC_DESC, HRGSTR_COMPLAINED_DTL, HRGSTR_REMARKS, HRGDT_EPISODE_DATE, HRGTM_EPISODE_TIME, GNUM_DEPT_CODE, HGNUM_WARD_CODE, \
									HRGNUM_REF_HOSPITAL_CODE, HRGSTR_REF_HOSPITAL_NAME, GDT_ENTRY_DATE,GNUM_ISVALID, GNUM_SEAT_ID) \
									VALUES(?,?,?,?,?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,sysdate,?,?)
									
																	    
INSERT.HRGT_EPISODE_DIAGNOSIS_DTL=	INSERT INTO HRGT_EPISODE_DIAGNOSIS_DTL \
									(HRGNUM_PUK, HRGSTR_EPISODE_CODE, HRGNUM_S_NO,\
									HRGNUM_ADMISSION_NO, HRGNUM_VISIT_NO, GNUM_DIAGNOSTIC_TYPE_CODE, \
									HRGNUM_DIAGNOSTIC_CODE, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID) \
									VALUES(?,?,(select NVL (MAX (HRGNUM_S_NO),0)+1 from HRGT_EPISODE_DIAGNOSIS_DTL where HRGSTR_EPISODE_CODE=? and HRGNUM_VISIT_NO=?),?,?,?,?,?,sysdate,?)

                 		                                												
ESSENTIAL.DIAGNOSIS_TREE=			 SELECT a.hgbstr_icd_group_code || ' '|| INITCAP (a.hgbstr_icd_group) icdgroup,\
				                     b.hgbstr_icd_subgrp_code ||' '||INITCAP (b.hgbstr_icd_subgroup) icdsubgroup,\
				                     Trim(c.hgbstr_disease_code)|| '|'|| Trim(INITCAP(c.hgbstr_disease)) icddisease \
				                     FROM hgbt_icd_disease_mst c, hgbt_icd_group_mst a,hgbt_icd_subgroup_mst b \
				  	                 WHERE a.hgbstr_icd_group_code = b.hgbstr_icd_group_code \
				                     AND b.hgbstr_icd_subgrp_code = c.hgbstr_icd_subgrp_code \
					                 ORDER BY icdgroup, icdsubgroup, icddisease											