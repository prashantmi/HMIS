SELECT.HIPT_PATADMDISC_DTL.RETRIEVE_BY_CRNO = select A.HIPNUM_ADMNO as patAdmNo, A.HRGNUM_PUK as patCrNo, A.HIPNUM_SLNO as patSlNo, A.HRGNUM_NAME as patName, A.HRGSTR_SEX as patGenderCode, (select GSTR_GENDER_NAME from GBLT_GENDER_MST where GSTR_GENDER_CODE\=A.HRGSTR_SEX and GNUM_HOSPITAL_CODE\=100 And GNUM_ISVALID\=1) as patGender, A.HRGNUM_AGE as patAge,A.HRGSTR_AGEUNIT as patAgeUnit, A.HRGSTR_FATHUSBNAME as patFatHusbandName, A.HRGSTR_ADDRESS as patAddress, A.HRGNUM_EPISODE_CODE as episodeCode, A.HRGNUM_VISIT_NO as episodeVisitNo, to_char(A.HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mi') as admDateTime, A.HIPDT_BEDALLOC_DATETIME as bedAllocDateTime, A.GNUM_DEPT_CODE as departmentCode, A.GNUM_DEPTUNIT_CODE as departmentUnitCode, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=A.GNUM_DEPT_CODE and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=1 ) as departmentName, (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=A.GNUM_DEPTUNIT_CODE and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=1 ) as departmentUnitName, A.HIPNUM_WARD_CODE as wardCode, (select HIPSTR_WARD_NAME from HIPT_WARD_MST where HIPNUM_WARD_CODE\=A.HIPNUM_WARD_CODE and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=1 AND GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))as wardName, A.HIPNUM_ROOM_CODE as roomCode,A.HIPNUM_BED_CODE as bedCode, A.HRGNUM_MLC_NO as mlcNo, (select HGNUM_BED_NAME from HIPT_WARD_ROOM_BED_MST where HGNUM_BED_CODE\=A.HIPNUM_BED_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=1) as bedName, A.HIPNUM_CONSULTANT_ID as consultantID, A.HRGSTR_SPOUSENAME as patSpouceName,A.HIPNUM_IS_DEAD as isDead, A.HRGNUM_REG_CAT_CODE as patRegCatCode, A.HRGNUM_CITY_LOC_CODE as locationCode, A.HRGSTR_CITY as cityName, A.GNUM_STATE_CODE as stateCode, A.GNUM_COUNTRY_CODE as countryCode, A.HRGSTR_NATIONALITY as patNationality, A.HRGSTR_MOTH_NATIONALITY as patMotherNationality, A.HRGSTR_FATH_NATIONALITY as patFatherNationality, A.HRGNUM_RELGN_CODE as patReligionCode, A.HRGNUM_MOTH_RELGN_CODE as patMotherReligionCode, A.HRGNUM_FATH_RELGN_CODE as patFatherReligionCode, A.HIPNUM_ADM_ADVNO as admAdvNo, A.HIPDT_DISDATETIME as disDateTime, A.HIPDT_DISSTATUS_CODE as disStatusCode, A.HIPSTR_ADMISSION_COMPALINT as admComplain, A.HIPSTR_DISCHARGE_ADVISE as dischargeAdvice, A.GNUM_OWNDEPT_CODE as ownDepartmentCode, A.GNUM_OWNDEPTUNIT_CODE as ownDepartmentUnitCode, A.HIPNUM_OWNWARD_CODE as ownWardCode, A.HIPNUM_TREAT_CATEG as treatmentCatCode, A.HIPNUM_ISNEWBORN as isNewBorn, A.HIPNUM_MOTHADMNO as motherAdmNo, A.HIPNUM_ISRURAL as isRural, A.HIPSTR_REMARKS as remarks, A.HIPNUM_OCCUP_ID as patOccupationId, A.GNUM_RELATION_CODE as relationCode, A.HISTR_DISCHCARD_LOCATION as dischCardLocation, A.HIPNUM_PATSTAY_DAYS as patStayDays, A.HISTR_GENCASE_LOCATION as genCaseLocation, A.HISTR_INTAKEOUT_LOCATION as intakeOutTakeLocation, A.HIPNUM_PAT_FROM as patFrom, A.HIPNUM_REF_ADM_NO as refAdmNo, A.HIPNUM_CHARGE as charge, A.HIPDT_ADMSTATUS_CODE as admStatusCode, A.HIPDT_POLICE_INFORMED_DATE as policeInformedDate, A.HIPDT_MLC_APPROVED_DATE as mlcApprovedDate, A.HIPSTR_MLC_APPROVED_BY as mlcApprovedBy, A.HIPNUM_ROOMNO as roomNo from HIPT_PATADMDISC_DTL A where HRGNUM_PUK \= ? AND HIPNUM_ADMNO \= ? AND GNUM_ISVALID \= ?
												
SELECT.IPD.RETRIEVE_BY_CRNO.HIPT_PATADMISSION_DTL.HRGT_PATIENT_DTL = SELECT A.HRGNUM_PUK as patCrNo, A.HRGSTR_PREV_PUK as prevCrNo, to_char(A.HRGDT_DOB,'dd-Mon-yyyy') as patDOB, A.HRGBL_IS_ACTUAL_DOB as isActualDob, A.HRGSTR_FNAME as patFirstName, A.HRGSTR_MNAME as patMiddleName, A.HRGSTR_LNAME as patLastName, A.gstr_gender_code as patGenderCode, A.GNUM_MARITAL_STATUS_CODE as patMaritalStatusCode, A.HRGNUM_IS_DEAD as patStatusCode, A.HRGSTR_FATHER_NAME as patGuardianName, A.HRGSTR_MOMNAME as patMotherName, A.HRGNUM_REG_CAT_CODE as patRegCatCode, A.HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, A.gdt_entry_date as registerDate, NVL(A.HRGNUM_IS_MLC,0) as isMLC, A.HRGNUM_ISUNKNOWN as isUnknown, A.HRGNUM_MONTH_INCOME as patMonthlyIncome, A.HRGNUM_IS_URBAN as patIsUrban, A.HRGNUM_ID_NO as patIdNo, A.HRGNUM_IS_REF as isReferred, A.GNUM_RELIGION_CODE as patReligionCode, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, A.HRGSTR_SPOUSENAME as patSpouceName, A.HRGSTR_NATIONAL_ID as patNationalId, A.HBNUM_BLDGRP_CODE as patBloodGroup,A.HBNUM_BLDGRP_CODE as patBloodGroupCode, A.HRGNUM_ISNEWBORN as isNewBorn, A.HRGNUM_MOTHER_PUK as patMotherCrNo, A.HRGSTR_NICKNAME as patNickName, A.HRGSTR_CARD_NO as patCardNo, A.HRGNUM_IS_BROUGHTDEAD as isBroughtDead, (SELECT B.GSTR_GENDER_NAME from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code  AND B.GNUM_ISVALID \= 1) as patGender, (SELECT decode(b.gstr_gender_code,'M',1,'F',2,3) from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code  AND B.GNUM_ISVALID \= 1) as patGenderType, (SELECT C.GSTR_MARITAL_STATUS from GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE\=A.GNUM_MARITAL_STATUS_CODE  AND C.GNUM_ISVALID \= 1) as patMaritalStatus, ('') as patRegCat, (SELECT E.GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST E where E.GNUM_PATIENT_CAT_CODE\=A.HGNUM_PATIENT_CAT_CODE AND E.GNUM_ISVALID \= 1 AND E.GNUM_HOSPITAL_CODE\=? ) as patPrimaryCat, (SELECT F.gstr_country_name FROM GBLT_COUNTRY_MST F WHERE F.gstr_country_code\=A.gstr_country_code  AND F.GNUM_ISVALID \= 1) as patNationality, (SELECT G.GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST G WHERE G.GNUM_RELIGION_CODE\=A.GNUM_RELIGION_CODE  AND G.GNUM_ISVALID \= 1) as patReligion, P.HIPNUM_ADMNO as patAdmNo, P.HIPNUM_ADM_ADVNO as admAdvNo, to_char(P.HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mi') as admDateTime, date_part('day',(trunc(SYSDATE)-trunc(P.HIPDT_ADMDATETIME)))||' Days' AS patAdmittedDays, P.HIPDT_BEDALLOC_DATETIME as bedAllocDateTime, P.HIPNUM_WARD_CODE as wardCode, P.HIPNUM_ROOM_CODE as ipdRoomCode, (SELECT HIPSTR_ROOM_DESC FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=P.HIPNUM_ROOM_CODE AND GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE) AS ipdRoomName, (SELECT HIPNUM_ROOM_TYPE_CODE FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=P.HIPNUM_ROOM_CODE AND GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE) AS ipdRoomTypeCode, P.HIPNUM_BED_CODE as bedCode, P.HIPNUM_CONSULTANT_ID as consultantID, decode(P.HIPNUM_CONSULTANT_ID,null,'',ahis_gbl_util.emp_name(P.HIPNUM_CONSULTANT_ID,P.GNUM_HOSPITAL_CODE)) AS consultantName, P.HIPDT_DISDATETIME as disDateTime, P.HIPDT_ADMSTATUS_CODE as admStatusCode, P.HIPNUM_CHARGE as charge, P.GNUM_DEPT_CODE as departmentCode, P.GNUM_DEPTUNIT_CODE as departmentUnitCode, (SELECT K.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST K WHERE K.GNUM_DEPT_CODE\=P.GNUM_DEPT_CODE AND K.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND K.GNUM_ISVALID\=1 ) as departmentName, (SELECT L.HGSTR_UNITNAME FROM HGBT_UNIT_MST L WHERE L.HGNUM_DEPTUNITCODE\=P.GNUM_DEPTUNIT_CODE and L.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND L.GNUM_ISVALID\=1 ) as departmentUnitName, (SELECT H.HIPSTR_WARD_NAME FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=P.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=1 )as wardName, (SELECT H.HIPNUM_WARDTYPE_CODE FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=P.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=1 )as wardTypeCode, (SELECT J.HGNUM_BED_NAME FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as bedName, (SELECT J.HGNUM_BED_TYPE_CODE FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as bedTypeCode, (SELECT COUNT(*) FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patIsPregnant, (SELECT (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7)+1 FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patGestationWeek, P.HRGNUM_MLC_NO as mlcNo,P.HRGNUM_EPISODE_CODE as episodeCode, P.HRGNUM_VISIT_NO as episodeVisitNo, (SELECT J.HIPNUM_SHARABLE_FLG FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as isBedSharable, (0.0-to_number(bill_mst.getaccountbalance( bill_mst.get_pat_accountno(a.GNUM_HOSPITAL_CODE,'2',a.HRGNUM_PUK), a.GNUM_HOSPITAL_CODE, '1'))) AS patBalance FROM HRGT_PATIENT_DTL A,HIPT_PATADMISSION_DTL P WHERE A.HRGNUM_PUK\=P.HRGNUM_PUK AND P.HIPDT_ADMSTATUS_CODE NOT IN (?,?,?) AND P.GNUM_ISVALID\= ? AND A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND P.GNUM_HOSPITAL_CODE \= ?

SELECT.MRD.RETRIEVE_BY_CRNO.HIPT_PATADMISSION_DTL.HRGT_PATIENT_DTL = SELECT A.HRGNUM_PUK as patCrNo, A.HRGSTR_PREV_PUK as prevCrNo, to_char(A.HRGDT_DOB,'dd-Mon-yyyy') as patDOB, A.HRGBL_IS_ACTUAL_DOB as isActualDob, A.HRGSTR_FNAME as patFirstName, A.HRGSTR_MNAME as patMiddleName, A.HRGSTR_LNAME as patLastName, A.gstr_gender_code as patGenderCode, A.GNUM_MARITAL_STATUS_CODE as patMaritalStatusCode, A.HRGNUM_IS_DEAD as patStatusCode, A.HRGSTR_FATHER_NAME as patGuardianName, A.HRGSTR_MOMNAME as patMotherName, A.HRGNUM_REG_CAT_CODE as patRegCatCode, A.HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, A.gdt_entry_date as registerDate, NVL(A.HRGNUM_IS_MLC,0) as isMLC, A.HRGNUM_ISUNKNOWN as isUnknown, A.HRGNUM_MONTH_INCOME as patMonthlyIncome, A.HRGNUM_IS_URBAN as patIsUrban, A.HRGNUM_ID_NO as patIdNo, A.HRGNUM_IS_REF as isReferred, A.GNUM_RELIGION_CODE as patReligionCode, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, A.HRGSTR_SPOUSENAME as patSpouceName, A.HRGSTR_NATIONAL_ID as patNationalId, A.HBNUM_BLDGRP_CODE as patBloodGroup,A.HBNUM_BLDGRP_CODE as patBloodGroupCode, A.HRGNUM_ISNEWBORN as isNewBorn, A.HRGNUM_MOTHER_PUK as patMotherCrNo, A.HRGSTR_NICKNAME as patNickName, A.HRGSTR_CARD_NO as patCardNo, A.HRGNUM_IS_BROUGHTDEAD as isBroughtDead, (SELECT B.GSTR_GENDER_NAME from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code  AND B.GNUM_ISVALID \= 1) as patGender, (SELECT decode(b.gstr_gender_code,'M',1,'F',2,3) from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code  AND B.GNUM_ISVALID \= 1) as patGenderType, (SELECT C.GSTR_MARITAL_STATUS from GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE\=A.GNUM_MARITAL_STATUS_CODE  AND C.GNUM_ISVALID \= 1) as patMaritalStatus, ('') as patRegCat, (SELECT E.GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST E where E.GNUM_PATIENT_CAT_CODE\=A.HGNUM_PATIENT_CAT_CODE AND E.GNUM_ISVALID \= 1 AND E.GNUM_HOSPITAL_CODE\=? ) as patPrimaryCat, (SELECT F.gstr_country_name FROM GBLT_COUNTRY_MST F WHERE F.gstr_country_code\=A.gstr_country_code  AND F.GNUM_ISVALID \= 1) as patNationality, (SELECT G.GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST G WHERE G.GNUM_RELIGION_CODE\=A.GNUM_RELIGION_CODE  AND G.GNUM_ISVALID \= 1) as patReligion, P.HIPNUM_ADMNO as patAdmNo, P.HIPNUM_ADM_ADVNO as admAdvNo, to_char(P.HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mi') as admDateTime, date_part('day',(trunc(SYSDATE)-trunc(P.HIPDT_ADMDATETIME)))||' Days' AS patAdmittedDays, P.HIPDT_BEDALLOC_DATETIME as bedAllocDateTime, P.HIPNUM_WARD_CODE as wardCode, P.HIPNUM_ROOM_CODE as ipdRoomCode, (SELECT HIPSTR_ROOM_DESC FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=P.HIPNUM_ROOM_CODE AND GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE) AS ipdRoomName, (SELECT HIPNUM_ROOM_TYPE_CODE FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=P.HIPNUM_ROOM_CODE AND GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE) AS ipdRoomTypeCode, P.HIPNUM_BED_CODE as bedCode, P.HIPNUM_CONSULTANT_ID as consultantID, decode(P.HIPNUM_CONSULTANT_ID,null,'',ahis_gbl_util.emp_name(P.HIPNUM_CONSULTANT_ID,P.GNUM_HOSPITAL_CODE)) AS consultantName, P.HIPDT_DISDATETIME as disDateTime, P.HIPDT_ADMSTATUS_CODE as admStatusCode, P.HIPNUM_CHARGE as charge, P.GNUM_DEPT_CODE as departmentCode, P.GNUM_DEPTUNIT_CODE as departmentUnitCode, (SELECT K.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST K WHERE K.GNUM_DEPT_CODE\=P.GNUM_DEPT_CODE AND K.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND K.GNUM_ISVALID\=1 ) as departmentName, (SELECT L.HGSTR_UNITNAME FROM HGBT_UNIT_MST L WHERE L.HGNUM_DEPTUNITCODE\=P.GNUM_DEPTUNIT_CODE and L.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND L.GNUM_ISVALID\=1 ) as departmentUnitName, (SELECT H.HIPSTR_WARD_NAME FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=P.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=1 )as wardName, (SELECT H.HIPNUM_WARDTYPE_CODE FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=P.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=1 )as wardTypeCode, (SELECT J.HGNUM_BED_NAME FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as bedName, (SELECT J.HGNUM_BED_TYPE_CODE FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as bedTypeCode, (SELECT COUNT(*) FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patIsPregnant, (SELECT (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7)+1 FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patGestationWeek, P.HRGNUM_MLC_NO as mlcNo,P.HRGNUM_EPISODE_CODE as episodeCode, P.HRGNUM_VISIT_NO as episodeVisitNo, (SELECT J.HIPNUM_SHARABLE_FLG FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as isBedSharable, (0.0-to_number(bill_mst.getaccountbalance( bill_mst.get_pat_accountno(a.GNUM_HOSPITAL_CODE,'2',a.HRGNUM_PUK), a.GNUM_HOSPITAL_CODE, '1'))) AS patBalance FROM HRGT_PATIENT_DTL A,HIPT_PATADMISSION_DTL P WHERE A.HRGNUM_PUK\=P.HRGNUM_PUK AND P.GNUM_ISVALID\= ? AND A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND P.GNUM_HOSPITAL_CODE \= ?






SELECT.PAT_STATUS.HRGT_PATIENT_DTL = SELECT HGNUM_PAT_STATUS_CODE FROM HRGT_PATIENT_DTL WHERE HRGNUM_PUK = ? AND GNUM_ISVALID = ?


SELECT.OPD.RETRIEVE_BY_CRNO.HRGT_DAILY_PATIENT_DTL = SELECT A.HRGNUM_PUK as patCrNo, A.HRGSTR_PREV_PUK as prevCrNo, to_char(A.HRGDT_DOB,'dd-Mon-yyyy') as patDOB, A.HRGNUM_VISIT_NO as episodeVisitNo, HRGNUM_IS_ACTUAL_DOB as isActualDob, A.HRGNUM_EPISODE_CODE as episodeCode, A.HRGSTR_FNAME as patFirstName, A.HRGSTR_MNAME as patMiddleName, A.HRGSTR_LNAME as patLastName, A.GNUM_GENDER_CODE as patGenderCode, A.GNUM_MARITAL_STATUS_CODE as patMaritalStatusCode, A.HGNUM_PAT_STATUS_CODE as patStatusCode, A.HRGSTR_FATHER_NAME as patGuardianName, A.HRGSTR_MOMNAME as patMotherName, A.HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, to_char(A.HRGDT_REGISTER_DATE,'dd-Mon-yyyy') as registerDate, A.HRGNUM_IS_MLC as isMLC, A.HRGNUM_ISUNKNOWN as isUnknown, A.HRGNUM_MONTH_INCOME as patMonthlyIncome, A.HRGNUM_IS_URBAN as patIsUrban, A.HRGNUM_ISREG_FREE as isFree, A.HRGNUM_ID_NO as patIdNo, A.HRGNUM_IS_REF as isReferred, A.GNUM_RELIGION_CODE as patReligionCode, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, A.GNUM_NATIONALITY_CODE as patNationalityCode, A.HRGSTR_SPOUSENAME as patSpouceName, A.HRGSTR_NATIONAL_ID as patNationalId, A.HBNUM_BLDGRP_CODE as patBloodGroup, A.HRGNUM_ISNEWBORN as isNewBorn, A.HRGNUM_MOTHER_PUK as patMotherCrNo, A.HRGSTR_PAT_OCCUPATION as patOccupation, A.HRGSTR_FAT_OCCUPATION as patFatherOccupation, A.HRGSTR_HUS_OCCUPATION as patHusbandOccupation, A.HRGSTR_NICKNAME as patNickName, A.HRGSTR_CARD_NO as patCardNo, A.HRGNUM_IS_BROUGHTDEAD as isBroughtDead,A.GNUM_DEPT_CODE as departmentCode, A.HGNUM_DEPTUNITCODE as departmentUnitCode, (SELECT K.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST K WHERE K.GNUM_DEPT_CODE\=A.GNUM_DEPT_CODE AND K.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND K.GNUM_ISVALID\=1 AND K.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(K.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as departmentName, (SELECT L.HGSTR_UNITNAME FROM HGBT_UNIT_MST L WHERE L.HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE and L.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND L.GNUM_ISVALID\=1 AND L.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(L.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as departmentUnitName, (SELECT B.GSTR_GENDER_NAME from GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE\=A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE\=100 AND B.GNUM_ISVALID \= 1) as patGender, (SELECT B.GNUM_GENDER_TYPE from GBLT_GENDER_MST B WHERE B.GNUM_GENDER_CODE\=A.GNUM_GENDER_CODE AND B.GNUM_HOSPITAL_CODE\=100 AND B.GNUM_ISVALID \= 1) as patGenderType, (SELECT C.GSTR_MARITAL_STATUS from GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE\=A.GNUM_MARITAL_STATUS_CODE AND C.GNUM_HOSPITAL_CODE\=100 AND C.GNUM_ISVALID \= 1) as patMaritalStatus, (SELECT E.GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST E where E.GNUM_PATIENT_CAT_CODE\=A.HGNUM_PATIENT_CAT_CODE AND E.GNUM_HOSPITAL_CODE\=100 AND E.GNUM_ISVALID \= 1 AND E.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(E.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as patPrimaryCat, (SELECT F.GSTR_NATIONALITY FROM GBLT_COUNTRY_MST F WHERE F.GNUM_COUNTRYCODE\=A.GNUM_NATIONALITY_CODE AND F.GNUM_HOSPITAL_CODE\=100 AND F.GNUM_ISVALID \= 1) as patNationality, (SELECT G.GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST G WHERE G.GNUM_RELIGION_CODE\=A.GNUM_RELIGION_CODE AND G.GNUM_HOSPITAL_CODE\=100 AND G.GNUM_ISVALID \= 1) as patReligion, (SELECT COUNT(*) FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND ((SYSDATE-H.HANCDT_GESTATION_START_DATE)/7+1)<\=? ) AS patIsPregnant, (SELECT (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7)+1 FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND ((SYSDATE-H.HANCDT_GESTATION_START_DATE)/7+1)<\=? ) AS patGestationWeek, (select x.HBNUM_BLDGRP_CODE from HRGT_PATIENT_DTL x where x.HRGNUM_PUK\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as patBloodGroupCode FROM HRGT_DAILY_PATIENT_DTL A WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND GDT_ENTRY_DATE\=(SELECT MAX(GDT_ENTRY_DATE) FROM HRGT_DAILY_PATIENT_DTL WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?)

SELECT.OPD.RETRIEVE_BY_CRNO.HRGT_DAILY_PATIENT_DTL.FROM.PAT_DTL = SELECT A.HRGNUM_PUK as patCrNo, A.HRGSTR_PREV_PUK as prevCrNo, to_char(A.HRGDT_DOB,'dd-Mon-yyyy') as patDOB, A.HRGBL_IS_ACTUAL_DOB as isActualDob, A.HRGSTR_FNAME as patFirstName, A.HRGSTR_MNAME as patMiddleName, A.HRGSTR_LNAME as patLastName, a.gstr_gender_code as patGenderCode, A.GNUM_MARITAL_STATUS_CODE as patMaritalStatusCode, A.HRGNUM_IS_DEAD as patStatusCode, A.HRGSTR_FATHER_NAME as patGuardianName, A.HRGSTR_MOMNAME as patMotherName, A.HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, to_char(A.gdt_entry_date,'dd-Mon-yyyy') as registerDate, A.HRGNUM_IS_MLC as isMLC, A.HRGNUM_ISUNKNOWN as isUnknown, A.HRGNUM_MONTH_INCOME as patMonthlyIncome, A.HRGNUM_IS_URBAN as patIsUrban, A.HRGNUM_ID_NO as patIdNo, A.HRGNUM_IS_REF as isReferred, A.GNUM_RELIGION_CODE as patReligionCode, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, A.GNUM_NATIONALITY as patNationalityCode, A.HRGSTR_SPOUSENAME as patSpouceName, A.HRGSTR_NATIONAL_ID as patNationalId, A.HBNUM_BLDGRP_CODE as patBloodGroupCode, A.HRGNUM_ISNEWBORN as isNewBorn, A.HRGNUM_MOTHER_PUK as patMotherCrNo,  A.HRGSTR_NICKNAME as patNickName, A.HRGSTR_CARD_NO as patCardNo, A.HRGNUM_IS_BROUGHTDEAD as isBroughtDead, (SELECT B.GSTR_GENDER_NAME from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code AND  B.GNUM_ISVALID \= 1) as patGender, (SELECT decode(B.gstr_gender_code,'M',1,'F',2,3) from GBLT_GENDER_MST B WHERE B.gstr_gender_code\=A.gstr_gender_code AND B.GNUM_ISVALID \= 1) as patGenderType, (SELECT C.GSTR_MARITAL_STATUS from GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE\=A.GNUM_MARITAL_STATUS_CODE  AND C.GNUM_ISVALID \= 1) as patMaritalStatus, (SELECT E.GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST E where E.GNUM_PATIENT_CAT_CODE\=A.HGNUM_PATIENT_CAT_CODE AND E.GNUM_HOSPITAL_CODE\=? AND E.GNUM_ISVALID \= 1) as patPrimaryCat, (SELECT F.gstr_country_name FROM GBLT_COUNTRY_MST F WHERE F.gstr_country_code\=A.gstr_country_code  AND F.GNUM_ISVALID \= 1) as patNationality, (SELECT G.GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST G WHERE G.GNUM_RELIGION_CODE\=A.GNUM_RELIGION_CODE  AND G.GNUM_ISVALID \= 1) as patReligion, (SELECT COUNT(*) FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patIsPregnant, (SELECT (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7)+1 FROM HANCT_ANC_DTL H WHERE H.HRGNUM_PUK\=A.HRGNUM_PUK AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.HANCNUM_DELIVERY_STATUS IS NULL AND (DATE_PART('day',(SYSDATE-H.HANCDT_GESTATION_START_DATE))/7+1)<\=? ) AS patGestationWeek FROM HRGT_PATIENT_DTL A WHERE A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? 

												/*A.HRGNUM_VISIT_NO as episodeVisitNo, A.HRGNUM_EPISODE_CODE as episodeCode,A.GNUM_DEPT_CODE as departmentCode, A.HGNUM_DEPTUNITCODE as departmentUnitCode,
                                                 HRGSTR_IDMARK1,HRGNUM_REG_CAT_CODE,GDT_ENTRY_DATE,HRGNUM_DEPT_STAFF_STUD,HRGSTR_IP_ADD,HRGSTR_CONTACT_NO,HRGNUM_IS_IMAGEUPLOADED
                                                --HRGDT_EXP_DATE,HRGSTR_IDMARK2,HRGNUM_VERIFICATION_SLNO,NUM_CASTE_ID,GNUM_FAMILY_TYPE
                                                --(SELECT L.HGSTR_UNITNAME FROM HGBT_UNIT_MST L WHERE L.HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE and L.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE 
                                                --AND L.GNUM_ISVALID\=1 AND L.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(L.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as departmentUnitName,*/


INSERT.HGBT_DEPTUNITWISE_INV_MST.UNIT_WISE = INSERT INTO HGBT_DEPTUNITWISE_INV_MST (HGNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_HOSPITAL_CODE,HGNUM_PARAMETER_ID,HGSTR_DISPLAY_VALUE,HIPNUM_WARD_CODE, GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HGNUM_SLNO),10)+1 FROM HGBT_DEPTUNITWISE_INV_MST WHERE GNUM_HOSPITAL_CODE \= ? AND HGNUM_DEPTUNITCODE \= ?),?,?,?,(SELECT A.HGSTR_PARAMETER FROM HIVT_PARAMETER_MST A WHERE A.HGNUM_PARAMETER_ID \= ? AND A.GNUM_ISVALID \= ?),?,?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy'))

INSERT.HGBT_DEPTUNITWISE_INV_MST.UNITWARD_WISE = INSERT INTO HGBT_DEPTUNITWISE_INV_MST (HGNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_HOSPITAL_CODE,HGNUM_PARAMETER_ID,HGSTR_DISPLAY_VALUE,HIPNUM_WARD_CODE, GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HGNUM_SLNO),10)+1 FROM HGBT_DEPTUNITWISE_INV_MST WHERE GNUM_HOSPITAL_CODE \= ? AND HGNUM_DEPTUNITCODE \= ?),?,?,?,(SELECT A.HGSTR_PARAMETER FROM HIVT_PARAMETER_MST A WHERE A.HGNUM_PARAMETER_ID \= ? AND A.GNUM_ISVALID \= ?),?,?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy'))


SELECT.FORMODIFY.HGBT_DEPTUNITWISE_INV_MST = SELECT A.HGNUM_SLNO,A.HGNUM_DEPTUNITCODE,A.HGSTR_DISPLAY_VALUE,A.HGNUM_PARAMETER_ID,A.HIPNUM_WARD_CODE FROM HGBT_DEPTUNITWISE_INV_MST A WHERE a.GNUM_HOSPITAL_CODE = ? AND a.HGNUM_DEPTUNITCODE = ? AND A.HGNUM_SLNO = ?

SELECT.PARAMETER.MODIFY =  SELECT A.HGNUM_PARAMETER_ID, B.HGSTR_PARAMETER FROM HIVT_PARAMETER_MST B, HGBT_DEPTUNITWISE_INV_MST A WHERE A.GNUM_ISVALID = ? AND A.HGNUM_PARAMETER_ID = ? AND A.GNUM_HOSPITAL_CODE = ?  AND a.HGNUM_PARAMETER_ID= b.HGNUM_PARAMETER_ID

SELECT.PARAMETERLISTFORMODIFY =  SELECT A.HGNUM_PARAMETER_ID, B.HGSTR_PARAMETER FROM HIVT_PARAMETER_MST B, HGBT_DEPTUNITWISE_INV_MST A WHERE A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? AND A.HGNUM_DEPTUNITCODE = ? AND a.HGNUM_PARAMETER_ID= b.HGNUM_PARAMETER_ID AND a.HIPNUM_WARD_CODE is null

SELECT.PARAMETERLISTFORWARDWISE =  SELECT A.HGNUM_PARAMETER_ID, B.HGSTR_PARAMETER FROM HIVT_PARAMETER_MST B, HGBT_DEPTUNITWISE_INV_MST A WHERE A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? AND A.HGNUM_DEPTUNITCODE = ? AND a.HGNUM_PARAMETER_ID= b.HGNUM_PARAMETER_ID AND a.HIPNUM_WARD_CODE = ?
 											
UDPATE.HGBT_DEPTUNITWISE_INV_MST.UNIT_WISE = UPDATE HGBT_DEPTUNITWISE_INV_MST SET GNUM_ISVALID \= ?, GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=TO_DATE(SYSDATE,'dd-Mon-yyyy') WHERE HGNUM_DEPTUNITCODE \= ? AND HIPNUM_WARD_CODE is NULL
											
UDPATE.HGBT_DEPTUNITWISE_INV_MST.WARD_WISE = UPDATE HGBT_DEPTUNITWISE_INV_MST SET GNUM_ISVALID \= ?, GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=TO_DATE(SYSDATE,'dd-Mon-yyyy') WHERE HGNUM_DEPTUNITCODE \= ? AND HIPNUM_WARD_CODE \= ?
											
	

INSERT.HIPD_NURSE_ROUND_DTL = INSERT INTO HIPD_NURSE_ROUND_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HIPDT_ROUND_DATE, HRGNUM_VISIT_NO, HRGNUM_ROUND_NO, HRGNUM_ADMISSION_NO, HIPDT_ROUND_TIME, HIPSTR_PROGRESS_NOTES, HRGNUM_STATUS_CODE, PSRSTR_EMP_NO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_LSTMOD_SEATID, GSTR_IP_ADD, GDT_LSTMOD_DATE,sctstr_pterms_progress_notes,sctstr_ids_progress_notes) VALUES(?,?,TRUNC(SYSDATE),?,(SELECT NVL(MAX(HRGNUM_ROUND_NO),0)+1 FROM HIPD_NURSE_ROUND_DTL WHERE HRGNUM_PUK\= ? AND TRUNC(HIPDT_ROUND_DATE)\=TRUNC(SYSDATE)),?,SYSDATE,?,?,?,?,?,SYSDATE,?,?,?,?,?,?)
							
                          
                             
SELECT.HIPD_PAT_BULLETIN_DTL =SELECT   hrgnum_puk AS patcrno, hrgnum_s_no AS bulletinSerialNo,hrgnum_episode_code AS episodecode, hrgnum_visit_no AS episodevisitno, hrgnum_status_code AS patstatuscode, hrgnum_admission_no AS patadmno,hipstr_remarks AS patremarks, gdt_effective_frm AS effectivefromdate, psrstr_emp_no AS patempno, gnum_isvalid AS isvalid, gdt_effective_to effectivetodate, gnum_seat_id AS seatid,to_char(gdt_entry_date,'dd-Mon-yyyy') AS entrydate, gnum_hospital_code AS hospitalcode, gstr_ip_add AS patipaddr, gdt_lstmod_date AS lstmodifieddate, (SELECT INITCAP (hrgstr_status) FROM hrgt_pat_status_mst WHERE hrgnum_status_code \= a.hrgnum_status_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1  AND hrgnum_slno \=(SELECT MAX (hrgnum_slno) FROM hrgt_pat_status_mst WHERE hrgnum_status_code \= a.hrgnum_status_code  AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= 1)) AS patstatusname, (SELECT INITCAP (gstr_usr_name) FROM gblt_user_mst WHERE GNUM_USERID \= a.gnum_seat_id  AND gnum_hospital_code \= a.gnum_hospital_code) as enterbyname FROM hipd_pat_bulletin_dtl a   WHERE hrgnum_puk \=?  AND hrgnum_episode_code \=?  AND hrgnum_visit_no \=?  AND gnum_isvalid \=? and gnum_hospital_code\=? ORDER BY hrgnum_s_no                         
							
								

INSERT.HIPD_PAT_BULLETIN_DTL=insert into HIPD_PAT_BULLETIN_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_S_NO, HRGNUM_STATUS_CODE, HRGNUM_ADMISSION_NO, HIPSTR_REMARKS, GDT_EFFECTIVE_FRM, PSRSTR_EMP_NO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GSTR_IP_ADD) \
							 values(?,?,?,?,?,?,?,sysdate,?,?,?,sysdate,?,?)


UDPATE.HIPD_PAT_BULLETIN_DTL=update HIPD_PAT_BULLETIN_DTL set HRGNUM_STATUS_CODE\=?, HIPSTR_REMARKS\=?,GDT_EFFECTIVE_TO\=sysdate,GDT_LSTMOD_DATE\=sysdate where HRGNUM_PUK\=? and  HRGNUM_EPISODE_CODE\=? and  HRGNUM_VISIT_NO\=? and  HRGNUM_S_NO\=?\t\t
													


INSERT_NURSE.HIPD_DOCTOR_ROUND_DTL = INSERT INTO HIPD_DOCTOR_ROUND_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HIPDT_ROUND_DATE, HRGNUM_VISIT_NO, HRGNUM_ROUND_NO, HIPNUM_SLNO, HRGNUM_ADMISSION_NO, HIPSTR_VISIT_NOTES, GNUM_ISVALID, HIPDT_ROUND_TIME, HIPDT_NEXT_VISIT_DATE, GNUM_SEAT_ID, GDT_ENTRY_DATE, HIPNUM_ENTER_BY, PSRSTR_EMP_NO, GNUM_HOSPITAL_CODE, GSTR_IP_ADD, HIPNUM_VERIFY_FLAG) VALUES(?,?,TRUNC(SYSDATE),?,(SELECT NVL(MAX(HRGNUM_ROUND_NO),0)+1 FROM HIPD_DOCTOR_ROUND_DTL WHERE HRGNUM_PUK \= ? AND TRUNC(HIPDT_ROUND_DATE) \= TRUNC(SYSDATE)),?,?,?,?,SYSDATE,to_date(?,'dd-Mon-yyyy'),?,SYSDATE,?,?,?,?,?)\t


SELECT_DOC_INSTRUCTION.HIPD_DOCTOR_ROUND_DTL = SELECT (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO\=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)AS DOCTORNAME, A.HIPSTR_INSTRUCTIONS AS INSTRUCTION , TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS ENTRYDATE FROM HIPD_DOCTOR_ROUND_DTL A WHERE A.HRGNUM_ADMISSION_NO \= ? AND A.HIPNUM_VERIFY_FLAG\=? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY ENTRYDATE DESC


SELECT_UNVERIFIED_ENTRY_PATWISE.HIPD_DOCTOR_ROUND_DTL = SELECT A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS EPISODECODE, A.HRGNUM_VISIT_NO AS EPISODEVISITNO, A.HRGNUM_ROUND_NO AS ROUNDNO, A.HIPNUM_SLNO AS SERIALNO, A.HRGNUM_ADMISSION_NO AS PATADMNO, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS ENTRYDATE, TO_CHAR(A.HIPDT_ROUND_DATE,'dd-Mon-yyyy') AS roundDate, (SELECT INITCAP(GSTR_USR_NAME)||DECODE(GNUM_DESIGNATION,NULL,'','('||INITCAP(GNUM_DESIGNATION)||')') FROM GBLT_USER_MST WHERE GNUM_USERID\=A.GNUM_SEAT_ID AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE) AS userName FROM HIPD_DOCTOR_ROUND_DTL A WHERE A.HRGNUM_ADMISSION_NO \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HIPNUM_VERIFY_FLAG \= ? AND A.PSRSTR_EMP_NO \= ? ORDER BY ENTRYDATE DESC


SELECT_UNVERIFIED_RECORD_DETAIL.HIPD_DOCTOR_ROUND_DTL = SELECT HIPSTR_PROGRESS_NOTES as progressNote, HIPSTR_VISIT_NOTES as visitNote, HIPSTR_INSTRUCTIONS as instruction FROM HIPD_DOCTOR_ROUND_DTL WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? AND HRGNUM_ROUND_NO \= ? AND HIPNUM_SLNO \= ? AND HRGNUM_ADMISSION_NO \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? AND HIPDT_ROUND_DATE\=TO_DATE(?,'dd-Mon-yyyy')
															

UPDATE_DOCTOR_NOTES.HIPD_DOCTOR_ROUND_DTL = UPDATE HIPD_DOCTOR_ROUND_DTL SET HIPSTR_PROGRESS_NOTES \= ?, HIPSTR_VISIT_NOTES \= ?, HIPSTR_INSTRUCTIONS \= ?, GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \=? , GNUM_DOCTORSEAT_ID \= ?, HIPNUM_VERIFY_FLAG \= ?, HIPDT_VERIFY_DATE \= SYSDATE WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? AND HRGNUM_ROUND_NO \= ? AND HIPNUM_SLNO \= ? AND HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND HIPDT_ROUND_DATE\=TO_DATE(?,'dd-Mon-yyyy')


INSERT_BY_DOCTOR.HIPD_DOCTOR_ROUND_DTL = INSERT INTO HIPD_DOCTOR_ROUND_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HIPDT_ROUND_DATE, HRGNUM_VISIT_NO, HRGNUM_ROUND_NO, HIPNUM_SLNO, HRGNUM_ADMISSION_NO, HIPSTR_PROGRESS_NOTES, HIPSTR_VISIT_NOTES, HIPSTR_INSTRUCTIONS, GNUM_ISVALID, HIPDT_ROUND_TIME, HIPDT_NEXT_VISIT_DATE, GNUM_SEAT_ID, GDT_ENTRY_DATE, HIPNUM_ENTER_BY, PSRSTR_EMP_NO, GNUM_HOSPITAL_CODE, GSTR_IP_ADD, GNUM_DOCTORSEAT_ID, HIPNUM_VERIFY_FLAG, HIPDT_VERIFY_DATE, sctstr_pterms_visit_notes,sctstr_ids_visit_notes,sctstr_pterms_progress_notes,sctstr_ids_progress_notes,sctstr_pterms_instructions,sctstr_ids_instructions) VALUES(?,?,TRUNC(SYSDATE),?,(SELECT NVL(MAX(HRGNUM_ROUND_NO),0)+1 FROM HIPD_DOCTOR_ROUND_DTL WHERE HRGNUM_PUK \= ? AND TRUNC(HIPDT_ROUND_DATE) \= TRUNC(SYSDATE)),?,?,?,?,?,?,to_date(?,'dd-Mon-yyyy hh24\:mi'),?\:\:timestamp,?,SYSDATE,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?)


#INSERT_OUT_TAKE.HIPD_PAT_INTAKEOUT_DTL = INSERT INTO HIPD_PAT_INTAKEOUT_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HIPDT_ENTRY_DATE, HRGNUM_VISIT_NO, \
#											HRGNUM_ADMISSION_NO, HIPNUM_INTAKEOUT_PARA_ID, HIPDT_INTAKEOUT_TIME, HIPNUM_ROUTE_ID, HIPNUM_INTAKEOUT_MODE, \
#											GNUM_ISVALID, GNUM_SEAT_ID, HIPSTR_VOLUME, GDT_ENTRY_DATE, HIPSTR_REMARK, HIPNUM_SLNO, GNUM_HOSPITAL_CODE, \
#											GNUM_LSTMOD_SEATID, GSTR_IP_ADD, GDT_LSTMOD_DATE, HIPSTR_INTAKEOUT_PARA_NAME,HIPNUM_ENTRY_MODE)VALUES(?,?,TRUNC(SYSDATE),?,?,?,TO_DATE(?,'dd-Mon-yyyy hh24:mi'),?,?,?,?,?, \
#											SYSDATE,?,(SELECT NVL(MAX(HIPNUM_SLNO),0)+1 FROM HIPD_PAT_INTAKEOUT_DTL WHERE HRGNUM_PUK = ? AND TRUNC(HIPDT_ENTRY_DATE)=TRUNC(SYSDATE)),?,?,?,?,?,?)																																																																				
#																																																																				

#modifiedby:NehaRajgariya Date:16dec2016 Purpose:intakeout snomed-ct
INSERT_OUT_TAKE.HIPD_PAT_INTAKEOUT_DTL = INSERT INTO HIPD_PAT_INTAKEOUT_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HIPDT_ENTRY_DATE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HIPNUM_INTAKEOUT_PARA_ID, HIPDT_INTAKEOUT_TIME, HIPNUM_ROUTE_ID, HIPNUM_INTAKEOUT_MODE, GNUM_ISVALID, GNUM_SEAT_ID, HIPSTR_VOLUME, GDT_ENTRY_DATE, HIPSTR_REMARK, HIPNUM_SLNO, GNUM_HOSPITAL_CODE, GNUM_LSTMOD_SEATID, GSTR_IP_ADD, GDT_LSTMOD_DATE, HIPSTR_INTAKEOUT_PARA_NAME,HIPNUM_ENTRY_MODE,sctstr_ids_remarks, sctstr_pterms_remarks, sctnum_id_inout_para_id, sctstr_pterm_inout_para_id)VALUES(?,?,TRUNC(SYSDATE),?,?,?,TO_DATE(?,'dd-Mon-yyyy hh24\:mi'),?,?,?,?,?, SYSDATE,?,(SELECT NVL(MAX(HIPNUM_SLNO),0)+1 FROM HIPD_PAT_INTAKEOUT_DTL WHERE HRGNUM_PUK \= ? AND TRUNC(HIPDT_ENTRY_DATE)\=TRUNC(SYSDATE)),?,?,?,?,?,?,?,?,?,?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
	

SELECT_OUT_TAKE_DETAIL.HIPD_PAT_INTAKEOUT_DTL = SELECT A.HIPNUM_INTAKEOUT_PARA_ID AS inTakeOutParaId, TO_CHAR(A.HIPDT_INTAKEOUT_TIME,'dd-Mon-yyyy hh24\:mi') AS inTakeOutTime, A.HIPSTR_VOLUME AS volume, A.HIPSTR_REMARK AS remarks, A.HIPSTR_INTAKEOUT_PARA_NAME AS inTakeOutParaName, DECODE(HIPNUM_ENTRY_MODE,1,NVL((SELECT hipstr_route_name FROM HIPD_INTAKEOUT_ROUTE_MST WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= 100 AND hipnum_route_id \= a.hipnum_route_id),'-'), 2,(DECODE(a.hipnum_route_id,1,'Phlebotomy Left Arm',2,'Phlebotomy Right Arm')), 0,NVL((SELECT HGSTR_DRUG_ROUTE_NAME FROM HGBT_DRUG_ROUTE_MST WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= 100 AND HGNUM_DRUG_ROUTE_ID \= a.hipnum_route_id),'-'))AS routename FROM HIPD_PAT_INTAKEOUT_DTL A WHERE A.HRGNUM_PUK \= ? AND HRGNUM_ADMISSION_NO \= ? AND A.HIPNUM_INTAKEOUT_MODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY A.HIPDT_INTAKEOUT_TIME DESC,inTakeOutParaName


CHECK_PATIENT_ADM.HIPT_PATADMISSION_DTL = SELECT * FROM HIPT_PATADMISSION_DTL WHERE HRGNUM_PUK = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ? AND HIPDT_ADMSTATUS_CODE NOT IN (?,?,?) AND HIPNUM_ISACCEPTED=?



INSERT.HIPD_PAT_MONITORING_MST = insert into HIPD_PAT_MONITORING_MST(HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGNUM_VISIT_NO,HRGNUM_S_NO,HGNUM_PARA_ID, HRGNUM_ADMISSION_NO,HIPSTR_REMARKS,HIPNUM_DURATION,PSRSTR_EMP_NO,GNUM_ISVALID,HIPNUM_VERIFY_FLAG,GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_DOCTORSEAT_ID,HIPDT_VERIFY_DATE,GNUM_HOSPITAL_CODE,GSTR_IP_ADD,HIPNUM_INSTRUCTIONS_MODE,HIPNUM_DAY_FREQ, HIPNUM_MODE_ID) values(?,?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HIPD_PAT_MONITORING_MST WHERE GNUM_HOSPITAL_CODE \=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_VISIT_NO\=?),?,?,?,?,?,?,?,?,sysdate,?,sysdate,?,?,?,?,?)
											
#Modified by Vasu on 14.March.2019											
#SELECT_VITAL_DETAIL.HIPD_PAT_MONITORING_MST	=SELECT A.HGNUM_PARA_ID AS paraId, A.HIPNUM_DURATION AS duration, B.HGSTR_PARA_NAME AS paraName, A.HIPSTR_REMARKS AS remarks, A.HRGNUM_S_NO AS serialNo, A.HIPNUM_MODE_ID AS monitorMode, C.HIPSTR_MODE_NAME AS monitorModeName FROM HIPD_PAT_MONITORING_MST A, HGBT_PARAMETER_MST B, HIPD_MONITORING_MODE_MST C WHERE A.HGNUM_PARA_ID\=B.HGNUM_PARA_ID AND B.GNUM_HOSPITAL_CODE\=100 AND A.GNUM_ISVALID\=B.GNUM_ISVALID AND A.HIPNUM_MODE_ID\=C.HIPNUM_MODE_ID AND A.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=C.GNUM_ISVALID AND A.HRGNUM_PUK\=? AND A.HRGNUM_EPISODE_CODE\=? AND A.HRGNUM_VISIT_NO\=? AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?
SELECT_VITAL_DETAIL.HIPD_PAT_MONITORING_MST = SELECT A.HGNUM_PARA_ID AS paraId, A.HIPNUM_DURATION AS duration, B.HGSTR_PARA_NAME AS paraName, A.HIPSTR_REMARKS AS remarks, A.HRGNUM_S_NO AS serialNo, A.HIPNUM_MODE_ID AS monitorMode, C.HIPSTR_MODE_NAME AS monitorModeName FROM HIPD_PAT_MONITORING_MST A, HGBT_PARAMETER_MST B, HIPD_MONITORING_MODE_MST C WHERE A.HGNUM_PARA_ID\=B.HGNUM_PARA_ID AND B.GNUM_HOSPITAL_CODE\=100 AND A.HIPNUM_MODE_ID\=C.HIPNUM_MODE_ID AND C.GNUM_HOSPITAL_CODE\=100 AND A.GNUM_ISVALID\=1 AND B.GNUM_ISVALID\=1 AND A.HRGNUM_PUK\=? AND A.HRGNUM_EPISODE_CODE\=? AND A.HRGNUM_VISIT_NO\=? AND A.GNUM_HOSPITAL_CODE\=? AND C.GNUM_ISVALID\=?
	
UPDATE_VITAL_DETAIL.HIPD_PAT_MONITORING_MST = update HIPD_PAT_MONITORING_MST set HIPSTR_REMARKS\=?,HIPNUM_DURATION\=?,HIPNUM_DAY_FREQ \= ?, HIPNUM_MODE_ID \= ? where HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_VISIT_NO\=?  and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_S_NO\=? and HGNUM_PARA_ID\=?\t\t\t\t\t\t\t\t
												

SELECT_PAT_PREVIOUS_PROGRESS_NOTERS_HIPD_NURSE_ROUND_DTL = select rownum,HIPSTR_PROGRESS_NOTES as progressNote , to_char(HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') as roundTime, (SELECT INITCAP(GSTR_USR_NAME)||DECODE(GNUM_DESIGNATION,NULL,'','('||INITCAP(GNUM_DESIGNATION)||')') FROM GBLT_USER_MST WHERE GNUM_USERID\=A.GNUM_SEAT_ID AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE) AS userName from HIPD_NURSE_ROUND_DTL A where HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?  order by hipdt_round_time desc\t\t\t\t\t\t\t\t\t\t\t


#SELECT.DOC_PREV_ROUND_DTL.HIPD_DOCTOR_ROUND_DTL	 =SELECT (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO\=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)AS doctorName, A.HIPSTR_PROGRESS_NOTES AS progressNote, A.HIPSTR_VISIT_NOTES AS visitNote, A.HIPSTR_INSTRUCTIONS AS instruction, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate FROM HIPD_DOCTOR_ROUND_DTL A WHERE A.HRGNUM_ADMISSION_NO\=? AND A.HIPNUM_VERIFY_FLAG\=? AND A.GNUM_DOCTORSEAT_ID\=? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY roundTime DESC
#Modified by Vasu on 26.Sept.2018
SELECT.DOC_PREV_ROUND_DTL.HIPD_DOCTOR_ROUND_DTL	 =SELECT (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO\=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)AS doctorName, A.HIPSTR_PROGRESS_NOTES AS progressNote, A.HIPSTR_VISIT_NOTES AS visitNote, A.HIPSTR_INSTRUCTIONS AS instruction, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate,HRGNUM_ROUND_NO as roundNo,HIPNUM_SLNO as serialNo,TO_CHAR(A.HIPDT_ROUND_DATE,'dd-Mon-yyyy hh24\:mi') AS roundDate FROM HIPD_DOCTOR_ROUND_DTL A WHERE A.HRGNUM_ADMISSION_NO\=? AND A.HIPNUM_VERIFY_FLAG\=? AND A.GNUM_DOCTORSEAT_ID\=? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY roundTime DESC

REVOKE_VITALS.HIPD_PAT_MONITORING_MST = UPDATE HIPD_PAT_MONITORING_MST SET GNUM_ISVALID \= ? WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? AND HGNUM_PARA_ID \= ? AND GNUM_HOSPITAL_CODE \= ?


INSERT.HIPT_PATDISCHARGE_REQ_DTL = INSERT INTO HIPT_PATDISCHARGE_REQ_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HIPNUM_SLNO, HRGNUM_ADMISSION_NO, HIPSTR_REMARKS, GNUM_ISVALID, HIPDT_NEXT_VISIT_DATE, GNUM_SEAT_ID, GDT_ENTRY_DATE, HIPNUM_REQ_TYPE, PSRSTR_EMP_NO, GNUM_HOSPITAL_CODE, GSTR_IP_ADD)VALUES(?,?,?,(SELECT NVL(MAX(HIPNUM_SLNO),0)+1 FROM HIPT_PATDISCHARGE_REQ_DTL WHERE HRGNUM_ADMISSION_NO \= ?),?,?,?,to_date(?,'dd-Mon-yyyy'),?,SYSDATE,?,?,?,?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
										
SELECT_PAT_STATUS.HIPT_PATADMISSION_DTL = SELECT HIPDT_ADMSTATUS_CODE FROM HIPT_PATADMISSION_DTL WHERE HIPNUM_ADMNO = ? AND GNUM_HOSPITAL_CODE = ?

SELECT.HIPT_PATDISCHARGE_REQ_DTL = SELECT HIPSTR_REMARKS as remarks, HIPNUM_REQ_TYPE as requestType,to_char(hipdt_next_visit_date,'dd-Mon-yyyy') as nextVisitDate FROM HIPT_PATDISCHARGE_REQ_DTL WHERE HRGNUM_ADMISSION_NO = ? AND GNUM_ISVALID = ? AND HIPNUM_REQ_TYPE = ? AND GNUM_HOSPITAL_CODE = ?

UPDATE_PAT_STATUS.HIPT_PATADMISSION_DTL = UPDATE HIPT_PATADMISSION_DTL SET HIPDT_ADMSTATUS_CODE \= ?,HIPNUM_IS_DEAD \= ?, HIPDT_NEXT_VISITDATE \= TO_DATE(?,'dd-Mon-yyyy'), HIPDT_DISSTATUS_CODE \= ?, HIPSTR_DISCHARGE_ADVISE \= ?, HIPSTR_DISCHARGE_ADVICE_BY \= ?, HIPDT_DISCHARGE_ADVICE_DATE \= SYSDATE WHERE HIPNUM_ADMNO \= ? AND GNUM_HOSPITAL_CODE \= ?

// Modified for Actual Item Name and Item Brand ID By Shruti Shail 10-Nov-2016
INSERT_HRGT_EPISODE_DRUG_ADMIN_DTL_OLD = insert into HRGT_EPISODE_DRUG_ADMIN_DTL(HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGDT_ADVICE_DATE,HRGDT_SCHEDULE_DATE,HRGNUM_S_NO, HRGNUM_ADMISSION_NO,HRGNUM_VISIT_NO,HSTNUM_ITEM_ID, HGSTR_DOSE_TIME, HRGDT_ADMINISTRATION_TIME, HGNUM_DOSE_ID,  HRGDT_ADMINISTRATION_ENDTIME, HGNUM_DOSE_SHIFT, HRGNUM_DRUG_SAURCE_FLAG, GNUM_SEAT_ID, GDT_ENTRY_DATE, HSTSTR_BATCH_NO, GNUM_ISVALID, HSTDT_EXPIRY_DATE, HGSTR_DOSE_NAME, HGNUM_DRUG_ROUTE_ID, HRGSTR_REMARKS, HGNUM_ISEMPTY_STOMACH,  HSTSTR_ITEM_NAME, GNUM_HOSPITAL_CODE, PSRSTR_EMP_NO, HRGNUM_IS_REACTION, HRGNUM_ADMIN_FLAG, HGNUM_ACTUAL_DOSE_ID, HGSTR_ACTUAL_DOSE_NAME, HGNUM_ACTUAL_DRUG_ROUTE_ID,HSTNUM_ITEMTYPE_ID, hstnum_itembrand_id) values(?,?,trunc(sysdate),to_date(?,'dd-Mon-yyyy'),(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_EPISODE_DRUG_ADMIN_DTL WHERE HRGNUM_PUK\= ? and trunc(HRGDT_ADVICE_DATE)\=trunc(sysdate) and GNUM_HOSPITAL_CODE\=?),?,?,?,?, to_date(?,'dd-mm-yyyy hh24\:mi'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,?,?,sysdate,?,?,to_date(?,'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,?,?,?,?,?,?)


INSERT_HRGT_EPISODE_DRUG_ADMIN_DTL = insert into HRGT_EPISODE_DRUG_ADMIN_DTL(HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGDT_ADVICE_DATE,HRGDT_SCHEDULE_DATE,HRGNUM_S_NO, HRGNUM_ADMISSION_NO,HRGNUM_VISIT_NO,HSTNUM_ITEM_ID, HGSTR_DOSE_TIME, HRGDT_ADMINISTRATION_TIME, HGNUM_DOSE_ID,  HRGDT_ADMINISTRATION_ENDTIME, HGNUM_DOSE_SHIFT, HRGNUM_DRUG_SAURCE_FLAG, GNUM_SEAT_ID, GDT_ENTRY_DATE, HSTSTR_BATCH_NO, GNUM_ISVALID, HSTDT_EXPIRY_DATE, HGSTR_DOSE_NAME, HGNUM_DRUG_ROUTE_ID, HRGSTR_REMARKS, HGNUM_ISEMPTY_STOMACH,  HSTSTR_ITEMBRAND_NAME, GNUM_HOSPITAL_CODE, PSRSTR_EMP_NO, HRGNUM_IS_REACTION, HRGNUM_ADMIN_FLAG, HGNUM_ACTUAL_DOSE_ID, HGSTR_ACTUAL_DOSE_NAME, HGNUM_ACTUAL_DRUG_ROUTE_ID,HSTNUM_ITEMTYPE_ID, hstnum_itembrand_id, hgstr_cutoff_time_left,hgstr_cutoff_time_right,HSTSTR_ITEM_NAME) values(?,?,trunc(sysdate),to_date(?,'dd-Mon-yyyy'),(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_EPISODE_DRUG_ADMIN_DTL WHERE HRGNUM_PUK\= ? and trunc(HRGDT_ADVICE_DATE)\=trunc(sysdate) and GNUM_HOSPITAL_CODE\=?),?,?,?,?, to_date(?,'dd-mm-yyyy hh24\:mi'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,?,?,sysdate,?,?,to_date(?,'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?, (SELECT pkg_opd_func.get_drugitem_name('','',?,'','')))


									/*INSERT INTO hrgt_episode_drug_admin_dtl (hrgnum_puk, hrgnum_episode_code, hrgdt_advice_date, hrgdt_schedule_date, hrgnum_s_no, hrgnum_admission_no, hrgnum_visit_no, hstnum_item_id, hgstr_dose_time, hrgdt_administration_time, hgnum_dose_id, hrgdt_administration_endtime, hgnum_dose_shift, hrgnum_drug_saurce_flag, gnum_seat_id, gdt_entry_date, hststr_batch_no, gnum_isvalid, hstdt_expiry_date, hgstr_dose_name, hgnum_drug_route_id, hrgstr_remarks, hgnum_isempty_stomach, hststr_item_name, gnum_hospital_code, psrstr_emp_no, hrgnum_is_reaction, hrgnum_admin_flag, hgnum_actual_dose_id, hgstr_actual_dose_name, hgnum_actual_drug_route_id, hstnum_itemtype_id ) VALUES (?, ?, TRUNC (SYSDATE), TO_DATE (?, 'dd-Mon-yyyy'), (SELECT NVL (MAX (hrgnum_s_no), 0) + 1 FROM hrgt_episode_drug_admin_dtl WHERE hrgnum_puk \= ? AND trunc(hrgdt_advice_date) \=trunc(SYSDATE) AND gnum_hospital_code \= ?), ?, ?, ?, ?, decode(?,null,null,to_date(?,'dd-mm-yyyy hh24\:mi')), ?, decode(?,null,null,to_date(?,'dd-mm-yyyy hh24\:mi')), ?, ?, ?, SYSDATE, ?, ?, decode(?,null,null,to_date(?,'dd-mm-yyyy hh24\:mi')), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )*/



										

INSERT_DRUG_ADMIN_DTL_HRGT_EPISODE_DRUG_ADMIN_DTL = insert into HRGT_EPISODE_DRUG_ADMIN_DTL(HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGDT_ADVICE_DATE,HRGDT_SCHEDULE_DATE,HRGNUM_S_NO, HRGNUM_ADMISSION_NO,HRGNUM_VISIT_NO,HSTNUM_ITEM_ID, HGSTR_DOSE_TIME, HRGDT_ADMINISTRATION_TIME, HGNUM_DOSE_ID,  HRGDT_ADMINISTRATION_ENDTIME, HGNUM_DOSE_SHIFT, HRGNUM_DRUG_SAURCE_FLAG, GNUM_SEAT_ID, GDT_ENTRY_DATE, HSTSTR_BATCH_NO, GNUM_ISVALID, HSTDT_EXPIRY_DATE, HGSTR_DOSE_NAME, HGNUM_DRUG_ROUTE_ID, HRGSTR_REMARKS, HGNUM_ISEMPTY_STOMACH,  HSTSTR_ITEM_NAME, GNUM_HOSPITAL_CODE, PSRSTR_EMP_NO, HRGNUM_IS_REACTION, HRGNUM_ADMIN_FLAG, HGNUM_ACTUAL_DOSE_ID, HGSTR_ACTUAL_DOSE_NAME, HGNUM_ACTUAL_DRUG_ROUTE_ID,HRGNUM_VOLUME, hstnum_itembrand_id, hststr_itembrand_name) values(?,?,to_date(?,'dd-Mon-yyyy'),trunc(sysdate),(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_EPISODE_DRUG_ADMIN_DTL WHERE HRGNUM_PUK\= ? and  trunc(to_date(HRGDT_ADVICE_DATE,'dd-mm-yyyy'))\=to_date(sysdate,'dd-mm-yyyy') and GNUM_HOSPITAL_CODE\=?),?,?,?,?, to_date(?,'dd-Mon-yyyy hh24\:mi'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,?,?,sysdate,?,?,to_date(?,'dd-Mon-yyyy'), ?,?,?,?,?,?,?,?,?,?,?,?,DECODE(?,0,null,?),?,?)

PKG_MRD_DTL.CONSENT_STATUS_FOR_DRUG = select PKG_MRD_DTL.ConsentStatus(?,?,?,?,?,?,?) from dual	
UPDATE_DRUG_EXECUTION.HRGT_EPISODE_DRUG_ADMIN_DTL_OLD = UPDATE HRGT_EPISODE_DRUG_ADMIN_DTL SET HRGDT_ADMINISTRATION_TIME\=to_TIMESTAMP(?,'DD-Mon-YYYY HH24\:MI'), HRGDT_ADMINISTRATION_ENDTIME \= to_TIMESTAMP(DECODE(?,0,null,?),'DD-MM-YYYY HH24\:MI'),HSTSTR_BATCH_NO\=?,HSTDT_EXPIRY_DATE\=to_timestamp(?,'DD-Mon-YYYY'), HRGSTR_REMARKS\=?,HRGNUM_ADMIN_FLAG\=?,HGNUM_ACTUAL_DOSE_ID\=?,HGSTR_ACTUAL_DOSE_NAME\=?,HGNUM_ACTUAL_DRUG_ROUTE_ID\=?,HRGNUM_VOLUME\=DECODE(?,0,null,?) WHERE HRGNUM_PUK \= ? AND trunc(HRGDT_ADVICE_DATE) \= to_timestamp(?,'DD-MM-YYYY') and HRGNUM_S_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?\t

UPDATE_DRUG_EXECUTION.HRGT_EPISODE_DRUG_ADMIN_DTL = UPDATE HRGT_EPISODE_DRUG_ADMIN_DTL SET HRGDT_ADMINISTRATION_TIME\=to_TIMESTAMP(?,'DD-Mon-YYYY HH24\:MI'), HRGDT_ADMINISTRATION_ENDTIME \= to_TIMESTAMP(DECODE(?,0,null,?),'DD-MM-YYYY HH24\:MI'),HSTSTR_BATCH_NO\=?,HSTDT_EXPIRY_DATE\=to_timestamp(?,'DD-Mon-YYYY'), HRGSTR_REMARKS\=?,HRGNUM_ADMIN_FLAG\=?,HGNUM_ACTUAL_DOSE_ID\=?,HGSTR_ACTUAL_DOSE_NAME\=?,HGNUM_ACTUAL_DRUG_ROUTE_ID\=?,HRGNUM_VOLUME\=DECODE(?,0,null,?), hstnum_itembrand_id\=?,hststr_itembrand_name\=?,hstnum_actual_itembrand_id\=?,hststr_actual_itembrand_name\=? WHERE HRGNUM_PUK \= ? AND trunc(HRGDT_ADVICE_DATE) \= to_timestamp(?,'DD-MM-YYYY') and HRGNUM_S_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?\t


UPDATE.DRUG_ADMIN_DETAIL.HRGT_EPISODE_DRUG_ADMIN_DTL = UPDATE HRGT_EPISODE_DRUG_ADMIN_DTL SET GNUM_ISVALID\=? WHERE HRGNUM_PUK \= ? AND trunc(HRGDT_ADVICE_DATE) \= trunc(to_date(?,'dd-mm-yyyy hh24\:mi')) and HSTNUM_ITEM_ID\=? AND HRGNUM_ADMISSION_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_ADMIN_FLAG\=?

UPDATE_ENDTIME.HRGT_EPISODE_DRUG_ADMIN_DTL = UPDATE HRGT_EPISODE_DRUG_ADMIN_DTL SET HRGDT_ADMINISTRATION_ENDTIME \= to_date(?,'dd-mm-yyyy hh24\:mi'),\tHRGSTR_REMARKS\=?,HRGNUM_ADMIN_FLAG\=? , HRGNUM_VOLUME\=?  WHERE HRGNUM_PUK \= ? AND trunc(HRGDT_ADVICE_DATE) \= trunc(to_date(?,'dd-mon-yyyy')) and HRGNUM_S_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?\t\t\t\t\t\t\t\t\t\t\t 


SELECT_MAXSLNO.HRGT_EPISODE_DRUG_ADMIN_DTL = SELECT NVL(MAX(HRGNUM_S_NO),0) FROM HRGT_EPISODE_DRUG_ADMIN_DTL WHERE GNUM_HOSPITAL_CODE =? and HRGNUM_PUK=? and trunc(to_date(HRGDT_ADMINISTRATION_DATE,'dd-mon-yyyy'))=trunc(to_date(sysdate,'dd-mon-yyyy'))			

INSERT_HRGT_EPISODE_DRUG_REACTION_DTL = insert into HRGT_EPISODE_DRUG_REACTION_DTL(HRGNUM_PUK,HRGDT_RECORD_DATE,HRGNUM_S_NO,HRGNUM_EPISODE_CODE, HRGNUM_ADMISSION_NO,HRGNUM_VISIT_NO,HSTNUM_ITEM_ID,HRGDT_REACTION_STARTTIME,HSTSTR_BATCH_NO,HRGDT_DRUGGIVEN_TIME, GNUM_SEAT_ID,HRGDT_REACTION_ENDTIME,GDT_ENTRY_DATE,HBSTR_CONTROL_SUMMARY,GNUM_ISVALID,HRGSTR_REACTION_SUMMARY, GNUM_HOSPITAL_CODE,PSRSTR_EMP_NO, HSTNUM_ITEMBRAND_ID,HSTSTR_ITEMBRAND_NAME)  values(?, TO_DATE (TO_CHAR(sysdate, 'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'),?,?,?,?,?, TO_DATE (TO_CHAR(?\:\:timestamp, 'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'),?, TO_DATE (TO_CHAR(?\:\:timestamp, 'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'),?, TO_DATE (TO_CHAR(?\:\:timestamp, 'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'),sysdate,?,?,?,?,?,?,?)


SELECT_MAXADMIN_DATE.HRGT_EPISODE_DRUG_ADMIN_DTL = select max(to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy')) from HRGT_EPISODE_DRUG_ADMIN_DTL where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?)
							 							

SELECT_IN_OUT_TAKE_SUMMARY.HIPD_PAT_INTAKEOUT_DTL = select paraId AS inTakeOutParaName,volume AS volume  from( select HIPSTR_INTAKEOUT_PARA_NAME as paraId, sum(HIPSTR_VOLUME) as volume from HIPD_PAT_INTAKEOUT_DTL a where A.HIPNUM_INTAKEOUT_MODE \= ? AND A.HRGNUM_PUK \= ? AND TRUNC(A.HIPDT_INTAKEOUT_TIME)\=TRUNC(SYSDATE) AND A.GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE\= ? group by HIPSTR_INTAKEOUT_PARA_NAME)

INSERT.HBBT_PAT_BLDSTOCK_DTL = insert into HBBT_PAT_BLDSTOCK_DTL(HRGNUM_PUK,HRGDT_STOCK_DATE,HBNUM_REQ_NO,HRGNUM_SLNO,HBNUM_STOCK_STATUS,HBSTR_BLDBAG_NO, HBNUM_BLDBAG_SEQNO,HBDT_BLDBAG_EXPIRY,HBNUM_BAG_VOLUME,HBNUM_SAURCE_FLAG,GNUM_SEAT_ID,HBSTR_TUBING_NO,GDT_ENTRY_DATE,HBSTR_BAG_BATCHNO, HBNUM_BLDGRP_CODE,GNUM_ISVALID,HBSTR_BLD_ABO,HBNUM_RH,HBNUM_BLD_COMPONENT_ID,HBSTR_REASON,HBSTR_BLOODBANK_NAME,HBSTR_BLOODBANK_ADD, HBSTR_COONTACT_NO,GNUM_HOSPITAL_CODE,HBNUM_ISREACTION) values(?,trunc(to_date(sysdate,'dd-mm-yyyy')),?,(SELECT NVL(MAX(HRGNUM_SLNO),0)+1 FROM HBBT_PAT_BLDSTOCK_DTL WHERE HRGNUM_PUK\= ? and to_date(HRGDT_STOCK_DATE,'dd-mm-yyyy')\=to_date(sysdate,'dd-mm-yyyy')),?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,?,sysdate,?,(select Pkg_Blood_Bank.BldGroup(?,?,?) from dual),?,?,?,?,?,?,?,?,?,?)

#INSERT.HIPD_DOCTOR_CALLBOOK_DTL = INSERT INTO HIPD_DOCTOR_CALLBOOK_DTL  (GNUM_HOSPITAL_CODE, GNUM_ISVALID,GSTR_IP_ADD,HIPDSTR_CALL_REMARKS,HIPDT_CALL_DATE,HIPNUM_CALL_TYPE,HIPNUM_ISDOCCALL_BYPEON,HIPNUM_ISDOCCALL_BYPHONE,HIPNUM_WARD_CODE,HIPSTR_DOCCALL_BYPEON_REMARKS,HIPSTR_DOCCALL_BYPHONE_REMARKS,HRGNUM_ADMISSION_NO,HRGNUM_CALL_NO,HRGNUM_PUK,PSRSTR_EMP_NO, PSRSTR_PEONEMP_NO,PSRSTR_RAISEBYEMP_NO,GDT_ENTRY_DATE,HIPDT_CALL_RAISETIME,GNUM_RAISESEAT_ID,HIPNUM_DOCCALL_BYPEON_STATUS,HIPNUM_DOCCALL_BYPHONE_STATUS,HIPNUM_CALL_PRIORITY) VALUES (?,?,?,?,trunc(sysdate),?,?,?,?,?,?,?,(SELECT NVL(MAX(HRGNUM_CALL_NO),0)+1 FROM HIPD_DOCTOR_CALLBOOK_DTL WHERE PSRSTR_EMP_NO\=? and HIPDT_CALL_DATE\=trunc(sysdate)),?,?,?,?,trunc(sysdate),sysdate,?,?,?,? )\t\t\t\t\t\t\t\t\t

INSERT.HIPD_DOCTOR_CALLBOOK_DTL=INSERT INTO HIPD_DOCTOR_CALLBOOK_DTL(GNUM_HOSPITAL_CODE, GNUM_ISVALID,GSTR_IP_ADD,HIPDSTR_CALL_REMARKS,HIPDT_CALL_DATE,HIPNUM_CALL_TYPE,HIPNUM_ISDOCCALL_BYPEON,HIPNUM_ISDOCCALL_BYPHONE,HIPNUM_WARD_CODE,HIPSTR_DOCCALL_BYPEON_REMARKS,HIPSTR_DOCCALL_BYPHONE_REMARKS,HRGNUM_ADMISSION_NO,PSRSTR_EMP_NO,HOPSTR_TO_CONSULTANT_NAME,HOPNUM_TO_USER_TYPE,HRGNUM_PUK,HRGNUM_CALL_NO,PSRSTR_PEONEMP_NO,PSRSTR_RAISEBYEMP_NO,GDT_ENTRY_DATE,HIPDT_CALL_RAISETIME,GNUM_RAISESEAT_ID,HIPNUM_DOCCALL_BYPEON_STATUS,HIPNUM_DOCCALL_BYPHONE_STATUS,HIPNUM_CALL_PRIORITY) VALUES (?,?,?,?,trunc(sysdate),?,?,?,?,?,?,?,?,?,?,?,(SELECT NVL(MAX(HRGNUM_CALL_NO),0)+1 FROM HIPD_DOCTOR_CALLBOOK_DTL WHERE PSRSTR_EMP_NO\=? and HIPDT_CALL_DATE\=trunc(sysdate)),?,?,trunc(sysdate),sysdate,?,?,?,? )\t\t\t\t\t\t\t\t\t

SELECT_CALLBOOK_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT TO_CHAR(a.HIPDT_CALL_DATE,'DD-Mon-yyyy')||' '||TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callDate,to_char(a.HIPDT_CALL_DATE,'dd-mon-yyyy') callDateFormat, TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callRaiseTime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST WHERE hipnum_ward_code \= a.hipnum_ward_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.GNUM_ISVALID AND gdt_effective_frm <\= SYSDATE AND trunc(NVL (gdt_effective_to, SYSDATE)) >\=trunc(SYSDATE)) wardcode,DECODE(a.HIPNUM_CALL_TYPE,1,'Automatic',2,'Manual')callType, DECODE(a.HIPNUM_CALL_PRIORITY,1,'Low',2,'Medium',3,'High')callPriority,a.HRGNUM_PUK patCrNo,UPPER(a.PSRSTR_EMP_NO) empNo,a.HRGNUM_CALL_NO callNo, nvl(a.HOPSTR_TO_CONSULTANT_NAME,(SELECT b.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL b WHERE b.str_emp_no \= a.PSRSTR_EMP_NO AND b.gnum_hospital_code \= a.gnum_hospital_code))consultantName,a.HIPDT_CALL_ACKTIME as status,a.HIPDSTR_DOCTOR_REMARKS doctorRemarks,a.HIPNUM_ISDOCCALL_BYPEON isDocCallByPeon,a.HIPNUM_DOCCALL_BYPEON_STATUS docCallByPeonStatus, a.HIPSTR_DOCCALL_BYPEON_REMARKS docCallByPeonRemarks,a.HIPNUM_ISDOCCALL_BYPHONE isDocCallbyPhone  ,a.HIPNUM_DOCCALL_BYPHONE_STATUS docCallByPhoneStatus,a.HIPSTR_DOCCALL_BYPHONE_REMARKS docCallByPhoneRemarks, a.PSRSTR_PEONEMP_NO peonEmpNo,a.HIPDSTR_CALL_REMARKS callRemarks FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE a.HRGNUM_PUK\=? AND a.HRGNUM_ADMISSION_NO\=? AND a.GNUM_HOSPITAL_CODE\=? AND a.GNUM_ISVALID \= ? AND trunc(a.HIPDT_CALL_DATE)>\=trunc(SYSDATE-1)  AND trunc(a.HIPDT_CALL_DATE)<\=trunc(SYSDATE) ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE
												
SELECT_CALLINBOX_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT TO_CHAR(a.HIPDT_CALL_DATE,'DD-Mon-yyyy')||' '||TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callDate,to_char(a.HIPDT_CALL_DATE,'dd-mon-yyyy') callDateFormat, TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callRaiseTime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST WHERE hipnum_ward_code \= a.hipnum_ward_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.GNUM_ISVALID AND gdt_effective_frm <\= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_DATE (SYSDATE, 'DD-MM-YY'))) wardCode,DECODE(a.HIPNUM_CALL_TYPE,1,'Automatic',2,'Manual')callType, DECODE(a.HIPNUM_CALL_PRIORITY,1,'Low',2,'Medium',3,'High')callPriority,a.HRGNUM_PUK patCrNo,UPPER(a.PSRSTR_EMP_NO) empNo,a.HRGNUM_CALL_NO callNo, (SELECT b.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL b WHERE b.str_emp_no \= a.PSRSTR_EMP_NO AND b.gnum_hospital_code \= a.gnum_hospital_code)consultantName,a.HIPDT_CALL_ACKTIME as status,a.HIPDSTR_DOCTOR_REMARKS doctorRemarks FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE a.GNUM_HOSPITAL_CODE\=? AND a.GNUM_ISVALID \= ? AND trunc(a.HIPDT_CALL_DATE)>\=trunc(SYSDATE-1)  AND trunc(a.HIPDT_CALL_DATE)<\=trunc(SYSDATE) ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE\t\t\t\t\t\t\t\t\t\t\t\t
												
SELECT_ALL_CALLBOOK_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT TO_CHAR(a.HIPDT_CALL_DATE,'DD-Mon-yyyy')||' '||TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callDate,to_char(a.HIPDT_CALL_DATE,'dd-mon-yyyy') callDateFormat, TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24\:Mi') callRaiseTime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST WHERE hipnum_ward_code \= a.hipnum_ward_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.GNUM_ISVALID AND gdt_effective_frm <\= SYSDATE AND trunc(NVL (gdt_effective_to, SYSDATE)) >\=trunc(SYSDATE)) wardcode,DECODE(a.HIPNUM_CALL_TYPE,1,'Automatic',2,'Manual')callType, DECODE(a.HIPNUM_CALL_PRIORITY,1,'Low',2,'Medium',3,'High')callPriority,a.HRGNUM_PUK patCrNo,UPPER(a.PSRSTR_EMP_NO) empNo,a.HRGNUM_CALL_NO callNo, nvl((SELECT b.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL b WHERE b.str_emp_no \= a.PSRSTR_EMP_NO AND b.gnum_hospital_code \= a.gnum_hospital_code),'---') consultantName,a.HIPDT_CALL_ACKTIME as status,a.HIPDSTR_DOCTOR_REMARKS doctorRemarks,a.HIPDSTR_CALL_REMARKS callRemarks FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE a.HRGNUM_PUK\=? AND a.HRGNUM_ADMISSION_NO\=? AND a.GNUM_HOSPITAL_CODE\=? AND a.GNUM_ISVALID \= ?  ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE\t\t\t\t\t\t\t\t\t\t\t\t 
														
SELECT_CALLDETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT a.HIPDSTR_CALL_REMARKS callRemarks,a.HIPNUM_CALL_PRIORITY callPriority, a.HIPNUM_DOCCALL_BYPEON_STATUS docCallByPeonStatus,a.HIPSTR_DOCCALL_BYPEON_REMARKS docCallByPeonRemarks, a.HIPNUM_DOCCALL_BYPHONE_STATUS docCallByPhoneStatus,a.HIPSTR_DOCCALL_BYPHONE_REMARKS docCallByPhoneRemarks, nvl(a.HOPSTR_TO_CONSULTANT_NAME,(SELECT b.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL b WHERE b.str_emp_no \= a.PSRSTR_EMP_NO AND b.gnum_hospital_code \= a.gnum_hospital_code))consultantName , (SELECT c.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no \= a.PSRSTR_RAISEBYEMP_NO AND c.gnum_hospital_code \= a.gnum_hospital_code) raiseByEmpNo,a.HIPNUM_ISDOCCALL_BYPEON isDocCallByPeon,a.HIPNUM_ISDOCCALL_BYPHONE isDocCallbyPhone, a.PSRSTR_EMP_NO empNo,a.HRGNUM_CALL_NO callNo,to_char(a.HIPDT_CALL_DATE, 'dd-Mon-yyyy') callDate,a.HIPDSTR_DOCTOR_REMARKS doctorRemarks,a.PSRSTR_PEONEMP_NO peonEmpNo, a.HIPDT_CALL_ACKTIME status ,a.HRGNUM_ADMISSION_NO patAdmnNo,a.HRGNUM_PUK patCrNo FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE a.HRGNUM_CALL_NO\=? AND a.PSRSTR_EMP_NO\=upper(?) and a.HIPDT_CALL_DATE\=To_DATE(?,'DD-Mon-YYYY') and a.GNUM_HOSPITAL_CODE\=? AND a.GNUM_ISVALID \= ?
											
UPDATE.HIPD_DOCTOR_CALLBOOK_DTL = 	UPDATE HIPD_DOCTOR_CALLBOOK_DTL a SET a.HIPDSTR_CALL_REMARKS=? , a.HIPNUM_ISDOCCALL_BYPEON=?, a.HIPNUM_ISDOCCALL_BYPHONE=?,a.HIPNUM_DOCCALL_BYPEON_STATUS=?,a.HIPNUM_DOCCALL_BYPHONE_STATUS=?, a.HIPSTR_DOCCALL_BYPEON_REMARKS=?,a.HIPSTR_DOCCALL_BYPHONE_REMARKS=?, a.PSRSTR_PEONEMP_NO=upper(?) WHERE a.HRGNUM_CALL_NO=? AND a.PSRSTR_EMP_NO=upper(?) AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? 

#SELECT_CALLACKNOWLEDGE_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT   TO_CHAR (a.hipdt_call_date, 'DD-Mon-yyyy')||' '||TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') calldate, TO_CHAR (a.hipdt_call_date, 'dd-mon-yyyy') calldateformat, TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') callraisetime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST  WHERE hipnum_ward_code = a.hipnum_ward_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= SYSDATE AND (TRUNC(NVL (gdt_effective_to, SYSDATE)) >=  TRUNC(SYSDATE))) wardcode, DECODE (a.hipnum_call_type, 1, 'Automatic',  2, 'Manual') calltype, DECODE (a.hipnum_call_priority,1, 'Low',2, 'Medium',3, 'High') callpriority, a.hrgnum_puk patcrno,UPPER (a.psrstr_emp_no) empno, a.hrgnum_call_no callno, a.hipdstr_doctor_remarks doctorRemarks,a.HIPDT_CALL_ACKTIME status,(SELECT INITCAP(d.HRGSTR_FNAME)||' '||INITCAP(d.HRGSTR_MNAME)||' '||INITCAP(d.HRGSTR_LNAME) FROM HRGT_PATIENT_DTL d WHERE a.HRGNUM_PUK=d.HRGNUM_PUK AND a.GNUM_ISVALID=d.GNUM_ISVALID AND a.GNUM_HOSPITAL_CODE=d.GNUM_HOSPITAL_CODE )AS patientName,a.HIPDSTR_CALL_REMARKS callRemarks, (SELECT e.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL e WHERE e.str_emp_no = a.PSRSTR_RAISEBYEMP_NO AND e.gnum_hospital_code = a.gnum_hospital_code) raiseByEmpNo  FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE  a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND a.psrstr_emp_no = UPPER(?) AND trunc(a.HIPDT_CALL_DATE)>=trunc(sysdate-1) and trunc(a.HIPDT_CALL_DATE)<=trunc(sysdate) ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE

SELECT_CALLACKNOWLEDGE_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT   TO_CHAR (a.hipdt_call_date, 'DD-Mon-yyyy')||' '||TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') calldate, TO_CHAR (a.hipdt_call_date, 'dd-mon-yyyy') calldateformat, TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') callraisetime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST  WHERE hipnum_ward_code = a.hipnum_ward_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= SYSDATE AND (TRUNC(NVL (gdt_effective_to, SYSDATE)) >=  TRUNC(SYSDATE))) wardcode, DECODE (a.hipnum_call_type, 1, 'Automatic',  2, 'Manual') calltype, DECODE (a.hipnum_call_priority,1, 'Low',2, 'Medium',3, 'High') callpriority, a.hrgnum_puk patcrno,UPPER (a.psrstr_emp_no) empno, a.hrgnum_call_no callno, a.hipdstr_doctor_remarks doctorRemarks,a.HIPDT_CALL_ACKTIME status,(SELECT INITCAP(d.HRGSTR_FNAME)||' '||INITCAP(d.HRGSTR_MNAME)||' '||INITCAP(d.HRGSTR_LNAME) FROM HRGT_PATIENT_DTL d WHERE a.HRGNUM_PUK=d.HRGNUM_PUK AND a.GNUM_ISVALID=d.GNUM_ISVALID AND a.GNUM_HOSPITAL_CODE=d.GNUM_HOSPITAL_CODE )AS patientName,a.HIPDSTR_CALL_REMARKS callRemarks, (SELECT e.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL e WHERE e.str_emp_no = a.PSRSTR_RAISEBYEMP_NO AND e.gnum_hospital_code = a.gnum_hospital_code) raiseByEmpNo,(select DECODE(hopnum_to_user_type,1,'Consultant',2,' Unit',null))receiver FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE  a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND a.psrstr_emp_no = UPPER(?) OR a.psrstr_emp_no IN(select hgnum_deptunitcode from hgbt_unit_consultant_mst where hgstr_emp_code=? and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1)AND trunc(a.HIPDT_CALL_DATE)>=trunc(sysdate-1) and trunc(a.HIPDT_CALL_DATE)<=trunc(sysdate) ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE


SELECT_ALL_CALLACKNOWLEDGE_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = SELECT   TO_CHAR (a.hipdt_call_date, 'DD-Mon-yyyy')||' '||TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') calldate, TO_CHAR (a.hipdt_call_date, 'dd-mon-yyyy') calldateformat, TO_CHAR (a.hipdt_call_raisetime, 'HH24:Mi') callraisetime, (SELECT hipstr_ward_name FROM HIPT_WARD_MST  WHERE hipnum_ward_code = a.hipnum_ward_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= SYSDATE AND (TRUNC(NVL (gdt_effective_to, SYSDATE)) >=  TRUNC(SYSDATE))) wardcode, DECODE (a.hipnum_call_type, 1, 'Automatic',  2, 'Manual') calltype, DECODE (a.hipnum_call_priority,1, 'Low',2, 'Medium',3, 'High') callpriority, a.hrgnum_puk patcrno,UPPER (a.psrstr_emp_no) empno, a.hrgnum_call_no callno, a.hipdstr_doctor_remarks doctorRemarks,a.HIPDT_CALL_ACKTIME status,(SELECT INITCAP(d.HRGSTR_FNAME)||' '||INITCAP(d.HRGSTR_MNAME)||' '||INITCAP(d.HRGSTR_LNAME) FROM HRGT_PATIENT_DTL d WHERE a.HRGNUM_PUK=d.HRGNUM_PUK AND a.GNUM_ISVALID=d.GNUM_ISVALID AND a.GNUM_HOSPITAL_CODE=d.GNUM_HOSPITAL_CODE )AS patientName,a.HIPDSTR_CALL_REMARKS callRemarks, (SELECT e.str_emp_full_name  FROM PIST_EMP_REGISTRATION_DTL e WHERE e.str_emp_no = a.PSRSTR_RAISEBYEMP_NO AND e.gnum_hospital_code = a.gnum_hospital_code) raiseByEmpNo FROM HIPD_DOCTOR_CALLBOOK_DTL a WHERE  a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND a.psrstr_emp_no = UPPER(?)  ORDER BY  a.HIPDT_CALL_ACKTIME DESC,a.HIPDT_CALL_DATE  

 																					
																	

UPDATE_ACKNOWLEDGE_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL = 	UPDATE HIPD_DOCTOR_CALLBOOK_DTL a SET a.HIPDSTR_DOCTOR_REMARKS=? , a.HIPDT_CALL_ACKTIME=sysdate, a.GNUM_ACCEPTSEAT_ID=? WHERE a.HRGNUM_CALL_NO=upper(?) AND a.PSRSTR_EMP_NO=? AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? 
#AND A.HIPDT_CALL_DATE = TO_DATE(?,'dd-Mon-yyyy')																					

																	

		
INSERT.HIPD_DOCTOR_WARDROUND_DTL= INSERT INTO HIPD_DOCTOR_WARDROUND_DTL (HIPDT_ROUND_DATE,HRGNUM_ROUND_NO,HIPNUM_WARD_CODE,HIPNUM_ROUND_TYPE,HIPDT_ROUND_OUTTIME,GNUM_ISVALID,HIPDT_ROUND_INTIME,HIPDT_NEXT_ROUND_DATE,GNUM_SEAT_ID,GDT_ENTRY_DATE,HIPNUM_ENTER_BY,PSRSTR_EMP_NO,GNUM_HOSPITAL_CODE,GSTR_IP_ADD) VALUES(to_date(?,'dd-Mon-yyyy'),(SELECT NVL(MAX(HRGNUM_ROUND_NO),0)+1 FROM HIPD_DOCTOR_WARDROUND_DTL WHERE trunc(HIPDT_ROUND_DATE)\=to_date(?,'dd-Mon-yyyy') AND HIPNUM_WARD_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?),?,?,to_date(?,'dd-mon-yyyy'),?,to_date(?,'dd-Mon-yyyy HH24MI'),to_date(?,'dd-Mon-yyyy HH24MI'),?,sysdate,?,?,?,?)

#INSERT.HBBT_TRANSFUSSION_DTL = insert into HBBT_TRANSFUSSION_DTL (HBNUM_REQ_NO,HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGDT_TRANSFUSSION_DATE,HRGNUM_S_NO,HRGNUM_ADMISSION_NO, HRGNUM_VISIT_NO,HBDT_TRANSFUSSION_ENDTIME,HBDT_TRANSFUSSION_STARTTIME,HBNUM_PHLEBOTOMY_ARM,HBSTR_BLDBAG_NO,GNUM_SEAT_ID, HBNUM_BLDBAG_SEQNO,GDT_ENTRY_DATE,GNUM_ISVALID,HBSTR_REMARKS,GNUM_HOSPITAL_CODE,PSRSTR_EMP_NO,HBNUM_QTY_TRANSFUSSED,HBNUM_TRANSFUSSION_RATE,HBNUM_TRANSFUSSION_STATUS) values(?,?,?,sysdate,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HBBT_TRANSFUSSION_DTL WHERE HBNUM_REQ_NO\= ? and to_date(HRGDT_TRANSFUSSION_DATE,'dd-Mon-yyyy')\=to_date(sysdate,'dd-Mon-yyyy') and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?),?,?,to_date(?,'dd-Mon-yyyy hh24\:mi'),to_date(?,'dd-mm-yyyy hh24\:mi'),?,?,?,?,sysdate,?,?,?,?,?,?,?)\t\t

INSERT.HBBT_TRANSFUSSION_DTL = insert into HBBT_TRANSFUSSION_DTL (HBNUM_REQ_NO,HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGDT_TRANSFUSSION_DATE,HRGNUM_S_NO,HRGNUM_ADMISSION_NO, HRGNUM_VISIT_NO,HBDT_TRANSFUSSION_ENDTIME,HBDT_TRANSFUSSION_STARTTIME,HBNUM_PHLEBOTOMY_ARM,HBSTR_BLDBAG_NO,GNUM_SEAT_ID, HBNUM_BLDBAG_SEQNO,GDT_ENTRY_DATE,GNUM_ISVALID,HBSTR_REMARKS,GNUM_HOSPITAL_CODE,PSRSTR_EMP_NO,HBNUM_QTY_TRANSFUSSED,HBNUM_TRANSFUSSION_RATE,HBNUM_TRANSFUSSION_STATUS) values(?,?,?,sysdate,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HBBT_TRANSFUSSION_DTL WHERE HBNUM_REQ_NO\= ? and to_char(HRGDT_TRANSFUSSION_DATE,'dd-Mon-yyyy')\=to_char(sysdate,'dd-Mon-yyyy') and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?),?,?,to_date(?,'dd-Mon-yyyy hh24\:mi'),to_date(?,'dd-mon-yyyy hh24\:mi'),?,?,?,?,sysdate,?,?,?,?,?,?,?)\t\t\t\t\t\t\t\t\t\t\t
									
UPDATE.STOCK_STATUS.HBBT_PAT_BLDSTOCK_DTL = update HBBT_PAT_BLDSTOCK_DTL set HBNUM_STOCK_STATUS\=?  where HRGNUM_PUK\=? and trunc(HRGDT_STOCK_DATE)\=trunc(to_date(?,'dd-mm-yyyy'))  and HRGNUM_SLNO\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t\t\t

									
UPDATE.IS_REACTION_STATUS.HRGT_EPISODE_DRUG_ADMIN_DTL = update HRGT_EPISODE_DRUG_ADMIN_DTL set HRGNUM_IS_REACTION\=? where HRGNUM_PUK\=? and trunc(HRGDT_ADVICE_DATE)\= TO_TIMESTAMP(?, 'dd - Mon - yyyy') and HRGNUM_S_NO\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t
														
SELECT.TEMPLAEiD_LIST.HGBT_TEMPLATE_MAPPING_MST = select HGNUM_TEMPLATE_ID from HGBT_TEMPLATE_MST  where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? \t
													
INSERT.HRGT_EPISODE_REACTION_PARA_DTL = insert into HRGT_EPISODE_REACTION_PARA_DTL (HRGNUM_PUK,HRGDT_RECORD_DATE,HRGNUM_S_NO,HRGNUM_PARA_SLNO,HGNUM_TEMPLATE_ID, HGSTR_PARA_VALUE,GNUM_ISVALID,GNUM_SEAT_ID,HGNUM_PARA_ID,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE) values(?,to_date(to_CHAR(sysdate,'dd-mm-yyyy'),'dd-mm-yyyy'),?,(select nvl(max(HRGNUM_PARA_SLNO),0)+1 from HRGT_EPISODE_REACTION_PARA_DTL where  trunc(HRGDT_RECORD_DATE)\=trunc(sysdate) and HRGNUM_PUK\=? and HRGNUM_S_NO\=?),?,?,?,?,?,sysdate,?) \t
										
#INSERT.HBBT_TRANSFUSSION_REACTION_DTL = insert into HBBT_TRANSFUSSION_REACTION_DTL(HBSTR_BLDBAG_NO,HBDT_RECORD_DATE,HBNUM_BLDBAG_SEQNO,HBNUM_REACTION_ID, HBDT_REACTION_STARTTIME,GNUM_SEAT_ID,HBDT_REACTION_ENDTIME,GDT_ENTRY_DATE,HBSTR_CONTROL_SUMMARY,HBNUM_TRANSFUSSION_STATUS, GNUM_ISVALID,HBNUM_REQ_NO,HBNUM_SAURCE_FLAG,HBSTR_REACTION_SUMMARY,GNUM_HOSPITAL_CODE,PSRSTR_EMP_NO) values(?,trunc(sysdate),?, ?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),sysdate,?,?,?,?,?,?,?,?)\t

INSERT.HBBT_TRANSFUSSION_REACTION_DTL = insert into HBBT_TRANSFUSSION_REACTION_DTL(HBSTR_BLDBAG_NO,HBDT_RECORD_DATE,HBNUM_BLDBAG_SEQNO,HBNUM_REACTION_ID, HBDT_REACTION_STARTTIME,GNUM_SEAT_ID,HBDT_REACTION_ENDTIME,GDT_ENTRY_DATE,HBSTR_CONTROL_SUMMARY,HBNUM_TRANSFUSSION_STATUS, GNUM_ISVALID,HBNUM_REQ_NO,HBNUM_SAURCE_FLAG,HBSTR_REACTION_SUMMARY,GNUM_HOSPITAL_CODE,PSRSTR_EMP_NO) values(?,trunc(sysdate),?, ?,to_date(?,'dd-mon-yyyy hh24\:mi'),?,to_date(?,'dd-mon-yyyy hh24\:mi'),sysdate,?,?,?,?,?,?,?,?)\t
										
INSERT.HBBT_TRANS_REACTION_PARA_DTL = insert into HBBT_TRANS_REACTION_PARA_DTL(HBDT_RECORD_DATE,HBNUM_REACTION_ID,HBNUM_PARA_SLNO,HGNUM_TEMPLATE_ID, HGSTR_PARA_VALUE,GNUM_ISVALID,GNUM_SEAT_ID,HGNUM_PARA_ID,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE) values(trunc(sysdate), ?,?,?,?,?,?,?,sysdate,?)\t
										
UPDATE.IS_REACTION_STATUS.HBBT_PAT_BLDSTOCK_DTL = update HBBT_PAT_BLDSTOCK_DTL set HBNUM_ISREACTION\=?  where HRGNUM_PUK\=? and trunc(HRGDT_STOCK_DATE)\=trunc(to_date(?,'dd-mm-yyyy'))  and HRGNUM_SLNO\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t
												
SELECT.TEMPLAEID_LIST_FOR_TRANSFUSION_REACTION.HGBT_TEMPLATE_MAPPING_MST = select HGNUM_TEMPLATE_ID from HGBT_TEMPLATE_MST  where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? \t\t\t\t\t\t\t\t\t\t
	
SELECT_MAXSLNO.HBBT_TRANSFUSSION_REACTION_DTL = select nvl(MAX (hbnum_reaction_id),0) from HBBT_TRANSFUSSION_REACTION_DTL  where  trunc(HBDT_RECORD_DATE)\=trunc(sysdate)  and GNUM_HOSPITAL_CODE\=?
												
SELECT_MAXSLNO.HRGT_EPISODE_DRUG_REACTION_DTL = select nvl(max(HRGNUM_S_NO),0) from HRGT_EPISODE_DRUG_REACTION_DTL where  trunc(HRGDT_RECORD_DATE)\=trunc(sysdate) and HRGNUM_PUK\=? and GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

SELECT.PAT_ANC_DETAIL.HANCT_ANC_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCSTR_ANC_NO AS ancNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HANCNUM_PARITY_NO AS parityNo, (SELECT A.HGNUM_DEPTUNITCODE FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnitCode, (SELECT (SELECT INITCAP(C.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST C WHERE C.GNUM_DEPT_CODE \= SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AND C.GNUM_HOSPITAL_CODE\=? AND C.GNUM_ISVALID\=? ) || ' (' || (SELECT INITCAP(D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE D.GNUM_HOSPITAL_CODE\=? AND D.HGNUM_DEPTUNITCODE \= A.HGNUM_DEPTUNITCODE AND D.GNUM_ISVALID \=?) || ')' FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnit, HANCNUM_ABORTUS_NO AS abortusNo, HRGNUM_ADMISSION_NO AS admissionNo, TO_CHAR(HANCDT_LMP,'dd-Mon-yyyy') AS lmpDate, HANCNUM_IS_ACTUAL_LMP AS isActualLMP, HANCNUM_MENSTRUAL_CYCLE_ID AS menstrualCycleId, TO_CHAR(HPMRDT_EDD,'dd-Mon-yyyy') AS expectedDeliveryDate, TO_CHAR(HPMRDT_ACTUAL_DD,'dd-Mon-yyyy') AS actualDeliveryDate, TO_CHAR(HANCDT_GESTATION_START_DATE,'dd-Mon-yyyy') AS gestationStartDate, DECODE(HANCDT_GESTATION_START_DATE,NULL,'',   CEIL (ahis_gbl_util.date_diff(SYSDATE,hancdt_gestation_start_date) / 7)) AS gestationperiod, HANCNUM_HIGHRISK_PREGNANCY AS isHighRiskPregnancy, HANCSTR_COMPLICATIONS AS complications, HANCNUM_DELIVERY_STATUS AS deliveryStatus, HPMRNUM_QUICKENING_WEEK AS quickeningWeek, HPMRSTR_QUICKENING_REMARKS AS quickeningRemarks, TO_CHAR(HPMRDT_BOOKING_DATE,'dd-Mon-yyyy') AS bookingDate, HANCNUM_BOOKING_STATUS AS bookingStatus, HANCNUM_MENSTRUAL_CYCLE_DAYS AS menstrualCycleDays, HANCNUM_ISCONTRACEPTIVE_USED AS isContraceptiveUsed, HANCSTR_CONTRACEPTIVE_REMARKS AS contraceptiveRemarks, HANCNUM_ANTID_GIVEN AS isAntiDGiven, TO_CHAR(HPMRDT_ULTRASOUND_EDD,'dd-Mon-yyyy') AS ultraSoundEDD FROM HANCT_ANC_DTL X WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_DELIVERY_STATUS IS NULL AND HANCNUM_GRAVIDA_NO IN (SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?)
										
SELECT.PAT_ANC_DETAIL_BY_EPISODE.HANCT_ANC_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCSTR_ANC_NO AS ancNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HANCNUM_PARITY_NO AS parityNo, (SELECT A.HGNUM_DEPTUNITCODE FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnitCode, (SELECT (SELECT INITCAP(C.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST C WHERE C.GNUM_DEPT_CODE \= SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AND SYSDATE BETWEEN C.GDT_EFFECTIVE_FRM AND NVL (C.GDT_EFFECTIVE_TO, SYSDATE) AND C.GNUM_HOSPITAL_CODE\=? AND C.GNUM_ISVALID\=? ) || ' (' || (SELECT INITCAP(D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE SYSDATE BETWEEN D.GDT_EFFECTIVE_FRM AND NVL (D.GDT_EFFECTIVE_TO, SYSDATE) AND D.GNUM_HOSPITAL_CODE\=? AND D.HGNUM_DEPTUNITCODE \= A.HGNUM_DEPTUNITCODE AND D.GNUM_ISVALID \=?) || ')' FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnit, HANCNUM_ABORTUS_NO AS abortusNo, HRGNUM_ADMISSION_NO AS admissionNo, TO_CHAR(HANCDT_LMP,'dd-Mon-yyyy') AS lmpDate, HANCNUM_IS_ACTUAL_LMP AS isActualLMP, HANCNUM_MENSTRUAL_CYCLE_ID AS menstrualCycleId, TO_CHAR(HPMRDT_EDD,'dd-Mon-yyyy') AS expectedDeliveryDate, TO_CHAR(HPMRDT_ACTUAL_DD,'dd-Mon-yyyy') AS actualDeliveryDate, TO_CHAR(HANCDT_GESTATION_START_DATE,'dd-Mon-yyyy') AS gestationStartDate, DECODE(HANCDT_GESTATION_START_DATE,NULL,'',CEIL((SYSDATE-HANCDT_GESTATION_START_DATE)/7)) AS gestationPeriod, HANCNUM_HIGHRISK_PREGNANCY AS isHighRiskPregnancy, HANCSTR_COMPLICATIONS AS complications, HANCNUM_DELIVERY_STATUS AS deliveryStatus, HPMRNUM_QUICKENING_WEEK AS quickeningWeek, HPMRSTR_QUICKENING_REMARKS AS quickeningRemarks, TO_CHAR(HPMRDT_BOOKING_DATE,'dd-Mon-yyyy') AS bookingDate, HANCNUM_BOOKING_STATUS AS bookingStatus, HANCNUM_MENSTRUAL_CYCLE_DAYS AS menstrualCycleDays, HANCNUM_ISCONTRACEPTIVE_USED AS isContraceptiveUsed, HANCSTR_CONTRACEPTIVE_REMARKS AS contraceptiveRemarks, HANCNUM_ANTID_GIVEN AS isAntiDGiven, TO_CHAR(HPMRDT_ULTRASOUND_EDD,'dd-Mon-yyyy') AS ultraSoundEDD FROM HANCT_ANC_DTL X WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_DELIVERY_STATUS IS NULL AND HANCNUM_GRAVIDA_NO IN (SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?)

SELECT.PAT_ANC_DETAIL_BY_GRAVIDA.HANCT_ANC_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCSTR_ANC_NO AS ancNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HANCNUM_PARITY_NO AS parityNo, (SELECT A.HGNUM_DEPTUNITCODE FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnitCode, (SELECT (SELECT INITCAP(C.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST C WHERE C.GNUM_DEPT_CODE \= SUBSTR (A.HGNUM_DEPTUNITCODE, 1, 3) AND C.GNUM_HOSPITAL_CODE\=? AND C.GNUM_ISVALID\=? ) || ' (' || (SELECT INITCAP(D.HGSTR_UNITNAME) FROM HGBT_UNIT_MST D WHERE  D.GNUM_HOSPITAL_CODE\=? AND D.HGNUM_DEPTUNITCODE \= A.HGNUM_DEPTUNITCODE AND D.GNUM_ISVALID \=?) || ')' FROM HRGT_EPISODE_DTL A WHERE A.HRGNUM_PUK\=X.HRGNUM_PUK AND A.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND A.GNUM_ISVALID\=? AND A.HRGNUM_VISIT_NO\=(SELECT MIN(B.HRGNUM_VISIT_NO) FROM HRGT_EPISODE_DTL B WHERE B.HRGNUM_PUK\=X.HRGNUM_PUK AND B.HRGNUM_EPISODE_CODE\=X.HRGNUM_EPISODE_CODE AND B.GNUM_ISVALID\=?)) AS episodeUnit, HANCNUM_ABORTUS_NO AS abortusNo, HRGNUM_ADMISSION_NO AS admissionNo, TO_CHAR(HANCDT_LMP,'dd-Mon-yyyy') AS lmpDate, HANCNUM_IS_ACTUAL_LMP AS isActualLMP, HANCNUM_MENSTRUAL_CYCLE_ID AS menstrualCycleId, TO_CHAR(HPMRDT_EDD,'dd-Mon-yyyy') AS expectedDeliveryDate, TO_CHAR(HPMRDT_ACTUAL_DD,'dd-Mon-yyyy') AS actualDeliveryDate, TO_CHAR(HANCDT_GESTATION_START_DATE,'dd-Mon-yyyy') AS gestationStartDate, DECODE(HANCDT_GESTATION_START_DATE,NULL,'',pkg_emr_view.getPatientGestationWeek(?,?,?)) AS gestationPeriod, HANCNUM_HIGHRISK_PREGNANCY AS isHighRiskPregnancy, HANCSTR_COMPLICATIONS AS complications, HANCNUM_DELIVERY_STATUS AS deliveryStatus, HPMRNUM_QUICKENING_WEEK AS quickeningWeek, HPMRSTR_QUICKENING_REMARKS AS quickeningRemarks, TO_CHAR(HPMRDT_BOOKING_DATE,'dd-Mon-yyyy') AS bookingDate, HANCNUM_BOOKING_STATUS AS bookingStatus, HANCNUM_MENSTRUAL_CYCLE_DAYS AS menstrualCycleDays, HANCNUM_ISCONTRACEPTIVE_USED AS isContraceptiveUsed, HANCSTR_CONTRACEPTIVE_REMARKS AS contraceptiveRemarks, HANCNUM_ANTID_GIVEN AS isAntiDGiven, TO_CHAR(HPMRDT_ULTRASOUND_EDD,'dd-Mon-yyyy') AS ultraSoundEDD FROM HANCT_ANC_DTL X WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_GRAVIDA_NO\=?

SELECT.BASIC_ANC_HIS_DETAIL.HANCT_ANC_DTL	=SELECT HANCNUM_GRAVIDA_NO+1 AS gravidaNo, HANCNUM_PARITY_NO AS parityNo, HANCNUM_ABORTUS_NO AS abortusNo FROM HANCT_ANC_HISTORY_DTL WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND HANCNUM_GRAVIDA_NO\=(SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_HISTORY_DTL WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=?)
												
INSERT.NEW_RECORD.HANCT_ANC_DTL	=INSERT INTO HANCT_ANC_DTL (HRGNUM_PUK, HRGNUM_S_NO, HANCSTR_ANC_NO, HANCNUM_GRAVIDA_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HANCNUM_PARITY_NO, HANCNUM_ABORTUS_NO, HRGNUM_ADMISSION_NO, HANCDT_LMP, HANCNUM_IS_ACTUAL_LMP, HANCNUM_MENSTRUAL_CYCLE_ID, HPMRDT_EDD, HANCDT_GESTATION_START_DATE, HANCNUM_GESTATION_PERIOD, HANCNUM_HIGHRISK_PREGNANCY, HANCSTR_COMPLICATIONS, HPMRNUM_QUICKENING_WEEK, HPMRSTR_QUICKENING_REMARKS, HANCNUM_MENSTRUAL_CYCLE_DAYS, HANCNUM_ISCONTRACEPTIVE_USED, HANCSTR_CONTRACEPTIVE_REMARKS, HANCNUM_ANTID_GIVEN, HPMRDT_ULTRASOUND_EDD, HANCNUM_DETECTION_METHOD, HANCDT_DETECTION_DATE, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_SEAT_ID, GNUM_ISVALID) VALUES (?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, TO_DATE(?,'dd-Mon-yyyy'), TO_DATE(?,'dd-Mon-yyyy'), ?, ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, TO_DATE(?,'dd-Mon-yyyy'), ?, SYSDATE, ?, ?, ?)

SELECT.ANC_HISTORY_DETAIL.HANCT_ANC_HISTORY_DTL	=SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_S_NO AS slNo, TO_CHAR(X.HANCDT_DELIVERY_DATE,'dd-mm-yyyy') AS deliveryDate, X.HANCNUM_DELIVERY_STATUS AS deliveryStatus, X.HANCNUM_PREGNANCY_DURATION AS pregnancyDuration, X.HANCSTR_PREGNANCY_REMARKS AS pregnancyRemarks, X.HANCNUM_DELIVERY_PLACE_ID AS deliveryPlaceId, DECODE(X.HANCNUM_DELIVERY_PLACE_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_DELIVERY_PLACE) FROM HANCT_DELIVERY_PLACE_MST A WHERE A.HANCNUM_DELIVERY_PLACE_ID\=X.HANCNUM_DELIVERY_PLACE_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS deliveryPlace, X.HANCNUM_LABOUR_DURATION AS labourDuration, X.HANCSTR_LABOUR_REMARKS AS labourRemarks, X.HANCSTR_ANC_NO AS ancNo, X.HANCNUM_GRAVIDA_NO AS gravidaNo, X.HANCNUM_PARITY_NO AS parityNo, X.HANCNUM_ABORTUS_NO AS abortusNo, X.HANCNUM_DELIVERY_TYPE_ID AS deliveryTypeId, DECODE(X.HANCNUM_DELIVERY_TYPE_ID,NULL,'',(SELECT INITCAP(C.HANCSTR_DELIVERY_TYPE) FROM HANCT_DELIVERY_TYPE_MST C WHERE C.HANCNUM_DELIVERY_TYPE_ID\=X.HANCNUM_DELIVERY_TYPE_ID AND C.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND C.GNUM_ISVALID\=?)) AS deliveryType, X.HANCNUM_ANTID_GIVEN AS isAntiDGiven FROM HANCT_ANC_HISTORY_DTL X WHERE X.HRGNUM_PUK\=? AND X.GNUM_ISVALID\=? ORDER BY X.HANCNUM_GRAVIDA_NO

INSERT.NEW_RECORD.HANCT_ANC_HISTORY_DTL	=INSERT INTO HANCT_ANC_HISTORY_DTL (HRGNUM_PUK, HRGNUM_S_NO, HANCDT_DELIVERY_DATE, HANCNUM_DELIVERY_STATUS, HANCNUM_PREGNANCY_DURATION, HANCSTR_PREGNANCY_REMARKS, HANCNUM_DELIVERY_PLACE_ID, HANCNUM_LABOUR_DURATION, HANCSTR_LABOUR_REMARKS, HANCSTR_ANC_NO, HANCNUM_GRAVIDA_NO, HANCNUM_PARITY_NO, HANCNUM_ABORTUS_NO, HANCNUM_DELIVERY_TYPE_ID, HANCNUM_ANTID_GIVEN, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HANCNUM_ENTRY_MODE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES (?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_HISTORY_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), TO_DATE(?,'dd-mm-yyyy'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE,?)

INSERT.NEW_RECORD.HANCT_ANC_VISIT_DTL	=INSERT INTO HANCT_ANC_VISIT_DTL (HRGNUM_PUK, HRGNUM_S_NO, HANCSTR_ANC_NO, HANCNUM_GRAVIDA_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HANCNUM_GESTATION_PERIOD, HANCNUM_HIGHRISK_PREGNANCY, HANCSTR_COMPLICATIONS, HPMRNUM_QUICKENING_WEEK, HPMRSTR_QUICKENING_REMARKS, HANCSTR_REMARKS, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_SEAT_ID, GNUM_ISVALID) VALUES (?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_VISIT_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?)

SELECT.ANC_HISTORY_DELIVERY_DETAIL.HANCT_ANC_HISTORY_DELIVERY_DTL	=SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_S_NO AS slNo, X.HBNUM_BABY_BLDGRP_CODE AS babyBloodGroupCode, DECODE(X.HBNUM_BABY_BLDGRP_CODE,NULL,'',(SELECT E.HBSTR_BLDGRP FROM HBBT_BLDGRP_MST E WHERE E.HBNUM_BLDGRP_CODE\=X.HBNUM_BABY_BLDGRP_CODE AND E.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND E.GNUM_ISVALID\=?)) AS babyBloodGroup, X.GNUM_GENDER_CODE AS genderCode, DECODE(X.GNUM_GENDER_CODE,NULL,'',(SELECT INITCAP(F.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST F WHERE F.GNUM_ISVALID\=? and f.gstr_gender_code \=x.GNUM_GENDER_CODE)) AS gender, HRGNUM_CHILD_PUK AS childCrNo, X.HANCNUM_BIRTH_NATURE_ID AS birthNatureId, X.HANCSTR_WEIGHT AS weight, X.HANCSTR_DEATH_CAUSE AS deathCause, X.HANCSTR_DEATH_AGE AS deathAge, X.HANCSTR_PRESENT_HEALTH AS presentHealth, X.HANCNUM_GRAVIDA_NO AS gravidaNo FROM HANCT_ANC_HISTORY_DELIVERY_DTL X WHERE X.HRGNUM_PUK\=? AND X.GNUM_ISVALID\=? ORDER BY X.HANCNUM_GRAVIDA_NO

INSERT.LOG_RECORD.HANCT_ANC_LOG_DTL	=INSERT INTO HANCT_ANC_LOG_DTL (HRGNUM_PUK, HRGNUM_S_NO, HANCSTR_ANC_NO, HANCNUM_GRAVIDA_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HANCNUM_PARITY_NO, HANCNUM_ABORTUS_NO, HRGNUM_ADMISSION_NO, HANCDT_LMP, HANCNUM_IS_ACTUAL_LMP, HANCNUM_MENSTRUAL_CYCLE_ID, HPMRDT_EDD, HANCNUM_MENSTRUAL_CYCLE_DAYS, HPMRDT_ACTUAL_DD, HPMRDT_ULTRASOUND_EDD, HANCDT_GESTATION_START_DATE, HANCNUM_GESTATION_PERIOD, HANCNUM_HIGHRISK_PREGNANCY, HANCSTR_COMPLICATIONS, HANCNUM_DELIVERY_STATUS, HANCNUM_ISCONTRACEPTIVE_USED, HPMRNUM_QUICKENING_WEEK, HANCSTR_CONTRACEPTIVE_REMARKS, HANCNUM_ANTID_GIVEN, HPMRSTR_QUICKENING_REMARKS, HANCDT_DETECTION_DATE, HANCNUM_DETECTION_METHOD, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_SEAT_ID, GNUM_ISVALID) VALUES (?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_LOG_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=?), ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, TO_DATE(?,'dd-Mon-yyyy'), TO_DATE(?,'dd-Mon-yyyy'), TO_DATE(?,'dd-Mon-yyyy'), ?, ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, SYSDATE, ?, ?, ?)

UPDATE.RECORD.HANCT_ANC_DTL	=UPDATE HANCT_ANC_DTL SET HANCDT_LMP\=TO_DATE(?,'dd-Mon-yyyy'), HANCNUM_MENSTRUAL_CYCLE_ID\=?, HPMRDT_EDD\=TO_DATE(?,'dd-Mon-yyyy'), HPMRDT_ACTUAL_DD\=TO_DATE(?,'dd-Mon-yyyy'), HANCDT_GESTATION_START_DATE\=TO_DATE(?,'dd-Mon-yyyy'),HANCNUM_GESTATION_PERIOD\=?, HANCNUM_HIGHRISK_PREGNANCY\=?, HANCSTR_COMPLICATIONS\=?, HANCNUM_DELIVERY_STATUS\=?, HPMRNUM_QUICKENING_WEEK\=?, HPMRSTR_QUICKENING_REMARKS\=?, HANCNUM_MENSTRUAL_CYCLE_DAYS\=?, HANCNUM_ISCONTRACEPTIVE_USED\=?, HANCSTR_CONTRACEPTIVE_REMARKS\=?, HANCNUM_ANTID_GIVEN\=?, HPMRDT_ULTRASOUND_EDD\=TO_DATE(?,'dd-Mon-yyyy'), HANCNUM_DETECTION_METHOD\=?, HANCDT_DETECTION_DATE\=TO_DATE(?,'dd-Mon-yyyy'), GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=?
								
UPDATE.HISTORY_RECORD.HANCT_ANC_HISTORY_DTL	=UPDATE HANCT_ANC_HISTORY_DTL SET HANCDT_DELIVERY_DATE\=TO_DATE(?,'dd-mm-yyyy'), HANCNUM_PREGNANCY_DURATION\=?, HANCSTR_PREGNANCY_REMARKS\=?, HANCNUM_DELIVERY_PLACE_ID\=?, HANCNUM_LABOUR_DURATION\=?, HANCSTR_LABOUR_REMARKS\=?, HANCNUM_DELIVERY_TYPE_ID\=?, HANCNUM_ANTID_GIVEN\=?, GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=?
												
INSERT.NEW_RECORD.HANCT_ANC_HISTORY_DELIVERY_DTL	=INSERT INTO HANCT_ANC_HISTORY_DELIVERY_DTL (HRGNUM_PUK, HANCNUM_GRAVIDA_NO, HRGNUM_S_NO, HBNUM_BABY_BLDGRP_CODE, GNUM_GENDER_CODE, HRGNUM_CHILD_PUK, HANCNUM_BIRTH_NATURE_ID, HANCSTR_WEIGHT, HANCSTR_DEATH_CAUSE, HANCSTR_DEATH_AGE, HANCSTR_PRESENT_HEALTH, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES (?, ?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_HISTORY_DELIVERY_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE,?)
											
UPDATE.HISTORY_DELIVERY_RECORD.HANCT_ANC_HISTORY_DELIVERY_DTL	=UPDATE HANCT_ANC_HISTORY_DELIVERY_DTL SET HBNUM_BABY_BLDGRP_CODE\=?, GNUM_GENDER_CODE\=?, HRGNUM_CHILD_PUK\=?, HANCSTR_WEIGHT\=?, HANCSTR_DEATH_CAUSE\=?, HANCSTR_DEATH_AGE\=?, HANCSTR_PRESENT_HEALTH\=?, GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=?\t\t\t\t\t\t\t\t\t\t\t

SELECT.VISIT_DTL.HANCT_ANC_VISIT_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCSTR_ANC_NO AS ancNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo, HANCNUM_GESTATION_PERIOD AS gestationPeriod, HANCNUM_HIGHRISK_PREGNANCY AS isHighRiskPregnancy, HANCSTR_COMPLICATIONS AS complications, HPMRNUM_QUICKENING_WEEK AS quickeningWeek, HPMRSTR_QUICKENING_REMARKS AS quickeningRemarks, HANCSTR_REMARKS AS remarks FROM HANCT_ANC_VISIT_DTL X WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?  \t\t\t\t\t\t\t\t\t\t\t\t

INSERT.NEW_RECORD.HANCT_ANC_DELIVERY_DTL	=INSERT INTO HANCT_ANC_DELIVERY_DTL (HRGNUM_PUK, HRGNUM_S_NO, HANCDT_DELIVERY_DATE, HANCNUM_DELIVERY_STATUS, HANCNUM_PREGNANCY_DURATION, HANCSTR_PREGNANCY_REMARKS, HANCNUM_DELIVERY_PLACE_ID, HANCNUM_LABOUR_DURATION, HANCSTR_LABOUR_REMARKS, HANCNUM_LABORROOM_AREA_ID, HANCNUM_GRAVIDA_NO, HANCNUM_DELIVERY_TYPE_ID, HANCNUM_ISINDUCED, HANCSTR_INDUCTION_INDICATION, HANCNUM_INDUCTION_METHOD_ID, HANCNUM_PLACENTA_REMOVAL_METHO, HRGNUM_EPISODE_CODE, HANCNUM_PLACENTA_WEIGHT, HRGNUM_VISIT_NO, HANCNUM_PLACENTA_TYPE_ID, HRGNUM_ADMISSION_NO, HANCSTR_PLACENTA_MORPHOLOGY, HANCSTR_PLACENTA_HISTOPATH, HANCNUM_RUPTURE_TYPE, HANCNUM_RUPTURE_DURATION, HANCNUM_FOETAL_DISTRESS, HANCDT_RUPTURE_DATETIME, HANCNUM_STAGE1_DURATION, HANCNUM_STAGE2_DURATION, HANCNUM_STAGE3_DURATION, HANCSTR_STAGE1_REMARKS, HANCSTR_STAGE2_REMARKS, HANCSTR_STAGE3_REMARKS, HANCNUM_COMPLICATION_ID, HANCSTR_COMPLICATION_REMARKS, HANCNUM_IS_EAS, HANCSTR_DOC_ID, HANCSTR_DELIVERY_INDICATION_RE, HANCNUM_MOTHER_STATUS, HANCNUM_DEATH_CAUSE, HRGSTR_IP_ADD, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_SEAT_ID, GNUM_ISVALID) VALUES (?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_DELIVERY_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), TO_DATE(?,'dd-Mon-yyyy'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?,'dd-Mon-yyyy hh24\:mi'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?)\t\t\t\t\t\t\t\t\t\t

SELECT.ANC_HISTORY_DETAIL_BY_GRAVIDA.HANCT_ANC_HISTORY_DTL	=SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_S_NO AS slNo, TO_CHAR(X.HANCDT_DELIVERY_DATE,'dd-mm-yyyy') AS deliveryDate, X.HANCNUM_DELIVERY_STATUS AS deliveryStatus, X.HANCNUM_PREGNANCY_DURATION AS pregnancyDuration, X.HANCSTR_PREGNANCY_REMARKS AS pregnancyRemarks, X.HANCNUM_DELIVERY_PLACE_ID AS deliveryPlaceId, DECODE(X.HANCNUM_DELIVERY_PLACE_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_DELIVERY_PLACE) FROM HANCT_DELIVERY_PLACE_MST A WHERE A.HANCNUM_DELIVERY_PLACE_ID\=X.HANCNUM_DELIVERY_PLACE_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS deliveryPlace, X.HANCNUM_LABOUR_DURATION AS labourDuration, X.HANCSTR_LABOUR_REMARKS AS labourRemarks, X.HANCSTR_ANC_NO AS ancNo, X.HANCNUM_GRAVIDA_NO AS gravidaNo, X.HANCNUM_PARITY_NO AS parityNo, X.HANCNUM_ABORTUS_NO AS abortusNo, X.HANCNUM_DELIVERY_TYPE_ID AS deliveryTypeId, DECODE(X.HANCNUM_DELIVERY_TYPE_ID,NULL,'',(SELECT INITCAP(C.HANCSTR_DELIVERY_TYPE) FROM HANCT_DELIVERY_TYPE_MST C WHERE C.HANCNUM_DELIVERY_TYPE_ID\=X.HANCNUM_DELIVERY_TYPE_ID AND C.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND C.GNUM_ISVALID\=?)) AS deliveryType, X.HANCNUM_ANTID_GIVEN AS isAntiDGiven FROM HANCT_ANC_HISTORY_DTL X WHERE X.HRGNUM_PUK\=? AND X.HANCNUM_GRAVIDA_NO\=? AND X.GNUM_ISVALID\=? ORDER BY X.HANCNUM_GRAVIDA_NO

SELECT.ANC_HISTORY_DELIVERY_DETAIL_BY_GRAVIDA.HANCT_ANC_HISTORY_DELIVERY_DTL	=	SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_S_NO AS slNo, X.HBNUM_BABY_BLDGRP_CODE AS babyBloodGroupCode, DECODE(X.HBNUM_BABY_BLDGRP_CODE,NULL,'',(SELECT E.HBSTR_BLDGRP FROM HBBT_BLDGRP_MST E WHERE E.HBNUM_BLDGRP_CODE=X.HBNUM_BABY_BLDGRP_CODE AND E.GNUM_HOSPITAL_CODE=X.GNUM_HOSPITAL_CODE AND E.GNUM_ISVALID=?)) AS babyBloodGroup, X.GNUM_GENDER_CODE AS genderCode, DECODE(X.GNUM_GENDER_CODE,NULL,'',(SELECT INITCAP(F.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST F WHERE F.gstr_GENDER_CODE=X.GNUM_GENDER_CODE  AND F.GNUM_ISVALID=?)) AS gender, HRGNUM_CHILD_PUK AS childCrNo, X.HANCNUM_BIRTH_NATURE_ID AS birthNatureId, X.HANCSTR_WEIGHT AS weight, X.HANCSTR_DEATH_CAUSE AS deathCause, X.HANCSTR_DEATH_AGE AS deathAge, X.HANCSTR_PRESENT_HEALTH AS presentHealth, X.HANCNUM_GRAVIDA_NO AS gravidaNo FROM HANCT_ANC_HISTORY_DELIVERY_DTL X WHERE X.HRGNUM_PUK=? AND X.HANCNUM_GRAVIDA_NO=? AND X.GNUM_ISVALID=? ORDER BY X.HANCNUM_GRAVIDA_NO

INSERT.INITIAL_RECORD.HANCT_NEWNATAL_DTL	=INSERT INTO HANCT_NEWNATAL_DTL (HRGNUM_PUK, HANCNUM_GRAVIDA_NO, HRGNUM_S_NO, HBNUM_BABY_BLDGRP_CODE, GNUM_GENDER_CODE, HANCDT_BIRTH_DATETIME, HANCNUM_BIRTH_NATURE_ID, HANCSTR_WEIGHT, HANCSTR_DEATH_STILLBIRTH_CAUSE, HANCSTR_DEATH_AGE, HANCSTR_PRESENT_HEALTH, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES (?, ?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_NEWNATAL_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=?), ?, ?, TO_DATE(?,'dd-mm-yyyy hh24\:mi'), ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE,?)\t\t\t\t\t\t\t\t\t
								
SELECT_NO_OF_VISIT.HRGT_DAILY_PATIENT_DTL=	SELECT COUNT(*) FROM HRGT_DAILY_PATIENT_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND trunc(GDT_ENTRY_DATE)=trunc(sysdate)		
			
SELECT_DELIVERYSTATUS.HANCT_ANC_DTL=   SELECT HANCNUM_DELIVERY_STATUS FROM HANCT_ANC_DTL A WHERE HRGNUM_PUK=? AND HANCNUM_GRAVIDA_NO=(SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL WHERE HRGNUM_PUK=A.HRGNUM_PUK AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?
			
SELECT_COMPARE_GESTATION_DATE = SELECT DECODE(SIGN((SELECT TRUNC((SYSDATE -(SELECT HANCDT_GESTATION_START_DATE FROM HANCT_ANC_DTL A WHERE HRGNUM_PUK\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND HANCNUM_GRAVIDA_NO\=(SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL WHERE HRGNUM_PUK\=A.HRGNUM_PUK AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)))) AS DAYS FROM DUAL) -(SELECT HANCNUM_REGISTER_UPTO FROM HANCT_JSY_RULE_MST WHERE HANCNUM_TREATMENT_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?)),-1,1,0) AS FLAG FROM DUAL
			
SELECT_ANC_DETAIL.HANCT_ANC_DTL= SELECT HANCNUM_IS_JSY as jsyFlag,HANCNUM_GRAVIDA_NO as gravidaNo,HANCSTR_ANC_NO as ancNo,to_char(HPMRDT_EDD,'dd-Mon-yyyy') as expectedDeliveryDate,HRGNUM_EPISODE_CODE as episodeCode,HRGNUM_VISIT_NO as episodeVisitNo, (SELECT COUNT(*) FROM HANCT_ANC_HISTORY_DELIVERY_DTL WHERE HRGNUM_PUK\=A.HRGNUM_PUK AND HANCNUM_BIRTH_NATURE_ID\=? AND GNUM_ISVALID\=?) AS liveBirthCount, pkg_emr_view.getPatientGestationWeek(?,?,?) AS gestationPeriod FROM HANCT_ANC_DTL A WHERE GNUM_ISVALID\=? AND HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=(SELECT MAX(HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL WHERE HRGNUM_PUK\=A.HRGNUM_PUK AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE) AND HANCNUM_DELIVERY_STATUS is null
			
			
SELECT_PATIENTDETAIL.HRGT_PATIENT_DTL=SELECT HRGNUM_IS_URBAN as patIsUrban,(SELECT GSTR_CASTE_NAME FROM gblt_caste_mst WHERE  GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND gstr_caste_code\=A.gstr_caste_code) as patCasteName FROM HRGT_PATIENT_DTL A WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=?
			
			
SELECT_JSYRULE.HANCT_JSY_RULE_MST=SELECT HANCNUM_MIN_AGE AS minimumAge,HANCNUM_MAX_AGE AS maximumAge,HANCNUM_LIVEBIRTH_UPTO AS liveBirthUpto,HANCNUM_PRIMARY_CAT_CODE AS primaryCategoryCode,HANCNUM_IS_CASTEBOUND AS isCasteBound,HANCSTR_CASTE_ID AS casteId,HANCNUM_REGISTER_UPTO as registrationUpto, (SELECT GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE\=A.HANCNUM_PRIMARY_CAT_CODE AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?) AS primaryCategoryName,HANCNUM_TREATMENT_CAT_VALIDITY AS treatmentCatValidity FROM HANCT_JSY_RULE_MST A WHERE HANCNUM_TREATMENT_TYPE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?
			
			
INSERTINTO.HANCT_JSY_REGISTRATION_DTL=	INSERT INTO HANCT_JSY_REGISTRATION_DTL(HRGNUM_PUK,HANCSTR_ANC_NO,HANCNUM_GRAVIDA_NO,HRGNUM_EPISODE_CODE,HANCNUM_REGISTRATION_AGE,HRGNUM_VISIT_NO,HANCNUM_LIVEBIRTH_COUNT,HANCNUM_AREA_TYPE,HANCNUM_IS_BROUGHTBY_ASHA, \
                                        HANCNUM_HEALTH_WORKER_ID,HANCSTR_HEALTH_WORKER_NAME,HANCSTR_HEALTH_WORKER_CARDNO,HANCSTR_ADDRESS,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GDT_ENTRY_DATE,HRGSTR_IP_ADD) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
			
	
UPDATE_JSYCASTE_AREATYPE.HRGT_PATIENT_DTL= 	UPDATE HRGT_PATIENT_DTL SET HRGNUM_IS_URBAN=?, NUM_CASTE_ID=? WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?
	
UPDATE_TREATEMENT_CAT.HRGT_EPISODE_DTL=	 UPDATE HRGT_EPISODE_DTL SET HGNUM_TREATMENT_CAT_CODE=? WHERE HRGNUM_PUK=? AND HRGNUM_EPISODE_CODE=? AND HRGNUM_VISIT_NO=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?  
	

UPDATE_JSY_FLAG.HANCT_ANC_DTL =  UPDATE HANCT_ANC_DTL SET HANCNUM_IS_JSY=? WHERE HRGNUM_PUK=? AND HANCNUM_GRAVIDA_NO=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?	


SELECT.LAST_DEL_NEW_NATS.HANCT_NEWNATAL_DTL	=SELECT X.HRGNUM_PUK AS patCrNo, X.HANCNUM_GRAVIDA_NO AS gravidaNo, X.HRGNUM_S_NO AS slNo, X.HBNUM_BABY_BLDGRP_CODE AS babyBloodGroupCode, DECODE(X.HBNUM_BABY_BLDGRP_CODE,NULL,'',(SELECT A.HBSTR_BLDGRP FROM HBBT_BLDGRP_MST A WHERE A.HBNUM_BLDGRP_CODE\=X.HBNUM_BABY_BLDGRP_CODE AND A.GNUM_HOSPITAL_CODE\=GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS babyBloodGroup, X.GNUM_GENDER_CODE AS genderCode, DECODE(X.GNUM_GENDER_CODE,NULL,'',(SELECT INITCAP(B.GSTR_GENDER_NAME) FROM GBLT_GENDER_MST B WHERE B.GSTR_GENDER_CODE\=X.GNUM_GENDER_CODE AND B.GNUM_ISVALID\=?)) AS gender, X.HRGNUM_CHILD_PUK AS childCrNo, TO_CHAR(X.HANCDT_BIRTH_DATETIME,'dd-Mon-yyyy HH24\:MI') AS birthDateTime, X.HANCNUM_BIRTH_NATURE_ID AS birthNatureId, X.HANCSTR_WEIGHT AS weight, X.HANCSTR_DEATH_STILLBIRTH_CAUSE AS deathStillBirthCause, X.HANCSTR_DEATH_AGE AS deathAge, X.HRGNUM_CHILD_ADMNO AS childAdmissionNo, X.HANCSTR_PEAD_ID AS peaditricianEmpId, X.HANCSTR_PRESENT_HEALTH AS presentHealth, X.HANCNUM_LENGTH AS babylength, X.HANCNUM_IS_ANOMALY AS isAnomolyPresent, X.HANCSTR_ANOMALY_REMARKS AS anomolyRemarks, X.HANCNUM_UNBILICAL_ARTERIS AS umbilicalArteries, X.HANCNUM_TRANSFER_TO AS transferToFlag, X.HANCNUM_FOOT_PRINT AS isFootPrintTaken, X.HANCNUM_LIQUOR_APPEARANCE AS liquorAppearance, X.HANCNUM_CORDBLD_SAMPLE AS isCordBloodSampleTaken, X.HANCNUM_HEAD_CIRCUMFERENCE AS headCircumferences, X.HANCDT_CRY_DATETIME AS cryDateTime, X.HANCDT_URINE_DATETIME AS urineDateTime, X.HANCDT_MOTHER_FEEDTIME AS motherFeedDateTime, X.HANCDT_FEED_DATETIME AS feedDateTime, X.HANCNUM_ISBIRTH_TRAUMA AS isBirthTrauma, X.HANCSTR_BIRTH_TRAUMA_REMARKS AS birthTraumaRemarks, X.HANCNUM_TRAUMA_CAUSE_ID AS traumaCauseId, DECODE(X.HANCNUM_TRAUMA_CAUSE_ID,NULL,'',(SELECT C.HANCSTR_COMPLICATION FROM HANCT_COMPLICATION_MST C WHERE C.HANCNUM_COMPLICATION_ID\=X.HANCNUM_TRAUMA_CAUSE_ID AND C.GNUM_HOSPITAL_CODE\=GNUM_HOSPITAL_CODE AND C.GNUM_ISVALID\=?)) AS trumaCause, X.HANCNUM_STILLBIRTH_DETECTION AS whenStillBirthDetection, X.HANCNUM_ANOMALY_TYPE_ID AS anomolyTypeId, DECODE(X.HANCNUM_ANOMALY_TYPE_ID,NULL,'',(SELECT INITCAP(D.HANCSTR_ANOMALY_TYPE) FROM HANCT_ANOMALY_TYPE_MST D WHERE D.HANCNUM_ANOMALY_TYPE_ID\=X.HANCNUM_ANOMALY_TYPE_ID AND D.GNUM_HOSPITAL_CODE\=GNUM_HOSPITAL_CODE AND D.GNUM_ISVALID\=?)) AS anomolyType FROM HANCT_NEWNATAL_DTL X WHERE X.HRGNUM_PUK\=? AND X.HANCNUM_GRAVIDA_NO\=(SELECT MAX(Y.HANCNUM_GRAVIDA_NO) FROM HANCT_NEWNATAL_DTL Y WHERE Y.HRGNUM_PUK\=X.HRGNUM_PUK AND Y.GNUM_ISVALID\=X.GNUM_ISVALID) AND X.GNUM_ISVALID\=?\t

GET_IN_OUT_TAKE_VIEW_SUMMARY.HIPD_PAT_INTAKEOUT_DTL = SELECT TO_CHAR(A.HIPDT_INTAKEOUT_TIME,'dd-Mon-yyyy HH24\:MI') as inTakeOutTime, DECODE(HIPNUM_ENTRY_MODE,1,NVL((SELECT hipstr_route_name FROM HIPD_INTAKEOUT_ROUTE_MST WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND hipnum_route_id \= a.hipnum_route_id),'-'), 2,(DECODE(a.hipnum_route_id,1,'Phlebotomy Left Arm',2,'Phlebotomy Right Arm')), 0,NVL((SELECT HGSTR_DRUG_ROUTE_NAME FROM HGBT_DRUG_ROUTE_MST WHERE gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND HGNUM_DRUG_ROUTE_ID \= a.hipnum_route_id),'-'))AS routeName, A.HIPSTR_VOLUME as volume, A.HIPSTR_INTAKEOUT_PARA_NAME as inTakeOutParaName, A.HIPNUM_INTAKEOUT_MODE as inTakeOutMode FROM HIPD_PAT_INTAKEOUT_DTL A WHERE A.HRGNUM_ADMISSION_NO \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HIPDT_INTAKEOUT_TIME >\= TO_DATE(?,'dd-Mon-yyyy') AND A.HIPDT_INTAKEOUT_TIME <\= TRUNC(TO_DATE(?,'dd-Mon-yyyy')+1) ORDER BY inTakeOutTime DESC, inTakeOutParaName



	

SELECT_RECORD_IN_ANC.HANCT_ANC_DTL= SELECT HRGNUM_PUK FROM HANCT_ANC_DTL WHERE HRGNUM_PUK=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?	


SELECT_ONCALL_DETAILS.HIPD_DOCTOR_CALLBOOK_DTL=  	SELECT TO_CHAR(a.HIPDT_CALL_DATE,'DD-Mon-yyyy') as  callDate,TO_CHAR(a.HIPDT_CALL_RAISETIME,'HH24:Mi') as callRaiseTime,HRGNUM_PUK as patCrNo,HRGNUM_ADMISSION_NO as patAdmnNo,UPPER(a.PSRSTR_EMP_NO) as empNo,a.HRGNUM_CALL_NO as callNo,(SELECT HRGSTR_FNAME||' '|| HRGSTR_MNAME||' '||HRGSTR_LNAME FROM HRGT_PATIENT_DTL  WHERE HRGNUM_PUK=A.HRGNUM_PUK AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=?) as patientName FROM HIPD_DOCTOR_CALLBOOK_DTL A WHERE a.PSRSTR_EMP_NO=? AND a.HIPNUM_WARD_CODE=? and HRGNUM_ROUND_NO is null  AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID = ? and (a.HIPDT_CALL_DATE=TO_CHAR (SYSDATE, 'DD-MM-YY') OR a.HIPDT_CALL_DATE=(TO_CHAR ((SYSDATE-1), 'DD-MM-YY')) )   order by a.HIPDT_CALL_DATE desc


	
UPDATE_ROUND_NO.HIPD_DOCTOR_CALLBOOK_DTL=      	UPDATE HIPD_DOCTOR_CALLBOOK_DTL SET HIPDT_ROUND_DATE=to_date(?,'dd-mm-yyyy'), HRGNUM_ROUND_NO=(SELECT nvl(MAX (HRGNUM_ROUND_NO),1) FROM HIPD_DOCTOR_WARDROUND_DTL WHERE HIPNUM_WARD_CODE=? AND trunc(HIPDT_ROUND_DATE)=trunc(to_date(?,'dd-mm-yyyy')) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?) WHERE PSRSTR_EMP_NO=? AND HRGNUM_CALL_NO=? AND trunc(HIPDT_CALL_DATE)=trunc(to_date(?,'dd-mm-yyyy')) AND GNUM_HOSPITAL_CODE=?  AND GNUM_ISVALID=?


SELECT_DRUG_STATUS.HRGT_EPISODE_DRUG_ADMIN_DTL = select count(*) from HRGT_EPISODE_DRUG_ADMIN_DTL where HRGNUM_PUK\=? and HSTNUM_ITEM_ID\=? and HRGDT_SCHEDULE_DATE\=to_date(?,'dd-Mon-yyyy') and HGSTR_DOSE_TIME\=? and HRGNUM_ADMIN_FLAG in(?,?,?) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?
								


SELECT_HEALTHWORKER_DETAIL.HANCT_HEALTH_WORKER_DTL=  SELECT HANCNUM_HEALTH_WORKER_ID AS healthWorkerID,HANCSTR_HEALTH_WORKER_NAME AS healthWorkerName,HANCSTR_HEALTH_WORKER_CARDNO AS healthWorkerCardNo,HANCSTR_ADDRESS AS healthWorkerAddress FROM HANCT_HEALTH_WORKER_DTL A GROUP BY healthWorkerID,healthWorkerName,healthWorkerCardNo,healthWorkerAddress,HRGNUM_PUK,HANCDT_VISIT_DATE,HANCNUM_SLNO HAVING HRGNUM_PUK=? AND TO_CHAR(HANCDT_VISIT_DATE,'DD-MM-YYYY')=TO_CHAR(SYSDATE,'DD-MM-YYYY') AND HANCNUM_SLNO=(SELECT MAX(A.HANCNUM_SLNO)  FROM HANCT_HEALTH_WORKER_DTL WHERE HRGNUM_PUK=A.HRGNUM_PUK AND TO_CHAR(HANCDT_VISIT_DATE,'DD-MM-YYYY')=TO_CHAR(SYSDATE,'DD-MM-YYYY') AND GNUM_ISVALID=A.GNUM_ISVALID) AND GNUM_ISVALID=?


 

UPDATE_SEC_CATAGORY.HRGT_SECCAT_CHANGE_DTL= UPDATE HRGT_SECCAT_CHANGE_DTL A SET HRGNUM_PREV_TREATMENT_CAT_CODE\=? AND HRGNUM_NEW_TREATMENT_CAT_CODE\=? AND HRGDT_VALID_UPTO\=? WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_S_NO\=(SELECT MAX(HRGNUM_S_NO) FROM HRGT_SECCAT_CHANGE_DTL WHERE HRGNUM_PUK\=A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE\=? AND GNUM_ISVALID\=?) AND GNUM_ISVALID\=?

          					
UPDATE.RECORD.HANCT_NEWNATAL_DTL	=UPDATE HANCT_NEWNATAL_DTL SET HBNUM_BABY_BLDGRP_CODE\=?, GNUM_GENDER_CODE\=?, HANCSTR_WEIGHT\=?, HANCSTR_DEATH_STILLBIRTH_CAUSE\=?, HANCSTR_DEATH_AGE\=?, HANCSTR_PRESENT_HEALTH\=?, HANCNUM_LENGTH\=?, HANCNUM_IS_ANOMALY\=?, HANCSTR_ANOMALY_REMARKS\=?, HANCNUM_UNBILICAL_ARTERIS\=?, HANCNUM_TRANSFER_TO\=?, HANCNUM_FOOT_PRINT\=?, HANCNUM_LIQUOR_APPEARANCE\=?, HANCNUM_CORDBLD_SAMPLE\=?, HANCNUM_HEAD_CIRCUMFERENCE\=?, HANCDT_CRY_DATETIME\=?, HANCDT_URINE_DATETIME\=?, HANCDT_MOTHER_FEEDTIME\=?, HANCDT_FEED_DATETIME\=?, HANCNUM_ISBIRTH_TRAUMA\=?, HANCSTR_BIRTH_TRAUMA_REMARKS\=?, HANCNUM_TRAUMA_CAUSE_ID\=?, HANCNUM_STILLBIRTH_DETECTION\=?, HANCNUM_ANOMALY_TYPE_ID\=?, GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HRGNUM_S_NO\=? AND GNUM_ISVALID\=?

INSERT.RECORD.HANCT_APGAR_DTL	= INSERT INTO HANCT_APGAR_DTL (HRGNUM_PUK, HANCNUM_GRAVIDA_NO, HRGNUM_S_NO, HRGNUM_APGAR_SLNO, HRGNUM_CHILD_PUK, HRGNUM_CHILD_ADMNO, HANCSTR_PEAD_ID, HANCNUM_HEART_RATE, HANCSTR_HEART_RATE, HANCNUM_RESPIRATION, HANCSTR_RESPIRATION, HANCNUM_COLOR, HANCSTR_COLOR, HANCNUM_ACTIVITY, HANCSTR_ACTIVITY, HANCNUM_GRIMACE, HANCSTR_GRIMACE, HANCNUM_APGAR_SCORE, HANCNUM_APGAR_TIME, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES (?, ?, ?, (SELECT NVL(MAX(HRGNUM_APGAR_SLNO),0)+1 FROM HANCT_APGAR_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HRGNUM_S_NO\=?), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?)

SELECT.ALL_NEW_NAT_APGARS.HANCT_APGAR_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_S_NO AS slNo, HRGNUM_APGAR_SLNO AS apgarSlNo, HRGNUM_CHILD_PUK AS childCrNo, HRGNUM_CHILD_ADMNO AS HRGNUM_CHILD_ADMNO, HANCSTR_PEAD_ID AS peaditricianEmpId, HANCNUM_HEART_RATE AS heartRateApgar, HANCSTR_HEART_RATE AS heartRate, HANCNUM_RESPIRATION AS respirationApgar, HANCSTR_RESPIRATION AS respiration, HANCNUM_COLOR AS colorApgar, HANCSTR_COLOR AS color, HANCNUM_ACTIVITY AS activityApgar, HANCSTR_ACTIVITY AS activity, HANCNUM_GRIMACE AS grimaceApgar, HANCSTR_GRIMACE AS grimace, HANCNUM_APGAR_SCORE AS apgarScore, HANCNUM_APGAR_TIME AS apgarTime, (SELECT A.HPMRSTR_FLAG_DESC FROM HPMRT_FLAG_MST A WHERE A.HPMRNUM_TABLE_ID\=7 AND A.HPMRNUM_FLAG_VALUE\=HANCNUM_APGAR_TIME) AS apgarTimeDesc FROM HANCT_APGAR_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=? ORDER BY HANCNUM_APGAR_TIME

INSERT.HRGT_EPISODE_EXTADMIN_DTL = insert into HRGT_EPISODE_EXTADMIN_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGDT_ADVICE_DATE, HRGNUM_S_NO, HRGNUM_ADMISSION_NO, HRGNUM_VISIT_NO, HGNUM_EXT_TREATMENT_ID, HGNUM_DOSE_ID, GNUM_SEAT_ID,  HRGDT_SCHEDULE_DATE, HGSTR_DOSE_NAME, HRGDT_ADMINISTRATION_TIME, HGNUM_FREQUENCY_ID,  HRGDT_ADMINISTRATION_ENDTIME, GDT_ENTRY_DATE, HGSTR_DOSE_TIME, GNUM_ISVALID, HRGSTR_REMARKS, GNUM_HOSPITAL_CODE, HRGNUM_ADMIN_FLAG, PSRSTR_EMP_NO, HRGNUM_ISMASTER_BOUND,  HGSTR_EXT_TREATMENT_NAME, HGNUM_TREATMENT_TYPE) values(?,?,trunc(sysdate),(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_EPISODE_EXTADMIN_DTL WHERE HRGNUM_PUK\= ? and to_date(to_char(HRGDT_ADVICE_DATE,'dd-mm-yyyy'),'dd-mm-yyyy')\=to_date(to_char(sysdate,'dd-mm-yyyy'),'dd-mm-yyyy') and GNUM_HOSPITAL_CODE\=?), ?,?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,to_date(?,'dd-mm-yyyy hh24\:mi'),trunc(sysdate),?,?,?,?,?,?,?,?,?)



UPDATE_PAT_STATUS_REVOKE.HIPT_PATADMISSION_DTL = UPDATE HIPT_PATADMISSION_DTL SET HIPDT_ADMSTATUS_CODE \= ?,HIPNUM_IS_DEAD \= ?, HIPDT_NEXT_VISITDATE \= TO_DATE(?,'dd-Mon-yyyy'), HIPDT_DISSTATUS_CODE \= ?, HIPSTR_DISCHARGE_ADVISE \= ?, HIPSTR_DISCHARGE_ADVICE_BY \= ?, HIPDT_DISCHARGE_ADVICE_DATE \= ? WHERE HIPNUM_ADMNO \= ? AND GNUM_HOSPITAL_CODE \= ?
									

									
UPDATE.TODAY_RECORD.HRGT_EPISODE_EXTADMIN_DTL = update HRGT_EPISODE_EXTADMIN_DTL set HRGDT_ADMINISTRATION_TIME\=to_date(to_char(?\:\:timestamp,'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'),HRGDT_ADMINISTRATION_ENDTIME\=to_date(TO_CHAR(?\:\:timestamp,'dd-mm-yyyy hh24\:mi'),'dd-mm-yyyy hh24\:mi'), HRGSTR_REMARKS\=?,HRGNUM_ADMIN_FLAG\=?  where HRGNUM_PUK\=? and trunc(HRGDT_ADVICE_DATE) \= trunc(to_date(TO_CHAR(?\:\:timestamp,'dd-mm-yyyy'),'dd-mm-yyyy')) and HRGNUM_S_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?

UPDATE.NOT_EXC_RECORD.HRGT_EPISODE_EXTADMIN_DTL = update HRGT_EPISODE_EXTADMIN_DTL set GNUM_ISVALID\=? where HRGNUM_PUK\=? and  HRGDT_ADVICE_DATE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_ADMIN_FLAG in (?) \t\t
													
SELECT_EXT_TREATMENT_STATUS.HRGT_EPISODE_DRUG_ADMIN_DTL = select count(*) from HRGT_EPISODE_EXTADMIN_DTL where HRGNUM_PUK\=? and HGSTR_EXT_TREATMENT_NAME\=? and HRGDT_SCHEDULE_DATE\=to_date(?,'dd-Mon-yyyy') and HGSTR_DOSE_TIME\=? and HRGNUM_ADMIN_FLAG in(?,?,?) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t



INSERT.HANCT_ABORTION_TYPE_MST = INSERT INTO HANCT_ABORTION_TYPE_MST (HANCNUM_ABORTION_TYPE_ID, HANCNUM_SLNO, HANCSTR_ABORTION_TYPE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HANCNUM_ABORTION_TYPE_ID),10)+1 FROM HANCT_ABORTION_TYPE_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE)
								
CHECK_DUPLICATE_NAME.HANCT_ABORTION_TYPE_MST= SELECT COUNT(*) FROM HANCT_ABORTION_TYPE_MST WHERE UPPER(HANCSTR_ABORTION_TYPE)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_ABORTION_TYPE_MST = SELECT a.HANCSTR_ABORTION_TYPE abortionType ,a.GNUM_ISVALID isActive FROM HANCT_ABORTION_TYPE_MST a WHERE a.HANCNUM_ABORTION_TYPE_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_ABORTION_TYPE_MST = UPDATE HANCT_ABORTION_TYPE_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_ABORTION_TYPE_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_ABORTION_TYPE_MST = INSERT INTO HANCT_ABORTION_TYPE_MST (HANCNUM_SLNO, HANCNUM_ABORTION_TYPE_ID, HANCSTR_ABORTION_TYPE,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_ABORTION_TYPE_MST WHERE HANCNUM_ABORTION_TYPE_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_ABORTION_TYPE_MST = SELECT COUNT(*) FROM HANCT_ABORTION_TYPE_MST WHERE UPPER(HANCSTR_ABORTION_TYPE)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_ABORTION_TYPE_ID <> ?  AND  GNUM_HOSPITAL_CODE = ?								




INSERT.HANCT_ABORTION_METHOD_MST = INSERT INTO HANCT_ABORTION_METHOD_MST (HANCNUM_ABORTION_METHOD_ID, HANCNUM_SLNO, HANCSTR_ABORTION_METHOD, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCNUM_ABORTION_TYPE_ID) VALUES((SELECT NVL(MAX(HANCNUM_ABORTION_METHOD_ID),10)+1 FROM HANCT_ABORTION_METHOD_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE,?)
								
CHECK_DUPLICATE_NAME.HANCT_ABORTION_METHOD_MST= SELECT COUNT(*) FROM HANCT_ABORTION_METHOD_MST WHERE UPPER(HANCSTR_ABORTION_METHOD)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_ABORTION_METHOD_MST = SELECT a.HANCSTR_ABORTION_METHOD abortionMethod ,a.GNUM_ISVALID isValid,a.HANCNUM_ABORTION_TYPE_ID abortionTypeId FROM HANCT_ABORTION_METHOD_MST a WHERE a.HANCNUM_ABORTION_METHOD_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_ABORTION_METHOD_MST = UPDATE HANCT_ABORTION_METHOD_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_ABORTION_METHOD_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_ABORTION_METHOD_MST = INSERT INTO HANCT_ABORTION_METHOD_MST (HANCNUM_SLNO, HANCNUM_ABORTION_METHOD_ID, HANCSTR_ABORTION_METHOD,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCNUM_ABORTION_TYPE_ID) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_ABORTION_METHOD_MST WHERE HANCNUM_ABORTION_METHOD_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE,?)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_ABORTION_METHOD_MST = SELECT COUNT(*) FROM HANCT_ABORTION_METHOD_MST WHERE UPPER(HANCSTR_ABORTION_METHOD)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_ABORTION_METHOD_ID <> ?  AND  GNUM_HOSPITAL_CODE = ?

SELECT_ABORTIONTYPENAME.HANCT_ABORTION_TYPE_MST = select initcap(HANCSTR_ABORTION_TYPE) abortionTypeName from HANCT_ABORTION_TYPE_MST where HANCNUM_ABORTION_TYPE_ID=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?


INSERT.HANCT_COMPLICATION_MST = INSERT INTO HANCT_COMPLICATION_MST (HANCNUM_COMPLICATION_ID, HANCNUM_SLNO, HANCSTR_COMPLICATION, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCNUM_COMPLICATION_TYPE) VALUES((SELECT NVL(MAX(HANCNUM_COMPLICATION_ID),10)+1 FROM HANCT_COMPLICATION_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE,?)


SELECT.HANCT_COMPLICATION_MST = SELECT a.HANCSTR_COMPLICATION complication ,a.GNUM_ISVALID isValid,a.HANCNUM_COMPLICATION_TYPE complicationTypeId FROM HANCT_COMPLICATION_MST a WHERE a.HANCNUM_COMPLICATION_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_COMPLICATION_MST = UPDATE HANCT_COMPLICATION_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_COMPLICATION_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_COMPLICATION_MST = INSERT INTO HANCT_COMPLICATION_MST (HANCNUM_SLNO, HANCNUM_COMPLICATION_ID, HANCSTR_COMPLICATION,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCNUM_COMPLICATION_TYPE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_COMPLICATION_MST WHERE HANCNUM_COMPLICATION_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE,?)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_COMPLICATION_MST = SELECT COUNT(*) FROM HANCT_COMPLICATION_MST WHERE UPPER(HANCSTR_COMPLICATION)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_COMPLICATION_ID <> ? AND  GNUM_HOSPITAL_CODE = ?

CHECK_DUPLICATE_NAME.HANCT_COMPLICATION_MST= SELECT COUNT(*) FROM HANCT_COMPLICATION_MST WHERE UPPER(HANCSTR_COMPLICATION)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ?
											
					
											
INSERT.HANCT_DELIVERY_PLACE_MST = INSERT INTO HANCT_DELIVERY_PLACE_MST (HANCNUM_DELIVERY_PLACE_ID, HANCNUM_SLNO, HANCSTR_DELIVERY_PLACE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HANCNUM_DELIVERY_PLACE_ID),10)+1 FROM HANCT_DELIVERY_PLACE_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE)
								
CHECK_DUPLICATE_NAME.HANCT_DELIVERY_PLACE_MST= SELECT COUNT(*) FROM HANCT_DELIVERY_PLACE_MST WHERE UPPER(HANCSTR_DELIVERY_PLACE)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_DELIVERY_PLACE_MST = SELECT a.HANCSTR_DELIVERY_PLACE deliveryPlace ,a.GNUM_ISVALID isValid FROM HANCT_DELIVERY_PLACE_MST a WHERE a.HANCNUM_DELIVERY_PLACE_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_DELIVERY_PLACE_MST = UPDATE HANCT_DELIVERY_PLACE_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_DELIVERY_PLACE_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_DELIVERY_PLACE_MST = INSERT INTO HANCT_DELIVERY_PLACE_MST (HANCNUM_SLNO, HANCNUM_DELIVERY_PLACE_ID, HANCSTR_DELIVERY_PLACE,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_DELIVERY_PLACE_MST WHERE HANCNUM_DELIVERY_PLACE_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_DELIVERY_PLACE_MST = SELECT COUNT(*) FROM HANCT_DELIVERY_PLACE_MST WHERE UPPER(HANCSTR_DELIVERY_PLACE)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_DELIVERY_PLACE_ID <> ? AND  GNUM_HOSPITAL_CODE = ?								

											 
INSERT.HANCT_METHOD_MST = INSERT INTO HANCT_METHOD_MST (HANCNUM_METHOD_ID, HANCNUM_SLNO,HANCSTR_METHOD, HANCNUM_METHOD_TYPE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HANCNUM_METHOD_ID),10)+1 FROM HANCT_METHOD_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),?,(?),?,?,SYSDATE)
								
CHECK_DUPLICATE_NAME.HANCT_METHOD_MST = SELECT COUNT(*) FROM HANCT_METHOD_MST WHERE UPPER(HANCSTR_METHOD)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_METHOD_MST = SELECT a.HANCSTR_METHOD method ,a.HANCNUM_METHOD_TYPE methodType,a.GNUM_ISVALID isActive FROM HANCT_METHOD_MST a WHERE a.HANCNUM_METHOD_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_METHOD_MST = UPDATE HANCT_METHOD_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_METHOD_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_METHOD_MST = INSERT INTO HANCT_METHOD_MST (HANCNUM_SLNO, HANCNUM_METHOD_ID, HANCSTR_METHOD,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCNUM_METHOD_TYPE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_METHOD_MST WHERE HANCNUM_METHOD_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE,?)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_METHOD_MST = SELECT COUNT(*) FROM HANCT_METHOD_MST WHERE UPPER(HANCSTR_METHOD)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_METHOD_ID <> ?  AND  GNUM_HOSPITAL_CODE = ? 							

INSERT.HANCT_PLACENTA_TYPE_MST = INSERT INTO HANCT_PLACENTA_TYPE_MST (HANCNUM_PLACENTA_TYPE_ID, HANCNUM_SLNO, HANCSTR_PLACENTA_TYPE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HANCNUM_PLACENTA_TYPE_ID),10)+1 FROM HANCT_PLACENTA_TYPE_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE)
								
CHECK_DUPLICATE_NAME.HANCT_PLACENTA_TYPE_MST= SELECT COUNT(*) FROM HANCT_PLACENTA_TYPE_MST WHERE UPPER(HANCSTR_PLACENTA_TYPE)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_PLACENTA_TYPE_MST = SELECT a.HANCSTR_PLACENTA_TYPE placentaType ,a.GNUM_ISVALID isValid FROM HANCT_PLACENTA_TYPE_MST a WHERE a.HANCNUM_PLACENTA_TYPE_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_PLACENTA_TYPE_MST = UPDATE HANCT_PLACENTA_TYPE_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_PLACENTA_TYPE_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_PLACENTA_TYPE_MST = INSERT INTO HANCT_PLACENTA_TYPE_MST (HANCNUM_SLNO, HANCNUM_PLACENTA_TYPE_ID, HANCSTR_PLACENTA_TYPE,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_PLACENTA_TYPE_MST WHERE HANCNUM_PLACENTA_TYPE_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_PLACENTA_TYPE_MST = SELECT COUNT(*) FROM HANCT_PLACENTA_TYPE_MST WHERE UPPER(HANCSTR_PLACENTA_TYPE)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_PLACENTA_TYPE_ID <> ? AND  GNUM_HOSPITAL_CODE = ?								
								

SELECT.PAT_ANC_DELIVERY_DETAIL.HANCT_ANC_DELIVERY_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_S_NO AS slNo, HANCDT_DELIVERY_DATE AS deliveryDate, HANCNUM_DELIVERY_STATUS AS deliveryStatus, HANCNUM_PREGNANCY_DURATION AS pregnancyDuration, HANCSTR_PREGNANCY_REMARKS AS pregnancyRemarks, HANCNUM_DELIVERY_PLACE_ID AS deliveryPlaceId, DECODE(HANCNUM_DELIVERY_PLACE_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_DELIVERY_PLACE) FROM HANCT_DELIVERY_PLACE_MST A WHERE A.HANCNUM_DELIVERY_PLACE_ID\=X.HANCNUM_DELIVERY_PLACE_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS deliveryPlace, HANCNUM_LABOUR_DURATION AS labourDuration, HANCSTR_LABOUR_REMARKS AS labourRemarks, HANCNUM_LABORROOM_AREA_ID AS labourRoomAreaId, DECODE(HANCNUM_LABORROOM_AREA_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_LABORROOM_AREA_DESC) FROM HANCT_LABORROOM_AREA_MST A WHERE A.HANCNUM_LABORROOM_AREA_ID\=X.HANCNUM_LABORROOM_AREA_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS labourRoomArea, HANCNUM_DELIVERY_TYPE_ID AS deliveryTypeId, DECODE(HANCNUM_DELIVERY_TYPE_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_DELIVERY_TYPE) FROM HANCT_DELIVERY_TYPE_MST A WHERE A.HANCNUM_DELIVERY_TYPE_ID\=X.HANCNUM_DELIVERY_TYPE_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS deliveryType, HANCNUM_ISINDUCED AS isInduced, HANCSTR_INDUCTION_INDICATION AS indicationOfInduction, HANCNUM_INDUCTION_METHOD_ID AS inductionMethodId, DECODE(HANCNUM_INDUCTION_METHOD_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_METHOD) FROM HANCT_METHOD_MST A WHERE A.HANCNUM_METHOD_ID\=X.HANCNUM_INDUCTION_METHOD_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS inductionMethod, HANCNUM_PLACENTA_REMOVAL_METHO AS placentaRemovalMethodId, DECODE(HANCNUM_PLACENTA_REMOVAL_METHO,NULL,'',(SELECT INITCAP(A.HANCSTR_METHOD) FROM HANCT_METHOD_MST A WHERE A.HANCNUM_METHOD_ID\=X.HANCNUM_INDUCTION_METHOD_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS placentaRemovalMethod, HRGNUM_EPISODE_CODE AS episodeCode, HANCNUM_PLACENTA_WEIGHT AS placentaWeight, HRGNUM_VISIT_NO AS episodeVisitNo, HANCNUM_PLACENTA_TYPE_ID AS placentaTypeId, DECODE(HANCNUM_PLACENTA_TYPE_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_PLACENTA_TYPE) FROM HANCT_PLACENTA_TYPE_MST A WHERE A.HANCNUM_PLACENTA_TYPE_ID\=X.HANCNUM_PLACENTA_TYPE_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS placentaType, HRGNUM_ADMISSION_NO AS admissionNo, HANCSTR_PLACENTA_MORPHOLOGY AS placentaMorphology, HANCSTR_PLACENTA_HISTOPATH AS placentaHistopath, HANCNUM_RUPTURE_TYPE AS ruptureType, HANCNUM_RUPTURE_DURATION AS ruptureDuration, HANCNUM_FOETAL_DISTRESS AS isFoetalDistress, HANCDT_RUPTURE_DATETIME AS ruptureDateTime, HANCNUM_STAGE1_DURATION AS labourStage1Duration, HANCNUM_STAGE2_DURATION AS labourStage2Duration, HANCNUM_STAGE3_DURATION AS labourStage3Duration, HANCSTR_STAGE1_REMARKS AS labourStage1Remarks, HANCSTR_STAGE2_REMARKS AS labourStage2Remarks, HANCSTR_STAGE3_REMARKS AS labourStage3Remarks, HANCNUM_COMPLICATION_ID AS complicationId, DECODE(HANCNUM_COMPLICATION_ID,NULL,'',(SELECT INITCAP(A.HANCSTR_COMPLICATION) FROM HANCT_COMPLICATION_MST A WHERE A.HANCNUM_COMPLICATION_ID\=X.HANCNUM_COMPLICATION_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?)) AS complication, HANCSTR_COMPLICATION_REMARKS AS complicationRemarks, HANCNUM_IS_EAS AS isEAS, HANCSTR_DOC_ID AS doctorId, HANCSTR_DELIVERY_INDICATION_RE AS indicationOfDeliveyType, HANCNUM_MOTHER_STATUS AS motherStatus, HANCNUM_DEATH_CAUSE AS deathCause, HANCNUM_DELIVERY_COUNT AS deliveryCount FROM HANCT_ANC_DELIVERY_DTL X WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

UPDATE.RECORD.HANCT_ANC_VISIT_DTL	=UPDATE HANCT_ANC_VISIT_DTL SET HANCSTR_ANC_NO\=?, HANCNUM_GESTATION_PERIOD\=?, HANCNUM_HIGHRISK_PREGNANCY\=?, HANCSTR_COMPLICATIONS\=?, HPMRNUM_QUICKENING_WEEK\=?, HPMRSTR_QUICKENING_REMARKS\=?, HANCSTR_REMARKS\=? WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=? AND GNUM_ISVALID\=?

SELECT_OUT_TAKE_DETAIL.HIPD_PAT_INTAKEOUT_DTL_EMR_OLD = SELECT A.HIPNUM_INTAKEOUT_PARA_ID AS inTakeOutParaId, TO_CHAR(A.HIPDT_INTAKEOUT_TIME,'dd-Mon-yyyy hh24\:mi') AS inTakeOutTime, A.HIPSTR_VOLUME AS volume, A.HIPSTR_REMARK AS remarks, A.HIPSTR_INTAKEOUT_PARA_NAME AS inTakeOutParaName, (select HIPSTR_ROUTE_NAME from HIPD_INTAKEOUT_ROUTE_MST where GNUM_ISVALID\=A.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE and HIPNUM_ROUTE_ID\=A.HIPNUM_ROUTE_ID ) as routeName,HRGNUM_ADMISSION_NO AS patAdmNo FROM HIPD_PAT_INTAKEOUT_DTL A WHERE A.HRGNUM_PUK \= ? AND A.HIPNUM_INTAKEOUT_MODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY A.HIPDT_INTAKEOUT_TIME DESC,inTakeOutParaName

SELECT_OUT_TAKE_DETAIL.HIPD_PAT_INTAKEOUT_DTL_EMR = SELECT A.HIPNUM_INTAKEOUT_PARA_ID AS inTakeOutParaId,a.gdt_entry_date as entrydate,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code as hospitalCode,(SELECT hgnum_deptunitcode FROM hrgt_episode_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND hrgnum_episode_code \= a.hrgnum_episode_code  AND hrgnum_visit_no \= a.hrgnum_visit_no AND gnum_isvalid \= a.gnum_isvalid  AND gnum_hospital_code \= a.gnum_hospital_code) AS departmentunitcode, TO_CHAR(A.HIPDT_INTAKEOUT_TIME,'dd-Mon-yyyy hh24\:mi') AS inTakeOutTime, A.HIPSTR_VOLUME AS volume, A.HIPSTR_REMARK AS remarks, A.HIPSTR_INTAKEOUT_PARA_NAME AS inTakeOutParaName, NVL((select HIPSTR_ROUTE_NAME from HIPD_INTAKEOUT_ROUTE_MST where GNUM_ISVALID\=A.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE and HIPNUM_ROUTE_ID\=A.HIPNUM_ROUTE_ID ),'-') as routeName,HRGNUM_ADMISSION_NO AS patAdmNo FROM HIPD_PAT_INTAKEOUT_DTL A WHERE A.HRGNUM_PUK \= ? AND A.HIPNUM_INTAKEOUT_MODE \= ? AND A.GNUM_ISVALID \= ?  
   SELECT.DOC_PREV_ROUND_DTL.HIPD_DOCTOR_ROUND_DTL_EMR= Select order1, order2, captureArea, doctorName, progressNote, visitNote, instruction, roundTime, entryDate, patAdmNo, episodecode, episodevisitno, hospitalcode, departmentunitcode FROM ( SELECT 2 as order1, A.HIPDT_ROUND_TIME as order2, 'IPD Doctor Round' AS captureArea, DECODE(A.PSRSTR_EMP_NO,NULL,pkg_usermgmt.emp_name_useridwise(a.GNUM_HOSPITAL_CODE,a.gnum_doctorseat_id), pkg_clinical_gbl_fun.get_emp_name(A.GNUM_HOSPITAL_CODE\:\:character varying, A.PSRSTR_EMP_NO\:\:character varying)) AS doctorName, NVL(A.HIPSTR_PROGRESS_NOTES,'-') AS progressNote, NVL(A.HIPSTR_VISIT_NOTES,'-') AS visitNote,NVL( A.HIPSTR_INSTRUCTIONS,'-') AS instruction, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode,  pkg_clinical_gbl_fun.get_unit_code('1'\:\:character varying, a.hrgnum_puk\:\:character varying, a.hrgnum_episode_code\:\:character varying, a.hrgnum_visit_no\:\:character varying, a.gnum_hospital_code\:\:character varying) AS departmentunitcode FROM HIPD_DOCTOR_ROUND_DTL A WHERE a.HRGNUM_PUK\=?  AND A.HIPNUM_VERIFY_FLAG\=1 AND A.GNUM_ISVALID \= 1 UNION SELECT 3 as order1, A.HIPDT_ROUND_TIME as order2, 'IPD Nurse Round' AS captureArea, DECODE(A.PSRSTR_EMP_NO,NULL,pkg_usermgmt.emp_name_useridwise(a.GNUM_HOSPITAL_CODE,\ta.gnum_seat_id),pkg_clinical_gbl_fun.get_emp_name(A.GNUM_HOSPITAL_CODE\:\:character varying, A.psrstr_emp_no\:\:character varying)) AS doctorName, NVL(A.hipstr_progress_notes,'-') AS progressNote, '-' AS visitNote, '-' AS instruction, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode,  pkg_clinical_gbl_fun.get_unit_code('1'\:\:character varying, a.hrgnum_puk\:\:character varying, a.hrgnum_episode_code\:\:character varying, a.hrgnum_visit_no\:\:character varying, a.gnum_hospital_code\:\:character varying) AS departmentunitcode FROM hipd_nurse_round_dtl A WHERE a.HRGNUM_PUK\=?  AND A.GNUM_ISVALID\= 1 \tUNION SELECT 1 as order1, A.gdt_entry_date as order2, 'OPD Doctor Prescription' AS captureArea,\tDECODE(A.psrstr_doc_emp_no,NULL,pkg_usermgmt.emp_name_useridwise(a.GNUM_HOSPITAL_CODE\:\:numeric,a.gnum_doc_seat_id\:\:numeric), pkg_clinical_gbl_fun.get_emp_name(A.GNUM_HOSPITAL_CODE\:\:character varying, A.psrstr_doc_emp_no\:\:character varying)) AS doctorName, NVL(A.hrgstr_visit_notes,'-') AS progressNote,'-' AS visitNote, NVL(a.hrgstr_episode_summary,'-') AS instruction, TO_CHAR(A.gdt_entry_date,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode, A.hgnum_deptunitcode AS departmentunitcode FROM hrgt_episode_dtl A WHERE a.HRGNUM_PUK\=?  AND A.GNUM_ISVALID \= 1 AND a.gnum_doc_seat_id is not null UNION SELECT 4 as order1, A.gdt_entry_date as order2, 'IPD Doctor Discharge' AS captureArea, DECODE(A.psrstr_emp_no,NULL,pkg_usermgmt.emp_name_useridwise(a.GNUM_HOSPITAL_CODE\:\:numeric,a.gnum_seat_id\:\:numeric), pkg_clinical_gbl_fun.get_emp_name(A.GNUM_HOSPITAL_CODE\:\:character varying, A.psrstr_emp_no\:\:character varying)) AS doctorName, NVL(A.hipstr_remarks,'-') AS progressNote, NVL(a.hipstr_dis_advice,'-') AS visitNote, '-' AS instruction, TO_CHAR(A.gdt_entry_date,'dd-Mon-yyyy hh24\:mi') AS roundTime,\tTO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode, pkg_clinical_gbl_fun.get_unit_code('1'\:\:character varying, a.hrgnum_puk\:\:character varying, a.hrgnum_episode_code\:\:character varying, a.hrgnum_visit_no\:\:character varying, a.gnum_hospital_code\:\:character varying) AS departmentunitcode FROM hipt_patdischarge_req_dtl A WHERE a.HRGNUM_PUK\=?  AND A.GNUM_ISVALID\= 1 AND a.hipnum_slno\= (select max(hipnum_slno) from hipt_patdischarge_req_dtl where hrgnum_admission_no\=a.hrgnum_admission_no))
   #SELECT.DOC_PREV_ROUND_DTL.HIPD_DOCTOR_ROUND_DTL_EMR	 =SELECT (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE)AS doctorName,  decode(hipstr_progress_notes,null,(select hrgstr_visit_notes  from HRGT_DAILY_PATIENT_DTL where hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND hrgnum_visit_no = a.hrgnum_visit_no  AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code),hipstr_progress_notes ) AS progressNote, A.HIPSTR_VISIT_NOTES AS visitNote, A.HIPSTR_INSTRUCTIONS AS instruction, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24\:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate,A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode, ( SELECT hgnum_deptunitcode FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code  AND hrgnum_visit_no = a.hrgnum_visit_no  AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code) AS departmentunitcode FROM HIPD_DOCTOR_ROUND_DTL A WHERE a.HRGNUM_PUK\=? AND A.HIPNUM_VERIFY_FLAG\=? AND A.GNUM_ISVALID \= ?
#
#SELECT.DOC_PREV_ROUND_DTL.HIPD_DOCTOR_ROUND_DTL_EMR =	SELECT (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE)AS doctorName, \
#													A.HIPSTR_PROGRESS_NOTES AS progressNote, TO_CHAR(A.HIPDT_ROUND_TIME,'dd-Mon-yyyy hh24:mi') AS roundTime, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24:mi') AS entryDate, A.HRGNUM_ADMISSION_NO AS patAdmNo,a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno,a.gnum_hospital_code AS hospitalcode,  \
#													(SELECT hgnum_deptunitcode FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code  AND hrgnum_visit_no = a.hrgnum_visit_no  AND gnum_isvalid = a.gnum_isvalid  AND gnum_hospital_code = a.gnum_hospital_code) AS departmentunitcode FROM HIPD_NURSE_ROUND_DTL A WHERE a.HRGNUM_PUK=? \
#													AND A.GNUM_ISVALID = ? AND a.hipstr_progress_notes is not null 
													
SELECT.HIPD_PAT_CLINICAL_DTL.VITAL_EMR_OLD =SELECT HRGNUM_ADMISSION_NO AS admissionNo, TO_CHAR(HRGDT_RECORD_DATE,'dd-Mon-yyyy hh24\:mi') AS recordDate,HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HGSTR_PARA_VALUE AS paraValue, HGNUM_PARA_ID AS paraId,(SELECT HGSTR_PARA_NAME FROM HGBT_PARAMETER_MST WHERE HGNUM_PARA_ID\=A.HGNUM_PARA_ID AND GNUM_ISVALID\=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE\=100) AS paraDesc FROM HIPD_PAT_CLINICAL_DTL A WHERE HRGNUM_PUK\=? AND A.GNUM_ISVALID\=? AND A.GNUM_HOSPITAL_CODE\=? AND HGNUM_TEMPLATE_ID IN (SELECT HGNUM_TEMPLATE_ID FROM HGBT_TEMPLATE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND GNUM_ISVALID\=a.gnum_isvalid AND HGNUM_TEMPLATE_CATEGORY\=?) order by hrgdt_record_date desc\t\t\t\t\t\t\t\t\t\t\t\t\t

SELECT.HIPD_PAT_CLINICAL_DTL.VITAL_EMR = SELECT HRGNUM_ADMISSION_NO AS admissionNo, TO_CHAR(HRGDT_RECORD_DATE,'dd-Mon-yyyy hh24\:mi') AS recordDate,HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HGSTR_PARA_VALUE AS paraValue, HGNUM_PARA_ID AS paraId,(SELECT HGSTR_PARA_NAME FROM HGBT_PARAMETER_MST WHERE HGNUM_PARA_ID\=A.HGNUM_PARA_ID AND GNUM_ISVALID\=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE\=100) AS paraDesc,a.gnum_hospital_code as hospitalCode  FROM HIPD_PAT_CLINICAL_DTL A WHERE HRGNUM_PUK\=? AND A.GNUM_ISVALID\=?  AND HGNUM_TEMPLATE_ID IN (SELECT HGNUM_TEMPLATE_ID FROM HGBT_TEMPLATE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND GNUM_ISVALID\=a.gnum_isvalid AND HGNUM_TEMPLATE_CATEGORY\=?) 


UPDATE.NEWNATAL_DEATH.HANCT_NEWNATAL_DTL = UPDATE HANCT_NEWNATAL_DTL SET HANCNUM_BIRTH_NATURE_ID \= ?, HANCSTR_DEATH_AGE\= (SELECT TRUNC(TO_DATE(?,'dd-Mon-yyyy')-A.HANCDT_BIRTH_DATETIME)||' Days' FROM HANCT_NEWNATAL_DTL A WHERE A.HRGNUM_CHILD_PUK \= HRGNUM_CHILD_PUK AND  A.GNUM_ISVALID \= GNUM_ISVALID AND A.GNUM_HOSPITAL_CODE \= GNUM_HOSPITAL_CODE) WHERE HRGNUM_CHILD_PUK \= ? AND  GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? 


GET_DETAIL_FOR_PATIENT_DEATH.HANCT_ANC_DTL = SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, X.HPMRDT_ACTUAL_DD AS actualDeliveryDate, DECODE (X.HPMRDT_ACTUAL_DD, NULL, 0, 1) AS deliveryStatus FROM HANCT_ANC_DTL X WHERE HANCNUM_GRAVIDA_NO \= (SELECT MAX (A.HANCNUM_GRAVIDA_NO) FROM HANCT_ANC_DTL A WHERE A.HRGNUM_PUK \= X.HRGNUM_PUK AND A.GNUM_ISVALID \= ?) AND ( ( X.HPMRDT_ACTUAL_DD IS NULL AND X.HANCDT_LMP > (TRUNC (SYSDATE) - (? * 7))) OR ( X.HPMRDT_ACTUAL_DD IS NOT NULL AND X.HPMRDT_ACTUAL_DD > (TRUNC (SYSDATE) - (? * 7)))) AND X.HRGNUM_PUK \= ? AND X.GNUM_ISVALID \= ? AND X.GNUM_HOSPITAL_CODE \= ?


UPDATE.MOTHER_STATUS.HANCT_ANC_DTL = UPDATE HANCT_ANC_DELIVERY_DTL SET HANCNUM_MOTHER_STATUS \= ?, HANCNUM_DEATH_CAUSE \= ? WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND HANCNUM_GRAVIDA_NO \= ? AND HRGNUM_S_NO\=(SELECT MAX(B.HRGNUM_S_NO) FROM HANCT_ANC_DELIVERY_DTL B WHERE B.HRGNUM_PUK \= ? AND HANCNUM_GRAVIDA_NO \= ?)




#Commmented By: Chetan Sharma 
# Reason: SCM integration 
# Date: 2015_11_30

#SELECT.DRUG_REACTION_DETAIL.HRGT_EPISODE_DRUG_REACTION_DTL = SELECT  HSTNUM_ITEM_ID as itemId ,(select HSTSTR_ITEM_NAME from HSTT_DRUGBRAND_MST b  \
#																where b.HSTNUM_ITEMBRAND_ID=a.HSTNUM_ITEM_ID \
#																and b.GNUM_HOSPITAL_CODE=100 and a.GNUM_ISVALID=b.GNUM_ISVALID ) as itemName, \
#																to_char(HRGDT_REACTION_STARTTIME,'dd-Mon-yyyy hh24:mi') as reactionStartTime, \
#																to_char(HRGDT_REACTION_ENDTIME,'dd-Mon-yyyy hh24:mi') as reactionEndTime,  \
#																HBSTR_CONTROL_SUMMARY as controlSummary, HRGSTR_REACTION_SUMMARY as reactionSummary \
#																FROM hrgt_episode_drug_reaction_dtl a \
#																WHERE hrgnum_puk = ? \
#																AND gnum_isvalid = ? \
#																AND gnum_hospital_code = ? \
#																and HSTNUM_ITEM_ID=?


# old--  pkg_opd_func.get_drug_name('1',a.HSTNUM_ITEM_ID,null,null,null) as itemName
#modified for cims integration 
SELECT.DRUG_REACTION_DETAIL.HRGT_EPISODE_DRUG_REACTION_DTL = SELECT  HSTNUM_ITEM_ID as itemId ,(select pkg_opd_func.get_drugitem_name('','',HSTNUM_ITEM_ID||'','','')  ) as itemName, to_char(HRGDT_REACTION_STARTTIME,'dd-Mon-yyyy hh24\:mi') as reactionStartTime, to_char(HRGDT_REACTION_ENDTIME,'dd-Mon-yyyy hh24\:mi') as reactionEndTime,  HBSTR_CONTROL_SUMMARY as controlSummary, HRGSTR_REACTION_SUMMARY as reactionSummary, hstnum_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName FROM hrgt_episode_drug_reaction_dtl a WHERE hrgnum_puk \= ? AND gnum_isvalid \= ? AND gnum_hospital_code \= ? and HSTNUM_ITEM_ID\=?

SELECT.NEO_NAT_DTL_BY_CHILD.HANCT_NEWNATAL_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HRGNUM_S_NO AS slNo, HRGNUM_CHILD_PUK AS childCrNo, TO_CHAR(HANCDT_BIRTH_DATETIME,'dd-Mon-yyyy HH24\:MI') AS birthDateTime, HANCNUM_BIRTH_NATURE_ID AS birthNatureId, HRGNUM_CHILD_ADMNO AS childAdmissionNo FROM HANCT_NEWNATAL_DTL WHERE HRGNUM_CHILD_PUK\=? AND HRGNUM_CHILD_ADMNO\=? AND GNUM_ISVALID\=?

INSERT.RECORD.HANCT_NEWBORN_HANDOVER_DTL	=INSERT INTO HANCT_NEWBORN_HANDOVER_DTL (HRGNUM_PUK, HPMRNO_SLNO, HANCDT_HANDOVER_DATETIME, HANCSTR_REMARKS, HANCSTR_RELATIVE_NAME, HANCSTR_RELATIVE_ADDRESS, GNUM_RELATIVECODE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES (?, (SELECT NVL(MAX(HPMRNO_SLNO),0)+1 FROM HANCT_NEWBORN_HANDOVER_DTL WHERE HRGNUM_PUK\=?), TO_DATE(?,'dd-Mon-yyyy hh24\:mi'), ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?)

SELECT.RECORD.HANCT_NEWBORN_HANDOVER_DTL	=SELECT X.HRGNUM_PUK AS patCrNo, X.HPMRNO_SLNO AS slNo, TO_CHAR(X.HANCDT_HANDOVER_DATETIME,'dd-Mon-yyyy HH24\:MI') AS handoverDateTime, TO_CHAR(X.HANCDT_HANDOVER_DATETIME,'dd-Mon-yyyy') AS handoverDate, TO_CHAR(X.HANCDT_HANDOVER_DATETIME,'HH24\:MI') AS handoverTime, X.HANCSTR_REMARKS AS remarks, X.HANCSTR_RELATIVE_NAME AS relativeName, X.HANCSTR_RELATIVE_ADDRESS AS relativeAddress, X.GNUM_RELATIVECODE AS relativeCode, (SELECT INITCAP(A.GSTR_RELATION_NAME) FROM GBLT_RELATION_MST A WHERE A.GNUM_RELATION_CODE\=X.GNUM_RELATIVECODE AND A.GNUM_HOSPITAL_CODE\=100 AND A.GNUM_ISVALID\=? ) AS relationship FROM HANCT_NEWBORN_HANDOVER_DTL X WHERE X.HRGNUM_PUK\=? AND X.GNUM_ISVALID\=?

INSERT.HANCT_ANOMALY_TYPE_MST = INSERT INTO HANCT_ANOMALY_TYPE_MST (HANCNUM_ANOMALY_TYPE_ID, HANCNUM_SLNO, HANCSTR_ANOMALY_TYPE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HANCNUM_ANOMALY_TYPE_ID),10)+1 FROM HANCT_ANOMALY_TYPE_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE)
								
CHECK_DUPLICATE_NAME.HANCT_ANOMALY_TYPE_MST= SELECT COUNT(*) FROM HANCT_ANOMALY_TYPE_MST WHERE UPPER(HANCSTR_ANOMALY_TYPE)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_ANOMALY_TYPE_MST = SELECT a.HANCSTR_ANOMALY_TYPE anomalyType ,a.GNUM_ISVALID isActive FROM HANCT_ANOMALY_TYPE_MST a WHERE a.HANCNUM_ANOMALY_TYPE_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_ANOMALY_TYPE_MST = UPDATE HANCT_ANOMALY_TYPE_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_ANOMALY_TYPE_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_ANOMALY_TYPE_MST = INSERT INTO HANCT_ANOMALY_TYPE_MST (HANCNUM_SLNO, HANCNUM_ANOMALY_TYPE_ID, HANCSTR_ANOMALY_TYPE,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_ANOMALY_TYPE_MST WHERE HANCNUM_ANOMALY_TYPE_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_ANOMALY_TYPE_MST = SELECT COUNT(*) FROM HANCT_ANOMALY_TYPE_MST WHERE UPPER(HANCSTR_ANOMALY_TYPE)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_ANOMALY_TYPE_ID <> ?  AND  GNUM_HOSPITAL_CODE = ?								


INSERT.HANCT_HEALTH_WORKER_MST = INSERT INTO HANCT_HEALTH_WORKER_MST (HANCNUM_HEALTH_WORKER_ID, HANCNUM_SLNO, HANCSTR_HEALTH_WORKER, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCSTR_SHORT_NAME,HANCSTR_DESC) VALUES((SELECT NVL(MAX(HANCNUM_HEALTH_WORKER_ID),10)+1 FROM HANCT_HEALTH_WORKER_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,Initcap(?),(?),?,?,SYSDATE,?,?)
								
CHECK_DUPLICATE_NAME.HANCT_HEALTH_WORKER_MST= SELECT COUNT(*) FROM HANCT_HEALTH_WORKER_MST WHERE UPPER(HANCSTR_HEALTH_WORKER)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 

SELECT.HANCT_HEALTH_WORKER_MST = SELECT a.HANCSTR_HEALTH_WORKER healthWorker,a.HANCSTR_SHORT_NAME shortName,a.HANCSTR_DESC description ,a.GNUM_ISVALID isValid FROM HANCT_HEALTH_WORKER_MST a WHERE a.HANCNUM_HEALTH_WORKER_ID\=? AND a.HANCNUM_SLNO\=? AND a.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t
						
UPDATE.HANCT_HEALTH_WORKER_MST = UPDATE HANCT_HEALTH_WORKER_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HANCNUM_HEALTH_WORKER_ID=? AND HANCNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HANCT_HEALTH_WORKER_MST = INSERT INTO HANCT_HEALTH_WORKER_MST (HANCNUM_SLNO, HANCNUM_HEALTH_WORKER_ID, HANCSTR_HEALTH_WORKER,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HANCSTR_SHORT_NAME,HANCSTR_DESC) VALUES((SELECT MAX(HANCNUM_SLNO)+1 FROM HANCT_HEALTH_WORKER_MST WHERE HANCNUM_HEALTH_WORKER_ID\=? AND GNUM_HOSPITAL_CODE \=?),?,Initcap(?),?,?,?,SYSDATE,?,?)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HANCT_HEALTH_WORKER_MST = SELECT COUNT(*) FROM HANCT_HEALTH_WORKER_MST WHERE UPPER(HANCSTR_HEALTH_WORKER)=UPPER(?) AND GNUM_ISVALID != ? AND HANCNUM_HEALTH_WORKER_ID <> ?  AND  GNUM_HOSPITAL_CODE = ?								

SELECT.ALL_TRIMESTERWISE_CHKLIST.HANCT_TRIMESTER_CHECKLIST_MST	=(SELECT ? AS trimester, HANCNUM_CHECKLIST_ID AS checklistId, HANCSTR_CHECKLIST_NAME AS checklistName, HANCNUM_CHECKLIST_TYPE AS checklistType, HANCNUM_CHECK_MODE AS checkMode, HANCSTR_DRUG_INV_ID AS drugInvID, HANCNUM_TRIMESTER1 AS compulsoryFlag, DECODE(HANCNUM_TRIMESTER1,?,'Yes',?,'No','N.A.') AS compulsoryFlagDesc FROM HANCT_TRIMESTER_CHECKLIST_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_TRIMESTER1<>?) UNION (SELECT ? AS trimester, HANCNUM_CHECKLIST_ID AS checklistId, HANCSTR_CHECKLIST_NAME AS checklistName, HANCNUM_CHECKLIST_TYPE AS checklistType, HANCNUM_CHECK_MODE AS checkMode, HANCSTR_DRUG_INV_ID AS drugInvID, HANCNUM_TRIMESTER2 AS compulsoryFlag, DECODE(HANCNUM_TRIMESTER2,?,'Yes',?,'No','N.A.') AS compulsoryFlagDesc FROM HANCT_TRIMESTER_CHECKLIST_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_TRIMESTER2<>?) UNION (SELECT ? AS trimester, HANCNUM_CHECKLIST_ID AS checklistId, HANCSTR_CHECKLIST_NAME AS checklistName, HANCNUM_CHECKLIST_TYPE AS checklistType, HANCNUM_CHECK_MODE AS checkMode, HANCSTR_DRUG_INV_ID AS drugInvID, HANCNUM_TRIMESTER3 AS compulsoryFlag, DECODE(HANCNUM_TRIMESTER3,?,'Yes',?,'No','N.A.') AS compulsoryFlagDesc FROM HANCT_TRIMESTER_CHECKLIST_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_TRIMESTER3<>?) ORDER BY trimester, checklistType, checklistName

INSERT.DRUG_CHKLST.HANCT_ANC_CHECKLIST_DTL	=INSERT INTO HANCT_ANC_CHECKLIST_DTL(HRGNUM_PUK, HANCNUM_GRAVIDA_NO, HANCNUM_TRIMESTER, HRGNUM_S_NO, HANCSTR_ANC_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HANCNUM_GESTATION_PERIOD, HANCNUM_CHECKLIST_ID, HANCDT_CONDUCT_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES(?, ?, ?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_CHECKLIST_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HANCNUM_TRIMESTER\=?), ?, ?, ?, ?, CEIL((TO_DATE(?, 'dd-Mon-yyyy')-TO_DATE(?, 'dd-Mon-yyyy'))/7), ?, TO_DATE(?, 'dd-Mon-yyyy'), ?, ?, ?, SYSDATE, ?)
												
INSERT.INVST_CHKLST.HANCT_ANC_CHECKLIST_DTL	=INSERT INTO HANCT_ANC_CHECKLIST_DTL(HRGNUM_PUK, HANCNUM_GRAVIDA_NO, HANCNUM_TRIMESTER, HRGNUM_S_NO, HANCSTR_ANC_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HANCNUM_GESTATION_PERIOD, HANCNUM_CHECKLIST_ID, HANCDT_CONDUCT_DATE, HANCSTR_RESULT, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) VALUES(?, ?, ?, (SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HANCT_ANC_CHECKLIST_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND HANCNUM_TRIMESTER\=?), ?, ?, ?, ?, CEIL((TO_DATE(?, 'dd-Mon-yyyy')-TO_DATE(?, 'dd-Mon-yyyy'))/7), ?, TO_DATE(?, 'dd-Mon-yyyy'), ?, ?, ?, ?, SYSDATE, ?)

SELECT.ALL.HANCT_ANC_CHECKLIST_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HANCNUM_TRIMESTER AS trimester, HRGNUM_S_NO AS slNo, HANCSTR_ANC_NO AS ancNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo, HANCNUM_GESTATION_PERIOD AS gestationPeriod, HANCNUM_CHECKLIST_ID AS checklistId, HANCDT_CONDUCT_DATE AS conductDate, HANCSTR_RESULT AS result FROM HANCT_ANC_CHECKLIST_DTL WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

SELECT.TYPE_WISE.HANCT_ANC_CHECKLIST_DTL	=SELECT HRGNUM_PUK AS patCrNo, HANCNUM_GRAVIDA_NO AS gravidaNo, HANCNUM_TRIMESTER AS trimester, HRGNUM_S_NO AS slNo, HANCSTR_ANC_NO AS ancNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo, HANCNUM_GESTATION_PERIOD AS gestationPeriod, HANCNUM_CHECKLIST_ID AS checklistId, (SELECT A.HANCSTR_CHECKLIST_NAME FROM HANCT_TRIMESTER_CHECKLIST_MST A WHERE A.GNUM_ISVALID\=? AND A.HANCNUM_CHECKLIST_ID\=X.HANCNUM_CHECKLIST_ID AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE) AS checklistName, TO_CHAR(HANCDT_CONDUCT_DATE, 'dd-Mon-yyyy') AS conductDate, HANCSTR_RESULT AS result FROM HANCT_ANC_CHECKLIST_DTL X WHERE HRGNUM_PUK\=? AND HANCNUM_GRAVIDA_NO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_CHECKLIST_ID IN (SELECT HANCNUM_CHECKLIST_ID FROM HANCT_TRIMESTER_CHECKLIST_MST WHERE HANCNUM_CHECKLIST_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?) ORDER BY HANCNUM_TRIMESTER, HANCDT_CONDUCT_DATE



INTER_INVEST_DTL = SELECT   hrgnum_puk as patcrno, hrgstr_episode_code AS episodecode, hgnum_visitno AS episodevisitno,TO_CHAR (hivtnum_req_dno) AS reqdno,gnum_lab_test_code AS labtestcode,TO_CHAR (hgnum_visit_date, 'dd-Mon-yyyy') AS visitdate,HIVTDT_PROPOSEDTESTDATE,HIVTDT_SESSIONSTARTTIME,HIVTDT_SESSIONENDTIME,(SELECT gstr_lab_nameFROM gblt_laboratory_mstWHERE gnum_lab_code \= SUBSTR (gnum_lab_test_code, 1, 5)AND gdt_effective_frm <\= TRUNC (SYSDATE)AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)AND gnum_hospital_code \= 108) AS labname,(SELECT gstr_test_nameFROM gblt_test_mstWHERE gnum_test_code \=SUBSTR (gnum_lab_test_code, 6, 9)AND gnum_hospital_code \= 108AND gdt_effective_frm <\= TRUNC (SYSDATE)AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE))AS testname,SUBSTR (gnum_lab_test_code, 1, 5) AS labcode,SUBSTR (gnum_lab_test_code, 6, 9) AS testcode,hipnum_admno AS patadmnoFROM hivt_requisition_dtl a, hivt_requisition_header bWHERE SUBSTR (hivtnum_req_dno, 1, 18) \= hivnum_req_no-- AND hrgnum_puk \= 1080900008772-- AND HRGSTR_EPISODE_CODE \= 10809004AND a.gbnum_status_code IN (9, 16, 17)and GNUM_LAB_TEST_CODE in (SELECT HANCSTR_DRUG_INV_ID FROM HANCT_TRIMESTER_CHECKLIST_MST WHERE HANCSTR_DRUG_INV_ID IS NOT NULL AND HANCNUM_CHECKLIST_TYPE\=1 AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=108)ORDER BY hgnum_visitno DESC

SELECT.DRUG_FROM_STORE.HSTT_DRUG_CURRSTOCK_DTL = SELECT hststr_batch_no||'\#'|| TO_CHAR (hstdt_expiry_date, 'dd-Mon-yyyy')||'\#'||hstnum_itembrand_id,hststr_batch_no FROM hstt_drug_currstock_dtl a WHERE gnum_hospital_code \=?  AND GNUM_ISVALID\=? AND hstnum_store_id \=? AND hstnum_itembrand_id IN (?)

INSERT.HANCT_LABOR_ROOM_MST = insert into HANCT_LABOR_ROOM_MST(HANCNUM_LABOR_ROOM_ID,HANCNUM_SLNO,HANCSTR_LABOR_ROOM_NAME,HANCSTR_LABOR_ROOM_SHORTNAME,HANCSTR_LABOR_ROOM_DESC,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_DEPT_CODE,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID) values((SELECT NVL(MAX(HANCNUM_LABOR_ROOM_ID),10)+1 FROM HANCT_LABOR_ROOM_MST WHERE GNUM_HOSPITAL_CODE\=?),?,initcap(?),upper(?),?,SYSDATE,?,?,?,?)

SELECT.FULL_INFO.HANCT_LABOR_ROOM_MST = select HANCNUM_LABOR_ROOM_ID,HANCNUM_SLNO ,HANCSTR_LABOR_ROOM_NAME,HANCSTR_LABOR_ROOM_SHORTNAME,HANCSTR_LABOR_ROOM_DESC,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_DEPT_CODE,GNUM_HOSPITAL_CODE from HANCT_LABOR_ROOM_MST where HANCNUM_LABOR_ROOM_ID\=? and HANCNUM_SLNO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?
 							
SELECT.DUPLICATE_CHECK.HANCT_LABOR_ROOM_MST = select count(*) from HANCT_LABOR_ROOM_MST where GNUM_DEPT_CODE\=? and trim(upper(HANCSTR_LABOR_ROOM_NAME))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?

UPDATE.HANCT_LABOR_ROOM_MST = update HANCT_LABOR_ROOM_MST set GDT_LSTMOD_DATE\=SYSDATE, GNUM_ISVALID\=? ,GNUM_LSTMOD_SEATID\=? where HANCNUM_LABOR_ROOM_ID\=? and HANCNUM_SLNO\=? and  GNUM_HOSPITAL_CODE\=?

SELECT.MODIFY_DUPLICATE_CHECK.HANCT_LABOR_ROOM_MST = select count(*) from HANCT_LABOR_ROOM_MST where GNUM_DEPT_CODE=? and  trim(upper(HANCSTR_LABOR_ROOM_NAME))=trim(upper(?)) AND gnum_isvalid !=? AND gnum_hospital_code =? and hancnum_labor_room_id!=? 


INSERT.MODIFY.HANCT_LABOR_ROOM_MST = insert into HANCT_LABOR_ROOM_MST(HANCNUM_LABOR_ROOM_ID,HANCNUM_SLNO,HANCSTR_LABOR_ROOM_NAME,HANCSTR_LABOR_ROOM_SHORTNAME,HANCSTR_LABOR_ROOM_DESC,GNUM_DEPT_CODE,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID) values(?,(SELECT NVL(MAX(HANCNUM_SLNO),1)+1 FROM HANCT_LABOR_ROOM_MST WHERE HANCNUM_LABOR_ROOM_ID\=? AND GNUM_HOSPITAL_CODE\=?),initcap(?),upper(?),?,?,SYSDATE,?,?,?)
 							
 							
 							
#SELECT.TEMPLAEID_LIST_FOR_TRANSFUSION_REACTION.HGBT_TEMPLATE_MAPPING_MST = 	select HGNUM_TEMPLATE_ID from HGBT_TEMPLATE_MST  \
#																			where HGNUM_TEMPLATE_CATEGORY=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?	


SELECT_BILL_ACCOUNT_STATUS.HBLT_PATACCOUNT_DTL = SELECT HBLNUM_PATACCOUNT_STATUS FROM HBLT_PATACCOUNT_DTL WHERE GNUM_ISVALID \= 1 AND GNUM_HOSPITAL_CODE \= ? AND SBLNUM_CHARGETYPE_ID \= 2  AND HASTR_ADM_NO \= ?

#addedBy:NehaRajgariya Date:1Sept2016
SELECT.HPMRT_CONFIG_FLAG_MST = SELECT hpmrstr_flag_value FROM hpmrt_config_flag_mst where gnum_isvalid=? and gnum_hospital_code=? and hpmrnum_flag_id = 2


#addedBy:NehaRajgariya Date:15dec2016
SELECT_SNOMED_ID_TERM_hipd_intakeout_para_mst = SELECT sctnum_id_inout_para_id AS paraid, sctstr_pterm_inout_para_id as paraTerm from hipd_intakeout_para_mst where hipstr_intakeout_para_name=? and gnum_hospital_code=? and gnum_isvalid=? and hipnum_intakeout_para_id=?
MODIFYINSERT.hipd_intakeout_para_mst = INSERT INTO hipd_intakeout_para_mst (hipnum_slno, hipnum_intakeout_para_id, hipstr_intakeout_para_name,gnum_hospital_code, gnum_isvalid, gnum_seat_id, gdt_entry_date, hipnum_intakeout_para_type, sctnum_id_inout_para_id,sctstr_pterm_inout_para_id) VALUES((SELECT MAX(hipnum_slno)+1 FROM hipd_intakeout_para_mst WHERE hipnum_intakeout_para_id\=? AND gnum_hospital_code \=?),?,Initcap(?),?,?,?,SYSDATE,?,?,?)
								
UPDATE.hipd_intakeout_para_mst =  UPDATE hipd_intakeout_para_mst SET gdt_lstmod_date=SYSDATE,gnum_lstmod_seatid=?,gnum_isvalid=? WHERE hipnum_intakeout_para_id=? AND hipnum_slno=? AND gnum_hospital_code=?
CHECK_DUPLICATE_NAMEFORMODIFY.hipd_intakeout_para_mst = SELECT COUNT(*) FROM hipd_intakeout_para_mst WHERE UPPER(hipstr_intakeout_para_name)=UPPER(?) AND GNUM_ISVALID != ? AND hipnum_intakeout_para_id <> ?  AND  GNUM_HOSPITAL_CODE = ?
SELECT.hipd_intakeout_para_mst = SELECT a.hipstr_intakeout_para_name paraName ,a.gnum_isvalid isActive, A.HIPNUM_INTAKEOUT_PARA_TYPE paraType, sctnum_id_inout_para_id as conceptId, sctstr_pterm_inout_para_id as prefferedTerm FROM hipd_intakeout_para_mst a WHERE a.hipnum_intakeout_para_id\=? AND a.hipnum_slno\=? AND a.gnum_hospital_code\=?
CHECK_DUPLICATE_NAME.HIPD_INTAKEOUT_PARA_MST = SELECT COUNT(*) FROM HIPD_INTAKEOUT_PARA_MST WHERE UPPER(HIPSTR_INTAKEOUT_PARA_NAME)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? 
INSERT.HIPD_INTAKEOUT_PARA_MST = insert into HIPD_INTAKEOUT_PARA_MST(HIPNUM_INTAKEOUT_PARA_ID,GNUM_HOSPITAL_CODE,HIPNUM_SLNO,HIPSTR_INTAKEOUT_PARA_NAME,HIPNUM_INTAKEOUT_PARA_TYPE,GNUM_ISVALID,GDT_ENTRY_DATE,gnum_seat_id, sctnum_id_inout_para_id, sctstr_pterm_inout_para_id) values((SELECT NVL(MAX(HIPNUM_INTAKEOUT_PARA_ID),10)+1 FROM HIPD_INTAKEOUT_PARA_MST WHERE GNUM_HOSPITAL_CODE = ?),?,?,?,?,?,sysdate,?,?,?)
#Added by Vasu on 26.Sept.2018 to update doctor visit notes
UPDATE_BY_DOCTOR.HIPD_DOCTOR_ROUND_DTL= UPDATE HIPD_DOCTOR_ROUND_DTL SET HIPSTR_PROGRESS_NOTES=?,HIPSTR_VISIT_NOTES=?,HIPSTR_INSTRUCTIONS=?,HIPDT_ROUND_TIME=TO_DATE(? ,'DD-Mon-YYYY HH24:MI') WHERE HRGNUM_PUK=? and  HIPDT_ROUND_DATE=TO_DATE(?,'DD-Mon-YYYY HH24:MI') AND HRGNUM_ROUND_NO=? AND HIPNUM_SLNO=? AND GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?

#Added By Vasu on 04.Jan.2019 to get FollowUp Essentials for discharge Summary
SELECT.HIPT_PATDISCHARGE_REQ_DTL.DISCHARGE_SUMMARY = SELECT HIPSTR_REMARKS as dischargeRemarks, to_char(hipdt_next_visit_date,'dd-Mon-yyyy') as nextVisitDate,hipdt_disstatus_code as dischargeStatus,(select hgstr_discharge_desc from HIPT_DISCHARGE_TYPE_MST X where X.hgnum_disharge_type_code in(select hipdt_disstatus_code from HIPT_PATDISCHARGE_REQ_DTL where HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ? and hrgnum_puk \= ? and hrgnum_episode_code \= ? and hrgnum_visit_no \= ? AND hipnum_slno \=(select max(hipnum_slno) from HIPT_PATDISCHARGE_REQ_DTL where HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ? and hrgnum_puk \= ? and hrgnum_episode_code \= ? and hrgnum_visit_no \= ?))) as dischargeStatusName,psrstr_emp_name as requestByName,psrstr_discharge_prepared_by_name as dischargePreparedByName,psrstr_discharge_approved_by_name as dischargeApprovedByName,to_char(hipdt_tent_disdatetime,'dd-Mon-yyyy') as dischargeDate, to_char(hipdt_disc_prepare_date,'dd-Mon-yyyy') as dischargePreparedDate FROM HIPT_PATDISCHARGE_REQ_DTL WHERE HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ? and hipnum_slno \=(select max(hipnum_slno) from HIPT_PATDISCHARGE_REQ_DTL where HRGNUM_ADMISSION_NO \= ? AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ? and hrgnum_puk \= ? and hrgnum_episode_code \= ? and hrgnum_visit_no \= ?) and hrgnum_episode_code \= ? and hrgnum_visit_no \= ? and hrgnum_puk \= ? \t\t\t\t\t\t

#Added by Vasu on 29.Jan.2019
INSERT.HIPT_PATDISCHARGE_REQ_DTL.SINGLE_PAGE_DISCHARGE = INSERT INTO HIPT_PATDISCHARGE_REQ_DTL(HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HIPNUM_SLNO, HRGNUM_ADMISSION_NO, HIPSTR_REMARKS, GNUM_ISVALID, HIPDT_NEXT_VISIT_DATE, GNUM_SEAT_ID, GDT_ENTRY_DATE, HIPNUM_REQ_TYPE,  GNUM_HOSPITAL_CODE,GSTR_IP_ADD,hipdt_disstatus_code,psrstr_emp_name,psrstr_discharge_prepared_by_name,psrstr_discharge_approved_by_name,hipdt_tent_disdatetime,hipdt_disc_prepare_date)VALUES(?,?,?,(SELECT NVL(MAX(HIPNUM_SLNO),0)+1 FROM HIPT_PATDISCHARGE_REQ_DTL WHERE HRGNUM_ADMISSION_NO \= ?),?,?,?,to_date(?,'dd-Mon-yyyy'),?,SYSDATE,?,?,?,?,?,?,?,to_date(?,'dd-Mon-yyyy'),to_date(?,'dd-Mon-yyyy'))\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

#Added by Vasu on 27.Feb.2019
UPDATE_PAT_STATUS.HIPT_PATADMDISC_DTL = UPDATE HIPT_PATADMDISC_DTL SET HIPDT_ADMSTATUS_CODE \= ?,HIPNUM_IS_DEAD \= ?, HIPDT_NEXT_VISITDATE \= TO_DATE(?,'dd-Mon-yyyy'), HIPDT_DISSTATUS_CODE \= ?, HIPSTR_DISCHARGE_ADVISE \= ? WHERE HIPNUM_ADMNO \= ? AND GNUM_HOSPITAL_CODE \= ?
#ADDED BY SWATI ON DATE:11-06-2019
SELECT.HIPT_PATADMDISC_DTL=select HIPDT_DISSTATUS_CODE AS dischargeStatus from HIPT_PATADMDISC_DTL WHERE HIPNUM_ADMNO \= ? AND gnum_isvalid \= ? AND GNUM_HOSPITAL_CODE \= ?


