<!-- 
## Copyright Information		: 	C-DAC, Noida  
## Project Name					: 	HIS-NIMS
## Name of Developer		 	: 	
## Module Name					: 	Docter Desk (IPD Nursing)
## Process/Database Object Name	:	
## Purpose						:	
## Date of Creation				: 	19-November-2014
## Modification Log				:	1.FETCH.CONSULTANT.LIST		2.	FETCH.ALLCONSULTANT.LIST	3.SELECT_ROUND_BY_LIST.HGBT_UNIT_CONSULTANT_MST		
##		Modify Date				: 	16/12/2014
##		Reason	(CR/PRS)		:	IPD Desk Menu details (Change emp first 2nd 3rd name to emp Name)
##		Modify By				:	Akash Singh

 -->
#ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL.RETRIEVE_UNITS_BY_SEATID	=SELECT A.HGNUM_DEPTUNITCODE||'^'||A.GNUM_DIAGNOSIS_CODE_TYPE, (SELECT INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID IN (?,?) AND GNUM_DEPT_CODE\=A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)||' ('|| INITCAP(A.HGSTR_UNITNAME)||')' AS DEPTUNITNAME FROM HGBT_UNIT_MST A WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?  AND A.HGNUM_DEPTUNITCODE IN (SELECT HGNUM_DEPTUNITCODE FROM HIPT_DUWRBED_MST C WHERE C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=?) AND A.HGNUM_DEPTUNITCODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID\=B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME\='HGBT_UNIT_MST' AND A.GNUM_HOSPITAL_CODE\=? AND A.GBL_ISVALID\=? AND B.GBL_ISVALID\=? AND B.GSTR_COLUMN_NAME\='HGNUM_DEPTUNITCODE' AND A.GNUM_MODULE_ID \= 36 AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE)) ORDER BY DEPTUNITNAME
#updated by Dheeraj for IPD Doctor Desk Optimization
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL.RETRIEVE_UNITS_BY_SEATID	=WITH ROLE_UNITS AS (SELECT DISTINCT GNUM_COLUMN_VALUE as unitcode FROM GBLT_ROLE_SEAT_TABLE_DTL B WHERE B.GNUM_HOSPITAL_CODE=? AND B.GBL_ISVALID=1 AND B.GNUM_MODULE_ID = 36 AND B.GNUM_SEATID=PKG_USERMGMT.FUN_GETSEATID(?,?) AND B.GSTR_COLUMN_NAME='HGNUM_DEPTUNITCODE' AND B.GSTR_TABLE_NAME='HGBT_UNIT_MST'), ADT_UNITS AS (SELECT A.HGNUM_DEPTUNITCODE as unitcode FROM HIPT_DUWRBED_MST A WHERE A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=1) SELECT X.HGNUM_DEPTUNITCODE||'^'||X.GNUM_DIAGNOSIS_CODE_TYPE, (SELECT A.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST A WHERE A.GNUM_DEPT_CODE=SUBSTR(X.HGNUM_DEPTUNITCODE,1,3) AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=1) ||' ('|| X.HGSTR_UNITNAME||')' AS UNITNAME FROM HGBT_UNIT_MST X WHERE X.GNUM_HOSPITAL_CODE=? AND X.GNUM_ISVALID=1 AND X.HGNUM_DEPTUNITCODE IN (SELECT unitcode FROM ROLE_UNITS) AND X.HGNUM_DEPTUNITCODE IN (SELECT unitcode FROM ADT_UNITS) ORDER BY 2


#ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL.RETRIEVE_WARDBASIS_BY_SEATID	=SELECT A.HGNUM_DEPTUNITCODE||'^'||A.GNUM_DIAGNOSIS_CODE_TYPE, (SELECT INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID IN (?,?) AND GNUM_DEPT_CODE\=A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)||' ('|| INITCAP(A.HGSTR_UNITNAME)||')' AS DEPTUNITNAME FROM HGBT_UNIT_MST A WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?  AND A.HGNUM_DEPTUNITCODE IN (SELECT HGNUM_DEPTUNITCODE FROM HIPT_DUWRBED_MST C WHERE C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND C.HIPNUM_WARD_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID\=B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME\='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE\=? AND A.GBL_ISVALID\=? AND B.GBL_ISVALID\=? AND B.GSTR_COLUMN_NAME\='HIPNUM_WARD_CODE' AND A.GNUM_MODULE_ID \= 36 AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE))) ORDER BY DEPTUNITNAME
# updated by Dheeraj on 28-Dec-2018 for IPD Nursing Desk optimization
#ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL.RETRIEVE_WARDBASIS_BY_SEATID	=SELECT A.HGNUM_DEPTUNITCODE||'^'||A.GNUM_DIAGNOSIS_CODE_TYPE, (SELECT INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID IN (?,?) AND GNUM_DEPT_CODE\=A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)||' ('|| INITCAP(A.HGSTR_UNITNAME)||')' AS DEPTUNITNAME FROM HGBT_UNIT_MST A WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?  AND A.HGNUM_DEPTUNITCODE IN (SELECT HGNUM_DEPTUNITCODE FROM HIPT_DUWRBED_MST C WHERE C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND C.HIPNUM_WARD_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A WHERE A.GSTR_TABLE_NAME\='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE\=? AND A.GBL_ISVALID\=? AND A.GSTR_COLUMN_NAME\='HIPNUM_WARD_CODE' AND A.GNUM_MODULE_ID \= 36 AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE))) ORDER BY DEPTUNITNAME
# updated by Pragya on 03-Jan-2019 for IPD Nursing Desk optimization
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL.RETRIEVE_WARDBASIS_BY_SEATID	=WITH TBL_UNITS AS (WITH TBL_ROLEWARDS AS (SELECT GNUM_COLUMN_VALUE AS wardcode FROM GBLT_ROLE_SEAT_TABLE_DTL A WHERE A.GSTR_TABLE_NAME='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE=? AND A.GBL_ISVALID=1 AND A.GSTR_COLUMN_NAME='HIPNUM_WARD_CODE' AND A.GNUM_MODULE_ID = 36 AND A.GNUM_SEATID=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE)) SELECT HGNUM_DEPTUNITCODE AS unitcode FROM HIPT_DUWRBED_MST C WHERE C.GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=1 AND C.HIPNUM_WARD_CODE IN (SELECT wardcode FROM TBL_ROLEWARDS) ) SELECT A.HGNUM_DEPTUNITCODE||'^'||A.GNUM_DIAGNOSIS_CODE_TYPE, (SELECT INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID IN (1,2) AND GNUM_DEPT_CODE=A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE)||' ('|| INITCAP(A.HGSTR_UNITNAME)||')' AS DEPTUNITNAME FROM HGBT_UNIT_MST A WHERE A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=1 AND HGNUM_DEPTUNITCODE IN (SELECT unitcode FROM TBL_UNITS ) ORDER BY DEPTUNITNAME

SELECT.COUNT_DRUG_ADMIN.HRGT_EPISODE_DRUG_DTL = SELECT count(*)  FROM HRGT_EPISODE_DRUG_DTL  WHERE HRGNUM_PUK\=? AND  GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=? 
ESSENTIAL.UNITLIST_FORUNITWISE = SELECT A.HGNUM_DEPTUNITCODE ,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.HGNUM_DEPT_CODE\=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND A.HGNUM_DEPTUNITCODE not in (select C.HGNUM_DEPTUNITCODE from HGBT_DEPTUNITWISE_INV_MST C where A.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE and C.HIPNUM_WARD_CODE is null AND C.GNUM_ISVALID \= ?) ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' 


ESSENTIAL.UNITLIST_FORWARDWISE = SELECT A.HGNUM_DEPTUNITCODE ,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.HGNUM_DEPT_CODE\=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND A.HGNUM_DEPTUNITCODE NOT IN (SELECT HGNUM_DEPTUNITCODE FROM HGBT_DEPTUNITWISE_INV_MST WHERE HIPNUM_WARD_CODE IS NOT NULL)ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' 
ESSENTIAL.PARAMETERLIST = SELECT HGNUM_PARAMETER_ID,HGSTR_PARAMETER FROM HIVT_PARAMETER_MST WHERE GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?

ESSENTIAL.PARAMETERLISTFORMODIFY = SELECT HGNUM_PARAMETER_ID,HGSTR_PARAMETER FROM HIVT_PARAMETER_MST WHERE GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?	AND HGNUM_PARAMETER_ID NOT In (SELECT HGNUM_PARAMETER_ID FROM HGBT_DEPTUNITWISE_INV_MST WHERE HGNUM_DEPTUNITCODE = ? AND GNUM_ISVALID = ? and HIPNUM_WARD_CODE is null)															

ESSENTIAL.PARAMETERLISTFORWARDWISE = SELECT HGNUM_PARAMETER_ID,HGSTR_PARAMETER FROM HIVT_PARAMETER_MST WHERE GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?	AND HGNUM_PARAMETER_ID NOT In (SELECT HGNUM_PARAMETER_ID FROM HGBT_DEPTUNITWISE_INV_MST WHERE HGNUM_DEPTUNITCODE = ? AND GNUM_ISVALID = ? and HIPNUM_WARD_CODE = ?)															


WARD_LIST.HIPT_DUWRBED_MST.RETRIEVE_BY_DEPTUNITCODE = SELECT DISTINCT HIPNUM_WARD_CODE,(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\= A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) and TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE))>\=TRUNC(SYSDATE)) AS WardName FROM HIPT_DUWRBED_MST A WHERE HGNUM_DEPTUNITCODE like(?) AND TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HIPNUM_WARD_CODE IN (SELECT HIPNUM_WARD_CODE FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\=A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=A.GNUM_ISVALID AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND TRUNC(NVL(GDT_EFFECTIVE_TO, SYSDATE))>\=TRUNC(SYSDATE) )  ORDER BY WardName

#WARD_LIST_NURSE.HIPT_DUWRBED_MST.RETRIEVE_BY_DEPTUNITCODE = SELECT DISTINCT HIPNUM_WARD_CODE,(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\= A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) and TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE))>\=TRUNC(SYSDATE)) AS WardName FROM HIPT_DUWRBED_MST A WHERE HGNUM_DEPTUNITCODE like (?) AND TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HIPNUM_WARD_CODE IN (SELECT HIPNUM_WARD_CODE FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\=A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=A.GNUM_ISVALID AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND TRUNC(NVL(GDT_EFFECTIVE_TO, SYSDATE))>\=TRUNC(SYSDATE) ) AND A.HIPNUM_WARD_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID\=B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME\='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE\=? AND A.GBL_ISVALID\=? AND B.GBL_ISVALID\=? AND B.GSTR_COLUMN_NAME\='HIPNUM_WARD_CODE' AND A.GNUM_MODULE_ID \= 36 AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE)) ORDER BY WardName
#updated by Dheeraj on 28-Dec-2018 fro IPD Nursing Desk Optimization
#WARD_LIST_NURSE.HIPT_DUWRBED_MST.RETRIEVE_BY_DEPTUNITCODE = SELECT DISTINCT HIPNUM_WARD_CODE,(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\= A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) and TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE))>\=TRUNC(SYSDATE)) AS WardName FROM HIPT_DUWRBED_MST A WHERE HGNUM_DEPTUNITCODE like (?) AND TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HIPNUM_WARD_CODE IN (SELECT HIPNUM_WARD_CODE FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\=A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=A.GNUM_ISVALID AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND TRUNC(NVL(GDT_EFFECTIVE_TO, SYSDATE))>\=TRUNC(SYSDATE) ) AND A.HIPNUM_WARD_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A WHERE A.GSTR_TABLE_NAME\='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE\=? AND A.GBL_ISVALID\=? AND A.GSTR_COLUMN_NAME\='HIPNUM_WARD_CODE' AND A.GNUM_MODULE_ID \= 36 AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE)) ORDER BY WardName
#updated by Dheeraj on 3-Jan-2019 fro IPD Nursing Desk Optimization
WARD_LIST_NURSE.HIPT_DUWRBED_MST.RETRIEVE_BY_DEPTUNITCODE = WITH ROLE_WARDS AS (SELECT DISTINCT GNUM_COLUMN_VALUE as wardcode FROM GBLT_ROLE_SEAT_TABLE_DTL A WHERE A.GNUM_HOSPITAL_CODE=? AND A.GBL_ISVALID=1 AND A.GNUM_MODULE_ID=36 AND A.GNUM_SEATID=PKG_USERMGMT.FUN_GETSEATID(?,A.GNUM_HOSPITAL_CODE) AND A.GSTR_COLUMN_NAME='HIPNUM_WARD_CODE' AND A.GSTR_TABLE_NAME='HIPT_WARD_MST') SELECT DISTINCT HIPNUM_WARD_CODE,(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST A WHERE HIPNUM_WARD_CODE=X.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE=X.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=1) AS WardName FROM HIPT_DUWRBED_MST X WHERE HGNUM_DEPTUNITCODE like (?) AND TRUNC(GDT_EFFECTIVE_FRM)<=TRUNC(SYSDATE) AND GNUM_ISVALID=1 AND GNUM_HOSPITAL_CODE=? AND X.HIPNUM_WARD_CODE IN (select wardcode from ROLE_WARDS) order by 2

WARD_LIST.HIPT_WARD_MST.RETRIEVE_BY_ROLEPERMISSION = SELECT DISTINCT HIPNUM_WARD_CODE||'\#'||(SELECT HGNUM_DEPTUNITCODE FROM HIPT_DUWRBED_MST A WHERE rownum\=1 AND HIPNUM_WARD_CODE\=X.HIPNUM_WARD_CODE AND TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE), HIPSTR_WARD_NAME FROM HIPT_WARD_MST X WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(SYSDATE) AND TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE))>\=TRUNC(SYSDATE) AND EXISTS (SELECT 1 FROM HIPT_DUWRBED_MST A WHERE TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND A.HIPNUM_WARD_CODE\=X.HIPNUM_WARD_CODE) AND EXISTS (SELECT 1 FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID\=B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME\='HIPT_WARD_MST' AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GBL_ISVALID\=? AND B.GBL_ISVALID\=? AND b.GSTR_COLUMN_NAME\='HIPNUM_WARD_CODE' AND A.GNUM_SEATID\=PKG_USERMGMT.FUN_GETSEATID (?,A.GNUM_HOSPITAL_CODE) AND GNUM_COLUMN_VALUE\=X.HIPNUM_WARD_CODE) ORDER BY HIPSTR_WARD_NAME

#Modified By Shruti Shail on 12-May-2017 for Ward Name
SELECT.HIPT_PATADMISSION_DTL.RETRIEVE_PATIENT = SELECT A.HIPNUM_ADMNO AS PATADMNO, A.HRGNUM_PUK AS PATCRNO, A.HRGNUM_EPISODE_CODE AS episodeCode, A.HRGNUM_VISIT_NO as episodeVisitNo, to_char(A.HIPDT_ADMDATETIME,'dd-Mon-yyyy') AS admDateTime, INITCAP (C.HRGSTR_FNAME) || ' ' || INITCAP (C.HRGSTR_MNAME) || ' ' || INITCAP (C.HRGSTR_LNAME) AS patname, (select GSTR_GENDER_CODE from GBLT_GENDER_MST where GSTR_GENDER_CODE\=C.GSTR_GENDER_CODE ) as patGender, C.GSTR_GENDER_CODE as patGenderCode, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) as patAge, (SELECT HGNUM_ISGENERAL  FROM HGBT_UNIT_MST x   WHERE x.hgnum_deptunitcode \= a.gnum_deptunit_code   AND x.gnum_hospital_code \= a.gnum_hospital_code   )  departmentunittype, pkg_clinical_gbl_fun.get_dept_name(to_char(A.GNUM_HOSPITAL_CODE), to_char(A.GNUM_DEPT_CODE)) || ' (' || pkg_clinical_gbl_fun.get_deptunit_name(to_char(A.GNUM_HOSPITAL_CODE), to_char(A.GNUM_DEPTUNIT_CODE)) || ')' AS departmentUnitName, (SELECT HGNUM_BED_NAME FROM HIPT_WARD_ROOM_BED_MST WHERE HGNUM_BED_CODE\=A.HIPNUM_BED_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=?) AS bedName,A.GNUM_DEPT_CODE as departmentCode, A.GNUM_DEPTUNIT_CODE as departmentUnitCode, (SELECT DECODE(hrgnum_mlc_flag,NULL,'0','1') FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK\=a.hrgnum_puk AND HRGNUM_EPISODE_CODE\=a.HRGNUM_EPISODE_CODE AND HRGNUM_VISIT_NO\=a.HRGNUM_VISIT_NO AND GNUM_ISVALID\=1 ANd GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) AS isMLC,a.HIPNUM_WARD_CODE as wardCode  ,(SELECT HIPSTR_WARD_NAME FROM HIPT_WARD_MST WHERE HIPNUM_WARD_CODE\= A.HIPNUM_WARD_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=1) as wardName FROM HIPT_PATADMISSION_DTL A,HIPT_PATADMDISC_DTL B, hrgt_patient_dtl c WHERE A.HRGNUM_PUK\=B.HRGNUM_PUK and A.HIPNUM_ADMNO\=B.HIPNUM_ADMNO AND a.hrgnum_puk \= c.hrgnum_puk AND A.HIPDT_ADMSTATUS_CODE IN (?,?) AND HIPNUM_ISACCEPTED\=? AND A.GNUM_ISVALID\=? AND A.GNUM_DEPTUNIT_CODE IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl y, gblt_metatable_column_mst z WHERE y.gnum_metatable_id \= z.gnum_metatable_id AND z.gstr_table_name \= 'HGBT_UNIT_MST' AND y.gnum_hospital_code \= ? AND z.gbl_isvalid \= 1 AND z.gbl_isvalid \= 1 AND z.gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND y.gnum_module_id \= 36 AND y.gnum_seatid \=pkg_usermgmt.fun_getseatid (?, ?))
												--AND A.HIPNUM_WARD_CODE=? 

SELECT.HIPT_PATADMISSION_DTL.RETRIEVE_PATIENT.COND.1	=	AND A.GNUM_DEPTUNIT_CODE = ?												
SELECT.HIPT_PATADMISSION_DTL.RETRIEVE_PATIENT.COND.2	=	AND A.HIPNUM_ROOM_CODE = ?												

SELECT.HIPT_PATADMISSION_DTL.RETRIEVE_PATIENT.COND.ORDER_BY	=	ORDER BY A.HIPDT_ADMDATETIME DESC												


SELECT.PAT_ROUND_CLI_DATA.HIPD_PAT_CLINICAL_DTL = SELECT HGNUM_TEMPLATE_ID AS templateId, HGNUM_PARA_ID AS paraId, HGSTR_PARA_VALUE AS paraValue FROM HIPD_PAT_CLINICAL_DTL WHERE HRGNUM_ADMISSION_NO\=? AND TO_CHAR(HRGDT_RECORD_DATE,'dd-Mon-yyyy')\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?\t\t\t             \t\t
												

#modifiedby:NehaRajgariya Date:28dec2016
ESSENTIAL.LIST.HIPD_INTAKEOUT_PARA_MST = SELECT HIPNUM_INTAKEOUT_PARA_ID, HIPSTR_INTAKEOUT_PARA_NAME, sctnum_id_inout_para_id as snomedParaId, sctstr_pterm_inout_para_id as snomedPtermPara FROM HIPD_INTAKEOUT_PARA_MST WHERE GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? AND HIPNUM_INTAKEOUT_PARA_TYPE \!\= ? ORDER BY HIPSTR_INTAKEOUT_PARA_NAME\t

											

ESSENTIAL.WARDLIST = SELECT DISTINCT a.hipnum_ward_code, INITCAP (e.gstr_dept_name)  || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) FROM HIPT_DUWRBED_MST a, HGBT_UNIT_MST b, HIPT_WARD_MST c, GBLT_DEPARTMENT_MST e WHERE a.gnum_dept_code \= e.gnum_dept_code AND a.gnum_hospital_code \= e.gnum_hospital_code AND a.hgnum_deptunitcode \= b.hgnum_deptunitcode AND a.gnum_hospital_code \= b.gnum_hospital_code AND c.hipnum_ward_code \= a.hipnum_ward_code AND a.gnum_hospital_code \= c.gnum_hospital_code AND TRUNC (SYSDATE) BETWEEN TRUNC (c.gdt_effective_frm) AND TRUNC (NVL (c.gdt_effective_to, SYSDATE ) ) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND b.gnum_isvalid \= ? AND c.gnum_isvalid \= ? AND e.gnum_isvalid \= ? AND a.hgnum_deptunitcode \= ? AND a.hipnum_ward_code NOT IN ( SELECT d.hipnum_ward_code FROM HGBT_DEPTUNITWISE_INV_MST d WHERE d.gnum_hospital_code \= ? AND d.gnum_isvalid \= ? AND d.hgnum_deptunitcode \= ? AND d.hipnum_ward_code IS NOT NULL) ORDER BY    INITCAP (e.gstr_dept_name) || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) 
                

ESSENTIAL.WARDLIST.WITHOUTUNITS = SELECT DISTINCT a.hipnum_ward_code, INITCAP (e.gstr_dept_name)  || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) FROM  HIPT_DUWRBED_MST a, HGBT_UNIT_MST b, HIPT_WARD_MST c, GBLT_DEPARTMENT_MST e WHERE a.gnum_hospital_code \= b.gnum_hospital_code and a.gnum_hospital_code \= c.gnum_hospital_code AND a.gnum_hospital_code \= e.gnum_hospital_code AND TRUNC (SYSDATE) BETWEEN TRUNC (c.gdt_effective_frm) AND TRUNC (NVL (c.gdt_effective_to, SYSDATE ) ) AND b.gnum_isvalid \= ? AND c.gnum_isvalid \= ? AND e.gnum_isvalid \= ? AND a.gnum_isvalid \= ? AND a.GNUM_HOSPITAL_CODE \= ? ORDER BY    INITCAP (e.gstr_dept_name) || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) 
           
           
SELECT.WARDSFORMODIFY = SELECT DISTINCT a.hipnum_ward_code, INITCAP (e.gstr_dept_name)  || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) FROM HIPT_DUWRBED_MST a, HGBT_UNIT_MST b, HIPT_WARD_MST c, GBLT_DEPARTMENT_MST e WHERE a.gnum_dept_code \= e.gnum_dept_code AND a.gnum_hospital_code \= e.gnum_hospital_code AND a.hgnum_deptunitcode \= b.hgnum_deptunitcode AND a.gnum_hospital_code \= b.gnum_hospital_code AND c.hipnum_ward_code \= a.hipnum_ward_code AND a.gnum_hospital_code \= c.gnum_hospital_code AND TRUNC (SYSDATE) BETWEEN TRUNC (c.gdt_effective_frm) AND TRUNC (NVL (c.gdt_effective_to, SYSDATE ) ) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND b.gnum_isvalid \= ? AND c.gnum_isvalid \= ? AND e.gnum_isvalid \= ? AND a.hgnum_deptunitcode \= ? ORDER BY    INITCAP (e.gstr_dept_name) || ' (' || INITCAP (b.hgstr_unitname) || ') - ' || INITCAP (c.hipstr_ward_name) \t\t\t\t\t\t\t
 
SELECT.WARDNAMEFORMODIFY = SELECT DISTINCT a.HIPNUM_WARD_CODE, a.hgnum_deptunitcode, b.HIPSTR_WARD_NAME FROM HGBT_DEPTUNITWISE_INV_MST a, HIPT_WARD_MST b WHERE a.gnum_hospital_code \= ? AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_isvalid \= ? AND a.gnum_isvalid \= b.gnum_isvalid AND a.HIPNUM_WARD_CODE\=b.HIPNUM_WARD_CODE AND a.HGNUM_DEPTUNITCODE \= ? AND A.HGNUM_SLNO \= ?
         
SELECT.WARDLIST = SELECT A.HIPNUM_WARD_CODE, B. 


DISTINCT A.HGNUM_ISDEFAULT,A.GNUM_DESK_MENU_ID||'&'||INITCAP(B.GSTR_DESK_MENU_NAME)||'\#'||A.HGNUM_TEMPLATE_ID||'&'||INITCAP(C.HGSTR_TEMPLATE_NAME) FROM GBLT_USER_DESKMENU_TEMPLATE A, GBLT_DESK_MENU_MST B,HGBT_TEMPLATE_MST C WHERE A.GNUM_DESK_MENU_ID\=B.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.HGNUM_TEMPLATE_ID\=C.HGNUM_TEMPLATE_ID AND A.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE AND TRUNC(SYSDATE) BETWEEN TRUNC(C.GDT_EFFECTIVE_FRM) AND TRUNC(NVL(C.GDT_EFFECTIVE_TO,SYSDATE)) AND A.HGNUM_DEPTUNITCODE\=? AND A.GNUM_DESK_ID\=? AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND A.HIPNUM_WARD_CODE \= ? AND A.GNUM_USERSEAT_ID \= ?
         
#Modified by Vasu on 14.March.2019
SELECT_MODE.HIPD_MONITORING_MODE_MST = SELECT HIPNUM_MODE_ID as modeId, HIPSTR_MODE_NAME as modeName, HIPNUM_DAY_FREQ as dayFrequency, HIPNUM_INTERVAL_INMIN as intervalInMin FROM HIPD_MONITORING_MODE_MST WHERE GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= 100 ORDER BY HIPSTR_MODE_NAME


COUNT_TOTAL_ADMITTED_PAT.HIPT_PATADMISSION_DTL = SELECT COUNT(*) FROM HIPT_PATADMISSION_DTL WHERE  HIPDT_ADMSTATUS_CODE IN (?,?) AND HIPNUM_ISACCEPTED\=? AND HIPNUM_WARD_CODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? 

COUNT_TOTAL_ADMITTED_PAT.HIPT_PATADMISSION_DTL.COND.1	=	AND GNUM_DEPTUNIT_CODE = ? 
COUNT_TOTAL_ADMITTED_PAT.HIPT_PATADMISSION_DTL.COND.2	=	AND HIPNUM_ROOM_CODE = ?


COUNT_ADMITTED_PAT_TODAY.HIPT_PATADMISSION_DTL = SELECT COUNT(*) FROM HIPT_PATADMISSION_DTL WHERE  HIPDT_ADMSTATUS_CODE IN (?,?) AND HIPNUM_ISACCEPTED\=? AND TRUNC(HIPDT_ADMDATETIME)\=TRUNC(SYSDATE) AND HIPNUM_WARD_CODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ?\t

COUNT_ADMITTED_PAT_TODAY.HIPT_PATADMISSION_DTL.COND.1	=	AND GNUM_DEPTUNIT_CODE = ?
COUNT_ADMITTED_PAT_TODAY.HIPT_PATADMISSION_DTL.COND.2	=	AND HIPNUM_ROOM_CODE = ?

COUNT_DISCHARGED_PAT_TODAY.HIPT_PATADMISSION_DTL = SELECT COUNT(*) FROM HIPT_PATADMISSION_DTL WHERE  HIPDT_ADMSTATUS_CODE \= ? AND TRUNC(HIPDT_DISDATETIME)\=TRUNC(SYSDATE) AND HIPNUM_WARD_CODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ?

COUNT_DISCHARGED_PAT_TODAY.HIPT_PATADMISSION_DTL.COND.1	=	AND GNUM_DEPTUNIT_CODE = ? 
COUNT_DISCHARGED_PAT_TODAY.HIPT_PATADMISSION_DTL.COND.2	=	AND HIPNUM_ROOM_CODE = ?

ROOM_LIST.HIPT_DUWRBED_MST.RETRIEVE_BY_DEPTUNITCODE = SELECT DISTINCT A.HIPNUM_ROOM_NO,(SELECT HIPSTR_ROOM_DESC FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=A.HIPNUM_ROOM_NO AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE ) FROM HIPT_DUWRBED_MST A WHERE HGNUM_DEPTUNITCODE \= ? AND  GDT_EFFECTIVE_FRM < SYSDATE AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND HIPNUM_WARD_CODE \= ? AND HIPNUM_ROOM_NO IN (SELECT HIPNUM_ROOM_NO FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO \= A.HIPNUM_ROOM_NO AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ?)



GET_MACRO_BY_PROCESSID.HGBT_MACRO_MST = SELECT HGSTR_MACRO_HEADER, HGSTR_MACRO_DESC FROM HGBT_MACRO_MST WHERE GNUM_HOSPITAL_CODE = ? AND HGNUM_PROCESS_ID = ? AND GNUM_ISVALID = ? ORDER BY HGSTR_MACRO_HEADER


SELECT_ROUTE_BY_TYPE.HIPD_INTAKEOUT_ROUTE_MST = SELECT HIPNUM_ROUTE_ID, HIPSTR_ROUTE_NAME FROM HIPD_INTAKEOUT_ROUTE_MST WHERE GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID = ? AND HIPNUM_ROUTE_TYPE != ? ORDER BY HIPSTR_ROUTE_NAME




SELECT_ALL.INPATIENT_BULLETIN_DETAIL	= SELECT distinct a.hrgnum_puk patCrNo,hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname patName, (SELECT gstr_gender_short FROM gblt_gender_mst WHERE gnum_gender_code \= b.gnum_gender_code AND gnum_isvalid \= 1 AND gnum_hospital_code \= 100)|| '/' || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) patAge, hrgnum_status_code, a.hrgnum_admission_no patAdmNo, hipstr_remarks patRemarks,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= c.gnum_dept_code AND gnum_isvalid \= c.gnum_isvalid  AND gnum_hospital_code \= c.gnum_hospital_code) departmentName, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= c.hgnum_deptunitcode AND gnum_isvalid \= c.gnum_isvalid AND gnum_hospital_code \= c.gnum_hospital_code) departmentUnitName, (select HIPSTR_WARDTYPENAME from hipt_ward_mst a,HIPT_WARDTYPE_MST b where HIPNUM_WARD_CODE\=d.HIPNUM_WARD_CODE and a.HIPNUM_WARDTYPE_CODE\=b.HIPNUM_WARDTYPE_CODE and a.gnum_hospital_code\=b.gnum_hospital_code and a.gnum_hospital_code\=d.gnum_hospital_code and a.gnum_isvalid\=b.gnum_isvalid and a.gnum_isvalid\=d.gnum_isvalid) wardType FROM hipd_pat_bulletin_dtl a, hrgt_patient_dtl b, hrgt_episode_dtl c, hipt_duwrbed_mst d WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hrgnum_puk \= b.hrgnum_puk AND a.hrgnum_puk \= c.hrgnum_puk  and d.HGNUM_DEPTUNITCODE\=c.hgnum_deptunitcode AND a.gnum_isvalid \= b.gnum_isvalid AND a.gnum_isvalid \= c.gnum_isvalid AND d.gnum_isvalid \= b.gnum_isvalid\tAND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND b.hgnum_pat_status_code \= 11 AND d.gnum_hospital_code \= b.gnum_hospital_code\tAND c.hrgnum_visit_no \=(SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid AND hrgnum_puk \= c.hrgnum_puk) and HRGNUM_S_NO\=(select max(HRGNUM_S_NO) from hipd_pat_bulletin_dtl where gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid AND hrgnum_puk \= a.hrgnum_puk)


SELECT.PREV_DRUG_SCHEDULE.HRGT_EPISODE_DRUG_SCHEDULE_DTL = SELECT hrgnum_puk as patCrNo, hrgnum_episode_code as episodeCode, hrgnum_s_no as serialNo , hrgnum_schedule_slno as sheduleSerialNo, hrgnum_visit_no as episodeVisitNo, hstnum_item_id as itemTypeId, hgnum_dose_id as doseId, gnum_seat_id as seatId, hgstr_dose_name as doseName, hgstr_dose_time as doseTime, gdt_entry_date as entryDate, hgnum_isempty_stomach as isEmptyStomach, gnum_isvalid as isValid,  hgnum_dose_shift as doseShift, hrgstr_remarks as remark, gnum_hospital_code as hospitalCode FROM hrgt_episode_drug_schedule_dtl where  HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? 
 													 	#select CNUM_ROUTE_NAME from CIMS_DRUG_ADMIN_ROUTE_MST_SYS where CNUM_ROUTE_ID=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID=?					

#Modified by Vasu on 28.Sept.2018
SELECT.PREVIOUS_DRUG_DETAIL.HRGT_EPISODE_DRUG_DTL	= SELECT HRGNUM_PUK AS patCrNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo, HRGNUM_S_NO AS serialNo, HSTNUM_ITEM_ID AS drugId, HSTSTR_ITEM_NAME AS drugName, HGNUM_DOSE_ID AS doseId, HGSTR_DOSE_NAME AS doseName, HGNUM_FREQUENCY_ID AS frequencyId, HGNUM_DAYS AS days, to_char(HRGDT_START_DATE,'dd-Mon-yyyy') AS startDate,to_char( HRGDT_END_DATE,'dd-Mon-yyyy') AS endDate, PSRSTR_EMP_NO AS empNo, HBNUM_RX_CONTINUE AS rxContinue, HRGSTR_REMARKS AS remarks, GNUM_SEAT_ID AS seatId, TO_CHAR(GDT_ENTRY_DATE, 'dd-Mon-yyyy') AS entryDate, HGNUM_ISEMPTY_STOMACH as drugAdminId,  (select d.cstr_admin_name from cims_drug_admin_mst_sys d where d.cnum_admin_id\=HGNUM_ISEMPTY_STOMACH and d.gnum_isvalid\=1) as drugAdminName, '0' as isEmptyStomach ,HGNUM_DRUG_ROUTE_ID as drugRouteId , (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=?)  AS drugRouteName,(select HGSTR_FREQUENCY_NAME from HGBT_DRUG_FREQUENCY_MST where HGNUM_FREQUENCY_ID\=b.HGNUM_FREQUENCY_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=100 ) as frequencyName  FROM HRGT_EPISODE_DRUG_DTL b WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? and trunc(sysdate) >\= trunc(HRGDT_START_DATE) and trunc(sysdate)<\=trunc(HRGDT_END_DATE) ORDER BY HRGNUM_VISIT_NO, HRGNUM_S_NO
#SELECT.PREVIOUS_DRUG_DETAIL.HRGT_EPISODE_DRUG_DTL = SELECT 0 as opdIpdFlag, HRGNUM_PUK AS patCrNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo, HRGNUM_S_NO AS serialNo, HSTNUM_ITEM_ID AS drugId, hststr_itembrand_name AS drugName, nvl(hstnum_itembrand_id,0) as drugBrandId, HGNUM_DOSE_ID AS doseId, HGSTR_DOSE_NAME AS doseName, HGNUM_FREQUENCY_ID AS frequencyId, HGNUM_DAYS AS days, to_char(HRGDT_START_DATE,'dd-Mon-yyyy') AS startDate,to_char( HRGDT_END_DATE,'dd-Mon-yyyy') AS endDate, PSRSTR_EMP_NO AS empNo, HBNUM_RX_CONTINUE AS rxContinue, HRGSTR_REMARKS AS remarks, GNUM_SEAT_ID AS seatId, TO_CHAR(GDT_ENTRY_DATE, 'dd-Mon-yyyy') AS entryDate,HGNUM_ISEMPTY_STOMACH as drugAdminId,HGNUM_DRUG_ROUTE_ID as drugRouteId, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as drugRouteName ,(SELECT  d.cstr_admin_name  FROM cims_drug_admin_mst_sys d where d.cnum_admin_id\=HGNUM_ISEMPTY_STOMACH and  d.gnum_isvalid\=1) as drugAdminName, (select HGSTR_FREQUENCY_NAME from HGBT_DRUG_FREQUENCY_MST where HGNUM_FREQUENCY_ID\=b.HGNUM_FREQUENCY_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? ) as frequencyName ,HGNUM_DOSE_QTY as doseQty , HSTNUM_ISSUE_QTY as issueQty , HSTNUM_REQUIRED_QTY as requiredQty, (select STR_EMP_FULL_NAME from PIST_EMP_REGISTRATION_DTL x where b.PSRSTR_EMP_NO\=x.STR_EMP_NO and b.GNUM_ISVALID\=x.GNUM_ISVALID and b.GNUM_HOSPITAL_CODE\=x.GNUM_HOSPITAL_CODE) as empName,HRGDT_START_DATE as orderByDate FROM HRGT_EPISODE_DRUG_DTL b WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?  union SELECT 1 as opdIpdFlag , HRGNUM_PUK AS patCrNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, HRGNUM_ADMISSION_NO AS admissionNo,HPMRNUM_ITEM_SRNO AS serialNo ,  HSTNUM_ITEM_ID AS drugId, HSTSTR_ITEM_NAME AS drugName, nvl(hstnum_itembrand_id,0) as drugBrandId, HGNUM_DOSE_ID AS doseId, HGSTR_DOSE_NAME AS doseName, HGNUM_FREQUENCY_ID AS frequencyId, HGNUM_DAYS AS days, to_char(HRGDT_START_DATE,'dd-Mon-yyyy') AS startDate,to_char( HRGDT_END_DATE,'dd-Mon-yyyy') AS endDate, PSRSTR_EMP_NO AS empNo, HBNUM_RX_CONTINUE AS rxContinue, HRGSTR_REMARKS AS remarks, a.GNUM_SEAT_ID AS seatId, TO_CHAR(a.GDT_ENTRY_DATE, 'dd-Mon-yyyy') AS entryDate,HGNUM_ISEMPTY_STOMACH as drugAdminId,HGNUM_DRUG_ROUTE_ID as drugRouteId,  (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=a.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as drugRouteName , (SELECT  d.cstr_admin_name  FROM cims_drug_admin_mst_sys d where d.cnum_admin_id\=HGNUM_ISEMPTY_STOMACH and  d.gnum_isvalid\=1) as drugAdminName, (select HGSTR_FREQUENCY_NAME from HGBT_DRUG_FREQUENCY_MST where HGNUM_FREQUENCY_ID\=a.HGNUM_FREQUENCY_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? ) as frequencyName ,HGNUM_DOSE_QTY as doseQty , HSTNUM_ISSUE_QTY as issueQty , HSTNUM_REQUIRED_QTY as requiredQty, (select STR_EMP_FULL_NAME from PIST_EMP_REGISTRATION_DTL x where a.PSRSTR_EMP_NO\=x.STR_EMP_NO and b.GNUM_ISVALID\=x.GNUM_ISVALID and b.GNUM_HOSPITAL_CODE\=x.GNUM_HOSPITAL_CODE) as empName,HRGDT_START_DATE as orderByDate  FROM hpmrt_profile_drug_advice_dtl a, hpmrt_pat_profile_dtl b WHERE a.hpmrnum_profile_id \= b.hpmrnum_profile_id AND a.gnum_isvalid \= b.gnum_isvalid AND a.gnum_hospital_code \= b.gnum_hospital_code AND hrgnum_puk \= ? AND hrgnum_episode_code \= ? AND a.gnum_hospital_code \= ? and  b.gnum_isvalid\=? AND a.HRGNUM_ENTRY_MODE\=1 ORDER BY orderByDate 

ESSENTIAL.HGBT_DRUG_FREQUENCY_MST	=SELECT HGNUM_FREQUENCY_ID, INITCAP(HGSTR_FREQUENCY_NAME) FROM HGBT_DRUG_FREQUENCY_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t\t\t \t\t\t\t\t\t

# Commented By: Chetan Sharma 
# Reason:       Not in Use.
# Date:         2015_11_30

#ESSENTIAL.LIST.HSTT_DRUGBRAND_MST	=	SELECT HSTNUM_ITEMBRAND_ID||'#'||HSTNUM_ITEMTYPE_ID ||'#'||(select count(*) from HPMRT_FLAG_MST where HPMRNUM_TABLE_ID=4 and HPMRSTR_FLAG_DESC=b.HSTNUM_ITEMTYPE_ID ), INITCAP(HSTSTR_ITEM_NAME) FROM HSTT_DRUGBRAND_MST b \
#										WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?

SELECT_DRUG_FREQ_VO_LIST.HGBT_DRUG_FREQUENCY_MST = SELECT hgnum_frequency_id as frequencyId, hgnum_slno as serialNo, hgstr_frequency_name as frequencyName, hbstr_freq_scedule as frequencySchedule, hgstr_freq_desc as frequencyDesc, gnum_seat_id as seatId, gdt_entry_date as entryDate, hgnum_frequency as frequency, hgstr_mor_dose_time as morDoseTime, hgstr_aft_dose_time as aftDoseTime, hgstr_eve_dose_time as eveDoseTime, hgstr_ngt_dose_time as ngtDoseTime FROM hgbt_drug_frequency_mst where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t\t
 													 							
 # MODIFIED FOR CIMS INTEGRATION	date: 10.05.2016  'drug route from CIMS_DRUG_ADMIN_ROUTE_MST_SYS'	 select CNUM_ROUTE_NAME from CIMS_DRUG_ADMIN_ROUTE_MST_SYS where CNUM_ROUTE_ID=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID=?
ESSENTIAL.LIST.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo ,HRGNUM_EPISODE_CODE as episodeCode ,to_char(HRGDT_ADMINISTRATION_DATE,'dd-Mon-yyyy') as administrationDate, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo,HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,HGNUM_DOSE_ID as doseId,HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, GNUM_SEAT_ID as seatId,GDT_ENTRY_DATE as entryDate,HSTSTR_BATCH_NO as batchNo,GNUM_ISVALID as isValid,to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate,HGSTR_DOSE_NAME as doseName,HGNUM_DRUG_ROUTE_ID as drugRouteId,  HRGSTR_REMARKS as remarks,HGNUM_ISEMPTY_STOMACH as isEmptyStomach,HSTSTR_ITEM_NAME as itemName,GNUM_HOSPITAL_CODE as hospitalCode,PSRSTR_EMP_NO as empNo, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=?) as drugRouteName, hstnum_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName from HRGT_EPISODE_DRUG_ADMIN_DTL b where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=?\tand trunc(HRGDT_ADMINISTRATION_DATE)\=trunc(sysdate)\tand HRGNUM_EPISODE_CODE\=? order by HRGDT_ADMINISTRATION_DATE,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')\t
 											
ESSENTIAL.LIST_BY_DRUG.HRGT_EPISODE_DRUG_ADMIN_DTL.OLD = select HRGNUM_PUK as patCrNo ,HRGNUM_EPISODE_CODE as episodeCode ,to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy') as administrationDate, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo,HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')as administrationTime,HGNUM_DOSE_ID as doseId,HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, GNUM_SEAT_ID as seatId,GDT_ENTRY_DATE as entryDate,HSTSTR_BATCH_NO as batchNo,GNUM_ISVALID as isValid,to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate,HGSTR_DOSE_NAME as doseName,HGNUM_DRUG_ROUTE_ID as drugRouteId,  HRGSTR_REMARKS as remarks,HGNUM_ISEMPTY_STOMACH as isEmptyStomach,HSTSTR_ITEM_NAME as itemName,GNUM_HOSPITAL_CODE as hospitalCode,PSRSTR_EMP_NO as empNo, HRGNUM_VOLUME as volume , (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_ACTUAL_DRUG_ROUTE_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE) as drugRouteName from HRGT_EPISODE_DRUG_ADMIN_DTL b where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=?\tand HSTNUM_ITEM_ID\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?) order by HRGDT_SCHEDULE_DATE,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')

 # MODIFIED FOR CIMS INTEGRATION	date: 10.05.2016  'drug route from CIMS_DRUG_ADMIN_ROUTE_MST_SYS'	
ESSENTIAL.LIST_BY_DRUG.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo ,HRGNUM_EPISODE_CODE as episodeCode ,to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy') as administrationDate, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo,HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')as administrationTime,HGNUM_DOSE_ID as doseId,HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, GNUM_SEAT_ID as seatId,GDT_ENTRY_DATE as entryDate,HSTSTR_BATCH_NO as batchNo,GNUM_ISVALID as isValid,to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate,HGSTR_DOSE_NAME as doseName,HGNUM_DRUG_ROUTE_ID as drugRouteId,  HRGSTR_REMARKS as remarks,HGNUM_ISEMPTY_STOMACH as isEmptyStomach,HSTSTR_ITEM_NAME as itemName,GNUM_HOSPITAL_CODE as hospitalCode,PSRSTR_EMP_NO as empNo, HRGNUM_VOLUME as volume , (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_ACTUAL_DRUG_ROUTE_ID and GNUM_ISVALID\=?) as drugRouteName, hstnum_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName from HRGT_EPISODE_DRUG_ADMIN_DTL b where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=?\tand HSTNUM_ITEM_ID\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?) order by HRGDT_SCHEDULE_DATE,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')
 
 
 # MODIFIED FOR CIMS INTEGRATION	date: 10.05.2016  'drug route from CIMS_DRUG_ADMIN_ROUTE_MST_SYS'									
ESSENTIAL.LIST_BY_DATE.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo ,HRGNUM_EPISODE_CODE as episodeCode ,to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy') as administrationDate, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo,HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,HGNUM_DOSE_ID as doseId,HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, GNUM_SEAT_ID as seatId,GDT_ENTRY_DATE as entryDate,nvl(HSTSTR_BATCH_NO,'-') as batchNo,GNUM_ISVALID as isValid,nvl(to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy'),'-') as expiryDate,HGSTR_DOSE_NAME as doseName,HGNUM_DRUG_ROUTE_ID as drugRouteId,  HRGSTR_REMARKS as remarks,HGNUM_ISEMPTY_STOMACH as isEmptyStomach,HSTSTR_ITEM_NAME as itemName,GNUM_HOSPITAL_CODE as hospitalCode,PSRSTR_EMP_NO as empNo, HRGNUM_VOLUME as volume, nvl((select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=?),'-') AS drugRouteName, hstnum_itembrand_id as drugBrandId, NVL(hststr_itembrand_name,HSTSTR_ITEM_NAME) as drugBrandName from HRGT_EPISODE_DRUG_ADMIN_DTL b where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=?\tAND TRUNC(HRGDT_ADMINISTRATION_TIME) >\=to_date(?,'dd-Mon-yyyy') AND TRUNC(HRGDT_ADMINISTRATION_TIME) <\=to_date (?,'dd-Mon-yyyy') and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?) order by to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy'),to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')

  # MODIFIED FOR CIMS INTEGRATION	date: 10.05.2016  'drug route from CIMS_DRUG_ADMIN_ROUTE_MST_SYS'	
ESSENTIAL.LIST_BY_END_DATE.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo ,to_char(HRGDT_ADVICE_DATE,'dd-Mon-yyyy') as adviceDate, HRGNUM_S_NO as serialNo , HSTSTR_ITEM_NAME as itemName ,HGSTR_DOSE_NAME as doseName,HSTNUM_ITEM_ID as itemId, HGNUM_DRUG_ROUTE_ID as drugRouteId, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=a.HGNUM_DRUG_ROUTE_ID and GNUM_ISVALID\=a.GNUM_ISVALID) as drugRouteName, hstnum_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName, to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,HSTSTR_BATCH_NO as batchNo, to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate ,HRGSTR_REMARKS as remarks ,HGSTR_DOSE_TIME as doseTime,HRGNUM_VOLUME as volume from HRGT_EPISODE_DRUG_ADMIN_DTL a where HRGNUM_PUK\=?  and HRGNUM_ADMIN_FLAG\=? and HRGDT_ADMINISTRATION_TIME IS NOT NULL and HRGDT_ADMINISTRATION_ENDTIME IS NULL and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?

ESSENTIAL_LIST_BY_CRNO.HRGT_EPISODE_DRUG_ADMIN_DTL = select distinct HSTNUM_ITEM_ID,HSTSTR_ITEM_NAME from HRGT_EPISODE_DRUG_ADMIN_DTL where HRGNUM_PUK\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_ADMIN_FLAG not in (?) order by HSTSTR_ITEM_NAME
 
 # MODIFIED FOR CIMS INTEGRATION	date: 10.05.2016  'drug route from CIMS_DRUG_ADMIN_ROUTE_MST_SYS' select CNUM_ROUTE_NAME from CIMS_DRUG_ADMIN_ROUTE_MST_SYS where CNUM_ROUTE_ID=b.HGNUM_ACTUAL_DRUG_ROUTE_ID and GNUM_ISVALID=?	
ESSENTIAL.ALL_LIST.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo ,HRGNUM_EPISODE_CODE as episodeCode ,to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy') as administrationDate,to_char(HRGDT_ADVICE_DATE,'dd-Mon-yyyy') as adviceDate , HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo,HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,HGNUM_DOSE_ID as doseId,HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, GNUM_SEAT_ID as seatId,GDT_ENTRY_DATE as entryDate,HSTSTR_BATCH_NO as batchNo,GNUM_ISVALID as isValid,to_char(HSTDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate,HGSTR_ACTUAL_DOSE_NAME as doseName,HGNUM_ACTUAL_DRUG_ROUTE_ID as drugRouteId,  HRGSTR_REMARKS as remarks,HGNUM_ISEMPTY_STOMACH as isEmptyStomach,hststr_actual_itembrand_name as itemName,GNUM_HOSPITAL_CODE as hospitalCode,PSRSTR_EMP_NO as empNo, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST where HGNUM_DRUG_ROUTE_ID\=b.HGNUM_ACTUAL_DRUG_ROUTE_ID and GNUM_ISVALID\=?) as drugRouteName, hstnum_actual_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName from HRGT_EPISODE_DRUG_ADMIN_DTL b where GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HRGNUM_PUK\=?\tand HRGNUM_EPISODE_CODE\=? and HRGNUM_IS_REACTION\=? and HRGNUM_ADMIN_FLAG not in (?) order by HRGDT_SCHEDULE_DATE,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi')

// Modified to fetch actual item brand id and actual item brand name by Shruti Shail date 10-Nov-16


FETCH.CONSULTANT.LIST = SELECT a.hgstr_emp_code ||'#'||initcap(b.str_emp_full_name) AS empno, initcap(b.str_emp_full_name) empname FROM PIST_EMP_REGISTRATION_DTL b,  HGBT_UNIT_CONSULTANT_MST a WHERE  a.hgnum_deptunitcode = ? AND  a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND  b.str_emp_no = a.hgstr_emp_code AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID=b.GNUM_ISVALID ORDER BY initcap(b.str_emp_full_name)   
			
FETCH.ALLCONSULTANT.LIST =SELECT   DISTINCT(a.hgstr_emp_code||'#'|| initcap(b.str_emp_full_name)) AS empno, INITCAP(b.str_emp_full_name) empname FROM PIST_EMP_REGISTRATION_DTL b, HGBT_UNIT_CONSULTANT_MST a WHERE a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND b.str_emp_no = a.hgstr_emp_code AND a.gnum_hospital_code = b.gnum_hospital_code AND a.gnum_isvalid = b.gnum_isvalid ORDER BY   INITCAP(b.str_emp_full_name)


ESSENTIAL.DATE_LIST.HRGT_EPISODE_DRUG_ADMIN_DTL = select distinct to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy'),to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy') from HRGT_EPISODE_DRUG_ADMIN_DTL where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?	and HRGNUM_PUK=? and HRGNUM_EPISODE_CODE=?	and HRGNUM_ADMIN_FLAG not in (?) and HRGNUM_IS_REACTION=?															 																																													         



ESSENTIAL.LIST.HBBT_BLDREQ_COMPONENT_DTL = select a.HBNUM_REQ_NO as requisitionNo,(select HBSTR_COMPONENT_NAME from HBBT_BLD_COMPONENT_MST where HBNUM_BLD_COMPONENT_ID\=a.HBNUM_BLD_COMPONENT_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as bloodComponentName,(select HBSTR_BLDGRP from HBBT_BLDGRP_MST where HBNUM_BLDGRP_CODE\=a.HBNUM_BLDGRP_CODE and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as bloodGroup,to_char(a.HBDT_REQUIREMENT_DATE,'dd-Mon-yyyy') as requirementDate,a.HBNUM_NOOF_UNIT_DEMANDED as noOfUnitDemanded, a.HBNUM_REQ_STATUS  as componentReqStatus, b.HBNUM_REQ_STATUS as requisitionStatus ,a.HBNUM_NOOF_UNIT_ACCEPTED as noOfUnitAccepted, (select count(*) from HBBT_PAT_BLDSTOCK_DTL where HRGNUM_PUK \=  ? and HBNUM_REQ_NO \= a.hbnum_req_no and HBNUM_STOCK_STATUS \= ?) as noOfUnitInStock from HBBT_BLDREQ_COMPONENT_DTL  a ,hbbt_bldreq_dtl b, hbbt_bldreq_patient_dtl c  where a.HBNUM_REQ_NO IN (SELECT hbnum_req_no FROM hbbt_bldreq_patient_dtl WHERE hrgnum_puk \= ? AND hrgnum_episode_code \= ?) and a.HBNUM_REQ_NO\=b.HBNUM_REQ_NO and b.HBNUM_REQ_NO\=c.HBNUM_REQ_NO and b.hbnum_req_type in (?,?)\tand a.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE and b.GNUM_HOSPITAL_CODE\=c.GNUM_HOSPITAL_CODE\t and a.GNUM_HOSPITAL_CODE\=? and a.GNUM_ISVALID\=? order by requirementDate
											 

ESSENTIAL.SELECT_ALL.HBBT_COMPONENT_MST  = select hbnum_bld_component_id, hbstr_component_name FROM hbbt_bld_component_mst WHERE gnum_hospital_code = 100 AND gnum_isvalid = ? order by hbnum_bld_component_id

SELECT.HBSTR_BLD_ABO.HBBT_BLDABO_MST= select HBSTR_BLD_ABO,HBSTR_BLD_ABO from HBBT_BLDABO_MST where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE = 100

ESSENTIAL.BLOODBAG_STOCK_LIST.HBBT_PAT_BLDSTOCK_DTL = select HBNUM_REQ_NO as requisitionNo,to_char(HRGDT_STOCK_DATE,'dd-mm-yyyy') as stockDate ,HRGNUM_SLNO as serialNo , (select HBSTR_COMPONENT_NAME from HBBT_BLD_COMPONENT_MST  where HBNUM_BLD_COMPONENT_ID\=a.HBNUM_BLD_COMPONENT_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as componentName, (select HBSTR_BLDGRP from HBBT_BLDGRP_MST where HBNUM_BLDGRP_CODE\=a.HBNUM_BLDGRP_CODE and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as bloodGroup, to_char(HBDT_BLDBAG_EXPIRY,'dd-Mon-yyyy') as bloodBagExpiry ,HBNUM_SAURCE_FLAG as sourceFlag,HBSTR_BLDBAG_NO as bloodBagNo,HBNUM_BLDBAG_SEQNO as bloodBagSequenceNo,HBNUM_STOCK_STATUS as StockStatus from HBBT_PAT_BLDSTOCK_DTL a where HRGNUM_PUK\=? and HBNUM_STOCK_STATUS in (?,?)  and trunc(HBDT_BLDBAG_EXPIRY)>\=trunc(sysdate) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\torder by HBNUM_REQ_NO , HBNUM_STOCK_STATUS\t
														
														
ESSENTIAL.CROSS_MATCH_LIST.HBBT_CROSSMATCH_DTL = select HBNUM_REQ_NO as requisitionNo, HBSTR_BLDBAG_NO as bloodBagNo,HBNUM_CROSS_SEQNO as bloodBagSequenceNo, (select HBSTR_BLDGRP from HBBT_BLDGRP_MST where HBNUM_BLDGRP_CODE\=(select HBNUM_BLDGRP_CODE from HBBT_BLDBAG_DTL where HBSTR_BLDBAG_NO\= a.HBSTR_BLDBAG_NO and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) and GNUM_ISVALID\=?  and GNUM_HOSPITAL_CODE\=?) as bloodGroup, (select HBSTR_COMPONENT_NAME from HBBT_BLD_COMPONENT_MST  where HBNUM_BLD_COMPONENT_ID\=(select HBNUM_BLD_COMPONENT_ID from HBBT_BLDBAG_COMPONENT_DTL where HBSTR_BLDBAG_NO\=a.HBSTR_BLDBAG_NO and HBNUM_BLDBAG_SEQNO\=a.HBNUM_BLDBAG_SEQNO and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE)  and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as componentName, (select TO_CHAR(HBDT_BLDBAG_EXPIRY,'dd-Mon-yyyy') from HBBT_BLDBAG_COMPONENT_DTL where HBSTR_BLDBAG_NO\=a.HBSTR_BLDBAG_NO and HBNUM_BLDBAG_SEQNO\=a.HBNUM_BLDBAG_SEQNO and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as bloodBagExpiry from HBBT_CROSSMATCH_DTL a where HBNUM_CROSSMATCHED_FLAG\=? and  HBNUM_REQ_NO\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? 

ESSENTIAL.BLOOD_TRANS_LIST.HBBT_TRANSFUSSION_DTL = SELECT a.HRGNUM_PUK as patCrNo, a.HBSTR_BLDBAG_NO as bloodBagNo, a.HBNUM_BLDBAG_SEQNO as bloodBagSequenceNo, to_char(HRGDT_TRANSFUSSION_DATE,'dd-Mon-yyyy') as transfussionDate, to_char(HBDT_TRANSFUSSION_ENDTIME,'hh24\:mi') as transfussionEndTime, to_char(HBDT_TRANSFUSSION_STARTTIME,'hh24\:mi') as transfussionStartTime, HBNUM_PHLEBOTOMY_ARM as phlebotomyArm,  hbstr_bag_batchno as bagBatchNo, to_char(hbdt_bldbag_expiry,'dd-Mon-yyyy') as bloodBagExpiry, hbnum_saurce_flag as sourceFlag, b.HBNUM_REQ_NO as requisitionNo,to_char(HRGDT_STOCK_DATE,'dd-mm-yyyy') as stockDate, HRGNUM_SLNO as stockBagSerialNo,  (SELECT hbstr_bldgrp FROM hbbt_bldgrp_mst WHERE hbnum_bldgrp_code \= b.hbnum_bldgrp_code AND gnum_isvalid \= ? AND gnum_hospital_code \= ?) as bloodGroup, (SELECT hbstr_component_name FROM hbbt_bld_component_mst WHERE hbnum_bld_component_id \= b.hbnum_bld_component_id AND gnum_isvalid \= ? AND gnum_hospital_code \= ?) as componentName FROM HBBT_TRANSFUSSION_DTL a, hbbt_pat_bldstock_dtl b WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.hbstr_bldbag_no \= a.hbstr_bldbag_no AND (   (b.hbnum_bldbag_seqno IS NULL AND a.hbnum_bldbag_seqno IS NULL) OR b.hbnum_bldbag_seqno \= a.hbnum_bldbag_seqno ) AND b.gnum_hospital_code \= a.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid AND a.hrgnum_puk \= ? AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND b.HBNUM_ISREACTION\=?


SELECT_ROUND_BY_LIST.HGBT_UNIT_CONSULTANT_MST = SELECT A.HGSTR_EMP_CODE AS EMPNO, (SELECT B.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL B WHERE B.STR_EMP_NO \= A.HGSTR_EMP_CODE AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE) AS EMPNAME FROM HGBT_UNIT_CONSULTANT_MST A WHERE A.HGNUM_DEPTUNITCODE \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_ISVALID \= ?

ESSENTIAL.NOTTRANSFUSED_BLOODBAG_STOCK_LIST_BY_CRNO.HBBT_PAT_BLDSTOCK_DTL = select HBNUM_REQ_NO as requisitionNo,to_char(HRGDT_STOCK_DATE,'dd-mm-yyyy') as stockDate ,HRGNUM_SLNO as serialNo , (select HBSTR_COMPONENT_NAME from HBBT_BLD_COMPONENT_MST  where HBNUM_BLD_COMPONENT_ID\=a.HBNUM_BLD_COMPONENT_ID and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as componentName, (select HBSTR_BLDGRP from HBBT_BLDGRP_MST where HBNUM_BLDGRP_CODE\=a.HBNUM_BLDGRP_CODE and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?) as bloodGroup, HBNUM_BAG_VOLUME as bagVolume,to_char(HBDT_BLDBAG_EXPIRY,'dd-Mon-yyyy') as bloodBagExpiry ,HBNUM_SAURCE_FLAG as sourceFlag,HBSTR_BLDBAG_NO as bloodBagNo,HBNUM_BLDBAG_SEQNO as bloodBagSequenceNo,HBNUM_STOCK_STATUS as StockStatus from HBBT_PAT_BLDSTOCK_DTL a where HRGNUM_PUK\=? and HBNUM_STOCK_STATUS in (?)  and trunc(HBDT_BLDBAG_EXPIRY)>\=trunc(sysdate) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\torder by HBNUM_REQ_NO , HBNUM_STOCK_STATUS\t

#<!--changed by Akash [ because t & removed hospital Code] dated by 11-03-2015-->
ESSENTIAL.GBLT_EDUCATION_STATUS_MST	=SELECT GNUM_EDUCATION_CODE, INITCAP(GSTR_EDUCATION_NAME) FROM GBLT_EDUCATION_MST WHERE GNUM_ISVALID\=? ORDER BY GSTR_EDUCATION_NAME\t\t\t\t\t\t

ESSENTIAL.HANCT_MENSTRUAL_CYCLE_MST	=SELECT HANCNUM_MENSTRUAL_CYCLE_ID, INITCAP(HANCSTR_MENSTRUAL_CYCLE_DESC) FROM HANCT_MENSTRUAL_CYCLE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? ORDER BY HANCSTR_MENSTRUAL_CYCLE_DESC\t\t\t\t\t\t

ESSENTIAL.HANCT_DELIVERY_PLACE_MST	=SELECT HANCNUM_DELIVERY_PLACE_ID, INITCAP(HANCSTR_DELIVERY_PLACE) FROM HANCT_DELIVERY_PLACE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? ORDER BY HANCSTR_DELIVERY_PLACE\t\t\t\t\t\t

ESSENTIAL.HANCT_BIRTH_TYPE_MST	=SELECT HANCNUM_BIRTH_TYPE_ID, INITCAP(HANCSTR_BIRTH_TYPE) FROM HANCT_BIRTH_TYPE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

ESSENTIAL.HANCT_DELIVERY_TYPE_MST	=SELECT HANCNUM_DELIVERY_TYPE_ID, INITCAP(HANCSTR_DELIVERY_TYPE) FROM HANCT_DELIVERY_TYPE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t

ESSENTIAL.BY_METHOD_TYPE.HANCT_METHOD_MST	=SELECT HANCNUM_METHOD_ID, INITCAP(HANCSTR_METHOD) FROM HANCT_METHOD_MST WHERE HANCNUM_METHOD_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?
										
ESSENTIAL.LIST.HANCT_LABOR_ROOM_MST	=SELECT HANCNUM_LABOR_ROOM_ID, INITCAP(HANCSTR_LABOR_ROOM_NAME)||' ('||HANCSTR_LABOR_ROOM_SHORTNAME|| ')' FROM HANCT_LABOR_ROOM_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

ESSENTIAL.LIST.HANCT_LABORROOM_AREA_MST	=SELECT HANCNUM_LABORROOM_AREA_ID||'^'||HANCNUM_LABOR_ROOM_ID, INITCAP(HANCSTR_LABORROOM_AREA_DESC) FROM HANCT_LABORROOM_AREA_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?
											

											
ESSENTIAL.LIST.HANCT_PLACENTA_TYPE_MST	=SELECT HANCNUM_PLACENTA_TYPE_ID, INITCAP(HANCSTR_PLACENTA_TYPE) FROM HANCT_PLACENTA_TYPE_MST  WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

ESSENTIAL.BY_TYPE.HANCT_COMPLICATION_MST	=SELECT HANCNUM_COMPLICATION_ID, HANCSTR_COMPLICATION FROM HANCT_COMPLICATION_MST  WHERE HANCNUM_COMPLICATION_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

ESSENTIAL.GBLT_GENDER_MST	=SELECT GNUM_GENDER_CODE||'^'||GNUM_GENDER_CODE, INITCAP(GSTR_GENDER_NAME) FROM GBLT_GENDER_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? ORDER BY INITCAP(GSTR_GENDER_NAME)
								
ESSENTIAL.LIST_BY_AREATYPE.HANCT_LABORROOM_AREA_MST	=SELECT HANCNUM_LABORROOM_AREA_ID||'^'||HANCNUM_LABOR_ROOM_ID, INITCAP(HANCSTR_LABORROOM_AREA_DESC) FROM HANCT_LABORROOM_AREA_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HANCNUM_AREA_TYPE IN (\#)
								


ESSENTIAL.PHONENO.CONSULTANT.EST_TELEPHONE_MST = SELECT num_mobile_no telephoneNo FROM PIST_EMP_REGISTRATION_DTL a WHERE a.GNUM_ISVALID=? AND a.gnum_hospital_code=? AND a.str_emp_no=upper(?) 

FETCH.CONSULTANT.PHONE.LIST = SELECT DECODE(num_mobile_no,NULL,'' ,NUM_MOBILE_NO) telephoneNo FROM PIST_EMP_REGISTRATION_DTL a WHERE a.GNUM_ISVALID=? AND a.gnum_hospital_code=? AND a.str_emp_no=upper(?)

FETCH.UNIT.PHONE.LIST=SELECT DECODE(hgnum_unit_contact_number,NULL,'' ,hgnum_unit_contact_number)telephoneNo From hgbt_unit_mst where gnum_isvalid=? and gnum_hospital_code=? and hgnum_deptunitcode=?

#Modified By Shruti Shail for Seat ID  --AND a.gnum_deptunit_code LIKE ?
SELECT.PENDING_CONSENT.HGBT_CONSENT_DTL	=SELECT a.hrgnum_puk patCrNo, a.hrgnum_episode_code, a.hrgnum_visit_no, a.hgnum_consent_id AS consentid, b.hgstr_template_name AS templatedesc, a.hgnum_consent_status AS consentstatus, a.hgnum_service_consent_id AS serviceconsentid, a.gnum_relation_code AS relationcode, a.hgnum_service_type_id AS servicetypeid, a.hgstr_service_id AS serviceid, a.hgnum_raised_by, pkg_bloodbank_mst.emp_name_useridwise (a.gnum_hospital_code, a.hgnum_raised_by) AS raisedby, TO_CHAR (a.hgdt_raised_date, 'dd-Mon-yyyy hh\:mi') AS raiseddate, a.hrgstr_doctor_id AS doctorid, (SELECT DISTINCT INITCAP (c.hgstr_service_desc)FROM hgbt_consent_mapping c WHERE c.hgstr_service_id \= a.hgstr_service_id AND c.hgnum_service_type_id \= a.hgnum_service_type_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid) AS servicedesc,d.hbstr_service_type AS servicetypedesc, hgstr_req_id AS requestid,DECODE (a.hrgnum_consent_givenby,0, 'Self', 1, 'Relative',NULL) AS givenby,a.hrgstr_relative_name AS relativename,a.gnum_relation_code AS relationcode, (SELECT DISTINCT INITCAP (e.gstr_relation_name) FROM gblt_relation_mst e WHERE e.gnum_relation_code \= a.gnum_relation_code ) AS relationshipname, a.hrgstr_relative_address AS relativeaddr, a.hrgstr_relative_contactno AS relativecontactno, a.hrgstr_relative_idmark AS relativeidremark FROM hgbt_consent_dtl a, hgbt_template_mst b, hgbt_consent_service_mst d WHERE a.hgnum_consent_id \= b.hgnum_template_id AND b.gnum_hospital_code \= 100 AND a.gnum_isvalid \= b.gnum_isvalid  AND TRUNC (SYSDATE) BETWEEN TRUNC (b.gdt_effective_frm) AND TRUNC (NVL (b.gdt_effective_to, SYSDATE)) AND d.hgnum_service_type_id \= a.hgnum_service_type_id AND a.gnum_isvalid \= d.gnum_isvalid AND b.gnum_hospital_code \= d.gnum_hospital_code AND (a.hrgnum_puk || a.hrgnum_episode_code || a.hrgnum_visit_no) IN ( SELECT a.hrgnum_puk || a.hrgnum_episode_code || a.hrgnum_visit_no FROM hipt_patadmission_dtl a, hipt_patadmdisc_dtl b WHERE a.hrgnum_puk \= b.hrgnum_puk  AND a.hipnum_admno \= b.hipnum_admno  AND a.hipnum_ward_code  in    ( (SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=14  AND p.gstr_table_name\= 'HIPT_WARD_MST'  AND p.gstr_column_name \= 'HIPNUM_WARD_CODE'   AND p.gnum_seatid \=pkg_usermgmt.fun_getseatid(?,21101) AND gnum_hospital_code \= a.gnum_hospital_code)  ) AND a.hipdt_admstatus_code IN (?, ?) AND a.HIPNUM_ISACCEPTED\=? AND a.gnum_isvalid \= ?) AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hgnum_consent_status \= ?  order by a.hrgnum_puk
 	            										
#SELECT.PENDING_CONSENT.HGBT_CONSENT_DTL.COND.1	=	AND a.hipnum_room_code = ?

SELECT.PREVIOUS_DRUG_DETAIL.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo,to_char(HRGDT_ADVICE_DATE,'dd-Mon-yyyy') as adviceDate,HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo, HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId, HGSTR_DOSE_TIME as doseTime, HGNUM_DOSE_ID as doseId, HGNUM_DOSE_SHIFT as doseShift, HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, HGSTR_DOSE_NAME as doseName, HGNUM_DRUG_ROUTE_ID as drugRouteId, HSTSTR_ITEM_NAME as itemName, GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_ADMIN_FLAG as AdminFlag, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST b where a.HGNUM_DRUG_ROUTE_ID\=b.HGNUM_DRUG_ROUTE_ID and a.GNUM_ISVALID\=b.GNUM_ISVALID and b.GNUM_HOSPITAL_CODE\=100) as drugRouteName from HRGT_EPISODE_DRUG_ADMIN_DTL a  where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMISSION_NO\=? and TRUNC(HRGDT_SCHEDULE_DATE)\=TRUNC(sysdate)             \t\t\t\t\t\t\t\t\t\t
             										

#### Commented By  Chetan Sharma
#### Date : 2015_12_3
#### Reason : Not in Use

#SELECT.TODAY_DRUG_DETAIL.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo,to_char(HRGDT_ADVICE_DATE,'dd-Mon-yyyy') as adviceDate,HRGNUM_S_NO as serialNo, \
#															HRGNUM_ADMISSION_NO as patAdmNo, \
#															HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId, HGSTR_DOSE_TIME as doseTime, \
#															HGNUM_DOSE_ID as doseId, HGNUM_DOSE_SHIFT as doseShift, HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, \
#															HGSTR_DOSE_NAME as doseName, HGNUM_DRUG_ROUTE_ID as drugRouteId, HSTSTR_ITEM_NAME as itemName, \
#															GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_ADMIN_FLAG as AdminFlag, \
#															(select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST b where b.HGNUM_DRUG_ROUTE_ID=a.HGNUM_DRUG_ROUTE_ID and a.GNUM_ISVALID=b.GNUM_ISVALID and b.GNUM_HOSPITAL_CODE=100) as drugRouteName , HRGNUM_EPISODE_CODE as episodeCode,  \
#															(SELECT COUNT (*) \
#															  FROM hrgt_episode_drug_reaction_dtl c \
#															 WHERE c.hrgnum_puk = a.hrgnum_puk and c.HSTNUM_ITEM_ID=a.HSTNUM_ITEM_ID \
#															   AND c.gnum_hospital_code =a.gnum_hospital_code \
#															   AND c.gnum_isvalid =a.gnum_isvalid) as reactionStatus, \
#															   (SELECT COUNT(*)  FROM HPMRT_PAT_ALLERGY_DTL d WHERE \
#															   d.GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE AND HGNUM_ALLERGY_TYPE_CODE=? \
#															    AND d.HRGNUM_PUK=a.hrgnum_puk AND HGSTR_ALLERGY_ID=a.HSTNUM_ITEM_ID AND TRUNC(HRGDT_EFFECTIVE_FRM) <= TRUNC(SYSDATE) AND NVL(TRUNC(HRGDT_EFFECTIVE_TO),SYSDATE+1) > TRUNC(SYSDATE)) as allergyStatus, \
#															    NVL((select HSTSTR_ITEMTYPE_NAME from HSTT_ITEMTYPE_MST x where x.HSTNUM_ITEMTYPE_ID=a.HSTNUM_ITEMTYPE_ID and x.GNUM_HOSPITAL_CODE=100 and x.GNUM_ISVALID=a.GNUM_ISVALID),'-') as itemTypeDesc \
#															from HRGT_EPISODE_DRUG_ADMIN_DTL a  \
#															where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? and HRGNUM_PUK=? and HRGNUM_EPISODE_CODE=? \
#															and HRGNUM_ADMISSION_NO=? and TRUNC(HRGDT_SCHEDULE_DATE)=TRUNC(sysdate) AND HRGNUM_ADMIN_FLAG=?  AND HRGDT_ADMINISTRATION_TIME is null AND HRGDT_ADMINISTRATION_ENDTIME  is null  order by HGSTR_DOSE_TIME , HSTSTR_ITEM_NAME      										
             
             
#### Modified By  Chetan Sharma
#### Date : 2015_12_3
#### Reason : Fetch the Item type details as per SCM Integration.             
             
# (select CNUM_ROUTE_NAME from CIMS_DRUG_ADMIN_ROUTE_MST_SYS where CNUM_ROUTE_ID=a.HGNUM_DRUG_ROUTE_ID and gnum_isvalid = 1)  AS drugRouteName , HRGNUM_EPISODE_CODE as episodeCode,  \

#Modified by Vasu on 28.Sept.2018																			
#SELECT.TODAY_DRUG_DETAIL.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo,to_char(HRGDT_ADVICE_DATE,'dd-MM-yyyy') as adviceDate,to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy') as scheduleDate,HGSTR_CUTOFF_TIME_LEFT as beforeTimeLimit, HGSTR_CUTOFF_TIME_RIGHT as afterTimeLimit, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo, HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId, HGSTR_DOSE_TIME as doseTime, HGNUM_DOSE_ID as doseId, HGNUM_DOSE_SHIFT as doseShift, HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, HGSTR_DOSE_NAME as doseName, HGNUM_DRUG_ROUTE_ID as drugRouteId, HSTSTR_ITEM_NAME as itemName, GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_ADMIN_FLAG as AdminFlag, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST b where b.HGNUM_DRUG_ROUTE_ID\=a.HGNUM_DRUG_ROUTE_ID and b.GNUM_ISVALID\=1 and b.GNUM_HOSPITAL_CODE\=100)  AS drugRouteName, HRGNUM_EPISODE_CODE as episodeCode, (SELECT COUNT (*) FROM hrgt_episode_drug_reaction_dtl c WHERE c.hrgnum_puk \= a.hrgnum_puk and c.HSTNUM_ITEM_ID\=a.HSTNUM_ITEM_ID AND c.gnum_hospital_code \=a.gnum_hospital_code AND c.gnum_isvalid \=a.gnum_isvalid) as reactionStatus, (SELECT COUNT(*)  FROM HPMRT_PAT_ALLERGY_DTL d WHERE d.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND HGNUM_ALLERGY_TYPE_CODE\=? AND d.HRGNUM_PUK\=a.hrgnum_puk AND HGSTR_ALLERGY_ID\=a.HSTNUM_ITEM_ID AND TRUNC(HRGDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND NVL(TRUNC(HRGDT_EFFECTIVE_TO),SYSDATE+1) > TRUNC(SYSDATE)) as allergyStatus, a.HSTNUM_ITEMTYPE_ID as itemTypeId, NVL(pkg_opd_func.get_itemType_name('1',a.HSTNUM_ITEMTYPE_ID\:\:character varying,null,null),'-') as itemTypeDesc, hstnum_itembrand_id as drugBrandId from HRGT_EPISODE_DRUG_ADMIN_DTL a  where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMISSION_NO\=? and TRUNC(HRGDT_SCHEDULE_DATE) in (TRUNC(sysdate+1),TRUNC(sysdate),TRUNC(sysdate-1))  AND HRGNUM_ADMIN_FLAG\=?  AND HRGDT_ADMINISTRATION_TIME is null AND HRGDT_ADMINISTRATION_ENDTIME  is null  order by HRGDT_SCHEDULE_DATE desc,HGSTR_DOSE_TIME asc, HSTSTR_ITEM_NAME asc    \t\t\t\t\t\t\t\t\t\t
SELECT.TODAY_DRUG_DETAIL.HRGT_EPISODE_DRUG_ADMIN_DTL = select HRGNUM_PUK as patCrNo,to_char(HRGDT_ADVICE_DATE,'dd-MM-yyyy') as adviceDate,to_char(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy') as scheduleDate,HGSTR_CUTOFF_TIME_LEFT as beforeTimeLimit, HGSTR_CUTOFF_TIME_RIGHT as afterTimeLimit, HRGNUM_S_NO as serialNo, HRGNUM_ADMISSION_NO as patAdmNo, HRGNUM_VISIT_NO as episodeVisitNo,HSTNUM_ITEM_ID as itemId, HGSTR_DOSE_TIME as doseTime, HGNUM_DOSE_ID as doseId, HGNUM_DOSE_SHIFT as doseShift, HRGNUM_DRUG_SAURCE_FLAG as drugSourceFlag, HGSTR_DOSE_NAME as doseName, HGNUM_DRUG_ROUTE_ID as drugRouteId, HSTSTR_ITEM_NAME as itemName, GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_ADMIN_FLAG as AdminFlag, (select HGSTR_DRUG_ROUTE_NAME from HGBT_DRUG_ROUTE_MST b where b.HGNUM_DRUG_ROUTE_ID\=a.HGNUM_DRUG_ROUTE_ID and b.GNUM_ISVALID\=1 and b.GNUM_HOSPITAL_CODE\=100)  AS drugRouteName, HRGNUM_EPISODE_CODE as episodeCode, (SELECT COUNT (*) FROM hrgt_episode_drug_reaction_dtl c WHERE c.hrgnum_puk \= a.hrgnum_puk and c.HSTNUM_ITEM_ID\=a.HSTNUM_ITEM_ID AND c.gnum_hospital_code \=a.gnum_hospital_code AND c.gnum_isvalid \=a.gnum_isvalid) as reactionStatus, (SELECT COUNT(*)  FROM HPMRT_PAT_ALLERGY_DTL d WHERE d.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND HGNUM_ALLERGY_TYPE_CODE\=? AND d.HRGNUM_PUK\=a.hrgnum_puk AND HGSTR_ALLERGY_ID\=a.HSTNUM_ITEM_ID AND TRUNC(HRGDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND NVL(TRUNC(HRGDT_EFFECTIVE_TO),SYSDATE+1) > TRUNC(SYSDATE)) as allergyStatus, a.HSTNUM_ITEMTYPE_ID as itemTypeId, NVL(pkg_opd_func.get_itemType_name('1',a.HSTNUM_ITEMTYPE_ID\:\:character varying,null,null),'-') as itemTypeDesc, hstnum_itembrand_id as drugBrandId from HRGT_EPISODE_DRUG_ADMIN_DTL a  where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMISSION_NO\=? AND HRGNUM_ADMIN_FLAG\=?  AND HRGDT_ADMINISTRATION_TIME is null AND HRGDT_ADMINISTRATION_ENDTIME  is null order by to_date(TO_CHAR(HRGDT_SCHEDULE_DATE,'dd-Mon-yyyy') || ' ' || HGSTR_DOSE_TIME,'dd-Mon-yyyy hh24\:mi') asc, HSTSTR_ITEM_NAME asc \t\t\t\t\t\t\t\t\t\t   


SELECT.PENDING_TREATMENT.HRGT_EPISODE_DRUG_ADMIN_DTL = SELECT hrgnum_puk patCrNo, hrgnum_admission_no patAdmNo, hgstr_dose_name doseName, hstnum_item_id itemId ,hststr_item_name drugName, hgstr_dose_time doseTime, hrgstr_remarks remarks,HRGDT_SCHEDULE_DATE , HGNUM_DOSE_SHIFT doseShift FROM hrgt_episode_drug_admin_dtl WHERE gnum_isvalid \= ? AND hrgnum_admin_flag \= ? AND gnum_hospital_code \= ? AND TRUNC (hrgdt_schedule_date) \= TRUNC (SYSDATE) and hgstr_dose_time < to_char(sysdate,'hh24\:mi') order by hgnum_dose_shift            \t\t\t\t\t\t\t\t\t\t
             										

SELECT.PENDING_SAMPLE.HIVT_REQUISITION_HEADER	= SELECT pkg_inv_fun.fun_puk_fromreqno(hivnum_req_no,gnum_hospital_code) AS patCrNo, gnum_lab_code, gnum_test_code, hivnum_req_no AS requisitionNo,DECODE(hivnum_isappointment,0,to_char(hivt_entry_date,'dd-Mon-yyyy'),to_char(hivdt_appointment_date,'dd-Mon-yyyy')) AS proposedTestDate, pkg_inv_fun.fun_test_name(gnum_test_code) AS testName, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) AS labname,  pkg_inv_fun.fun_admissionno_fromreqno(hivnum_req_no,gnum_hospital_code) AS patAdmNo,HIVNUM_SAM_REJECTION_REASON AS strRejectionReason, HIVNUM_SAM_REJECTION_REASON as strReschedleReason, hivnum_sample_col_area_code from hivt_requisition_dtl a  where  pkg_inv_fun.fun_wardcode_fromreqno(hivnum_req_no,gnum_hospital_code)  in ((SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= ?    AND p.gnum_module_id \=14  AND   p.gstr_table_name\= 'HIPT_WARD_MST'  AND p.gstr_column_name \= 'HIPNUM_WARD_CODE'   AND p.gnum_seatid \=pkg_usermgmt.fun_getseatid(?,a.gnum_hospital_code)AND gnum_hospital_code \= a.gnum_hospital_code)  )   and   gnum_lab_code in (SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= ?    AND p.gnum_module_id \=15  AND p.gstr_table_name\= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=pkg_usermgmt.fun_getseatid(?,a.gnum_hospital_code) AND gnum_hospital_code \= a.gnum_hospital_code)     and  HIVNUM_REQDTL_STATUS in (2,11) and gnum_hospital_code\=? AND pkg_inv_fun.fun_wardcode_fromreqno (hivnum_req_no, gnum_hospital_code) IN (SELECT to_char((SELECT hipnum_ward_code FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 and hipnum_ward_code is not null AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_area_code \= b.gnum_area_code)) FROM hivt_lab_collection_area_mst b WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_lab_code \= a.gnum_lab_code and exists (SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 and hipnum_ward_code is not null AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_area_code \= b.gnum_area_code) )




# Change By Chetan Sharma 
# According to new database.
#SELECT.PENDING_SAMPLE.HIVT_REQUISITION_HEADER	= SELECT b.hrgnum_puk patCrNo, a.gnum_lab_test_code, b.HIVNUM_REQ_NO AS requisitionNo, to_char(hivtdt_proposedtestdate,'dd-Mon-yyyy') AS proposedTestDate, (SELECT gstr_test_name FROM gblt_test_mst WHERE gnum_test_code = \
#										SUBSTR (a.gnum_lab_test_code, 6) AND gnum_isvalid = ?  AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND gnum_hospital_code = ?) AS testName, (SELECT gstr_lab_name \
#            							FROM gblt_laboratory_mst WHERE gnum_lab_code = SUBSTR (a.gnum_lab_test_code, 1, 5) AND gbl_isvalid = ? AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) \
#             							AND gnum_hospital_code = ?) AS labname, HIPNUM_ADMNO AS patAdmNo,HGSTR_REMARKS AS remarks, investigationpatientdetails.getsamplerejectionaction(TO_CHAR(a.hivtnum_req_dno),TO_CHAR(0)) AS strRejectionAction, \
#             							investigationpatientdetails.getsamplereschedulereason(TO_CHAR(a.hivtnum_req_dno),TO_CHAR(0)) AS strRejectionReason FROM hivt_requisition_dtl a, hivt_requisition_header b WHERE a.gbnum_status_code IN (1, 2, 6) AND b.gbnum_status_code IN (1,2,3) AND b.hivnum_req_no = \
#             							SUBSTR (a.hivtnum_req_dno, 1, 18) AND hipnum_wardcode = ?  # AND hgnum_deptunitcode LIKE ? ORDER BY b.hrgnum_puk,testname
#										
#SELECT.PENDING_SAMPLE.HIVT_REQUISITION_HEADER.COND.1	=	AND hipnum_room_code = ?

SELECT.PENDING_VITALS.HIPD_PAT_CLINICAL_DTL	=SELECT TO_CHAR (a.hrgdt_record_date, 'dd-Mon-yyyy HH24\:MI') AS duration, (SELECT hgstr_para_name FROM hgbt_parameter_mst WHERE hgnum_para_id \= a.hgnum_para_id AND gnum_hospital_code \= 100) paraname, a.hgnum_para_id AS paraid, a.hgstr_para_value AS paravalue, a.hrgnum_puk patCrNo, hipnum_duration,((SYSDATE - a.hrgdt_record_date) * 24 * 60) AS MIN  FROM hipd_pat_clinical_dtl a, hipd_pat_monitoring_mst b WHERE a.hrgnum_puk \= b.hrgnum_puk AND a.hrgnum_episode_code \= b.hrgnum_episode_code AND a.hrgnum_visit_no \= b.hrgnum_visit_no AND a.hrgnum_admission_no \= b.hrgnum_admission_no AND a.hgnum_para_id \= b.hgnum_para_id AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_hospital_code \= ?  AND a.gnum_isvalid \= ?  AND b.gnum_isvalid \= a.gnum_isvalid  AND a.hrgdt_record_date \= (SELECT NVL (MAX (hrgdt_record_date), SYSDATE) FROM hipd_pat_clinical_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND hrgnum_episode_code \= a.hrgnum_episode_code AND hrgnum_visit_no \= a.hrgnum_visit_no AND hrgnum_admission_no \= a.hrgnum_admission_no AND hgnum_para_id \= a.hgnum_para_id AND gnum_hospital_code \= ? AND gnum_isvalid \= ?) AND ((SYSDATE - a.hrgdt_record_date) * 24 * 60) > (hipnum_duration + 15) ORDER BY a.hgnum_para_id, TO_CHAR (a.hrgdt_record_date, 'dd-Mon-yyyy HH24\:MI') DESC\t
     											
ESSENTIAL.APGAR_TIMES.HPMRT_FLAG_MST	=	SELECT HPMRNUM_FLAG_VALUE, HPMRSTR_FLAG_DESC FROM HPMRT_FLAG_MST WHERE HPMRNUM_TABLE_ID=7 ORDER BY HPMRNUM_FLAG_VALUE



ESSENTIAL.PREV_INST.HRGT_EPISODE_EXTTREATMENT_DTL = select HGNUM_EXT_TREATMENT_ID, HGSTR_EXT_TREATMENT_NAME from HRGT_EPISODE_EXTTREATMENT_DTL where GDT_ENTRY_DATE\=( select max(trunc(GDT_ENTRY_DATE)) from HRGT_EPISODE_EXTTREATMENT_DTL where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?)and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HGNUM_TREATMENT_TYPE\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? \t
													
ESSENTIAL.PREV_ACTIVITY.HRGT_EPISODE_EXTTREATMENT_DTL = select HGNUM_EXT_TREATMENT_ID, HGSTR_EXT_TREATMENT_NAME from HRGT_EPISODE_EXTTREATMENT_DTL where GDT_ENTRY_DATE\=( select max(trunc(GDT_ENTRY_DATE)) from HRGT_EPISODE_EXTTREATMENT_DTL where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?)and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HGNUM_TREATMENT_TYPE\=?\tand HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=?
																						


ESSENTIAL.HIPT_PATADMISSION_DTL.ADMMISSIOM_DETAILS_EMR=SELECT HIPNUM_ADMNO AS patAdmNo, HRGNUM_PUK AS patCrNo, HRGNUM_EPISODE_CODE AS episodeCode, HRGNUM_VISIT_NO AS episodeVisitNo, GNUM_DEPT_CODE AS departmentCode, GNUM_DEPTUNIT_CODE AS departmentUnitCode, HIPNUM_WARD_CODE AS wardCode, HIPNUM_ROOM_CODE AS ipdRoomCode, HIPNUM_BED_CODE AS bedCode,to_char(HIPDT_DISDATETIME,'dd-Mon-yyyy') disDateTime,to_char(HIPDT_ADMDATETIME,'dd-Mon-yyyy')admDateTime, (SELECT k.gstr_dept_name FROM gblt_department_mst k WHERE k.gnum_dept_code \= a.gnum_dept_code AND k.gnum_hospital_code \= a.gnum_hospital_code AND k.gnum_isvalid \= 1 ) AS departmentname,(SELECT l.hgstr_unitname FROM hgbt_unit_mst l WHERE l.hgnum_deptunitcode \= a.gnum_deptunit_code  AND l.gnum_hospital_code \= a.gnum_hospital_code AND l.gnum_isvalid \= 1 ) AS departmentunitname, (SELECT h.hipstr_ward_name FROM hipt_ward_mst h WHERE h.hipnum_ward_code \= a.hipnum_ward_code AND h.gnum_hospital_code \= a.gnum_hospital_code AND h.gnum_isvalid \= 1 AND h.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (h.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS wardname, (SELECT j.hgnum_bed_name FROM hipt_ward_room_bed_mst j WHERE j.hgnum_bed_code \= a.hipnum_bed_code AND j.gnum_hospital_code \= a.gnum_hospital_code AND j.gnum_isvalid \= 1) AS bedname,(SELECT hipstr_room_desc FROM hipt_room_config_mst WHERE hipnum_room_no \= a.hipnum_room_code AND gnum_hospital_code \= a.gnum_hospital_code) AS ipdroomname,(SELECT GSTR_HOSPITAL_NAME FROM GBLT_HOSPITAL_MST WHERE GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=a.gnum_isvalid) as hospitalName, (SELECT GNUM_HOSPITAL_CODE FROM GBLT_HOSPITAL_MST WHERE GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=a.gnum_isvalid) as hospitalCode  FROM HIPT_PATADMISSION_DTL  a WHERE HRGNUM_PUK\=?  AND GNUM_ISVALID\=? AND HIPDT_ADMSTATUS_CODE NOT IN (?,?) ORDER BY HIPNUM_ADMNO


SELECT_DISCHARGE_STATUS.HIPT_DISCHARGE_TYPE_MST = SELECT HGNUM_DISHARGE_TYPE_CODE, HGSTR_DISCHARGE_DESC FROM HIPT_DISCHARGE_TYPE_MST WHERE GDT_EFFECTIVE_FRM <\= SYSDATE AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? ORDER BY HGSTR_DISCHARGE_DESC

SELECT.TODAY_EXT_LIST.HRGT_EPISODE_EXTADMIN_DTL = select HRGNUM_PUK as patCrNo , HRGNUM_EPISODE_CODE as episodeCode, to_char(HRGDT_ADVICE_DATE,'dd-Mon-yyyy') as adviceDate , HRGNUM_S_NO as serialNo , HRGNUM_ADMISSION_NO as patAdmNo, HRGNUM_VISIT_NO as episodeVisitNo, HGNUM_EXT_TREATMENT_ID as extTreatmentId, HGNUM_DOSE_ID as doseId , GNUM_SEAT_ID as seatId, HRGDT_SCHEDULE_DATE as scheduleDate, HGSTR_DOSE_NAME as doseName,  HRGDT_ADMINISTRATION_TIME as administrationTime , HGNUM_FREQUENCY_ID as frequencyId , HRGDT_ADMINISTRATION_ENDTIME as administrationEndTime, trunc(GDT_ENTRY_DATE) as entryDate, HGSTR_DOSE_TIME as doseTime, GNUM_ISVALID as isValid, HRGSTR_REMARKS as remarks, GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_ADMIN_FLAG as adminFlag, PSRSTR_EMP_NO as empNo, HRGNUM_ISMASTER_BOUND as isMasterBound,  HGSTR_EXT_TREATMENT_NAME as extTreatmentName, HGNUM_TREATMENT_TYPE as treatmentType, (select HGNUM_DURATION_BOUND from HGBT_EXT_TREATMENT_MST b where b.GNUM_ISVALID\=a.GNUM_ISVALID and b.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and b.HGNUM_EXT_TREATMENT_ID\=a.HGNUM_EXT_TREATMENT_ID ) as isDurationBound from HRGT_EPISODE_EXTADMIN_DTL a where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMISSION_NO\=? and trunc(HRGDT_SCHEDULE_DATE)\=trunc(sysdate) AND HRGNUM_ADMIN_FLAG\=?
													
SELECT.EXEC_EXT_LIST.HRGT_EPISODE_EXTADMIN_DTL = select HGSTR_EXT_TREATMENT_NAME as extTreatmentName,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy') as administrationDate , to_char(HRGDT_ADMINISTRATION_ENDTIME,'hh24\:mi') as administrationEndTime, HRGSTR_REMARKS as remarks from HRGT_EPISODE_EXTADMIN_DTL where HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?) and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HGNUM_TREATMENT_TYPE\=?
													
SELECT.EXEC_ACTIVITY_LIST.HRGT_EPISODE_EXTADMIN_DTL = select HGSTR_EXT_TREATMENT_NAME as extTreatmentName,to_char(HRGDT_ADMINISTRATION_TIME,'hh24\:mi') as administrationTime,to_char(HRGDT_ADMINISTRATION_TIME,'dd-Mon-yyyy') as administrationDate , to_char(HRGDT_ADMINISTRATION_ENDTIME,'hh24\:mi') as administrationEndTime, HRGSTR_REMARKS as remarks from HRGT_EPISODE_EXTADMIN_DTL where HRGNUM_PUK\=? and HRGNUM_EPISODE_CODE\=? and HRGNUM_ADMIN_FLAG not in (?) and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? and HGNUM_TREATMENT_TYPE\=?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

#Changed By Chetan Sharma to use a funtion for SCM integration.
#SELECT_PREV_LIST.HRGT_EPISODE_DRUG_REACTION_DTL = SELECT distinct HSTNUM_ITEM_ID ||'#'|| to_char(HRGDT_REACTION_STARTTIME,'dd-Mon-yyyy hh24:mi') ||'#'|| to_char(HRGDT_REACTION_ENDTIME,'dd-Mon-yyyy hh24:mi'),(select HSTSTR_ITEM_NAME from HSTT_DRUGBRAND_MST b \
#													where b.HSTNUM_ITEMBRAND_ID=a.HSTNUM_ITEM_ID  \
#													and b.GNUM_HOSPITAL_CODE=100 and a.GNUM_ISVALID=b.GNUM_ISVALID ) as itemName \
#													FROM hrgt_episode_drug_reaction_dtl a \
#													WHERE hrgnum_puk = ? \
#													AND gnum_isvalid = ? \
#													AND gnum_hospital_code = ?  \
#													AND HRGDT_REACTION_STARTTIME=(select max(HRGDT_REACTION_STARTTIME) from hrgt_episode_drug_reaction_dtl d \
#													where d.hstnum_item_id=a.hstnum_item_id and d.GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE and d.GNUM_ISVALID=a.GNUM_ISVALID) \
#													order by itemName
													


#  old--- pkg_opd_func.get_drug_name('1',a.HSTNUM_ITEM_ID::character varying,null,null,null) as itemName \	
#modified for cims integration		
SELECT_PREV_LIST.HRGT_EPISODE_DRUG_REACTION_DTL = SELECT distinct HSTNUM_ITEM_ID ||'\#'|| to_char(HRGDT_REACTION_STARTTIME,'dd-Mon-yyyy hh24\:mi') ||'\#'|| to_char(HRGDT_REACTION_ENDTIME,'dd-Mon-yyyy hh24\:mi') ||'\#'|| hststr_itembrand_name, (select pkg_opd_func.get_drugitem_name('','',a.hstnum_item_id||'','','') ) as itemName, hstnum_itembrand_id as drugBrandId, hststr_itembrand_name as drugBrandName FROM hrgt_episode_drug_reaction_dtl a WHERE hrgnum_puk \= ? AND gnum_isvalid \= ? AND gnum_hospital_code \= ?  AND HRGDT_REACTION_STARTTIME\=(select max(HRGDT_REACTION_STARTTIME) from hrgt_episode_drug_reaction_dtl d where d.hstnum_item_id\=a.hstnum_item_id and d.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and d.GNUM_ISVALID\=a.GNUM_ISVALID) order by itemName
													
													
SELECT_ALL_ROLE.HANCT_ROLE_MST = select HANCNUM_ROLE_ID, HANCSTR_ROLE_NAME from HANCT_ROLE_MST where GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=?

ESSENTIAL.LIST.HANCT_ANOMALY_TYPE_MST	=SELECT HANCNUM_ANOMALY_TYPE_ID, INITCAP(HANCSTR_ANOMALY_TYPE) FROM HANCT_ANOMALY_TYPE_MST  WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

											
GET_PROFILE_STATUS.HPMRT_PAT_PROFILE_DTL = SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE \= ? AND HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND HRGNUM_ADMISSION_NO \= ?
											



ESSENTIAL.LIST.HANCT_LABORROOM_AREATYPE_MST	=SELECT HANCNUM_AREA_TYPE, INITCAP(HANCSTR_LABORROOM_AREATYPE) FROM HANCT_LABORROOM_AREATYPE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?
												
SELECT.DUPLICATE_CHECK.HANCT_LABORROOM_AREA_MST = select count(*) from HANCT_LABORROOM_AREA_MST where HANCNUM_LABOR_ROOM_ID\=? and HANCNUM_AREA_TYPE\=? and trim(upper(HANCSTR_LABORROOM_AREA_DESC))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?

INSERT.HANCT_LABORROOM_AREA_MST = insert into HANCT_LABORROOM_AREA_MST(HANCNUM_LABOR_ROOM_ID,HANCNUM_LABORROOM_AREA_ID,HANCNUM_SLNO,HANCNUM_AREA_TYPE,GNUM_HOSPITAL_CODE,HANCSTR_AREA_ID,GNUM_ISVALID,GNUM_SEAT_ID,HANCSTR_LABORROOM_AREA_DESC,GDT_ENTRY_DATE) \
 										values(?,(SELECT NVL(MAX(HANCNUM_LABORROOM_AREA_ID),10000)+1 FROM HANCT_LABORROOM_AREA_MST),?,?,?,(SELECT NVL(MAX(HANCSTR_AREA_ID),10000)+1 FROM HANCT_LABORROOM_AREA_MST),?,?,?,sysdate)


SELECT.FULL_INFO.HANCT_LABORROOM_AREA_MST = select HANCNUM_LABOR_ROOM_ID,HANCNUM_AREA_TYPE,HANCSTR_LABORROOM_AREA_DESC from HANCT_LABORROOM_AREA_MST where HANCNUM_LABORROOM_AREA_ID\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? 

SELECT.MODIFY_DUPLICATE_CHECK.HANCT_LABORROOM_AREA_MST = select count(*) from HANCT_LABORROOM_AREA_MST where HANCNUM_LABOR_ROOM_ID=? AND gnum_isvalid !=? AND gnum_hospital_code =? and HANCNUM_AREA_TYPE =? 

UPDATE.HANCT_LABORROOM_AREA_MST = update HANCT_LABORROOM_AREA_MST set GDT_LSTMOD_DATE\=SYSDATE, GNUM_ISVALID\=? ,GNUM_LSTMOD_SEATID\=? where HANCNUM_LABORROOM_AREA_ID\=? and GNUM_HOSPITAL_CODE\=?

INSERT.MODIFY.HANCT_LABORROOM_AREA_MST = insert into HANCT_LABORROOM_AREA_MST(HANCNUM_LABOR_ROOM_ID,HANCNUM_LABORROOM_AREA_ID,HANCNUM_SLNO,HANCNUM_AREA_TYPE,GNUM_HOSPITAL_CODE,HANCSTR_AREA_ID,GNUM_ISVALID,GNUM_SEAT_ID,HANCSTR_LABORROOM_AREA_DESC,GDT_ENTRY_DATE) values(?,(SELECT NVL(MAX(HANCNUM_LABORROOM_AREA_ID),10000)+1 FROM HANCT_LABORROOM_AREA_MST),(SELECT NVL(MAX(HANCNUM_SLNO),1)+1 FROM HANCT_LABOR_ROOM_MST WHERE HANCNUM_LABOR_ROOM_ID\=? AND GNUM_HOSPITAL_CODE\=?),?,?,(SELECT NVL(MAX(HANCSTR_AREA_ID),10000)+1 FROM HANCT_LABORROOM_AREA_MST),?,?,?,sysdate)

ESSENTIAL.ALL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE, INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND GNUM_DEPT_TYPE \= ? ORDER BY GSTR_DEPT_NAME

ESSENTIAL.PREVIOUS_TRANSFUSION_DETAIL.HBBT_TRANSFUSION_DTL= SELECT DISTINCT ( TO_CHAR (a.HRGDT_TRANSFUSSION_DATE, 'dd-Mon-yyyy')||' '|| TO_CHAR (a.HBDT_TRANSFUSSION_STARTTIME, 'hh\:mi')) AS transfussionDate, (a.hbstr_bldbag_no || '(' || a.hbnum_bldbag_seqno ||')') AS strunitno, (SELECT hbstr_component_name FROM hbbt_bld_component_mst c, hbbt_bldbag_component_dtl b WHERE c.hbnum_bld_component_id \= b.hbnum_bld_component_id AND c.gnum_isvalid \= b.gnum_isvalid AND b.hbstr_bldbag_no\=a.hbstr_bldbag_no AND b.hbnum_bldbag_seqno\=a.hbnum_bldbag_seqno AND c.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_isvalid \= ? AND b.gnum_hospital_code \= ?) AS componentname, DECODE(a.hbnum_is_reaction,0,'NIL','-') AS stradverseeffect, TRUNC(a.HRGDT_TRANSFUSSION_DATE)  FROM hbbt_transfussion_dtl a WHERE a.hrgnum_puk \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? ORDER BY TRUNC(a.HRGDT_TRANSFUSSION_DATE) DESC\t\t\t\t\t\t
 								
ESSENTIAL.HIPT_DUWRBED_MST.WARD	=SELECT  DISTINCT HIPNUM_WARD_CODE,nvl(Ipd_Mst.getWardName(HIPNUM_WARD_CODE,GNUM_HOSPITAL_CODE),'/') AS WARD_NAME FROM \tHIPT_DUWRBED_MST WHERE \tGNUM_ISVALID \= 1 AND \tGNUM_HOSPITAL_CODE \= ? AND \tGDT_EFFECTIVE_FRM <\= SYSDATE AND  GNUM_DEPT_CODE like ? AND \tHGNUM_DEPTUNITCODE like ? ORDER  BY WARD_NAME \t\t\t\t\t\t\t\t
    								 
ESSENTIAL.GBLT_PATIENT_CAT_MST.PRIMARY_OLD=  SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_TYPE=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? AND GDT_EFFECTIVE_FRM	<= sysdate and (TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>=TO_DATE(SYSDATE,'DD-MM-YY')) ORDER BY GSTR_PATIENT_CAT_NAME									 

ESSENTIAL.GBLT_PATIENT_CAT_MST=SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_PATIENT_CAT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID \= B.GNUM_METATABLE_ID  AND B.GSTR_TABLE_NAME \= 'GBLT_PATIENT_CAT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_PATIENT_CAT_CODE' AND A.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,A.GNUM_HOSPITAL_CODE)  AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY GSTR_PATIENT_CAT_NAME\t


ESSENTIAL.GBLT_PATIENT_CAT_MST.PRIMARY=SELECT gnum_patient_cat_code, gstr_patient_cat_name FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_type \= ? AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_FRM <\= sysdate and (TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>\=TO_DATE(SYSDATE,'DD-MM-YY')) and (GNUM_ISVALID \=? OR GNUM_ISVALID \=?)AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'GBLT_PATIENT_CAT_MST' AND gstr_column_name \= 'GNUM_PATIENT_CAT_CODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,A.GNUM_HOSPITAL_CODE)  AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY gstr_patient_cat_name     \t\t\t\t\t\t\t\t 
										
ESSENTIAL.ALL_HOSPTIAL_SEAT_WISE.GBLT_HOSPITAL_MST = SELECT  distinct gnum_hospital_code, gstr_hospital_name AS orderbyname  FROM gblt_hospital_mst WHERE (gnum_hospital_code\=? or gnum_hospital_code IN ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'GBLT_HOSPITAL_MST' AND gstr_column_name \= 'GNUM_HOSPITAL_CODE' AND p.gnum_seatid \= pkg_usermgmt.fun_getseatid (?, ?) AND p.gnum_hospital_code \= ? AND p.gbl_isvalid \= ?  )) and GNUM_ISVALID\=1 ORDER BY orderbyname\t\t\t\t\t\t\t\t\t\t
										             
ESSENTIAL.ALL_GLOBAL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE , GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE\=? ORDER BY GSTR_DEPT_NAME\t
												
SELECT.COUNT_PROGRESS_NOTES.HIPD_NURSE_ROUND_DTL = select COUNT(*)  FROM HIPD_NURSE_ROUND_DTL WHERE HRGNUM_PUK\=? AND HRGNUM_ADMISSION_NO\=?  AND GNUM_HOSPITAL_CODE\=? and  GNUM_ISVALID\=1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t             
																					             
ESSENTIAL_ALL_UNITS.HOPT_DEPT_UNIT_ROSTER_DTL1=SELECT A.HGNUM_DEPTUNITCODE || '#' || INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' ,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.GNUM_DEPT_CODE=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=? ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' 
																					             
ESSENTIAL_ALL_UNITS.HOPT_DEPT_UNIT_ROSTER_DTL=SELECT A.HGNUM_DEPTUNITCODE,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.GNUM_DEPT_CODE=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=? ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' 
																				             
																				             