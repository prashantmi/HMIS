INSERT.HGBT_DEPT_ICD_MST=INSERT INTO HGBT_DEPT_ICD_MST  (GNUM_DEPT_CODE,  HGNUM_DEPTUNITCODE, HGBSTR_DISEASE_CODE, HGNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID,  GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE) VALUES ((select distinct SUBSTR (hgnum_deptunitcode, 1, 3) FROM HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=?),?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM  HGBT_DEPT_ICD_MST\tWHERE  HGNUM_DEPTUNITCODE\=? AND  HGBSTR_DISEASE_CODE\=? AND GNUM_HOSPITAL_CODE\=? ),?,?,SYSDATE,?)

INSERT.HGBT_ICD_GROUP_MST	=INSERT INTO HGBT_ICD_GROUP_MST (HGBSTR_ICD_GROUP_CODE, HGBSTR_ICD_GROUP, GBL_ISVALID,GNUM_SEAT_ID, \
							 GDT_ENTRY_DATE) values(UPPER(?),UPPER(?),?,?,to_date(?,'dd-Mon-yyyy'))
							 
INSERT.HGBT_ICD_DISEASE_MST=INSERT INTO hgbt_icd_disease_mst (hgbstr_disease_code, hgbstr_icd_subgrp_code, hgbstr_disease, \
             				hgbstr_parent_code, gbl_isvalid, gnum_seat_id, gdt_entry_date, gbl_iscommon ) \
     						VALUES (UPPER (?), UPPER (?), UPPER (?), UPPER (?), 1, 11111, \
     						TO_DATE (?, 'dd-Mon-yyyy'), ? )
     						
INSERT.HGBT_ICD_SUBGROUP_MST=INSERT INTO HGBT_ICD_SUBGROUP_MST (HGBSTR_ICD_SUBGRP_CODE, HGBSTR_ICD_SUBGROUP, HGBSTR_ICD_GROUP_CODE, \
							 GBL_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE ) VALUES (UPPER (?), UPPER (?), UPPER (?), ?, ?, TO_DATE (?, 'dd-Mon-yyyy'))
							
OPDESSENTIAL.MENU_DTL.GBLT_USER_DESKMENU_MST=select GNUM_DESK_MENU_ID,GNUM_LOCATION,GNUM_DISPLAY_ORDER, GSTR_USER_DESKMENU_NAME,GDT_ENTRY_DATE FROM GBLT_USER_DESKMENU_MST where GNUM_USERSEAT_ID \= ? AND  GNUM_LOCATION \= ?
											 
											 
UPDATE.ACTIVE_RECORD.HGBT_DEPT_HOSDISEASE_MST= UPDATE HGBT_DEPT_HOSDISEASE_MST SET GNUM_ISVALID\=1 WHERE HGBSTR_HOSPITAL_DISEASE_CODE\=? AND GNUM_DEPT_CODE\=? AND HGNUM_DEPTUNITCODE\=? AND GNUM_HOSPITAL_CODE\=?
												
INSERT.HGBT_DEPT_HOSDIS_MST= INSERT INTO HGBT_DEPT_HOSDISEASE_MST(GNUM_DEPT_CODE, \
                             HGNUM_DEPTUNITCODE,HGBSTR_HOSPITAL_DISEASE_CODE,GNUM_SEAT_ID, \
                             GNUM_ISVALID,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE) VALUES(?,?,?,?,?,SYSDATE,?)
                             
SELECT.DEPTWISE.HGBT_DEPT_HOSDIS_MST= SELECT a.GNUM_DEPT_CODE AS departmentcode,a.HGNUM_DEPTUNITCODE AS departmentunitcode, a.HGBSTR_HOSPITAL_DISEASE_CODE as hospitaldiseasecode, (SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE HGBSTR_HOSPITAL_DISEASE_CODE \= a.HGBSTR_HOSPITAL_DISEASE_CODE) AS disease FROM HGBT_DEPT_HOSDISEASE_MST a WHERE GNUM_DEPT_CODE \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE\=?
							             
SELECT.UNITWISE.HGBT_DEPT_HOSDIS_MST= SELECT a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.HGBSTR_HOSPITAL_DISEASE_CODE as hospitaldiseasecode, (SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE HGBSTR_HOSPITAL_DISEASE_CODE \= a.HGBSTR_HOSPITAL_DISEASE_CODE) AS disease FROM HGBT_DEPT_HOSDISEASE_MST a WHERE hgnum_deptunitcode \= ? AND gnum_isvalid \= ? AND GNUM_HOSPITAL_CODE\=?
									                							                                          
INSERT.GBLT_DESK_MST		=INSERT INTO GBLT_DESK_MST (GNUM_DESK_ID, GNUM_HOSPITAL_CODE, GSTR_DESK_NAME, GNUM_DESK_TYPE, GNUM_ISDEFAULT_DESK,GNUM_SEAT_ID, GNUM_ISVALID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(GNUM_DESK_ID), to_number(? || '1000'))+1 FROM GBLT_DESK_MST WHERE GNUM_HOSPITAL_CODE \=?) , ?, UPPER(?) , ?, ?, ?, ?, SYSDATE )


INSERTGLOBAL.GBLT_DESK_MST		=INSERT INTO GBLT_DESK_MST (GNUM_DESK_ID, GNUM_HOSPITAL_CODE, GSTR_DESK_NAME, GNUM_DESK_TYPE, GNUM_ISDEFAULT_DESK,GNUM_SEAT_ID, GNUM_ISVALID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(GNUM_DESK_ID),0)+1 FROM GBLT_DESK_MST WHERE GNUM_HOSPITAL_CODE \=?) , ?, UPPER(?) , ?, ?, ?, ?, SYSDATE )


SELECT.DESK_ID.GBLT_DESK_MST	= SELECT GNUM_DESK_ID FROM GBLT_DESK_MST WHERE UPPER(GSTR_DESK_NAME)\=UPPER(?) AND GNUM_DESK_TYPE \= ? AND GNUM_SEAT_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?
									
SELECT.BY_DESK_ID.GBLT_DESK_MST	=	SELECT INITCAP(GSTR_DESK_NAME), GNUM_DESK_TYPE,GNUM_ISDEFAULT_DESK, GNUM_ISVALID FROM GBLT_DESK_MST WHERE GNUM_HOSPITAL_CODE = ? AND GNUM_DESK_ID = ?

UPDATE.GBLT_DESK_MST		=UPDATE GBLT_DESK_MST SET GSTR_DESK_NAME \= UPPER(?), GNUM_DESK_TYPE \= ?, GNUM_SEAT_ID \= ?, GNUM_ISVALID \= ?, GNUM_ISDEFAULT_DESK \= ? , GDT_ENTRY_DATE \=  SYSDATE WHERE GNUM_DESK_ID \= ? AND GNUM_HOSPITAL_CODE \= ?

INSERT.GBLT_DESK_DTL	=INSERT INTO GBLT_DESK_DTL (GNUM_DESK_ID, GNUM_DESK_MENU_ID, GNUM_HOSPITAL_CODE, GNUM_SLNO, GNUM_LOCATION, GNUM_DISPLAY_ORDER, GSTR_USER_DESKMENU_NAME, GSTR_COLOR, GNUM_IS_LOGINBOUND, HDRNUM_DUTY_ROLE_ID, GNUM_SEAT_ID, GNUM_ISVALID, GDT_ENTRY_DATE) VALUES(?, ?, ?, (SELECT NVL(MAX(GNUM_SLNO),0)+1 FROM GBLT_DESK_DTL WHERE GNUM_DESK_ID\=? AND GNUM_DESK_MENU_ID\=? AND GNUM_HOSPITAL_CODE\=?), ?, ?, ?, UPPER(?), ?, ?, ?, ?, SYSDATE)

DELETE.BY_DESK_ID.GBLT_DESK_DTL		=	UPDATE GBLT_DESK_DTL SET GNUM_ISVALID = ? WHERE GNUM_DESK_ID = ? AND GNUM_HOSPITAL_CODE = ? 

SELECT.ALL_BY_DESK_ID_BY_LOC.GBLT_DESK_DTL	=SELECT GNUM_DESK_ID AS deskId, GNUM_DESK_MENU_ID AS deskMenuId, GNUM_LOCATION AS location, GNUM_DISPLAY_ORDER AS displayOrder, GSTR_USER_DESKMENU_NAME AS userDeskMenuName, GSTR_COLOR AS color, GNUM_ISDEFAULT_PROFILE AS isDefaultProfile, GNUM_PROFILE_ORDER AS profileOrder, GNUM_IS_LOGINBOUND AS isLoginBound, HDRNUM_DUTY_ROLE_ID AS dutyRoleId FROM\tGBLT_DESK_DTL WHERE GNUM_DESK_ID \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID\=? ORDER BY GNUM_LOCATION, GNUM_DISPLAY_ORDER\t\t\t\t\t\t \t

SELECT.ALL_BY_DESK_TYPE_BY_LOC_FROM_GBL.GBLT_DESK_DTL	=SELECT GNUM_DESK_ID AS deskId, GNUM_DESK_MENU_ID AS deskMenuId, GNUM_LOCATION AS location, GNUM_DISPLAY_ORDER AS displayOrder, GSTR_USER_DESKMENU_NAME AS userDeskMenuName, GSTR_COLOR AS color, GNUM_ISDEFAULT_PROFILE AS isDefaultProfile, GNUM_PROFILE_ORDER AS profileOrder, GNUM_IS_LOGINBOUND AS isLoginBound, HDRNUM_DUTY_ROLE_ID AS dutyRoleId FROM\tGBLT_DESK_DTL WHERE GNUM_DESK_ID\=(SELECT DISTINCT GNUM_DESK_ID FROM GBLT_DESK_MST WHERE GNUM_DESK_TYPE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID\=?)  AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID\=? ORDER BY GNUM_LOCATION, GNUM_DISPLAY_ORDER\t


#Commented By Chetan For global Mapping concept 2015.11.17
INSERT.GBLT_USER_DESKMENU_MST_OLD	=INSERT INTO GBLT_USER_DESKMENU_MST (GNUM_USER_DESKMENU_ID,GNUM_USERSEAT_ID, HGNUM_DEPTUNITCODE, GNUM_DESK_ID, GNUM_HOSPITAL_CODE, hipnum_ward_code, GNUM_ISVALID, GNUM_DESK_TYPE, GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(GNUM_USER_DESKMENU_ID),0)+1 FROM GBLT_USER_DESKMENU_MST WHERE GNUM_HOSPITAL_CODE \=?),?,?,?,?,?,?,?,?,SYSDATE)

#Created By Chetan For global Mapping concept 2015.11.17								 	
INSERT.GBLT_USER_DESKMENU_MST	=INSERT INTO GBLT_USER_DESKMENU_MST (Gnum_mapping_seqno,GNUM_USERSEAT_ID, HGNUM_DEPTUNITCODE, GNUM_DESK_ID, GNUM_HOSPITAL_CODE, HIPNUM_WARD_CODE, GNUM_ISVALID, GNUM_DESK_TYPE, GNUM_SEAT_ID,gnum_mapping_type,GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(Gnum_mapping_seqno),0)+1 FROM GBLT_USER_DESKMENU_MST WHERE GNUM_HOSPITAL_CODE \=?),?,?,?,?,?,?,?,?,?,SYSDATE)\t\t\t\t\t\t\t\t \t
			
SELECT.DEPTWISE.HGBT_DEPT_ICD_MST=SELECT a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hgbstr_disease_code as diseasecode, (SELECT hgbstr_disease FROM hgbt_icd_disease_mst WHERE hgbstr_disease_code \= a.hgbstr_disease_code and HGNUM_RECORD_TYPE\=0) AS disease, a.hgbstr_icd_group_code AS icdgroupcode, (SELECT hgbstr_icd_group FROM hgbt_icd_group_mst WHERE TRIM (hgbstr_icd_group_code) \= TRIM (a.hgbstr_icd_group_code)) AS icdgroup, a.hgbstr_icd_subgrp_code as icdsubgroupcode, (SELECT hgbstr_icd_subgroup FROM hgbt_icd_subgroup_mst WHERE hgbstr_icd_subgrp_code \= a.hgbstr_icd_subgrp_code) AS icdsubgroup  FROM hgbt_dept_icd_mst a WHERE gnum_dept_code \= ? AND gnum_isvalid \= ? AND GNUM_HOSPITAL_CODE\=?
 								  
 								  
SELECT.UNITWISE.HGBT_DEPT_ICD_MST=SELECT a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS departmentunitcode, a.hgbstr_disease_code as diseasecode, (SELECT hgbstr_disease FROM hgbt_icd_disease_mst WHERE hgbstr_disease_code \= a.hgbstr_disease_code and HGNUM_RECORD_TYPE\=0) AS disease, a.hgbstr_icd_group_code as icdGroupCode, (SELECT hgbstr_icd_group FROM hgbt_icd_group_mst WHERE hgbstr_icd_group_code \= a.hgbstr_icd_group_code) AS icdGroup, a.hgbstr_icd_subgrp_code as icdSubgroupCode , (SELECT hgbstr_icd_subgroup FROM hgbt_icd_subgroup_mst WHERE hgbstr_icd_subgrp_code \= a.hgbstr_icd_subgrp_code) AS icdSubGroup  FROM hgbt_dept_icd_mst a WHERE hgnum_deptunitcode \= ? AND gnum_isvalid \= ? AND GNUM_HOSPITAL_CODE\=?
 
DELETE.BY.GROUP.HGBT_DEPT_ICD_MST=UPDATE hgbt_dept_icd_mst SET gnum_isvalid \= ? WHERE gnum_dept_code \= ? AND hgnum_deptunitcode \= ? AND hgbstr_icd_group_code \= ? AND gnum_hospital_code \=?\t

DELETE.BY.SUBGROUP.HGBT_DEPT_ICD_MST=UPDATE hgbt_dept_icd_mst SET gnum_isvalid \= 2 WHERE gnum_dept_code \= ? AND hgnum_deptunitcode \= ? AND hgbstr_icd_subgrp_code \= ?\tAND gnum_hospital_code \=?

DELETE.BY.DISEASE.HGBT_DEPT_ICD_MST=UPDATE hgbt_dept_icd_mst SET gnum_isvalid \= 2 WHERE gnum_dept_code \= ? AND hgnum_deptunitcode \= ? AND hgbstr_disease_code \= ?\tAND gnum_hospital_code \=?
																
SELECT.BY.GROUPCODE.HGBT_ICD_DISEASE_MST=SELECT A.HGBSTR_DISEASE_CODE as diseasecode,A.HGBSTR_ICD_SUBGRP_CODE as icdsubgroupcode,B.HGBSTR_ICD_GROUP_CODE as icdgroupcode, A.HGBSTR_PARENT_CODE as parentcode FROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B WHERE A.HGBSTR_ICD_SUBGRP_CODE\=B.HGBSTR_ICD_SUBGRP_CODE AND B.HGBSTR_ICD_GROUP_CODE\=?
											
SELECT.BY.SUBGROUPCODE.HGBT_ICD_DISEASE_MST=SELECT A.HGBSTR_DISEASE_CODE as diseasecode,A.HGBSTR_ICD_SUBGRP_CODE as icdsubgroupcode, B.HGBSTR_ICD_GROUP_CODE as icdgroupcode, A.HGBSTR_PARENT_CODE as parentcode FROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B WHERE A.HGBSTR_ICD_SUBGRP_CODE\=B.HGBSTR_ICD_SUBGRP_CODE AND B.HGBSTR_ICD_SUBGRP_CODE\=?
												
SELECT.BY.DISEASECODE.HGBT_ICD_DISEASE_MST=SELECT A.HGBSTR_DISEASE_CODE as diseasecode,A.HGBSTR_ICD_SUBGRP_CODE as icdsubgroupcode, B.HGBSTR_ICD_GROUP_CODE as icdgroupcode, A.HGBSTR_PARENT_CODE as parentcode FROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B WHERE A.HGBSTR_ICD_SUBGRP_CODE\=B.HGBSTR_ICD_SUBGRP_CODE AND A.HGBSTR_DISEASE_CODE\=?\t\t\t\t\t\t\t\t\t\t\t\t

SELECT.FULL_INFO.GBLT_USER_DESKMENU_MST.old=SELECT GNUM_USERSEAT_ID AS userSeatId, HGNUM_DEPTUNITCODE AS deptUnitCode, GNUM_DESK_ID AS deskId, GNUM_SEAT_ID AS seatId, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, GNUM_ISVALID AS isValid, GNUM_DESK_TYPE AS deskType, GNUM_HOSPITAL_CODE AS hospitalCode, HIPNUM_WARD_CODE AS wardCode, GNUM_USER_DESKMENU_ID AS userDeskMenuId FROM GBLT_USER_DESKMENU_MST WHERE GNUM_USER_DESKMENU_ID \= ? AND GNUM_HOSPITAL_CODE \= ?
	
#modified by manisha gangwar date: 18.5.2016	
SELECT.FULL_INFO.GBLT_USER_DESKMENU_MST=SELECT GNUM_USERSEAT_ID AS userSeatId, HGNUM_DEPTUNITCODE AS deptUnitCode, GNUM_DESK_ID AS deskId, GNUM_SEAT_ID AS seatId, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, GNUM_ISVALID AS isValid, GNUM_DESK_TYPE AS deskType, GNUM_HOSPITAL_CODE AS hospitalCode, HIPNUM_WARD_CODE AS wardCode FROM GBLT_USER_DESKMENU_MST WHERE GNUM_DESK_TYPE \= ? AND GNUM_HOSPITAL_CODE \= ?

#added by manisha gangwar date: 18.5.2016
SELECT.GBLT_USER_DESKMENU_MST=select A.gnum_desk_type as deskType, INITCAP(B.GSTR_DESK_NAME) as deskTypeName,DECODE(a.gnum_mapping_type, 1, 'Hospital Default', 2, 'Unit Wise', 3, 'Ward Wise', 4, 'User Wise', 0, 'Global Default') as mappingType,DECODE(a.gnum_mapping_type, 2, ( SELECT INITCAP(X.GSTR_DEPT_NAME)||' ('||INITCAP(Y.HGSTR_UNITNAME)||')' FROM gblt_department_mst X, hgbt_unit_mst Y where Y.HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND X.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND X.GNUM_DEPT_CODE\=Y.GNUM_DEPT_CODE AND Y.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND X.GNUM_ISVALID\=1 AND Y.GNUM_ISVALID\=1), 3, (select d.HIPSTR_WARD_NAME from HIPT_WARD_MST d where d.HIPNUM_WARD_CODE\=a.HIPNUM_WARD_CODE and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE), 4, (select d.gstr_user_name from GBLT_USER_MST d where d.gnum_userid\=A.GNUM_USERSEAT_ID and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)) as mappedTo, a.GNUM_DESK_ID AS deskId, a.GNUM_ISVALID AS isValid, (SELECT INITCAP(F.GSTR_DESK_NAME) FROM GBLT_DESK_MST F WHERE F.GNUM_DESK_ID\=A.GNUM_DESK_ID AND F.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND F.GNUM_ISVALID\=1 AND F.GNUM_ISDEFAULT_DESK\=0) as deskName from GBLT_USER_DESKMENU_MST A,GBLT_DESK_MST B  WHERE  A.gnum_desk_type\=B.gnum_desk_type AND  A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND\tB.GNUM_ISVALID\=1 AND  a.GNUM_DESK_TYPE \= ? AND a.GNUM_HOSPITAL_CODE \= ? AND a.GNUM_MAPPING_SEQNO\=? and a.gnum_isvalid\=1\t\t\t\t\t\t\t\t\t\t\t\t\t
											

UPDATE.GBLT_USER_DESKMENU_MST.OLD	=UPDATE GBLT_USER_DESKMENU_MST SET GNUM_DESK_ID\=?,GNUM_DESK_TYPE\=?,GNUM_ISVALID\=?, GNUM_SEAT_ID\=?,GDT_ENTRY_DATE\=SYSDATE WHERE GNUM_USERSEAT_ID\=? AND HGNUM_DEPTUNITCODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_USER_DESKMENU_ID \= ?

#modified by manisha gangwar date: 24.5.2016			
UPDATE.GBLT_USER_DESKMENU_MST	=UPDATE GBLT_USER_DESKMENU_MST SET GNUM_DESK_ID\=?, GNUM_ISVALID\=?, GNUM_SEAT_ID\=?,GDT_ENTRY_DATE\=SYSDATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_TYPE \= ? AND  GNUM_MAPPING_SEQNO\=? 
				
UPDATE_UNITWISE.GBLT_USER_DESKMENU_MST = UPDATE GBLT_USER_DESKMENU_MST SET GNUM_DESK_ID\=?,GNUM_DESK_TYPE\=?,GNUM_ISVALID\=?, GNUM_SEAT_ID\=?,GDT_ENTRY_DATE\=SYSDATE WHERE GNUM_USERSEAT_ID IS NULL AND HGNUM_DEPTUNITCODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_USER_DESKMENU_ID \= ?\t\t\t\t\t\t\t\t\t
		 
		 
INSERT.FIRST.HGBT_TEMPLATE_MST	=INSERT INTO HGBT_TEMPLATE_MST (HGNUM_TEMPLATE_ID, GNUM_HOSPITAL_CODE, HGSTR_TEMPLATE_NAME, HGNUM_TEMPLATE_TYPE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO,HGNUM_TEMPLATE_SLNO) VALUES ((SELECT NVL(MAX(HGNUM_TEMPLATE_ID),0)+1 FROM HGBT_TEMPLATE_MST WHERE GNUM_HOSPITAL_CODE\=?), ?,INITCAP(?),?,?,?, SYSDATE,TO_DATE(?,'dd-Mon-yyyy'),TO_DATE(?,'dd-Mon-yyyy'),'1')\t\t\t\t\t\t\t\t\t\t\t

SELECT.NEXT_DATE.HGBT_TEMPLATE_MST	=SELECT MIN(GDT_EFFECTIVE_FRM) FROM HGBT_TEMPLATE_MST WHERE HGNUM_TEMPLATE_ID \= ? AND GDT_EFFECTIVE_FRM > ? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\= ?

UPDATE.HGBT_TEMPLATE_MST	=UPDATE HGBT_TEMPLATE_MST SET HGSTR_TEMPLATE_NAME\=?, GDT_EFFECTIVE_FRM \= TO_DATE(?,'dd-Mon-yyyy'), GDT_EFFECTIVE_TO \= TO_DATE(?,'dd-Mon-yyyy'), GNUM_ISVALID\=? ,GNUM_SEAT_ID\=?, GDT_ENTRY_DATE \=  SYSDATE WHERE HGNUM_TEMPLATE_ID\=? AND HGNUM_TEMPLATE_SLNO\=? AND GNUM_HOSPITAL_CODE\=?

UPDATE.TABLE_NAME.HGBT_TEMPLATE_MST	=UPDATE HGBT_TEMPLATE_MST SET HGSTR_TEMPLATE_NAME\=?, GNUM_SEAT_ID\=?, GDT_ENTRY_DATE \= SYSDATE WHERE HGNUM_TEMPLATE_ID\=? AND GNUM_HOSPITAL_CODE\=?

SELECT.PREV_DATE.HGBT_TEMPLATE_MST	=SELECT COUNT(*) FROM HGBT_TEMPLATE_MST WHERE TRUNC(GDT_EFFECTIVE_FRM)<\=TRUNC(TO_DATE(?,'dd-Mon-yyyy')) AND TRUNC(NVL(GDT_EFFECTIVE_TO,GDT_EFFECTIVE_FRM))>\=  TRUNC(TO_DATE(?,'dd-Mon-yyyy')) AND HGNUM_TEMPLATE_ID \=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID > 0\t\t\t\t\t

SELECT.PREVIOUS_SERIAL_NO.HGBT_TEMPLATE_MST	=SELECT HGNUM_TEMPLATE_SLNO,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') FROM HGBT_TEMPLATE_MST WHERE HGNUM_TEMPLATE_ID \= ? AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_TO IS NULL
												
CREATE.NEW.HGBT_TEMPLATE_MST	=INSERT INTO HGBT_TEMPLATE_MST (HGNUM_TEMPLATE_ID, HGNUM_TEMPLATE_SLNO, GNUM_HOSPITAL_CODE, HGSTR_TEMPLATE_NAME, HGNUM_TEMPLATE_TYPE, GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE)VALUES (?, (SELECT NVL (MAX (HGNUM_TEMPLATE_SLNO),0) + 1 FROM HGBT_TEMPLATE_MST WHERE HGNUM_TEMPLATE_ID\=? AND GNUM_HOSPITAL_CODE\=?),?,INITCAP(?),?, TO_DATE(?, 'dd-Mon-yyyy'),TO_DATE(?, 'dd-Mon-yyyy'),?,?,SYSDATE)
									
UPDATE.PREVIOUS_ROW.HGBT_TEMPLATE_MST	=UPDATE HGBT_TEMPLATE_MST SET GDT_EFFECTIVE_TO\=TO_DATE(? ,'dd-mm-yyyy')-1 WHERE HGNUM_TEMPLATE_ID\=? AND HGNUM_TEMPLATE_SLNO\=? AND GNUM_HOSPITAL_CODE\=?

SELECT.MAX_TEMPLATE_ID.HGBT_TEMPLATE_MST	=	SELECT MAX(HGNUM_TEMPLATE_ID) FROM HGBT_TEMPLATE_MST WHERE GNUM_HOSPITAL_CODE =? AND GNUM_ISVALID=?

INSERT.HGBT_PARAMETER_MST	=INSERT INTO HGBT_PARAMETER_MST (HGSTR_PARA_ID, GNUM_HOSPITAL_CODE, HGSTR_PARA_NAME, GNUM_ISVALID, GNUM_SEAT_ID,GDT_ENTRY_DATE ) VALUES ( (SELECT NVL(MAX(TO_NUMBER(HGSTR_PARA_ID)),0)+1 FROM HGBT_PARAMETER_MST WHERE GNUM_HOSPITAL_CODE\=?), ?, INITCAP(?),?,?, SYSDATE)

SELECT.ID_BY_NAME.HGBT_PARAMETER_MST	=	SELECT HGSTR_PARA_ID FROM HGBT_PARAMETER_MST WHERE INITCAP(HGSTR_PARA_NAME) = INITCAP(?) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID =?
											
INSERT.HGBT_TEMPLATE_PARA_MST	=INSERT INTO HGBT_TEMPLATE_PARA_MST (HGNUM_TEMPLATE_ID, GNUM_HOSPITAL_CODE,HGSTR_PARA_ID, HGSTR_PARENT_PARA_ID, HGNUM_LOCATION_ID, HGNUM_ROW_ID, HGNUM_COL_ID, HGSTR_VALUE_OBJ_ID, HGSTR_VALUE_OBJ_PROP, HGSTR_PARA_VALUE, HGNUM_SOURCE_FLAG, HGSTR_TABLE_QUERY, HGNUM_COLSPAN, HGNUM_ISCOMPULSORY, HGNUM_ISRANGE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?, SYSDATE )\t

SELECT.BY_ID.HGBT_TEMPLATE_MST	=SELECT HGSTR_TEMPLATE_NAME, HGNUM_TEMPLATE_TYPE, TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy'),TO_CHAR(GDT_EFFECTIVE_TO,'dd-Mon-yyyy') FROM HGBT_TEMPLATE_MST WHERE HGNUM_TEMPLATE_ID\=? AND HGNUM_TEMPLATE_SLNO \=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?

INSERT.HOPT_PATIENT_PARA_DTL	=	INSERT INTO HOPT_PATIENT_PARA_DTL (HRGNUM_PUK,HGNUM_TEMPLATE_ID,HGNUM_PARA_ID,HGSTR_PARA_VALUE) VALUES (?,?,?,?)

INSERT.TEMPLATE_PARA_VALUES.HOPT_EPISODE_CLINICAL_DTL=INSERT INTO HOPT_EPISODE_CLINICAL_DTL (HRGNUM_PUK,HRGNUM_EPISODE_CODE,HRGNUM_VISIT_NO,GNUM_DESK_MENU_ID,\
												HGNUM_TEMPLATE_ID,HGSTR_PARA_ID,GNUM_HOSPITAL_CODE,\
												HGSTR_PARA_VALUE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
												VALUES (?,?,?,?,?,?,?,?,?,?, SYSDATE)

SELECT.HAS_RECORD.HOPT_EPISODE_CLINICAL_DTL	=SELECT COUNT(*) FROM HOPT_EPISODE_CLINICAL_DTL WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=? AND GNUM_DESK_MENU_ID\=? AND HGNUM_TEMPLATE_ID\=? AND HGSTR_PARA_ID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND GNUM_SEAT_ID \=?

UPDATE.TEMPLATE_PARA_VALUES.HOPT_EPISODE_CLINICAL_DTL	=UPDATE HOPT_EPISODE_CLINICAL_DTL SET HGSTR_PARA_VALUE \=? WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=? AND GNUM_DESK_MENU_ID\=? AND HGNUM_TEMPLATE_ID\=? AND HGSTR_PARA_ID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND GNUM_SEAT_ID \=? 

DELETE.BY_TEMP_ID.HGBT_TEMPLATE_PARA_MST=DELETE HGBT_TEMPLATE_PARA_MST WHERE HGNUM_TEMPLATE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?												


INSERT.GBLT_USER_DESKMENU_TEMPLATE.UNIT_WISE =INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_DESK_ID,GNUM_DESK_MENU_ID,HGNUM_TEMPLATE_ID,GNUM_HOSPITAL_CODE,HGNUM_ISDEFAULT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?),?,?,?,?,?,?,?,?,SYSDATE)

INSERT.GBLT_USER_DESKMENU_TEMPLATE.DESK_WISE =INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_SLNO,GNUM_DESK_ID,GNUM_DESK_MENU_ID,HGNUM_TEMPLATE_ID,GNUM_HOSPITAL_CODE,HGNUM_ISDEFAULT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?),?,?,?,?,?,?,?,SYSDATE)


INSERT.GBLT_USER_DESKMENU_TEMPLATE.SEAT_WISE =INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_USERSEAT_ID,GNUM_DESK_ID,GNUM_DESK_MENU_ID,HGNUM_TEMPLATE_ID,GNUM_HOSPITAL_CODE,HGNUM_ISDEFAULT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?),?,?,?,?,?,?,?,?,?,SYSDATE)

INSERT.GBLT_USER_DESKMENU_TEMPLATE.WARDSEAT_WISE =INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_USERSEAT_ID,HIPNUM_WARD_CODE,GNUM_DESK_ID,GNUM_DESK_MENU_ID,HGNUM_TEMPLATE_ID,GNUM_HOSPITAL_CODE,HGNUM_ISDEFAULT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?),?,?,?,?,?,?,?,?,?,?,SYSDATE)


INSERT.GBLT_USER_DESKMENU_TEMPLATE.WARD_WISE =INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_SLNO,HGNUM_DEPTUNITCODE,GNUM_DESK_ID,GNUM_DESK_MENU_ID,HGNUM_TEMPLATE_ID,HIPNUM_WARD_CODE,GNUM_HOSPITAL_CODE,HGNUM_ISDEFAULT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?),?,?,?,?,?,?,?,?,?,SYSDATE)\t\t\t\t\t\t
						
DELETE.GBLT_USER_DESKMENU_TEMPLATE_SEATWISE=UPDATE GBLT_USER_DESKMENU_TEMPLATE  SET GNUM_ISVALID \= 0 WHERE GNUM_SLNO \= ? 
								
DELETE.GBLT_USER_DESKMENU_TEMPLATE_DESKWISE=UPDATE GBLT_USER_DESKMENU_TEMPLATE  SET GNUM_ISVALID \= 0 WHERE GNUM_SLNO \= ? \t\t\t\t
								

DELETE.GBLT_USER_DESKMENU_TEMPLATE_UNITWISE=UPDATE GBLT_USER_DESKMENU_TEMPLATE  SET GNUM_ISVALID \= 0 WHERE GNUM_SLNO \= ? 
											
DELETE.GBLT_USER_DESKMENU_TEMPLATE_UNITWARDWISE	= UPDATE GBLT_USER_DESKMENU_TEMPLATE  SET GNUM_ISVALID \= 0 WHERE GNUM_SLNO \= ? \t\t\t\t\t\t\t\t\t
								 								 

INSERT.HOPT_DESK_MENU_MACRO = INSERT INTO HOPT_DESK_MENU_MACRO (HOPNUM_MACRO_ID, GNUM_DESK_TYPE, GNUM_DESK_MENU_ID, HGNUM_DEPTUNITCODE, HOPSTR_MACRO_HEAD, HOPSTR_MACRO_DESC, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE) VALUES((SELECT NVL(MAX(HOPNUM_MACRO_ID),0)+1 FROM HOPT_DESK_MENU_MACRO where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,SYSDATE,?)
				

DELETE.HOPT_DESK_MENU_MACRO = UPDATE HOPT_DESK_MENU_MACRO SET GNUM_ISVALID=? WHERE HOPNUM_MACRO_ID=? and GNUM_HOSPITAL_CODE=?

SELECT.ALL.HOPT_DESK_MENU_MACRO = SELECT HOPNUM_MACRO_ID, (SELECT GSTR_DESK_TYPE_DESC FROM GBLT_DESK_TYPE_MST WHERE GNUM_DESK_TYPE\=A.GNUM_DESK_TYPE and GNUM_HOSPITAL_CODE\=?) deskName, (SELECT GSTR_DESK_MENU_NAME FROM GBLT_DESK_MENU_MST WHERE GNUM_DESK_MENU_ID\=A.GNUM_DESK_MENU_ID and GNUM_HOSPITAL_CODE\=?) deskMenu, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE\=SUBSTR(HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=1)||'('|| (SELECT HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE and GNUM_HOSPITAL_CODE\=? )||')' deptUnitName, HOPSTR_MACRO_HEAD AS MACROHEAD, HOPSTR_MACRO_DESC AS MACRODESC FROM HOPT_DESK_MENU_MACRO A WHERE A.HOPNUM_MACRO_ID\=? and A.GNUM_HOSPITAL_CODE\=?\t\t\t
								  
UPDATE.HOPT_DESK_MENU_MACRO = update HOPT_DESK_MENU_MACRO set HOPSTR_MACRO_HEAD\=?, HOPSTR_MACRO_DESC\=? where HOPNUM_MACRO_ID\=? and GNUM_HOSPITAL_CODE\=?
								  				 
INSERT.INITIAL_ENTRY.HOPT_PAT_IMAGE_DTL	=INSERT INTO HOPT_PAT_IMAGE_DTL (HRGNUM_PUK, HRGNUM_S_NO, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES (?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HOPT_PAT_IMAGE_DTL WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=?), ?, ?, ?, ?, ?, SYSDATE)

SELECT.SNO_OF_CRNO.HOPT_PAT_IMAGE_DTL	=	SELECT MAX(HRGNUM_S_NO) FROM HOPT_PAT_IMAGE_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?

UPDATE.FINAL_RECORD.HOPT_PAT_IMAGE_DTL	=UPDATE HOPT_PAT_IMAGE_DTL SET HRGNUM_EPISODE_CODE \= ?, HRGNUM_VISIT_NO \= ?, HOPSTR_IMAGE_NAME \= ?, HOPSTR_IMAGE_FILENAME \= ?, HOPSTR_REMARKS \= ?, HOPSTR_DIR_PATH \= ?, GNUM_ISVALID \= ? , GNUM_SEAT_ID \= ?, GDT_ENTRY_DATE \= SYSDATE WHERE HRGNUM_PUK \= ? AND HRGNUM_S_NO \= ? AND GNUM_HOSPITAL_CODE \= ?
																	  				 
SELECT.EPISODE_IMAGES.HOPT_PAT_IMAGE_DTL	=SELECT HRGNUM_S_NO AS serialNo, INITCAP(HOPSTR_IMAGE_NAME) AS imageName, HOPSTR_IMAGE_FILENAME AS imageFileName, HOPSTR_DIR_PATH AS dirPath, HOPSTR_REMARKS AS remarks, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate FROM HOPT_PAT_IMAGE_DTL WHERE HRGNUM_PUK\=? AND HRGNUM_EPISODE_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? ORDER BY entryDate\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t 

INSERT.HOPT_IMAGE_MST = INSERT INTO HOPT_IMAGE_MST (HOPNUM_IMAGE_CODE,HOPNUM_SLNO, HOPSTR_IMAGE_NAME, HOPSTR_FILE_NAME, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT) VALUES ((SELECT NVL(MAX(HOPNUM_IMAGE_CODE),100)+1 FROM HOPT_IMAGE_MST where GNUM_HOSPITAL_CODE\=?),?,TRIM(INITCAP(?)), (UPPER(?)||(SELECT LPAD(NVL(MAX(HOPNUM_IMAGE_CODE),100)+1,3,'0') FROM HOPT_IMAGE_MST where GNUM_HOSPITAL_CODE\=?)||UPPER(?)),?,?,SYSDATE,?,?)


SELECT.FILENAME.HOPT_IMAGE_MST = SELECT UPPER(HOPSTR_FILE_NAME) FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=(SELECT MAX(HOPNUM_IMAGE_CODE) FROM HOPT_IMAGE_MST where GNUM_HOSPITAL_CODE\=?) AND UPPER(HOPSTR_IMAGE_NAME)\=UPPER(?) AND GNUM_ISVALID\=? AND GNUM_SEAT_ID\=? AND GNUM_HOSPITAL_CODE\=?
								  				 

SELECT.MODIFY.HOPT_IMAGE_MST = SELECT HOPNUM_IMAGE_CODE AS imageCode, HOPSTR_IMAGE_NAME AS imageName, UPPER(HOPSTR_FILE_NAME) AS fileName,GNUM_ISVALID AS isValid, HOPNUM_IS_DEFAULT as isDefault FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=? and HOPNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?\t
								
								
UPDATE.HOPT_IMAGE_MST = UPDATE\tHOPT_IMAGE_MST SET GDT_LSTMOD_DATE\=sysdate,GNUM_LSTMOD_SEATID\=?,GNUM_ISVALID\=? WHERE HOPNUM_IMAGE_CODE\=? AND GNUM_HOSPITAL_CODE\=? and HOPNUM_SLNO\=?
						
						
SELECT.FILENAME.MODIFY.HOPT_IMAGE_MST = SELECT UPPER(HOPSTR_FILE_NAME) FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=? AND UPPER(HOPSTR_IMAGE_NAME)\=UPPER(?) AND GNUM_ISVALID\=?\tAND GNUM_HOSPITAL_CODE\=? and HOPNUM_SLNO\=(SELECT MAX(HOPNUM_SLNO) FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=? AND GNUM_HOSPITAL_CODE \=?)\t\t\t\t
									
UPDATE.IMAGE_NAME.HOPT_IMAGE_MST = UPDATE HOPT_IMAGE_MST SET GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HOPNUM_IMAGE_CODE=? AND GNUM_HOSPITAL_CODE=? and HOPNUM_SLNO=?

MODIFYSAVEWITHIMAGE.HOPT_IMAGE_MST = INSERT INTO HOPT_IMAGE_MST (HOPNUM_IMAGE_CODE,HOPNUM_SLNO, HOPSTR_IMAGE_NAME, HOPSTR_FILE_NAME, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT) VALUES (?,(SELECT MAX(HOPNUM_SLNO)+1 FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=? AND GNUM_HOSPITAL_CODE \=?),TRIM(INITCAP(?)), (UPPER(?)||(LPAD(?,3,0))||UPPER(?)),?,?,SYSDATE,?,?)

MODIFYSAVEWITHOUTIMAGE.HOPT_IMAGE_MST = INSERT INTO HOPT_IMAGE_MST (HOPNUM_IMAGE_CODE,HOPNUM_SLNO, HOPSTR_IMAGE_NAME, HOPSTR_FILE_NAME, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT) VALUES (?,(SELECT MAX(HOPNUM_SLNO)+1 FROM HOPT_IMAGE_MST WHERE HOPNUM_IMAGE_CODE\=? AND GNUM_HOSPITAL_CODE \=?),TRIM(INITCAP(?)), UPPER(?),?,?,SYSDATE,?,?)


INSERT.HOPT_UNIT_IMAGEDESC_MST = INSERT INTO HOPT_UNIT_IMAGEDESC_MST (HGNUM_DEPTUNITCODE, HOPNUM_IMAGEDESC_ID, HOPSTR_COLOR, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_SLNO) \
								 VALUES (?,?,?,?,?,SYSDATE,?,?)
								 
MODIFYSAVE.HOPT_UNIT_IMAGEDESC_MST = INSERT INTO HOPT_UNIT_IMAGEDESC_MST (HGNUM_DEPTUNITCODE, HOPNUM_IMAGEDESC_ID, HOPSTR_COLOR, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_SLNO) VALUES (?,?,?,?,?,SYSDATE,?,(select max(HOPNUM_SLNO)+1 from HOPT_UNIT_IMAGEDESC_MST where  HGNUM_DEPTUNITCODE\=? and GNUM_HOSPITAL_CODE\=?))\t\t\t\t\t\t\t\t 
								 
								 
SELECT.HOPT_UNIT_IMAGEDESC_MST = SELECT A.HGNUM_DEPTUNITCODE, A.HOPSTR_COLOR||'&'|| decode(A.HOPSTR_COLOR,'000000','Black','0000FF','Blue','999999', 'Gray','009900','Green','FF9900','Orange','FFCCCC','Pink','FF0000','Red','FFFF00','Yellow')||'\#'|| A.HOPNUM_IMAGEDESC_ID||'&'|| (select HOPSTR_IMAGE_DESC from HOPT_IMAGEDESC_MST where HOPNUM_IMAGEDESC_ID\=a.HOPNUM_IMAGEDESC_ID and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?) FROM HOPT_UNIT_IMAGEDESC_MST A WHERE A.HGNUM_DEPTUNITCODE\=? AND A.GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? 
					  				 
					  				 
DELETE.HOPT_UNIT_IMAGEDESC_MST = UPDATE HOPT_UNIT_IMAGEDESC_MST SET GNUM_ISVALID=?,GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? WHERE HGNUM_DEPTUNITCODE=? and GNUM_HOSPITAL_CODE=?		

INSERT.HOPT_PLAYERFILE_MST = INSERT INTO HOPT_PLAYERFILE_MST (HOPNUM_FILE_CODE,HOPNUM_SLNO, HOPSTR_FILE_HEADER ,HOPSTR_FILE_NAME, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT) VALUES ((SELECT NVL(MAX(HOPNUM_FILE_CODE),100)+1 FROM HOPT_PLAYERFILE_MST WHERE GNUM_HOSPITAL_CODE\=?),?,TRIM(initcap(?)),(UPPER(?)||(SELECT LPAD(NVL(MAX(HOPNUM_FILE_CODE),100)+1,3,'0') FROM HOPT_PLAYERFILE_MST where GNUM_HOSPITAL_CODE\=?)||(?)),?,?,SYSDATE,?,?)
			  			

SELECT.HOPT_PLAYERFILE_MST = SELECT HOPSTR_FILE_NAME FROM HOPT_PLAYERFILE_MST WHERE HOPNUM_FILE_CODE\=(SELECT MAX(HOPNUM_FILE_CODE) FROM HOPT_PLAYERFILE_MST) AND GNUM_ISVALID\=? AND GNUM_SEAT_ID\=? AND GNUM_HOSPITAL_CODE\=?\t\t
							 
SELECT.MODIFY.HOPT_PLAYERFILE_MST = SELECT HOPNUM_FILE_CODE AS fileCode, HOPSTR_FILE_NAME AS  fileName ,HOPNUM_IS_DEFAULT as isDefault ,HOPSTR_FILE_HEADER as fileHeader FROM HOPT_PLAYERFILE_MST WHERE HOPNUM_FILE_CODE=?  AND GNUM_HOSPITAL_CODE=? and HOPNUM_SLNO=?


GET.HOPT_PLAYERFILE_MST = SELECT HOPSTR_FILE_NAME AS fileName FROM HOPT_PLAYERFILE_MST WHERE HOPNUM_FILE_CODE=? AND GNUM_HOSPITAL_CODE=?


UPDATE.HOPT_PLAYERFILE_MST =UPDATE\tHOPT_PLAYERFILE_MST SET GDT_LSTMOD_DATE\=sysdate,GNUM_LSTMOD_SEATID\=?,GNUM_ISVALID\=? WHERE HOPNUM_FILE_CODE\=? AND GNUM_HOSPITAL_CODE\=? and HOPNUM_SLNO\=?
				
MODIFYSAVE.HOPT_PLAYERFILE_MST = INSERT INTO HOPT_PLAYERFILE_MST (HOPNUM_FILE_CODE,HOPNUM_SLNO, HOPSTR_FILE_HEADER, HOPSTR_FILE_NAME, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT) VALUES (?,(SELECT MAX(HOPNUM_SLNO)+1 FROM HOPT_PLAYERFILE_MST WHERE HOPNUM_FILE_CODE\=? AND GNUM_HOSPITAL_CODE \=?),TRIM(INITCAP(?)), (UPPER(?)||(LPAD(?,3,0))||(?)),?,?,SYSDATE,?,?)\t\t\t\t

INSERT.HOPT_UNIT_IMAGE_MST	=INSERT INTO HOPT_UNIT_IMAGE_MST (HGNUM_DEPTUNITCODE, HOPNUM_IMAGE_CODE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HOPNUM_SLNO) VALUES(?,?,?,?,?,SYSDATE,(SELECT NVL(MAX(HOPNUM_SLNO),0)+1 FROM HOPT_UNIT_IMAGE_MST WHERE GNUM_HOSPITAL_CODE\=? AND HOPNUM_IMAGE_CODE \=? AND HGNUM_DEPTUNITCODE\=?))\t\t\t\t\t\t\t\t
							
GET_VIEW.HOPT_UNIT_IMAGE_MST	=SELECT A.HOPNUM_IMAGE_CODE AS imageUnitCode,A.HOPSTR_IMAGE_NAME AS imageName,A.HOPSTR_FILE_NAME AS fileName FROM HOPT_IMAGE_MST A,HOPT_UNIT_IMAGE_MST B WHERE A.HOPNUM_IMAGE_CODE\=B.HOPNUM_IMAGE_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.HGNUM_DEPTUNITCODE\=? AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=? and a.gnum_isvalid\=b.gnum_isvalid
									
SELECT.EXIST.HGBT_DEPT_HOSDISEASE_MST= SELECT COUNT(*) FROM HGBT_DEPT_HOSDISEASE_MST WHERE HGBSTR_HOSPITAL_DISEASE_CODE\=? AND GNUM_DEPT_CODE\=? AND HGNUM_DEPTUNITCODE\=? AND GNUM_HOSPITAL_CODE\=?
									   
									   									


INSERT.HOPT_UNIT_PLAYERFILE_MST = INSERT INTO HOPT_UNIT_PLAYERFILE_MST \
									(HGNUM_DEPTUNITCODE, HOPNUM_FILE_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HOPNUM_SLNO) \
									VALUES(?,?,?,?,SYSDATE,?,?)

DELETE.HOPT_UNIT_PLAYERFILE_MST = DELETE HOPT_UNIT_PLAYERFILE_MST WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?

DELETE.REMOVE_INITIAL_ENTRY.HOPT_PAT_IMAGE_DTL   =   DELETE HOPT_PAT_IMAGE_DTL WHERE HRGNUM_PUK=? AND HOPSTR_IMAGE_FILENAME IS NULL AND GNUM_HOSPITAL_CODE=?									

DELETE.REMOVE_ALL_VALUES.HOPT_EPISODE_CLINICAL_DTL	=DELETE HOPT_EPISODE_CLINICAL_DTL WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? AND GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID IN (@) AND GNUM_HOSPITAL_CODE \= ?
					
COUNTDEFAULT.GBLT_DESK_MST = select * from GBLT_DESK_MST where GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND GNUM_ISDEFAULT_DESK=? AND GNUM_DESK_TYPE=? AND GNUM_DESK_ID<>? 

DELETE.BY.DISEASE.HGBT_DEPT_HOSDIS_MST= UPDATE HGBT_DEPT_HOSDISEASE_MST SET GNUM_ISVALID \= 0 WHERE GNUM_DEPT_CODE \= ? AND HGNUM_DEPTUNITCODE \= ? AND HGBSTR_HOSPITAL_DISEASE_CODE \= ?\tAND GNUM_HOSPITAL_CODE \=?
										
														

UPDATE.DELETE_BY_HOPDISEASECODE.HGBT_ICD_HOSPITAL_MST	=	UPDATE HGBT_ICD_HOSPITAL_MST SET GNUM_ISVALID=0 WHERE HGBSTR_HOSPITAL_DISEASE_CODE=? AND GNUM_HOSPITAL_CODE=?						
								 
SELECT.EXIST.HGBT_ICD_HOSPITAL_MST	=SELECT COUNT(*) FROM HGBT_ICD_HOSPITAL_MST WHERE HGBSTR_HOSPITAL_DISEASE_CODE \=? AND HGBSTR_DISEASE_CODE\=? AND GNUM_HOSPITAL_CODE \=? 

UPDATE.ACTIVE_RECORD.HGBT_ICD_HOSPITAL_MST	=UPDATE HGBT_ICD_HOSPITAL_MST SET GNUM_ISVALID\=1 WHERE HGBSTR_HOSPITAL_DISEASE_CODE\=? AND HGBSTR_DISEASE_CODE\=? AND GNUM_HOSPITAL_CODE\=?

INSERT.HGBT_ICD_HOSPITAL_MST= INSERT INTO HGBT_ICD_HOSPITAL_MST \
									(HGBSTR_DISEASE_CODE,HGBSTR_HOSPITAL_DISEASE_CODE,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GDT_ENTRY_DATE,GNUM_SEAT_ID) \
									VALUES(?,?,?,?,SYSDATE,?)





SELECT.UNIT_WISE_FULL_INFO.GBLT_USER_DESKMENU_MST = SELECT A.GNUM_USER_DESKMENU_ID,INITCAP(D.GSTR_DEPT_NAME) || ' (' || INITCAP(C.HGSTR_UNITNAME) || ')',INITCAP(E.GSTR_DESK_NAME), A.GNUM_DESK_TYPE FROM GBLT_USER_DESKMENU_MST A, HGBT_UNIT_MST C , GBLT_DEPARTMENT_MST D, GBLT_DESK_MST E,GBLT_DESK_TYPE_MST F WHERE A.HGNUM_DEPTUNITCODE\=C.HGNUM_DEPTUNITCODE AND A.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE AND C.GNUM_DEPT_CODE\=D.GNUM_DEPT_CODE AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE AND A.GNUM_DESK_ID\=E.GNUM_DESK_ID AND A.GNUM_HOSPITAL_CODE\=E.GNUM_HOSPITAL_CODE AND A.GNUM_DESK_TYPE\=F.GNUM_DESK_TYPE AND A.GNUM_HOSPITAL_CODE\=F.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_USER_DESKMENU_ID \= ?  AND D.GNUM_ISVALID\=1
														
														
														
														
INSERT_UNIT_WARD_MAPPING_MASTER.GBLT_USER_DESKMENU_MST	=INSERT INTO GBLT_USER_DESKMENU_MST (GNUM_USER_DESKMENU_ID,HGNUM_DEPTUNITCODE, GNUM_DESK_ID, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_DESK_TYPE, GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_USER_DESKMENU_ID),1)+1 FROM GBLT_USER_DESKMENU_MST WHERE GNUM_HOSPITAL_CODE\=? ),?,?,?,?,?,?,SYSDATE)
								 							
								 							
INSERT_UNIT_WARD_MAPPING_MASTER_UNIT_WARD_WISE.GBLT_USER_DESKMENU_MST =INSERT INTO GBLT_USER_DESKMENU_MST (GNUM_USER_DESKMENU_ID,GNUM_USERSEAT_ID,HIPNUM_WARD_CODE,HGNUM_DEPTUNITCODE, GNUM_DESK_ID,GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_DESK_TYPE, GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(GNUM_USER_DESKMENU_ID),1)+1 FROM GBLT_USER_DESKMENU_MST WHERE GNUM_HOSPITAL_CODE\=? ),?,?,?,?,?,?,?,?,SYSDATE)\t
								 			
								 			
								 			
								 										 							
SELECT.FULL_INFO_UNIT_WARD_SEAT_WISE.GBLT_USER_DESKMENU_MST= SELECT A.GNUM_USER_DESKMENU_ID,A.HGNUM_DEPTUNITCODE,A.GNUM_DESK_ID, A.GNUM_USERSEAT_ID, A.GNUM_ISVALID, A.GNUM_DESK_TYPE,A.HIPNUM_WARD_CODE FROM GBLT_USER_DESKMENU_MST A WHERE A.GNUM_USER_DESKMENU_ID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_ISVALID \= ?
																		
											
SELECT.FULL_INFO_UNIT_WARD_WISE.GBLT_USER_DESKMENU_MST=SELECT A.GNUM_USER_DESKMENU_ID,INITCAP(D.GSTR_DEPT_NAME) || ' (' || INITCAP(C.HGSTR_UNITNAME) || ')',INITCAP(E.GSTR_DESK_NAME), INITCAP (B.HIPSTR_WARD_NAME),A.GNUM_DESK_TYPE FROM GBLT_USER_DESKMENU_MST A,HIPT_WARD_MST B, HGBT_UNIT_MST C ,GBLT_DEPARTMENT_MST D, GBLT_DESK_MST E,GBLT_DESK_TYPE_MST F WHERE B.HIPNUM_WARD_CODE \=A.HIPNUM_WARD_CODE AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND TRUNC(B.GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND A.HGNUM_DEPTUNITCODE \= C.HGNUM_DEPTUNITCODE AND A.GNUM_HOSPITAL_CODE \= C.GNUM_HOSPITAL_CODE AND C.GNUM_DEPT_CODE\=D.GNUM_DEPT_CODE AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE AND A.GNUM_DESK_ID\=E.GNUM_DESK_ID AND A.GNUM_HOSPITAL_CODE\= E.GNUM_HOSPITAL_CODE AND A.GNUM_DESK_TYPE\=F.GNUM_DESK_TYPE AND A.GNUM_HOSPITAL_CODE\=F.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_USER_DESKMENU_ID \= ? AND D.GNUM_ISVALID\=1



UPDATE_UNIT_WARD_SEAT_MAPPING_MASTER.GBLT_USER_DESKMENU_MST	=UPDATE GBLT_USER_DESKMENU_MST SET GNUM_DESK_ID\=?, GNUM_DESK_TYPE\=?,GNUM_ISVALID\=?,GNUM_SEAT_ID\=?,GDT_ENTRY_DATE\=SYSDATE WHERE GNUM_USERSEAT_ID\=? AND HGNUM_DEPTUNITCODE\=? AND HIPNUM_WARD_CODE\=? AND GNUM_HOSPITAL_CODE\=?
								    
								    
								    
								    
<!-- Allergy Type Master queries-->							    
<!--SELECT.ALL_TABLE_NAME = SELECT TABLE_NAME,INITCAP(TABLE_NAME) FROM TABS WHERE TABLE_NAME LIKE '%MST' ORDER BY INITCAP(TABLE_NAME)-->
                        
SELECT.ALL_TABLE_NAME = SELECT TABLENAME,INITCAP(TABLENAME) FROM PG_TABLES WHERE upper(TABLENAME) LIKE upper('%MST') \
                        ORDER BY INITCAP(TABLENAME)
                        
                        
                         
								    
SELECT.COLUMN_NAME_BY_TABLE_NAME = SELECT  COLUMN_NAME FROM  USER_TAB_COLUMNS WHERE TABLE_NAME=UPPER(?) ORDER BY COLUMN_NAME 
                        
SELECT.PRIMARY_KEY_BY_TABLE_NAME = SELECT  COLUMN_NAME FROM USER_CONSTRAINTS A,USER_CONS_COLUMNS B WHERE A.TABLE_NAME\=UPPER(?) AND UPPER(CONSTRAINT_TYPE) LIKE '%P%' AND A.TABLE_NAME\=B.TABLE_NAME AND A.CONSTRAINT_NAME \= B.CONSTRAINT_NAME
                        
CHECK_DUPLICATE_BEFORE_INSERT.HGBT_ALLERGIES_TYPE_MST = SELECT HGSTR_ALLERGY_TYPE FROM HGBT_ALLERGY_TYPE_MST WHERE HGSTR_ALLERGY_TYPE\=INITCAP(?) AND  GNUM_ISVALID<>? AND GNUM_HOSPITAL_CODE\=?                         

CHECK_DUPLICATE_BEFORE_UPDATE.HGBT_ALLERGIES_TYPE_MST = SELECT HGSTR_ALLERGY_TYPE FROM HGBT_ALLERGY_TYPE_MST WHERE HGSTR_ALLERGY_TYPE\=INITCAP(?) AND  GNUM_ISVALID<>? AND GNUM_HOSPITAL_CODE\=? AND HGNUM_ALLERGY_TYPE_CODE<>?                         

							        
INSERT.HGBT_ALLERGY_TYPE_MST_DYNAMIC_MODE = INSERT INTO HGBT_ALLERGY_TYPE_MST (HGNUM_ALLERGY_TYPE_CODE, HGSTR_ALLERGY_TYPE, HGSTR_ALLERGY_DESC, HGNUM_SOURCE_FLAG, GNUM_ISVALID, HGSTR_TABLE_QUERY, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE,HGNUM_SENSITIVITY_CODE) values ((SELECT NVL (MAX (HGNUM_ALLERGY_TYPE_CODE), 10) + 1 FROM HGBT_ALLERGY_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=?),initcap(?),initcap(?),?,?,?,?,?,SYSDATE,?)
							                
							                
SELECT_ALLERGY_TYPE_CODE = SELECT NVL (MAX(HGNUM_ALLERGY_TYPE_CODE),10) FROM HGBT_ALLERGY_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=?
						   
						   
						   
INSERT.HGBT_ALLERGY_MST = INSERT INTO HGBT_ALLERGY_MST (HGNUM_ALLERGY_ID, HGNUM_ALLERGY_TYPE_CODE, HGSTR_ALLERGY_NAME, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES ((SELECT NVL (MAX (HGNUM_ALLERGY_ID), 10) + 1 FROM HGBT_ALLERGY_MST WHERE GNUM_HOSPITAL_CODE\=?),?,'others',?,?,?,SYSDATE)
                          
                          
                          
SELECT.HGBT_ALLERGIES_TYPE_MST = SELECT  HGNUM_ALLERGY_TYPE_CODE as allergiesCode,HGSTR_ALLERGY_TYPE as allergiesType, HGSTR_ALLERGY_DESC as allergiesDesc,HGNUM_SOURCE_FLAG as sourceFlag, HGSTR_TABLE_QUERY as longQuery,GNUM_ISVALID as isValid,HGNUM_SENSITIVITY_CODE as allergySensitivity FROM HGBT_ALLERGY_TYPE_MST WHERE HGNUM_ALLERGY_TYPE_CODE\=?\tAND GNUM_HOSPITAL_CODE\=?
 								  
 								  
UPDATE.HGBT_ALLERGIES_TYPE_MST = UPDATE HGBT_ALLERGY_TYPE_MST SET HGSTR_ALLERGY_TYPE\=initcap(?), HGSTR_ALLERGY_DESC\=initcap(?), HGNUM_SOURCE_FLAG\=?, HGSTR_TABLE_QUERY\=?,GNUM_ISVALID\=?, HGNUM_SENSITIVITY_CODE\=? WHERE HGNUM_ALLERGY_TYPE_CODE\=? and GNUM_HOSPITAL_CODE\=?\t
									
									
SELECT_ALLERGY_TYPE_NOTIN_ALLERGYWISE_SYMPTOM = SELECT INITCAP(A.HGNUM_ALLERGY_TYPE_CODE),INITCAP(A.HGSTR_ALLERGY_TYPE) FROM HGBT_ALLERGY_TYPE_MST A WHERE A.HGNUM_ALLERGY_TYPE_CODE NOT IN (SELECT B.HGNUM_ALLERGY_TYPE_CODE FROM HGBT_ALLERGYWISE_SYMPTOM_MST B WHERE B.GNUM_ISVALID\=? AND B.GNUM_HOSPITAL_CODE\=?) AND A.GNUM_ISVALID\=? AND A.GNUM_HOSPITAL_CODE\=? 
                                                
SELECT_SYMPTOM_LIST_WHERE_SYMPTOMTYPE_IS_ONE = SELECT INITCAP(HGNUM_SYMPTOM_CODE),INITCAP(HGNUM_SYMPTOM_DESC) FROM HGBT_ALLERGY_SYMPTOM_MST WHERE HGNUM_SYMPTOM_TYPE \= 1 AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? 
											   
											   
INSERT_HGBT_ALLERGYWISE_SYMPTOM_MST =INSERT INTO HGBT_ALLERGYWISE_SYMPTOM_MST (HGNUM_SYMPTOM_CODE,HGNUM_ALLERGY_TYPE_CODE,GNUM_ISVALID, GNUM_HOSPITAL_CODE,HGNUM_SEAT_ID, HGDT_ENTRY_DATE,HGNUM_SLNO) VALUES(?,?,?,?,?,SYSDATE,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_ALLERGYWISE_SYMPTOM_MST WHERE GNUM_HOSPITAL_CODE\=? and HGNUM_ALLERGY_TYPE_CODE\=? and HGNUM_SYMPTOM_CODE\=?))\t
								 		
								 		
SELECT_SELECTED_SYMPTOM_LIST = SELECT A.HGNUM_SYMPTOM_CODE,A.HGNUM_SYMPTOM_DESC FROM HGBT_ALLERGY_SYMPTOM_MST A WHERE A.GNUM_HOSPITAL_CODE\=? AND A.HGNUM_SYMPTOM_TYPE\=1 AND A.GNUM_ISVALID\=? AND A.HGNUM_SYMPTOM_CODE IN( SELECT HGNUM_SYMPTOM_CODE FROM HGBT_ALLERGYWISE_SYMPTOM_MST WHERE GNUM_HOSPITAL_CODE \=? AND GNUM_ISVALID \= ? AND HGNUM_ALLERGY_TYPE_CODE\=?)
                               
SELECT_REMAINING_SYMPTOM_LIST= SELECT A.HGNUM_SYMPTOM_CODE, A.HGNUM_SYMPTOM_DESC FROM HGBT_ALLERGY_SYMPTOM_MST A WHERE A.GNUM_HOSPITAL_CODE \= ? AND A.HGNUM_SYMPTOM_TYPE \= 1 AND A.GNUM_ISVALID \= ? AND A.HGNUM_SYMPTOM_CODE NOT IN (SELECT HGNUM_SYMPTOM_CODE FROM HGBT_ALLERGYWISE_SYMPTOM_MST WHERE GNUM_HOSPITAL_CODE \=? AND GNUM_ISVALID \= ? AND HGNUM_ALLERGY_TYPE_CODE\=?)
                                
								 		
								 		
								 		
								 		
SELECT_ALLERGY_TYPE_AND_SYMPTOM_LIST = SELECT A.HGSTR_ALLERGY_TYPE,C.HGNUM_SYMPTOM_DESC FROM HGBT_ALLERGY_TYPE_MST A,HGBT_ALLERGYWISE_SYMPTOM_MST B, HGBT_ALLERGY_SYMPTOM_MST C WHERE C.HGNUM_SYMPTOM_CODE\=B.HGNUM_SYMPTOM_CODE AND C.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE AND A.HGNUM_ALLERGY_TYPE_CODE\=B.HGNUM_ALLERGY_TYPE_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.HGNUM_ALLERGY_TYPE_CODE\=? AND B.HGNUM_SYMPTOM_CODE\=? AND B.GNUM_ISVALID\=? AND B.GNUM_HOSPITAL_CODE\=?
                                       
                                       
 
 
                           								 		
								 														                                                    
                                                										  
 								  		                          
							                 						   
							                 							                							        
	                        
								 							
SELECT.SERVICEID_QUERY.HGBT_CONSENT_SERVICE_MST=select HBSTR_QUERY from HGBT_CONSENT_SERVICE_MST where HGNUM_SERVICE_TYPE_ID=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?

SELECT.SERVICELISTFORMODIFY.HGBT_TEMPLATE_MST = SELECT DISTINCT HGSTR_SERVICE_ID, INITCAP(HGSTR_SERVICE_DESC) FROM HGBT_CONSENT_MAPPING WHERE HGNUM_TEMPLATE_TYPE=? AND HGNUM_SERVICE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND HGSTR_SERVICE_ID IN (SELECT DISTINCT HGSTR_SERVICE_ID FROM HGBT_CONSENT_MAPPING WHERE HGNUM_TEMPLATE_TYPE=? AND HGNUM_SERVICE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND HGNUM_TEMPLATE_ID IN ( SELECT DISTINCT HGNUM_TEMPLATE_ID FROM HGBT_CONSENT_MAPPING WHERE HGNUM_TEMPLATE_TYPE=? AND HGNUM_SERVICE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?)) GROUP BY HGSTR_SERVICE_ID, INITCAP(HGSTR_SERVICE_DESC) HAVING COUNT (HGNUM_TEMPLATE_ID)=(SELECT DISTINCT COUNT(HGNUM_TEMPLATE_ID) FROM HGBT_CONSENT_MAPPING WHERE HGNUM_TEMPLATE_TYPE=? and HGNUM_SERVICE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?)  

SELECT.SELECTEDSERVICELISTFORMODIFY.HGBT_TEMPLATE_MST = SELECT DISTINCT HGSTR_SERVICE_ID, INITCAP(HGSTR_SERVICE_DESC) FROM HGBT_CONSENT_MAPPING WHERE HGNUM_SERVICE_TYPE_ID=? AND HGNUM_TEMPLATE_ID=? AND HGSTR_SERVICE_ID=? and HGNUM_SLNO=? and GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?

SELECT.TEMPLATELIST.HGBT_TEMPLATE_MST=select distinct HGNUM_TEMPLATE_ID ,HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_CATEGORY\=? and HGNUM_TEMPLATE_ID NOT IN  (select distinct hgnum_template_id  from hgbt_consent_mapping  where gnum_isvalid \= 1   AND gnum_hospital_code \= ?  and HGNUM_SERVICE_TYPE_ID \= ?  and HGSTR_SERVICE_ID\=?)  and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t


INSERT.HGBT_CONSENT_MAPPING=insert into HGBT_CONSENT_MAPPING (HGNUM_SERVICE_TYPE_ID,HGNUM_TEMPLATE_ID,HGSTR_SERVICE_ID,HGNUM_SLNO,GNUM_HOSPITAL_CODE,GNUM_ISVALID,HGNUM_TEMPLATE_TYPE,GNUM_SEAT_ID,GDT_ENTRY_DATE,HGSTR_SERVICE_DESC) values(?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_CONSENT_MAPPING WHERE GNUM_HOSPITAL_CODE\=? and HGNUM_SERVICE_TYPE_ID\=? and HGNUM_TEMPLATE_ID\=? and HGSTR_SERVICE_ID\=?),?,?,?,?,sysdate,? )

SELECT.SERVICEDESC.HGBT_CONSENT_SERVICE_MST=select HBSTR_SERVICE_TYPE from HGBT_CONSENT_SERVICE_MST where HGNUM_SERVICE_TYPE_ID=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?

SELECT.SERVICEDESC_TEMPLATEDESC.HGBT_CONSENT_MAPPING=select HGSTR_SERVICE_DESC,HGNUM_TEMPLATE_TYPE from HGBT_CONSENT_MAPPING where HGNUM_SERVICE_TYPE_ID=? and HGNUM_TEMPLATE_ID=? and HGSTR_SERVICE_ID=? and HGNUM_SLNO=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?

SELECT.TEMPLATETYPEDESC.HGBT_TEMPLATE_MST=select HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_TYPE=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?
													
SELECT.SELECTEDTEMPLATELIST.HGBT_TEMPLATE_MST=select distinct HGNUM_TEMPLATE_ID ,HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_CATEGORY\=? and HGNUM_TEMPLATE_ID IN  (select distinct hgnum_template_id  from hgbt_consent_mapping  where gnum_isvalid \= 1   AND gnum_hospital_code \= ?  and HGNUM_SERVICE_TYPE_ID \= ?  and HGSTR_SERVICE_ID\=?)  and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t

UPDATE.HGBT_CONSENT_MAPPING=UPDATE HGBT_CONSENT_MAPPING SET GNUM_ISVALID\=0 , GNUM_LSTMOD_SEATID\=? , GDT_LSTMOD_DATE\=sysdate  where HGNUM_SERVICE_TYPE_ID\=?  and HGSTR_SERVICE_ID\=? and GNUM_HOSPITAL_CODE\=? and HGNUM_TEMPLATE_TYPE\=?
							
SELECT.SELECTEDSERVICEIDLIST.HGBT_CONSENT_MAPPING=select HGSTR_SERVICE_ID,HGSTR_SERVICE_DESC from HGBT_CONSENT_MAPPING where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? and HGNUM_SERVICE_TYPE_ID=? and HGNUM_TEMPLATE_TYPE=?							
								
UPDATE.HGBT_ALLERGYWISE_SYMPTOM_MST=update HGBT_ALLERGYWISE_SYMPTOM_MST set GNUM_ISVALID=? where HGNUM_ALLERGY_TYPE_CODE=? and GNUM_HOSPITAL_CODE=?										
																		 							
																		 							
								 							
								 																					


SELECT.GBLT_USER_DESKMENU_TEMPLATE  = SELECT GNUM_SLNO, GNUM_DESK_ID, GNUM_DESK_MENU_ID, GNUM_USERSEAT_ID, HGNUM_DEPTUNITCODE, HGNUM_ISDEFAULT, HGNUM_TEMPLATE_ID,HIPNUM_WARD_CODE, GNUM_HOSPITAL_CODE FROM GBLT_USER_DESKMENU_TEMPLATE A WHERE GNUM_SLNO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \=? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

SELECT_WARDUNITMODE.GBLT_USER_DESKMENU_TEMPLATE  = SELECT GNUM_SLNO, GNUM_DESK_ID, GNUM_DESK_MENU_ID, HIPNUM_WARD_CODE, HGNUM_DEPTUNITCODE, HGNUM_ISDEFAULT, HGNUM_TEMPLATE_ID, GNUM_HOSPITAL_CODE FROM GBLT_USER_DESKMENU_TEMPLATE A WHERE GNUM_SLNO\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_DESK_MENU_ID \=? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ?\t\t\t
										
SELECT.ALLERGYTYPE.HGBT_ALLERGY_TYPE_MST=SELECT hgstr_allergy_type  FROM hgbt_allergy_type_mst where HGNUM_ALLERGY_TYPE_CODE=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?	

SELECT.DUPLICATE_CHECK.HOPT_IMAGE_MST =	SELECT COUNT (*) FROM hopt_image_mst WHERE trim(upper(hopstr_image_name)) = trim(upper(?)) AND gnum_isvalid = ? AND gnum_hospital_code =?																					

SELECT.MODIFY_DUPLICATE_CHECK.HOPT_IMAGE_MST =  SELECT COUNT (*) FROM hopt_image_mst WHERE trim(upper(hopstr_image_name)) = trim(upper(?)) AND gnum_isvalid !=? AND gnum_hospital_code =? and HOPNUM_IMAGE_CODE!=?


SELECT.DUPLICATE_CHECK.HOPT_PLAYERFILE_MST = select count(*) from HOPT_PLAYERFILE_MST where TRIM (UPPER (HOPSTR_FILE_HEADER)) = TRIM (UPPER (?)) and gnum_isvalid=? AND gnum_hospital_code =?


SELECT.MODIFY_DUPLICATE_CHECK.HOPT_PLAYERFILE_MST = select count(*) from HOPT_PLAYERFILE_MST where TRIM (UPPER (HOPSTR_FILE_HEADER)) = TRIM (UPPER (?)) and gnum_isvalid!=? AND gnum_hospital_code =? and HOPNUM_FILE_CODE!=?


SELECT_MENU_TEMPLATE_BY_DESK.GBLT_USER_DESKMENU_TEMPLATE = SELECT X.GNUM_DESK_ID AS deskId, X.GNUM_DESK_MENU_ID AS deskMenuId, X.HGNUM_TEMPLATE_ID AS templateId, X.HGNUM_ISDEFAULT AS isDefault, DECODE(X.HGNUM_ISDEFAULT,0,'False',1,'True') AS isDefaultName, X.HGNUM_DISPLAY_ORDER AS displayOrder, (SELECT INITCAP(A.GSTR_DESK_MENU_NAME) FROM GBLT_DESK_MENU_MST A WHERE A.GNUM_DESK_MENU_ID\=X.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?) AS deskMenuName, (SELECT INITCAP(B.HGSTR_TEMPLATE_NAME) FROM HGBT_TEMPLATE_MST B WHERE B.HGNUM_TEMPLATE_ID\=X.HGNUM_TEMPLATE_ID AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=?) as templateName FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.HGNUM_DEPTUNITCODE IS NULL AND X.GNUM_USERSEAT_ID IS NULL AND X.HIPNUM_WARD_CODE IS NULL ORDER BY deskMenuName, X.HGNUM_DISPLAY_ORDER
															

INSERT_BY_DESK_GBLT_USER_DESKMENU_TEMPLATE	=INSERT INTO GBLT_USER_DESKMENU_TEMPLATE (GNUM_DESK_ID, GNUM_DESK_MENU_ID, HGNUM_TEMPLATE_ID, GNUM_HOSPITAL_CODE, GNUM_SLNO, GNUM_USERSEAT_ID, HGNUM_DEPTUNITCODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HGNUM_ISDEFAULT, HIPNUM_WARD_CODE, HGNUM_DISPLAY_ORDER) VALUES(?,?,?,?,(SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_DESK_ID\=? AND GNUM_DESK_MENU_ID\=? AND HGNUM_TEMPLATE_ID\=? AND GNUM_HOSPITAL_CODE\=?),?,?,?,?,SYSDATE,?,?,?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
												
DELETE_BY_DESK_GBLT_USER_DESKMENU_TEMPLATE	=	UPDATE GBLT_USER_DESKMENU_TEMPLATE SET GNUM_ISVALID=? WHERE GNUM_DESK_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE IS NULL AND HIPNUM_WARD_CODE IS NULL AND GNUM_USERSEAT_ID IS NULL												



INSERT_BY_UNIT_GBLT_USER_DESKMENU_TEMPLATE = INSERT INTO GBLT_USER_DESKMENU_TEMPLATE(GNUM_DESK_ID, GNUM_DESK_MENU_ID, HGNUM_TEMPLATE_ID, GNUM_HOSPITAL_CODE, GNUM_SLNO, HGNUM_DEPTUNITCODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HGNUM_ISDEFAULT) VALUES(?,?,?,?,(SELECT NVL(MAX(GNUM_SLNO),10000)+1 FROM GBLT_USER_DESKMENU_TEMPLATE WHERE GNUM_DESK_MENU_ID \= ? AND HGNUM_TEMPLATE_ID \= ? AND GNUM_DESK_ID \= ? AND GNUM_HOSPITAL_CODE \= ?),?,?,?,SYSDATE,?)

												
SELECT_MENU_TEMPLATE_BY_DESKNUNIT.GBLT_USER_DESKMENU_TEMPLATE = SELECT X.GNUM_DESK_ID AS deskId, X.GNUM_DESK_MENU_ID AS deskMenuId, X.HGNUM_TEMPLATE_ID AS templateId, X.HGNUM_ISDEFAULT AS isDefault, DECODE(X.HGNUM_ISDEFAULT,0,'False',1,'True') AS isDefaultName, X.HGNUM_DISPLAY_ORDER AS displayOrder, (SELECT INITCAP(A.GSTR_DESK_MENU_NAME) FROM GBLT_DESK_MENU_MST A WHERE A.GNUM_DESK_MENU_ID\=X.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?) AS deskMenuName, (SELECT INITCAP(B.HGSTR_TEMPLATE_NAME) FROM HGBT_TEMPLATE_MST B WHERE B.HGNUM_TEMPLATE_ID\=X.HGNUM_TEMPLATE_ID AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=?) as templateName FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.HGNUM_DEPTUNITCODE\=? AND X.GNUM_USERSEAT_ID IS NULL AND X.HIPNUM_WARD_CODE IS NULL ORDER BY deskMenuName, X.HGNUM_DISPLAY_ORDER\t\t\t\t\t\t\t\t\t\t\t\t
																

DELETE_BY_DESKNUNIT_GBLT_USER_DESKMENU_TEMPLATE = UPDATE GBLT_USER_DESKMENU_TEMPLATE SET GNUM_ISVALID=? WHERE GNUM_DESK_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE=? AND HIPNUM_WARD_CODE IS NULL AND GNUM_USERSEAT_ID IS NULL


SELECT_MENU_TEMPLATE_BY_DESKUNIT_N_SEAT.GBLT_USER_DESKMENU_TEMPLATE = SELECT X.GNUM_DESK_ID AS deskId, X.GNUM_DESK_MENU_ID AS deskMenuId, X.HGNUM_TEMPLATE_ID AS templateId, X.HGNUM_ISDEFAULT AS isDefault, DECODE(X.HGNUM_ISDEFAULT,0,'False',1,'True') AS isDefaultName, X.HGNUM_DISPLAY_ORDER AS displayOrder, (SELECT INITCAP(A.GSTR_DESK_MENU_NAME) FROM GBLT_DESK_MENU_MST A WHERE A.GNUM_DESK_MENU_ID\=X.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?) AS deskMenuName, (SELECT INITCAP(B.HGSTR_TEMPLATE_NAME) FROM HGBT_TEMPLATE_MST B WHERE B.HGNUM_TEMPLATE_ID\=X.HGNUM_TEMPLATE_ID AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=?) as templateName FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.HGNUM_DEPTUNITCODE\=? AND X.GNUM_USERSEAT_ID\=? AND X.HIPNUM_WARD_CODE IS NULL ORDER BY deskmenuname, X.HGNUM_DISPLAY_ORDER
								
DELETE_BY_DESK_UNIT_N_SEAT_GBLT_USER_DESKMENU_TEMPLATE = UPDATE GBLT_USER_DESKMENU_TEMPLATE SET GNUM_ISVALID=? WHERE GNUM_DESK_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE=? AND HIPNUM_WARD_CODE IS NULL AND GNUM_USERSEAT_ID=?


SELECT_MENU_TEMPLATE_BY_DESKUNIT_N_WARD.GBLT_USER_DESKMENU_TEMPLATE = SELECT X.GNUM_DESK_ID AS deskId, X.GNUM_DESK_MENU_ID AS deskMenuId, X.HGNUM_TEMPLATE_ID AS templateId, X.HGNUM_ISDEFAULT AS isDefault, DECODE(X.HGNUM_ISDEFAULT,0,'False',1,'True') AS isDefaultName, X.HGNUM_DISPLAY_ORDER AS displayOrder, (SELECT INITCAP(A.GSTR_DESK_MENU_NAME) FROM GBLT_DESK_MENU_MST A WHERE A.GNUM_DESK_MENU_ID\=X.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?) AS deskMenuName, (SELECT INITCAP(B.HGSTR_TEMPLATE_NAME) FROM HGBT_TEMPLATE_MST B WHERE B.HGNUM_TEMPLATE_ID\=X.HGNUM_TEMPLATE_ID AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=?) as templateName FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.HGNUM_DEPTUNITCODE\=? AND X.GNUM_USERSEAT_ID IS NULL AND X.HIPNUM_WARD_CODE\=? ORDER BY deskmenuname, X.HGNUM_DISPLAY_ORDER

DELETE_BY_DESK_UNIT_N_WARD_GBLT_USER_DESKMENU_TEMPLATE = UPDATE GBLT_USER_DESKMENU_TEMPLATE SET GNUM_ISVALID=? WHERE GNUM_DESK_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE=? AND HIPNUM_WARD_CODE=? AND GNUM_USERSEAT_ID IS NULL


SELECT_MENU_TEMPLATE_BY_DESKUNIT_N_WARD_N_SEAT.GBLT_USER_DESKMENU_TEMPLATE = SELECT X.GNUM_DESK_ID AS deskId, X.GNUM_DESK_MENU_ID AS deskMenuId, X.HGNUM_TEMPLATE_ID AS templateId, X.HGNUM_ISDEFAULT AS isDefault, DECODE(X.HGNUM_ISDEFAULT,0,'False',1,'True') AS isDefaultName, X.HGNUM_DISPLAY_ORDER AS displayOrder, (SELECT INITCAP(A.GSTR_DESK_MENU_NAME) FROM GBLT_DESK_MENU_MST A WHERE A.GNUM_DESK_MENU_ID\=X.GNUM_DESK_MENU_ID AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=?) AS deskMenuName, (SELECT INITCAP(B.HGSTR_TEMPLATE_NAME) FROM HGBT_TEMPLATE_MST B WHERE B.HGNUM_TEMPLATE_ID\=X.HGNUM_TEMPLATE_ID AND B.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=?) as templateName FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.HGNUM_DEPTUNITCODE\=? AND X.HIPNUM_WARD_CODE\=? AND X.GNUM_USERSEAT_ID\=? ORDER BY deskmenuname, X.HGNUM_DISPLAY_ORDER
																

DELETE_BY_DESK_UNIT_N_WARD_N_SEAT_GBLT_USER_DESKMENU_TEMPLATE = UPDATE GBLT_USER_DESKMENU_TEMPLATE SET GNUM_ISVALID=? WHERE GNUM_DESK_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE=? AND HIPNUM_WARD_CODE=? AND GNUM_USERSEAT_ID=?


INSERT.GBLT_DESK_MENU_MST = insert into GBLT_DESK_MENU_MST(GNUM_DESK_MENU_ID,GSTR_DESK_MENU_NAME,GSTR_DESK_URL,GNUM_SEAT_ID,GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_ISTEMPLATE,GNUM_DESK_TYPE,GNUM_HOSPITAL_CODE,HGNUM_TEMPLATE_CATEGORY,GNUM_USABILITY_FLAG) \
 							values((SELECT NVL(MAX(GNUM_DESK_MENU_ID),0)+1 FROM GBLT_DESK_MENU_MST),initcap(?),upper(?),?,sysdate,?,?,?,?,?,?)

SELECT.FULL_INFO.GBLT_DESK_MENU_MST = select GSTR_DESK_MENU_NAME,GSTR_DESK_URL ,GNUM_ISTEMPLATE,GNUM_DESK_TYPE,HGNUM_TEMPLATE_CATEGORY,GNUM_USABILITY_FLAG from GBLT_DESK_MENU_MST where GNUM_DESK_MENU_ID\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?
									 
UPDATE.GBLT_DESK_MENU_MST = update GBLT_DESK_MENU_MST set GSTR_DESK_MENU_NAME\=initcap(?),GSTR_DESK_URL\=upper(?),GNUM_ISTEMPLATE\=?,GNUM_DESK_TYPE\=?, HGNUM_TEMPLATE_CATEGORY\=?,GNUM_USABILITY_FLAG\=? where GNUM_DESK_MENU_ID\=? and  GNUM_HOSPITAL_CODE\=?
 							
SELECT.DUPLICATE_CHECK.GBLT_DESK_MENU_MST = select count(*) from GBLT_DESK_MENU_MST where trim(upper(GSTR_DESK_MENU_NAME))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?
											
SELECT.DUPLICATE_DESKNAME.GBLT_DESK_MST = select count(*) from GBLT_DESK_MST where trim(upper(GSTR_DESK_NAME))\=trim(upper(?)) and GNUM_ISVALID IN (?,?) and GNUM_HOSPITAL_CODE\=?\tand GNUM_DESK_TYPE\=? AND GNUM_DESK_ID <> ?\t\t\t\t\t\t\t\t\t
											
											
SELECT.MODIFY_DUPLICATE_CHECK.GBLT_DESK_MENU_MST = select count(*) from GBLT_DESK_MENU_MST where trim(upper(GSTR_DESK_MENU_NAME))=trim(upper(?)) AND gnum_isvalid !=? AND gnum_hospital_code =? and GNUM_DESK_MENU_ID!=? 

INSERT.HGBT_DRUG_DOSE_MST = insert into HGBT_DRUG_DOSE_MST (HGNUM_DOSE_ID,GNUM_HOSPITAL_CODE,HGNUM_SLNO,HGSTR_DOSE_NAME,HGSTR_DOSE_INSTRUCTIONS, HSTNUM_ITEMTYPE_ID,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HGNUM_ISFREQUENCY_BOUND,HGNUM_DOSE_QTY) values((SELECT NVL(MAX(HGNUM_DOSE_ID),10)+1 FROM HGBT_DRUG_DOSE_MST WHERE GNUM_HOSPITAL_CODE \=?),?,?,?,?,?,?,?,sysdate,?,?)

SELECT.FULL_INFO.HSTT_ITEMTYPE_MST = SELECT (SELECT hststr_itemtype_name FROM hstt_itemtype_mst WHERE hstnum_itemtype_id \= (SELECT hstnum_itemtype_id FROM hgbt_drug_dose_mst WHERE hgnum_dose_id \= ? AND gnum_hospital_code \= ? AND gnum_isvalid \= ?)) as itemType, hgstr_dose_name as doseName , hgstr_dose_instructions as doseInstruction ,a.HSTNUM_ITEMTYPE_ID as itemTypeId , HGNUM_DOSE_ID as doseId ,HGNUM_ISFREQUENCY_BOUND as isFrequencyBound , HGNUM_DOSE_QTY as doseQty FROM hgbt_drug_dose_mst a WHERE a.hstnum_itemtype_id \= (SELECT hstnum_itemtype_id FROM hgbt_drug_dose_mst WHERE hgnum_dose_id \= ? AND gnum_hospital_code \= ? AND gnum_isvalid \= ?) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? and a.HGNUM_DOSE_ID\=?
   
SELECT.HGBT_DRUG_DOSE_MST= SELECT  HGNUM_DOSE_ID AS doseId, GNUM_HOSPITAL_CODE AS hospitalCode, HGNUM_SLNO AS sereialNo, HGSTR_DOSE_NAME AS doseName , HGSTR_DOSE_INSTRUCTIONS AS doseInstruction ,HSTNUM_ITEMTYPE_ID AS itemTypeId , GNUM_ISVALID AS isValid, HGNUM_ISFREQUENCY_BOUND AS isFrequencyBound , HGNUM_DOSE_QTY AS doseQty,NVL(pkg_opd_func.get_itemType_name('1',HSTNUM_ITEMTYPE_ID\:\:character varying,null,null),'-') as itemTypeName FROM HGBT_DRUG_DOSE_MST WHERE HGNUM_DOSE_ID\=? AND HGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE \= ? 
   
UPDATE.HGBT_DRUG_DOSE_MST = update HGBT_DRUG_DOSE_MST  set GNUM_ISVALID=?  where   HGNUM_DOSE_ID=?  and GNUM_HOSPITAL_CODE=? and HGNUM_SLNO=?
							

INSERT_MODIFY.HGBT_DRUG_DOSE_MST = insert into HGBT_DRUG_DOSE_MST (HGNUM_DOSE_ID,HSTNUM_ITEMTYPE_ID, HGSTR_DOSE_NAME, HGSTR_DOSE_INSTRUCTIONS,HGNUM_ISFREQUENCY_BOUND, HGNUM_DOSE_QTY, GNUM_HOSPITAL_CODE,HGNUM_SLNO, GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE )  values(?,?,?,?,?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_DRUG_DOSE_MST WHERE GNUM_HOSPITAL_CODE \=? and HGNUM_DOSE_ID\=?),?,?,sysdate)
FETCH.FULL_INFO.HSTT_ITEMTYPE_MST  =  SELECT a.HSTSTR_ITEMTYPE_NAME FROM HSTT_ITEMTYPE_MST a where a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? and a.HSTNUM_ITEMTYPE_ID=?


SELECT.CHECK_DUPLICATE.HGBT_DRUG_DOSE_MST = SELECT COUNT (*) FROM hgbt_drug_dose_mst WHERE hstnum_itemtype_id \= ? AND TRIM (UPPER (hgstr_dose_name)) \= TRIM (UPPER (?)) AND gnum_isvalid \= ? AND gnum_hospital_code \= ?
   											
SELECT.CHECK_MOD_DUPLICATE.HGBT_DRUG_DOSE_MST = SELECT COUNT (*) FROM hgbt_drug_dose_mst WHERE hstnum_itemtype_id \= ? AND TRIM (UPPER (hgstr_dose_name)) \= TRIM (UPPER (?)) AND gnum_isvalid \!\= ? AND gnum_hospital_code \= ? and HGNUM_DOSE_ID\!\=?
 									
 									
//----------------------------------------QueryForTemplateMappingMaster------------------- 			
									  
SELECT.CATEGORY_NAME.HGBT_TEMPLATE_CATEGORY_MST	=	select HGNUM_TEMPLATE_CATEGORY_TYPE from HGBT_TEMPLATE_CATEGORY_MST where HGNUM_TEMPLATE_CATEGORY=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?  												  
 			
SELECT.DEPTUNIT.HGBT_UNIT_MST	=select HGNUM_DEPTUNITCODE, HGSTR_UNITNAME from HGBT_UNIT_MST a where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HGNUM_DEPTUNITCODE not in (select HGNUM_DEPTUNITCODE from HGBT_TEMPLATE_MAPPING_MST  where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HIPNUM_WARD_CODE is null AND HGNUM_DEPTUNITCODE IS NOT NULL) and a.HGNUM_DEPT_CODE\=? order by HGSTR_UNITNAME
									
SELECT.DEPT.GBLT_DEPARTMENT_MST	= select GNUM_DEPT_CODE, GSTR_DEPT_NAME  from GBLT_DEPARTMENT_MST where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and GNUM_DEPT_TYPE \= ? and GNUM_DEPT_CODE not in (select GNUM_DEPT_CODE from HGBT_TEMPLATE_MAPPING_MST where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?  AND hgnum_deptunitcode IS NULL AND hipnum_ward_code IS NULL) order by GSTR_DEPT_NAME 
									
SELECT.WARD.HIPT_WARD_MST	=SELECT DISTINCT a.hipnum_ward_code, hipstr_ward_name, b.hgnum_deptunitcode FROM hipt_ward_mst a, hipt_duwrbed_mst b WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipnum_ward_code NOT IN (SELECT hipnum_ward_code FROM hgbt_template_mapping_mst WHERE hgnum_template_category \= ?  AND gnum_isvalid \= ? AND gnum_hospital_code \= ?  AND hipnum_ward_code IS NOT NULL AND hgnum_deptunitcode \= ?)  AND a.hipnum_ward_code \= b.hipnum_ward_code AND b.gnum_dept_code \= ?  AND b.hgnum_deptunitcode \= ? AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_hospital_code \= a.gnum_hospital_code ORDER BY hipstr_ward_name

									
SELECT.TEMPLATE_NOT_ADDED.HGBT_TEMPLATE_MST	=	select HGNUM_TEMPLATE_ID||'%'||HGNUM_TEMPLATE_ID, HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_CATEGORY = ? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? order by HGSTR_TEMPLATE_NAME

SELECT.TEMPLATE_ADDED.HGBT_TEMPLATE_MST 	=select HGNUM_MAPPING_ID||'%'||a.HGNUM_TEMPLATE_ID, a.HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST a,HGBT_TEMPLATE_MAPPING_MST b where  a.GNUM_ISVALID\=? and b.GNUM_HOSPITAL_CODE\=? and a.HGNUM_TEMPLATE_ID\=b.HGNUM_TEMPLATE_ID and a.GNUM_ISVALID\=b.GNUM_ISVALID and a.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE and b.HGNUM_TEMPLATE_CATEGORY\=? AND b.GNUM_DEPT_CODE \=(select GNUM_DEPT_CODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? and gnum_isvalid\=? and gnum_hospital_code \= ?) AND exists (select  hgnum_deptunitcode from hgbt_template_mapping_mst where  hgnum_mapping_id\=? and gnum_isvalid\=? and gnum_hospital_code \= ?) order by HGSTR_TEMPLATE_NAME
												
INSERT.HGBT_TEMPLATE_MAPPING_MST	=Insert into HGBT_TEMPLATE_MAPPING_MST (HGNUM_MAPPING_ID, HGNUM_TEMPLATE_CATEGORY, GNUM_HOSPITAL_CODE, HGNUM_TEMPLATE_ID, HGNUM_ISDEFAULT, GNUM_ISVALID, GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE, GNUM_SEAT_ID, GDT_ENTRY_DATE, HIPNUM_WARD_CODE) values( (select NVL(max(HGNUM_MAPPING_ID),1000)+1 from HGBT_TEMPLATE_MAPPING_MST where gnum_hospital_code\=? and gnum_isvalid\=?),?,?,?,?,?,?,?,?,sysdate,?)
										
UPDATE.HGBT_TEMPLATE_MAPPING_MST	=	update HGBT_TEMPLATE_MAPPING_MST set GNUM_ISVALID=? where HGNUM_MAPPING_ID= ? and HGNUM_TEMPLATE_CATEGORY=? and GNUM_HOSPITAL_CODE=?

SELECT.HGBT_TEMPLATE_MAPPING_MST	=select hgnum_mapping_id||'%'||HGNUM_TEMPLATE_ID,(select HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_ID\=a.HGNUM_TEMPLATE_ID and gnum_isvalid\=?)HGSTR_TEMPLATE_NAME, HGNUM_ISDEFAULT,GNUM_DEPT_CODE||'@'|| (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_DEPT_CODE and gnum_isvalid\=?)GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE||'@'||(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_DEPTUNITCODE and gnum_isvalid\=?)HGNUM_DEPTUNITCODE, HIPNUM_WARD_CODE||'@'||(select HIPSTR_WARD_NAME  from HIPT_WARD_MST where HIPNUM_WARD_CODE\=a.HIPNUM_WARD_CODE and gnum_isvalid\=?)HIPNUM_WARD_CODE from HGBT_TEMPLATE_MAPPING_MST a where HGNUM_TEMPLATE_CATEGORY\=? and gnum_isvalid\=? and gnum_hospital_code \= ? AND a.GNUM_DEPT_CODE \=(select GNUM_DEPT_CODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) AND a.HGNUM_DEPTUNITCODE \=(select HGNUM_DEPTUNITCODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) AND a.HIPNUM_WARD_CODE \=(select HIPNUM_WARD_CODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) \t
										
SELECT.IF_WARD_IS_NULL.HGBT_TEMPLATE_MAPPING_MST	=select hgnum_mapping_id||'%'||HGNUM_TEMPLATE_ID,(select HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_ID\=a.HGNUM_TEMPLATE_ID and gnum_isvalid\=?)HGSTR_TEMPLATE_NAME, HGNUM_ISDEFAULT,GNUM_DEPT_CODE||'@'|| (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_DEPT_CODE and gnum_isvalid\=?)GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE||'@'||(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_DEPTUNITCODE and gnum_isvalid\=?)HGNUM_DEPTUNITCODE, HIPNUM_WARD_CODE||'@'||(select HIPSTR_WARD_NAME  from HIPT_WARD_MST where HIPNUM_WARD_CODE\=a.HIPNUM_WARD_CODE and gnum_isvalid\=?)HIPNUM_WARD_CODE from HGBT_TEMPLATE_MAPPING_MST a where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? AND a.GNUM_DEPT_CODE \=(select GNUM_DEPT_CODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) AND a.HGNUM_DEPTUNITCODE \=(select HGNUM_DEPTUNITCODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) AND a.HIPNUM_WARD_CODE is null \t
										
SELECT.IF_UNIT_IS_NULL.HGBT_TEMPLATE_MAPPING_MST	=select hgnum_mapping_id||'%'||HGNUM_TEMPLATE_ID,(select HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST where HGNUM_TEMPLATE_ID\=a.HGNUM_TEMPLATE_ID and gnum_isvalid\=?)HGSTR_TEMPLATE_NAME, HGNUM_ISDEFAULT,GNUM_DEPT_CODE||'@'|| (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_DEPT_CODE and gnum_isvalid\=?)GNUM_DEPT_CODE, HGNUM_DEPTUNITCODE||'@'||(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_DEPTUNITCODE and gnum_isvalid\=?)HGNUM_DEPTUNITCODE, HIPNUM_WARD_CODE||'@'||(select HIPSTR_WARD_NAME  from HIPT_WARD_MST where HIPNUM_WARD_CODE\=a.HIPNUM_WARD_CODE and gnum_isvalid\=?)HIPNUM_WARD_CODE from HGBT_TEMPLATE_MAPPING_MST a where HGNUM_TEMPLATE_CATEGORY\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=? AND a.GNUM_DEPT_CODE \=(select GNUM_DEPT_CODE from hgbt_template_mapping_mst where  hgnum_mapping_id\=? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) AND a.HGNUM_DEPTUNITCODE is null AND a.HIPNUM_WARD_CODE is null \t
										
CHECK.BEFORE_MODIFY.HGBT_TEMPLATE_MAPPING_MST	=	SELECT  HGNUM_DEPTUNITCODE, HIPNUM_WARD_CODE from hgbt_template_mapping_mst WHERE gnum_isvalid = ? AND gnum_hospital_code = ? AND hgnum_template_category = ? and HGNUM_MAPPING_ID=?

SELECT.DEPTUNIT.BY_DEPT_CODE.HGBT_UNIT_MST	=select HGNUM_DEPTUNITCODE, HGSTR_UNITNAME from HGBT_UNIT_MST a where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and\tGNUM_DEPT_CODE\=? order by HGSTR_UNITNAME\t
						
SELECT.GBLT_DESK_MENU_MST = select GNUM_DESK_MENU_ID,GSTR_DESK_MENU_NAME  from GBLT_DESK_MENU_MST where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?	order By GSTR_DESK_MENU_NAME	

INSERT.GBLT_DESKTYPE_MENU_MAPPING = insert into  GBLT_DESKTYPE_MENU_MAPPING(GNUM_DESK_MENU_ID,GNUM_HOSPITAL_CODE,GNUM_SLNO,GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_DESK_TYPE) values(?,?,(select NVL(max(GNUM_SLNO),0)+1 from GBLT_DESKTYPE_MENU_MAPPING where gnum_hospital_code\=? and GNUM_DESK_TYPE\=? and GNUM_DESK_MENU_ID\=?),?,sysdate,?,?)


SELECT.SELECTEDMENULST.GBLT_DESKTYPE_MENU_MAPPING = SELECT gnum_desk_menu_id, gstr_desk_menu_name FROM gblt_desk_menu_mst WHERE gnum_desk_menu_id IN (SELECT gnum_desk_menu_id FROM gblt_desktype_menu_mapping WHERE gnum_desk_type \= ? AND gnum_hospital_code \= ? and GNUM_ISVALID\=?) and  GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? order by GSTR_DESK_MENU_NAME\t
													 
SELECT.REMANINGMENULST.GBLT_DESKTYPE_MENU_MAPPING = SELECT gnum_desk_menu_id, gstr_desk_menu_name FROM gblt_desk_menu_mst WHERE gnum_desk_menu_id NOT IN (SELECT gnum_desk_menu_id FROM gblt_desktype_menu_mapping WHERE gnum_desk_type \= ? AND gnum_hospital_code \= ? and GNUM_ISVALID\=?) and  GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? order by GSTR_DESK_MENU_NAME\t
	
UPDATE.GBLT_DESKTYPE_MENU_MAPPING = update GBLT_DESKTYPE_MENU_MAPPING set GNUM_ISVALID=? where GNUM_DESK_TYPE=? and GNUM_HOSPITAL_CODE=?													 													 																																			 									  	 																 												  	

												and	HGNUM_DEPT_CODE=? AND TRUNC (SYSDATE) BETWEEN TRUNC (gdt_effective_frm) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) order by HGSTR_UNITNAME
												
SELECT.HGBT_MACRO_PROCESS_MST =  SELECT HGSTR_PROCESS_DESC  as processname,HGNUM_MACRO_LENGTH FROM HGBT_MACRO_PROCESS_MST a WHERE a.GNUM_ISVALID=? and a.HGNUM_PROCESS_ID=?

INSERT.HGBT_MACRO_MST = INSERT INTO HGBT_MACRO_MST  (HGNUM_MACRO_ID,HGNUM_PROCESS_ID,HGSTR_MACRO_HEADER,HGSTR_MACRO_DESC, HGNUM_SLNO,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GDT_ENTRY_DATE ) VALUES ((SELECT NVL(MAX(HGNUM_MACRO_ID),1000)+1 FROM HGBT_MACRO_MST WHERE GNUM_HOSPITAL_CODE\=? ),?,initcap(?),?,?,?,?,?,SYSDATE)
						
SELECT.HGBT_MACRO_MST = SELECT a.HGSTR_MACRO_HEADER,a.HGSTR_MACRO_DESC,HGNUM_PROCESS_ID FROM HGBT_MACRO_MST a WHERE a.HGNUM_MACRO_ID=? AND a.HGNUM_SLNO=? AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=?

UPDATE.HGBT_MACRO_MST = UPDATE HGBT_MACRO_MST SET GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=TRUNC(SYSDATE), GNUM_ISVALID\=? WHERE HGNUM_MACRO_ID\=? AND GNUM_HOSPITAL_CODE\=?  and HGNUM_SLNO\=?
										
MODIFYINSERT.HGBT_MACRO_MST = INSERT INTO HGBT_MACRO_MST  (HGNUM_MACRO_ID,HGNUM_PROCESS_ID,HGSTR_MACRO_HEADER,HGSTR_MACRO_DESC, HGNUM_SLNO,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GDT_ENTRY_DATE ) VALUES (?,?,initcap(?),?,(SELECT NVL(MAX(HGNUM_SLNO),1)+1 FROM HGBT_MACRO_MST WHERE GNUM_HOSPITAL_CODE\=? ),?,?,?,SYSDATE)
						
CHECKDUPLICATEBEFOREINSERT.HGBT_MACRO_MST =    SELECT a.HGSTR_MACRO_HEADER FROM HGBT_MACRO_MST a  WHERE INITCAP(a.HGSTR_MACRO_HEADER)=INITCAP(?)  AND a.GNUM_ISVALID !=? AND a.GNUM_HOSPITAL_CODE=? and a.HGNUM_PROCESS_ID=?


SELECT.HGBT_DRUG_ROUTE_MST_old =  SELECT a.HSTSTR_ITEMTYPE_NAME FROM HSTT_ITEMTYPE_MST a where a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? and a.HSTNUM_ITEMTYPE_ID=?

# Modified By : Chetan Sharma 
# Reason : 		For SCM Integration Implementation
# Date :   		16-12-2015
SELECT.HGBT_DRUG_ROUTE_MST =  select NVL(pkg_opd_func.get_itemType_name('1',?::character varying,null,null),'-') from  dual


INSERT.HGBT_DRUG_ROUTE_MST = INSERT INTO HGBT_DRUG_ROUTE_MST (HGNUM_DRUG_ROUTE_ID,HSTNUM_ITEMTYPE_ID,HGSTR_DRUG_ROUTE_NAME,HGSTR_DRUG_ROUTE_DESC,HGNUM_SLNO,HGNUM_ROUTE_CLASSIFICATION,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GDT_ENTRY_DATE ) VALUES ((SELECT NVL(MAX(HGNUM_DRUG_ROUTE_ID),10)+1 FROM HGBT_DRUG_ROUTE_MST WHERE GNUM_HOSPITAL_CODE=? ),?,INITCAP(?),?,?,?,?,?,?,SYSDATE)

CHECKDUPLICATEBEFOREINSERT.HGBT_DRUG_ROUTE_MST = SELECT a.HGSTR_DRUG_ROUTE_NAME  FROM HGBT_DRUG_ROUTE_MST  a  WHERE INITCAP (a.HGSTR_DRUG_ROUTE_NAME) = INITCAP (?) AND a.gnum_isvalid != ? AND a.gnum_hospital_code = ? and a.HSTNUM_ITEMTYPE_ID=?

CHECKDUPLICATEFORMODIFY.HGBT_DRUG_ROUTE_MST =SELECT a.HGSTR_DRUG_ROUTE_NAME  FROM HGBT_DRUG_ROUTE_MST  a  WHERE INITCAP (a.HGSTR_DRUG_ROUTE_NAME) = INITCAP(?) AND a.gnum_isvalid !=?  AND a.gnum_hospital_code =?  and a.HSTNUM_ITEMTYPE_ID=? and A.HGNUM_DRUG_ROUTE_ID !=?  and A.HGNUM_SLNO !=?

FETCH.HGBT_DRUG_ROUTE_MST = SELECT a.HGSTR_DRUG_ROUTE_NAME, a.HGSTR_DRUG_ROUTE_DESC, a.HSTNUM_ITEMTYPE_ID,HGNUM_ROUTE_CLASSIFICATION FROM HGBT_DRUG_ROUTE_MST a WHERE a.HGNUM_DRUG_ROUTE_ID = ? AND a.hgnum_slno = ?  AND a.gnum_hospital_code = ?  AND a.gnum_isvalid = ?

## Added By Chetan 
## Date 07_12_2015
GET.HGBT_DRUG_ROUTE_MST = SELECT a.HGSTR_DRUG_ROUTE_NAME, a.HSTNUM_ITEMTYPE_ID,HGNUM_ROUTE_CLASSIFICATION,a.hgnum_drug_route_id FROM HGBT_DRUG_ROUTE_MST a WHERE a.gnum_hospital_code = ?  AND a.gnum_isvalid = ?


UPDATE.HGBT_DRUG_ROUTE_MST =    UPDATE HGBT_DRUG_ROUTE_MST   SET  gnum_isvalid = ? WHERE HGNUM_DRUG_ROUTE_ID = ? AND gnum_hospital_code = ? AND hgnum_slno = ? 						 																 																																	 									  	 																 												  	

MODIFYINSERT.HGBT_DRUG_ROUTE_MST = INSERT INTO HGBT_DRUG_ROUTE_MST (HGNUM_DRUG_ROUTE_ID,HSTNUM_ITEMTYPE_ID, HGSTR_DRUG_ROUTE_NAME, HGSTR_DRUG_ROUTE_DESC,HGNUM_ROUTE_CLASSIFICATION, hgnum_slno, gnum_isvalid, gnum_seat_id, gnum_hospital_code, gdt_entry_date ) VALUES (?, ?, INITCAP (?), ?,?, (SELECT NVL (MAX (hgnum_slno), 1) + 1 FROM HGBT_DRUG_ROUTE_MST WHERE gnum_hospital_code \= ?), ?, ?, ?, SYSDATE) 


DESK_TYPE.GBLT_DESK_TYPE_MST = SELECT a.GNUM_DESK_TYPE,a.GSTR_DESK_TYPE_DESC FROM GBLT_DESK_TYPE_MST A WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_PROFILE_BOUND=?            

DESK_NAME.GBLT_DESK_MST = SELECT a.GNUM_DESK_ID,a.GSTR_DESK_NAME FROM GBLT_DESK_MST A WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_DESK_TYPE=?

MENU_NAME.GBLT_DESK_DTL = SELECT a.GNUM_DESK_MENU_ID,b.GSTR_DESK_MENU_NAME FROM GBLT_DESK_DTL a,GBLT_DESK_MENU_MST b WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_DESK_ID=? AND a.GNUM_DESK_MENU_ID=b.GNUM_DESK_MENU_ID AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID=b.GNUM_ISVALID AND b.GNUM_USABILITY_FLAG=? 

NON_DEFAULT_MENU_NAME.GBLT_DESK_DTL = SELECT a.GNUM_DESK_MENU_ID, b.GSTR_DESK_MENU_NAME FROM GBLT_DESK_DTL a,GBLT_DESK_MENU_MST b WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_DESK_ID=? AND a.GNUM_DESK_MENU_ID=b.GNUM_DESK_MENU_ID AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID=b.GNUM_ISVALID AND b.GNUM_USABILITY_FLAG=? AND (a.GNUM_ISDEFAULT_PROFILE=? ) order by a.GNUM_PROFILE_ORDER

UPDATE.PROFILE_DETAILS.GBLT_DESK_DTL = UPDATE GBLT_DESK_DTL SET GNUM_PROFILE_ORDER\=?,GNUM_ISDEFAULT_PROFILE\=? WHERE gnum_hospital_code \= ? and GNUM_DESK_ID\=? and GNUM_DESK_MENU_ID\=? and GNUM_ISVALID\=?
            
DEFAULT_VALUE.GBLT_DESK_DTL = SELECT a.GNUM_ISDEFAULT_PROFILE FROM GBLT_DESK_DTL a,GBLT_DESK_MENU_MST b WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_DESK_ID=? AND a.GNUM_DESK_MENU_ID=b.GNUM_DESK_MENU_ID AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID=b.GNUM_ISVALID AND b.GNUM_USABILITY_FLAG=? and a.GNUM_ISDEFAULT_PROFILE is null 

DEFAULT_MENU_NAME.GBLT_DESK_DTL = SELECT a.GNUM_DESK_MENU_ID,b.GSTR_DESK_MENU_NAME FROM GBLT_DESK_DTL a,GBLT_DESK_MENU_MST b WHERE a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_DESK_ID=? AND a.GNUM_DESK_MENU_ID=b.GNUM_DESK_MENU_ID AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID=b.GNUM_ISVALID AND b.GNUM_USABILITY_FLAG=? AND (a.GNUM_ISDEFAULT_PROFILE=? or a.GNUM_ISDEFAULT_PROFILE is null) order by a.GNUM_PROFILE_ORDER


 
SELECT_SENSITIVITY_DESC.HGBT_ALLERGY_SENSITIVITY_MST = SELECT initcap(a.HGSTR_SENSITIVITY_DESC) FROM HGBT_ALLERGY_SENSITIVITY_MST a where a.GNUM_ISVALID=? and a.GNUM_HOSPITAL_CODE=? and a.HGNUM_SENSITIVITY_CODE=?

INSERT.HOPT_IMAGEDESC_MST = INSERT INTO HOPT_IMAGEDESC_MST (HOPNUM_IMAGEDESC_ID, HOPNUM_SLNO, HOPSTR_IMAGE_DESC, HOPSTR_COLOR, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_ISVALID,GNUM_HOSPITAL_CODE,HOPNUM_IS_DEFAULT )VALUES((SELECT NVL(MAX(HOPNUM_IMAGEDESC_ID),1000)+1 FROM HOPT_IMAGEDESC_MST WHERE GNUM_HOSPITAL_CODE \= ?), ?,trim(Initcap(?)),?,?,SYSDATE,?,?,?)

SELECT.HOPT_IMAGEDESC_MST = SELECT a.HOPSTR_IMAGE_DESC imageDesc,a.HOPNUM_IS_DEFAULT isDefault,a.HOPSTR_COLOR color,a.GNUM_ISVALID isValid FROM HOPT_IMAGEDESC_MST a WHERE a.HOPNUM_IMAGEDESC_ID=? AND a.HOPNUM_SLNO=?  AND a.GNUM_HOSPITAL_CODE=?

CHECK_DUPLICATE_NAME.HOPT_IMAGEDESC_MST = SELECT COUNT(*) FROM HOPT_IMAGEDESC_MST  a WHERE initcap(a.HOPSTR_IMAGE_DESC)= initcap(?)  AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID!=?

UPDATE.HOPT_IMAGEDESC_MST = UPDATE HOPT_IMAGEDESC_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HOPNUM_IMAGEDESC_ID=? AND HOPNUM_SLNO=? AND GNUM_HOSPITAL_CODE=?

MODIFYINSERT.HOPT_IMAGEDESC_MST = INSERT INTO HOPT_IMAGEDESC_MST (HOPNUM_IMAGEDESC_ID, HOPNUM_SLNO, HOPSTR_IMAGE_DESC, HOPSTR_COLOR, GNUM_SEAT_ID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GNUM_ISVALID,HOPNUM_IS_DEFAULT) VALUES(?, (SELECT MAX(HOPNUM_SLNO)+1 FROM HOPT_IMAGEDESC_MST WHERE HOPNUM_IMAGEDESC_ID\=? AND GNUM_HOSPITAL_CODE \=?),trim(Initcap(?)),?,?,SYSDATE,?,?,?)
								
CHECK_DUPLICATE_NAMEFORMODIFY.HOPT_IMAGEDESC_MST = 	SELECT COUNT(*) FROM HOPT_IMAGEDESC_MST WHERE INITCAP(HOPSTR_IMAGE_DESC)=INITCAP(?) AND GNUM_ISVALID != ? AND HOPNUM_IMAGEDESC_ID <> ? AND  GNUM_HOSPITAL_CODE = ?

SELECT.IMAGES_OF_DEPTUNIT.HOPT_IMAGE_MST = SELECT A.HOPNUM_IMAGE_CODE AS imageCode, INITCAP(A.HOPSTR_IMAGE_NAME) AS imageName, A.HOPSTR_FILE_NAME AS fileName FROM HOPT_IMAGE_MST A, HOPT_UNIT_IMAGE_MST B WHERE A.HOPNUM_IMAGE_CODE\=B.HOPNUM_IMAGE_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.HGNUM_DEPTUNITCODE\=? AND A.GNUM_HOSPITAL_CODE\=? AND B.GNUM_ISVALID\=? AND A.GNUM_ISVALID\=?

SELECT.DEFAULT_IMAGES.HOPT_IMAGE_MST = SELECT HOPNUM_IMAGE_CODE AS imageCode, INITCAP(HOPSTR_IMAGE_NAME) AS imageName, HOPSTR_FILE_NAME AS fileName FROM HOPT_IMAGE_MST WHERE HOPNUM_IS_DEFAULT\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

SELECT.COLOR_DESCS_OF_UNIT.HOPT_UNIT_IMAGEDESC_MST	=SELECT A.HOPNUM_IMAGEDESC_ID AS imageDescId, INITCAP(A.HOPSTR_IMAGE_DESC) AS imageDesc, A.HOPSTR_COLOR AS color FROM HOPT_IMAGEDESC_MST A, HOPT_UNIT_IMAGEDESC_MST B WHERE A.HOPNUM_IMAGEDESC_ID\=B.HOPNUM_IMAGEDESC_ID AND A.GNUM_HOSPITAL_CODE\=? AND B.HGNUM_DEPTUNITCODE\=? AND B.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=?\t\t\t\t\t\t\t\t

SELECT.DEFAULT_IMAGEDESCS.HOPT_IMAGEDESC_MST = SELECT HOPNUM_IMAGEDESC_ID AS imageDescId, INITCAP(HOPSTR_IMAGE_DESC) AS imageDesc, HOPSTR_COLOR AS color FROM HOPT_IMAGEDESC_MST WHERE HOPNUM_IS_DEFAULT\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?

SELECTPARANAME.HGBT_PARA_RANGE_MST =  SELECT a.HGSTR_PARA_NAME FROM HGBT_PARAMETER_MST a where a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? and a.HGNUM_PARA_ID=?


INSERT.HGBT_PARA_RANGE_MST = INSERT INTO HGBT_PARA_RANGE_MST (HGNUM_PARA_RANGE_ID,HGNUM_PARA_ID,GNUM_GENDER_CODE,HGNUM_LOW_AGE,HGNUM_HIGH_AGE,HGSTR_LOW_VALUE,HGSTR_HIGH_VALUE,HGSTR_VALUE_UOM,GNUM_ISVALID,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GDT_ENTRY_DATE ) VALUES ((SELECT NVL(MAX(HGNUM_PARA_RANGE_ID),10)+1 FROM HGBT_PARA_RANGE_MST WHERE GNUM_HOSPITAL_CODE=? AND HGNUM_PARA_ID=?),?,?,?,?,?,?,?,?,?,?,SYSDATE)



FETCH.HGBT_PARA_RANGE_MST = SELECT a.GNUM_GENDER_CODE as genderCode, a.HGNUM_LOW_AGE as lowAge,HGNUM_HIGH_AGE as highAge,HGSTR_LOW_VALUE as lowValue, HGSTR_HIGH_VALUE as highValue,GNUM_ISVALID as isValid,HGSTR_VALUE_UOM as unitOfMeasure FROM HGBT_PARA_RANGE_MST a WHERE a.HGNUM_PARA_ID = ? AND a.HGNUM_PARA_RANGE_ID = ?  AND a.GNUM_HOSPITAL_CODE = ?  

UPDATE.HGBT_PARA_RANGE_MST	=UPDATE HGBT_PARA_RANGE_MST   SET  gnum_isvalid \= ? WHERE HGNUM_PARA_ID \= ? and HGNUM_PARA_RANGE_ID\=? AND gnum_hospital_code \= ? \t\t\t\t\t\t\t\t\t

MODIFYINSERT.HGBT_PARA_RANGE_MST = INSERT INTO HGBT_DRUG_ROUTE_MST (HGNUM_DRUG_ROUTE_ID,HSTNUM_ITEMTYPE_ID, HGSTR_DRUG_ROUTE_NAME, HGSTR_DRUG_ROUTE_DESC,HGNUM_ROUTE_CLASSIFICATION, hgnum_slno, gnum_isvalid, gnum_seat_id, gnum_hospital_code, gdt_entry_date ) VALUES (?, ?, INITCAP (?), ?,?, (SELECT NVL (MAX (hgnum_slno), 1) + 1 FROM HGBT_DRUG_ROUTE_MST WHERE gnum_hospital_code \= ?), ?, ?, ?, SYSDATE) 

CHECKLOWAGELIMIT.HGBT_PARA_RANGE_MST = SELECT HGNUM_HIGH_AGE from HGBT_PARA_RANGE_MST where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=?

SELECT.CHECK_RANGE.HGBT_PARA_RANGE_MST =  select count(*) from 	HGBT_PARA_RANGE_MST where not((HGNUM_LOW_AGE>? and HGNUM_LOW_AGE>?) OR (HGNUM_HIGH_AGE<? and HGNUM_HIGH_AGE<?)) and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? and HGNUM_PARA_ID=? and GNUM_GENDER_CODE=? AND HGNUM_PARA_RANGE_ID<>?


SELECT.DUPLICATERECORD.HGBT_PARA_RANGE_MST = SELECT COUNT (*)  FROM HGBT_PARA_RANGE_MST  WHERE GNUM_GENDER_CODE = ? AND HGNUM_PARA_ID = ? AND gnum_hospital_code = ? AND gnum_isvalid = ? AND HGNUM_PARA_RANGE_ID<>?

ESSENTIAL.ALL_CLINICAL_UNIT_NOT_ADDED.GBLT_USER_DESKMENU_TEMPLATE = SELECT A.HGNUM_DEPTUNITCODE ||'@'||A.HGNUM_ISGENERAL,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.GNUM_DEPT_CODE\=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=1 AND B.GNUM_DEPT_TYPE\= ? AND A.HGNUM_DEPTUNITCODE NOT IN (SELECT DISTINCT X.HGNUM_DEPTUNITCODE FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? AND X.HGNUM_DEPTUNITCODE IS NOT NULL AND X.HIPNUM_WARD_CODE IS NULL AND X.GNUM_USERSEAT_ID IS NULL) ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')'

ESSENTIAL.ALL_SEATS_NOT_ADDED_UNITSEATWISE.GBLT_USER_DESKMENU_TEMPLATE = SELECT GNUM_SEATID||'@'||GNUM_GROUP_CODE, INITCAP(GSTR_SEAT_NAME) FROM GBLT_SEAT_MST WHERE TRUNC(GDT_EFFECT_DATE)<\=TRUNC(SYSDATE) AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND GNUM_SEATID NOT IN (SELECT DISTINCT X.GNUM_USERSEAT_ID FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? AND X.HGNUM_DEPTUNITCODE IS NOT NULL AND X.HGNUM_DEPTUNITCODE IN (\#) AND X.HIPNUM_WARD_CODE IS NULL AND X.GNUM_USERSEAT_ID IS NOT NULL) ORDER BY INITCAP(GSTR_SEAT_NAME)

ESSENTIAL.ALL_USERS_NOT_ADDED_UNITUSERWISE.GBLT_USER_DESKMENU_TEMPLATE = SELECT A.GNUM_USERID||'@'||B.GNUM_GROUP_CODE, INITCAP(A.GSTR_USER_NAME) FROM GBLT_USER_MST A, GBLT_SEAT_MST B WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND A.GNUM_USER_SEATID\=B.GNUM_SEATID AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=B.GNUM_ISVALID AND A.GNUM_USERID NOT IN (SELECT DISTINCT X.GNUM_USERSEAT_ID FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? AND X.HGNUM_DEPTUNITCODE IS NOT NULL AND X.HGNUM_DEPTUNITCODE IN (\#) AND X.HIPNUM_WARD_CODE IS NULL AND X.GNUM_USERSEAT_ID IS NOT NULL) ORDER BY INITCAP(A.GSTR_USER_NAME)

ESSENTIAL.ALL_SEATS_NOT_ADDED_UNITWARDSEATWISE.GBLT_USER_DESKMENU_TEMPLATE = SELECT GNUM_SEATID||'@'||GNUM_GROUP_CODE, INITCAP(GSTR_SEAT_NAME) FROM GBLT_SEAT_MST WHERE TRUNC(GDT_EFFECT_DATE)<\=TRUNC(SYSDATE) AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND GNUM_SEATID NOT IN (SELECT DISTINCT X.GNUM_USERSEAT_ID FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? AND X.HGNUM_DEPTUNITCODE IS NOT NULL AND X.HGNUM_DEPTUNITCODE IN (\#) AND X.HIPNUM_WARD_CODE IS NOT NULL AND X.HIPNUM_WARD_CODE IN (%) AND X.GNUM_USERSEAT_ID IS NOT NULL) ORDER BY INITCAP(GSTR_SEAT_NAME)

ESSENTIAL.ALL_USERS_NOT_ADDED_UNITWARDUSERWISE.GBLT_USER_DESKMENU_TEMPLATE = SELECT A.GNUM_USERID||'@'||B.GNUM_GROUP_CODE, INITCAP(A.GSTR_USER_NAME) FROM GBLT_USER_MST A, GBLT_SEAT_MST B WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND A.GNUM_USER_SEATID\=B.GNUM_SEATID AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=B.GNUM_ISVALID AND A.GNUM_USERID NOT IN (SELECT DISTINCT X.GNUM_USERSEAT_ID FROM GBLT_USER_DESKMENU_TEMPLATE X WHERE X.GNUM_DESK_ID\=? AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? AND X.HGNUM_DEPTUNITCODE IS NOT NULL AND X.HGNUM_DEPTUNITCODE IN (\#) AND X.HIPNUM_WARD_CODE IS NOT NULL AND X.HIPNUM_WARD_CODE IN (%) AND X.GNUM_USERSEAT_ID IS NOT NULL) ORDER BY INITCAP(A.GSTR_USER_NAME)

INSERT.HPMRT_PROFILE_RESTRICTED_CAT =    INSERT INTO HPMRT_PROFILE_RESTRICTED_CAT(GNUM_PATIENT_CAT_CODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) \
	   										VALUES(?,?,?,1,?,?,sysdate)
	   										
DUPLICATE_CHECK_BEFORE_SAVE.HPMRT_PROFILE_RESTRICTED_CAT =Select GNUM_PATIENT_CAT_CODE from HPMRT_PROFILE_RESTRICTED_CAT where GNUM_PATIENT_CAT_CODE=?  and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? and HPMRNUM_PROFILE_TYPE=?

SELECT.HPMRT_PROFILE_RESTRICTED_CAT= SELECT GNUM_PATIENT_CAT_CODE patientCategoryCode,HPMRNUM_SLNO serialNo,HPMRNUM_PROFILE_TYPE profileType,gnum_hospital_code hospitalCode,gnum_isvalid isActive, gnum_seat_id seatId, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate FROM HPMRT_PROFILE_RESTRICTED_CAT a where GNUM_PATIENT_CAT_CODE\=? and HPMRNUM_PROFILE_TYPE\=? and GNUM_HOSPITAL_CODE\=?  and HPMRNUM_SLNO\=(SELECT MAX(HPMRNUM_SLNO) FROM HPMRT_PROFILE_RESTRICTED_CAT WHERE GNUM_PATIENT_CAT_CODE\= a.GNUM_PATIENT_CAT_CODE AND HPMRNUM_PROFILE_TYPE\=a.HPMRNUM_PROFILE_TYPE AND gnum_hospital_code \= a.gnum_hospital_code\t)
		      							  
SELECT.BY_PROFILE_TYPE.HPMRT_PROFILE_RESTRICTED_CAT = SELECT a.gnum_patient_cat_code,GSTR_PATIENT_CAT_NAME FROM hpmrt_profile_restricted_cat a, gblt_patient_cat_mst b WHERE a.hpmrnum_profile_type \= ? AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? and a.gnum_patient_cat_code\=b.gnum_patient_cat_code and b.GNUM_HOSPITAL_CODE\=? and a.gnum_isvalid \=b.gnum_isvalid  order by GSTR_PATIENT_CAT_NAME
		      							  
DUPLICATE_CHECK_BEFORE_MODIFYSAVE.HPMRT_PROFILE_RESTRICTED_CAT =  Select GNUM_PATIENT_CAT_CODE from HPMRT_PROFILE_RESTRICTED_CAT where GNUM_PATIENT_CAT_CODE=?  and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? and HPMRNUM_PROFILE_TYPE=? 
		      							                         
		      							                         
UPDATE.HPMRT_PROFILE_RESTRICTED_CAT=          update HPMRT_PROFILE_RESTRICTED_CAT set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where GNUM_PATIENT_CAT_CODE=? AND HPMRNUM_PROFILE_TYPE=? and GNUM_HOSPITAL_CODE=? and  HPMRNUM_SLNO=?

UPDATE.ISVALID.HPMRT_PROFILE_RESTRICTED_CAT= update HPMRT_PROFILE_RESTRICTED_CAT set GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? where GNUM_PATIENT_CAT_CODE\=? AND HPMRNUM_PROFILE_TYPE\=? and GNUM_HOSPITAL_CODE\=? and  HPMRNUM_SLNO\=(select max(HPMRNUM_SLNO) from HPMRT_PROFILE_RESTRICTED_CAT where GNUM_PATIENT_CAT_CODE\=? and HPMRNUM_PROFILE_TYPE\=? and GNUM_HOSPITAL_CODE\=?)

MODIFY_INSERT.HPMRT_PROFILE_RESTRICTED_CAT =INSERT INTO HPMRT_PROFILE_RESTRICTED_CAT(GNUM_PATIENT_CAT_CODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,?,(select nvl(max(HPMRNUM_SLNO),0)+1 from HPMRT_PROFILE_RESTRICTED_CAT where GNUM_PATIENT_CAT_CODE\=? and HPMRNUM_PROFILE_TYPE\=? and gnum_hospital_code\=?),?,?,sysdate)
	   										
DUPLICATE_CHECK_BEFORE_SAVE.HPMRT_PROFILE_GROUP_MST =Select HPMRSTR_PROFILE_GROUP_NAME from HPMRT_PROFILE_GROUP_MST where upper(HPMRSTR_PROFILE_GROUP_NAME)=upper(trim(?)) and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? AND HGNUM_DEPTUNITCODE=?

INSERT.HPMRT_PROFILE_GROUP_MST = INSERT INTO HPMRT_PROFILE_GROUP_MST(HPMRNUM_PROFILE_GROUP_ID, GNUM_HOSPITAL_CODE, HPMRNUM_SLNO, HPMRSTR_PROFILE_GROUP_NAME, HGNUM_DEPTUNITCODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((select nvl(max(HPMRNUM_PROFILE_GROUP_ID),10)+1 from HPMRT_PROFILE_GROUP_MST where gnum_hospital_code\=?),?,1,initcap(?),?,?,?,sysdate)
	   								
DUPLICATE_CHECK_BEFORE_MODIFYSAVE.HPMRT_PROFILE_GROUP_MST =  Select GNUM_ISVALID from HPMRT_PROFILE_GROUP_MST where upper(trim(HPMRSTR_PROFILE_GROUP_NAME))=upper(trim(?)) and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? AND HGNUM_DEPTUNITCODE=?
	   								
SELECT.HPMRT_PROFILE_GROUP_MST= SELECT HPMRNUM_PROFILE_GROUP_ID profileGroupId,HGNUM_DEPTUNITCODE deptUnitCode,HPMRNUM_SLNO serialNo,HPMRSTR_PROFILE_GROUP_NAME profileGroupName,gnum_hospital_code hospitalCode,gnum_isvalid isActive, gnum_seat_id seatId, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate FROM HPMRT_PROFILE_GROUP_MST a where HPMRNUM_PROFILE_GROUP_ID\=? and GNUM_HOSPITAL_CODE\=?  and HPMRNUM_SLNO\=(SELECT MAX(HPMRNUM_SLNO) FROM HPMRT_PROFILE_GROUP_MST WHERE HPMRNUM_PROFILE_GROUP_ID\= a.HPMRNUM_PROFILE_GROUP_ID AND gnum_hospital_code \= a.gnum_hospital_code)\t
	   								
UPDATE.HPMRT_PROFILE_GROUP_MST=			update HPMRT_PROFILE_GROUP_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HPMRNUM_PROFILE_GROUP_ID=?  and GNUM_HOSPITAL_CODE=? and  HPMRNUM_SLNO=?

MODIFY_INSERT.HPMRT_PROFILE_GROUP_MST=INSERT INTO HPMRT_PROFILE_GROUP_MST(HPMRNUM_PROFILE_GROUP_ID, GNUM_HOSPITAL_CODE, HPMRNUM_SLNO, HPMRSTR_PROFILE_GROUP_NAME, HGNUM_DEPTUNITCODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,(select nvl(max(HPMRNUM_SLNO),0)+1 from HPMRT_PROFILE_GROUP_MST where HPMRNUM_PROFILE_GROUP_ID\=? and gnum_hospital_code\=?),initcap(?),?,?,?,sysdate)
	   										
INSERT.HPMRT_PROFILE_GROUP_DTL=					INSERT INTO HPMRT_PROFILE_GROUP_DTL(HPMRNUM_PROFILE_GROUP_ID, GNUM_HOSPITAL_CODE, HPMRNUM_RECORD_MODE, HPMRNUM_ACCESS_RECORD_ID, HPMRNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,?,?,?,?,?,sysdate)
SELECT_MAX_SERIAL.HPMRT_PROFILE_GROUP_DTL=(select nvl(max(HPMRNUM_SLNO),0)+1 from hpmrt_profile_group_dtl where gnum_hospital_code=? )

SELECT.HPMRT_PROFILE_GROUP_DTL=SELECT HPMRNUM_PROFILE_GROUP_ID profileGroupId, HPMRNUM_RECORD_MODE recordMode, HPMRNUM_ACCESS_RECORD_ID accessRecordId, HPMRNUM_SLNO serialNo, GNUM_ISVALID isValid,(SELECT HPMRSTR_PROFILE_GROUP_NAME FROM HPMRT_PROFILE_GROUP_MST WHERE hpmrnum_profile_group_id\=a.hpmrnum_profile_group_id AND gnum_hospital_code \= a.gnum_hospital_code AND GNUM_ISVALID\=?) profileGroupName FROM HPMRT_PROFILE_GROUP_DTL a WHERE HPMRNUM_PROFILE_GROUP_ID\=? AND GNUM_HOSPITAL_CODE\=? and HPMRNUM_SLNO\=(SELECT MAX(HPMRNUM_SLNO) FROM HPMRT_PROFILE_GROUP_DTL WHERE HPMRNUM_PROFILE_GROUP_ID\=a.HPMRNUM_PROFILE_GROUP_ID AND gnum_hospital_code \= a.gnum_hospital_code)

UPDATE.HPMRT_PROFILE_GROUP_DTL=    update HPMRT_PROFILE_GROUP_DTL set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HPMRNUM_PROFILE_GROUP_ID=?  and GNUM_HOSPITAL_CODE=? and  HPMRNUM_SLNO=?
													
MODIFY_INSERT.HPMRT_PROFILE_GROUP_DTL=INSERT INTO HPMRT_PROFILE_GROUP_DTL(HPMRNUM_PROFILE_GROUP_ID, GNUM_HOSPITAL_CODE, HPMRNUM_RECORD_MODE, HPMRNUM_ACCESS_RECORD_ID, HPMRNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,?,?,?,?,?,sysdate)\t
	   										
DUPLICATE_CHECK_BEFORE_SAVE.HPMRT_PROFILE_ACCESS_POLICY =		Select HGNUM_DEPTUNITCODE from HPMRT_PROFILE_ACCESS_POLICY where HGNUM_DEPTUNITCODE=? and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? AND HPMRNUM_PROFILE_TYPE=? AND HPMRNUM_POLICY_TYPE=?											

INSERT.HPMRT_PROFILE_ACCESS_POLICY_old=   		INSERT INTO HPMRT_PROFILE_ACCESS_POLICY(HGNUM_DEPTUNITCODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE, HPMRNUM_SLNO, HPMRNUM_ACCESS_TYPE, HPMRNUM_USER_LEVEL, HPMRNUM_PROFILE_GROUP_ID, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO) \
	   		                  					VALUES(?,?,?,?,1,?,?,?,?,?,sysdate,to_date(?,'dd-mm-yyyy'),to_date(?,'dd-mm-yyyy'))
	   		                  					
INSERT.HPMRT_PROFILE_ACCESS_POLICY=   		INSERT INTO HPMRT_PROFILE_ACCESS_POLICY(HGNUM_DEPTUNITCODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE, HPMRNUM_SLNO, HPMRNUM_ACCESS_TYPE, HPMRNUM_USER_LEVEL, HPMRNUM_PROFILE_GROUP_ID, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO) \
	   		                  					VALUES(?,?,?,?,(select nvl(max(hpmrnum_slno),0)+1 from hpmrt_profile_access_policy),?,?,?,?,?,sysdate,sysdate,to_date(?,'dd-mm-yyyy'))
	   		                  					
#SELECT.HPMRT_PROFILE_ACCESS_POLICY =	  SELECT HPMRNUM_PROFILE_GROUP_ID profileGroupId,HGNUM_DEPTUNITCODE deptUnitCode,HPMRNUM_PROFILE_TYPE profileType,(select HPMRSTR_PROFILE_NAME from hpmrt_profile_type_mst where hpmrnum_profile_type=a.hpmrnum_profile_type \
#	     								  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) profileTypeName,HPMRNUM_POLICY_TYPE policyType,HPMRNUM_ACCESS_TYPE accessType,HPMRNUM_USER_LEVEL userLevel,HPMRNUM_SLNO serialNo,gnum_hospital_code hospitalCode,\
#		      							  gnum_isvalid isActive, gnum_seat_id seatId, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate,(SELECT HPMRSTR_PROFILE_GROUP_NAME FROM HPMRT_PROFILE_GROUP_MST WHERE HPMRNUM_PROFILE_GROUP_ID=a.HPMRNUM_PROFILE_GROUP_ID AND GNUM_HOSPITAL_CODE= \
#		      							  a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=?) profileGroupName FROM HPMRT_PROFILE_ACCESS_POLICY a \
#		      							  where HGNUM_DEPTUNITCODE=? AND HPMRNUM_PROFILE_TYPE=? AND HPMRNUM_POLICY_TYPE=? and GNUM_HOSPITAL_CODE=?  and HPMRNUM_SLNO=?
#	

#modifiedby: NehaRajgariya Date:7sept2016
SELECT.HPMRT_PROFILE_ACCESS_POLICY =SELECT HPMRNUM_PROFILE_GROUP_ID profileGroupId,HGNUM_DEPTUNITCODE deptUnitCode,HPMRNUM_PROFILE_TYPE profileType,(select HPMRSTR_PROFILE_NAME from hpmrt_profile_type_mst where hpmrnum_profile_type\=a.hpmrnum_profile_type AND gnum_hospital_code \= 100 AND gnum_isvalid \= a.gnum_isvalid) profileTypeName,HPMRNUM_POLICY_TYPE policyType,HPMRNUM_ACCESS_TYPE accessType,HPMRNUM_USER_LEVEL userLevel,HPMRNUM_SLNO serialNo,gnum_hospital_code hospitalCode,gnum_isvalid isActive, gnum_seat_id seatId, to_char(gdt_entry_date,'dd-Mon-yyyy') entryDate,(SELECT HPMRSTR_PROFILE_GROUP_NAME FROM HPMRT_PROFILE_GROUP_MST WHERE HPMRNUM_PROFILE_GROUP_ID\=a.HPMRNUM_PROFILE_GROUP_ID AND GNUM_HOSPITAL_CODE\= a.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=?) profileGroupName FROM HPMRT_PROFILE_ACCESS_POLICY a where HGNUM_DEPTUNITCODE\=? AND HPMRNUM_PROFILE_TYPE\=? AND HPMRNUM_POLICY_TYPE\=? and GNUM_HOSPITAL_CODE\=?  and HPMRNUM_SLNO\=?
		      							  
DUPLICATE_CHECK_BEFORE_MODIFYSAVE.HPMRT_PROFILE_ACCESS_POLICY =		Select HGNUM_DEPTUNITCODE from HPMRT_PROFILE_ACCESS_POLICY where HGNUM_DEPTUNITCODE=? and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID <> ? AND HPMRNUM_PROFILE_TYPE=? AND HPMRNUM_POLICY_TYPE=?

UPDATE.HPMRT_PROFILE_ACCESS_POLICY=  update HPMRT_PROFILE_ACCESS_POLICY set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HGNUM_DEPTUNITCODE=? AND  HPMRNUM_PROFILE_TYPE=? AND  HPMRNUM_POLICY_TYPE=?  and GNUM_HOSPITAL_CODE=? and  HPMRNUM_SLNO=?

MODIFY_INSERT.HPMRT_PROFILE_ACCESS_POLICY_old= INSERT INTO HPMRT_PROFILE_ACCESS_POLICY(HGNUM_DEPTUNITCODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE, HPMRNUM_SLNO, HPMRNUM_ACCESS_TYPE, HPMRNUM_USER_LEVEL, HPMRNUM_PROFILE_GROUP_ID, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO) VALUES(?,?,?,?,(SELECT nvl(max(HPMRNUM_SLNO),0)+1 FROM hpmrt_profile_access_policy a WHERE a.hgnum_deptunitcode \= HGNUM_DEPTUNITCODE AND a.hpmrnum_profile_type \= hpmrnum_profile_type AND a.hpmrnum_policy_type \= hpmrnum_policy_type AND a.gnum_hospital_code \= gnum_hospital_code),?,?,?,?,?,sysdate,to_date(?,'dd-mm-yyyy'),to_date(?,'dd-mm-yyyy'))\t\t    
	   		                  					
MODIFY_INSERT.HPMRT_PROFILE_ACCESS_POLICY= INSERT INTO HPMRT_PROFILE_ACCESS_POLICY(HGNUM_DEPTUNITCODE, HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE, HPMRNUM_SLNO, HPMRNUM_ACCESS_TYPE, HPMRNUM_USER_LEVEL, HPMRNUM_PROFILE_GROUP_ID, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO) VALUES(?,?,?,?,(SELECT nvl(max(HPMRNUM_SLNO),0)+1 FROM hpmrt_profile_access_policy a WHERE a.hgnum_deptunitcode \= HGNUM_DEPTUNITCODE AND a.hpmrnum_profile_type \= hpmrnum_profile_type AND a.hpmrnum_policy_type \= hpmrnum_policy_type AND a.gnum_hospital_code \= gnum_hospital_code),?,?,?,?,?,sysdate,sysdate,to_date(?,'dd-mm-yyyy'))\t\t    
	   		                  					
INSERT.HGBT_EXT_UNIT_TREATMENT_MST =insert into HGBT_EXT_UNIT_TREATMENT_MST (HGNUM_EXT_TREATMENT_ID, HGNUM_DEPTUNITCODE, GNUM_HOSPITAL_CODE, HGNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE)  values(?,?,?,(SELECT nvl(max(HGNUM_SLNO),0)+1 FROM HGBT_EXT_UNIT_TREATMENT_MST a WHERE a.HGNUM_EXT_TREATMENT_ID \= ? AND a.HGNUM_DEPTUNITCODE\= ? AND GNUM_HOSPITAL_CODE\=?),?,?,sysdate)
								

INSERT.hgbt_unit_drug_mapping_mst=INSERT INTO hgbt_unit_drug_mapping_mst(hstnum_item_id, hgnum_deptunitcode, gnum_hospital_code, gnum_isvalid, gnum_seat_id, gdt_entry_date) VALUES (?, ?, ?, ?, ?, sysdate)

								
UPDATE.HGBT_EXT_UNIT_TREATMENT_MST = UPDATE HGBT_EXT_UNIT_TREATMENT_MST set GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?

UPDATE.hgbt_unit_drug_mapping_mst = DELETE FROM  hgbt_unit_drug_mapping_mst  WHERE hgnum_deptunitcode=? and  gnum_hospital_code=?;
								
DELETE.hgbt_unit_drug_mapping_mst = DELETE FROM  hgbt_unit_drug_mapping_mst  WHERE hgnum_deptunitcode=? and  gnum_hospital_code=? AND hstnum_item_id=? AND GNUM_ISVALID=0;
	
INSERT.HGBT_MACRO_UNITWISE_MST = INSERT INTO HGBT_MACRO_UNITWISE_MST (HGNUM_MACRO_ID, HGNUM_DEPTUNITCODE, GNUM_HOSPITAL_CODE, HGNUM_SLNO, HGNUM_PROCESS_ID, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES(?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_MACRO_UNITWISE_MST a WHERE a.HGNUM_MACRO_ID \= ?  AND a.HGNUM_DEPTUNITCODE\= ? AND a. GNUM_HOSPITAL_CODE\=?),?,?,?,SYSDATE,?,?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t   \t\t                  \t\t\t\t\t  \t\t\t\t\t\t\t  


INSERT.HPMRT_PROFILE_TYPE_TABMAPPING	=insert into HPMRT_PROFILE_TYPE_TABMAPPING (HPMRNUM_PROFILE_TYPE, GNUM_DESK_MENU_ID, GNUM_HOSPITAL_CODE, HPMRNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, hpmrnum_order_by) values(?,?,?,(select nvl(max(HPMRNUM_SLNO),0)+1 from HPMRT_PROFILE_TYPE_TABMAPPING where HPMRNUM_PROFILE_TYPE\=? and GNUM_DESK_MENU_ID\=? and GNUM_HOSPITAL_CODE\=?),?,?,sysdate,?)\t\t\t\t\t\t\t\t   \t\t                  \t\t\t\t\t  \t\t
											
UPDATE.HPMRT_PROFILE_TYPE_TABMAPPING	=	update HPMRT_PROFILE_TYPE_TABMAPPING set  GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HPMRNUM_PROFILE_TYPE=? and GNUM_HOSPITAL_CODE=?
							
											
SELECT.DESK_MENU.HPMRT_PROFILE_TYPE_TABMAPPING	=SELECT a.gnum_desk_menu_id, gstr_desk_menu_name deskMenuName FROM hpmrt_profile_type_tabmapping a,gblt_desk_menu_mst b WHERE a.hpmrnum_profile_type \= ? AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? and a.gnum_desk_menu_id \= b.gnum_desk_menu_id AND b.gnum_hospital_code\=? AND a.gnum_isvalid \= b.gnum_isvalid ORDER BY deskmenuname
  													
  													
SELECT.DESKMENU_NOT_ADDED.GBLT_DESK_MENU_MST	=SELECT GNUM_DESK_MENU_ID, gstr_desk_menu_name  FROM gblt_desk_menu_mst a WHERE gnum_hospital_code \= ?  AND gnum_isvalid \= ?  and GNUM_USABILITY_FLAG\=? and GNUM_DESK_MENU_ID not in (select GNUM_DESK_MENU_ID from HPMRT_PROFILE_TYPE_TABMAPPING where HPMRNUM_PROFILE_TYPE\=? and  GNUM_HOSPITAL_CODE\=?  and  GNUM_ISVALID\=a.GNUM_ISVALID)  order by gstr_desk_menu_name

SELECT.HPMRT_PROFILE_TYPE_MST   = SELECT HPMRNUM_PROFILE_TYPE AS profileType,GNUM_HOSPITAL_CODE AS hospitalCode, HPMRNUM_SLNO AS slNo, HPMRSTR_PROFILE_NAME AS profileName,  HPMRNUM_IS_UNIQUE AS isUnique,HPMRNUM_GENERATION_MODE AS generationMode,HPMRSTR_DEFAULT_NAME AS defaultName, HPMRNUM_PROFILE_USABILITY AS profileUsablity, HPMRNUM_CD_BURN AS isCdBurn, HPMRNUM_IS_BILLING AS isBilling, gnum_isvalid isActive, GNUM_SEAT_ID AS seatID, HPMRNUM_IS_DISCLAIMER AS isDesclaimerRequired, HPMRSTR_PROFILE_DESC AS profileDesc, to_char(gdt_entry_date,'dd-Mon-yyyy') AS entryDate FROM HPMRT_PROFILE_TYPE_MST where HPMRNUM_PROFILE_TYPE\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_SLNO\=? 

UPDATE.HPMRT_PROFILE_TYPE_MST  =  update HPMRT_PROFILE_TYPE_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HPMRNUM_PROFILE_TYPE=?  and GNUM_HOSPITAL_CODE=? and  HPMRNUM_SLNO=?													


MODIFY_INSERT.HPMRT_PROFILE_TYPE_MST = INSERT INTO HPMRT_PROFILE_TYPE_MST(HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE,HPMRNUM_SLNO,HPMRSTR_PROFILE_NAME, HPMRSTR_PROFILE_DESC,  HPMRNUM_IS_UNIQUE, HPMRNUM_GENERATION_MODE, HPMRSTR_DEFAULT_NAME,HPMRNUM_PROFILE_USABILITY,HPMRNUM_CD_BURN,HPMRNUM_IS_BILLING, GNUM_ISVALID, GNUM_SEAT_ID, HPMRNUM_IS_DISCLAIMER,GDT_ENTRY_DATE) VALUES(?,?,(SELECT max(HPMRNUM_SLNO)+1 FROM HPMRT_PROFILE_TYPE_MST a WHERE a.HPMRNUM_PROFILE_TYPE \= ? AND a.GNUM_HOSPITAL_CODE \= ?),?,?,?,?,?,?,?,?,?,?,?,sysdate)\t\t

DUPLICATE_CHECK_BEFORE_SAVE.HPMRT_PROFILE_TYPE_MST = select count(*) from HPMRT_PROFILE_TYPE_MST where trim(upper(HPMRSTR_PROFILE_NAME))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t\t

DUPLICATE_CHECK_BEFORE_MODIFY_SAVE.HPMRT_PROFILE_TYPE_MST = select count(*) from HPMRT_PROFILE_TYPE_MST where trim(upper(HPMRSTR_PROFILE_NAME))=trim(upper(?)) AND GNUM_ISVALID !=? AND GNUM_HOSPITAL_CODE =? AND HPMRNUM_PROFILE_TYPE!=? 

SELECT.All_PROFILE_TYPE.HPMRT_PROFILE_TYPE_MST	=	SELECT hpmrnum_profile_type, hpmrstr_profile_name FROM hpmrt_profile_type_mst where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? order by hpmrstr_profile_name

UPDATE.HGBT_MACRO_UNITWISE_MST = UPDATE HGBT_MACRO_UNITWISE_MST SET GNUM_ISVALID=?,GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? WHERE HGNUM_DEPTUNITCODE=? and GNUM_HOSPITAL_CODE=?   																																									  

INSERT.HPMRT_PROFILE_TYPE_MST	=insert into HPMRT_PROFILE_TYPE_MST (HPMRNUM_PROFILE_TYPE, GNUM_HOSPITAL_CODE, HPMRSTR_PROFILE_NAME, HPMRNUM_SLNO, HPMRSTR_PROFILE_DESC, HPMRNUM_IS_UNIQUE, HPMRNUM_GENERATION_MODE, HPMRSTR_DEFAULT_NAME, HPMRNUM_PROFILE_USABILITY, HPMRNUM_CD_BURN, HPMRNUM_IS_BILLING, GNUM_ISVALID, GNUM_SEAT_ID,GDT_ENTRY_DATE, HPMRNUM_IS_DISCLAIMER) values((select nvl(max(HPMRNUM_PROFILE_TYPE),10)+1 from HPMRT_PROFILE_TYPE_MST where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?)
									   																																									  

SELECT.BY_PROFILE_TYPE_AND_POLICY_TYPE.HPMRT_PROFILE_ACCESS_POLICY	=	SELECT hgnum_deptunitcode deptunitcode FROM hpmrt_profile_access_policy a WHERE hpmrnum_profile_type = ? AND hpmrnum_policy_type = ?  AND gnum_hospital_code = ? AND GNUM_ISVALID=? 

INSERT.HGBT_EPISODE_KEYWORD_MST = INSERT  INTO HGBT_EPISODE_KEYWORD_MST (HGNUM_EPISODE_KEYWORD_ID, HGSTR_EPISODE_KEYWORD, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,  GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID)  VALUES((SELECT NVL(MAX(HGNUM_EPISODE_KEYWORD_ID),100)+1 FROM HGBT_EPISODE_KEYWORD_MST ), INITCAP(?),?,?,SYSDATE,?\:\:timestamp,?)

CHECK_DUPLICATE_NAME.HGBT_EPISODE_KEYWORD_MST =  SELECT COUNT(*) FROM  HGBT_EPISODE_KEYWORD_MST WHERE trim(UPPER(HGSTR_EPISODE_KEYWORD))=trim(UPPER(?))  AND GNUM_ISVALID != ?	

SELECT.HGBT_EPISODE_KEYWORD_MST = SELECT HGNUM_EPISODE_KEYWORD_ID AS episodeKeywordID,HGSTR_EPISODE_KEYWORD AS episodeKeyword, GNUM_ISVALID AS isValid FROM HGBT_EPISODE_KEYWORD_MST WHERE HGNUM_EPISODE_KEYWORD_ID\=?

CHECK_DUPLICATE_NAMEFORMODIFY.HGBT_EPISODE_KEYWORD_MST = SELECT COUNT(*) FROM HGBT_EPISODE_KEYWORD_MST WHERE UPPER(HGSTR_EPISODE_KEYWORD)\=UPPER(?)  AND GNUM_ISVALID \!\= ? AND HGNUM_EPISODE_KEYWORD_ID\!\=?

UPDATE.HGBT_EPISODE_KEYWORD_MST = UPDATE HGBT_EPISODE_KEYWORD_MST SET GDT_LSTMOD_DATE\=SYSDATE,GNUM_LSTMOD_SEATID\=?,GNUM_ISVALID\=? WHERE HGNUM_EPISODE_KEYWORD_ID\=? 
									
INSERT_MODIFY.HGBT_EPISODE_KEYWORD_MST = INSERT INTO HGBT_EPISODE_KEYWORD_MST(HGNUM_EPISODE_KEYWORD_ID,  HGSTR_EPISODE_KEYWORD, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES((SELECT NVL(MAX(HGNUM_EPISODE_KEYWORD_ID),100)+1 FROM HGBT_EPISODE_KEYWORD_MST ),?,?,?,SYSDATE,?\:\:timestamp,?)
											
INSERT.HGBT_DRUG_LIST_MST = INSERT INTO HGBT_DRUG_LIST_MST ( HGNUM_DRUGLIST_ID, HGSTR_DRUGLIST_NAME, GNUM_ISVALID, HGSTR_REMARK, HGNUM_SLNO, GNUM_SEAT_ID, HGSTR_DISEASE_CODES, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,  GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES((SELECT NVL(MAX(HGNUM_DRUGLIST_ID),1000)+1 FROM HGBT_DRUG_LIST_MST WHERE GNUM_HOSPITAL_CODE\=?), ?,?,?,?,?,?,SYSDATE,?,?,?)\t\t
							  
CHECK_DUPLICATE_NAME.HGBT_DRUG_LIST_MST = SELECT COUNT(*) FROM   HGBT_DRUG_LIST_MST WHERE UPPER(HGSTR_DRUGLIST_NAME)=UPPER(?) AND GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID != ?	

SELECT.HGBT_DRUG_LIST_MST = SELECT HGNUM_DRUGLIST_ID AS drugListId, HGSTR_DRUGLIST_NAME AS drugListName , GNUM_ISVALID AS isValid , HGSTR_REMARK AS remark, HGNUM_SLNO AS slNo, HGSTR_DISEASE_CODES AS diseaseCode, GNUM_HOSPITAL_CODE AS hospitalCode FROM HGBT_DRUG_LIST_MST WHERE HGNUM_DRUGLIST_ID\=? AND  HGNUM_SLNO\=? AND  GNUM_HOSPITAL_CODE\=?\t\t
							
CHECK_DUPLICATE_NAMEFORMODIFY.HGBT_DRUG_LIST_MST = SELECT COUNT(*) FROM HGBT_DRUG_LIST_MST WHERE UPPER(HGSTR_DRUGLIST_NAME)\=UPPER(?) AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \!\= ? AND HGNUM_DRUGLIST_ID\!\=?\t
															
UPDATE.HGBT_DRUG_LIST_MST = UPDATE HGBT_DRUG_LIST_MST SET GDT_LSTMOD_DATE\=SYSDATE,GNUM_LSTMOD_SEATID\=?,GNUM_ISVALID\=? WHERE HGNUM_DRUGLIST_ID\=? AND HGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?
									
INSERT_MODIFY.HGBT_DRUG_LIST_MST = INSERT INTO HGBT_DRUG_LIST_MST(HGNUM_DRUGLIST_ID, HGSTR_DRUGLIST_NAME, GNUM_ISVALID, HGSTR_REMARK, HGNUM_SLNO, GNUM_SEAT_ID, HGSTR_DISEASE_CODES, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES (?,?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_DRUG_LIST_MST  WHERE GNUM_HOSPITAL_CODE \=? AND HGNUM_DRUGLIST_ID\=?), ?,?,SYSDATE,?,?,?)\t
									
SELECT.DRUGLISTNAME_LIST.HGBT_DRUG_LIST_MST = select  HGNUM_DRUGLIST_ID, HGSTR_DRUGLIST_NAME from HGBT_DRUG_LIST_MST  where  GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? AND HGNUM_DRUGLIST_ID NOT IN(SELECT HGNUM_DRUGLIST_ID FROM HGBT_DRUGLIST_ITEM_MST WHERE gnum_isvalid =? AND gnum_hospital_code = ? ) order by  HGSTR_DRUGLIST_NAME		

INSERT.HGBT_DRUGLIST_ITEM_MST = INSERT  INTO HGBT_DRUGLIST_ITEM_MST (HGNUM_DRUGLIST_ID, HSTNUM_ITEM_ID, GNUM_ISVALID, HGNUM_DOSE_ID, HGNUM_SLNO, GNUM_SEAT_ID, HGNUM_FREQUENCY_ID, GDT_ENTRY_DATE, HGNUM_DAYS,  HGNUM_ISEMPTY_STOMACH, GNUM_HOSPITAL_CODE, GDT_LSTMOD_DATE, HRGSTR_REMARKS, GNUM_LSTMOD_SEATID) VALUES(?,?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_DRUGLIST_ITEM_MST  WHERE HSTNUM_ITEM_ID\=? AND HGNUM_DRUGLIST_ID\=? AND GNUM_HOSPITAL_CODE\=?),?,?,SYSDATE,?,?,?,?,?,?)\t
								
ESSENTIAL.LIST.HGBT_DRUGLIST_ITEM_MST = SELECT HGNUM_DRUGLIST_ID AS drugListId , HSTNUM_ITEM_ID AS drugId,  HGNUM_DOSE_ID AS doseId, HGNUM_SLNO AS slNo, HGNUM_FREQUENCY_ID AS frequencyId, HGNUM_DAYS AS days, HGNUM_ISEMPTY_STOMACH AS isEmptyStomach, GNUM_HOSPITAL_CODE AS hospitalCode,  HRGSTR_REMARKS AS remarks , (SELECT HGSTR_DRUGLIST_NAME  FROM HGBT_DRUG_LIST_MST X WHERE X.HGNUM_DRUGLIST_ID\=a.HGNUM_DRUGLIST_ID  AND X.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND X.GNUM_ISVALID\=a.GNUM_ISVALID) AS drugListName, (SELECT HSTSTR_ITEM_NAME  FROM HSTT_DRUGBRAND_MST y  WHERE Y.HSTNUM_ITEMBRAND_ID\=a.HSTNUM_ITEM_ID  AND y.GNUM_HOSPITAL_CODE\=100 AND y.GNUM_ISVALID\=a.GNUM_ISVALID) AS drugName, (SELECT HGSTR_FREQUENCY_NAME  FROM HGBT_DRUG_FREQUENCY_MST z  WHERE z.HGNUM_FREQUENCY_ID\=a.HGNUM_FREQUENCY_ID  AND z.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND z.GNUM_ISVALID\=a.GNUM_ISVALID) AS frequencyName, (SELECT HGSTR_DOSE_NAME  FROM HGBT_DRUG_DOSE_MST b  WHERE  b.HGNUM_DOSE_ID\=a.HGNUM_DOSE_ID  AND b.GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND b.GNUM_ISVALID\=a.GNUM_ISVALID)  AS doseName, \t\t\t\t\t\t\t\t\t\t DECODE(HGNUM_ISEMPTY_STOMACH,1,'Yes',0,'No') AS isEmptyStomachName FROM HGBT_DRUGLIST_ITEM_MST a WHERE HGNUM_DRUGLIST_ID\=? AND  GNUM_ISVALID\=? AND  GNUM_HOSPITAL_CODE\=? ORDER BY drugName\t
										 
UPDATE.HGBT_DRUGLIST_ITEM_MST = UPDATE HGBT_DRUGLIST_ITEM_MST SET GDT_LSTMOD_DATE\=SYSDATE,GNUM_LSTMOD_SEATID\=?,GNUM_ISVALID\=? WHERE HGNUM_DRUGLIST_ID\=? AND GNUM_HOSPITAL_CODE\=?\t
									
INSERT.HGBT_DRUGLIST_UNITWISE_MST = INSERT INTO HGBT_DRUGLIST_UNITWISE_MST (HGNUM_DEPTUNITCODE, HGNUM_DRUGLIST_ID, GNUM_ISVALID, HGNUM_ISDEFAULT, HGNUM_SLNO, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES (?,?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM  HGBT_DRUGLIST_UNITWISE_MST WHERE  HGNUM_DEPTUNITCODE\=? AND  HGNUM_DRUGLIST_ID\=? AND GNUM_HOSPITAL_CODE\=? ),?,SYSDATE,?,?,?)\t
									
UPDATE.HGBT_DRUGLIST_UNITWISE_MST = UPDATE HGBT_DRUGLIST_UNITWISE_MST set GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?																										 																																																	  																																	


INSERT.HGBT_ATTENDANT_REASON_MST	=INSERT  INTO HGBT_ATTENDANT_REASON_MST(HGNUM_ATTENDANT_REASON_ID, GNUM_HOSPITAL_CODE, HGNUM_SLNO, HGSTR_ATTENDANT_REASON, GNUM_ISVALID,GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX( HGNUM_ATTENDANT_REASON_ID),10)+1 FROM HGBT_ATTENDANT_REASON_MST WHERE GNUM_HOSPITAL_CODE\=?),?, ?, INITCAP(?), ?, ?, SYSDATE)\t\t\t\t\t\t\t\t\t\t
										
CHECK_DUPLICATE.HGBT_ATTENDANT_REASON_MST	=	SELECT COUNT(*) FROM HGBT_ATTENDANT_REASON_MST WHERE trim(UPPER(HGSTR_ATTENDANT_REASON))=trim(UPPER(?)) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID<>?    

CHECK_DUPLICATE.MODIFY.HGBT_ATTENDANT_REASON_MST	=	SELECT COUNT(*) FROM HGBT_ATTENDANT_REASON_MST WHERE UPPER(HGSTR_ATTENDANT_REASON)=UPPER(?) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID<>? AND HGNUM_ATTENDANT_REASON_ID<>?    

SELECT.HGBT_ATTENDANT_REASON_MST	=SELECT HGNUM_ATTENDANT_REASON_ID AS attendantReasonID, GNUM_HOSPITAL_CODE AS hospitalCode, HGNUM_SLNO AS slNo, INITCAP(HGSTR_ATTENDANT_REASON) AS attendantReason, GNUM_ISVALID AS isValid, GNUM_SEAT_ID AS seatId, GDT_ENTRY_DATE AS entryDate, GDT_LSTMOD_DATE AS lastModifyDate, GNUM_LSTMOD_SEATID AS lastModifiedSeatID FROM HGBT_ATTENDANT_REASON_MST WHERE HGNUM_ATTENDANT_REASON_ID\=? AND GNUM_HOSPITAL_CODE\=? AND HGNUM_SLNO\=?


UPDATE.DELETE.HGBT_ATTENDANT_REASON_MST	=	UPDATE HGBT_ATTENDANT_REASON_MST SET GDT_LSTMOD_DATE=SYSDATE, GNUM_ISVALID=?, GNUM_LSTMOD_SEATID=? WHERE HGNUM_ATTENDANT_REASON_ID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_SLNO=? 
										
INSERT.MODIFY.HGBT_ATTENDANT_REASON_MST	=INSERT  INTO HGBT_ATTENDANT_REASON_MST(HGNUM_ATTENDANT_REASON_ID, GNUM_HOSPITAL_CODE, HGNUM_SLNO, HGSTR_ATTENDANT_REASON, GNUM_ISVALID,GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES (?, ?, (SELECT MAX(HGNUM_SLNO)+1 FROM HGBT_ATTENDANT_REASON_MST WHERE HGNUM_ATTENDANT_REASON_ID\=? AND GNUM_HOSPITAL_CODE\=?),INITCAP(?), ?, ?, SYSDATE)

UPDATE.IMAGE.HOPT_UNIT_IMAGE_MST	=	UPDATE HOPT_UNIT_IMAGE_MST SET GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=? 
							
SELECT.NOT_ADDED_UNITS.HGBT_EPI_KEYWORD_UNITWISE_MST	=SELECT A.HGNUM_DEPTUNITCODE , INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' FROM  HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.GNUM_DEPT_CODE\=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=B.GNUM_ISVALID AND A.HGNUM_DEPTUNITCODE NOT IN (SELECT HGNUM_DEPTUNITCODE FROM HGBT_EPI_KEYWORD_UNITWISE_MST WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? ) AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')'

INSERT.HGBT_EPI_KEYWORD_UNITWISE_MST	=INSERT INTO HGBT_EPI_KEYWORD_UNITWISE_MST (HGNUM_DEPTUNITCODE, HGNUM_EPISODE_KEYWORD_ID, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, HGNUM_SLNO) VALUES(?,?,?,?,?,SYSDATE,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_EPI_KEYWORD_UNITWISE_MST WHERE GNUM_HOSPITAL_CODE\=? AND HGNUM_EPISODE_KEYWORD_ID \=? AND HGNUM_DEPTUNITCODE\=?))\t\t\t\t\t\t\t\t
							
UPDATE.DELETE.HGBT_EPI_KEYWORD_UNITWISE_MST	=	UPDATE HGBT_EPI_KEYWORD_UNITWISE_MST SET GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=? 
							
INSERT.INCLUDE_EXCLUDE.HGBT_ICD_DISEASE_MST	=INSERT INTO HGBT_ICD_DISEASE_MST (HGBSTR_DISEASE_CODE, GNUM_HOSPITAL_CODE, HGNUM_SLNO, HGBSTR_ICD_SUBGRP_CODE, HGBSTR_DISEASE, HGBSTR_PARENT_CODE, HGNUM_RECORD_TYPE, GNUM_SEAT_ID, GDT_ENTRY_DATE, GBL_ISCOMMON, HGBSTR_DISEASE_REMARK, GNUM_ISVALID, HBSTR_MAIN_DISEASE, HGBNUM_DISEASE_TYPE_CODE) VALUES (?, ?, (SELECT NVL(MAX( HGNUM_SLNO),0)+1 FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE) LIKE TRIM(?) AND GNUM_HOSPITAL_CODE\=?), ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?)\t\t\t\t\t\t\t\t\t\t

CHECK_DUPLICATE.INCLUDE_EXCLUDE.HGBT_ICD_DISEASE_MST	=	SELECT COUNT(*) FROM HGBT_ICD_DISEASE_MST WHERE UPPER(HGBSTR_DISEASE)=UPPER(?) AND HGBSTR_DISEASE_CODE=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID<>?    

SELECT.INCLUDE_EXCLUDE.HGBT_ICD_DISEASE_MST	=SELECT X.HGBSTR_DISEASE_CODE AS diseaseCode, X.GNUM_HOSPITAL_CODE AS hospitalCode, X.HGNUM_SLNO AS slNo, X.HGBSTR_ICD_SUBGRP_CODE AS icdSubgroupCode, INITCAP(X.HGBSTR_DISEASE) AS disease, X.HGBSTR_PARENT_CODE AS parentCode, X.HGNUM_RECORD_TYPE AS recordType, X.GNUM_SEAT_ID AS seatId, X.GDT_ENTRY_DATE AS entryDate, X.GBL_ISCOMMON AS isCommon, X.HGBSTR_DISEASE_REMARK AS diseaseRemark, X.GNUM_ISVALID AS isValid, INITCAP(X.HBSTR_MAIN_DISEASE) ||'('||TRIM(X.HGBSTR_DISEASE_CODE)||')'  AS mainDisease, X.HGBNUM_DISEASE_TYPE_CODE AS diseaseTypeCode, NVL((SELECT INITCAP(HGBSTR_DISEASE_TYPE_NAME) FROM HGBT_DISEASE_TYPE_MST WHERE HGBNUM_DISEASE_TYPE_CODE\=X.HGBNUM_DISEASE_TYPE_CODE AND GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=?),'') AS diseaseTypeName, A.HGBSTR_ICD_GROUP_CODE AS icdGroupCode, SUBSTR(A.HGBSTR_ICD_GROUP,1,40)||DECODE(SUBSTR(A.HGBSTR_ICD_GROUP,40,200),'',' ','..')||'('||A.HGBSTR_ICD_GROUP_CODE||')' AS icdGroup, SUBSTR(B.HGBSTR_ICD_SUBGROUP,1,40)||DECODE(SUBSTR(B.HGBSTR_ICD_SUBGROUP,40,125),'',' ','..')||'('||B.HGBSTR_ICD_SUBGRP_CODE||')' AS icdSubgroup FROM HGBT_ICD_DISEASE_MST X, HGBT_ICD_GROUP_MST A, HGBT_ICD_SUBGROUP_MST B WHERE X.HGBSTR_ICD_SUBGRP_CODE\=B.HGBSTR_ICD_SUBGRP_CODE AND X.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.HGBSTR_ICD_GROUP_CODE\=A.HGBSTR_ICD_GROUP_CODE AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND X.GNUM_HOSPITAL_CODE\=? AND X.HGBSTR_DISEASE_CODE\=? AND X.HGNUM_SLNO\=? AND A.GNUM_ISVALID \= ? AND B.GNUM_ISVALID \= ?

CHECK_DUPLICATE.INCLUDE_EXCLUDE.MODIFY.HGBT_ICD_DISEASE_MST	=	SELECT COUNT(*) FROM HGBT_ICD_DISEASE_MST WHERE UPPER(HGBSTR_DISEASE)=UPPER(?) AND HGBSTR_DISEASE_CODE=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_SLNO<>? AND GNUM_ISVALID<>? AND HGNUM_RECORD_TYPE<>?    

UPDATE.DELETE.INCLUDE_EXCLUDE.HGBT_ICD_DISEASE_MST	=	UPDATE HGBT_ICD_DISEASE_MST SET GNUM_ISVALID=? WHERE HGBSTR_DISEASE_CODE=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_SLNO=?

INSERT.HGBT_PAT_ALERT_MST    = insert into HGBT_PAT_ALERT_MST ( HGNUM_PAT_ALERT_ID,HGSTR_ALERT_NAME, HGBSTR_DISEASE_CODE, GNUM_HOSPITAL_CODE, HGNUM_SLNO,GNUM_ISVALID, GNUM_SEAT_ID,GDT_ENTRY_DATE) values((select nvl(max(HGNUM_PAT_ALERT_ID),100)+1 from HGBT_PAT_ALERT_MST where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,sysdate)
										
DUPLICATE_CHECK_BEFORE_SAVE.HGBT_PAT_ALERT_MST    = select count(*) from HGBT_PAT_ALERT_MST where trim(upper(HGSTR_ALERT_NAME))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? 
														
UPDATE.HGBT_PAT_ALERT_MST     =   update HGBT_PAT_ALERT_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HGNUM_PAT_ALERT_ID=?  and GNUM_HOSPITAL_CODE=? and  HGNUM_SLNO=?		
							
MODIFY_INSERT.HGBT_PAT_ALERT_MST   = INSERT INTO HGBT_PAT_ALERT_MST(HGNUM_PAT_ALERT_ID, GNUM_HOSPITAL_CODE,HGNUM_SLNO,HGSTR_ALERT_NAME, HGBSTR_DISEASE_CODE,GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,(SELECT max(HGNUM_SLNO)+1 FROM HGBT_PAT_ALERT_MST a WHERE a.HGNUM_PAT_ALERT_ID \= ? AND a.GNUM_HOSPITAL_CODE \= ?),?,?,?,?,sysdate)


DUPLICATE_CHECK_BEFORE_MODIFY_SAVE.HGBT_PAT_ALERT_MST =  select count(*) from HGBT_PAT_ALERT_MST where trim(upper(HGSTR_ALERT_NAME))=trim(upper(?)) AND (gnum_isvalid = 1 or  gnum_isvalid=2) AND GNUM_HOSPITAL_CODE =? AND HGNUM_PAT_ALERT_ID!=? 
											
SELECT.HGBT_PAT_ALERT_MST   = SELECT HGNUM_PAT_ALERT_ID AS patAlertId, HGSTR_ALERT_NAME AS alertName, GNUM_HOSPITAL_CODE AS hospitalCode, HGNUM_SLNO AS serialNo, HGBSTR_DISEASE_CODE as diseaseCode,gnum_isvalid AS isActive, GNUM_SEAT_ID AS seatID, to_char(gdt_entry_date,'dd-Mon-yyyy') AS entryDate, (SELECT HGBSTR_DISEASE FROM HGBT_ICD_DISEASE_MST B WHERE trim(upper(B.HGBSTR_DISEASE_CODE)) like trim(upper(a.HGBSTR_DISEASE_CODE)) AND B.GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE AND B.gnum_isvalid \=1 and B.HGNUM_RECORD_TYPE\=0) disease FROM HGBT_PAT_ALERT_MST a where HGNUM_PAT_ALERT_ID\=? and GNUM_HOSPITAL_CODE\=? and HGNUM_SLNO\=? \t

SELECT.GROUP_NAME_IN_FORMAT.HGBT_ICD_GROUP_MST	=	SELECT SUBSTR(HGBSTR_ICD_GROUP,1,40)||DECODE(SUBSTR(HGBSTR_ICD_GROUP,40,200),'',' ','..')||'('||HGBSTR_ICD_GROUP_CODE||')' FROM HGBT_ICD_GROUP_MST WHERE TRIM(HGBSTR_ICD_GROUP_CODE) LIKE TRIM(?) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?

SELECT.SUBGROUP_NAME_IN_FORMAT.HGBT_ICD_SUBGROUP_MST	=	SELECT SUBSTR(HGBSTR_ICD_SUBGROUP,1,40)||DECODE(SUBSTR(HGBSTR_ICD_SUBGROUP,40,125),'',' ','..')||'('||HGBSTR_ICD_SUBGRP_CODE||')' FROM HGBT_ICD_SUBGROUP_MST WHERE TRIM(HGBSTR_ICD_SUBGRP_CODE) LIKE TRIM(?) AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?

SELECT.DISEASE_NAME_IN_FORMAT.HGBT_ICD_DISEASE_MST	=	SELECT SUBSTR(HGBSTR_DISEASE,1,40)||DECODE(SUBSTR(HGBSTR_DISEASE,40,200),'',' ','..')||'('||HGBSTR_DISEASE_CODE||')' FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE) LIKE TRIM(?) AND HGNUM_RECORD_TYPE=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?


SELECT_ALL_CHART_NAME.HGBT_CHART_MST	=SELECT HGNUM_CHART_ID as chartId, GNUM_HOSPITAL_CODE AS hospitalCode, HGNUM_SLNO AS slNo, INITCAP(HGSTR_CHART_NAME) as chartName, HGSTR_CHART_DESC AS chartDescription, GNUM_ISVALID AS isValid, HGNUM_CHART_CATEGORY AS chartCategory, HGNUM_GENERATION_TYPE AS generationType, GNUM_SEAT_ID AS seatID, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, HGNUM_ISGRAPH AS isGraph  FROM HGBT_CHART_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? and HGNUM_GENERATION_TYPE \= ? ORDER BY HGSTR_CHART_NAME
	

SELECT.PARA_NAME.HGBT_CHART_PARA_MAPPING_MST = SELECT a.HGNUM_PARA_ID, b.HGSTR_PARA_NAME,a.HGNUM_DISPLAY_ORDER   FROM HGBT_CHART_PARA_MST a,HGBT_PARAMETER_MST b WHERE a.HGNUM_CHART_ID \= ? AND a.GNUM_HOSPITAL_CODE \= ? AND a.GNUM_ISVALID \= ? and a.HGNUM_PARA_ID \= b.HGNUM_PARA_ID AND a.GNUM_HOSPITAL_CODE \= b.GNUM_HOSPITAL_CODE AND a.GNUM_ISVALID \= b.GNUM_ISVALID ORDER BY HGNUM_DISPLAY_ORDER
	
SELECT.PARA_NAME_NOT_ADDED.HGBT_CHART_PARA_MAPPING_MST = SELECT HGNUM_PARA_ID as paraId, HGSTR_PARA_NAME as para  FROM HGBT_PARAMETER_MST a WHERE GNUM_HOSPITAL_CODE \= ?  AND GNUM_ISVALID \= ?  AND HGNUM_PARA_TYPE \= ? and HGNUM_PARA_ID not in (select HGNUM_PARA_ID from HGBT_CHART_PARA_MST where HGNUM_CHART_ID\=? and  GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  and  GNUM_ISVALID\=a.GNUM_ISVALID)  ORDER BY HGSTR_PARA_NAME
   								
INSERT.HGBT_CHART_PARA_MST	= insert into HGBT_CHART_PARA_MST (HGNUM_PARA_ID,HGNUM_CHART_ID, GNUM_HOSPITAL_CODE, HGNUM_SLNO, GNUM_ISVALID, HGNUM_PARA_TYPE,GNUM_SEAT_ID,HGNUM_DISPLAY_ORDER, GDT_ENTRY_DATE) values(?,?,?,(select nvl(max(HGNUM_SLNO),0)+1 from HGBT_CHART_PARA_MST  where HGNUM_CHART_ID\=? and GNUM_HOSPITAL_CODE\=?),?,?,?,?,sysdate)
								
UPDATE.DELETE.HGBT_CHART_PARA_MST	=	UPDATE HGBT_CHART_PARA_MST SET GNUM_ISVALID=?, GDT_LSTMOD_DATE=SYSDATE, GNUM_LSTMOD_SEATID=? WHERE HGNUM_CHART_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?

INSERT.HGBT_DISEASE_SITE_MST	=INSERT INTO HGBT_DISEASE_SITE_MST(HGNUM_DISEASE_SITE_ID, HGSTR_DISEASE_SITE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, HGBNUM_ICD_SITE_CODE, HGNUM_ICD_CODE_TYPE, GNUM_SEAT_ID, GDT_ENTRY_DATE,HGSTR_SUBGROUP_DISEASE_CODE) VALUES((SELECT NVL(MAX(HGNUM_DISEASE_SITE_ID),10)+1 FROM HGBT_DISEASE_SITE_MST WHERE GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,SYSDATE,?) 

CHECK_DUPLICATE.HGBT_DISEASE_SITE_MST	=	SELECT COUNT (*) FROM HGBT_DISEASE_SITE_MST WHERE UPPER (HGSTR_DISEASE_SITE) = UPPER (?) AND GNUM_HOSPITAL_CODE=? AND HGNUM_ICD_CODE_TYPE=? AND GNUM_ISVALID<>?    
CHECK_DUPLICATE.HGBT_DISEASE_SITE_MST.FOR_DEFINED	=	SELECT COUNT (*) FROM HGBT_DISEASE_SITE_MST WHERE GNUM_HOSPITAL_CODE=? AND HGNUM_ICD_CODE_TYPE=? AND GNUM_ISVALID<>? AND HGSTR_SUBGROUP_DISEASE_CODE=? AND (UPPER(HGSTR_DISEASE_SITE)=UPPER(?) OR HGBNUM_ICD_SITE_CODE=?)  

CHECK_DUPLICATE.MODIFY.HGBT_DISEASE_SITE_MST	=	SELECT COUNT (*) FROM HGBT_DISEASE_SITE_MST WHERE UPPER (HGSTR_DISEASE_SITE) = UPPER (?) AND GNUM_HOSPITAL_CODE=? AND HGNUM_ICD_CODE_TYPE=? AND GNUM_ISVALID<>? AND HGNUM_DISEASE_SITE_ID<>?    
CHECK_DUPLICATE.MODIFY.HGBT_DISEASE_SITE_MST.FOR_DEFINED	=	SELECT COUNT (*) FROM HGBT_DISEASE_SITE_MST WHERE GNUM_HOSPITAL_CODE=? AND HGNUM_ICD_CODE_TYPE=? AND GNUM_ISVALID<>? AND HGSTR_SUBGROUP_DISEASE_CODE=? AND (UPPER(HGSTR_DISEASE_SITE)=UPPER(?) OR HGBNUM_ICD_SITE_CODE=?) AND HGNUM_DISEASE_SITE_ID<>?    

SELECT.HGBT_DISEASE_SITE_MST	=SELECT X.HGNUM_DISEASE_SITE_ID AS diseaseSiteId, X.GNUM_HOSPITAL_CODE AS hospitalCode, X.HGSTR_DISEASE_SITE AS diseaseSite, X.GNUM_ISVALID AS isValid, X.HGBNUM_ICD_SITE_CODE AS icdSiteCode, X.HGNUM_ICD_CODE_TYPE AS icdCodeType, X.GNUM_SEAT_ID AS seatId, TO_CHAR(X.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, X.HGSTR_SUBGROUP_DISEASE_CODE AS icdSubgroupDiseaseCode, DECODE(X.HGNUM_ICD_CODE_TYPE,?,X.HGSTR_SUBGROUP_DISEASE_CODE,'') AS diseaseCode, DECODE(X.HGNUM_ICD_CODE_TYPE,?,(SELECT INITCAP(A.HGBSTR_DISEASE) || '('||A.HGBSTR_DISEASE_CODE ||')' FROM HGBT_ICD_DISEASE_MST A WHERE A.HGBSTR_DISEASE_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.HGNUM_RECORD_TYPE\=? AND A.GNUM_ISVALID\=?),'') AS disease, DECODE(X.HGNUM_ICD_CODE_TYPE,?,(SELECT A.HGBSTR_ICD_SUBGRP_CODE FROM HGBT_ICD_DISEASE_MST A WHERE A.HGBSTR_DISEASE_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.HGNUM_RECORD_TYPE\=? AND A.GNUM_ISVALID\=?),?,X.HGSTR_SUBGROUP_DISEASE_CODE,'') AS icdSubgroupCode, DECODE(X.HGNUM_ICD_CODE_TYPE,?,(SELECT INITCAP(A.HGBSTR_ICD_SUBGROUP) || '('||A.HGBSTR_ICD_SUBGRP_CODE ||')' FROM HGBT_ICD_SUBGROUP_MST A, HGBT_ICD_DISEASE_MST B WHERE A.HGBSTR_ICD_SUBGRP_CODE\=B.HGBSTR_ICD_SUBGRP_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=? AND B.HGBSTR_DISEASE_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND B.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND B.HGNUM_RECORD_TYPE\=?), ?,(SELECT INITCAP(A.HGBSTR_ICD_SUBGROUP) || '('||A.HGBSTR_ICD_SUBGRP_CODE ||')' FROM HGBT_ICD_SUBGROUP_MST A WHERE A.HGBSTR_ICD_SUBGRP_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND A.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=?),'') AS icdSubgroup, DECODE(X.HGNUM_ICD_CODE_TYPE,?,(SELECT A.HGBSTR_ICD_GROUP_CODE FROM HGBT_ICD_GROUP_MST A, HGBT_ICD_SUBGROUP_MST B, HGBT_ICD_DISEASE_MST C WHERE A.HGBSTR_ICD_GROUP_CODE\=B.HGBSTR_ICD_GROUP_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=? AND B.HGBSTR_ICD_SUBGRP_CODE\=C.HGBSTR_ICD_SUBGRP_CODE AND B.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE AND B.GNUM_ISVALID\=? AND C.HGBSTR_DISEASE_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND C.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND C.HGNUM_RECORD_TYPE\=? AND C.GNUM_ISVALID\=?),?,(SELECT A.HGBSTR_ICD_GROUP_CODE FROM HGBT_ICD_GROUP_MST A, HGBT_ICD_SUBGROUP_MST B WHERE A.HGBSTR_ICD_GROUP_CODE\=B.HGBSTR_ICD_GROUP_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=? AND B.HGBSTR_ICD_SUBGRP_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND B.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE ),'') AS icdGroupCode, DECODE(X.HGNUM_ICD_CODE_TYPE,?,(SELECT INITCAP(A.HGBSTR_ICD_GROUP)||' ('|| A.HGBSTR_ICD_GROUP_CODE||')' FROM HGBT_ICD_GROUP_MST A, HGBT_ICD_SUBGROUP_MST B, HGBT_ICD_DISEASE_MST C WHERE A.HGBSTR_ICD_GROUP_CODE\=B.HGBSTR_ICD_GROUP_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=? AND B.HGBSTR_ICD_SUBGRP_CODE\=C.HGBSTR_ICD_SUBGRP_CODE AND B.GNUM_HOSPITAL_CODE\=C.GNUM_HOSPITAL_CODE AND B.GNUM_ISVALID\=? AND C.HGBSTR_DISEASE_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND C.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND C.HGNUM_RECORD_TYPE\=? AND C.GNUM_ISVALID\=?),?,(SELECT INITCAP(A.HGBSTR_ICD_GROUP)||' ('|| A.HGBSTR_ICD_GROUP_CODE||')' FROM HGBT_ICD_GROUP_MST A, HGBT_ICD_SUBGROUP_MST B WHERE A.HGBSTR_ICD_GROUP_CODE\=B.HGBSTR_ICD_GROUP_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=? AND B.HGBSTR_ICD_SUBGRP_CODE\=X.HGSTR_SUBGROUP_DISEASE_CODE AND B.GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE ),'') AS icdGroup FROM HGBT_DISEASE_SITE_MST X WHERE X.HGNUM_DISEASE_SITE_ID\=? AND X.GNUM_HOSPITAL_CODE\=?

UPDATE.DELETE.HGBT_DISEASE_SITE_MST	=	UPDATE HGBT_DISEASE_SITE_MST SET GNUM_ISVALID=? WHERE HGNUM_DISEASE_SITE_ID=? AND GNUM_HOSPITAL_CODE=? 

UPDATE.RECORD.HGBT_DISEASE_SITE_MST	=	UPDATE HGBT_DISEASE_SITE_MST SET HGSTR_DISEASE_SITE=?, GNUM_ISVALID=?, HGBNUM_ICD_SITE_CODE=?, HGNUM_ICD_CODE_TYPE=?, GNUM_SEAT_ID=?, GDT_ENTRY_DATE=SYSDATE, HGSTR_SUBGROUP_DISEASE_CODE=? WHERE HGNUM_DISEASE_SITE_ID=? AND GNUM_HOSPITAL_CODE=? 

INSERT.MODIFY.HGBT_DISEASE_SITE_MST	=	INSERT INTO HGBT_DISEASE_SITE_MST(HGNUM_DISEASE_SITE_ID, HGSTR_DISEASE_SITE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, HGBNUM_ICD_SITE_CODE, HGNUM_ICD_CODE_TYPE, GNUM_SEAT_ID, GDT_ENTRY_DATE,HGSTR_SUBGROUP_DISEASE_CODE) VALUES(?,?,?,?,?,?,?,SYSDATE,?)
																			
DUPLICATE_CHECK_BEFORE_SAVE.HGBT_CHART_MST = select count(*) from HGBT_CHART_MST where trim(upper(HGSTR_CHART_NAME))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?

INSERT.HGBT_CHART_MST  		 = insert into HGBT_CHART_MST (HGNUM_CHART_ID, GNUM_HOSPITAL_CODE, HGSTR_CHART_NAME, HGNUM_SLNO, HGSTR_CHART_DESC, HGNUM_CHART_CATEGORY, HGNUM_GENERATION_TYPE,  HGSTR_BODY_QUERY, HGSTR_FOOTER_QUERY, HGNUM_ISGRAPH, GNUM_ISVALID, GNUM_SEAT_ID,GDT_ENTRY_DATE) values((select nvl(max(HGNUM_CHART_ID),10001)+1 from HGBT_CHART_MST where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,?,?,?,?,sysdate)

SELECT.HGBT_CHART_MST  =  			SELECT HGNUM_CHART_ID AS chartId,GNUM_HOSPITAL_CODE AS hospitalCode,HGNUM_SLNO AS slNo,HGSTR_CHART_NAME AS chartName, HGNUM_ISGRAPH AS isGraph,HGNUM_GENERATION_TYPE AS generationType,	HGNUM_CHART_CATEGORY AS chartCategory,HGSTR_BODY_QUERY AS bodyQuery,HGSTR_FOOTER_QUERY AS footerQuery, GNUM_ISVALID AS isValid, GNUM_SEAT_ID AS seatID, HGSTR_CHART_DESC AS chartDescription,  to_char(gdt_entry_date,'dd-Mon-yyyy') AS entryDate  FROM HGBT_CHART_MST where HGNUM_CHART_ID=? and GNUM_HOSPITAL_CODE=? and HGNUM_SLNO=? 

UPDATE.HGBT_CHART_MST   =   update HGBT_CHART_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=? where HGNUM_CHART_ID=?   and GNUM_HOSPITAL_CODE=? and  HGNUM_SLNO =?

MODIFY_INSERT.HGBT_CHART_MST  = INSERT INTO HGBT_CHART_MST(HGNUM_CHART_ID,GNUM_HOSPITAL_CODE,HGNUM_SLNO,HGSTR_CHART_NAME,HGSTR_CHART_DESC, HGNUM_ISGRAPH, HGNUM_GENERATION_TYPE, HGNUM_CHART_CATEGORY,\tHGSTR_BODY_QUERY, HGSTR_FOOTER_QUERY, GNUM_ISVALID,\t GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,(SELECT max(HGNUM_SLNO)+1 FROM HGBT_CHART_MST a WHERE a.HGNUM_CHART_ID \= ? AND a.GNUM_HOSPITAL_CODE \= ?),?,?,?,?,?,?,?,?,?,sysdate)
	   		                  					
DUPLICATE_CHECK_BEFORE_MODIFY_SAVE.HGBT_CHART_MST  =   select count(*) from HGBT_CHART_MST  where trim(upper(HGSTR_CHART_NAME))=trim(upper(?)) AND GNUM_ISVALID !=? AND GNUM_HOSPITAL_CODE =? AND HGNUM_CHART_ID!=?


INSERT.HGBT_CHART_UNIT_MAPPING   = INSERT INTO HGBT_CHART_UNIT_MAPPING (HGNUM_DEPTUNITCODE, HGNUM_CHART_ID, GNUM_ISVALID, HGNUM_ISDEFAULT, HGNUM_SLNO, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) VALUES (?,?,?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM  HGBT_CHART_UNIT_MAPPING \tWHERE  HGNUM_DEPTUNITCODE\=? AND  HGNUM_CHART_ID\=? AND GNUM_HOSPITAL_CODE\=? ),?,SYSDATE,?,SYSDATE,?)
											
UPDATE.HGBT_CHART_UNIT_MAPPING   =     UPDATE HGBT_CHART_UNIT_MAPPING set GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?

SELECT.HGBT_DEPT_ICD_MST   = SELECT a.hgbstr_disease_code AS diseaseCode,X.HGBSTR_ICD_SUBGRP_CODE as icdSubGroupCode, a.hgnum_deptunitcode AS departmentUnitCode, SUBSTR (x.hgbstr_disease, 1, 40) || DECODE (SUBSTR (x.hgbstr_disease, 40, 200), '', ' ', '..') || '(' || x.hgbstr_disease_code || ')' AS disease, SUBSTR (y.hgbstr_icd_subgroup, 1, 40)  || DECODE (SUBSTR (y.hgbstr_icd_subgroup, 40, 125), '', ' ', '..') || '('  || y.hgbstr_icd_subgrp_code  || ')' AS icdSubGroup, SUBSTR (z.hgbstr_icd_group, 1, 40) || DECODE (SUBSTR (z.hgbstr_icd_group, 40, 200), '', ' ', '..') || '(' || z.hgbstr_icd_group_code || ')' AS icdGroup,z.HGBSTR_ICD_GROUP_CODE AS icdGroupCode  FROM hgbt_dept_icd_mst a, hgbt_icd_disease_mst x, hgbt_icd_subgroup_mst y,hgbt_icd_group_mst z WHERE x.hgbstr_disease_code \= a.hgbstr_disease_code   AND y.hgbstr_icd_subgrp_code \=X.HGBSTR_ICD_SUBGRP_CODE   AND y.hgbstr_icd_group_code \= z.hgbstr_icd_group_code    AND a.hgnum_deptunitcode \= ?    AND a.gnum_hospital_code \= ?    AND a.gnum_isvalid \= ?
 								
SELECT.DISEASE_NOT_ADDED.HGBT_DEPT_ICD_MST    = SELECT hgbstr_disease_code AS diseaseCode, SUBSTR (hgbstr_disease, 1, 40) || DECODE (SUBSTR (hgbstr_disease, 40, 200), '', ' ', '..') || '(' || hgbstr_disease_code || ')' AS disease FROM hgbt_icd_disease_mst x WHERE GNUM_HOSPITAL_CODE \= ?  AND GNUM_ISVALID \= ?  AND upper(hgbstr_icd_subgrp_code) \= upper(?) AND hgnum_record_type \= ?  AND hgbstr_parent_code IS NULL  and hgbstr_disease_code not in (select HGBSTR_DISEASE_CODE from HGBT_DEPT_ICD_MST \twhere HGNUM_DEPTUNITCODE \=? AND GNUM_HOSPITAL_CODE\=x.GNUM_HOSPITAL_CODE  and  GNUM_ISVALID\=X.GNUM_ISVALID)  ORDER BY HGBSTR_DISEASE_CODE
												 

UPDATE.HGBT_DEPT_ICD_MST             =         UPDATE HGBT_DEPT_ICD_MST set GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?

#modifiedby NehaRajgariya Date:27July2016
INSERT.HGBT_DEPT_HOSDISEASE_MST   =      INSERT INTO HGBT_DEPT_HOSDISEASE_MST  (GNUM_DEPT_CODE,  HGNUM_DEPTUNITCODE, HGBSTR_HOSPITAL_DISEASE_CODE, HGNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE) VALUES ((select distinct gnum_dept_code FROM HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=?),?,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM  HGBT_DEPT_HOSDISEASE_MST	WHERE  HGNUM_DEPTUNITCODE=? AND  HGBSTR_HOSPITAL_DISEASE_CODE=? AND GNUM_HOSPITAL_CODE=? ),?,?,SYSDATE,?)


SELECT.HGBT_DEPT_HOSDISEASE_MST   = SELECT a.hgbstr_hospital_disease_code AS hospitaldiseasecode, a.hgnum_deptunitcode AS departmentunitcode, SUBSTR (x.hgbstr_disease_desc, 1, 40) || DECODE (SUBSTR (x.hgbstr_disease_desc, 40, 200), '', ' ', '..') || '(' || x.hgbstr_hospital_disease_code || ')' AS hospitalDisease   FROM hgbt_dept_hosdisease_mst a, hgbt_hospital_disease_mst x WHERE x.hgbstr_hospital_disease_code \= a.hgbstr_hospital_disease_code  AND a.hgnum_deptunitcode \= ?  AND a.gnum_hospital_code \= ?   AND a.gnum_isvalid \= ? order by x.hgbstr_disease_desc
 										
SELECT.HOSPITAL.DISEASE_NOT_ADDED.HGBT_DEPT_HOSDISEASE_MST  = SELECT x.HGBSTR_HOSPITAL_DISEASE_CODE AS hospitalDiseaseCode, SUBSTR (x.HGBSTR_DISEASE_DESC, 1, 40) || DECODE (SUBSTR (x.HGBSTR_DISEASE_DESC, 40, 200), '', ' ', '..') || '(' || HGBSTR_HOSPITAL_DISEASE_CODE || ')' AS hospitalDisease FROM HGBT_HOSPITAL_DISEASE_MST x WHERE x.GNUM_HOSPITAL_CODE \= ?  AND x.GNUM_ISVALID \= ?  AND x.HGBSTR_HOSPITAL_DISEASE_CODE not in (select HGBSTR_HOSPITAL_DISEASE_CODE from HGBT_DEPT_HOSDISEASE_MST \twhere HGNUM_DEPTUNITCODE \=? AND GNUM_HOSPITAL_CODE\=x.GNUM_HOSPITAL_CODE  and  GNUM_ISVALID\=X.GNUM_ISVALID)  ORDER BY x.HGBSTR_DISEASE_DESC
												 				
UPDATE.HGBT_DEPT_HOSDISEASE_MST   =     UPDATE HGBT_DEPT_HOSDISEASE_MST set GNUM_ISVALID=? WHERE HGNUM_DEPTUNITCODE=? AND GNUM_HOSPITAL_CODE=?

SELECT.PARA_LIST.PARA_TYPE.1	=	SELECT HGNUM_PARA_ID, INITCAP(HGSTR_PARA_NAME) FROM HGBT_PARAMETER_MST WHERE GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND HGNUM_PARA_TYPE=? ORDER BY INITCAP(HGSTR_PARA_NAME)

SELECT.PARA_LIST.PARA_TYPE.2.old	=SELECT X.GNUM_TEST_PARAMETER_CODE, INITCAP(Y.HGSTR_PARAMETER)||' ('|| SUBSTR(INITCAP(Z.GSTR_TEST_NAME),1,10)||'...)' AS paraName FROM HIVT_TEST_PARAMETER_DTL X, HIVT_PARAMETER_MST Y, GBLT_TEST_MST Z WHERE Y.HGNUM_PARAMETER_ID\=SUBSTR(X.GNUM_TEST_PARAMETER_CODE,5,8) AND X.GNUM_HOSPITAL_CODE\=Y.GNUM_HOSPITAL_CODE AND X.GNUM_ISVALID\=Y.GNUM_ISVALID AND Z.GNUM_TEST_CODE\=SUBSTR(X.GNUM_TEST_PARAMETER_CODE,1,4) AND X.GNUM_HOSPITAL_CODE\=Z.GNUM_HOSPITAL_CODE AND X.GNUM_ISVALID\=Z.GNUM_ISVALID AND X.GNUM_HOSPITAL_CODE\=? AND X.GNUM_ISVALID\=? ORDER BY paraName
	
SELECT.PARA_LIST.PARA_TYPE.2	=select distinct x.HGNUM_PARAMETER_ID as paraId, x.HGSTR_PARAMETER AS paraName from hivt_parameter_mst x, hivt_test_parameter_mst y where x.HGNUM_PARAMETER_ID\=y.GNUM_PARAMETER_CODE and X.GNUM_ISVALID\=y.GNUM_ISVALID and X.GNUM_ISVALID\=? ORDER BY paraName 

INSERT.HGBT_ICD_MAPPING_MST  = INSERT INTO HGBT_ICD_MAPPING_MST (HGBSTR_MAPPING_ID, HGBNUM_MAPPING_TYPE, HGBSTR_DISEASE_CODE, GNUM_SEAT_ID, GNUM_ISVALID, GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,HGNUM_SLNO) VALUES(?,?,?,?,?,SYSDATE,?,(SELECT NVL(MAX(HGNUM_SLNO),0)+1 FROM HGBT_ICD_MAPPING_MST WHERE HGBSTR_MAPPING_ID\=? AND HGBNUM_MAPPING_TYPE\=? AND HGBSTR_DISEASE_CODE\=? AND GNUM_HOSPITAL_CODE\=?))
									
SELECT.HGBT_ICD_MAPPING_MST  = SELECT A.HGBSTR_DISEASE_CODE AS diseaseCode, DECODE (a.hgbnum_mapping_type,'1',(SELECT x.hgbstr_disease_desc FROM hgbt_hospital_disease_mst x WHERE a.hgbstr_mapping_id \= x.hgbstr_hospital_disease_code  AND x.gnum_hospital_code \= a.gnum_hospital_code AND a.gnum_isvalid \= x.gnum_isvalid),'2', (SELECT y.hgstr_alert_name  FROM hgbt_pat_alert_mst y  WHERE a.hgbstr_mapping_id \= y.hgnum_pat_alert_id AND y.gnum_hospital_code \= a.gnum_hospital_code AND a.gnum_isvalid \= y.gnum_isvalid),  '') AS mappingID, A.HGBNUM_MAPPING_TYPE AS mappingType,  SUBSTR (x.hgbstr_disease, 1, 40) || DECODE (SUBSTR (x.hgbstr_disease, 40, 200), '', ' ', '..') || '(' || x.hgbstr_disease_code || ')' AS disease FROM HGBT_ICD_MAPPING_MST A, HGBT_HOSPITAL_DISEASE_MST B,HGBT_ICD_DISEASE_MST X WHERE  A.HGBSTR_MAPPING_ID \= ? AND A.HGBNUM_MAPPING_TYPE \= ? AND A.GNUM_HOSPITAL_CODE \= ?  AND A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE  AND A.GNUM_ISVALID\= ? AND A.GNUM_ISVALID\=B.GNUM_ISVALID AND x.hgbstr_disease_code \= a.hgbstr_disease_code AND X.HGNUM_RECORD_TYPE\=? order by x.hgbstr_disease_code
   								
SELECT.DISEASE_NOT_MAPPED.HGBT_ICD_MAPPING_MST  = SELECT hgbstr_disease_code AS diseaseCode, SUBSTR (hgbstr_disease, 1, 40) || DECODE (SUBSTR (hgbstr_disease, 40, 200), '', ' ', '..') || '(' || hgbstr_disease_code || ')' AS disease FROM hgbt_icd_disease_mst x WHERE GNUM_HOSPITAL_CODE \= ?  AND GNUM_ISVALID \= ?  AND hgbstr_icd_subgrp_code \= ? AND hgnum_record_type \= ?   and hgbstr_disease_code not in (select HGBSTR_DISEASE_CODE from HGBT_ICD_MAPPING_MST \twhere HGBNUM_MAPPING_TYPE \=? AND HGBSTR_MAPPING_ID\= ? AND GNUM_HOSPITAL_CODE\=x.GNUM_HOSPITAL_CODE  and  GNUM_ISVALID\=X.GNUM_ISVALID)  ORDER BY HGBSTR_DISEASE_CODE
													
UPDATE.HGBT_ICD_MAPPING_MST   =    UPDATE HGBT_ICD_MAPPING_MST set GNUM_ISVALID=? WHERE HGBSTR_MAPPING_ID=? AND HGBNUM_MAPPING_TYPE=? AND  GNUM_HOSPITAL_CODE=?


SELECT.INDEX_TERM.HGBT_ICD_INDEX_MST = SELECT HGNUM_INDEX_CODE , INITCAP(HGSTR_DIAGNOSTIC_TERM)  FROM   HGBT_ICD_INDEX_MST WHERE  GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? ORDER BY HGSTR_DIAGNOSTIC_TERM 

SELECT.PARENT_MODIFIER.HGBT_ICD_INDEX_LEVEL_MST = SELECT HGNUM_INDEX_MODIFIERID , INITCAP(HGSTR_MODIFIER)  FROM HGBT_ICD_INDEX_LEVEL_MST WHERE HGNUM_INDEX_CODE \= ? AND  HGNUM_MODIFIER_LEVEL \= (? - 1)\t\tAND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? ORDER BY HGSTR_MODIFIER\t\t\t\t\t\t\t\t\t\t

SELECT.SUBGROUP_BY_GROUP.HGBT_ICD_SUBGROUP_MST	=SELECT HGBSTR_ICD_SUBGRP_CODE AS ICDSUBGROUPCODE, INITCAP(HGBSTR_ICD_SUBGROUP) AS ICDSUBGROUPFULL, SUBSTR(HGBSTR_ICD_SUBGROUP,1,40)||DECODE(SUBSTR(HGBSTR_ICD_SUBGROUP,40,125),'',' ','..')||'('||HGBSTR_ICD_SUBGRP_CODE||')' AS ICDSUBGROUP, HGBSTR_ICD_GROUP_CODE AS ICDGROUPCODE, GNUM_SEAT_ID AS SEATID, GDT_ENTRY_DATE AS ENTRYDATE, GNUM_ISVALID AS ISVALID, GNUM_HOSPITAL_CODE AS HOSPITALCODE, HGBSTR_SUBGRP_PARENT_CODE AS SUBGROUPPARENTCODE, HGBNUM_LEVEL AS SUBGROUPLEVEL FROM HGBT_ICD_SUBGROUP_MST WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND HGBSTR_ICD_GROUP_CODE\=? ORDER BY ICDSUBGROUPCODE
												

SELECT.INSERT.CHECK.DUPLICATE.HGBT_ICD_INDEX_LEVEL_MST	=SELECT COUNT (1)\tFROM HGBT_ICD_INDEX_LEVEL_MST\tWHERE    HGNUM_INDEX_CODE\t|| '^'\t|| HGNUM_MODIFIER_LEVEL\t|| '^'\t|| UPPER (TRIM (HGSTR_MODIFIER))\t|| '^'\t|| HGNUM_PARENT_INDEXMODIFIE_CODE \=\t? || '^' || ? || '^' || UPPER (TRIM (?)) || '^' || ?\tAND GNUM_HOSPITAL_CODE \= ?\tAND GNUM_ISVALID \!\= 0\t\t\t\t\t\t\t\t\t\t\t\t\t

												
INSERT.RECORD.HGBT_ICD_INDEX_LEVEL_MST	=INSERT INTO hgbt_icd_index_level_mst\t(hgnum_index_code,\thgnum_index_modifierid,\thgnum_slno, hgnum_parent_indexmodifie_code, hgstr_modifier,\thgnum_modifier_level, hgstr_icd_disease_code, gnum_seat_id,\thgnum_iswith, gdt_entry_date, gnum_isvalid,\thgstr_dual_icd_disease_code, hgstr_remark, gnum_hospital_code\t)\tVALUES (?,\t(SELECT TO_NUMBER(?||?||(LPAD(NVL(MAX (SUBSTR (hgnum_index_modifierid, 8)),0) + 1, 3, 0 )))\tFROM hgbt_icd_index_level_mst\tWHERE gnum_hospital_code \= ?),\t1, ?, ?,\t?, ?, ?,\t?, SYSDATE, ?,\t?, ?, ?\t)





SELECT.MODIFY.HGBT_ICD_INDEX_LEVEL_MST	=SELECT HGNUM_INDEX_CODE AS indexCode,\tHGNUM_INDEX_MODIFIERID AS indexModifierID,\tHGNUM_MODIFIER_LEVEL AS modifierLevel, HGSTR_MODIFIER AS modifier,\tHGNUM_ISWITH AS isWith,\tHGNUM_PARENT_INDEXMODIFIE_CODE AS parentIndexModifierCode,\tHGSTR_ICD_DISEASE_CODE AS diseaseCode,\tDECODE (HGSTR_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_ICD_SUBGRP_CODE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS icdSubgroupCode,\tDECODE (HGSTR_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT B.HGBSTR_ICD_GROUP_CODE\tFROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B\tWHERE A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_ICD_SUBGRP_CODE \= B.HGBSTR_ICD_SUBGRP_CODE\tAND A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND B.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS icdGroupCode,\tHGSTR_DUAL_ICD_DISEASE_CODE AS dualDiseaseCode,\tDECODE (HGSTR_DUAL_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_ICD_SUBGRP_CODE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_DUAL_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS dualIcdSubGroupCode,\tDECODE (HGSTR_DUAL_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT B.HGBSTR_ICD_GROUP_CODE\tFROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B\tWHERE A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_ICD_SUBGRP_CODE \= B.HGBSTR_ICD_SUBGRP_CODE\tAND A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_DUAL_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND B.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS dualIcdGroupCode,\tGNUM_ISVALID AS isValid, HGSTR_REMARK AS remark\tFROM HGBT_ICD_INDEX_LEVEL_MST X\tWHERE HGNUM_INDEX_MODIFIERID \= ?\tAND HGNUM_SLNO \= ?\tAND GNUM_HOSPITAL_CODE \= ?

SELECT.UPDATE.CHECK.DUPLICATE.HGBT_ICD_INDEX_LEVEL_MST	=SELECT COUNT (1)\tFROM HGBT_ICD_INDEX_LEVEL_MST\tWHERE NOT (    HGNUM_INDEX_MODIFIERID \= ?\tAND HGNUM_SLNO \= ?\tAND GNUM_HOSPITAL_CODE \= ?\t)\tAND    HGNUM_INDEX_CODE\t|| '^'\t|| HGNUM_MODIFIER_LEVEL\t|| '^'\t|| UPPER (TRIM (HGSTR_MODIFIER))\t|| '^'\t|| HGNUM_PARENT_INDEXMODIFIE_CODE \=\t? || '^' || ? || '^' || UPPER (TRIM (?)) || '^' || ?\tAND GNUM_HOSPITAL_CODE \= ?\tAND GNUM_ISVALID \!\= 0
																									       
										       
UPDATE.MODIFY.HGBT_ICD_INDEX_LEVEL_MST	=UPDATE HGBT_ICD_INDEX_LEVEL_MST\tSET GDT_LSTMOD_DATE \= SYSDATE,\tGNUM_ISVALID \= ?,\tGNUM_LSTMOD_SEATID \= ?\tWHERE HGNUM_INDEX_MODIFIERID \= ? AND HGNUM_SLNO \= ?\tAND GNUM_HOSPITAL_CODE \= ?                        
											       

INSERT.MODIFY.HGBT_ICD_INDEX_LEVEL_MST	=INSERT INTO HGBT_ICD_INDEX_LEVEL_MST\t(HGNUM_INDEX_CODE, HGNUM_INDEX_MODIFIERID,\tHGNUM_SLNO,\tHGNUM_PARENT_INDEXMODIFIE_CODE, HGSTR_MODIFIER,\tHGNUM_MODIFIER_LEVEL, HGSTR_ICD_DISEASE_CODE, GNUM_SEAT_ID,\tHGNUM_ISWITH, GDT_ENTRY_DATE, GNUM_ISVALID,\tHGSTR_DUAL_ICD_DISEASE_CODE, HGSTR_REMARK, GNUM_HOSPITAL_CODE\t)\tVALUES (?, ?,\t(SELECT NVL (MAX (HGNUM_SLNO), 1) + 1\tFROM HGBT_ICD_INDEX_LEVEL_MST\tWHERE HGNUM_INDEX_MODIFIERID \= ? AND GNUM_HOSPITAL_CODE \= ?),\t?, ?,\t?, ?, ?,\t?, SYSDATE, ?,\t?, ?, ?\t)

SELECT.VIEW.HGBT_ICD_INDEX_LEVEL_MST	=SELECT DECODE (HGNUM_INDEX_CODE,\tNULL, '',\t(SELECT C.HGSTR_DIAGNOSTIC_TERM\tFROM HGBT_ICD_INDEX_MST C\tWHERE C.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND C.HGNUM_INDEX_CODE \= X.HGNUM_INDEX_CODE\tAND C.GNUM_ISVALID \= 1)\t) AS INDEXCODE,\tHGNUM_INDEX_MODIFIERID AS INDEXMODIFIERID,\tHGNUM_MODIFIER_LEVEL AS MODIFIERLEVEL, HGSTR_MODIFIER AS MODIFIER,\tHGNUM_ISWITH AS ISWITH,\tDECODE (HGNUM_PARENT_INDEXMODIFIE_CODE,\tNULL, '',\tINITCAP (X.HGSTR_MODIFIER)\t) AS PARENTINDEXMODIFIERCODE,\tDECODE (HGSTR_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_DISEASE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0) || ' ('||TRIM(X.HGSTR_ICD_DISEASE_CODE)||')'\t) AS DISEASECODE,\tDECODE (HGSTR_DUAL_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_DISEASE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_DUAL_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0) || ' ('||TRIM(X.HGSTR_ICD_DISEASE_CODE)||')'\t) AS DUALDISEASECODE,\tGNUM_ISVALID AS ISVALID, HGSTR_REMARK AS REMARK\tFROM HGBT_ICD_INDEX_LEVEL_MST X\tWHERE HGNUM_INDEX_MODIFIERID \= ? AND HGNUM_SLNO \= ?\tAND GNUM_HOSPITAL_CODE \= ?\t

/*-----------------------------------------ICD Cross Reference Master-----------------------------------------------*/\t\t\t\t\t\t\t\t
									            
									            
									            
SELECT.INSERT.CHECK.DUPLICATE.RECORD.HGBT_ICD_INDEX_MST= SELECT COUNT (1)\tFROM HGBT_ICD_INDEX_MST\tWHERE UPPER (TRIM (HGSTR_DIAGNOSTIC_TERM))\tLIKE UPPER (TRIM (?)) AND GNUM_HOSPITAL_CODE \= ?\tAND GNUM_ISVALID <> 0
															   
															   
															   
INSERT.RECORD.HGBT_ICD_INDEX_MST =INSERT INTO hgbt_icd_index_mst\t(hgnum_index_code,\thgstr_diagnostic_term, hgnum_slno, \thgstr_hospital_synonym, hgstr_icd_disease_code, gnum_seat_id,\thgstr_dual_icd_disease_code, gdt_entry_date, gnum_isvalid,\thgstr_remark, gnum_hospital_code\t)\tVALUES ((Select NVL(MAX(hgnum_index_code)+1,'100000') from hgbt_icd_index_mst WHERE gnum_hospital_code\=?), ?,1,?, ?,?,?, SYSDATE,?,?,?)
										             
										            														   
															   
															   
SELECT.MODIFY.RECORD.HGBT_ICD_INDEX_MST = SELECT  x.HGNUM_INDEX_CODE, x.HGSTR_DIAGNOSTIC_TERM AS diagnosticTerm, x.HGSTR_HOSPITAL_SYNONYM AS hospitalSynonym, x.HGSTR_ICD_DISEASE_CODE AS diseaseCode,  DECODE (x.HGSTR_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_ICD_SUBGRP_CODE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS icdSubgroupCode,\tDECODE (x.HGSTR_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT B.HGBSTR_ICD_GROUP_CODE\tFROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B\tWHERE A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_ICD_SUBGRP_CODE \= B.HGBSTR_ICD_SUBGRP_CODE\tAND A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND B.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS icdGroupCode,\tx.HGSTR_DUAL_ICD_DISEASE_CODE AS strDualDiseaseCode, DECODE (x.HGSTR_DUAL_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT A.HGBSTR_ICD_SUBGRP_CODE\tFROM HGBT_ICD_DISEASE_MST A\tWHERE A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_DUAL_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS strDualSubGroupCode,\tDECODE (x.HGSTR_DUAL_ICD_DISEASE_CODE,\tNULL, '',\t(SELECT B.HGBSTR_ICD_GROUP_CODE\tFROM HGBT_ICD_DISEASE_MST A, HGBT_ICD_SUBGROUP_MST B\tWHERE A.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_ICD_SUBGRP_CODE \= B.HGBSTR_ICD_SUBGRP_CODE\tAND A.GNUM_HOSPITAL_CODE \= X.GNUM_HOSPITAL_CODE\tAND A.HGBSTR_DISEASE_CODE \= X.HGSTR_DUAL_ICD_DISEASE_CODE\tAND A.GNUM_ISVALID \= 1\tAND B.GNUM_ISVALID \= 1\tAND A.HGNUM_RECORD_TYPE \= 0)\t) AS strDualGroupCode,\tx.GNUM_ISVALID AS isValid, x.HGSTR_REMARK AS strRemark\tFROM HGBT_ICD_INDEX_MST X\tWHERE x.HGNUM_INDEX_CODE \= ?\tAND x.HGNUM_SLNO \= ?\tAND x.GNUM_HOSPITAL_CODE \= ?\t\t
											   
											   
INSERT.MODIFY.RECORD.HGBT_ICD_INDEX_MST =INSERT INTO HGBT_ICD_INDEX_MST\t(HGNUM_INDEX_CODE, HGSTR_DIAGNOSTIC_TERM, HGNUM_SLNO,\tHGSTR_HOSPITAL_SYNONYM, HGSTR_ICD_DISEASE_CODE, GNUM_SEAT_ID,\tHGSTR_DUAL_ICD_DISEASE_CODE, GDT_ENTRY_DATE, GNUM_ISVALID, \tHGSTR_REMARK, GNUM_HOSPITAL_CODE\t)\tVALUES (?,?,(SELECT NVL (MAX (HGNUM_SLNO), 1) + 1\tFROM HGBT_ICD_INDEX_MST a\tWHERE a.HGNUM_INDEX_CODE \= ? AND a.GNUM_HOSPITAL_CODE \= ?),\t?, ?,\t?, ?, SYSDATE,\t?, ?,? )
										   
											   
											   
											   
											   
UPDATE.MODIFY.RECORD.HGBT_ICD_INDEX_MST =UPDATE HGBT_ICD_INDEX_MST\tSET  GNUM_ISVALID \= ?, GDT_LSTMOD_DATE \= SYSDATE,\tGNUM_LSTMOD_SEATID \= ?\tWHERE HGNUM_INDEX_CODE \= ? AND HGNUM_SLNO \= ?\tAND GNUM_HOSPITAL_CODE \= ?               \t\t\t\t\t\t\t\t\t\t   
											   
											   
											   
											   
SELECT.UPDATE.CHECK.DUPLICATE.RECORD.HGBT_ICD_INDEX_MST = SELECT COUNT (1)\tFROM HGBT_ICD_INDEX_MST\tWHERE  HGNUM_INDEX_CODE <> ?\tAND UPPER (TRIM (HGSTR_DIAGNOSTIC_TERM)) LIKE UPPER(TRIM(?))\tAND GNUM_HOSPITAL_CODE \= ?\tAND GNUM_ISVALID <> 0\t\t\t\t\t\t\t\t\t\t   
											   											   
	
SELECT.SEE.TERMS.HGBT_ICD_INDEX_MST = SELECT HGNUM_SEE_TERM_CODE As seeTermCode,HGSTR_SEE_TERM As seeTerm, HGNUM_SEE_ALSO_TERM_CODE As seeAlsoTermCode, HGSTR_SEEALSO_TERM As seeAlsoTerm , HGNUM_SEE_INDEX_MODIFIERID As seeIndexModifierId,\tHGNUM_SEEALSO_INDEX_MODIFIERID As seeAlsoIndexModifierId\tFROM HGBT_ICD_INDEX_MST WHERE HGNUM_INDEX_CODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? 
	
	
SELECT.SEE.TERMS.MOD.HGBT_ICD_INDEX_LEVEL_MST = SELECT HGNUM_SEE_TERM_CODE As seeTermCode,HGSTR_SEE_TERM As seeTerm, HGNUM_SEE_ALSO_TERM_CODE As seeAlsoTermCode, HGSTR_SEEALSO_TERM As seeAlsoTerm, HGNUM_SEE_INDEX_MODIFIERID As seeIndexModifierId,\tHGNUM_SEEALSO_INDEX_MODIFIERID As seeAlsoIndexModifierId\tFROM HGBT_ICD_INDEX_LEVEL_MST WHERE HGNUM_INDEX_MODIFIERID \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? \t
	
	
	
SELECT.MODIFIER1.HGBT_ICD_INDEX_LEVEL_MST = SELECT HGNUM_INDEX_MODIFIERID , INITCAP(HGSTR_MODIFIER)  FROM HGBT_ICD_INDEX_LEVEL_MST WHERE HGNUM_INDEX_CODE \= ? AND  HGNUM_MODIFIER_LEVEL \= 1\t\tAND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? ORDER BY HGSTR_MODIFIER\t
													  
													  									
SELECT.SUB_MODIFIER_OF_LEVEL.HGBT_ICD_INDEX_LEVEL_MST=SELECT HGNUM_INDEX_MODIFIERID ,INITCAP(HGSTR_MODIFIER)  FROM HGBT_ICD_INDEX_LEVEL_MST WHERE HGNUM_PARENT_INDEXMODIFIE_CODE \= ? AND  HGNUM_MODIFIER_LEVEL \= ?\t\tAND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? ORDER BY HGSTR_MODIFIER\t\t
													  
UPDATE.SEE.HGBT_ICD_INDEX_MST = UPDATE HGBT_ICD_INDEX_MST    SET HGSTR_SEE_TERM \= ? ,    HGNUM_SEE_TERM_CODE \= ?,\tHGNUM_SEE_INDEX_MODIFIERID \= ?    WHERE  HGNUM_INDEX_CODE \= ?    AND GNUM_ISVALID \= ?\tAND GNUM_HOSPITAL_CODE \= ?
		                                        
		                                        
UPDATE.SEE.HGBT_ICD_INDEX_LEVEL_MST = UPDATE HGBT_ICD_INDEX_LEVEL_MST    SET HGSTR_SEE_TERM \= ? ,    HGNUM_SEE_TERM_CODE \= ?,    HGNUM_SEE_INDEX_MODIFIERID \= ?    WHERE HGNUM_INDEX_MODIFIERID \= ?    AND GNUM_ISVALID \= ?    AND GNUM_HOSPITAL_CODE \= ?
				                                        
UPDATE.SEE.ALSO.HGBT_ICD_INDEX_MST = UPDATE HGBT_ICD_INDEX_MST    SET HGSTR_SEEALSO_TERM \= ? ,    HGNUM_SEE_ALSO_TERM_CODE \= ?,\tHGNUM_SEEALSO_INDEX_MODIFIERID \= ?    WHERE  HGNUM_INDEX_CODE \= ?    AND GNUM_ISVALID \= ?\tAND GNUM_HOSPITAL_CODE \= ?
		                                        
		                                        
UPDATE.SEE.ALSO.HGBT_ICD_INDEX_LEVEL_MST = UPDATE HGBT_ICD_INDEX_LEVEL_MST    SET HGSTR_SEEALSO_TERM \= ? ,    HGNUM_SEE_ALSO_TERM_CODE \= ?,    HGNUM_SEEALSO_INDEX_MODIFIERID \= ?    WHERE HGNUM_INDEX_MODIFIERID \= ?    AND GNUM_ISVALID \= ?    AND GNUM_HOSPITAL_CODE \= ?
				                                 
DUPLICATE_CHECK_BEFORE_SAVE.HGBT_HOSPITAL_DISEASE_MST   = select count(*) from hgbt_hospital_disease_mst where trim(upper(HGBSTR_DISEASE_DESC))\=trim(upper(?)) and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? 

INSERT.HGBT_HOSPITAL_DISEASE_MST = INSERT INTO HGBT_HOSPITAL_DISEASE_MST (HGBSTR_HOSPITAL_DISEASE_CODE, HGBSTR_DISEASE_DESC,HGBNUM_DISEASE_TYPE_CODE,HGBSTR_DISEASE_REMARK,GNUM_ISVALID, GNUM_SEAT_ID,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE, GSTR_IP_ADD) values ((SELECT  concat('H',NVL(MAX(SUBSTR(HGBSTR_HOSPITAL_DISEASE_CODE,2)),'10000')+1) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=100), ?,?,?,?,?,SYSDATE,?,?)
								   
INSERT_MAP_ICD.HGBT_DISEASE_MAPPING_MST	=INSERT INTO HGBT_DISEASE_MAPPING_MST (HGBSTR_DISEASE_CODE_FRM, GNUM_CODIFICATION_ID_FRM,GNUM_CODIFICATION_ID_TO,GNUM_ISVALID, GNUM_SEAT_ID,HGBSTR_DISEASE_CODE_TO,HGNUM_MAPPING_SEQ_NO,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GSTR_IP_ADD, HGBSTR_DISEASE_NAME_FRM,HGBSTR_DISEASE_NAME_TO) values ((SELECT HGBSTR_HOSPITAL_DISEASE_CODE FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND trim(upper(HGBSTR_DISEASE_DESC))\=trim(upper(?)) AND GNUM_ISVALID \= 1 ), 1,0,?,?,trim(?),(SELECT NVL(MAX(HGNUM_MAPPING_SEQ_NO),0)+1 FROM HGBT_DISEASE_MAPPING_MST WHERE GNUM_HOSPITAL_CODE\=100), SYSDATE,?,?,?,?)
INSERT_MAP_SNOMED.HGBT_DISEASE_MAPPING_MST	=INSERT INTO HGBT_DISEASE_MAPPING_MST (HGBSTR_DISEASE_CODE_FRM, GNUM_CODIFICATION_ID_FRM,GNUM_CODIFICATION_ID_TO,GNUM_ISVALID, GNUM_SEAT_ID,HGBSTR_DISEASE_CODE_TO,HGNUM_MAPPING_SEQ_NO,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GSTR_IP_ADD, HGBSTR_DISEASE_NAME_FRM,HGBSTR_DISEASE_NAME_TO) values ((SELECT HGBSTR_HOSPITAL_DISEASE_CODE FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND trim(upper(HGBSTR_DISEASE_DESC))\=trim(upper(?)) AND GNUM_ISVALID \= 1 ), 1,3,?,?,trim(?),(SELECT NVL(MAX(HGNUM_MAPPING_SEQ_NO),0)+1 FROM HGBT_DISEASE_MAPPING_MST WHERE GNUM_HOSPITAL_CODE\=100 ), SYSDATE,?,?,?,?)
 											
SELECT.HGBT_HOSPITAL_DISEASE_MST   = SELECT HGBSTR_HOSPITAL_DISEASE_CODE AS diseaseID, HGBSTR_DISEASE_DESC AS diseaseName, HGBSTR_DISEASE_REMARK remarks, HGBNUM_DISEASE_TYPE_CODE as diseaseType FROM HGBT_HOSPITAL_DISEASE_MST a where HGBSTR_HOSPITAL_DISEASE_CODE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?
										
UPDATE.HGBT_HOSPITAL_DISEASE_MST =	update HGBT_HOSPITAL_DISEASE_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HGBSTR_HOSPITAL_DISEASE_CODE=?  and GNUM_HOSPITAL_CODE=?

UPDATE.HGBT_DISEASE_MAPPING_MST =	update HGBT_DISEASE_MAPPING_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HGBSTR_DISEASE_CODE_FRM=?  and GNUM_HOSPITAL_CODE=?

DUPLICATE_CHECK_BEFORE_MODIFY_SAVE.HGBT_HOSPITAL_DISEASE_MST =  select count(*) from HGBT_HOSPITAL_DISEASE_MST where trim(upper(HGBSTR_DISEASE_DESC))=trim(upper(?)) AND gnum_isvalid = 1 AND GNUM_HOSPITAL_CODE =? AND HGBSTR_HOSPITAL_DISEASE_CODE!=?

DUPLICATE_CHECK_BEFORE_SAVE.HGBT_DISEASE_MAPPING_MST = SELECT count(*) FROM HGBT_DISEASE_MAPPING_MST A WHERE A.GNUM_CODIFICATION_ID_FRM\= 0 AND A.GNUM_CODIFICATION_ID_TO\=3 AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND trim(hgbstr_disease_code_frm) \= trim(?) AND trim(hgbstr_disease_code_to) \= trim(?)


INSERT_ICD_SNOMED.HGBT_DISEASE_MAPPING_MST = INSERT INTO HGBT_DISEASE_MAPPING_MST (HGBSTR_DISEASE_CODE_FRM, GNUM_CODIFICATION_ID_FRM,GNUM_CODIFICATION_ID_TO,GNUM_ISVALID, GNUM_SEAT_ID,HGBSTR_DISEASE_CODE_TO,HGNUM_MAPPING_SEQ_NO,GDT_ENTRY_DATE,GNUM_HOSPITAL_CODE,GSTR_IP_ADD, HGBSTR_DISEASE_NAME_FRM,HGBSTR_DISEASE_NAME_TO) values (trim(?), 0,3,?,?,trim(?),(SELECT NVL(MAX(HGNUM_MAPPING_SEQ_NO),0)+1 FROM HGBT_DISEASE_MAPPING_MST WHERE GNUM_HOSPITAL_CODE\=100 ), SYSDATE,?,?,?,?)
 											
SELECT.HGBT_DISEASE_MAPPING_MST = SELECT HGBSTR_DISEASE_NAME_FRM AS icdName,HGBSTR_DISEASE_NAME_TO AS conceptName FROM  HGBT_DISEASE_MAPPING_MST WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND HGNUM_MAPPING_SEQ_NO \= ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

#added by sandip naik on 20/06/2017 to fetch template list

SELECT_Template_List= select hgnum_template_id,hgstr_template_name  from hgbt_template_mst where gnum_isvalid=? and gnum_hospital_code=? 
#added by sandip naik on 27/06/2017 to save data
INSERT_HGBT_SYMPTOM_TEMPLATE_MST=INSERT INTO HGBT_SYMPTOM_TEMPLATE_MST(SCTSTR_ID_SYMPTOM,SCTSTR_PTERM_SYMPTOM,HGNUM_TEMPLATE_ID,HGNUM_S_NO,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE,GNUM_ISVALID)VALUES(?,?,?,?,?,?,?)
#added by sandip naik on 27/06/2017 to get details
#SELECT_SELECTED_TEMPLATE_LIST=select b.hgnum_template_id,b.hgstr_template_name from hgbt_template_mst b,hgbt_symptom_template_mst a where b.hgnum_template_id=a.hgnum_template_id and b.gnum_hospital_code=a.gnum_hospital_code and a.hgnum_template_id IN(select hgnum_template_id from hgbt_symptom_template_mst where gnum_hospital_code=? and hgnum_template_id=? and gnum_isvalid=?)
SELECT_SELECTED_TEMPLATE_LIST=select b.hgnum_template_id,b.hgstr_template_name from hgbt_template_mst b,hgbt_symptom_template_mst a where b.hgnum_template_id=a.hgnum_template_id and b.gnum_hospital_code=? and a.hgnum_template_id =? and a.sctstr_id_symptom=? and b.gnum_isvalid=?
#added by sandip naik on 27/06/2017 to get details
SELECT_REMAINING_TEMPLATE_LIST=select distinct b.hgnum_template_id,b.hgstr_template_name from hgbt_template_mst b,hgbt_symptom_template_mst a where b.hgnum_template_id=a.hgnum_template_id and b.gnum_hospital_code=a.gnum_hospital_code and b.hgnum_template_id NOT IN(select hgnum_template_id from hgbt_template_mst where gnum_hospital_code=? and hgnum_template_id=? and gnum_isvalid=?)
#added by sandip naik on 27/06/2017 to get details
SELECT.SYMPTOMTYPE.HGBT_SYMPTOM_TEMPLATE_MST=select sctstr_pterm_symptom from hgbt_symptom_template_mst where sctstr_id_symptom=? and gnum_hospital_code=? and gnum_isvalid=?
#added by sandip naik on 27/06/2017 to update details
UPDATE.HGBT_SYMPTOM_TEMPLATE_MST=update hgbt_symptom_template_mst set gnum_isvalid=? where sctstr_id_symptom=? and gnum_hospital_code=?

#Added By Shweta on 12-03-2019 to get the clinical Section Names and code
SELECT_Clinical_Section_List=select gnum_clinical_section_code,initcap(gstr_clinical_section) from ehrts_clinical_section_mst where gnum_isvalid=?

#get the interface type and code
SELECT_INTERFACE_TYPE_LIST=select gnum_interface_type_code,initcap(gstr_interface_type) from ehrts_interface_type_mst where gnum_isvalid=?

#Added by Shweta(13-3-2019)
DUPLICATE_CHECK_BEFORE_SAVE.EHRTS_SECTION_TEMPLATES_MST = select count(*) from EHRTS_SECTION_INTERFACES_MST where gnum_clinical_section_code=? and gnum_section_interface_id=? and gstr_section_interface_key=?
INSERT_EHRTS_SECTION_TEMPLATES_MST=insert into ehrts_section_interfaces_mst (gnum_clinical_section_code, gnum_section_interface_id, gstr_section_interface,gstr_section_interface_desc, gnum_section_interface_type, gnum_section_interface_def_position, gnum_parent_section_code,gstr_section_interface_key,gstr_section_interface_content) values(?,?,?,?,?,?,?,?,?)
SELECT.EHRTS_SECTION_INTERFACES_MST = SELECT B.GSTR_CLINICAL_SECTION AS clinicalSection,C.GSTR_INTERFACE_TYPE as interfaceType,A.GSTR_SECTION_INTERFACE AS interfaceName, GSTR_SECTION_INTERFACE_KEY AS keyCode,  GSTR_SECTION_INTERFACE_DESC AS desc, A.GNUM_CLINICAL_SECTION_CODE AS clinicalSectionCode,A.GNUM_SECTION_INTERFACE_ID AS interfaceId from ehrts_section_interfaces_mst a,ehrts_clinical_section_mst b,ehrts_interface_type_mst c where a.GNUM_CLINICAL_SECTION_CODE=B.GNUM_CLINICAL_SECTION_CODE and A.GNUM_ISVALID=? and a.gnum_section_interface_id=c.gnum_interface_type_code and a.GNUM_CLINICAL_SECTION_CODE=?;
DUPLICATE_CHECK_BEFORE_MODIFY_SAVE.ehrts_section_interfaces_mst = select count(*) from ehrts_section_interfaces_mst where GSTR_SECTION_INTERFACE=? and gnum_isvalid=? and  gstr_section_interface_content=? 
UPDATE.ehrts_section_interfaces_mst  =  update ehrts_section_interfaces_mst set GSTR_SECTION_INTERFACE=?,GSTR_SECTION_INTERFACE_KEY=?,GSTR_SECTION_INTERFACE_DESC=?,gstr_section_interface_content=? where GNUM_CLINICAL_SECTION_CODE=? AND GNUM_SECTION_INTERFACE_ID=?

#Added by Vasu on 27.Dec.2019
SELECT.FILENO.HOPT_IMAGE_MST = select hopstr_file_name from hopt_image_mst where UPPER(hopstr_image_name) like UPPER(?) and hopnum_image_code = (select max(hopnum_image_code) from hopt_image_mst  where UPPER(hopstr_image_name) like UPPER(?))
