/*** Property File for Investigation Transactions***/

/** Requsition Status -READY_APPOINTMENT\=1 READY_SAMPLECOLLECTION \=2 READY_PLISTGENERATION  \= 3 READY_SAMPLEACCEPTANCE \= 4 READY_PATIENTACCEPTANCE \=5 READY_RESULTENTRY \=6


SELECT.PATIENT_DTLS.HRGT_PATIENT_DTL=SELECT a.hrgnum_puk AS patCRNo, initcap(a.hrgstr_fname) AS patFirstName, NVL(initcap(a.hrgstr_mname),' ')  AS patMiddleName, NVL(initcap(a.hrgstr_lname),' ') AS patLastName, initcap(a.hrgstr_father_name) AS patGuardianName, a.hgnum_pat_status_code AS patStatusCode, hgnum_patient_cat_code AS patCategoryCode, pkg_reg_util.DOB_AGE_ON(a.hrgdt_dob,'') AS patAge, initcap(a.hrgstr_spousename) AS patHusbandName, gstr_gender_code AS patGenderCode, pkg_clinical_util_fun.get_pat_category_name(?,a.hgnum_patient_cat_code) AS patCategory,NVL(TO_CHAR(hrgdt_dob,'dd-Mon-yyyy'),'') as patDOB, NVL(hrgbl_is_actual_dob,0) as isActualDob, pkg_clinical_util_fun.get_gender_name(gstr_gender_code) AS patGender, DECODE (hgnum_pat_status_code, 3, 'Emergency', 2, 'IPD', 1, 'OPD',4,'Special' ) AS patStatus ,NVL(hrgstr_mobile_no,'') as patMobileNo,NVL(hrgstr_address_line1,' ')||' '||NVL(hrgstr_sub_locality1,' ')||' '||NVL(hrgstr_city_location,' ')||' '||NVL(hrgstr_city,' ')||' '||NVL(hrgstr_district,' ')||' '||NVL(hrgstr_state_name,' ')||' '||NVL(gstr_country_name,' ') as patAddress, DECODE (SIGN (DATE_PART('day',TO_DATE (to_CHAR(hrgdt_primarycat_validupto\:\:timestamp,'DD-MM-YYYY'), 'DD-MM-YYYY') -TO_DATE (TO_CHAR(SYSDATE,'DD-MM-YYYY'), 'DD-MM-YYYY')) ), 1, 0, -1, 1, 0) isCatExpired,NVL(hrgstr_email_id,'-') as patEmailId FROM hrgt_patient_dtl a WHERE gnum_isvalid\=1 and hrgnum_puk \= ?   

      
 /**Query To get the Lab Test . Used for searching **/  
 // For Investigation Raising Test Code Wise Searching
    
/* SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST\=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,             GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,      (select hgnum_group_code from hivt_test_group_info_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code and gnum_lab_code\=a.gnum_labcode and gnum_hospital_code\=a.gnum_hospital_code) as TestGroupCode ,         (select  (select hgstr_group_name from hivt_test_group_mst where gnum_isvalid\=1 and hgnum_group_code\=b.hgnum_group_code and gnum_hospital_code \=a.gnum_hospital_code) from hivt_test_group_info_mst b where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code and gnum_lab_code\=a.gnum_labcode and gnum_hospital_code\=a.gnum_hospital_code) as SearchTestGroup             FROM hivt_laboratory_test_mst a       WHERE a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'        AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?      ORDER BY labname, testname\t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t    
                  

SELECT.LAB_WISE_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LABCODE ) as sampleNoConfig, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,gstr_desk_properties as deskProperties, NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,  CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||   (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k  where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,    CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo    FROM hivt_laboratory_test_mst a      WHERE a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \=?   AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=? AND gnum_numof_test >\= (Select count(*) from hivt_requisition_dtl where GNUM_LAB_CODE \= a.GNUM_LABCODE and gnum_test_code \= a.gnum_test_code and     gnum_hospital_code \= a.gnum_hospital_code and HIVT_ENTRY_DATE \= sysdate)       \t\t\t   

                                        
                                        
SELECT.PATIENT_ADMISSION_DTLS.HIPT_PATADMISSION_DTL= SELECT hrgnum_puk as patcrno,to_char(hipdt_admdatetime,'dd-Mon-yyyy') as admissionDate,gnum_deptunit_code as patdeptunitcode, hrgnum_visit_no as patvisitno, hrgnum_episode_code as  patepisodecode ,hpad.gnum_dept_code AS admitteddepartmentcode, hpad.hipnum_admno AS patadmissionno, pkg_clinical_util_fun.get_deptunit_name(hpad.gnum_hospital_code,hpad.gnum_deptunit_code) AS patdeptunit, pkg_clinical_util_fun.get_dept_name(hpad.gnum_hospital_code,hpad.gnum_dept_code) AS admitteddepartmentname,  hpad.hipnum_ward_code AS patwardcode, hpad.gnum_dept_code AS admitteddepartmentcode,(SELECT INITCAP(hipstr_ward_name) FROM hipt_ward_mst hwm WHERE gnum_isvalid \=1 and hipnum_ward_code \= hpad.hipnum_ward_code and GNUM_HOSPITAL_CODE\=hpad.GNUM_HOSPITAL_CODE) as patwardname, hpad.hipnum_room_code AS patroomno,(SELECT INITCAP(hipstr_room_desc) FROM hipt_room_config_mst  WHERE gnum_isvalid\=1 and hipnum_room_no \= hpad.hipnum_room_code and GNUM_HOSPITAL_CODE\=hpad.GNUM_HOSPITAL_CODE) as patroomname,hpad.hipnum_bed_code bedcode,ipd_mst.GETBEDNAME(hpad.hipnum_bed_code,gnum_hospital_code) AS bedname, gnum_hospital_code as hospitalcode,(SELECT INITCAP(str_emp_full_name) FROM PIST_EMP_registration_DTL WHERE gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= hpad.gnum_hospital_code  AND STR_EMP_NO \= hpad.hIPNUM_CONSULTANT_ID ) consultantName, (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no\=hpad.hrgnum_visit_no and hrgnum_episode_code \=hpad.hrgnum_episode_code  and  hrgnum_puk\=hpad.hrgnum_puk   and GNUM_HOSPITAL_CODE \= hpad.GNUM_HOSPITAL_CODE)  as patmlcno, NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''|| diagnosticTypeName ||'')'' FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM (HGBSTR_HOSPITAL_DISEASE_CODE)  \=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName  FROM HRGT_EPISODE_DIAGNOSIS_DTL X WHERE X.HRGNUM_EPISODE_CODE \='''||hpad.hrgnum_episode_code||'''  AND X.HRGNUM_PUK \='''||hpad.HRGNUM_PUK||''' AND X.GNUM_HOSPITAL_CODE \= '''||hpad.gnum_hospital_code||'''   and x.hrgnum_visit_no\='''||hpad.hrgnum_visit_no||'''  AND X.HBNUM_ISREPEAT IN (0,1)  AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,BILL_MST.GET_PAT_ACCOUNTNO(hpad.GNUM_HOSPITAL_CODE\:\:character varying,2\:\:character varying,hpad.HRGNUM_PUK\:\:character varying) as patAccNo FROM HIPT_PATADMISSION_DTL hpad WHERE GNUM_ISVALID \= 1 AND HIPDT_ADMSTATUS_CODE NOT IN (13,14,16) AND  GNUM_HOSPITAL_CODE \= ? AND HIPDT_DISDATETIME IS NULL AND HRGNUM_PUK \= ?                                        

SELECT.PATIENT_EPISODE_DTLS.HRGT_EPISODE_DTL=SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS patepisodecode, a.hrgnum_visit_no AS patvisitno, TO_CHAR( gdt_entry_date, 'dd-Mon-yyyy') AS patvisitdate, a.gnum_dept_code AS departmentcode, a.hgnum_deptunitcode AS patdeptunitcode, pkg_clinical_util_fun.get_deptunit_name(a.gnum_hospital_code,a.hgnum_deptunitcode) AS patdeptunit,  pkg_clinical_util_fun.get_dept_name(a.gnum_hospital_code,a.gnum_dept_code) AS department, pkg_clinical_util_fun.get_room_name(a.gnum_hospital_code,a.hgnum_room_code) AS room, hrgnum_episode_type_code as patepisodetypecode,hrgnum_visit_type AS patvisittypecode, gnum_hospital_code AS hospitalcode , (select hrgstr_mlc_no from hrgt_patient_mlc_dtl where  gnum_isvalid\=1 and hrgnum_visit_no \=a.hrgnum_visit_no and hrgnum_episode_code \=a.hrgnum_episode_code and  hrgnum_puk\=a.hrgnum_puk   and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE)  as patmlcno,NVL(CONCATSTRING( 'SELECT  m.dignosisName || ''(''||  diagnosticTypeName ||'')''FROM ( SELECT DECODE(X.HRGNUM_DIAGNOSIS_CODE_TYPE,0, (SELECT INITCAP(HGBSTR_DISEASE) FROM HGBT_ICD_DISEASE_MST WHERE TRIM(HGBSTR_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_HOSPITAL_CODE\=100 AND HGNUM_RECORD_TYPE\=0 AND GNUM_ISVALID\=1), 1,(SELECT INITCAP(HGBSTR_DISEASE_DESC) FROM HGBT_HOSPITAL_DISEASE_MST WHERE GNUM_HOSPITAL_CODE\=X.GNUM_HOSPITAL_CODE AND TRIM(HGBSTR_HOSPITAL_DISEASE_CODE)\=TRIM(X.HRGNUM_DIAGNOSTIC_CODE) AND GNUM_ISVALID\=1)) AS dignosisName, (SELECT INITCAP(HGBSTR_DIAGNOSTIC_TYPE_NAME) FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=100 AND HGBNUM_DIAGNOSTIC_TYPE_CODE\=X.GNUM_DIAGNOSTIC_TYPE_CODE AND GNUM_ISVALID\=1) AS diagnosticTypeName FROM HRGT_EPISODE_DIAGNOSIS_DTL X  WHERE X.HRGNUM_EPISODE_CODE \='''|| a.hrgnum_episode_code ||'''  AND X.HRGNUM_PUK \='''||a.HRGNUM_PUK||'''   AND X.GNUM_HOSPITAL_CODE \= '''|| gnum_hospital_code||'''       and x.hrgnum_visit_no\='''||a.hrgnum_visit_no||''' AND X.HBNUM_ISREPEAT IN (0,1) AND gnum_isvalid \= 1 ) m',','),'-') AS diagnosis,gnum_hospital_code AS hospitalcode from hrgt_episode_dtl a WHERE a.gnum_isvalid \= 1 AND a.gnum_hospital_code \=? AND hrgnum_visit_no \=(SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl WHERE gnum_isvalid \= a.gnum_isvalid AND a.hrgnum_is_episode_open \=1 AND gnum_hospital_code \= a.gnum_hospital_code AND hrgnum_episode_code \= a.hrgnum_episode_code AND hrgnum_puk \= a.hrgnum_puk) AND a.hrgnum_puk \= ? ORDER BY a.hrgnum_episode_code 

SELECT.LABTESTSAMPLECOMBO.HIVT_LABTEST_SAMPLE_MST = select a.GNUM_SAMPLE_CODE||'&'||a.gnum_uom_code||'&'||a.gnum_container_code||'&'||NVL(a.gnum_sample_qty,-1) as sampleCode, (Select INITCAP(GSTR_SAMPLE_NAME)  from hivt_sample_mst where gnum_isvalid=1 and GNUM_SAMPLE_CODE = a.GNUM_SAMPLE_CODE)||'&'||(select gstr_uom from hivt_uom_mst where gnum_isvalid=1 and gnum_uom_code=a.gnum_uom_code)||'&'||(select INITCAP(gstr_container_name) from hivt_container_mst where gnum_isvalid=1 and gnum_container_code=a.gnum_container_code ) as sampleName   from HIVT_LABTEST_SAMPLE_MST a  where GNUM_LAB_CODE = ? AND GNUM_TEST_CODE = ?   AND a.GNUM_HOSPITAL_CODE=?  AND a.GNUM_ISVALID=1  order by sampleName

SELECT.LAB_COMBO_NAMES.HIVT_LABORATORY_MST = Select GNUM_LAB_CODE,  INITCAP (gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and DECODE (SUBSTR(HIVNUM_LAB_WORKING_DAYS,TO_NUMBER(TO_CHAR(SYSDATE,'d')),1),1,'1','0')\=1 and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'  and p.gnum_seatid\=? AND p.gnum_hospital_code \= ? ) order by labName
SELECT.TEST_COMBO_NAMES.HIVT_TEST_MST = select distinct(gnum_test_code), pkg_inv_fun.fun_test_name(gnum_test_code) as testName from hivt_laboratory_test_mst where gnum_isvalid\=1  and gnum_hospital_code \= ? order by testName
SELECT.TEST_COMBO_NAMES_AJAX.HIVT_TEST_MST = select gnum_test_code, pkg_inv_fun.fun_test_name(gnum_test_code) as testName from hivt_laboratory_test_mst where gnum_isvalid\=1  and gnum_hospital_code \= ?  
SELECT.TEST_GROUP_NAMES.HIVT_TEST_GROUP_MST = SELECT   hgnum_group_code,hgstr_group_name AS testgroupname FROM hivt_test_group_mst a WHERE a.gnum_hospital_code \= ? AND gnum_isvalid \= 1 AND EXISTS(SELECT 1 from hivt_test_group_info_mst  WHERE hgnum_group_code \= a.hgnum_group_code AND gnum_is_valid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code) ORDER BY testgroupname
SELECT.TEST_GROUP_NAMES_AJAX.HIVT_TEST_GROUP_MST = SELECT   hgnum_group_code,hgstr_group_name AS testgroupname FROM hivt_test_group_mst a WHERE a.gnum_hospital_code \= ? AND gnum_isvalid \= 1 AND EXISTS(SELECT 1 from hivt_test_group_info_mst  WHERE hgnum_group_code \= a.hgnum_group_code AND gnum_is_valid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code   \t\t\t\t\t\t\t\t\t\t\t\t               \t\t\t   

SELECT.BOOK_MARK_DTLS.HIVT_BOOKMARK_MST=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid \=1 and gnum_bookmark_type \= 1 and gnum_hospital_code \= ? and gnum_user_id \= ? and hivtnum_lab_code in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1   AND p.gnum_module_id \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  and gnum_hospital_code \= ? )  order by INITCAP(hivtstr_bookmark_name)  \t\t\t               \t\t\t   
			               			   
/**Generate Requsition No *//

SELECT.REQUISTIONNO.SYS_REQUISITION_MAINTAINER= Select NVL((Select  MAX(HIVTNUM_REQUISITION_SEQUENCE) from SYS_REQUISITION_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
 
INSERT.REQUISTIONNO.SYS_REQUISITION_MAINTAINER = INSERT INTO sys_requisition_maintainer( gnum_laboratory_code, gnum_hospital_code, hivtnum_requisition_sequence, gnum_yymmdd) \
    											VALUES (?, ?, ?, ?);
UPDATE.REQUISTIONNO.SYS_REQUISITION_MAINTAINER = UPDATE sys_requisition_maintainer SET  hivtnum_requisition_sequence\=? WHERE gnum_yymmdd\=TO_CHAR(SYSDATE,'YYMMDD') and  gnum_hospital_code\=? and gnum_laboratory_code\=? 
INSERT.HIVT_REQUISITION_HEADER_TEMP = INSERT INTO hivt_requisition_header( hivnum_req_no, hrgnum_puk, gnum_hospital_code, hgnum_visitno, gnum_lab_code, hivdt_requisition_date, hivdt_entry_date, gnum_isvalid) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, 1\:\:numeric,?\:\:numeric, SYSDATE, SYSDATE, 1\:\:numeric);
            					
 
 INSERT.HIVT_REQUISITION_HEADER = INSERT INTO hivt_requisition_header( hivnum_req_no, hrgnum_puk, gnum_hospital_code, hgnum_visitno, gnum_lab_code, hivdt_requisition_date, hivdt_entry_date, hivnum_isconfidential, hivnum_reqheader_status, gnum_seat_id, gnum_episode_code, hrgstr_patname, hbnum_requisition_type, hrgdt_dob, hgnum_visit_date, hivnum_isactual_dob, hgstr_ordered_by_doc, gstr_gender_code, hivnum_req_raised_through, hivstr_age, hipnum_admno, hivstr_address, hipnum_wardcode, hrgstr_mobile_no, hrgstr_email_id, hipnum_room_code, hipnum_bed_code, hrgstr_mlc_no, hipstr_bed_name, hipstr_room_name, hipstr_ward_name, gstr_dept_name, hgstr_unit_name, hgnum_dept_code, hgnum_deptunitcode, hivtnum_isautomated_request, hgstr_ordered_by_doc_name, gnum_reffered_hospital_code, gnum_reffered_dept_unit_name,gnum_reffered_lab_code, hivstr_ext_hosporlab_name, hivstr_ext_crnumber, gnum_bill_no, hivstr_delete_reason, gnum_isvalid  ) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, SYSDATE, SYSDATE, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:character varying, ?\:\:numeric, ?\:\:timestamp without time zone, ?\:\:timestamp without time zone, ?\:\:numeric,  ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:numeric, ?, ?\:\:numeric, ?\:\:numeric, ?, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?\:\:character varying, ?, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?, ?\:\:numeric, ?, ?, ?, ?, ?\:\:numeric, ?, ?  );
            					
UPDATE.APPOITMENT.IN.REQUISITIONHEADER=UPDATE hivt_requisition_header SET   hivdt_requisition_date\=?\:\:timestamp without time zone WHERE  hivnum_req_no\=?
            					
/**Insert Requsition Dtl table **/
				    //READY_RESULTVALIDATION:=7 READY_RESULTREVALIDATION:=8 PATIENT_REJECTED =9 PATIENT_RESCHEDULED=10 SAMPLE_RESCHEDULED:=11 SAMPLE_CANCELLED =12 READY_RESULTPRINTING =13
					//READY_DUPRESULTPRINTING =14 TEST_CANCELLED =15 TEST_DELETED =16 TEST_SEND_TO_MACHINE=17 RESULT_RECEIVED_FROM MACHINE=18 READY_FOR_GROSSING  =19 READY_SLIDEENTRY  =20;
					//READY_FOR_PROCESSING =23 READY_FOR_CUTTING =24 READY_FOR_REPORTING =25 READY_ASSOCIATE LAB =99 READY_EXTERNAL LAB =98  **/

INSERT.HIVT_REQUISITION_DTL= INSERT INTO hivt_requisition_dtl( gnum_hospital_code, hivtnum_req_dno, hivnum_isappointment, gnum_lab_code, gnum_test_code, hivnum_isconfidential, gnum_sample_code, hivt_entry_date,gnum_seat_id,hivnum_req_no,hivtnum_workordersequence,hivtnum_typeofcomponent,hivnum_reqdtl_status,gbnum_priority_code,hgnum_group_code,hgnum_group_type,hivdt_appointment_date,hivstr_appointment_time) VALUES (?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, SYSDATE,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?\:\:numeric,?,?,?\:\:timestamp without time zone,?\:\:character varying)         \t\t\t\t\t
            					
            					
            					
            					
            					

INSERT.HIVT_REQUISITION_DTL_TEMP= INSERT INTO hivt_requisition_dtl( gnum_hospital_code, hivtnum_req_dno, hivnum_isappointment, gnum_lab_code, gnum_test_code, hivnum_isconfidential, gbnum_priority_code, hivdt_result_date, hivnum_sample_no, hivnum_result_seatid, hivt_entry_date, hivnum_reqdtl_status, gnum_seat_id, hapnum_app_ref_no, hivnum_temp_sample_no, hgnum_group_code, hgnum_group_type, hivtnum_cancellation_seatid, gnum_bill_no,  gnum_sample_code, hgstr_daily_labno, hivnum_pat_rejection_reason, hivnum_pat_rejection_action, hivtnum_workordersequence, hivnum_sam_rejection_action, hivnum_sam_rejection_reason, hivtnum_typeofcomponent,hivnum_req_no, hivnum_isaccepted, hivnum_packing_list_no, gnum_machine_code, hivnum_collection_seatid, hivnum_sample_col_area_code, hivdt_appointment_date, hivstr_appointment_time) VALUES (?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,  ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?);            \t\t\t\t\t
SELECT_LAB_COMBO_HIVT_LABORATORY_MST=Select GNUM_LAB_CODE, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) || '-' || gstr_lab_name  as labName from  hivt_laboratory_mst where gnum_isvalid\=1 and gnum_hospital_code\=? and gnum_lab_code in (SELECT  gnum_column_value  FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_hospital_code \=?)
			
			
			
			
			
			
SELECT.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in(5,10)  AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO)and  TRUNC(HIVDT_REQUISITION_DATE) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) 
									
SELECT.PATIENT_HIVT_REQUISITION_HEADER=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING,DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character VARYING, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character VARYING,  (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail ,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE testCode, (Select GSTR_TEST_NAME from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL ,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority, to_Char(HIVT_ENTRY_DATE,'DD-Mon-YYYY') as requisitionDate,HIVNUM_REQDTL_STATUS, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE,HGNUM_GROUP_TYPE, (Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as labNoConfiguration from HIVT_REQUISITION_DTL a where  HIVNUM_REQDTL_STATUS in(5,10) AND HIVNUM_REQ_NO\=?  and gnum_hospital_code\=?
                                          
SELECT.COMBO_hivt_rejectionreason_mst=select hgnum_rejectionreason_id as rejectionId, hgstr_rejectionreason as  rejectionReason From	hivt_rejectionreason_mst where gnum_isvalid=1         

SELECT.PATIENT.SYS_REQUISITION_MAINTAINER= Select NVL((Select  MAX(HIVTNUM_PATACCNO_SEQUENCE) \tfrom SYS_PATIENTACC_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD')  and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
                                						
INSERT.PATIENTNO.SYS_PATIENTACC_MAINTAINER=INSERT INTO SYS_PATIENTACC_MAINTAINER( gnum_laboratory_code, gnum_hospital_code, HIVTNUM_PATACCNO_SEQUENCE, gnum_yymmdd) \
    										VALUES (?, ?, ?, ?);
UPDATE.PATIENT.REQUISTIONNO.SYS_SAMPLE_MAINTAINER= UPDATE SYS_PATIENTACC_MAINTAINER SET  HIVTNUM_PATACCNO_SEQUENCE\=?  WHERE gnum_yymmdd\=TO_CHAR(SYSDATE,'YYMMDD')and gnum_laboratory_code\=? and   gnum_hospital_code\=?
  
INSERT.PATIENTDTLSACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL=  INSERT INTO hivt_patient_acceptance_dtl(hivtnum_req_dno, gnum_hospital_code, hivnum_pat_acc_no, hivdt_acceptance_date_time,hivtnum_isaccepted,   gnum_seatid,   hivtdt_entry_date, hgstr_daily_labno, \
                                                            hivnum_pat_acc_status_code) VALUES (?, ?, ?, SYSDATE,?, ?, SYSDATE, ?, ?)
                                                               
INSERT.PATIENTDTLSNOTACCEPTED.HIVT_PATIENT_ACCEPTANCE_DTL= INSERT INTO hivt_patient_acceptance_dtl(hivtnum_req_dno, gnum_hospital_code, hivnum_pat_acc_no, hivtnum_isaccepted, hivnum_pat_rejection_reason, gnum_seatid, hivnum_pat_rejection_action, hivtdt_entry_date, hgstr_daily_labno, \
                                                           hivdt_rejection_date_time, hivnum_pat_acc_status_code, hivtnum_rejection_seatid) VALUES (?, ?, ?,?, ?, ?,?, SYSDATE, ?,SYSDATE, ?, ?)
                                                               
UPDATE.REQDTLS.PATIENT.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?,   HIVNUM_PAT_REJECTION_REASON\=?, HIVNUM_PAT_REJECTION_ACTION\=?, hivtnum_cancellation_seatid\=?,HIVNUM_ISACCEPTED\=?, hivtdt_cancellation_date\=SYSDATE  Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
                                
UPDATE.PATIENTDTLS.HIVT_REQUISITION_HEADER=UPDATE HIVT_REQUISITION_HEADER SET  HRGSTR_MOBILE_NO=?  , HRGSTR_EMAIL_ID= ? , HIVSTR_ADDRESS = ? where GNUM_ISVALID=1 and gnum_hospital_code = ? and HIVNUM_REQ_NO=?

UPDATE.REQDTLS.PATIENT.ACCEPTED.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?, HIVTDT_PAT_ACCPT_DATE_TIME\=SYSDATE,   HIVNUM_ISACCEPTED\=?, HIVDT_ACCEPTANCE_DATE_TIME\=SYSDATE, HIVDT_ACCEPTANCE_SEATID\=? Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
                                                
UPDATE.REQDTLS.PATIENT.RESCHEDULED.HIVT_REQUISITION_DTLS=Update HIVT_REQUISITION_DTL set HIVNUM_REQDTL_STATUS\=?, GNUM_BILL_NO\=?, HGSTR_DAILY_LABNO\=?,   HIVNUM_PAT_REJECTION_REASON\=?, HIVNUM_PAT_REJECTION_ACTION\=?, HIVNUM_RESHEDULE_SEATID\=?, HIVDT_RESHEDULE_DATE\=SYSDATE, HIVNUM_ISACCEPTED\=?   Where gnum_hospital_code\=? And HIVTNUM_REQ_DNO\= ? 
                                                           
                                                           
SELECT.CHECKDAILYLABNODUPLICACY=select count(*) from hivt_patient_acceptance_dtl where trunc(hivtdt_entry_date)\=trunc(sysdate) and UPPER(hgstr_daily_labno) \= UPPER(?)\t\t\t\t                                             
                                                           
                                                           


 SELECT.SAMPLE_COLLECTION_AREA.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE \=2 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE and hipnum_ward_code\=?) as sampleAreaName  from HIVT_LAB_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  AND p.gnum_column_VALUE \= a.GNUM_LAB_CODE  and p.gnum_seatid\=? AND p.gnum_hospital_code \= ?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type \= 2 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code and hipnum_ward_code\=?)                                             \t\t\t\t\t


SELECT.SAMPLE_PATIENT_LIST.HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as requisitionNo, HRGNUM_PUK as patCRNo ,HGNUM_VISITNO as patVisitNo,GNUM_LAB_CODE as labCode,DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus ,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as requisitionDate, HRGDT_DOB as patDOB ,HIVNUM_REQHEADER_STATUS as reqHeaderStatus,GNUM_EPISODE_CODE as episodeCode,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGenderCode,HBNUM_REQUISITION_TYPE as reqType,to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDate ,HIVSTR_AGE as patAge ,HIPNUM_ADMNO as patAdmNo, NVL(HIVSTR_ADDRESS,'-') as patAddress,HIPNUM_WARDCODE as patWardCode,NVL(HRGSTR_MOBILE_NO,'-') as patMobile, NVL(HRGSTR_EMAIL_ID,'-') as patEmail,HIPNUM_ROOM_CODE as patRoomCode,HIPNUM_BED_CODE as patBedCode,HRGSTR_MLC_NO as patMlcNo ,NVL(HIPSTR_BED_NAME,'-') as patBedName,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,NVL(GSTR_DEPT_NAME,'-') as patDeptName, NVL(HGSTR_UNIT_NAME,'-') as patUnitName,HGNUM_DEPT_CODE as patDeptCode,HGNUM_DEPTUNITCODE as patDeptUnitCode,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc, (select gnum_sample_code from hivt_requisition_dtl where gnum_hospital_code\=a.gnum_hospital_code and hivnum_req_no\=a.hivnum_req_no and gnum_isvalid\=1 and rownum\=1) as sampleCode,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=?   and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  )   AND  EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO)
  														
  														
													  

# Sample Acceptance Process Added By Pathan Basha


SELECT_SAMPLE_ACCEPTANCE_LAB_COMBO_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'    AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
                                                        
                                                        
SELECT.SAMPLE_ACCEPTANCE_PACKAGE_LIST_HIVT_REQUISITION_DTL= SELECT hivtnum_req_dno as requisitionDNo, hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE hivnum_reqdtl_status \= 4 AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) 

                                
SELECT.CHECKDAILYLABNODUPLICACY.FORSAMPLEACCEPTANCE=select count(*) from hivt_requisition_dtl where trunc(hivt_entry_date)\=trunc(sysdate) and UPPER(hgstr_daily_labno) \= UPPER(?)\t\t\t\t                                             
SELECT.SAMPLE_ACCCOMBO_HIVT_REJECTIONREASON_MST=Select hgnum_rejectionreason_id as rejectionId, hgstr_rejectionreason as rejectionReason from HIVT_REJECTIONREASON_MST where gnum_isvalid\=1 and HIVNUM_ACCEPTANCE_TYPE in (1,3)
        
UPDATE.SAMPLEACCDETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=?, hivnum_issample_received\=?, hivnum_isaccepted\=?, HIVDT_ACCEPTANCE_DATE_TIME\=SYSDATE,HIVDT_ACCEPTANCE_SEATID\=?,HGSTR_DAILY_LABNO\=? WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
												   
UPDATE.SAMPLE_NOTACC_DETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=? ,hivnum_issample_received\=?, hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, hivtdt_cancellation_date\=SYSDATE, hivtnum_cancellation_seatid\=?, hivnum_isaccepted\=? WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
												   
UPDATE.SAMPLE_RESCHEDULED_ACCDETAIL.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl   SET  hivnum_reqdtl_status\=? ,hivnum_issample_received\=?, hivnum_sam_rejection_action\=?, hivnum_sam_rejection_reason\=?, HIVNUM_RESHEDULE_SEATID\=?,HIVDT_RESHEDULE_DATE\=SYSDATE, hivnum_isaccepted\=?  WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?\t\t\t\t\t\t\t\t\t\t\t\t   \t\t\t\t\t\t\t\t\t\t\t\t      

UPDATE.SAMPLEACCDETAIL.HIVT_SAMPLE_DTL=UPDATE hivt_sample_dtl    SET  hivdt_acceptance_date_time\=SYSDATE, hivdt_acceptance_seatid\=?, hgstr_daily_labno\=? WHERE hivnum_sample_no\=?  AND hivtnum_req_dno\=?


UPDATE.SAMPLE_NOTACC_DETAIL.HIVT_SAMPLE_DTL=UPDATE hivt_sample_dtl    SET  hivdt_rejection_date_time\=SYSDATE, hivnum_sam_rejection_seatid\=?, hivnum_sam_rejection_action\=?,  hivnum_sam_rejection_reason\=?  WHERE hivnum_sample_no\=?  AND hivtnum_req_dno\=?

UPDATE.SAMPLEACCDETAIL.HIVT_PACKING_LIST_DTL=UPDATE hivt_packing_list_dtl   SET   hivbl_list_status=?  WHERE hivnum_packing_list_no=?  

UPDATE.SAMPLE_RECIEVE_NO_DETAIL.HIVT_REQUISITION_DTL=UPDATE   hivt_requisition_dtl  SET hivnum_reqdtl_status\=? ,hivdt_acceptance_date_time\=SYSDATE, hivdt_acceptance_seatid\=?,    hivnum_issample_received\=?,hivnum_isaccepted\=?  WHERE  hivnum_sample_no\=? AND gnum_test_code\=? AND hivtnum_req_dno\=?
                                                      
SELECT.SAMPLE_ACCEPTANCE_PACKING_LIST_ON_LOAD_HIVT_REQUISITION_DTL=SELECT hivtnum_req_dno as requisitionDNo, hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl  a WHERE hivnum_reqdtl_status \= 4 AND TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (SYSDATE, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (SYSDATE, 'DD-MON-YYYY')) 
 
SELECT.SAMPLE_ACCEPTANCE_PACKING_LIST_FOR_CHECK_PACKNO_HIVT_REQUISITION_DTL=SELECT hivtnum_req_dno as requisitionDNo, hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE hivnum_reqdtl_status \= 4  
                                        
                                        
SELECT.SAMPLE_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select gnum_lab_code as labCode,gdt_initialization_date as initDate, gnum_pat_type as patType,gnum_sq_no as seqNo, gnum_hospital_code,gnum_no_of_seq_digits, nvl(gnum_machine_code,'-1') as machineCode, nvl(gnum_test_code,'-1') as testCode ,hivtstr_labno_format as labNoFormat,gdt_entry_date as entryDate, gdt_reinit_date as reInitDate,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_machine_code in( -1,?) and gnum_pat_type in(1,2,3,?\:\:numeric) AND gnum_is_valid\=1   order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   
															
SELECT.SAMPLEACC.LABNODATEGEN.FROM.DUAL=  select TO_CHAR(SYSDATE,?)  from dual;

UPDATE.SAMPLEACCDETAIL.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_machine_code in( -1,?) and gnum_pat_type in(1,2,3,?) AND gnum_is_valid\=1

UPDATE.SAMPLEACCDETAIL.RESET_RUNNING_LABNO.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_machine_code in( -1,?) and gnum_pat_type in(1,2,3,?) AND gnum_is_valid\=1


															              
UPDATE.PATIENTACCDETAIL.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET gdt_initialization_date\=?\:\:timestamp without time zone,    hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1\t\t

UPDATE.PATIENTACCDETAIL.RESET_RUNNING_LABNO.HIVT_LABNO_CONF_MST=UPDATE hivt_labno_conf_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1\t\t

SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.AJAX.CHECK.HIVT_LABNO_CONF_MST=select   hivstr_running_lab_no as runningLabNo     from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1      \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                 

															
SELECT.PATIENT_ACCC_DETAIL_AUTOGEN_LABNO.HIVT_LABNO_CONF_MST=select   hivtstr_labno_format as labNoFormat ,  gdt_initialization_date as initDate  ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,gnum_init_type as initType, hivstr_running_lab_no as runningLabNo , hivst_initial_lab_no as initLabNo from hivt_labno_conf_mst  where gnum_lab_code\=? and gnum_test_code in( -1 ,?) AND gnum_is_valid\=1   order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                 
SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character VARYING, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character VARYING, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS \= ? and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=?
													  
SELECT.UOM_COMBO.HIVT_UOM_MST= select GNUM_UOM_CODE as uomCode,INITCAP(gstr_uom) as uomName from HIVT_UOM_MST WHERE GNUM_ISVALID=1	

SELECT.CONTAINER_COMBO.HIVT_CONTAINER_MST= select GNUM_CONTAINER_CODE,INITCAP(GSTR_CONTAINER_NAME) from HIVT_CONTAINER_MST WHERE GNUM_ISVALID=1	

SELECT.SAMPLENO.SYS_SAMPLE_MAINTAINER=Select NVL((Select  MAX(HIVTNUM_SAMPLENO_SEQUENCE) from SYS_SAMPLE_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_SAMPLE_CODE \= ? and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 100000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual

INSERT.SAMPLENO.SYS_SAMPLE_MAINTAINER=INSERT INTO SYS_SAMPLE_MAINTAINER( gnum_laboratory_code,GNUM_SAMPLE_CODE, gnum_hospital_code, HIVTNUM_SAMPLENO_SEQUENCE, gnum_yymmdd) VALUES (?, ?, ?, ?,?);

UPDATE.SAMPLENO.SYS_SAMPLE_MAINTAINER= UPDATE SYS_SAMPLE_MAINTAINER SET  HIVTNUM_SAMPLENO_SEQUENCE=?   WHERE gnum_yymmdd=TO_CHAR(SYSDATE,'YYMMDD')and gnum_laboratory_code=? and gnum_sample_code=? and  gnum_hospital_code=?

UPDATE.PATDTLS.HIVT_REQUISITION_HEADER=UPDATE HIVT_REQUISITION_HEADER SET  HRGSTR_MOBILE_NO=?  , HRGSTR_EMAIL_ID= ? , HIVSTR_ADDRESS = ? where GNUM_ISVALID=1 and gnum_hospital_code = ? and HIVNUM_REQ_NO=?

UPDATE.REQDTLS.HIVT_REQUISITION_DTLS=UPDATE HIVT_REQUISITION_DTL SET HIVNUM_REQDTL_STATUS\=? , HIVNUM_SAMPLE_NO\= ? , GNUM_BILL_NO\=?, HIVNUM_TEMP_SAMPLE_NO\=? , HIVDT_COLL_DATE_TIME\=SYSDATE, HIVNUM_COLLECTION_SEATID\=? , HIVNUM_SAMPLE_COL_AREA_CODE\=?,hivnum_uom\=?,hivnum_containercode\=?,hivnum_collected_volume\=?  where GNUM_HOSPITAL_CODE\=? and  HIVTNUM_REQ_DNO\= ?
  
INSERT.SAMPLEDTLS.HIVT_SAMPLE_DTL=INSERT INTO hivt_sample_dtl(hivnum_sample_no, gnum_hospital_code, hivtnum_req_dno,  \
								  hivnum_sample_col_area_code, hivdt_coll_date_time, hivnum_collection_seatid, \
						            hivnum_print_status, hivnum_collected_volume, hgnum_sample_code, \
						            hivnum_uom, hivnum_containercode,  \
						            hivtnum_typeofcomponent, gnum_seat_id, hivnum_sam_status_code, \
						            hivdt_entry_date, hivnum_temp_sample_no) \
								    VALUES (?, ?, ?, ?,  \
								            SYSDATE, ?, ?,  \
								            ?, ?, ?,  \
								            ?, ?, ?,  \
								            ?, SYSDATE, ?  \
										);
										
SELECT.TEMP_SAMPLE_NO.HIVT_SAMPLE_DTL=select count(*)from hivt_sample_dtl where HIVNUM_SAMPLE_COL_AREA_CODE\=? and trunc(HIVDT_ENTRY_DATE)\=trunc(sysdate) and UPPER(HIVNUM_TEMP_SAMPLE_NO) \= UPPER(?)\t
SELECT.LAB_COMBO.HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in ( Select gnum_lab_code from HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= ?) and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' and p.gnum_seatid\=? AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
										
#SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  )   \t\t\t\t\t\t\t\t\t
SELECT.PACKINGLIST_PATIENT_LIST.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT gstr_test_name  FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT gstr_sample_name  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= ? AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(?,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )  \t\t\t\t\t\t\t\t\t



SELECT.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER=Select NVL((Select  MAX(HIVTNUM_PACKINGLISTNO_SEQUENCE) from SYS_PACKINGLIST_MAINTAINER where  GNUM_YYMMDD \= TO_CHAR(SYSDATE,'YYMMDD') and GNUM_LABORATORY_CODE \= ? and GNUM_HOSPITAL_CODE\=?) , 1000) +1 ,TO_CHAR(SYSDATE,'YYMMDD')  from dual
 											
INSERT.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER=INSERT INTO SYS_PACKINGLIST_MAINTAINER( gnum_laboratory_code,gnum_hospital_code, HIVTNUM_PACKINGLISTNO_SEQUENCE, GNUM_YYMMDD) VALUES (?, ?, ?,?)

UPDATE.PACKINGLISTNO.SYS_PACKINGLIST_MAINTAINER= UPDATE SYS_PACKINGLIST_MAINTAINER SET  HIVTNUM_PACKINGLISTNO_SEQUENCE=?   WHERE GNUM_YYMMDD=TO_CHAR(SYSDATE,'YYMMDD')and GNUM_LABORATORY_CODE=? and  GNUM_HOSPITAL_CODE=?

UPDATE.PACKINGLISTNO.HIVT_REQUISITION_DTLS= UPDATE HIVT_REQUISITION_DTL SET HIVNUM_REQDTL_STATUS=? , HIVNUM_PACKING_LIST_NO=?,HIVNUM_PACKING_LIST_SEAT_ID=?, HIVTDT_PACKINGLIST_DATE_TIME=SYSDATE where GNUM_HOSPITAL_CODE=? and  HIVTNUM_REQ_DNO= ?

UPDATE.PACKINGLISTNO.HIVT_SAMPLE_DTL=  UPDATE HIVT_SAMPLE_DTL SET HIVNUM_SAM_STATUS_CODE=?,HIVNUM_PACKING_LIST_NO=? WHERE HIVNUM_SAMPLE_NO= ? AND GNUM_HOSPITAL_CODE=?

INSERT.PACKINGLISTDTLS.HIVT_PACKING_LIST_DTL=INSERT INTO hivt_packing_list_dtl( \
            										hivnum_packing_list_no, hivbl_list_status, hivnum_seat_id, hivdt_entry_date, \
            										hivnum_ispackinglist_offline,gnum_hospital_code) \
    												VALUES (?, ?, ?, SYSDATE,  \
           											?,?)
           											
SELECT.HIVNUM_PACKING_LIST_NO.HIVT_REQUISITION_DTL=SELECT HIVNUM_PACKING_LIST_NO FROM HIVT_REQUISITION_DTL WHERE HIVTNUM_REQ_DNO=? AND GNUM_HOSPITAL_CODE=?           											

#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1=select        hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType   from hivt_sampleno_conf_mst1  where gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?) AND gnum_is_valid\=1 and gnum_hospital_code=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc


#UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET   gdt_initialization_date\=?\:\:timestamp without time zone  ,hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code=? 
#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST=select    hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code\=?     and gnum_pat_type in(3,?)  AND gnum_is_valid\=1  and gnum_hospital_code=? order by    gnum_lab_code desc,     gnum_pat_type    asc


#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_SAMPLENO_CONF_MST1=select   hivstr_running_lab_no as runningSampleNo from hivt_sampleno_conf_mst1  where gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?) AND gnum_is_valid\=1 and gnum_hospital_code=?   
#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_COLAREA_SAMNO_CONFIG_MST=select    hivstr_running_lab_no as runningSampleNo     from hivt_colarea_samno_config_mst  where gnum_lab_code\=?     and gnum_pat_type in(3,?)  AND gnum_is_valid\=1 and gnum_hospital_code=?    


#UPDATE.SAMPLECOllDETAIL.RESET.RUNNING.NO.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET    hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code in( -1 ,?) and gnum_pat_type in(3,?) AND gnum_is_valid\=1 and gnum_hospital_code=?

															
															
#UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_area_code in( -1 ,?) and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code=? \t\t\t\t\t\t\t\t\t\t\t\t\t\t 



#UPDATE.SAMPLECOLLDETAIL.RESET.RUNNING.NO.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_area_code in( -1 ,?) and gnum_pat_type in(3,?) AND gnum_is_valid\=1 and gnum_hospital_code=? \t\t\t\t\t\t\t\t\t\t\t\t\t\t 



SELECT_LAB_COMBO_FOR_RESULT_ENTRY_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
                                                        
 
SELECT.RESULT_ENTRY_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS requisitionNo,hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode, gnum_test_code as testCode,  gnum_sample_code as samplecode, (select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,   pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no ,    hgnum_group_code as groupcode, gnum_hospital_code as hospitalcode, hivnum_temp_sample_no as tempSampleNo,  hivnum_sample_no as sampleNo,hgstr_daily_labno as labno, hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,    pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName , pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType, pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patCRNo,    pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patName,   pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,gnum_hospital_code),       pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,gnum_hospital_code),        pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,gnum_hospital_code) patvisitdat,   pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,gnum_hospital_code) as address ,     pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName, pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,gnum_hospital_code) as emailId,       pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,     pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patBedName,    pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,gnum_hospital_code) ,      pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patAge,pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode FROM hivt_requisition_dtl a       WHERE gnum_hospital_code \=? and hivnum_reqdtl_status\=6     AND TRUNC (hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND TRUNC (hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY'))   AND gnum_lab_code \=?
								                                                    
											                                                    
UPDATE.REQDTLS.RESULT.ENTRY.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl  SET  hivdt_result_date\=SYSDATE, hivnum_result_seatid\=?, hivt_entry_date\=SYSDATE,  hivnum_reqdtl_status\=?, gnum_seat_id\=?  WHERE hivtnum_req_dno\=?  AND gnum_test_code\=? and gnum_hospital_code\=?

													 
INSERT.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=INSERT INTO hivt_parameter_dtl(hivtnum_req_dno, hivtnum_test_code, hivtnum_parent_parameter_code,gnum_hospital_code, hivt_entry_date, gnum_seat_id, hivtstr_value,    \
                                           hivnum_parameter_code, gnum_isvalid,hivstr_loinc_string)    \
                                                 VALUES (?, ?, ?,?, SYSDATE, ?, ?,?, ?,?);

			
#SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? )   \t\t\t\t\t\t\t\t\t
SELECT.PACKINGLIST_PATIENT_LIST.ONLOAD.HIVT_REQUISITION_DTL=Select HIVNUM_REQ_NO as requisitionNo,hivnum_packing_list_no as packingListNo,HIVTNUM_REQ_DNO as requisitionDNo, GNUM_LAB_CODE as labCode,(Select GSTR_LAB_NAME  from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as labName ,(SELECT  gstr_test_name   FROM hivt_test_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_test_code\=a.gnum_test_code ) AS testName, hivnum_temp_sample_no as tempSampleNo,(SELECT HRGSTR_PATNAME FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE ) as patName, hivnum_sample_no as sampleNo, (SELECT HRGNUM_PUK FROM  HIVT_REQUISITION_HEADER WHERE hivnum_req_no\=a.hivnum_req_no AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) as patCRNo,TO_CHAR(hivdt_coll_date_time, 'DD-Mon-YYYY hh24\:mi') as sampleCollectionDate, (SELECT INITCAP(gstr_sample_name)  FROM hivt_sample_mst p  WHERE gnum_isvalid \= 1 AND gnum_hospital_code \= a.gnum_hospital_code  AND p.gnum_sample_code\=a.gnum_sample_code) AS sampleName from HIVT_REQUISITION_DTL A where GNUM_HOSPITAL_CODE \=? AND HIVNUM_REQDTL_STATUS \= 3 AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE and  TRUNC(hivdt_coll_date_time) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(hivdt_coll_date_time) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? )   \t\t\t\t\t\t\t\t\t

SELECT.TEMPLATE_PROCESSING.LOINC_CODE = SELECT hivstr_loinc_string as loincCode FROM hivt_loinc_mapping_mst where gnum_isvalid\=1 and hivnum_test_code\=? and hivnum_parameter_code\=? and hivnum_sample_code \= ? and hivnum_uom_code \= ? 
 
 
 
 
 
 
 SELECT.HIVT_PARAMETER_DTL.WORKORDERRESULTENTRYDATA.RESULTVALIDATIONPROCESS = SELECT concat(HIVTNUM_TEST_CODE,hivnum_parameter_code), HIVTSTR_VALUE , hivtnum_parent_parameter_code FROM hivt_parameter_dtl hpd WHERE gnum_isvalid=1 and hpd.hivtnum_req_dno =? and gnum_hospital_code=?																		

UPDATE.RESULT.ENTRY.DETAIL.HIVT_PARAMETER_DTL=update hivt_parameter_dtl set hivtstr_value=? , gnum_lstmod_seatid=?,gdt_lstmod_date=SYSDATE where gnum_isvalid=1 and hivtnum_req_dno=? and hivtnum_test_code=? and hivnum_parameter_code=? and gnum_hospital_code=?



 
SELECT.RESULT_VALIDATION_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS RequisitionNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleNo,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patCRNo,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName, hivnum_uom as uomCode FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=?  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code \=?      
 

 SELECT.APT_BASED_DETAIL.HAPT_APPOINTMENT_DTL= SELECT hapnum_apt_no as aptNo, hrgnum_puk as pukNo, hrgnum_episode_code as episodeCode, NVL(hapstr_pat_first_name,'-') as patFirstName, NVL(hapstr_pat_middle_name,'') as PatMiddleName, NVL(hapstr_pat_last_name,'') as patLastNAme, hapstr_patient_fname, NVL(gstr_gender_code,'-') as gender, hapdt_patient_dob as patDob,to_char(hapdt_appointment_date,'dd-Mon-yyyy') AS aptdate, hapstr_email as email, hapstr_mobile_no mobileNo, gnum_isvalid,  habnum_appt_queue_no as apptQueueNo,   NVL(hapstr_slot_time,'-') as slotTime, hapnum_apt_status as aptStatus, hapstr_statusremarks as statusRemarks, hapnum_slot_type as slotType,  hapstr_remarks as remarks, hapnum_appt_type_id as aptId,   hapnum_appt_mode as aptMode, hapstr_mod_specific_key_name as specificKeyName, NVL(hapstr_patage,'-') as patAge,  hapstr_spousename as spouseName, hapnum_shift_id as shiftId, NVL(hapstr_slot_start_time,'-') as slotSatrtTime, hapstr_slot_end_time,  hapstr_slot_duration, hapstr_old_start_time, hapdt_old_appt_date,  hapstr_old_duration,  hapnum_isbooked_by_vip,  hapnum_actual_para_refid, hrgnum_visit_no,hapstr_actual_para_id_1 as labCode,hapstr_actual_para_id_2 as testCode FROM hapt_appointment_dtl where gnum_isvalid \=1 and  hapnum_apt_id\=?   and gnum_hospital_code\= ?  and hapnum_apt_status in(1,2)  AND hapstr_actual_para_id_1 IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p WHERE p.gbl_isvalid \= 1 AND p.gnum_module_id \=? AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \=?  AND gnum_hospital_code \=?)  and hapstr_actual_para_id_1 like '%' and hapstr_actual_para_id_2 like'%'  AND hapdt_appointment_date\=TO_DATE(SYSDATE,'dd-Mon-YYYY')
											 		
											 		
INSERT.RESULT.ENTRY.DETAIL.HIVT_JOBWORKORDER_DATA=INSERT INTO hivt_jobworkorder_data(hivnum_reqorcr_no, hivnum_req_dno, hivnum_updation_type, gnum_status_code,  \
												            hivdt_entry_date,  gnum_hospital_code, hivnum_req_no,  \
												             hrgnum_puk, hivt_requisition_date,    gnum_test_code,   \
												              gnum_current_lab_code, hivnum_sample_code,  \
												            hivstr_pat_age, gnum_gender_code, hgnum_parameter_code, hgnum_reportgenerationafter,  \
												            hivtstr_result_value,hgnum_visit_date,hgnum_visitno,hgnum_lab_no,hrgnum_episode_code,hgnum_dept_code,hgnum_deptunitcode,hbnum_requisition_type,hgstr_testname,hgstr_labname,hgstr_samplename,hgnum_temp_sampleno)  \
												           VALUES (?, ?, ?, ?, SYSDATE, ?,  ?,?, SYSDATE, ?,?, ?, ?,?, ?, ?, ?,TRUNC (TO_DATE (?, 'DD-Mon-YYYY')),?,?,?,?,?,?,?,?,?,?)
												           
									        
											 																							
INSERT.HIVT_REQUSITION_TEST_MANDATORY_DTL=INSERT INTO hivt_requsition_test_mandatory_dtl(hivtnum_req_dno, gnum_test_code, hgnum_mand_code, hivstr_value,  \
										            hivnum_seatid, hivnum_entry_date, gnum_hospital_code, gnum_isvalid)   \
										    VALUES (?, ?, ?, ?,?,SYSDATE, ?, ?);
										    
										    
										    
	
 
SELECT.ONLOAD_HIVT_REQUISITION_HEADER=Select HIVNUM_REQ_NO as patReqNo, HRGNUM_PUK as patPuk ,HGNUM_VISITNO,GNUM_LAB_CODE as labCode , DECODE(HBNUM_REQUISITION_TYPE,2, 'IPD',1,'OPD',3,'Emergency',4,'Special') as patStatus, (Select GSTR_LAB_NAME from HIVT_LABORATORY_MST where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE \= a.GNUM_LAB_CODE ) as patLabName, to_char(HIVDT_REQUISITION_DATE,'DD-Mon-YYYY') as patReqDate, HRGDT_DOB ,HIVNUM_REQHEADER_STATUS,GNUM_EPISODE_CODE,INITCAP(HRGSTR_PATNAME) as patName, GSTR_GENDER_CODE as patGender,HBNUM_REQUISITION_TYPE, to_char(HGNUM_VISIT_DATE,'DD-Mon-YYYY') as patVisitDat,LTRIM(RTRIM(HIVSTR_AGE)) as patAge ,HIPNUM_ADMNO, NVL(HIVSTR_ADDRESS,'-') as address,HIPNUM_WARDCODE , NVL(HRGSTR_MOBILE_NO,'-') as mobileNo, NVL(HRGSTR_EMAIL_ID,'-') as emailId,HIPNUM_ROOM_CODE,HIPNUM_BED_CODE ,HRGSTR_MLC_NO, NVL(HIPSTR_BED_NAME,'-') as patBedName ,NVL(HIPSTR_ROOM_NAME,'-') as patRoomName,NVL(HIPSTR_WARD_NAME,'-') as patWardName,GSTR_DEPT_NAME||''|| HGSTR_UNIT_NAME as patUnitName , HGNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,NVL(HGSTR_ORDERED_BY_DOC_NAME,'-') as patOrderByDoc,pkg_clinical_util_fun.get_pat_category_name(a.GNUM_HOSPITAL_CODE,a.hgnum_patient_cat_code) AS patCategory  from HIVT_REQUISITION_HEADER A where gnum_isvalid\=1 and GNUM_HOSPITAL_CODE \=? AND EXISTS ( SELECT 1 FROM HIVT_REQUISITION_DTL WHERE HIVNUM_REQDTL_STATUS in(5,10)  AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO) and TRUNC(HIVDT_REQUISITION_DATE) >\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY')) AND TRUNC(HIVDT_REQUISITION_DATE) <\= TRUNC(TO_DATE(SYSDATE,'DD-Mon-YYYY'))
 

SELECT_LAB_COMBO_FOR_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
   												    

   		 									    
 
SELECT.RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=26  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
 														
														
														
														
														
SELECT.RESULT_REPORT_PRINTING_FOR_PDF_IN_PROCESS_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=13  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t
														
														
SELECT_PDF_NAME_HIVTSTR_PDF_URL=SELECT  hivtstr_pdf_url as pdfFileName FROM hivt_pdf_workorder_dtl  where hrgnum_puk\=?   AND gnum_isvalid\=1 and  hivtnum_req_dno\=? order  by gdt_entry_date desc\t
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
		                                
 
SELECT.RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=26  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))  

CHECK_COMBO_VALUE.HIVT_TEST_PARAMETER_COMBO_MST=select hgstr_value from hivt_test_param_combo_mst a, hivt_test_parameter_mst b where a.gnum_is_valid=? and b.gnum_isvalid=1 and a.gnum_parameter_code=b.gnum_parameter_code and a.gnum_test_code=b.gnum_test_code and  b.gstr_element_type='D' and a.gnum_test_code=? and a.gnum_parameter_code=? and hgnum_seq_id=?

														
														
														
SELECT.ADVISEDBY_DOCTOR_NAMES.PIST_EMP_REGISTRATION_DTL=Select str_emp_no, str_emp_full_name from pist_emp_registration_dtl where gnum_isvalid =? and gnum_hospital_code = ? order by str_emp_full_name														

SELECT_LAB_COMBO_FOR_DUPLICATE_RESULT_REPORT_PRINTING_HIVT_LABORATORY_MST=SELECT m.labCode,m.departmenName||'-'||m.labName FROM(Select GNUM_LAB_CODE as labCode, INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) as departmenName, gstr_lab_name  as labName from  hivt_laboratory_mst a where gnum_isvalid\=1 and gnum_hospital_code\=? and a.gnum_lab_code in (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1    AND  p.gnum_module_id \=?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?   AND p.gnum_hospital_code \= ?) order by  departmenName,labName)m
                                                        
                                                        
                                                        
                                                        
SELECT.DUPLICATE_RESULT_REPORT_PRINTING_ON_LOAD_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus,  (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName ,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName  FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=14  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (SYSDATE, 'DD-Mon-YYYY'))      
														
UPDATE.REQDTLS.RESULT.REPORT_PRINITNG.HIVT_REQUISITION_DTLS=UPDATE hivt_requisition_dtl   SET hivnum_reqdtl_status\=?, hivtdt_res_print_date\=SYSDATE, hivtnum_res_print_seatid\=? WHERE hivtnum_req_dno\=?
																					
																					
SELECT_PDF_NAME_FOR_DUPLICATE_REPORT_HIVTSTR_PDF_URL=SELECT  hivtstr_pdf_url as pdfFileName FROM hivt_pdf_workorder_dtl  where hrgnum_puk\=?   AND gnum_isvalid\=1 and  hivtnum_req_dno\=? order  by gdt_entry_date desc\t
											
											
										
SELECT.DUPLICATE_RESULT_REPORT_PRINTING_HIVT_REQUISITION_HEADER=Select hivnum_req_no AS patReqNo,a.hivtnum_req_dno as requisitionDNo,gbnum_priority_code as priorityCode,gnum_test_code as testCode, gnum_sample_code as samplecode,(select HBNUM_REQUISITION_TYPE from hivt_requisition_header where GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HIVNUM_REQ_NO \= A.HIVNUM_REQ_NO ) as requisitionTypeCode ,pkg_inv_fun.fun_test_name(a.gnum_test_code) as testName,concatstring(   'Select k.hivnum_parameter_code||''\#''||  (select INITCAP(hgstr_parameter) from hivt_parameter_mst where gnum_isvalid\=1 and hgnum_parameter_id\=k.hivnum_parameter_code)||''\#''||k.hivtstr_value  from  hivt_parameter_dtl k  where  k.gnum_isvalid\=1 and k.hivtnum_test_code \= '''||a.gnum_test_code ||'''   and k.hivtnum_req_dno\='''|| a.hivtnum_req_dno ||''' and k.gnum_hospital_code\=''' || a.gnum_hospital_code||'''' ,  ',' ) AS testParameterName,pkg_inv_fun.fun_lab_name(a.gnum_lab_code, a.gnum_hospital_code) AS patLabName,hivnum_req_no , hgnum_group_code as groupcode, a.gnum_hospital_code as hospitalcode,hivnum_temp_sample_no as tempSampleNo, hivnum_sample_no as sampleno,hgstr_daily_labno as labno,hivnum_packing_list_no as packinglistno,gnum_lab_code AS labCode,pkg_inv_fun.fun_sample_name(a.gnum_sample_code) as sampleName ,pkg_inv_fun.fun_test_type(a.gnum_test_code) as testType,pkg_inv_fun.fun_puk_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patPuk,pkg_inv_fun.fun_visitno_fromreqno(a.hivnum_req_no, a.gnum_hospital_code) as patVisitNo,pkg_inv_fun.fun_patName_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patName,pkg_inv_fun.fun_gender_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patGender,pkg_inv_fun.fun_dob_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqStatus_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_episodeCode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_reqType_fromreqno(a.hivnum_req_no,a.gnum_hospital_code),pkg_inv_fun.fun_patvistdate(a.hivnum_req_no,a.gnum_hospital_code) patvisitdat,pkg_inv_fun.fun_address_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as address ,pkg_inv_fun.fun_wardcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_admissionNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_mobileNo_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_emailID_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as emailId,pkg_inv_fun.fun_roomcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) ,pkg_inv_fun.fun_bedcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_bedname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patBedName,pkg_inv_fun.fun_mlcno_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) , pkg_inv_fun.fun_patage_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patAge, pkg_inv_fun.fun_patient_status(a.hivnum_req_no,a.gnum_hospital_code) as patStatus, (Select hivt_report_available_after from hivt_laboratory_test_mst where gnum_isvalid\=1 and gnum_hospital_code\=a.gnum_hospital_code  and gnum_test_code\=a.gnum_test_code and gnum_labcode\=a.gnum_lab_code) as reportAvailableAfter  ,pkg_inv_fun.fun_episodecode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as episodeCode,pkg_inv_fun.fun_deptcode_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as departmentcode,pkg_inv_fun.fun_deptunit_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patdeptunitcode,pkg_inv_fun.fun_reqtype_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as requisitionTypeCode, pkg_inv_fun.fun_deptname_fromreqno(a.hivnum_req_no,a.gnum_hospital_code) as patUnitName,pkg_inv_fun.fun_group_name(a.hgnum_group_code,gnum_hospital_code) as groupName FROM hivt_requisition_dtl a WHERE  hivnum_reqdtl_status\=14  and a.gnum_hospital_code \=? AND TRUNC (a.hivt_entry_date) >\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) AND TRUNC (a.hivt_entry_date) <\= TRUNC (TO_DATE (?, 'DD-Mon-YYYY')) and  gnum_lab_code  like ? 
																																					                                                    


																																				         


#	SELECT.PRV_TEST_DETAIL=Select hivtnum_req_dno ,(select hgnum_visitno from hivt_requisition_header where hivnum_req_no\= a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as visitNo,(select hipnum_admno from hivt_requisition_header where hivnum_req_no\= a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as admNo,(select to_char(hivdt_requisition_date) from hivt_requisition_header where hivnum_req_no\= a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as reqDate,nvl(to_char(hivdt_report_date),'-') as resultDate,NVL(hivstr_report_url,'-') as resURL,gnum_lab_code as labCode, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName,    gbnum_priority_code, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,    to_char(hivt_entry_date,'dd-Mon-yyyy'), decode(pkg_inv_fun.fun_test_type(gnum_test_code),'P','Patient Based','S', 'Sample Based', 'I','Slide Based') as sampleCode,     hivnum_reqdtl_status as prvReqStatus,    DECODE(hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted', 7,'Result Entered',    8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed',     15,'Test Cancelled',16,'Test Deleted',26,'Report Generated',55,'Test Advised',17,'Test Sent to Machine') status,    pkg_inv_fun.fun_sample_name(gnum_sample_code) sampleName, gnum_sample_code  from hivt_requisition_dtl  a where       hivnum_req_no in ( Select hivnum_req_no from hivt_requisition_header where gnum_isvalid\=1 and gnum_hospital_code \= ? and hrgnum_puk \= ?)      and gnum_hospital_code\= ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t                                                               
# given by chandan for AIIMS Patna
SELECT.PRV_TEST_DETAIL= Select hivtnum_req_dno ,(select hgnum_visitno from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as visitNo,(select hipnum_admno from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as admNo,(select to_char(hivdt_requisition_date) from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as reqDate,nvl(to_char(hivdt_report_date),'-') as resultDate,NVL(hivstr_report_url,'-') as resURL,gnum_lab_code as labCode, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName,    gbnum_priority_code, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,    to_char(hivt_entry_date,'dd-Mon-yyyy'), decode(pkg_inv_fun.fun_test_type(gnum_test_code),'P','Patient Based','S', 'Sample Based', 'I','Slide Based') as sampleCode,     hivnum_reqdtl_status as prvReqStatus,    DECODE(hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted', 7,'Result Entered',    8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed',     15,'Test Cancelled',16,'Test Deleted',26,'Report Generated',55,'Test Advised',17,'Test Sent to Machine') status,    pkg_inv_fun.fun_sample_name(gnum_sample_code) sampleName, gnum_sample_code  from hivt_requisition_dtl  a where hrgnum_puk_reqd = 	?  and gnum_hospital_code=? union Select hivtnum_req_dno ,(select hgnum_visitno from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as visitNo,(select hipnum_admno from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as admNo,(select to_char(hivdt_requisition_date) from hivt_requisition_header where hivnum_req_no= a.hivnum_req_no and gnum_hospital_code=a.gnum_hospital_code) as reqDate,nvl(to_char(hivdt_report_date),'-') as resultDate,NVL(hivstr_report_url,'-') as resURL,gnum_lab_code as labCode, pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName,    gbnum_priority_code, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent',3,'Low') as priority,    to_char(hivt_entry_date,'dd-Mon-yyyy'), decode(pkg_inv_fun.fun_test_type(gnum_test_code),'P','Patient Based','S', 'Sample Based', 'I','Slide Based') as sampleCode,     hivnum_reqdtl_status as prvReqStatus,    DECODE(hivnum_reqdtl_status,2,'Requistion Raised',3,'Sample Collected',4,'Packing List Generated',5,'Requisition Raised', 6,'Sample/Patient Accepted', 7,'Result Entered',    8,'Result Validated',9,'Patient Rejected',10,'Test Resceduled',11,'Test Rescheduled',12,'Sample Cancelled',13,'Ready For Report Printing',14,'Result Printed',     15,'Test Cancelled',16,'Test Deleted',26,'Report Generated',55,'Test Advised',17,'Test Sent to Machine') status,    pkg_inv_fun.fun_sample_name(gnum_sample_code) sampleName, gnum_sample_code  from hivt_requisition_dtl_hst  a where hrgnum_puk_reqd = ? and gnum_hospital_code=?  \t

SELECT.hivt_test_mand_ref_val_mst = SELECT gnum_test_code as testCode, gnum_parameter_code as parameterCode, gstr_gender_code as gender, hgnum_low_age as lowAge, hgnum_high_age as highAge, hgstr_low_value_uom lowValueUom,     hgstr_high_value as highValue, hgstr_low_value as lowValue, hgstr_high_value_uom as highValueUom, hgstr_symbol as symbol,hgstr_low_age_uom as lowAgeUom, hgstr_high_age_uom as highAgeUom,gnum_sample_code as sampleCode, gnum_lab_code as labCode, hgnum_mand_code as mandCode FROM hivt_test_mand_ref_val_mst where gnum_isvalid\=1 and gnum_hospital_code \=?;

SELECT.LAB_WISE_TEST_GROUP_TEST.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,gstr_desk_properties as deskProperties, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,             GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?   AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?   ORDER BY  TestGroupCode,labCode\t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t    



SELECT.HIVT_LABORATORY_TEST_MST.PRINT_WITH_STANDARD_RANGES = select hivtnum_test_printing_type from hivt_laboratory_test_mst where gnum_test_code\=? and gnum_labcode\=? and gnum_hospital_code\=? and gnum_isvalid\=1\t
															
SELECT.HIVT_PARAMETER_DTL.DEFAULTVALUES = SELECT concat(GNUM_TEST_CODE,gnum_parameter_code), HIVTSTR_DEFAULT_VALUE , gnum_parent_id FROM hivt_test_parameter_mst WHERE gnum_isvalid=1 and gnum_test_code=?  																												                                													  												   

SELECT.BOOK_MARK_DTLS_DEPT_UNIT_WISE.HIVT_BOOKMARK_MST=Select  gnum_bookmark_code as bookMarkCode,hgnum_seq_no as seqNo,hivtnum_lab_code as labCode,hivtnum_test_code as testCode,INITCAP(hivtstr_bookmark_name) as bookMarkName, hivtnum_is_test_group as isTestGroup,hgnum_group_code as groupCode from hivt_bookmark_mst where gnum_isvalid \=1 and gnum_bookmark_type \= 2 and gnum_hospital_code \= ? and gnum_dept_unit_code \= ? and hivtnum_lab_code in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1   AND p.gnum_module_id \= ? AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  and gnum_hospital_code \= ? )  order by INITCAP(hivtstr_bookmark_name)  \t\t\t               \t\t\t

SELECT.BOOKMARK_TYPE.BookMark_mst=select gnum_bookmark_type from hivt_bookmark_mst_1 where gnum_isvalid=? and gnum_bookmark_code=? and gnum_hospital_code=?
   
SELECT.SAMPLE_COLLECTION_AREA_WARD.HIVT_COLLECTION_AREA_MST=Select distinct(GNUM_AREA_CODE) as sampleAreaCode, (Select GSTR_AREA_NAME from  HIVT_COLLECTION_AREA_MST where gnum_isvalid\=1 and GNUM_COLLECTIONAREA_TYPE \=2 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_AREA_CODE \= a.GNUM_AREA_CODE) as sampleAreaName  from HIVT_LAB_COLLECTION_AREA_MST a where gnum_hospital_code\=? and gnum_isvalid\=1 and EXISTS (SELECT 1 FROM gblt_role_seat_table_dtl p where p.gbl_isvalid\=1 AND  p.gnum_module_id \= ?   AND p.gstr_table_name \= 'HIVT_LABORATORY_MST' AND p.gstr_column_name \= 'GNUM_LAB_CODE'  AND p.gnum_column_VALUE \= a.GNUM_LAB_CODE and p.gnum_seatid\=?  AND p.gnum_hospital_code \= ?) AND EXISTS( SELECT 1 FROM hivt_collection_area_mst WHERE gnum_isvalid \= 1 AND gnum_collectionarea_type \= 2 AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_area_code \= a.gnum_area_code)                                             \t\t\t\t\t

SELECT.BILLING_PAT_LIST.HIVT_REQUISITION_DTLS_REQ_D_NO=Select GNUM_HOSPITAL_CODE, Bill_Interface.func_online_bill_dtl (a.gnum_hospital_code\:\:character varying, DECODE (NVL(a.HGNUM_GROUP_TYPE,11),  NULL, a.gnum_test_code,11, a.gnum_test_code,  1,a.gnum_lab_code||a.HGNUM_GROUP_CODE,    2,      a.gnum_lab_code||a.HGNUM_GROUP_CODE,     3,     a.gnum_test_code)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character VARYING, DECODE (NVL(a.HGNUM_GROUP_TYPE,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character VARYING, (a.HIVNUM_REQ_NO||'\!')\:\:CHARACTER VARYING) as billDetail,HIVTNUM_REQ_DNO as requisitionDNo,GNUM_LAB_CODE as labCode, (Select INITCAP(GSTR_LAB_NAME) from HIVT_LABORATORY_MST where GNUM_LAB_CODE \= a.GNUM_LAB_CODE and gnum_hospital_code \=a.gnum_hospital_code and gnum_isvalid\=1) as labName, GNUM_TEST_CODE as testCode, (Select  GSTR_TEST_NAME  from hivt_test_mst where gnum_isvalid\=1 and gnum_test_code\=a.gnum_test_code ) as testName,HIVNUM_ISCONFIDENTIAL as isConfidential,GBNUM_PRIORITY_CODE as priorityCode, decode(GBNUM_PRIORITY_CODE,1,'Normal',2,'Urgent') as priority,TO_CHAR(HIVT_ENTRY_DATE,'dd-Mon-yyyy') as requisitionDate,HIVNUM_REQDTL_STATUS as reqDtlStatus,GNUM_SAMPLE_CODE as sampleCode, (Select INITCAP(gstr_sample_name) from hivt_sample_mst where gnum_isvalid\=1 and gnum_sample_code\=a.gnum_sample_code) as sampleName, HIVNUM_REQ_NO as requisitionNo,HGNUM_GROUP_CODE as groupCode,HGNUM_GROUP_TYPE as groupType,(Select GNUM_SAMPLE_QTY from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as sampleQnty, (Select GNUM_CONTAINER_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultContainerCode, (Select GNUM_UOM_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_SAMPLE_CODE\=a.GNUM_SAMPLE_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1) as defaultUOMCode, (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE\= a.GNUM_LAB_CODE and GNUM_TEST_CODE\=a.GNUM_TEST_CODE and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and gnum_isvalid\=1 and GNUM_IS_DEFAULT_SAMPLE\=1 and rownum\=1) as defaultSampelCode, (Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE ) as sampleNoConfiguration,(select hbnum_requisition_type from hivt_requisition_header where    HIVNUM_REQ_NO\= a.HIVNUM_REQ_NO and gnum_hospital_code\=a.gnum_hospital_code) as patType from HIVT_REQUISITION_DTL a where HIVNUM_REQDTL_STATUS \= ? and HIVNUM_REQ_NO\= ? and gnum_hospital_code\=? AND hivtnum_req_dno\=?


SELECT.BILLING_DETAILS.BILL_FUNCTION=Select Bill_Interface.func_online_bill_dtl (?\:\:character varying, DECODE (NVL(?,11),  NULL, ?,11, ?,  1,?||?,    2,      ?||?,     3,    ?)\:\:character VARYING, DECODE (?, 1, 2,  2, 1,  3, 1 )\:\:character VARYING, DECODE (NVL(?,11), 0, 1,NULL,1,11,1, 1, 4, 2, 4, 3, 1 )\:\:character VARYING, (?||'\!')\:\:CHARACTER VARYING) as billDetail from dual


SELECT.TEST_CODE_WISE.HIVT_LABORATORY_TEST_MST=select distinct(gnum_user_test_code),  gnum_user_test_code as testCodeWise from hivt_laboratory_test_mst where gnum_isvalid=1  and gnum_hospital_code = ? order by testCodeWise

 SELECT.REQUISITON.PENDING.DTL.HIVT_REQUISITION_DTL=select count(*) from hivt_requisition_dtl a where gnum_lab_code=? and gnum_test_code=?  And gnum_hospital_code=? and trunc(hivt_entry_date)<=trunc(sysdate) and hivnum_reqdtl_status in (2,3,4,5,6) and exists(select 1 from hivt_requisition_header where gnum_isvalid=1 and hrgnum_puk=? and hivnum_req_no=a.hivnum_req_no and gnum_hospital_code=? and trunc(hivdt_requisition_date)<=(sysdate))


UPDATE.REQUISITIONSTATUS.HIVT_REQUISITION_DTL=UPDATE hivt_requisition_dtl  SET  hivnum_reqdtl_status=? , hivtnum_test_delete_seatid=?,  hivtdt_test_delete_date=SYSDATE  WHERE hivnum_reqdtl_status in(?,?) AND gnum_hospital_code=? And  gnum_lab_code=? And gnum_test_code=?

SELECT.TEST.REQSTATUS.HIVT_REQUISITION_DTL=select  hivnum_reqdtl_status from hivt_requisition_dtl where  gnum_hospital_code=?   AND gnum_lab_code=? and gnum_test_code=?   and trunc(hivt_entry_date)=trunc(sysdate)  and hivnum_reqdtl_status in (2,3,4,5,6)


SELECT.PACKAGING_LIST_DETAILS.HIVT_REQUISITION_DTL= SELECT (select hrgstr_patname from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patName,(select hrgnum_puk from hivt_requisition_header where hivnum_req_no\=a.hivnum_req_no and gnum_hospital_code\=a.gnum_hospital_code) as patCRNo,hivtnum_req_dno as requisitionDNo,hgstr_daily_labno as strDailyLabNo, hivnum_issample_received as recieved, hivnum_isaccepted as accepted ,hivnum_req_no as requisitionNo, hivnum_isappointment as isAppointment, gnum_lab_code as labCode , pkg_inv_fun.fun_lab_name(gnum_lab_code,gnum_hospital_code) as labName, gnum_test_code as testCode, pkg_inv_fun.fun_test_name(gnum_test_code) as testName , hivnum_isconfidential, gbnum_priority_code as priorityCode , DECODE (gbnum_priority_code, 1, 'Normal',2,'Urgent') as priority, hivnum_sample_no as sampleNo, hivnum_reqdtl_status, hivnum_temp_sample_no as tempSampleNo, hgnum_group_code, hgnum_group_type, gnum_bill_no, gnum_sample_code, pkg_inv_fun.fun_sample_name(gnum_sample_code) as sampleName,(Select gnum_labno_config from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LAB_CODE )as labNoConfiguration, (hivnum_packing_list_no) as packingListNO, hivdt_coll_date_time as collDate, hivnum_sample_col_area_code, hivtdt_packinglist_date_time as packingListDate , hivnum_packing_list_seat_id FROM hivt_requisition_dtl a WHERE gnum_hospital_code\=? and TRUNC (hivtdt_packinglist_date_time) >\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) AND TRUNC (hivtdt_packinglist_date_time) <\=TRUNC (TO_DATE (?, 'DD-MON-YYYY')) and GNUM_LAB_CODE in (select GNUM_LAB_CODE from HIVT_LAB_COLLECTION_AREA_MST   where GNUM_ISVALID\=1 and gnum_hospital_Code \=? and GNUM_AREA_CODE\=?  ) and gnum_lab_code in ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p  where p.gbl_isvalid\=1  AND  p.gnum_module_id \= ?  AND p.gstr_table_name \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE' AND p.gnum_seatid \= ?  AND p.gnum_hospital_code \= ? ) 
														           																												
SELECT.LAB_WISE_TEST.RAISING_CUM_SELECTION.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode,(Select GNUM_SAMPLENO_CONFIG_FROM from hivt_laboratory_mst where GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE and GNUM_LAB_CODE\= a.GNUM_LABCODE ) as sampleNoConfig, a.gnum_test_code AS testCode, (SELECT INITCAP(gstr_lab_name)|| '-' || INITCAP (pkg_clinical_util_fun.get_dept_name(gnum_hospital_code,gnum_dept_code)) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode  AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name    FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,gnum_user_test_code as userTestCode, '1\#1' as sampleString  ,  GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,  NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired, NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText, hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent, gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,  hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1  AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode, (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType, '1\#1\#1' as mandInfo,   '1\#1' as mandCombo    FROM hivt_laboratory_test_mst a      WHERE a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=? AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p  WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?  AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'  AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?  AND gnum_hospital_code \= ?)    AND a.gnum_hospital_code \=? AND gnum_numof_test >\= (Select count(*) from hivt_requisition_dtl where GNUM_LAB_CODE \= a.GNUM_LABCODE and gnum_test_code \= a.gnum_test_code and     gnum_hospital_code \= a.gnum_hospital_code and HIVT_ENTRY_DATE \= sysdate)  AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID\=1 AND GSTR_TEST_TYPE\='S' AND GNUM_TEST_CODE\=A.GNUM_TEST_CODE)     \t\t\t

SELECT.TEST_COMBO_NAMES.CUM_COLL.HIVT_TEST_MST = select distinct(gnum_test_code), (select INITCAP(gstr_test_name) from hivt_test_mst where gnum_isvalid\=1 and gstr_test_type\='S' and gnum_test_code\=a.gnum_test_code ) as testName from hivt_laboratory_test_mst  a where gnum_isvalid\=1  and gnum_hospital_code \= ? order by testName

#SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST1=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code in (-1,?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc

#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_SAMPLENO_CONF_MST1=select   hivstr_running_lab_no as runningSampleNo from hivt_sampleno_conf_mst1  where gnum_lab_code\=? and gnum_test_code \=?\t and gnum_pat_type \=? AND gnum_is_valid\=1   and gnum_hospital_code\=? and gnum_sq_no\=?
#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.AJAX.CHECK.HIVT_COLAREA_SAMNO_CONFIG_MST=select    hivstr_running_lab_no as runningSampleNo     from hivt_colarea_samno_config_mst  where gnum_lab_code\=?   and gnum_area_code\=?  and gnum_pat_type \=?  AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?    

		
#modified to add hos code
UPDATE.SAMPLECOllDETAIL.RESET.RUNNING.NO.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET    hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_test_code \= ? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=? 

															
															
#UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_area_code =? and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code=? and gnum_sq_no=?  \t\t\t\t\t\t\t\t\t\t\t\t\t\t 



UPDATE.SAMPLECOLLDETAIL.RESET.RUNNING.NO.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET      hivstr_running_lab_no\=null where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type \=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=? \t\t\t\t\t\t\t\t\t\t\t\t\t\t 
		
#modified to add hos code
UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET   gdt_initialization_date\=?\:\:timestamp without time zone  ,hivstr_running_lab_no\=? where gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code \=? and gnum_pat_type\=? and gnum_hospital_code\=? and gnum_sq_no\=?

UPDATE.SAMPLECOLLDETAIL.HIVT_COLAREA_SAMNO_CONFIG_MST=UPDATE hivt_colarea_samno_config_mst   SET  gdt_initialization_date\=?\:\:timestamp without time zone,   hivstr_running_lab_no\=? where gnum_lab_code\=? and gnum_area_code \=? and gnum_pat_type\=? AND gnum_is_valid\=1 and gnum_hospital_code\=? and gnum_sq_no\=?  \t\t\t\t\t\t\t\t\t\t\t\t\t\t 


#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_SAMPLENO_CONF_MST1=select        gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_test_code as configTest,hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate, gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries , gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo, gnum_pat_type as patType   from hivt_sampleno_conf_mst1  where  gnum_is_valid\=1 and gnum_lab_code\=? and gnum_test_code in( -1 ,?)\t and gnum_pat_type in(3,?)  and gnum_hospital_code\=?  order by    gnum_lab_code desc,   gnum_machine_code desc, gnum_test_code desc,   gnum_pat_type    asc

#modified to add hos code
#UPDATE.SAMPLECOllDETAIL.HIVT_SAMPLENO_CONF_MS=UPDATE hivt_sampleno_conf_mst1   SET   gdt_initialization_date\=?\:\:timestamp without time zone  ,hivstr_running_lab_no\=? where gnum_is_valid=1 and gnum_lab_code\=? and gnum_test_code =? and gnum_pat_type\=? and gnum_hospital_code=? and gnum_sq_no=?
#modified to add hos code
SELECT.SAMPLE_COLL_DETAIL_AUTOGEN_SAMPLENO.HIVT_COLAREA_SAMNO_CONFIG_MST=select   gnum_lab_code as configLab, gnum_pat_type as configType, gnum_sq_no as configSeq, gnum_area_code as configArea, hivtstr_sampleno_format as SampleNoFormat ,gdt_initialization_date as initDate ,gnum_no_of_seq_digits as noOfSeqDigit,gnum_from_series as fromSeries,gnum_to_series as toSeries ,    gnum_init_type as initType, hivstr_running_lab_no as runningSampleNo,gnum_pat_type as patType   from hivt_colarea_samno_config_mst  where gnum_lab_code in (-1,?)  and gnum_area_code in (-1,?)  and gnum_pat_type in(3,?)  AND gnum_is_valid\=1   and gnum_hospital_code\=?  order by    gnum_lab_code desc, gnum_area_code desc,    gnum_pat_type    asc


SELECT.LAB_WISE_TEST_GROUP_TEST_CUM_COLL.HIVT_TEST_MST=SELECT   a.gnum_labcode AS labCode, a.gnum_test_code AS testCode,gstr_desk_properties as deskProperties, (SELECT INITCAP(gstr_lab_name) FROM hivt_laboratory_mst WHERE gnum_isvalid\=1 and gnum_lab_code \= a.gnum_labcode     AND gnum_hospital_code \= a.gnum_hospital_code) AS labName, (SELECT  gstr_test_name     FROM hivt_test_mst  WHERE gnum_isvalid\=1 and gnum_test_code \= a.gnum_test_code) AS testName,             GNUM_TEST_ORDER as testOrder, NVL(GNUM_ISMULTISESSION,0) as isMultiSession,  NVL(GBL_IS_APPOINTMENT,0) as isAppointment,    NVL(GNUM_ISREQUISITIONFORM_NEEDED,0) as isRequisitionFormNeeded,  NVL(gnum_is_sample_form_needed,'0') as isSampleFormNeeded ,    NVL(GNUM_IS_MANDATORY_REQ,'0') as isMandatoryReq,NVL(GNUM_GENDER_BOUND,0) as genderBound,  NVL(GBL_IS_GROSSING_REQUIRED,0) as isGrossingRequired,   NVL(GNUM_AGE_BOUND,0) as ageBound,   NVL(gnum_low_age_range,0) as lowAgeRange, NVL(gnum_high_age_range,0) as highAgeRange,  hivstr_header_text as testheaderText,     hivstr_footer_text as testFooterText,   NVL(gnum_is_film_required,0) as isFilmRequired, NVL(gnum_issecure_printing,0) as isSecurePrinting, NVL(hivtnum_isconsent,0) as isConsent,          gstr_test_method as testMethod, NVL(gnum_isconfidential,0) as isConfidential, gnum_sam_coll_area as samCollectionArea, hivtnum_test_printing_type as testPrintingType,     a.hivtnum_printing_template_id as printTemplateID, hivt_report_available_after as reportAvailableAfter,  (Select GNUM_SAMPLE_CODE from HIVT_LABTEST_SAMPLE_MST     where GNUM_LAB_CODE \= a.GNUM_LABCODE  and   GNUM_TEST_CODE \= a.GNUM_TEST_CODE and  GNUM_IS_DEFAULT_SAMPLE \= 1     AND   gnum_hospital_code \= a.gnum_hospital_code and GNUM_ISVALID\=1 ) as defaultSampleCode,         (Select GSTR_TEST_TYPE from HIVT_TEST_MST where gnum_isvalid\=1 and GNUM_TEST_CODE \= a.GNUM_TEST_CODE) as testType,          CONCATSTRING( 'Select HGNUM_MAND_CODE||''\#''||  (Select HGSTR_MANDATORY_NAME from HIVT_MANDATORY_MST    where gnum_isvalid\=1 and HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE ) ||''\#''||       (Select HIVNUM_MANDATORY_TYPE from HIVT_MANDATORY_MST where gnum_isvalid\=1 and  HGNUM_MAND_CODE\= k.HGNUM_MAND_CODE)  from  HIVT_TEST_MANDATORY_MST k      where  k.gnum_isvalid\=1 and k.gnum_test_code \='''||a.gnum_test_code||''' and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''',',') as mandInfo,       CONCATSTRING( '(Select  HGNUM_MAND_CODE ||''\#''|| hgstr_value from hivt_mand_combo_mst where HGNUM_MAND_CODE in      (Select k.HGNUM_MAND_CODE from HIVT_TEST_MANDATORY_MST k where   k.gnum_test_code \='''||a.gnum_test_code||'''     and k.GNUM_HOSPITAL_CODE \= '''||a.gnum_hospital_code||'''  )  )' ,',') as mandCombo  ,    hgnum_group_code as TestGroupCode ,        (select hgstr_group_name from hivt_test_group_mst where gnum_is_valid\=1 and hgnum_group_code\=b.hgnum_group_code                                              and gnum_hospital_code \=b.gnum_hospital_code) as SearchTestGroup             FROM hivt_laboratory_test_mst a  ,hivt_test_group_info_mst b\tWHERE b.gnum_is_valid\=1   and b.gnum_test_code\=a.gnum_test_code and b.gnum_lab_code\=a.gnum_labcode and b.gnum_hospital_code\=a.gnum_hospital_code and       a.gnum_is_test_available \= 1  AND  a.gnum_isvalid \= 1  AND a.gnum_hospital_code \=?        AND    gnum_labcode in (  SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p       WHERE p.gbl_isvalid \= 1    AND p.gnum_module_id \=?    AND p.gstr_table_name  \= 'HIVT_LABORATORY_MST'       AND p.gstr_column_name \= 'GNUM_LAB_CODE'   AND p.gnum_seatid \=?   AND gnum_hospital_code \= ?)              AND a.gnum_hospital_code \=?  AND EXISTS(SELECT 1 FROM HIVT_TEST_MST WHERE GNUM_ISVALID\=1 AND GSTR_TEST_TYPE\='S' AND GNUM_TEST_CODE\=A.GNUM_TEST_CODE)       ORDER BY  TestGroupCode,labCode\t\t   \t\t\t\t\t\t\t\t\t\t\t\t\t                                \t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t           \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t