

SELECT.CATEGORY.GBLT_PATIENT_CAT_MST.PRIMARY=  SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM \
										 GBLT_PATIENT_CAT_MST \
										 WHERE GNUM_PATIENT_CAT_TYPE=? \
										 AND GNUM_ISVALID=?	and GNUM_HOSPITAL_CODE=? and GNUM_PATIENT_CAT_CODE in (select a.GNUM_PATIENT_CAT_CODE from HMBT_PAT_CAT_MAPPING a where a.GNUM_ISVALID=GNUM_ISVALID and a.GNUM_HOSPITAL_CODE=GNUM_HOSPITAL_CODE) 								 
										 
SELECT.CERTIFCATE.HMBT_CERTIFICATE_TYPE_MST_OLD = SELECT HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,HMBSTR_CERTIFICATE_TYPE_NAME as certificateTypeName,HMBNUM_BOARD_ID as boardTypeID,HMBNUM_WEEK_DAY as weekDay,HMBNUM_MIN_REQ as minRequest,HMBNUM_MAX_REQ as maxRequest,HMBNUM_CERTIFICATE_CAT_ID as certificateCatID,HMBNUM_REQ_BY as requestBy FROM HMBT_CERTIFICATE_TYPE_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?

SELECT.CERTIFCATE.HMBT_CERTIFICATE_TYPE_MST = SELECT HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,HMBSTR_CERTIFICATE_TYPE_NAME as certificateTypeName,HMBNUM_BOARD_TYPE as boardTypeID,HMBNUM_MIN_REQ as minRequest,HMBNUM_MAX_REQ as maxRequest,HMBNUM_CERTIFICATE_CAT_ID as certificateCatID,HMBNUM_REQ_BY as requestBy,,HMBNUM_LOCATION_BOUND locationBound FROM HMBT_CERTIFICATE_TYPE_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=100

SELECT.CERTIFICATE_FOR_REQUISITION.HMBT_CERTIFICATE_TYPE_MST = SELECT hmbnum_certificate_type_id AS certificatetypeid,hmbstr_certificate_type_name AS certificateTypeName,hmbnum_board_type AS boardtypeid, hmbnum_min_req AS minrequest,hmbnum_max_req AS maxrequest,hmbnum_certificate_cat_id AS certificatecatid, hmbnum_req_by AS requestby,HMBNUM_LOCATION_BOUND locationBound,HGNUM_DEPTUNITCODE departmentUnitCode, \
	   											(SELECT NVL (SUM (hblnum_cost), 0) FROM hblt_charge_mst WHERE TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC(nvl (gdt_effective_to,sysdate)) >= TRUNC (SYSDATE) AND gnum_patient_cat_code = ? AND gnum_hospital_code = a.gnum_hospital_code AND sblnum_chargetype_id = ?  AND sblnum_ipd_chargetype_id = ? AND gnum_isvalid = a.gnum_isvalid \
   												AND hblnum_tariff_id =(SELECT hblnum_tariff_id FROM hblt_tariff_mst WHERE gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND sblnum_service_id = ? AND gstr_tariff_id = a.HMBNUM_CERTIFICATE_TYPE_ID AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE)))isBillApply,HMBNUM_MAX_AGE maxAge, HMBNUM_MIN_AGE minAge FROM hmbt_certificate_type_mst a \
 												WHERE gnum_isvalid = ? AND gnum_hospital_code = ? ORDER BY hmbstr_certificate_type_name

SELECT.ORGANISATION.HMBT_ORGANIZATION_MST = SELECT a.HMBNUM_ORGANIZATION_ID,a.HMBSTR_ORG_NAME FROM HMBT_ORGANIZATION_MST a WHERE  a.GNUM_ISVALID=? and a.GNUM_HOSPITAL_CODE=?

CHECKLIST_FOR_MEDICALBOARD.HMBT_CHECKLIST_MST = SELECT hmbnum_checklist_id AS checklistid,(SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE hmbnum_checklist_id = a.hmbnum_checklist_id and gnum_isvalid=a.gnum_isvalid and gnum_hospital_code=a.gnum_hospital_code) AS checklist, hmbnum_iscompulsory AS iscompulsory FROM hmbt_certificate_checklist_mst a WHERE hmbnum_certificate_type_id = ?  AND gnum_isvalid = ? AND gnum_hospital_code = ? \
											order by checklist 

SELECT_DEPARTMENT_DETAIL.HMBT_BOARD_CONFIGURATION=  SELECT GNUM_DEPT_CODE AS departmentCode,HGNUM_DEPTUNITCODE AS departmentUnitCode,HMSTR_DEPT_INCHARGE AS departmentIncharge,HGNUM_ROOM_CODE AS roomCode FROM HMBT_BOARD_CONFIGURATION WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?

SELECT_ORG_DTL.HMBT_ORGANIZATION_MST=  SELECT HMBSTR_ORG_NAME AS orgName,HMBNUM_ORG_TYPE AS orgTypeID,HMBSTR_ORG_ADDRESS AS orgAddress FROM HMBT_ORGANIZATION_MST WHERE HMBNUM_ORGANIZATION_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?


              
SELECT.CATEGORY_LIST.HMBT_CERTIFICATE_CAT_MST=  SELECT HMBNUM_CERTIFICATE_CAT_ID,HMBSTR_CERTIFICATE_CAT_NAME FROM HMBT_CERTIFICATE_CAT_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? order by HMBSTR_CERTIFICATE_CAT_NAME
               
SELECT.BOARDTYPE_LIST.HMBT_CERTIFICATE_CAT_MST=  SELECT HPMRNUM_FLAG_VALUE,HPMRSTR_FLAG_DESC FROM HPMRT_FLAG_MST WHERE HPMRNUM_TABLE_ID=? AND HPMRSTR_COLUMN_NAME='HMBNUM_BOARD_TYPE' order by HPMRSTR_FLAG_DESC

SELECT.DEPARTMENTLIST.HGBT_UNIT_MST= SELECT HGNUM_DEPTUNITCODE,INITCAP(HGSTR_UNITNAME) FROM HGBT_UNIT_MST A WHERE GNUM_ISVALID=? AND \
                                     GNUM_HOSPITAL_CODE=? AND GNUM_DEPT_CODE IN (SELECT GNUM_DEPT_CODE FROM HMBT_BOARD_CONFIGURATION WHERE GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=A.GNUM_ISVALID) order by HGSTR_UNITNAME
  

SELECT.DISTRICT_LIST.GBLT_DISTRICT_MST= SELECT GNUM_DISTRICT_CODE,GSTR_DISTRICT_NAME FROM GBLT_DISTRICT_MST WHERE  GNUM_ISVALID=? order by GSTR_DISTRICT_NAME

//------------------------------------------------Medical_Board_Requisition-----------------------------------------
SELECT.PATIENT.HRGT_EPISODE_DTL	=	SELECT hrgnum_puk patCrNo, gnum_dept_code department, hgnum_deptunitcode departmentUnit,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code AND gnum_hospital_code = a.gnum_hospital_code )departmentCode, \
                                   (SELECT HGSTR_UNITNAME FROM hgbt_unit_mst WHERE HGNUM_DEPTUNITCODE = a.HGNUM_DEPTUNITCODE and gnum_isvalid=1 AND gnum_hospital_code = a.gnum_hospital_code\
		 							) departmentUnitCode,(SELECT hrgstr_fname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patFirstName, (SELECT  hrgstr_mname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk \
		 							AND gnum_hospital_code = a.gnum_hospital_code) patMiddleName,(SELECT hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patLastName, (SELECT C.GSTR_GENDER_CODE FROM hrgt_patient_dtl c,gblt_gender_mst d WHERE c.hrgnum_puk = a.hrgnum_puk \
		 							and c.GSTR_GENDER_CODE=d.GSTR_GENDER_CODE  AND c.gnum_hospital_code = a.gnum_hospital_code and d.GNUM_ISVALID=a.gnum_isvalid) patGender, (SELECT ahis_util.dob_age_on(HRGDT_DOB,sysdate) FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk \
									AND gnum_hospital_code = a.gnum_hospital_code) patAge FROM hrgt_daily_patient_dtl a WHERE gnum_isvalid = ? AND gnum_hospital_code = ?  AND gnum_dept_code IN ( SELECT gnum_dept_code FROM hmbt_board_configuration WHERE gnum_isvalid = a.gnum_isvalid \
             						AND gnum_hospital_code = a.gnum_hospital_code) and trunc(gdt_entry_date)=trunc(sysdate) order by hrgnum_puk

SELECT.PATIENT_BY_CRNO.HRGT_EPISODE_DTL	=	SELECT hrgnum_puk patCrNo, gnum_dept_code department, hgnum_deptunitcode departmentUnit,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code AND gnum_hospital_code = a.gnum_hospital_code )departmentCode,(SELECT HGSTR_UNITNAME FROM hgbt_unit_mst WHERE HGNUM_DEPTUNITCODE = a.HGNUM_DEPTUNITCODE and gnum_isvalid=1 AND gnum_hospital_code = a.gnum_hospital_code \
		 							) departmentUnitCode,(SELECT hrgstr_fname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patFirstName, (SELECT  hrgstr_mname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk \
		 							AND gnum_hospital_code = a.gnum_hospital_code) patMiddleName,(SELECT hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patLastName, (SELECT GSTR_GENDER_NAME FROM hrgt_patient_dtl c,gblt_gender_mst d WHERE c.hrgnum_puk = a.hrgnum_puk \
		 							and c.GSTR_GENDER_CODE=d.GSTR_GENDER_CODE  AND c.gnum_hospital_code = a.gnum_hospital_code and d.GNUM_ISVALID=a.gnum_isvalid) patGender, (SELECT ahis_util.dob_age_on(HRGDT_DOB,sysdate) FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk \
									AND gnum_hospital_code = a.gnum_hospital_code) patAge FROM hrgt_episode_dtl a WHERE gnum_isvalid = ? AND gnum_hospital_code = ?  AND gnum_dept_code IN ( SELECT gnum_dept_code FROM hmbt_board_configuration WHERE gnum_isvalid = a.gnum_isvalid \
             						AND gnum_hospital_code = a.gnum_hospital_code) AND hrgnum_puk=? AND a.hrgnum_visit_no =1

SELECT.HMBT_LOCATION_ELIGIBILITY_MST =	select distinct NUM_DIST_ID districtId from HMBT_LOCATION_ELIGIBILITY_MST where HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=?             

SELECT.SCHEDULE.HOPT_DEPT_UNIT_ROSTER_DTL	=	SELECT distinct TO_CHAR (hopdt_start_dt, 'DD-Mon-YYYY') AS examDate, (SELECT COUNT (*) FROM hmbt_requisition_dtl WHERE trunc(hmbdt_exam_date) = trunc(a.hopdt_start_dt)  AND gnum_isvalid = a.GNUM_ISVALID AND gnum_hospital_code = a.gnum_hospital_code and HMBNUM_CERTIFICATE_TYPE_ID=?) AS registeredReq, \
         									(SELECT hmbnum_min_req FROM hmbt_certificate_type_mst WHERE gnum_isvalid = a.GNUM_ISVALID AND gnum_hospital_code = ? AND hmbnum_certificate_type_id = ?) AS minReq, (SELECT hmbnum_max_req FROM hmbt_certificate_type_mst WHERE gnum_isvalid = a.GNUM_ISVALID \
             								AND gnum_hospital_code = ? AND hmbnum_certificate_type_id = ?) AS maxReq FROM hopt_dept_unit_roster_dtl a WHERE hopnum_deptunitcode = ?  AND trunc(hopdt_start_dt) >= trunc(SYSDATE)  AND gnum_isvalid = ?  AND gnum_hospital_code = ? ORDER BY examDate             

SELECT.BY_CRNO.HMBT_REQUISITION_DTL= 	SELECT hrgnum_puk patCrNo,hmbnum_req_id reqid, hmbnum_slno slno, hmbnum_certificate_type_id certificatetypeid, (SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_isvalid = a.gnum_isvalid \
           							) certificatetypename,to_char(hmbdt_exam_date,'dd-Mon-yyyy') examdate, (SELECT HGNUM_DEPTUNITCODE FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_isvalid = a.gnum_isvalid  \
           	                         ) departmentUnitCode,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code)patName FROM hmbt_requisition_dtl a WHERE hrgnum_puk like ?  \
           							AND hmbnum_req_status = ? AND gnum_isvalid = ?  AND gnum_hospital_code = ?  AND hmbdt_exam_date >= TRUNC (SYSDATE) order by certificatetypename,hmbdt_exam_date 
           							
INSERT.HMBT_REQ_CHANGE_DTL		=	insert into HMBT_REQ_CHANGE_DTL (HMBNUM_REQ_ID, HMBNUM_SLNO, HMBDT_OLD_EXAM_DATE, HMBDT_NEW_EXAM_DATE, HMBSTR_REASON, HMBDT_APPROVED_DATE, HMBSTR_APPROVED_BY, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, HMBNUM_REQ_MODE) \
									values(?,(select nvl(max(hmbnum_slno),0)+1 from HMBT_REQ_CHANGE_DTL where HMBNUM_REQ_ID=? and gnum_hospital_code=?),to_date(?,'dd-Mon-yyyy'),to_date(?,'dd-Mon-yyyy'),?,to_date(?,'dd-Mon-yyyy'),?,?,?,sysdate,?,?) 

SELECT.BY_ORG.HMBT_REQUISITION_DTL	= 	SELECT hrgnum_puk patCrNo,hmbnum_req_id reqid, hmbnum_slno slno, hmbnum_certificate_type_id certificatetypeid, (SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_isvalid = a.gnum_isvalid \
           							AND gnum_hospital_code = 100) certificatetypename,to_char(hmbdt_exam_date,'dd-Mon-yyyy') examdate, (SELECT HGNUM_DEPTUNITCODE FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = \
           							100) departmentUnitCode,HMBSTR_ORG_NAME orgName,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code)patName FROM hmbt_requisition_dtl a WHERE hmbnum_req_status = ? \
           							AND gnum_isvalid = ?  AND gnum_hospital_code = ?  AND hmbdt_exam_date >= TRUNC (SYSDATE) 
           							
SELECT.BILL_DETAIL.HBLT_BILL_SERVICE_DTL	=	SELECT a.gstr_tariff_id AS tarriff, hblnum_bill_no AS billno,a.SBLNUM_SERVICE_ID serviceId,NVL (hblnum_remained_qty, 0) AS remainedquantity FROM HBLT_BILL_SERVICE_DTL a, SBLT_OUTBOUND_DTL b WHERE a.gnum_isvalid = ? AND b.gnum_isvalid = a.gnum_isvalid AND a.gnum_hospital_code = b.gnum_hospital_code \
   									AND a.gnum_hospital_code = ? AND b.hblnum_trans_no = a.hblnum_bill_no AND b.hblnum_status = ? AND b.sblnum_chargetype_id = ? AND b.sblnum_bservice_id = ? AND b.sblnum_service_id = ? AND b.hblnum_trans_type = ? AND b.HRGNUM_PUK =?

SELECT.COUNT_BY_CRNO.HMBT_REQUISITION_DTL	=	SELECT count(*) FROM hmbt_requisition_dtl a WHERE HRGNUM_PUK=? AND HMBNUM_CERTIFICATE_TYPE_ID=? and	gnum_hospital_code = ? AND gnum_isvalid = ? AND (hmbnum_req_status IN (?, ?, ?, ?, ?) or trunc(GDT_ENTRY_DATE)=trunc(sysdate)) 


 
   									
//------------------------------------------------Candidate_Acceptance-------------------------------------------------   	

SELECT.CERTIFICATE_TYPE.HMBT_REQUISITION_DTL	=	SELECT DISTINCT hmbnum_certificate_type_id,Initcap((SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid)) certificatetypename \
           											FROM hmbt_requisition_dtl a WHERE hmbdt_exam_date =?::timestamp without time zone AND gnum_hospital_code = ? AND gnum_isvalid = ? and HMBNUM_REQ_STATUS in(?,?) order by certificatetypename 
           											
SELECT.PATIENT_FOR_MB_ACCEPTANCE.HMBT_REQUISITION_DTL	=	SELECT hrgnum_puk patCrNo,HMBNUM_REQ_ID reqId,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code)patName, hmbnum_certificate_type_id certificateTypeId, (SELECT hmbstr_certificate_type_name \
          											FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id  AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT c.GSTR_GENDER_NAME||'/'|| ahis_util.dob_age_on(HRGDT_DOB,sysdate) FROM hrgt_patient_dtl b,\
          											gblt_gender_mst c WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code AND  b.GSTR_GENDER_CODE=c.GSTR_GENDER_CODE and c.gnum_isvalid=a.GNUM_ISVALID)patAgeGender,(SELECT HGNUM_DEPTUNITCODE FROM hmbt_certificate_type_mst \
          											WHERE HMBNUM_CERTIFICATE_TYPE_ID = a.HMBNUM_CERTIFICATE_TYPE_ID AND gnum_hospital_code = 100 and gnum_isvalid=a.GNUM_ISVALID) departmentUnitCode,(SELECT count(*)+1 FROM hmbt_medical_visit_dtl WHERE HMBNUM_REQ_ID = a.HMBNUM_REQ_ID AND gnum_hospital_code = a.gnum_hospital_code \
             										AND gnum_isvalid = a.gnum_isvalid) visitNo,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate,HMBNUM_BOARD_NO boardNo,(SELECT hmbstr_board_name FROM hmbt_board_mst m, hmbt_board_dtl n WHERE m.hmbnum_board_id = n.hmbnum_board_id and a.HMBNUM_BOARD_NO=n.HMBNUM_BOARD_NO and m.gnum_isvalid=a.gnum_isvalid  \
             										and m.gnum_isvalid=n.gnum_isvalid and m.gnum_hospital_code=a.gnum_hospital_code and n.gnum_hospital_code=m.gnum_hospital_code)boardName FROM HMBT_REQUISITION_DTL a WHERE TRUNC (hmbdt_exam_date) = TRUNC (to_date(?,'dd-Mon-yyyy'))  AND gnum_hospital_code = ? AND gnum_isvalid = ? AND hmbnum_certificate_type_id LIKE ?  \
             										and HMBNUM_REQ_STATUS in(?,?) ORDER BY entryDate  
		   											
SELECT.CHECKLIST_COMPULSORY_AT_ACCEPTANCE.HMBT_CERTIFICATE_CHECKLIST_MST	=	SELECT hmbnum_certificate_type_id certificateTypeID, hmbnum_iscompulsory isCompulsory, (SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE hmbnum_checklist_id = a.hmbnum_checklist_id  AND gnum_isvalid = a.gnum_isvalid) checklist \
  													,HMBNUM_CHECKLIST_ID checklistId FROM HMBT_CERTIFICATE_CHECKLIST_MST a WHERE gnum_hospital_code = ?  AND gnum_isvalid = ? and HMBNUM_CERTIFICATE_TYPE_ID=? AND hmbnum_checklist_id NOT IN (SELECT hmbnum_checklist_id FROM hmbt_req_checklist_dtl WHERE hmbnum_req_id = ? AND gnum_hospital_code = a.gnum_hospital_code \
               										AND a.gnum_isvalid = a.gnum_isvalid) order by checklist           											
           																			           							           							                       
SELECT.HMBT_REQ_CHECKLIST_DTL =	SELECT hmbnum_req_id, HMBNUM_CHECKLIST_ID checklistId, (SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE hmbnum_checklist_id = a.hmbnum_checklist_id  AND gnum_hospital_code = ? AND gnum_isvalid = a.gnum_isvalid) checklist,HMBSTR_REMARKS remarks FROM hmbt_req_checklist_dtl a WHERE hmbnum_req_id = ? AND gnum_isvalid = ?


SELECT.BOARD_NO.BOARD_NAME.HMBT_BOARD_DTL	=	select hmbnum_board_no,(select hmbstr_board_name from hmbt_board_mst where hmbnum_board_id=a.hmbnum_board_id and gnum_hospital_code=a.gnum_hospital_code  and gnum_isvalid=a.gnum_isvalid) boardname from hmbt_board_dtl a where trunc(hmbdt_board_starttime)= trunc(to_date(?,'dd-Mon-yyyy')) and hmbnum_certificate_type_id=? \
  												and hmbnum_board_status= ? and gnum_isvalid=? and gnum_hospital_code=?

SELECT.EPISODE_DTL.BY_CRNO.HRGT_EPISODE_DTL	= SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												 a.hrgnum_admission_no AS admissionno,a.hrgnum_mlc_flag AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,decode(a.hrgnum_visit_no,1,0,1) AS patisold,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS episodedate,TO_CHAR (a.gdt_entry_date, 'hh24:mi') AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgnum_is_episode_open AS episodeisopen,a.psrstr_doc_emp_no AS empno,  pkg_clinical_gbl_fun.get_emp_name(a.gnum_hospital_code::character varying,a.psrstr_doc_emp_no) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode, \
								                 hgnum_treatment_cat_code AS patsecondarycatcode,a.hgnum_patient_cat_code AS patprimarycatcode,pkg_clinical_gbl_fun.get_dept_name(a.gnum_hospital_code::character varying,a.gnum_dept_code::character varying) AS department, \
								                  pkg_clinical_gbl_fun.get_deptunit_name(a.gnum_hospital_code::character varying,a.hgnum_deptunitcode::character varying) AS departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, pkg_clinical_gbl_fun.get_deptunit_name(a.gnum_hospital_code::character varying,a.hgnum_deptunitcode::character varying)  \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room,(DECODE ((SELECT count(1) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
												AND ( hopnum_deptunitcode =a.hgnum_deptunitcode)),0, 0,1)) deptunitisonduty,(DECODE (NVL((SELECT 1 FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1),0), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,DECODE(trunc(a.gdt_entry_date),trunc(sysdate),1,0) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) isgeneral \
												FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_type IN (1, 4) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = a.HRGNUM_PUK) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code=a.gnum_hospital_code) AND (z.gnum_isvalid = a.gnum_isvalid) AND z.hrgnum_visit_type = a.hrgnum_visit_type ) \
												AND GNUM_DEPT_CODE IN (SELECT GNUM_DEPT_CODE FROM HMBT_BOARD_CONFIGURATION WHERE GNUM_ISVALID = A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) ORDER BY A.HRGNUM_EPISODE_CODE  												

INSERT.HMBT_MEDICAL_VISIT_DTL	=	insert into HMBT_MEDICAL_VISIT_DTL (HMBNUM_REQ_ID, HMBNUM_VISIT_NO, HRGNUM_PUK, HRGNUM_EPISODE_CODE,HRGNUM_VISIT_NO, HMBSTR_REASON, HMBDT_VISIT_DATE, HMBNUM_BOARD_NO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HMBNUM_IS_REFERRED, HMBNUM_IS_INV_RAISED) \
									values(?,(select nvl(max(HMBNUM_VISIT_NO),0)+1 from HMBT_MEDICAL_VISIT_DTL where HMBNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?),?,?,?,?,sysdate,?,?,?,sysdate,?,?,?)
			
SELECT.MAX_EPISODE_CODE.HRGT_EPISODE_DTL	=	SELECT hrgnum_puk patcrno, hrgnum_episode_code episodecode, hrgnum_visit_no episodeVisitNo FROM hrgt_episode_dtl a WHERE hrgnum_puk = ? AND gnum_isvalid = ? AND gnum_hospital_code = ? AND hrgnum_episode_code = (SELECT MAX (hrgnum_episode_code) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk \
              									AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) AND hrgnum_visit_no = (SELECT MAX (hrgnum_visit_no) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)
									
									
//------------------------------------------------Medical_Exam_Initiation------------------------------------------------------------
SELECT.CERTIFICATE_TYPE_FOR_MEDICAL_EXAM.HMBT_REQUISITION_DTL	=	SELECT DISTINCT hmbnum_certificate_type_id,Initcap((SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code =101 AND gnum_isvalid = a.gnum_isvalid)) certificatetypename \
           											FROM hmbt_requisition_dtl a WHERE gnum_hospital_code = ? AND gnum_isvalid = ? and HMBNUM_REQ_STATUS=? AND HRGNUM_PUK IN (SELECT B.HRGNUM_PUK FROM HMBT_MEDICAL_VISIT_DTL B WHERE TRUNC (HMBDT_VISIT_DATE) = TRUNC (SYSDATE) AND A.HMBNUM_REQ_ID = B.HMBNUM_REQ_ID AND B.HMBNUM_VISIT_NO =(SELECT MAX (HMBNUM_VISIT_NO) FROM HMBT_MEDICAL_VISIT_DTL WHERE HMBNUM_REQ_ID = B.HMBNUM_REQ_ID AND GNUM_HOSPITAL_CODE = B.GNUM_HOSPITAL_CODE AND GNUM_ISVALID = B.GNUM_ISVALID)) order by certificatetypename
           											
SELECT.PATIENT_FOR_MB_EXAM.HMBT_REQUISITION_DTL_OLD	=	SELECT hrgnum_puk patCrNo,HMBNUM_REQ_ID reqId,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code)patName, hmbnum_certificate_type_id certificateTypeId, (SELECT hmbstr_certificate_type_name \
          											FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT c.GSTR_GENDER_SHORT||'/'|| ahis_util.dob_age_on(HRGDT_DOB,sysdate) FROM hrgt_patient_dtl b,\
          											gblt_gender_mst c WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_hospital_code = c.gnum_hospital_code and b.GNUM_GENDER_CODE=c.GNUM_GENDER_CODE and c.gnum_isvalid=a.GNUM_ISVALID)patAgeGender,(SELECT HGNUM_DEPTUNITCODE FROM hmbt_certificate_type_mst \
          											WHERE HMBNUM_CERTIFICATE_TYPE_ID = a.HMBNUM_CERTIFICATE_TYPE_ID  and gnum_isvalid=a.GNUM_ISVALID) departmentUnitCode,(SELECT count(*) FROM hmbt_medical_visit_dtl WHERE HMBNUM_REQ_ID = a.HMBNUM_REQ_ID AND gnum_hospital_code = a.gnum_hospital_code \
             										AND gnum_isvalid = a.gnum_isvalid) visitNo,(SELECT hrgnum_episode_code FROM hmbt_medical_visit_dtl p WHERE hmbnum_req_id = a.hmbnum_req_id AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND hmbnum_visit_no = (SELECT MAX (hmbnum_visit_no) FROM hmbt_medical_visit_dtl \
							 	                    WHERE hmbnum_req_id = p.hmbnum_req_id AND gnum_hospital_code = p.gnum_hospital_code AND gnum_isvalid = p.gnum_isvalid)) episodecode, (SELECT MAX (hmbnum_visit_no) FROM hmbt_medical_visit_dtl WHERE hmbnum_req_id = a.hmbnum_req_id AND gnum_hospital_code = a.gnum_hospital_code \
							                        AND gnum_isvalid = a.gnum_isvalid) episodeVisitNo,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate FROM HMBT_REQUISITION_DTL a WHERE TRUNC (hmbdt_exam_date) = TRUNC (SYSDATE) AND gnum_hospital_code = ? AND gnum_isvalid = ? AND hmbnum_certificate_type_id LIKE ?  and HMBNUM_REQ_STATUS=? ORDER BY upper(certificatetypename),entryDate

SELECT.PATIENT_FOR_MB_EXAM.HMBT_REQUISITION_DTL	=	SELECT  a.hrgnum_puk patcrno, a.hmbnum_req_id reqid,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' '|| hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patname, hmbnum_certificate_type_id certificatetypeid, (SELECT hmbstr_certificate_type_name \
            										FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT  c.gstr_gender_name || '/' || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) FROM hrgt_patient_dtl b, gblt_gender_mst c \
           											WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_hospital_code = ? AND b.gstr_gender_code = c.gstr_gender_code AND c.gnum_isvalid = a.gnum_isvalid) patagegender, (SELECT hgnum_deptunitcode FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = \
                              						a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid) departmentunitcode, HMBNUM_VISIT_NO visitno, hrgnum_episode_code episodecode, b.hmbnum_visit_no episodevisitno, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') entrydate, HMBNUM_IS_REFERRED isReferred, HMBNUM_IS_INV_RAISED isInvestigationRaised, \
                              						decode((select distinct HRGNUM_PUK from hrgt_episode_ref_dtl where HRGNUM_PUK=a.HRGNUM_PUK and gnum_hospital_code=a.gnum_hospital_code),null,0,1) referStatus,DECODE ((SELECT DISTINCT hrgnum_puk FROM hivt_requisition_header WHERE hrgnum_puk = a.hrgnum_puk), NULL, 0,1) invstatus, DECODE ((SELECT DISTINCT hmbnum_req_id \
                              						FROM hmbt_req_ext_refer_dtl WHERE gnum_hospital_code = a.gnum_hospital_code AND hmbnum_req_id = a.hmbnum_req_id), NULL, 0, 1 ) extReferStatus, \
                              						(SELECT GST_FILE_NAME FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_is_default = 1 AND gnum_isvalid = 1 and rownum=1) AS ImageFileNo, \
                              						(SELECT COUNT (1) FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_is_default = 1 AND gnum_isvalid = 1) AS isimageuploaded	 \
    												FROM hmbt_requisition_dtl a,hmbt_medical_visit_dtl b WHERE  TRUNC (HMBDT_VISIT_DATE) = TRUNC (SYSDATE)  AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND hmbnum_certificate_type_id=?  AND hmbnum_req_status = ? and a.HMBNUM_REQ_ID=b.HMBNUM_REQ_ID and b.hmbnum_visit_no = (SELECT MAX (hmbnum_visit_no) FROM hmbt_medical_visit_dtl \
                      								WHERE hmbnum_req_id = b.hmbnum_req_id AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid) ORDER BY patname, entrydate 
             										
SELECT.BY_CERTIFICATE_TYPE.HMBT_REFER_MAPPING	=	SELECT hmbnum_certificate_type_id certificatetypeid, hmbnum_refer_type refertype, gnum_dept_code departmentcode, hgnum_deptunitcode departmentunitcode, hmbstr_refer_remarks referremarks,(SELECT gstr_dept_name \
													FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code AND gnum_hospital_code = a.gnum_hospital_code ) \
                                                    department,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=1 ) \
                                                    departmentunit,HMBNUM_IS_OPTIONAL isOptional FROM hmbt_refer_mapping a WHERE hmbnum_certificate_type_id = ?  AND gnum_hospital_code = ? AND gnum_isvalid = ?   order by department,departmentUnit
                                                    
SELECT.HMBT_BOARD_CONFIGURATION		=	 select HGNUM_DEPTUNITCODE from HMBT_BOARD_CONFIGURATION where gnum_hospital_code=? and gnum_isvalid=?

UPDATE.HMBT_MEDICAL_VISIT_DTL	=	update HMBT_MEDICAL_VISIT_DTL set HMBNUM_IS_REFERRED=? where HMBNUM_REQ_ID=? and HMBNUM_VISIT_NO=? and gnum_isvalid=? and gnum_hospital_code=? 

UPDATE.HMBNUM_IS_INV_RAISED.HMBT_MEDICAL_VISIT_DTL	=	update HMBT_MEDICAL_VISIT_DTL set HMBNUM_IS_INV_RAISED=? where HMBNUM_REQ_ID=? and HMBNUM_VISIT_NO=? and gnum_isvalid=? and gnum_hospital_code=? 

SELECT.REF_DTL_FROM_MEDICAL_BOARD.HRGT_EPISODE_REF_DTL		=	SELECT a.hrgnum_puk AS patcrno, INITCAP (hrgstr_fname || '  ' || hrgstr_mname || '  ' || hrgstr_lname ) AS patname, (SELECT gstr_dept_name  FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_from_dept_code AND gnum_hospital_code = a.gnum_hospital_code ) AS fromdepartment,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_from_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=1 ) fromdepartmentunit,TO_CHAR (hrgdt_reff_date_time, 'DD-MON-YYYY') AS reffdatetime, \
   													INITCAP (a.gstr_remarks) AS remarks, hrgnum_to_dept_code AS todepartmentcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.hrgnum_to_dept_code AND gnum_hospital_code = a.gnum_hospital_code ) AS todepartment, hgnum_to_deptunitcode AS todepartmentunitcode, \
       												a.hrgnum_episode_code AS episodecode, a.hrgnum_visit_no AS episodevisitno, a.hrgnum_s_no AS serialno, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_to_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=1 ) \
                                          			AS todepartmentunit,a.hrgnum_from_dept_code AS fromdepartmentcode, to_char(a.gdt_acceptance_date,'dd-Mon-yyyy') episodeReferAcceptDate,coalesce(a.gdt_acceptance_date::character varying,'1','0')isAccepted FROM hrgt_episode_ref_dtl a, hrgt_daily_patient_dtl b WHERE b.hrgnum_puk = a.hrgnum_puk AND b.hrgnum_episode_code = a.hrgnum_episode_code AND b.hrgnum_visit_no = a.hrgnum_visit_no AND b.gnum_dept_code = a.hrgnum_from_dept_code AND a.hrgnum_to_dept_code IS NOT NULL \
   													AND b.gnum_hospital_code = a.gnum_hospital_code and a.HRGNUM_PUK = ?  and a.gnum_hospital_code=? AND hrgnum_from_dept_code IN (SELECT gnum_dept_code FROM hmbt_board_configuration WHERE gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = ?) order by reffDatetime,todepartment,todepartmentUnit 		  
										                                             
SELECT.LAB_TEST.HMBT_INVESTIGATION_MAPPING	=	SELECT   a.gnum_lab_test_code labtestcode,SUBSTR (a.gnum_lab_test_code, 0, 5) labcode,(SELECT gstr_test_name FROM gblt_test_mst WHERE gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 9) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE)) \
                                                labtestname, SUBSTR (a.gnum_lab_test_code, 6, 9) testCode, (SELECT gstr_lab_name FROM gblt_laboratory_mst WHERE gnum_lab_code = SUBSTR (a.gnum_lab_test_code, 0, 5) AND gnum_hospital_code = a.gnum_hospital_code AND gbl_isvalid = a.gnum_isvalid AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE)) labname,hmbnum_is_optional isoptional, \
    											 (SELECT GSTR_TEST_TYPE FROM gblt_test_mst WHERE gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 9) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE)) \
                                                 testType FROM hivt_laboratory_test_dtl a, hmbt_investigation_mapping b WHERE a.gnum_isvalid = ?  AND a.gnum_hospital_code = ? AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND a.gnum_lab_test_code = b.gnum_lab_test_code AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_isvalid = a.gnum_isvalid \
     											 AND hmbnum_certificate_type_id = ? ORDER BY labtestname

SELECT.SAMPLE.HIVT_TEST_SAMPLE_MST	=	SELECT HGNUM_TEST_SAMPLE_CODE sampleCode,(SELECT gstr_sample_name FROM gblt_sample_mst WHERE gnum_sample_code = SUBSTR (b.hgnum_test_sample_code, 5, 7) AND gnum_isvalid = b.gnum_isvalid AND gnum_hospital_code = b.gnum_hospital_code) SampleName FROM hivt_test_sample_mst b WHERE gnum_isvalid = ? AND gnum_hospital_code = ?  and GNUM_GROUPCODE=? and GNUM_IS_GROUPCODE=?  

SELECT.SAMPLE.HIVT_LABTEST_SAMPLE_MST	=	SELECT GNUM_LAB_CODE||hgnum_test_sample_code samplecode,(SELECT gstr_sample_name FROM gblt_sample_mst WHERE gnum_sample_code = SUBSTR (b.hgnum_test_sample_code, 5, 3) AND gnum_isvalid = b.gnum_isvalid AND gnum_hospital_code = b.gnum_hospital_code) samplename FROM hivt_labtest_sample_mst b WHERE gnum_isvalid = ? AND gnum_hospital_code = ? AND gnum_groupcode = ? AND gnum_is_groupcode =?
    													
    													
SELECT.PATIENT_DTL.HRGT_PATIENT_DTL		=	SELECT hpd.hrgnum_puk AS patcrno, hpd.hrgstr_fname AS patfirstname, hpd.hrgstr_mname AS patmiddlename, hpd.hrgstr_lname AS patlastname, hpd.hrgstr_father_name AS patguardianname, hpd.hgnum_pat_status_code AS patstatuscode, hpd.hgnum_patient_cat_code AS patcategorycode, getage (hpd.hrgdt_dob) AS patage, hpd.hrgstr_spousename AS pathusbandname, hpd.gnum_gender_code AS patgendercode, hed.hrgnum_visit_no, \
       										SUBSTR (hpd.hrgnum_puk, 1, 3) AS hospitalcode, 'OPD' AS patstatus, hed.hrgnum_episode_code, (SELECT INITCAP (ggm.gstr_gender_name) FROM gblt_gender_mst ggm WHERE ggm.gnum_gender_code = hpd.gnum_gender_code AND ggm.gnum_hospital_code = SUBSTR (hpd.hrgnum_puk, 1, 3)) AS patgender, (SELECT gstr_patient_cat_name FROM gblt_patient_cat_mst rt WHERE rt.gnum_patient_cat_code = hpd.hgnum_patient_cat_code \
       										AND TO_DATE (rt.gdt_effective_frm) <= TRUNC (SYSDATE) AND NVL (TO_DATE (rt.gdt_effective_to), SYSDATE) >= SYSDATE AND rt.gnum_hospital_code = SUBSTR (hpd.hrgnum_puk, 1, 3)) AS patcategory, TO_CHAR (hed.gdt_entry_date, 'dd-Mon-YYYY') AS patvisitdate, hed.hgnum_deptunitcode AS patdeptunitcode, DECODE (hed.hrgnum_visit_type, 0, 'OPD', 1, 'IPD', 2, 'EMERGENCY') AS patstatus, hed.hrgstr_mlc_no AS patmlcno, \
       										DECODE (hed.hrgstr_mlc_no, NULL, 'NONMLC') AS patmlc,(SELECT (SELECT gstr_dept_name FROM gblt_department_mst gd WHERE gd.gnum_dept_code = um.hgnum_dept_code AND gd.gnum_hospital_code = SUBSTR (hed.hrgnum_puk, 1, 3) AND TO_DATE (gd.gdt_effective_frm) <= SYSDATE AND NVL (TO_DATE (gd.gdt_effective_to), SYSDATE) >= SYSDATE) || '-' || hgstr_unitname FROM hgbt_unit_mst um WHERE um.hgnum_deptunitcode = hed.hgnum_deptunitcode \
           									AND um.gnum_hospital_code = SUBSTR (hed.hrgnum_puk, 1, 3) AND um.gnum_isvalid=1) AS patdeptunit, hrgnum_visit_type AS patvisittypecode FROM hrgt_episode_dtl hed, hrgt_patient_dtl hpd WHERE hed.hrgnum_puk = ? AND hed.hrgnum_episode_code = ? AND hed.hrgnum_visit_no = ? and hed.hrgnum_puk=hpd.hrgnum_puk and hed.gnum_hospital_code=hpd.gnum_hospital_code \
											and hed.gnum_hospital_code=?

SELECT.EPISODE_DTL.BY_EPISODE_CODE_VIST_NO.HRGT_EPISODE_DTL	= SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gnum_isvalid=1 and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode AND gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT hopnum_deptunitcode FROM hopt_dept_unit_roster_dtl WHERE gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
												AND ( hopnum_deptunitcode =a.hgnum_deptunitcode)),NULL, 0,1)) deptunitisonduty,(DECODE ((SELECT gnum_isvalid FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and HGNUM_UNIT_SLNO = (select max( HGNUM_UNIT_SLNO) from  hgbt_unit_mst where hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_hospital_code = a.gnum_hospital_code)), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,check_visited_today (a.hrgnum_puk,a.hgnum_deptunitcode,a.hrgnum_episode_code,a.gnum_hospital_code) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE gnum_isvalid=1 and  ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code) isgeneral \
												FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_type IN (1, 4) AND a.hrgnum_visit_no =? and HRGNUM_EPISODE_CODE=? \
												AND GNUM_DEPT_CODE IN (SELECT GNUM_DEPT_CODE FROM HMBT_BOARD_CONFIGURATION WHERE GNUM_ISVALID = A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE)

SELECT.REQUISITION_STATUS.HIVT_REQUISITION_DTL	=	SELECT  distinct to_char(hrh.hivnum_req_no) AS reqno,hrh.hrgnum_puk AS patcrno,hrh.hrgstr_episode_code AS episodecode, hrh.hgnum_visitno AS episodevisitno, hrh.hivt_requisition_date, TO_CHAR (hrh.hivt_requisition_date, 'dd-Mon-yyyy') AS reqdate, hrh.gbnum_status_code AS reqstatuscode, \
										 		hrd.hivtnum_req_dno AS requisitiondno,SUBSTR (hrd.gnum_lab_test_code, 1, 5) AS laboratorycode,hrd.gnum_lab_test_code labTestcode, SUBSTR (hrd.gnum_lab_test_code, 6, 4) AS testcode, glm.gstr_lab_name AS laboratoryname, gtm.gstr_test_name AS testname, hrd.gbnum_status_code AS teststatuscode, TO_CHAR (hrd.hivdt_result_date) AS resultdate, \
									     		hrd.gbnum_priority_code AS prioritycode, DECODE (hrd.gbnum_priority_code, 0, 'NORMAL',1, 'Urgent', 2, ' Low', 'Unknown') AS priorityname, gtm.gstr_test_type AS testtype,hrd.hgnum_samplegroup_code AS samplegroupcode,DECODE ((SELECT COUNT (hrdf.hivtnum_req_dno) FROM hivt_requisition_dtl hrdf	\
									            WHERE SUBSTR (hrdf.hivtnum_req_dno, 1, 18) = SUBSTR (hrd.hivtnum_req_dno, 1, 18) AND hrdf.gnum_lab_test_code = hrd.gnum_lab_test_code AND hrdf.hgnum_samplegroup_code = hrd.hgnum_samplegroup_code AND hrdf.gbnum_status_code IN (9, 16, 17, 18)), 0, 'READY','NOTREADY') AS istestready, \
										        DECODE (gtm.gstr_test_type, 'I', (SELECT hsd.hivnum_sample_no FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno AND hsd.gbnum_status_code IN (12, 13, 14, 15)), 'S', (SELECT hsd.hivnum_sample_no FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno \
									            AND hsd.gbnum_status_code IN (12, 13, 14, 15)), '') AS sampleno, DECODE (gtm.gstr_test_type,'S', (SELECT hsd.hgstr_labno FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno), 'I', (SELECT hsd.hgstr_labno FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno), \
									            (SELECT hpad.hivtstr_labno FROM hivt_patient_acceptance_dtl hpad WHERE hpad.hivtnum_req_dno = hrd.hivtnum_req_dno)) AS labno,DECODE (gtm.gstr_test_type, 'I', (SELECT hsd.hivnum_packing_list_no FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno AND hsd.gbnum_status_code IN (12, 13, 14, 15)), \
									            'S', (SELECT hsd.hivnum_packing_list_no FROM hivt_sample_dtl hsd WHERE hsd.hivtnum_req_dno = hrd.hivtnum_req_dno AND hsd.gbnum_status_code IN (12, 13, 14, 15)), '') AS packinglistno, (SELECT INITCAP (hpd.hrgstr_fname) || ' ' || INITCAP (NVL (hpd.hrgstr_mname, ' '))|| ' '|| INITCAP (NVL (hpd.hrgstr_lname, ' ')) \
									            FROM hrgt_patient_dtl hpd WHERE hpd.hrgnum_puk = hrh.hrgnum_puk) AS patname,hltd.gbl_multi_session AS istestmultisession, (SELECT gsmst.gstr_sample_name FROM gblt_sample_mst gsmst WHERE gsmst.gnum_sample_code = hrd.hgnum_sample_code)AS samplename,hrd.hivtnum_res_val_seatid AS resultvalidatedby, \
									         	hrh.hipstr_ward_name AS wardname,TO_CHAR (hrh.hrgdt_episode_date, 'dd-Mon-yyyy') AS visitdate,hrh.hipnum_room_code AS roomname, hrh.hipnum_bed_code AS bedcode, hrh.hipstr_bed_name AS bedname, (SELECT pepd12.str_emp_full_name  FROM pist_emp_registration_dtl pepd12 \
									            WHERE pepd12.str_emp_no = hrh.hgstr_ordered_by_doc   and PEPD12.GNUM_HOSPITAL_CODE= glm.gnum_hospital_code and PEPD12.gnum_isvalid= 1 and PEPD12.str_validate='Y'  ) AS isadvisedby FROM hivt_requisition_header hrh, hivt_requisition_dtl hrd, hivt_laboratory_test_dtl hltd, gblt_laboratory_mst glm, gblt_test_mst gtm WHERE hrh.hrgnum_puk = ? AND hrh.hrgstr_episode_code = ? AND hrh.hivnum_req_no = \
									            SUBSTR (hrd.hivtnum_req_dno, 1, 18) AND hrd.gnum_lab_test_code = hltd.gnum_lab_test_code AND TO_DATE (hltd.gdt_effective_frm) <= TO_DATE (SYSDATE) AND TO_DATE (NVL (hltd.gdt_effective_to, SYSDATE)) >= TO_DATE (SYSDATE) AND hltd.gnum_isvalid = gtm.gnum_isvalid AND SUBSTR (hltd.gnum_lab_test_code, 1, 5) = glm.gnum_lab_code \
									     		AND TO_DATE (glm.gdt_effective_frm) <= TO_DATE (SYSDATE)  AND TO_DATE (NVL (glm.gdt_effective_to, SYSDATE)) >= TO_DATE (SYSDATE) AND glm.gbl_isvalid = gtm.gnum_isvalid AND SUBSTR (hltd.gnum_lab_test_code, 6, 4) = gtm.gnum_test_code AND TO_DATE (gtm.gdt_effective_frm) <= TO_DATE (SYSDATE) AND TO_DATE (NVL \
									     		(gtm.gdt_effective_to, SYSDATE)) >= TO_DATE (SYSDATE) AND gtm.gnum_isvalid = ? and glm.GNUM_HOSPITAL_CODE=? \
												and gtm.GNUM_HOSPITAL_CODE=glm.GNUM_HOSPITAL_CODE ORDER BY  hrh.hivt_requisition_date desc, laboratorycode, testcode, samplegroupcode 
    	
//-----------------------------------------------Post_Medical_Entry-------------------------------------------------------    	
    													
SELECT.CERTIFICATE_TYPE_FOR_POST_ENTRY.HMBT_REQUISITION_DTL	=	SELECT DISTINCT hmbnum_certificate_type_id,Initcap((SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 101 AND gnum_isvalid = a.gnum_isvalid)) certificatetypename \
           											FROM hmbt_requisition_dtl a WHERE a.gnum_hospital_code = ? AND gnum_isvalid = ?  and trunc(HMBDT_EXAM_DATE)<=trunc(sysdate) order by certificatetypename

SELECT.CONSULTANT.PIST_EMP_CUR_DETAIL_DTL_OLD	=	SELECT a.str_emp_no,str_emp_full_name || '(' || (SELECT gstr_desig_name FROM gblt_designation_mst WHERE num_desig_id = b.gnum_desig_code \
                								AND gnum_isvalid =  a.GNUM_ISVALID AND  AND gnum_hospital_code = a.gnum_hospital_code)|| ')' \
         										|| '('|| a.str_emp_no|| ')' AS empname FROM pist_emp_registration_dtl a, pist_emp_registration_dtl b WHERE a.str_emp_no = b.str_emp_no AND  A.GNUM_ISVALID=? and a.gnum_isvalid = b.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \
     											AND b.gnum_desig_code IN (SELECT d.num_desig_id FROM hgbt_doctor_desig_mapping d WHERE d.gnum_isvalid =b.gnum_isvalid AND d.hgnum_process_type = ? AND d.gnum_hospital_code = a.gnum_hospital_code) AND a.gnum_hospital_code = ? ORDER BY str_emp_full_name

SELECT.CONSULTANT.PIST_EMP_CUR_DETAIL_DTL=    SELECT a.STR_EMP_NO AS empno,a.str_emp_full_name || '(' || (SELECT gstr_desig_name FROM gblt_designation_mst WHERE gnum_desig_code = a.gnum_desig_code \
                								AND gnum_isvalid =  a.GNUM_ISVALID  AND gnum_hospital_code = a.gnum_hospital_code)|| ')' FROM pist_emp_registration_dtl a WHERE  a.gnum_hospital_code = ? and a.GNUM_DESIG_CODE in (select NUM_DESIG_ID from HGBT_DOCTOR_DESIG_MAPPING where HGNUM_PROCESS_TYPE=? and gnum_hospital_code = ? and GNUM_ISVALID=?  ) order by a.str_emp_full_name 
SELECT.BOARD_ASSIGNED.HMBT_REQUISITION_DTL	=	SELECT DISTINCT a.hmbnum_board_no,INITCAP((SELECT HMBSTR_BOARD_NAME FROM hmbt_board_mst WHERE HMBNUM_BOARD_ID = b.HMBNUM_BOARD_ID AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)   ||' '||HMBDT_BOARD_STARTTIME ) boardName FROM hmbt_requisition_dtl a,hmbt_board_dtl b WHERE a.gnum_hospital_code = ? \
								            AND a.gnum_isvalid = ?  AND hmbnum_req_status = ? and a.hmbnum_board_no=b.hmbnum_board_no and a.gnum_hospital_code=b.gnum_hospital_code and a.gnum_isvalid=b.gnum_isvalid ORDER BY boardName
								            
SELECT.BOARD_ASSIGNED.HMBT_REQUISITION_DTL_CERTIFICATE_ID_BASED = SELECT DISTINCT a.hmbnum_board_no,INITCAP((SELECT HMBSTR_BOARD_NAME FROM hmbt_board_mst WHERE HMBNUM_BOARD_ID = b.HMBNUM_BOARD_ID AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)   ||' '||HMBDT_BOARD_STARTTIME ) boardName FROM hmbt_requisition_dtl a,hmbt_board_dtl b WHERE a.gnum_hospital_code = ? \
								            AND a.gnum_isvalid = ?  AND hmbnum_req_status = ? AND B.HMBNUM_CERTIFICATE_TYPE_ID= ? and a.hmbnum_board_no=b.hmbnum_board_no and a.gnum_hospital_code=b.gnum_hospital_code and a.gnum_isvalid=b.gnum_isvalid ORDER BY boardName
								            				
SELECT.PATIENT_FOR_POST_ENTRY.HMBT_REQUISITION_DTL	=	SELECT  a.hrgnum_puk patcrno, a.hmbnum_req_id reqid,a.HMBNUM_SLNO slNo,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' '|| hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patname, hmbnum_certificate_type_id certificatetypeid, (SELECT hmbstr_certificate_type_name \
            										FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT  c.gstr_gender_name || '/' || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) FROM hrgt_patient_dtl b, gblt_gender_mst c \
           											WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_hospital_code = ? AND b.gstr_gender_code = c.gstr_gender_code AND c.gnum_isvalid = a.gnum_isvalid) patagegender, (SELECT hgnum_deptunitcode FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = \
                              						a.hmbnum_certificate_type_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid) departmentunitcode, HMBNUM_VISIT_NO visitno, hrgnum_episode_code episodecode, b.hmbnum_visit_no episodevisitno, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') entrydate, HMBNUM_IS_REFERRED isReferred, HMBNUM_IS_INV_RAISED isInvestigationRaised, \
                              						decode((select distinct HRGNUM_PUK from hrgt_episode_ref_dtl where HRGNUM_PUK=a.HRGNUM_PUK and gnum_hospital_code=a.gnum_hospital_code),null,0,1) referStatus ,to_char(b.HMBDT_VISIT_DATE,'dd-Mon-yyyy')visitDate,to_char(a.HMBDT_EXAM_DATE,'dd-Mon-yyyy')examDate,a.HMBNUM_BOARD_NO boardNo,(SELECT hmbstr_board_name FROM hmbt_board_mst m, hmbt_board_dtl n \
           											WHERE m.hmbnum_board_id = n.hmbnum_board_id and a.HMBNUM_BOARD_NO=n.HMBNUM_BOARD_NO and m.gnum_isvalid=a.gnum_isvalid  and m.gnum_isvalid=n.gnum_isvalid and m.gnum_hospital_code=a.gnum_hospital_code and n.gnum_hospital_code=m.gnum_hospital_code)boardName \
    												FROM hmbt_requisition_dtl a,hmbt_medical_visit_dtl b WHERE TRUNC (hmbdt_exam_date) <= TRUNC (SYSDATE)  AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND hmbnum_certificate_type_id=?  and a.HMBNUM_BOARD_NO like ? AND hmbnum_req_status = ? and a.HMBNUM_REQ_ID=b.HMBNUM_REQ_ID and b.hmbnum_visit_no = (SELECT MAX (hmbnum_visit_no) FROM hmbt_medical_visit_dtl \
                      								WHERE hmbnum_req_id = b.hmbnum_req_id AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid)
                      								
SELECT.CHECKLIST_COMPULSORY_AT_POST_ENTRY.HMBT_CERTIFICATE_CHECKLIST_MST	=	SELECT hmbnum_checklist_id AS checklistid,(SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE hmbnum_checklist_id = a.hmbnum_checklist_id  AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) AS checklist, hmbnum_iscompulsory AS iscompulsory FROM hmbt_certificate_checklist_mst a \
													WHERE hmbnum_certificate_type_id = ?  AND gnum_isvalid = ? AND gnum_hospital_code =? and HMBNUM_ISCOMPULSORY=? ORDER BY checklist                      								
//----------------------------------------------------------  

SELECT_ROLL.HMBT_ROLE_MST=    SELECT HMBNUM_ROLE_ID,HMBSTR_ROLE_NAME FROM HMBT_ROLE_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?      
          
          
SELECT_CERTIFICATETYPEID.HMBT_CERTIFICATE_TYPE_MST=  SELECT HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,initcap(HMBSTR_CERTIFICATE_TYPE_NAME) as certificateTypeName,HMBNUM_BOARD_TYPE as boardType FROM HMBT_CERTIFICATE_TYPE_MST WHERE GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?  order by certificateTypeName
           										
           										
SELECT_BOARD_LIST.HMBT_BOARD_MST=  SELECT HMBNUM_BOARD_ID as boardID,HMBSTR_BOARD_NAME as boardName,HMBNUM_BOARD_TYPE as boardTypeID FROM HMBT_BOARD_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?           										
           										
SELECT.ALL_CERTIFICATE_TYPE.HMBT_CERTIFICATE_TYPE_MST = select HMBNUM_CERTIFICATE_TYPE_ID ||'#'|| HGNUM_DEPTUNITCODE , HMBSTR_CERTIFICATE_TYPE_NAME from HMBT_CERTIFICATE_TYPE_MST where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? order by  HMBSTR_CERTIFICATE_TYPE_NAME          										
           										

  
SELECT.SCHEDULE_DATE_LIST.HOPT_DEPT_UNIT_ROSTER_DTL = SELECT distinct TO_CHAR (hopdt_start_dt, 'DD-Mon-YYYY') AS examDate, (SELECT COUNT (*) FROM hmbt_requisition_dtl WHERE trunc(to_date(hmbdt_exam_date)) = trunc(to_date(a.hopdt_start_dt))  AND gnum_isvalid = a.GNUM_ISVALID AND gnum_hospital_code = a.gnum_hospital_code and HMBNUM_REQ_STATUS=?) AS registeredReq, \
         									(SELECT hmbnum_min_req FROM hmbt_certificate_type_mst WHERE gnum_isvalid = a.GNUM_ISVALID AND gnum_hospital_code = 101 AND hmbnum_certificate_type_id = ?) AS minReq, (SELECT hmbnum_max_req FROM hmbt_certificate_type_mst WHERE gnum_isvalid = a.GNUM_ISVALID \
             								AND gnum_hospital_code = 101 AND hmbnum_certificate_type_id = ?) AS maxReq FROM hopt_dept_unit_roster_dtl a WHERE hopnum_deptunitcode = ?  AND trunc(hopdt_start_dt) >= trunc(SYSDATE)  AND gnum_isvalid = ?  AND gnum_hospital_code = ? ORDER BY examDate              										

SELECT_CERTIFICATE_DETAIL.HMBT_CERTIFICATE_TYPE_MST=  SELECT HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,HMBSTR_CERTIFICATE_TYPE_NAME as certificateTypeName,HGNUM_DEPTUNITCODE as departmentUnitCode,HMBNUM_MIN_REQ as minAge,HMBNUM_MAX_REQ as maxAge, \
                                                     (SELECT count(*) from HMBT_REQUISITION_DTL WHERE HMBNUM_CERTIFICATE_TYPE_ID=A.HMBNUM_CERTIFICATE_TYPE_ID AND HMBNUM_REQ_STATUS=? AND GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) as registeredPatientCount \
                                                     FROM HMBT_CERTIFICATE_TYPE_MST A WHERE A.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=100										
           											
SELECT_BOARDS.HMBT_CERTIFICATE_BOARD_MST=   SELECT HMBNUM_BOARD_ID,(SELECT HMBSTR_BOARD_NAME FROM HMBT_BOARD_MST WHERE HMBNUM_BOARD_ID=A.HMBNUM_BOARD_ID AND GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) FROM HMBT_CERTIFICATE_BOARD_MST WHERE \
                                            HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?         											
           											
           											
 //------------------------------------------------Refer_Mapping------------------------------------------------------------        																		           							           							                       
           
ESSENTIAL.ALL_DEPT.GBLT_DEPARTMENT_MST=		SELECT GNUM_DEPT_CODE,INITCAP(GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST \
											WHERE  GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? AND GNUM_DEPT_TYPE =1 ORDER BY GSTR_DEPT_NAME
           
ESSENTIAL.ALL_UNIT.HGBT_UNIT_MST=		SELECT A.HGNUM_DEPTUNITCODE || '@' || A.GNUM_DEPT_CODE   ,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' \
										FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B \
										WHERE A.GNUM_DEPT_CODE=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE \
										and A.GNUM_ISVALID=B.GNUM_ISVALID  AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=? ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')'
           
ESSENTIAL.ALL_SPECIAL_UNIT.HGBT_UNIT_MST=		SELECT A.HGNUM_DEPTUNITCODE || '@' || A.GNUM_DEPT_CODE   ,INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' \
										FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B \
										WHERE A.GNUM_DEPT_CODE=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE \
										and A.GNUM_ISVALID=B.GNUM_ISVALID  AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=? and A.HGNUM_ISGENERAL=? ORDER BY INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')'

           
           
ESSENTIAL.ALL_LABTEST.HIVT_LABORATORY_TEST_DTL= SELECT GNUM_LAB_TEST_CODE as testCode,(select GSTR_LAB_NAME from GBLT_LABORATORY_MST where GNUM_LAB_CODE=substr(A.GNUM_LAB_TEST_CODE,1,5) and GNUM_ISVALID=A.GNUM_ISVALID and GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE)||' '|| \
                                                (select GSTR_TEST_NAME from GBLT_TEST_MST where GNUM_TEST_CODE=substr(A.GNUM_LAB_TEST_CODE,6,9) and GNUM_ISVALID=A.GNUM_ISVALID and GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) as testName from HIVT_LABORATORY_TEST_DTL A where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?
           
           
 

           																			           							           							                       
SELECT.BOARD_DETAIL_LIST.HMBT_CERTIFICATE_BOARD_MST =   select b.HMBSTR_BOARD_NAME as boardName,b.HMBNUM_BOARD_TYPE as boardTypeID,c.HPMRSTR_FLAG_DESC  as boardTypeName,b.HMBNUM_BOARD_ID as boardID \
														from HMBT_CERTIFICATE_BOARD_MST a ,HMBT_BOARD_MST b,HPMRT_FLAG_MST c \
														where a.HMBNUM_BOARD_ID=b.HMBNUM_BOARD_ID and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and a.GNUM_ISVALID=b.GNUM_ISVALID \
														and b.HMBNUM_BOARD_TYPE=c.HPMRNUM_FLAG_VALUE and c.HPMRNUM_TABLE_ID=? \
														and a.HMBNUM_CERTIFICATE_TYPE_ID=? and a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=?
														         																			           							           							                       
SELECT.TEAM_DETAIL_LIST.HMBT_BOARD_TEAM_MST = select a.HMBNUM_BOARD_ID as boardId, a.HMBSTR_EMP_ID as employeeId, a.HMBNUM_ROLE_ID as roleId, \
												(select hmbstr_role_name from hmbt_role_mst where hmbnum_role_id=a.hmbnum_role_id ) AS roleName, b.str_emp_full_name as empName \
												from HMBT_BOARD_TEAM_MST a,PIST_EMP_REGISTRATION_DTL b \
												where HMBNUM_BOARD_ID=? and a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? \
												and a.HMBSTR_EMP_ID=b.STR_EMP_NO and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and a.GNUM_ISVALID=b.GNUM_ISVALID
												           																			           							           							                       
SELECT.ASSIGN_BOARD_LIST.HMBT_BOARD_DTL = select b.HMBSTR_BOARD_NAME as boardName,a.HMBNUM_BOARD_ID as boardId,a.HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeId, \
														a.HMBSTR_LOCATION as location,a.HMBNUM_BOARD_NO as boardNo \
														from HMBT_BOARD_DTL a,HMBT_BOARD_MST b \
														where a.HMBNUM_CERTIFICATE_TYPE_ID=? and a.GNUM_ISVALID=? and a.GNUM_HOSPITAL_CODE=? \
														and trunc(HMBDT_BOARD_STARTTIME)=to_date(?,'dd-mon-yyyy') and HMBNUM_BOARD_STATUS=? \
														and a.HMBNUM_BOARD_ID=b.HMBNUM_BOARD_ID and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and a.GNUM_ISVALID=b.GNUM_ISVALID
														
SELECT.ASSIGN_TEAM_DETAIL.HMBT_BOARD_TEAM_DTL = SELECT b.hmbstr_emp_id AS employeeid, b.hmbnum_role_id AS roleid,(select hmbstr_role_name from hmbt_role_mst where hmbnum_role_id=b.hmbnum_role_id ) AS roleName, pkg_bloodbank_mst.emp_name_empidwise(a.gnum_hospital_code,  b.hmbstr_emp_id) \
												AS empname, a.hmbnum_board_no AS boardno, a.hmbnum_board_id AS boardid, a.hmbstr_location AS LOCATION FROM hmbt_board_dtl a, hmbt_board_team_dtl b WHERE a.hmbnum_board_no = b.hmbnum_board_no \
												AND a.gnum_hospital_code = b.gnum_hospital_code  AND a.gnum_isvalid = b.gnum_isvalid AND a.gnum_hospital_code = ?   AND b.gnum_isvalid = ?   AND a.hmbnum_board_no = ?	
												
SELECT.NEW_BOARD_DETAIL_LIST.HMBT_CERTIFICATE_BOARD_MST =   select b.HMBSTR_BOARD_NAME as boardName,b.HMBNUM_BOARD_TYPE as boardTypeID,c.HPMRSTR_FLAG_DESC  as boardTypeName,b.HMBNUM_BOARD_ID as boardID \
														from HMBT_CERTIFICATE_BOARD_MST a ,HMBT_BOARD_MST b,HPMRT_FLAG_MST c \
														where a.HMBNUM_BOARD_ID=b.HMBNUM_BOARD_ID and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and a.GNUM_ISVALID=b.GNUM_ISVALID \
														and b.hmbnum_board_id not in (select HMBNUM_BOARD_ID from HMBT_BOARD_DTL x where x.gnum_hospital_code = ? and x.gnum_isvalid = ? and trunc(x.HMBDT_BOARD_STARTTIME)=to_date(?,'dd-mon-yyyy') and x.HMBNUM_BOARD_STATUS=? and x.HMBNUM_CERTIFICATE_TYPE_ID=?) \
														and b.HMBNUM_BOARD_TYPE=c.HPMRNUM_FLAG_VALUE and c.HPMRNUM_TABLE_ID=? \
														and a.HMBNUM_CERTIFICATE_TYPE_ID=? and a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=?

SELECT.VARIFIED_CERTIFICATE_LIST.HMBT_REQUISITION_DTL = select distinct b.HMBNUM_CERTIFICATE_TYPE_ID || '#' || b.HMBNUM_ISSUE_TYPE ||'#'|| b.HMBNUM_REQ_BY ||'#'||HGNUM_TEMPLATE_ID ,b.HMBSTR_CERTIFICATE_TYPE_NAME \
														from HMBT_REQUISITION_DTL a , HMBT_CERTIFICATE_TYPE_MST b \
														where a.HMBNUM_CERTIFICATE_TYPE_ID=b.HMBNUM_CERTIFICATE_TYPE_ID  and a.GNUM_ISVALID=b.GNUM_ISVALID \
														 and a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? order by b.HMBSTR_CERTIFICATE_TYPE_NAME	
														
SELECT.REQ_DATE_BY_CRTIFICATETYPEID.HMBT_REQUISITION_DTL = select distinct to_char(a.GDT_ENTRY_DATE,'dd-Mon-yyyy'),to_char(a.GDT_ENTRY_DATE,'dd-Mon-yyyy') \
															from HMBT_REQUISITION_DTL a \
															where a.HMBNUM_CERTIFICATE_TYPE_ID=? \
															and a.HMBNUM_REQ_STATUS=? and  a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? \
															order by to_char(a.GDT_ENTRY_DATE,'dd-Mon-yyyy')	
															
SELECT.CADIDATE_LIST.HMBT_REQUISITION_DTL = SELECT   hrgnum_puk patcrno, hmbnum_req_id reqid,a.HMBNUM_REQ_FROM as requestFrom,a.HMBNUM_ORGANIZATION_ID as orgID,to_char(a.HMBDT_APPROVED_DATE,'dd-Mon-yyyy') as approvedDate, \
									         (SELECT    hrgstr_fname \
									                 || ' ' \
									                 || hrgstr_mname \
									                 || ' ' \
									                 || hrgstr_lname \
									            FROM hrgt_patient_dtl \
									           WHERE hrgnum_puk = a.hrgnum_puk \
									             AND gnum_hospital_code = a.gnum_hospital_code) patname, \
									         hmbnum_certificate_type_id certificatetypeid, \
									         (SELECT hmbstr_certificate_type_name \
									            FROM hmbt_certificate_type_mst \
									           WHERE hmbnum_certificate_type_id = \
									                             a.hmbnum_certificate_type_id \
									             AND gnum_hospital_code = 100 \
									             AND gnum_isvalid = a.gnum_isvalid) certificatetypename, \
									         (SELECT    c.gstr_gender_short \
									                 || '/' \
									                 || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) \
									            FROM hrgt_patient_dtl b, gblt_gender_mst c \
									           WHERE hrgnum_puk = a.hrgnum_puk \
									             AND b.gnum_hospital_code = a.gnum_hospital_code \
									             AND b.gnum_gender_code = c.gnum_gender_code \
									             AND c.gnum_isvalid = a.gnum_isvalid) patagegender, \
									         (SELECT hgnum_deptunitcode \
									            FROM hmbt_certificate_type_mst \
									           WHERE hmbnum_certificate_type_id = \
									                              a.hmbnum_certificate_type_id \
									             AND gnum_hospital_code = 100 \
									             AND gnum_isvalid = a.gnum_isvalid) departmentunitcode, \
									         (SELECT COUNT (*) + 1 \
									            FROM hmbt_medical_visit_dtl \
									           WHERE hmbnum_req_id = a.hmbnum_req_id \
									             AND gnum_hospital_code = a.gnum_hospital_code \
									             AND gnum_isvalid = a.gnum_isvalid) visitno, \
									         TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy') entrydate, \
									         hmbnum_board_no boardno, \
									         (SELECT hmbstr_board_name \
									            FROM hmbt_board_mst m, hmbt_board_dtl n \
									           WHERE m.hmbnum_board_id = n.hmbnum_board_id \
									             AND a.hmbnum_board_no = n.hmbnum_board_no \
									             AND m.gnum_isvalid = a.gnum_isvalid \
									             AND m.gnum_isvalid = n.gnum_isvalid \
									             AND m.gnum_hospital_code = a.gnum_hospital_code \
									             AND n.gnum_hospital_code = m.gnum_hospital_code) boardname \
									    FROM hmbt_requisition_dtl a \
									   WHERE TRUNC (GDT_ENTRY_DATE) = to_date(?,'dd-mon-yyyy') \
									     AND gnum_hospital_code = ? \
									     AND gnum_isvalid = ? \
									     AND hmbnum_certificate_type_id = ? \
									     AND hmbnum_req_status =? \
									ORDER BY  entrydate		
									
SELECT.CADIDATE_LIST_BY_CERTIFICATE_TYPE.HMBT_REQUISITION_DTL = SELECT   hrgnum_puk patcrno, hmbnum_req_id reqid,a.HMBNUM_REQ_FROM as requestFrom,a.HMBNUM_ORGANIZATION_ID as orgID,to_char(a.HMBDT_APPROVED_DATE,'dd-Mon-yyyy') as approvedDate, \
														         (SELECT    hrgstr_fname \
														                 || ' ' \
														                 || hrgstr_mname \
														                 || ' ' \
														                 || hrgstr_lname \
														            FROM hrgt_patient_dtl \
														           WHERE hrgnum_puk = a.hrgnum_puk \
														             AND gnum_hospital_code = a.gnum_hospital_code) patname, \
														         hmbnum_certificate_type_id certificatetypeid, \
														         (SELECT hmbstr_certificate_type_name \
														            FROM hmbt_certificate_type_mst \
														           WHERE hmbnum_certificate_type_id = \
														                             a.hmbnum_certificate_type_id \
														             AND gnum_hospital_code = 101 \
														             AND gnum_isvalid = a.gnum_isvalid) certificatetypename, \
														         (SELECT    c.gstr_gender_name \
														                 || '/' \
														                 || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) \
														            FROM hrgt_patient_dtl b, gblt_gender_mst c \
														           WHERE hrgnum_puk = a.hrgnum_puk \
														             AND b.gnum_hospital_code = a.gnum_hospital_code \
														             AND b.gstr_gender_code = c.gstr_gender_code \
														             AND c.gnum_isvalid = a.gnum_isvalid) patagegender, \
														         (SELECT hgnum_deptunitcode \
														            FROM hmbt_certificate_type_mst \
														           WHERE hmbnum_certificate_type_id = \
														                              a.hmbnum_certificate_type_id \
														             AND gnum_hospital_code =101 \
														             AND gnum_isvalid = a.gnum_isvalid) departmentunitcode, \
														         (SELECT COUNT (*) + 1 \
														            FROM hmbt_medical_visit_dtl \
														           WHERE hmbnum_req_id = a.hmbnum_req_id \
														             AND gnum_hospital_code = a.gnum_hospital_code \
														             AND gnum_isvalid = a.gnum_isvalid) visitno, \
														         TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy') entrydate, \
														         hmbnum_board_no boardno, \
														         (SELECT hmbstr_board_name \
														            FROM hmbt_board_mst m, hmbt_board_dtl n \
														           WHERE m.hmbnum_board_id = n.hmbnum_board_id \
														             AND a.hmbnum_board_no = n.hmbnum_board_no \
														             AND m.gnum_isvalid = a.gnum_isvalid \
														             AND m.gnum_isvalid = n.gnum_isvalid \
														             AND m.gnum_hospital_code = a.gnum_hospital_code \
														             AND n.gnum_hospital_code = m.gnum_hospital_code) boardname,a.HMBSTR_ORG_NAME orgName, \
														             (select HMBSTR_OPINION_NAME from   HMBT_OPINION_MST where HMBNUM_OPINION_CODE = a.HMBNUM_OPINION_CODE and GNUM_ISVALID=1) opinion, \
														             NVL(HMBSTR_CERTIFICATE_NO,'-') AS certificateNo \
														    FROM hmbt_requisition_dtl a \
														   WHERE gnum_hospital_code = ? \
														     AND gnum_isvalid = ? \
														     AND hmbnum_certificate_type_id = ? \
														     AND hmbnum_req_status =? \
														ORDER BY certificatetypename, entrydate		
														
														
SELECT.CADIDATE_LIST_BY_REQNO.HMBT_REQUISITION_DTL = SELECT   hrgnum_puk patcrno, hmbnum_req_id reqid,a.HMBNUM_REQ_FROM as requestFrom,a.HMBNUM_ORGANIZATION_ID as orgID,decode(a.HMBNUM_REQ_STATUS,'7','NOT HANDOVER','8','HANDOVER') as reqStatusDesc,a.HMBNUM_REQ_STATUS as reqStatus,to_char(a.HMBDT_APPROVED_DATE,'dd-Mon-yyyy') as approvedDate,  \
														         (SELECT    hrgstr_fname \
														                 || ' ' \
														                 || hrgstr_mname \
														                 || ' ' \
														                 || hrgstr_lname \
														            FROM hrgt_patient_dtl \
														           WHERE hrgnum_puk = a.hrgnum_puk \
														             AND gnum_hospital_code = a.gnum_hospital_code) patname, \
														         hmbnum_certificate_type_id certificatetypeid, \
														         (SELECT hmbstr_certificate_type_name \
														            FROM hmbt_certificate_type_mst \
														           WHERE hmbnum_certificate_type_id = \
														                             a.hmbnum_certificate_type_id \
														             AND gnum_isvalid = a.gnum_isvalid) certificatetypename, \
														         (SELECT    c.gstr_gender_name \
														                 || '/' \
														                 || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) \
														            FROM hrgt_patient_dtl b, gblt_gender_mst c \
														           WHERE hrgnum_puk = a.hrgnum_puk \
														             AND b.gnum_hospital_code = a.gnum_hospital_code \
														             AND b.gstr_gender_code = c.gstr_gender_code \
														             AND c.gnum_isvalid = a.gnum_isvalid) patagegender, \
														         (SELECT HMBNUM_ISSUE_TYPE \
														            FROM hmbt_certificate_type_mst \
														           WHERE hmbnum_certificate_type_id = \
														                              a.hmbnum_certificate_type_id \
														             AND gnum_hospital_code = 100 \
														             AND gnum_isvalid = a.gnum_isvalid) certIssueType, \
																 (SELECT HMBNUM_REQ_BY \
														            FROM hmbt_certificate_type_mst \
														           WHERE hmbnum_certificate_type_id = \
														                              a.hmbnum_certificate_type_id \
														             AND gnum_hospital_code = 100 \
														             AND gnum_isvalid = a.gnum_isvalid) certReqBy,	 \
														         (SELECT COUNT (*) + 1 \
														            FROM hmbt_medical_visit_dtl \
														           WHERE hmbnum_req_id = a.hmbnum_req_id \
														             AND gnum_hospital_code = a.gnum_hospital_code \
														             AND gnum_isvalid = a.gnum_isvalid) visitno, \
														         TO_CHAR (gdt_entry_date, 'dd-Mon-yyyy') entrydate, \
														         hmbnum_board_no boardno, \
														         (SELECT hmbstr_board_name \
														            FROM hmbt_board_mst m, hmbt_board_dtl n \
														           WHERE m.hmbnum_board_id = n.hmbnum_board_id \
														             AND a.hmbnum_board_no = n.hmbnum_board_no \
														             AND m.gnum_isvalid = a.gnum_isvalid \
														             AND m.gnum_isvalid = n.gnum_isvalid \
														             AND m.gnum_hospital_code = a.gnum_hospital_code \
														             AND n.gnum_hospital_code = m.gnum_hospital_code) boardname ,(SELECT hgnum_template_id FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id=a.hmbnum_certificate_type_id and GNUM_ISVALID =1 )   templateId, HMBSTR_ORG_NAME orgName, NVL (hmbstr_certificate_no, '-') AS certificateno \
														    FROM hmbt_requisition_dtl a \
														   WHERE gnum_hospital_code = ? \
														     AND gnum_isvalid = ? \
														     AND HRGNUM_PUK = ? \
														     AND hmbnum_req_status in(?,?) \
														ORDER BY entrydate desc	
														
SELECT.OPINION_LIST_BY_REQUISITIONID.HMBT_REQUISITION_DTL = select a.HMBNUM_OPINION_CODE ||'#'|| a.HMBNUM_OPINIUM_TYPE ,a.HMBSTR_OPINION_NAME  \
															from HMBT_OPINION_MST a, HMBT_CERTIFICATE_TYPE_MST b ,HMBT_REQUISITION_DTL c \
															where a.GNUM_ISVALID=? and a.GNUM_HOSPITAL_CODE=? and c.HMBNUM_REQ_ID=? \
															and a.HMBNUM_CERTIFICATE_CAT_ID=b.HMBNUM_CERTIFICATE_CAT_ID and a.GNUM_ISVALID=b.GNUM_ISVALID  \
															and b.HMBNUM_CERTIFICATE_TYPE_ID=c.HMBNUM_CERTIFICATE_TYPE_ID and c.GNUM_ISVALID=b.GNUM_ISVALID and c.GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE \
															order by a.HMBSTR_OPINION_NAME 	
															
SELECT.BOARD_MEMBER_LIST_BY_REQUISITIONID.HMBT_REQUISITION_DTL = select  b.hmbstr_emp_id AS employeeid, c.str_emp_full_name AS empname \
																from HMBT_REQUISITION_DTL a ,HMBT_BOARD_TEAM_DTL b,pist_emp_registration_dtl c \
																where a.HMBNUM_REQ_ID =? and  a.GNUM_ISVALID=? and a.GNUM_HOSPITAL_CODE=? \
																and a.HMBNUM_BOARD_NO=b.HMBNUM_BOARD_NO and a.GNUM_ISVALID=b.GNUM_ISVALID and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE \
																AND b.hmbstr_emp_id = c.str_emp_no AND b.gnum_hospital_code = c.gnum_hospital_code AND b.gnum_isvalid = c.gnum_isvalid \
																and b.hmbstr_emp_id not in  \
																(select x.HMBSTR_EMP_ID from HMBT_BOARD_TEAM_DTL x , HMBT_REQUISITION_DTL y where y.HMBNUM_REQ_ID =? and  y.GNUM_ISVALID=? and y.GNUM_HOSPITAL_CODE=? \
																and x.HMBNUM_BOARD_NO=y.HMBNUM_BOARD_NO and x.GNUM_ISVALID=y.GNUM_ISVALID and x.GNUM_HOSPITAL_CODE=y.GNUM_HOSPITAL_CODE and HMBNUM_ROLE_ID=?) \
																order by empname	
																
SELECT.CERT_TYPE_FOR_CERT_VERIFICATION.HMBT_REQUISITION_DTL	=	SELECT DISTINCT hmbnum_certificate_type_id,Initcap((SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = ? AND gnum_isvalid = a.gnum_isvalid)) certificatetypename \
           														FROM hmbt_requisition_dtl a WHERE gnum_hospital_code = ? AND gnum_isvalid = ?  and trunc(HMBDT_EXAM_DATE)<=trunc(sysdate) order by certificatetypename	
           														
SELECT.BOARD_ASSIGNED_FOR_CERT_VERIF.HMBT_REQUISITION_DTL	=	SELECT DISTINCT a.hmbnum_board_no,INITCAP((SELECT HMBSTR_BOARD_NAME FROM hmbt_board_mst WHERE HMBNUM_BOARD_ID = b.HMBNUM_BOARD_ID AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid)) boardName FROM hmbt_requisition_dtl a,hmbt_board_dtl b WHERE a.gnum_hospital_code = ? \
								          						 AND a.gnum_isvalid = ?  AND hmbnum_req_status = ? and a.hmbnum_board_no=b.hmbnum_board_no and a.gnum_hospital_code=b.gnum_hospital_code and a.gnum_isvalid=b.gnum_isvalid ORDER BY boardName  
								          						 
SELECT.PATIENT_FOR_CERT_VERIFICATION.HMBT_REQUISITION_DTL	=	SELECT  a.hrgnum_puk patcrno, a.hmbnum_req_id reqid,a.HMBNUM_SLNO slNo,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' '|| hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patname, hmbnum_certificate_type_id certificatetypeid, (SELECT hmbstr_certificate_type_name \
            										FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code = 101 AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT  c.gstr_gender_name || '/' || ahis_util.dob_age_on (hrgdt_dob, SYSDATE) FROM hrgt_patient_dtl b, gblt_gender_mst c \
           											WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code  AND b.gstr_gender_code = c.gstr_gender_code AND c.gnum_isvalid = a.gnum_isvalid) patagegender, (SELECT hgnum_deptunitcode FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = \
                              						a.hmbnum_certificate_type_id AND gnum_hospital_code = 101 AND gnum_isvalid = a.gnum_isvalid) departmentunitcode, HMBNUM_VISIT_NO visitno, hrgnum_episode_code episodecode, b.hmbnum_visit_no episodevisitno, TO_CHAR (a.gdt_entry_date, 'dd-Mon-yyyy') entrydate, HMBNUM_IS_REFERRED isReferred, HMBNUM_IS_INV_RAISED isInvestigationRaised, \
                              						decode((select distinct HRGNUM_PUK from hrgt_episode_ref_dtl where HRGNUM_PUK=a.HRGNUM_PUK and gnum_hospital_code=a.gnum_hospital_code),null,0,1) referStatus ,to_char(b.HMBDT_VISIT_DATE,'dd-Mon-yyyy')visitDate,to_char(a.HMBDT_EXAM_DATE,'dd-Mon-yyyy')examDate,a.HMBNUM_BOARD_NO boardNo,(SELECT hmbstr_board_name FROM hmbt_board_mst m, hmbt_board_dtl n \
           											WHERE m.hmbnum_board_id = n.hmbnum_board_id and a.HMBNUM_BOARD_NO=n.HMBNUM_BOARD_NO and m.gnum_isvalid=a.gnum_isvalid  and m.gnum_isvalid=n.gnum_isvalid and m.gnum_hospital_code=a.gnum_hospital_code and n.gnum_hospital_code=m.gnum_hospital_code)boardName, \
           											NVL(HMBSTR_CERTIFICATE_NO,'-') AS certificateNo \
    												FROM hmbt_requisition_dtl a,hmbt_medical_visit_dtl b WHERE TRUNC (hmbdt_exam_date) <= TRUNC (SYSDATE)  AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND hmbnum_certificate_type_id=?  and a.HMBNUM_BOARD_NO like ? AND hmbnum_req_status = ? and a.HMBNUM_REQ_ID=b.HMBNUM_REQ_ID and b.hmbnum_visit_no = (SELECT MAX (hmbnum_visit_no) FROM hmbt_medical_visit_dtl \
                      								WHERE hmbnum_req_id = b.hmbnum_req_id AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid)	
                      								
SELECT.OPINION_LIST_BY_REQID.HMBT_VERIFICATION_DTL = SELECT a.hmbnum_opinion_code AS opinioncode, (select hmbstr_opinion_name from hmbt_opinion_mst b where   a.hmbnum_opinion_code = b.hmbnum_opinion_code \
											         AND a.gnum_hospital_code = b.gnum_hospital_code  AND a.gnum_isvalid = b.gnum_isvalid)AS opiniondesc, \
												     a.hmbstr_verify_emp_id AS empid, a.hmbstr_opinion AS opinion,PKG_BLOODBANK_MST.EMP_NAME_EMPIDWISE(a.gnum_hospital_code, a.hmbstr_verify_emp_id) AS empname \
													 FROM hmbt_verification_dtl a WHERE a.hmbnum_req_id =? AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ?

SELECT.TEMPLATE_LIST.HGBT_TEMPLATE_MST = SELECT   hgnum_template_id, hgstr_template_name FROM hgbt_template_mst WHERE gnum_hospital_code = ? AND gnum_isvalid = ? AND hgnum_template_category = ? ORDER BY hgstr_template_name


SELECT.REF_DTL.HMBT_REQ_EXT_REFER_DTL	=	select HMBNUM_REQ_ID reqID,HMBNUM_SLNO slNo,HMBSTR_REFER_TO extReferTo,HMBSTR_REFER_REASON referReason,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate,GNUM_HOSPITAL_CODE hospitalCode from HMBT_REQ_EXT_REFER_DTL where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? and HMBNUM_REQ_ID=?

	
SELECT.PATIENT_FOR_MB_ACCEPTANCE_PREV_DATE.HMBT_REQUISITION_DTL	=	SELECT hrgnum_puk patCrNo,HMBNUM_REQ_ID reqId,(SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code)patName, hmbnum_certificate_type_id certificateTypeId, (SELECT hmbstr_certificate_type_name \
          											FROM hmbt_certificate_type_mst WHERE hmbnum_certificate_type_id = a.hmbnum_certificate_type_id AND gnum_hospital_code =100 AND gnum_isvalid = a.gnum_isvalid) certificatetypename, (SELECT c.GSTR_GENDER_SHORT||'/'|| ahis_util.dob_age_on(HRGDT_DOB,sysdate) FROM hrgt_patient_dtl b,\
          											gblt_gender_mst c WHERE hrgnum_puk = a.hrgnum_puk AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gnum_hospital_code = c.gnum_hospital_code and b.GNUM_GENDER_CODE=c.GNUM_GENDER_CODE and c.gnum_isvalid=a.GNUM_ISVALID)patAgeGender,(SELECT HGNUM_DEPTUNITCODE FROM hmbt_certificate_type_mst \
          											WHERE HMBNUM_CERTIFICATE_TYPE_ID = a.HMBNUM_CERTIFICATE_TYPE_ID AND gnum_hospital_code = a.gnum_hospital_code and gnum_isvalid=a.GNUM_ISVALID) departmentUnitCode,(SELECT count(*)+1 FROM hmbt_medical_visit_dtl WHERE HMBNUM_REQ_ID = a.HMBNUM_REQ_ID AND gnum_hospital_code = a.gnum_hospital_code \
             										AND gnum_isvalid = a.gnum_isvalid) visitNo,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate,HMBNUM_BOARD_NO boardNo,(SELECT hmbstr_board_name FROM hmbt_board_mst m, hmbt_board_dtl n WHERE m.hmbnum_board_id = n.hmbnum_board_id and a.HMBNUM_BOARD_NO=n.HMBNUM_BOARD_NO and m.gnum_isvalid=a.gnum_isvalid  \
             										and m.gnum_isvalid=n.gnum_isvalid and m.gnum_hospital_code=a.gnum_hospital_code and n.gnum_hospital_code=m.gnum_hospital_code)boardName FROM HMBT_REQUISITION_DTL a WHERE TRUNC (hmbdt_exam_date) = TRUNC (TO_DATE (?, 'dd-Mon-yyyy')) AND gnum_hospital_code = ? AND gnum_isvalid = ? AND hmbnum_certificate_type_id LIKE ?  \
             										and HMBNUM_REQ_STATUS in(?,?) ORDER BY upper(certificatetypename),entryDate

SELECT.EPISODE_DTL.BY_CRNO.PREVDATE.HRGT_EPISODE_DTL	= SELECT   a.hrgnum_puk AS patcrno, a.hrgnum_episode_code AS episodecode,a.hrgnum_visit_no AS episodevisitno,a.hrgnum_visit_type AS episodevisittype,a.hrgnum_episode_type_code AS episodetypecode, \
												a.hrgstr_episode_action_code AS episodeactioncode,a.hrgstr_file_no AS fileno, a.hrgnum_admission_no AS admissionno,a.hrgstr_mlc_no AS mlcno, a.gnum_dept_code AS departmentcode,a.hgnum_deptunitcode AS departmentunitcode, \
												a.hrgnum_que_no AS queno,a.hrgnum_is_old AS patisold,TO_CHAR (a.hrgdt_episode_date, 'dd-Mon-YYYY') AS episodedate,a.hrgtm_episode_time AS episodetime,TO_CHAR (a.hrgdt_next_visit_date,'dd-Mon-YYYY' \
												) AS episodenextvisitdate,a.hrgstr_next_visit_dept_code AS episodenextvisitdeptcode,a.hrgnum_is_episode_open AS episodeisopen,INITCAP (a.hrgstr_complained_dtl) AS complaindetail,a.psrstr_emp_no AS empno, INITCAP (a.psrstr_emp_name) AS empname, \
												a.gnum_seat_id AS seatid,TO_CHAR (a.gdt_entry_date, 'dd-Mon-YYYY') AS entrydate,a.hrgnum_is_confirmed AS isconfirmed, a.gnum_isvalid AS isvalid,a.hgnum_room_code AS roomcode, a.hgnum_ward_code AS wardcode,a.hrgnum_next_visit_type AS episodenextvisittype, \
												a.hgnum_next_visit_deptunitcode AS episodenextvisitdeptunitcode,hrgnum_referral_acceptance AS episodereferaccept,gdt_referral_acceptance_date AS episodereferacceptdate,hgnum_treatment_cat_code AS patsecondarycatcode,(SELECT hgnum_patient_cat_code \
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code =a.hgnum_patient_cat_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) AND gnum_hospital_code = a.gnum_hospital_code) AS patprimarycatcode,(SELECT INITCAP (d.gstr_episode_action_name) \
												FROM gblt_episode_action_mst d WHERE d.gnum_episode_action_code =a.hrgstr_episode_action_code and d.gnum_hospital_code=a.gnum_hospital_code) episodeaction,(SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e \
												WHERE e.gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and e.gnum_hospital_code=a.gnum_hospital_code) department,(SELECT INITCAP (g.hgstr_unitname) \
												FROM hgbt_unit_mst g WHERE g.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) departmentunit, \
												TO_CHAR (a.hrgdt_exp_date, 'dd-MM-YYYY') AS expirydate, (SELECT INITCAP (f.gstr_dept_name) FROM gblt_department_mst f WHERE f.gnum_dept_code =a.hrgstr_next_visit_dept_code AND gdt_effective_frm <= TRUNC (a.gdt_entry_date) AND NVL (gdt_effective_to, a.gdt_entry_date + 1) >= TRUNC (a.gdt_entry_date) and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdept,(SELECT INITCAP (i.hgstr_room_name) FROM hgbt_room_mst i WHERE i.hgnum_room_code = a.hgnum_room_code and gnum_hospital_code=a.gnum_hospital_code) room, (SELECT INITCAP (j.hgstr_unitname) \
												FROM hgbt_unit_mst j WHERE j.hgnum_deptunitcode =a.hgnum_next_visit_deptunitcode and gnum_isvalid=1 and gnum_hospital_code=a.gnum_hospital_code) \
												episodenextvisitdeptunit,(DECODE ((SELECT count(1) FROM hopt_dept_unit_roster_dtl WHERE gnum_hospital_code=a.gnum_hospital_code and hopdt_start_dt <= SYSDATE AND hopdt_end_dt > SYSDATE \
												AND ( hopnum_deptunitcode =a.hgnum_deptunitcode)),0, 0,1)) deptunitisonduty,(DECODE( NVL((SELECT 1 FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1),0), \
												0, 1,1, 0,2, 1,NULL, 3)) deptunitisclosed,check_visited_today (a.hrgnum_puk,a.hgnum_deptunitcode,a.hrgnum_episode_code,a.gnum_hospital_code) visitedtoday,(SELECT ab.hgnum_isgeneral FROM hgbt_unit_mst ab WHERE ab.hgnum_deptunitcode = a.hgnum_deptunitcode and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) isgeneral \
												FROM hrgt_episode_dtl a WHERE (a.hrgnum_puk = ?) AND (a.gnum_isvalid = ?) and ( a.gnum_hospital_code=?) AND a.hrgnum_visit_type IN (1, 4) AND a.hrgnum_visit_no >= ALL (SELECT z.hrgnum_visit_no AS episodevisitno \
												FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk = a.HRGNUM_PUK) AND (z.hrgnum_episode_code = a.hrgnum_episode_code) AND (gnum_hospital_code=a.gnum_hospital_code)  and  trunc(A.GDT_ENTRY_DATE) = trunc(to_date(?,'dd-Mon-yyyy')) AND (z.gnum_isvalid = a.gnum_isvalid) AND z.hrgnum_visit_type = a.hrgnum_visit_type ) \
												AND GNUM_DEPT_CODE IN (SELECT GNUM_DEPT_CODE FROM HMBT_BOARD_CONFIGURATION WHERE GNUM_ISVALID = A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) ORDER BY A.HRGNUM_EPISODE_CODE  												
             										
             										  
SELECT.REF_DTL.HMBT_REQ_EXT_REFER_DTL	=	select HMBNUM_REQ_ID reqID,HMBNUM_SLNO slNo,HMBSTR_REFER_TO extReferTo,HMBSTR_REFER_REASON referReason,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') entryDate,GNUM_HOSPITAL_CODE hospitalCode from HMBT_REQ_EXT_REFER_DTL where GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? and HMBNUM_REQ_ID=?

SELECT.CIDNO_FOR_MEDICAL_BOARD.FTS_DOC_RECEIVING_FORM_TRN = SELECT str_cid_number as CIDNo , NUM_DOCUMENT_TYPE_ID AS documentTypeId, STR_TYPE_OF_DOCUMENT AS typeOfDocument, num_category_id as categoryId, \
											TO_CHAR (dt_receiving_date, 'dd-Mon-yyyy') as receivingDate, str_receiving_time as receivingTime, STR_FILE_HEAD_NAME AS fileHeadName, STR_LETTER_NUMBER AS letterNo, TO_CHAR (DT_LETTER_DATED, 'dd-Mon-yyyy') AS letterDated, \
											STR_NO_OF_PAGES_IN_LETTER AS noOfPageInLetter, STR_DOC_SUBJECT AS docSubject, STR_RECEIVED_FROM AS receiveFrom, STR_ADD_TO_DEPARTMENT AS addToDepartment, \
											STR_EMP_NO AS empNo, STR_ADD_TO_NAME_OF_PERSON AS addToNameOfPerson, STR_ADD_TO_DESIGNATION AS addToDesignation, STR_STATUS AS status, NUM_FLAG_ID AS flagId, \
											DATE_TO_BE_TRACKED AS dateToBeTracked, TO_CHAR (DT_TRACKED, 'dd-Mon-yyyy') AS dtTracked \
											FROM fts_doc_receiving_form_trn a \
											WHERE  num_category_id IN (?,?) and GNUM_HOSPITAL_CODE=? and gnum_isvalid = ? \
											order by dt_receiving_date desc, str_receiving_time

