


SELECT_CHECKDUPLICATE_ON_INSERT.HMBT_CERTIFICATE_TYPE_MST=   SELECT COUNT(*) FROM HMBT_CERTIFICATE_TYPE_MST WHERE UPPER(HMBSTR_CERTIFICATE_TYPE_NAME)=UPPER(?) AND GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID = ? 



INSERT.HMBT_CERTIFICATE_TYPE_MST=   INSERT INTO HMBT_CERTIFICATE_TYPE_MST (HMBNUM_CERTIFICATE_TYPE_ID,HMBNUM_SLNO,HMBSTR_CERTIFICATE_TYPE_NAME,HMBNUM_CERTIFICATE_CAT_ID,HMBSTR_DESC,HMBNUM_BOARD_TYPE,HGNUM_DEPTUNITCODE,HMBNUM_LOCATION_BOUND, \
                                    HMBNUM_MIN_REQ,HMBNUM_MAX_REQ,HMBNUM_REQ_BY,HMBNUM_MAX_AGE,HMBNUM_MIN_AGE,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HMBNUM_ISSUE_TYPE, HGNUM_TEMPLATE_ID,HMBNUM_ISCERTIFICATENO_REQ, HMBNUM_CERTIFICATENO_STARTFROM, HMBNUM_CERTIFICATE_MAXN0) \
                                    VALUES(?,?,initcap(?),?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,DECODE(?,1,TO_CHAR(SYSDATE,'yyyy')||LPAD(?,4,'0'),null) )

                                    
SELECT.HMBT_CERTIFICATE_TYPE_MST =  SELECT HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,HMBNUM_SLNO as slNo,HMBSTR_CERTIFICATE_TYPE_NAME as certificateTypeName,HMBNUM_CERTIFICATE_CAT_ID as certificateCatID,HMBSTR_DESC as description,HMBNUM_BOARD_TYPE as boardType,HGNUM_DEPTUNITCODE as deptUnitCode,HMBNUM_LOCATION_BOUND as locationBound,HMBNUM_MIN_REQ as minRequest,HMBNUM_MAX_REQ as maxRequest, \
                                    HMBNUM_REQ_BY as requisitionBy,HMBNUM_MAX_AGE as maxAge,HMBNUM_MIN_AGE as minAge,HMBNUM_ISSUE_TYPE as issueType, hgnum_template_id as templateCode, HMBNUM_ISCERTIFICATENO_REQ AS isCertNoRequired, HMBNUM_CERTIFICATENO_STARTFROM AS certNoStartFrom \
                                    FROM HMBT_CERTIFICATE_TYPE_MST WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND HMBNUM_SLNO=? AND GNUM_ISVALID=?
               
               
UPDATE.HMBT_CERTIFICATE_TYPE_MST=  UPDATE HMBT_CERTIFICATE_TYPE_MST SET GNUM_LSTMOD_SEATID=? ,GDT_LSTMOD_DATE=SYSDATE ,GNUM_ISVALID=? WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND HMBNUM_SLNO=? AND GNUM_ISVALID=?          


MODIFY_INSERT.HMBT_CERTIFICATE_TYPE_MST= INSERT INTO HMBT_CERTIFICATE_TYPE_MST (HMBNUM_CERTIFICATE_TYPE_ID,HMBNUM_SLNO,HMBSTR_CERTIFICATE_TYPE_NAME,HMBNUM_CERTIFICATE_CAT_ID,HMBSTR_DESC,HMBNUM_BOARD_TYPE,HGNUM_DEPTUNITCODE, \
                                         HMBNUM_LOCATION_BOUND,HMBNUM_MIN_REQ,HMBNUM_MAX_REQ,HMBNUM_REQ_BY,HMBNUM_MAX_AGE,HMBNUM_MIN_AGE,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HMBNUM_ISSUE_TYPE, HGNUM_TEMPLATE_ID,HMBNUM_ISCERTIFICATENO_REQ, HMBNUM_CERTIFICATENO_STARTFROM, HMBNUM_CERTIFICATE_MAXN0) \
                                         VALUES(?,(SELECT NVL(MAX(HMBNUM_SLNO),0)+1 FROM HMBT_CERTIFICATE_TYPE_MST WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=?),initcap(?),?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,DECODE(?,1,TO_CHAR(SYSDATE,'yyyy')||LPAD(?,4,'0'),null) )           
                                         
SELECT_CHECKDUPLICATE_ON_MODIFY.HMBT_CERTIFICATE_TYPE_MST=  SELECT COUNT(*) FROM HMBT_CERTIFICATE_TYPE_MST WHERE UPPER(HMBSTR_CERTIFICATE_TYPE_NAME)=UPPER(?) AND GNUM_ISVALID!=? AND HMBNUM_CERTIFICATE_TYPE_ID<>? AND GNUM_HOSPITAL_CODE = ?                     


INSERT_DISTRICT.HMBT_LOCATION_ELIGIBILITY_MST=   INSERT INTO HMBT_LOCATION_ELIGIBILITY_MST (HMBNUM_CERTIFICATE_TYPE_ID,GNUM_HOSPITAL_CODE,NUM_DIST_ID,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES(?,?,?,?,?,SYSDATE)           



SELECT_DISTRICT.HMBT_LOCATION_ELIGIBILITY_MST=   SELECT A.NUM_DIST_ID,(SELECT GSTR_DISTRICT_NAME FROM GBLT_DISTRICT_MST WHERE GNUM_DISTRICT_CODE=A.NUM_DIST_ID \
                                                 AND GNUM_ISVALID=A.GNUM_ISVALID  )AS DIST  \
                                                FROM HMBT_LOCATION_ELIGIBILITY_MST A WHERE A.HMBNUM_CERTIFICATE_TYPE_ID=? AND A.GNUM_HOSPITAL_CODE=? AND A.GNUM_ISVALID=?  order by DIST 
                                                
                                                
                                                
SELECT_REMAINING_DISTRICT_LIST.GBLT_DISTRICT_MST=  SELECT A.GNUM_DISTRICT_CODE,A.GSTR_DISTRICT_NAME FROM GBLT_DISTRICT_MST A WHERE  A.GNUM_ISVALID=? and \
                                                    A.GNUM_DISTRICT_CODE not in(SELECT NUM_DIST_ID FROM HMBT_LOCATION_ELIGIBILITY_MST WHERE HMBNUM_CERTIFICATE_TYPE_ID=?  AND GNUM_ISVALID=A.GNUM_ISVALID ) order by GSTR_DISTRICT_NAME           
                                                
                                                
UPDATE_DISTRICT.HMBT_LOCATION_ELIGIBILITY_MST=  UPDATE HMBT_LOCATION_ELIGIBILITY_MST SET GDT_LSTMOD_DATE=SYSDATE ,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?
                                                
                                                
SELECT_MAX_CERTIFICATETYPE_ID.HMBT_CERTIFICATE_TYPE_MST=   select nvl(max(HMBNUM_CERTIFICATE_TYPE_ID),10)+1 from HMBT_CERTIFICATE_TYPE_MST where GNUM_HOSPITAL_CODE=?                                             
                                                
        
             
SELECT_CHECK_DUPLICITY_INSERT.HMBT_ORGANIZATION_MST=  SELECT COUNT(*) FROM HMBT_ORGANIZATION_MST WHERE UPPER(HMBSTR_ORG_NAME)=UPPER(?) AND GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID != ?

INSERT.HMBT_ORGANIZATION_MST= INSERT INTO HMBT_ORGANIZATION_MST (HMBNUM_ORGANIZATION_ID,HMBNUM_SLNO,HMBSTR_ORG_NAME,HMBNUM_ORG_TYPE,HMBSTR_ORG_ADDRESS,GNUM_ISVALID,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                              VALUES((SELECT NVL(MAX(HMBNUM_ORGANIZATION_ID),10)+1 FROM HMBT_ORGANIZATION_MST WHERE GNUM_HOSPITAL_CODE=?),?,?,?,?,?,?,?,SYSDATE)


SELECT.HMBT_ORGANIZATION_MST=   SELECT HMBNUM_ORGANIZATION_ID AS orgID,HMBNUM_SLNO AS slNo,HMBSTR_ORG_NAME AS orgName,HMBNUM_ORG_TYPE AS orgTypeID,HMBSTR_ORG_ADDRESS AS orgAddress \
                                FROM HMBT_ORGANIZATION_MST WHERE HMBNUM_ORGANIZATION_ID=? AND GNUM_HOSPITAL_CODE=? AND HMBNUM_SLNO=? AND GNUM_ISVALID=?
               
			   
UPDATE.HMBT_ORGANIZATION_MST=  UPDATE HMBT_ORGANIZATION_MST SET GNUM_LSTMOD_SEATID=? ,GDT_LSTMOD_DATE=SYSDATE ,GNUM_ISVALID=? WHERE HMBNUM_ORGANIZATION_ID=? AND GNUM_HOSPITAL_CODE=? AND HMBNUM_SLNO=? AND GNUM_ISVALID=?		


INSERT_MODIFY.HMBT_ORGANIZATION_MST= INSERT INTO HMBT_ORGANIZATION_MST (HMBNUM_ORGANIZATION_ID,HMBNUM_SLNO,HMBSTR_ORG_NAME,HMBNUM_ORG_TYPE,HMBSTR_ORG_ADDRESS,GNUM_ISVALID,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                                     VALUES(?,(SELECT NVL(MAX(HMBNUM_SLNO),0)+1 FROM HMBT_ORGANIZATION_MST WHERE HMBNUM_ORGANIZATION_ID=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,?,?,SYSDATE)           

	   
SELECT.CHECK_DUPLICITY_MODIFY.HMBT_ORGANIZATION_MST=  SELECT COUNT(*) FROM HMBT_ORGANIZATION_MST WHERE UPPER(HMBSTR_ORG_NAME)=UPPER(?) AND GNUM_ISVALID!=? AND HMBNUM_ORGANIZATION_ID<>? AND GNUM_HOSPITAL_CODE = ?	   
	   
	   
SELECT_ORG_TYPE.HPMRT_FLAG_MST=    SELECT HPMRNUM_FLAG_VALUE,HPMRSTR_FLAG_DESC FROM HPMRT_FLAG_MST WHERE HPMRNUM_TABLE_ID=? AND HPMRSTR_COLUMN_NAME='HMBNUM_ORG_TYPE'	   
	    
             
//------------------------------------------------CheckList_master---------------------------------------------------

INSERT.HMBT_CHECKLIST_MST	=	insert into HMBT_CHECKLIST_MST (HMBNUM_CHECKLIST_ID, HMBNUM_SLNO, GNUM_HOSPITAL_CODE, HMBSTR_CHECKLIST, HMBSTR_REMARKS, HMBNUM_ISCOMPULSORY, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) \
 							values((select  nvl(max(HMBNUM_CHECKLIST_ID),10)+1 from HMBT_CHECKLIST_MST where gnum_hospital_code=?),?,?,initcap(?),?,?,?,?,sysdate )              
             
             
SELECT.HMBT_BOARD_TEAM_MST=    SELECT HMBSTR_EMP_ID as empID,HMBNUM_ROLE_ID as roleID,HMBNUM_SLNO as boardTeamSlNo, \
                               (SELECT HMBSTR_BOARD_NAME FROM HMBT_BOARD_MST WHERE HMBNUM_BOARD_ID=A.HMBNUM_BOARD_ID  AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE and GNUM_ISVALID=A.GNUM_ISVALID) as boardName, \
                               (SELECT str_emp_full_name FROM pist_emp_registration_dtl WHERE STR_EMP_NO=A.HMBSTR_EMP_ID AND GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) AS empName, \
                               (SELECT HMBSTR_ROLE_NAME FROM HMBT_ROLE_MST WHERE HMBNUM_ROLE_ID=A.HMBNUM_ROLE_ID AND GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=100) as roleName ,(SELECT HMBNUM_BOARD_TYPE  FROM hmbt_board_mst WHERE hmbnum_board_id = a.hmbnum_board_id  AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid) AS boardTypeID  \
                               FROM HMBT_BOARD_TEAM_MST A WHERE A.HMBNUM_BOARD_ID=? AND A.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=?        
                               
SELECT_BOARD_ID.HMBT_BOARD_MST = SELECT NVL(MAX(HMBNUM_BOARD_ID),10)+1 FROM HMBT_BOARD_MST WHERE GNUM_HOSPITAL_CODE=?                          
                               
INSERT.HMBT_BOARD_MST=   INSERT INTO HMBT_BOARD_MST (HMBNUM_BOARD_ID,HMBNUM_SLNO,HMBSTR_BOARD_NAME,HMBNUM_BOARD_TYPE,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                         VALUES(?,(SELECT NVL(MAX(HMBNUM_SLNO),0)+1 FROM HMBT_BOARD_MST WHERE HMBNUM_BOARD_ID=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,?,SYSDATE )                                 
                               
                                      
INSERT.HMBT_BOARD_TEAM_MST=  INSERT INTO HMBT_BOARD_TEAM_MST (HMBNUM_BOARD_ID,HMBNUM_SLNO,GNUM_HOSPITAL_CODE,HMBSTR_EMP_ID,HMBNUM_ROLE_ID,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                             VALUES(?,(SELECT NVL(MAX(HMBNUM_SLNO),0)+1 FROM HMBT_BOARD_TEAM_MST WHERE HMBNUM_BOARD_ID=? AND GNUM_HOSPITAL_CODE=? AND HMBSTR_EMP_ID=?),?,?,?,?,?,SYSDATE )           
                         
                                      
CHECK_DUPLICATE_BOARDNAME.HMBT_BOARD_MST=  SELECT COUNT(*) FROM HMBT_BOARD_MST WHERE UPPER(HMBSTR_BOARD_NAME)=UPPER(?) AND GNUM_HOSPITAL_CODE = ? AND GNUM_ISVALID != ?          
               
               
UPDATE.HMBT_BOARD_MST=  UPDATE HMBT_BOARD_MST SET GDT_LSTMOD_DATE=SYSDATE ,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE HMBNUM_BOARD_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?               
               
UPDATE.HMBT_BOARD_TEAM_MST= UPDATE HMBT_BOARD_TEAM_MST SET GDT_LSTMOD_DATE=SYSDATE,GNUM_LSTMOD_SEATID=? , GNUM_ISVALID=? WHERE HMBNUM_BOARD_ID=?  AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?              
               

CHECK_DUPLICATE.MODIFY.HMBT_BOARD_MST=    SELECT COUNT(*) FROM HMBT_BOARD_MST WHERE UPPER(HMBSTR_BOARD_NAME)=UPPER(?) AND GNUM_ISVALID!=? AND HMBNUM_BOARD_ID<>? AND GNUM_HOSPITAL_CODE = ? 
          
          
SELECT_UNSELECTED_BOARD.HMBT_BOARD_MST =  SELECT A.HMBNUM_BOARD_ID,A.HMBSTR_BOARD_NAME FROM HMBT_BOARD_MST A WHERE A.HMBNUM_BOARD_TYPE=? AND A.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=? AND \
                                          A.HMBNUM_BOARD_ID NOT IN(SELECT HMBNUM_BOARD_ID FROM HMBT_CERTIFICATE_BOARD_MST WHERE GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE and HMBNUM_CERTIFICATE_TYPE_ID=?) order by A.HMBSTR_BOARD_NAME           
          
SELECT_SELECTED_BOARD.HMBT_CERTIFICATE_BOARD_MST=  SELECT HMBNUM_BOARD_ID,(SELECT HMBSTR_BOARD_NAME FROM HMBT_BOARD_MST WHERE HMBNUM_BOARD_ID=A.HMBNUM_BOARD_ID AND GNUM_ISVALID=A.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE) as boardName \
                                                   FROM HMBT_CERTIFICATE_BOARD_MST A WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? and HMBNUM_CERTIFICATE_TYPE_ID=? order by boardName
          
               
INSERT.HMBT_CERTIFICATE_BOARD_MST= INSERT INTO HMBT_CERTIFICATE_BOARD_MST (HMBNUM_CERTIFICATE_TYPE_ID,HMBNUM_SNO,HMBNUM_BOARD_ID,GNUM_HOSPITAL_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                                   VALUES(?,(SELECT NVL(MAX(HMBNUM_SNO),0)+1 FROM HMBT_CERTIFICATE_BOARD_MST WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? and HMBNUM_BOARD_ID=?),?,?,?,?,SYSDATE )                                 
                             
                             
UPDATE.HMBT_CERTIFICATE_BOARD_MST=   UPDATE HMBT_CERTIFICATE_BOARD_MST SET GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=?,GNUM_ISVALID=? WHERE GNUM_HOSPITAL_CODE=? AND HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_ISVALID=?
                             
                             
                                                               
CHECK.DUPLICATE_BEFORE_SAVE.HMBT_CHECKLIST_MST	=	SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE upper(HMBSTR_CHECKLIST)=? and gnum_hospital_code = ? and gnum_isvalid !=?                                                

SELECT.HMBT_CHECKLIST_MST	=	SELECT hmbnum_checklist_id checklistId, hmbstr_checklist checklist, hmbstr_remarks remarks, hmbnum_iscompulsory isCompulsory, gnum_isvalid isValid FROM hmbt_checklist_mst WHERE gnum_hospital_code = ? \
   								AND HMBNUM_SLNO = ?  AND hmbnum_checklist_id = ?       
   						
CHECK.DUPLICATE_BEFORE_MODIFY.HMBT_CHECKLIST_MST	=	SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE gnum_hospital_code = ? and upper(HMBSTR_CHECKLIST)=? and gnum_isvalid <> ? and hmbnum_checklist_id <> ?     						
   						
UPDATE.HMBT_CHECKLIST_MST	=	update hmbt_checklist_mst set gnum_isvalid=?,GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? WHERE gnum_hospital_code = ?  AND HMBNUM_SLNO = ? AND hmbnum_checklist_id = ?   						

MODIFY.INSERT.HMBT_CHECKLIST_MST	=	insert into HMBT_CHECKLIST_MST (HMBNUM_CHECKLIST_ID, HMBNUM_SLNO, GNUM_HOSPITAL_CODE, HMBSTR_CHECKLIST, HMBSTR_REMARKS, HMBNUM_ISCOMPULSORY, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) \
 							values(?,(select nvl(max(HMBNUM_SLNO),0)+1 from HMBT_CHECKLIST_MST where HMBNUM_CHECKLIST_ID=? and gnum_hospital_code=?),?,initcap(?),?,?,?,?,sysdate )   						
   						                          
//---------------------------------------------Certificate_checklist_master----------------------------------------------

SELECT.CERTIFICATE_TYPE.HMBT_CERTIFICATE_TYPE_MST	=	SELECT HMBNUM_CERTIFICATE_TYPE_ID, HMBSTR_CERTIFICATE_TYPE_NAME FROM HMBT_CERTIFICATE_TYPE_MST WHERE GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? ORDER BY INITCAP(HMBSTR_CERTIFICATE_TYPE_NAME)

SELECT.CHECKLIST_NOT_ADDED.HMBT_CHECKLIST_MST	=	SELECT hmbnum_checklist_id||'@'|| hmbnum_iscompulsory, hmbstr_checklist checklist FROM hmbt_checklist_mst a WHERE gnum_hospital_code = ? AND gnum_isvalid = ? AND hmbnum_checklist_id NOT IN ( \
            											SELECT hmbnum_checklist_id FROM hmbt_certificate_checklist_mst WHERE gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid and HMBNUM_CERTIFICATE_TYPE_ID=?) ORDER BY checklist    
            											
SELECT.CHECKLIST_ADDED.HMBT_CERTIFICATE_CHECKLIST_MST =	SELECT hmbnum_certificate_type_id certificateTypeID,hmbnum_checklist_id checklistID,hmbnum_iscompulsory isCompulsory,HMBNUM_SNO serialNo,(SELECT hmbstr_checklist FROM hmbt_checklist_mst WHERE \
														hmbnum_checklist_id = a.hmbnum_checklist_id and gnum_hospital_code=a.gnum_hospital_code \
		   												and gnum_isvalid=a.gnum_isvalid) checklist FROM hmbt_certificate_checklist_mst a WHERE gnum_hospital_code = ? AND gnum_isvalid = ? and HMBNUM_CERTIFICATE_TYPE_ID=? ORDER BY checklist            		
		   																						
INSERT.HMBT_CERTIFICATE_CHECKLIST_MST	=	insert into HMBT_CERTIFICATE_CHECKLIST_MST (HMBNUM_CERTIFICATE_TYPE_ID, GNUM_HOSPITAL_CODE, HMBNUM_SNO, HMBNUM_CHECKLIST_ID, GNUM_ISVALID, HMBNUM_ISCOMPULSORY, GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,(select \
 											nvl(max(HMBNUM_SNO),0)+1 from HMBT_CERTIFICATE_CHECKLIST_MST where HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_HOSPITAL_CODE=?),?,?,?,?,sysdate) 

UPDATE.HMBT_CERTIFICATE_CHECKLIST_MST	=	update HMBT_CERTIFICATE_CHECKLIST_MST set  GNUM_ISVALID=? ,GDT_LSTMOD_DATE=sysdate,GNUM_LSTMOD_SEATID=? where HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_HOSPITAL_CODE=? and HMBNUM_CHECKLIST_ID=? \
											and HMBNUM_SNO=(select max(HMBNUM_SNO) from HMBT_CERTIFICATE_CHECKLIST_MST where HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_HOSPITAL_CODE=? and HMBNUM_CHECKLIST_ID=?)
 											

 					
//---------------------------------------------Role_master---------------------------------------------- 					
 								 											   
SELECT_CHECKDUPLICATE.HMBT_ROLE_MST= 		SELECT COUNT(*) FROM HMBT_ROLE_MST WHERE UPPER(HMBSTR_ROLE_NAME)=UPPER(?) AND GNUM_HOSPITAL_CODE =? AND GNUM_ISVALID != ?					   
 						
INSERT.HMBT_ROLE_MST= 	INSERT INTO HMBT_ROLE_MST (HMBNUM_ROLE_ID,HMBNUM_SLNO,HMBSTR_ROLE_NAME,GNUM_ISVALID,GNUM_HOSPITAL_CODE, GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                        VALUES((SELECT NVL(MAX(HMBNUM_ROLE_ID),10)+1 FROM HMBT_ROLE_MST WHERE GNUM_HOSPITAL_CODE=?),?,?,?,?,?,SYSDATE)					
 						
SELECT.HMBT_ROLE_MST=    SELECT HMBNUM_ROLE_ID AS roleID,HMBNUM_SLNO AS slNo,HMBSTR_ROLE_NAME AS roleName FROM HMBT_ROLE_MST WHERE HMBNUM_ROLE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?						
 						
UPDATE.HMBT_ROLE_MST = 	UPDATE HMBT_ROLE_MST SET GNUM_LSTMOD_SEATID=? ,GDT_LSTMOD_DATE=SYSDATE ,GNUM_ISVALID=? WHERE HMBNUM_ROLE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?		
 			
 			
INSERT_MODIFY.HMBT_ROLE_MST= INSERT INTO HMBT_ROLE_MST (HMBNUM_ROLE_ID,HMBNUM_SLNO,HMBSTR_ROLE_NAME,GNUM_ISVALID,GNUM_HOSPITAL_CODE,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
 					        VALUES(?,(SELECT NVL(MAX(HMBNUM_SLNO),0)+1 FROM HMBT_ROLE_MST WHERE HMBNUM_ROLE_ID=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,SYSDATE)   						        											                                

SELECT_CHECKDUPLICATE_MODIFY.HMBT_ROLE_MST= SELECT COUNT(*) FROM HMBT_ROLE_MST WHERE UPPER(HMBSTR_ROLE_NAME)=UPPER(?) AND GNUM_ISVALID!=? AND HMBNUM_ROLE_ID<>? AND GNUM_HOSPITAL_CODE = ?			        
 					        
 					        
 					    
INSERT.HMBT_REFER_MAPPING=    INSERT INTO HMBT_REFER_MAPPING (HMBNUM_CERTIFICATE_TYPE_ID,GNUM_HOSPITAL_CODE,HMBNUM_SNO,HMBNUM_REFER_TYPE, \
                              GNUM_DEPT_CODE,HGNUM_DEPTUNITCODE,HMBSTR_REFER_REMARKS,GNUM_ISVALID,HMBNUM_IS_OPTIONAL,GNUM_SEAT_ID,GDT_ENTRY_DATE) \
                              VALUES(?,?,(SELECT NVL(MAX(HMBNUM_SNO),0)+1 FROM HMBT_REFER_MAPPING WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=?),?,?,?,?,?,?,?,sysdate)   						        											                                
 					    
SELECT.HMBT_REFER_MAPPING=    SELECT HMBNUM_CERTIFICATE_TYPE_ID AS certificateTypeID,HMBNUM_SNO AS slNo,HMBNUM_REFER_TYPE AS referType, \
                              GNUM_DEPT_CODE AS deptCode,HGNUM_DEPTUNITCODE AS deptUnitCode,HMBSTR_REFER_REMARKS AS remarks, \
                              HMBNUM_IS_OPTIONAL AS isOptional FROM HMBT_REFER_MAPPING WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?
 					        
 					        
UPDATE.HMBT_REFER_MAPPING= 	  UPDATE HMBT_REFER_MAPPING SET GNUM_LSTMOD_SEATID=?,GDT_LSTMOD_DATE=SYSDATE ,GNUM_ISVALID=? WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?  
 					        
 					        
 					        
 					        

SELECT.CERTIFICATE_TYPE_NAME.HMBT_CERTIFICATE_TYPE_MST	=	SELECT hmbstr_certificate_type_name FROM hmbt_certificate_type_mst where HMBNUM_CERTIFICATE_TYPE_ID=? and GNUM_HOSPITAL_CODE=? and GNUM_ISVALID=? 	
										        											                                
SELECT.LABTEST_LIST.HIVT_LABORATORY_TEST_DTL = select a.GNUM_LAB_TEST_CODE ,b.GSTR_LAB_NAME||'('||c.GSTR_TEST_NAME||')' AS testname \
												from HIVT_LABORATORY_TEST_DTL a,GBLT_LABORATORY_MST b,GBLT_TEST_MST c \
												where a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? \
												and substr(a.GNUM_LAB_TEST_CODE,0,5)=b.GNUM_LAB_CODE and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE  and a.GNUM_ISVALID=b.GBL_ISVALID \
												and substr(a.GNUM_LAB_TEST_CODE,6,9)=c.GNUM_TEST_CODE and a.GNUM_HOSPITAL_CODE=c.GNUM_HOSPITAL_CODE  and a.GNUM_ISVALID=c.GNUM_ISVALID \
												and c.GSTR_TEST_TYPE in ('S','P') \
												and a.GNUM_LAB_TEST_CODE not in (select x.GNUM_LAB_TEST_CODE from HMBT_INVESTIGATION_MAPPING x where x.HMBNUM_CERTIFICATE_TYPE_ID=? and x.GNUM_HOSPITAL_CODE=? and x.GNUM_ISVALID=?) \
												order by testname

SELECT.SEL_LABTEST_LIST.HIVT_LABORATORY_TEST_DTL = select gnum_lab_test_code as labTestCode,b.gstr_lab_name || '(' || c.gstr_test_name || ')' as labTestName, \
												   a.HMBNUM_CERTIFICATE_TYPE_ID as certificateTypeID,a.HMBNUM_IS_OPTIONAL as isOptional, \
												   decode(a.HMBNUM_IS_OPTIONAL ,'1','Yes','0','No') as isOptionalName \
													from HMBT_INVESTIGATION_MAPPING a,GBLT_LABORATORY_MST b,GBLT_TEST_MST c \
													where a.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? \
													and substr(a.GNUM_LAB_TEST_CODE,0,5)=b.GNUM_LAB_CODE and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE  and a.GNUM_ISVALID=b.GBL_ISVALID \
													and substr(a.GNUM_LAB_TEST_CODE,6,9)=c.GNUM_TEST_CODE and a.GNUM_HOSPITAL_CODE=c.GNUM_HOSPITAL_CODE  and a.GNUM_ISVALID=c.GNUM_ISVALID \
													and a.HMBNUM_CERTIFICATE_TYPE_ID=? \
													order by b.GSTR_LAB_NAME||'('||c.GSTR_TEST_NAME||')'	
													
INSERT.HMBT_INVESTIGATION_MAPPING = insert into HMBT_INVESTIGATION_MAPPING (HMBNUM_CERTIFICATE_TYPE_ID, GNUM_HOSPITAL_CODE, HMBNUM_SNO,  \
									GNUM_LAB_TEST_CODE, GNUM_ISVALID, HMBNUM_IS_OPTIONAL, GNUM_SEAT_ID, GDT_ENTRY_DATE,  \
									GDT_LSTMOD_DATE, GNUM_LSTMOD_SEATID) \
									values(?,?,(SELECT NVL(MAX(HMBNUM_SNO),0)+1 FROM HMBT_INVESTIGATION_MAPPING \
									WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? and GNUM_LAB_TEST_CODE=?),?,?,?,?,trunc(sysdate),to_date(?,'dd-Mon-yyyy'),?)		
									
UPDATE.HMBT_INVESTIGATION_MAPPING = UPDATE HMBT_INVESTIGATION_MAPPING SET GNUM_LSTMOD_SEATID=?,GDT_LSTMOD_DATE=trunc(SYSDATE) ,GNUM_ISVALID=? \
									WHERE HMBNUM_CERTIFICATE_TYPE_ID=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?																															