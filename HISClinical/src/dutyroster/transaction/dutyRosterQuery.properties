//----------------------------Query----For-----HDRT_ROSTER_DTL-----Employee--Duty--Roster-------------------------------------------------
													
SELECT_GENERATE_ROSTER_ID.PKG_DUTY_ROSTER.GEN_ROSTER_ID=select pkg_duty_roster.gen_roster_id(?) from dual													
													 

INSERT.HDRT_ROSTER_DTL=insert into HDRT_ROSTER_DTL(HDRNUM_ROSTER_TYPE_ID, HDRSTR_DUTY_AREA_CODE, HDRNUM_AREA_TYPE_CODE, STR_EMP_NO, HDRNUM_SHIFT_ID, HDRDT_START_DATETIME, HDRDT_END_DATETIME, HDRNUM_DUTY_ROLE_ID, HDRNUM_DUTY_DONE, HDRSTR_DUTY_REMARKS, HDRSTR_CANCEL_REMARKS,GNUM_ISVALID, GNUM_ENTER_BY, GDT_ENTRY_DATE,  GNUM_HOSPITAL_CODE,HDRNUM_ROSTER_ID, HDRNUM_SLNO,HDRDT_FROM_DATE,HDRDT_TO_DATE,HDRNUM_DUTY_TYPE) values (?,?,?,?,?,TO_DATE (?, 'dd/mm/yyyy hh24\:mi\:ss'),TO_DATE (?, 'dd/mm/yyyy hh24\:mi\:ss'),?,?,?,?,?,?,SYSDATE,?,?,(select nvl(max(HDRNUM_SLNO),0)+1 from HDRT_ROSTER_DTL where HDRNUM_ROSTER_ID\=? ),TO_DATE (?, 'dd/mm/yyyy'),TO_DATE (?, 'dd/mm/yyyy'),? )
	 

SELECT.HDRT_ROSTER_DTL.PIST_EMP_PERSONNEL_DTL=SELECT  str_emp_no || '^'  || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) || '^' || hdrnum_shift_id  || '^' || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5)  || '^' || SUBSTR (TO_CHAR (hdrdt_end_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5) AS concateData, (SELECT    INITCAP(str_first_name) || ' ' || INITCAP(str_middle_name) || ' ' || INITCAP(str_last_name)  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_isvalid \=?  AND gnum_hospital_code \=?) AS empName FROM hdrt_roster_dtl a    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'), 4,2) \= ? AND SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'), 7,4) \= ?  AND SUBSTR (TO_CHAR (hdrdt_end_datetime, 'dd-mm-yyyy hh24\:mi\:ss'), 4, 2) \=? AND SUBSTR (TO_CHAR (hdrdt_end_datetime, 'dd-mm-yyyy hh24\:mi\:ss'), 7, 4) \=?   ORDER BY empName,concatedata\t 
			         
SELECT.HDRT_ROSTER_DTL.PIST_EMP_PERSONNEL_DTL.2=SELECT  a.str_emp_no || '^'  || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) || '^' || hdrnum_shift_id  || '^' || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5)  || '^' || SUBSTR (TO_CHAR (hdrdt_end_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5) AS concateData, (SELECT    INITCAP(str_first_name) || ' ' || INITCAP(str_middle_name) || ' ' || INITCAP(str_last_name)  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_isvalid \=?  AND gnum_hospital_code \=?) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t and b.NUM_DESIG_ID\=?  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=?  AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID

			         


SELECT_ALL.HDRT_ROSTER_DTL.PIST_EMP_PERSONNEL_DTL=SELECT  a.str_emp_no || '^'  || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) || '^' || hdrnum_shift_id  || '^' || SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5)  || '^' || SUBSTR (TO_CHAR (hdrdt_end_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5) AS concateData, (SELECT    INITCAP(str_first_name) || ' ' || INITCAP(str_middle_name) || ' ' || INITCAP(str_last_name)  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_isvalid \=?  AND gnum_hospital_code \=?) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			      
	
	
UPDATE_ISVALID.HDRT_ROSTER_DTL=UPDATE hdrt_roster_dtl   SET gnum_isvalid \= ?  WHERE hdrnum_roster_type_id \=?  AND hdrstr_duty_area_code \=?  AND hdrnum_area_type_code \=?  AND gnum_isvalid \=?   AND gnum_hospital_code \=? \t \t
			      
//-------------------Query----For-----HDRT_BLOCKWISE_ROSTER_DTL-----Location---Capacity--Duty--Roster------------------------------------------


			         
INSERT.HDRT_BLOCKWISE_ROSTER_DTL=insert into HDRT_BLOCKWISE_ROSTER_DTL(HDRNUM_ROSTER_TYPE_ID, HDRSTR_DUTY_AREA_CODE, HDRNUM_AREA_TYPE_CODE, HDRNUM_SHIFT_ID, HDRNUM_CAPACITY, HDRDT_START_DATETIME, HDRDT_END_DATETIME, HDRNUM_DUTY_ROLE_ID, HDRNUM_DUTY_DONE, HDRSTR_DUTY_REMARKS, HDRSTR_CANCEL_REMARKS, HDRNUM_BLOCK_ID, NUM_DESIG_ID,GNUM_ISVALID, GNUM_ENTER_BY, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HDRDT_FROM_DATE, HDRDT_TO_DATE) values\t(?,?,?,?,?,TO_DATE (?, 'dd/mm/yyyy hh24\:mi\:ss'),TO_DATE (?, 'dd/mm/yyyy hh24\:mi\:ss'),?,?,?,?,?,?,?,?,SYSDATE,?,TO_DATE (?, 'dd-mon-yyyy'),TO_DATE (?, 'dd-mon-yyyy'))
					


SELECT_DISTINCT_ROSTERS_BLOCKWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT DISTINCT TO_CHAR (HDRDT_FROM_DATE,'dd-mm-yyyy')  || '@' || TO_CHAR (HDRDT_TO_DATE,'dd-mm-yyyy') || '@' || nvl(hdrnum_isgenerated,0) as concateDate,HDRDT_FROM_DATE as startDate FROM hdrt_blockwise_roster_dtl  WHERE hdrnum_roster_type_id =? AND hdrnum_block_id =?  and GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=?  ORDER BY startDate


SELECT_DISTINCT_ROSTERS_AREAWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT DISTINCT TO_CHAR (HDRDT_FROM_DATE,'dd-mm-yyyy')  || '@' || TO_CHAR (HDRDT_TO_DATE,'dd-mm-yyyy') || '@' ||nvl(hdrnum_isgenerated,0) as concateDate,HDRDT_FROM_DATE as startDate  FROM hdrt_blockwise_roster_dtl  WHERE HDRNUM_ROSTER_TYPE_ID=?  and HDRNUM_AREA_TYPE_CODE=?  and  HDRSTR_DUTY_AREA_CODE=? and GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=? ORDER BY startDate


SELECT_MAX_DATE_BLOCKWISE_ROSTERS.HDRT_BLOCKWISE_ROSTER_DTL=SELECT distinct to_char(max(hdrdt_end_datetime),'dd-mm-yyyy') as maxEndDate  FROM hdrt_blockwise_roster_dtl  WHERE hdrnum_roster_type_id =? AND hdrnum_block_id =?


SELECT_MAX_DATE_AREAWISE_ROSTERS.HDRT_BLOCKWISE_ROSTER_DTL=SELECT distinct to_char(max(hdrdt_end_datetime),'dd-mm-yyyy') as maxEndDate   FROM hdrt_blockwise_roster_dtl  WHERE HDRNUM_ROSTER_TYPE_ID=?  and HDRNUM_AREA_TYPE_CODE=?  and  HDRSTR_DUTY_AREA_CODE=?


SELECT_DATE_CHECK_BLOCKWISE.HDRT_BLOCKWISE_ROSTER_DTL_OLD=SELECT COUNT (*)  FROM hdrt_blockwise_roster_dtl  WHERE TRUNC (HDRDT_START_DATETIME) <= TRUNC (TO_DATE (?, 'dd-mm-yyyy'))  AND TRUNC (HDRDT_END_DATETIME) >=TRUNC (TO_DATE (?, 'dd-mm-yyyy'))  AND hdrnum_roster_type_id =? AND hdrnum_block_id =?    and GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=?


SELECT_DATE_CHECK_AREAWISE.HDRT_BLOCKWISE_ROSTER_DTL_OLD=SELECT COUNT (*)  FROM hdrt_blockwise_roster_dtl  WHERE TRUNC (HDRDT_START_DATETIME) <= TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  AND TRUNC (HDRDT_END_DATETIME) >=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  AND hdrnum_roster_type_id =?    AND hdrnum_area_type_code =?    AND hdrstr_duty_area_code =?  and GNUM_ISVALID=? and  GNUM_HOSPITAL_CODE=?



SELECT_DATE_CHECK_BLOCKWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT COUNT (*)  FROM hdrt_blockwise_roster_dtl  WHERE (\t   (    TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) OR (    TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) OR (    TRUNC (HDRDT_FROM_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   ) OR (    TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   AND TRUNC (HDRDT_TO_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) )   AND hdrnum_roster_type_id \=?   AND hdrnum_block_id \=?   AND gnum_isvalid \=?   AND gnum_hospital_code \=? 
	
	
	

SELECT_DATE_CHECK_AREAWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT COUNT (*)  FROM hdrt_blockwise_roster_dtl  WHERE (\t   (    TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) OR (    TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) OR (    TRUNC (HDRDT_FROM_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy')) AND TRUNC (HDRDT_FROM_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   ) OR (    TRUNC (HDRDT_TO_DATE) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   AND TRUNC (HDRDT_TO_DATE) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))     ) )   AND hdrnum_roster_type_id \=?    AND hdrnum_area_type_code \=?    AND hdrstr_duty_area_code \=?  and GNUM_ISVALID\=? and  GNUM_HOSPITAL_CODE\=?




SELECT_ROSTER_AREAWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT  distinct  hdrnum_roster_type_id AS rosterId, hdrstr_duty_area_code AS areaCode,hdrnum_area_type_code AS areaTypecode, hdrnum_shift_id AS shiftId,hdrnum_capacity AS capacity, to_char(HDRDT_FROM_DATE, 'dd-Mon-yyyy') AS fromDate,TO_CHAR (HDRDT_TO_DATE, 'dd-Mon-yyyy') AS toDate, hdrnum_duty_role_id AS roleId,hdrnum_duty_done AS dutyDone, hdrstr_duty_remarks AS dutyRemarks,hdrstr_cancel_remarks AS cancelRemarks, hdrnum_block_id AS blockId,num_desig_id AS designationId,(SELECT pkg_duty_roster.areaName(?,a.hdrnum_area_type_code,a.hdrstr_duty_area_code) FROM DUAL) AS areaName, (SELECT gstr_desig_name   FROM gblt_designation_mst  WHERE gnum_hospital_code \= ?  AND gnum_isvalid \= ?   AND num_desig_id \= a.num_desig_id) AS desigName,(SELECT    hdtstr_shift_shortname || '@' || hdrstr_start_time || '@' || hdrstr_end_time || '@' || HDTSTR_SHIFT_DESC || '@' || HDRNUM_SHIFT_TYPE   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \=?    AND gnum_isvalid \=? AND hdrnum_slno \=(SELECT MAX (hdrnum_slno) FROM hdrt_shift_mst WHERE hdrnum_shift_id \= a.hdrnum_shift_id AND gnum_hospital_code \=? AND gnum_isvalid \= ?)) AS shiftDesc, ( SELECT     HDRNUM_SHIFT_TYPE FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE    AND gnum_isvalid \=a.gnum_isvalid AND hdrnum_slno \=(SELECT MAX (hdrnum_slno) FROM hdrt_shift_mst WHERE hdrnum_shift_id \= a.hdrnum_shift_id AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE  AND gnum_isvalid \=a.gnum_isvalid )) AS shiftType FROM hdrt_blockwise_roster_dtl  a WHERE hdrnum_roster_type_id \=?   AND hdrnum_area_type_code \=?    AND hdrstr_duty_area_code \=? AND to_char(HDRDT_FROM_DATE, 'dd-mm-yyyy') \=?   AND to_char(HDRDT_TO_DATE, 'dd-mm-yyyy') \=?  and GNUM_ISVALID\=? and  GNUM_HOSPITAL_CODE\=?  ORDER BY areaName, desigName, shiftType 

#\\Change in column name from a.num_desig_id to gnum_desig_code for  gblt_designation_mst\\
#\\ By Chetan Sharma\\
SELECT_ROSTER_BLOCKWISEWISE.HDRT_BLOCKWISE_ROSTER_DTL=SELECT  distinct  hdrnum_roster_type_id AS rosterId, hdrstr_duty_area_code AS areaCode,hdrnum_area_type_code AS areaTypecode, hdrnum_shift_id AS shiftId,hdrnum_capacity AS capacity, to_char(HDRDT_FROM_DATE, 'dd-Mon-yyyy') AS fromDate,TO_CHAR (HDRDT_TO_DATE, 'dd-Mon-yyyy') AS toDate, hdrnum_duty_role_id AS roleId,hdrnum_duty_done AS dutyDone, hdrstr_duty_remarks AS dutyRemarks,hdrstr_cancel_remarks AS cancelRemarks, hdrnum_block_id AS blockId,num_desig_id AS designationId,(SELECT pkg_duty_roster.areaName(?,a.hdrnum_area_type_code,a.hdrstr_duty_area_code) FROM DUAL) AS areaName, (SELECT gstr_desig_name   FROM gblt_designation_mst  WHERE gnum_hospital_code \= ?  AND gnum_isvalid \= ?   AND  gnum_desig_code \= a.num_desig_id) AS desigName,(SELECT    hdtstr_shift_shortname || '@' || hdrstr_start_time || '@' || hdrstr_end_time  || '@' || hdtstr_shift_desc || '@' || HDRNUM_SHIFT_TYPE FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \=?    AND gnum_isvalid \=? AND hdrnum_slno \=(SELECT MAX (hdrnum_slno) FROM hdrt_shift_mst WHERE hdrnum_shift_id \= a.hdrnum_shift_id AND gnum_hospital_code \=? AND gnum_isvalid \= ?)) AS shiftDesc, ( SELECT     HDRNUM_SHIFT_TYPE FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE    AND gnum_isvalid \=a.gnum_isvalid AND hdrnum_slno \=(SELECT MAX (hdrnum_slno) FROM hdrt_shift_mst WHERE hdrnum_shift_id \= a.hdrnum_shift_id AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE AND gnum_isvalid \=a.gnum_isvalid )) AS shiftType FROM hdrt_blockwise_roster_dtl  a   WHERE hdrnum_roster_type_id \=?  AND hdrnum_block_id \=?  AND TO_CHAR (HDRDT_FROM_DATE, 'dd-mm-yyyy') \= ?  AND TO_CHAR (HDRDT_TO_DATE, 'dd-mm-yyyy') \= ?  and GNUM_ISVALID\=? and  GNUM_HOSPITAL_CODE\=?  ORDER BY areaName, desigName, shiftType 
 
  
UPDATE_ROSTER_BLOCKWISEWISE.HDRT_BLOCKWISE_ROSTER_DTL=update hdrt_blockwise_roster_dtl set GNUM_ISVALID=? WHERE hdrnum_roster_type_id =?  AND hdrnum_block_id =?  AND TO_CHAR (HDRDT_FROM_DATE, 'dd-mon-yyyy') = to_date(?,'dd-mon-yyyy')  AND TO_CHAR (HDRDT_TO_DATE, 'dd-mon-yyyy') = to_date(?,'dd-mon-yyyy')  and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?


UPDATE_ROSTER_AREAWISE.HDRT_BLOCKWISE_ROSTER_DTL=update hdrt_blockwise_roster_dtl set GNUM_ISVALID=? WHERE hdrnum_roster_type_id =?   AND hdrnum_area_type_code =?    AND hdrstr_duty_area_code =? AND to_char(HDRDT_FROM_DATE, 'dd-mon-yyyy') = to_date(?,'dd-mon-yyyy')    AND to_char(HDRDT_TO_DATE, 'dd-mon-yyyy') =to_date(?,'dd-mon-yyyy')  and  GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?



UPDATE_BLOCKWISEWISE_GENERATE.HDRT_BLOCKWISE_ROSTER_DTL=UPDATE hdrt_blockwise_roster_dtl a   SET gdt_verify_date \= SYSDATE,gnum_verify_by \=?,hdrnum_isgenerated \=?  WHERE hdrnum_roster_type_id \= ? AND hdrnum_block_id \= ?  AND TO_CHAR (HDRDT_FROM_DATE, 'dd-mm-yyyy') \= ?    AND TO_CHAR (HDRDT_TO_DATE, 'dd-mm-yyyy') \= ?    AND gnum_isvalid \= ?   AND gnum_hospital_code \= ?

UPDATE_AREAWISE_GENERATE.HDRT_BLOCKWISE_ROSTER_DTL=UPDATE hdrt_blockwise_roster_dtl a  SET gdt_verify_date \= SYSDATE,gnum_verify_by \=?,hdrnum_isgenerated \= ? WHERE hdrnum_roster_type_id \= ?   AND hdrnum_area_type_code \=?    AND hdrstr_duty_area_code \=?    AND TO_CHAR (HDRDT_FROM_DATE, 'dd-mm-yyyy') \=?  AND TO_CHAR (HDRDT_TO_DATE, 'dd-mm-yyyy') \= ?   AND gnum_isvalid \= ?   AND gnum_hospital_code \=?




//////----------------------Queries---for---Monthwise----EMPLOYEE---Roster--AND---Report--------------------------//////  


SELECT_DESG_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL=SELECT   a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, NVL ((SELECT HDRSTR_START_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftStartTime,  NVL ((SELECT HDRSTR_END_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftEndTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime , SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN (SELECT hdrnum_roster_type_id FROM hdrt_roster_type_mst  WHERE hdrnum_area_type_code \=a.hdrnum_area_type_code  AND hdrnum_roster_cat_id \= (SELECT hdrnum_roster_cat_id  FROM hdrt_roster_type_mst   WHERE hdrnum_roster_type_id \= ? AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ) AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t and b.NUM_DESIG_ID\=?  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=?  AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID
    


SELECT_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL_OLD=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN (SELECT hdrnum_roster_type_id FROM hdrt_roster_type_mst  WHERE hdrnum_area_type_code \=a.hdrnum_area_type_code  AND hdrnum_roster_cat_id \= (SELECT hdrnum_roster_cat_id  FROM hdrt_roster_type_mst   WHERE hdrnum_roster_type_id \= ? AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ) AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			      
  
/////////Query-----for----report----making----in---case---of---all---mapped---areas----is----selected
   
SELECT_ALL_MAPPED_AREA_EMP_REPORT.HDRT_ROSTER_DTL_OLD=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN (SELECT hdrnum_roster_type_id FROM hdrt_roster_type_mst  WHERE hdrnum_area_type_code \=a.hdrnum_area_type_code  AND hdrnum_roster_cat_id \= (SELECT hdrnum_roster_cat_id  FROM hdrt_roster_type_mst   WHERE hdrnum_roster_type_id \= ? AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ) AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )  AND hdrstr_duty_area_code in (SELECT hdrstr_duty_area_code  FROM hdrt_rosterarea_capacity_mst X  WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.GNUM_HOSPITAL_CODE  AND hdrnum_slno \=(SELECT MAX (hdrnum_slno)   FROM hdrt_rosterarea_capacity_mst   WHERE hdrnum_roster_type_id \= X.hdrnum_roster_type_id   AND gnum_hospital_code \= X.gnum_hospital_code   AND hdrstr_duty_area_code \= X.hdrstr_duty_area_code))  AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			        
  
SELECT_ALL_MAPPED_AREA_EMP_REPORT.HDRT_ROSTER_DTL=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code)|| '\#' || NVL ((SELECT c.num_mobile_no || ' ' ||NUM_TEL_NO_RESI FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c WHERE a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid))) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?  AND hdrstr_duty_area_code in (SELECT hdrstr_duty_area_code  FROM hdrt_rosterarea_capacity_mst X  WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.GNUM_HOSPITAL_CODE  AND hdrnum_slno \=(SELECT MAX (hdrnum_slno)   FROM hdrt_rosterarea_capacity_mst   WHERE hdrnum_roster_type_id \= X.hdrnum_roster_type_id   AND gnum_hospital_code \= X.gnum_hospital_code   AND hdrstr_duty_area_code \= X.hdrstr_duty_area_code))  AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			        
			        
			          
  
//////----------------------Queries---for---Datwise----EMPLOYEE---Roster--AND---Report--------------------------//////  

SELECT_DESIGNATION_WISE_DISTINCT_DATEWISE_ROSTER.HDRT_ROSTER_DTL=SELECT DISTINCT TO_CHAR (HDRDT_FROM_DATE,'dd-Mon-yyyy')  || '@' || TO_CHAR (HDRDT_TO_DATE,'dd-Mon-yyyy') || '@' || HDRNUM_ROSTER_ID || '@'   || (SELECT COUNT (distinct HDRNUM_ROSTER_ID)   FROM hdrt_roster_generation_dtl   WHERE hdrnum_roster_id \= a.HDRNUM_ROSTER_ID   AND gnum_isvalid \= a.GNUM_ISVALID   AND gnum_hospital_code \= a.GNUM_HOSPITAL_CODE) as concateDate,TO_CHAR (hdrdt_from_date, 'dd-Mon-yyyy') as startDate,hdrdt_from_date   FROM hdrt_roster_dtl a, pist_emp_registration_dtl b WHERE hdrnum_roster_type_id \=?    AND hdrstr_duty_area_code \= ?   AND hdrnum_area_type_code \= ?   AND a.gnum_isvalid \= ?   AND a.gnum_hospital_code \=?  AND b.gnum_desig_code \= ? AND a.str_emp_no \= b.str_emp_no  AND a.gnum_isvalid \= b.gnum_isvalid       ORDER BY hdrdt_from_date 
	           
            	    
	           
	            	
SELECT_ALL_DISTINCT_DATEWISE_ROSTER.HDRT_ROSTER_DTL=SELECT DISTINCT    TO_CHAR (hdrdt_from_date, 'dd-Mon-yyyy')  || '@'  || TO_CHAR (hdrdt_to_date, 'dd-Mon-yyyy')  || '@' || hdrnum_roster_id  || '@' || nvl((SELECT distinct hdrnum_roster_status  FROM hdrt_roster_generation_dtl  WHERE hdrnum_roster_id \= a.hdrnum_roster_id    AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE   AND hdrnum_roster_status \= 1   AND gnum_isvalid \= a.GNUM_ISVALID),0) AS concatedate, hdrdt_from_date AS startdate     FROM hdrt_roster_dtl a    WHERE hdrnum_roster_type_id \=?   AND hdrstr_duty_area_code \=?    AND hdrnum_area_type_code \=?   AND a.gnum_isvalid \=?  AND a.gnum_hospital_code \=?        ORDER BY startdate
	            	    
 
	            	    
//---QUERY------FOR---FETCHING----THE--ROSTERS---FOR----ALL---THE----MAPPED----EMPLOYEES 

SELECT_ALL_MAPPEED_EMP_ROSTERS_MONTHLY.HDRT_ROSTER_DTL=SELECT hdrnum_roster_type_id AS rosterId,(SELECT hdrstr_roster_type_name  FROM hdrt_roster_type_mst  WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ) AS rosterName, (SELECT hdrnum_roster_cat_id  FROM hdrt_roster_type_mst  WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid) AS rosterCatgId, (SELECT hdrstr_roster_cat_name  FROM hdrt_roster_cat_mst    WHERE gnum_hospital_code \= a.gnum_hospital_code    AND gnum_isvalid \= a.gnum_isvalid  AND hdrnum_roster_cat_id \= (SELECT hdrnum_roster_cat_id   FROM hdrt_roster_type_mst WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid)) as rosterCatgName, hdrnum_area_type_code AS areaTypeCode, (SELECT hdtstr_duty_area_type   FROM hdrt_duty_area_mst   WHERE hdrnum_area_type_code \= a.hdrnum_area_type_code  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid) AS areaTypeName, hdrstr_duty_area_code AS areaCode, (SELECT pkg_duty_roster.areaname (a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code )  FROM DUAL) AS areaName,hdrnum_shift_id AS shiftId, NVL((SELECT hdtstr_shift_desc  FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),(SELECT HDTSTR_SHIFT_DESC FROM HDRT_SHIFT_TYPE_MST WHERE HDRNUM_SHIFT_TYPE\=A.hdrnum_shift_id  AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=A.GNUM_ISVALID)) AS shiftName, NVL((SELECT HDTSTR_SHIFT_SHORTNAME  FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),(SELECT HDTSTR_SHIFT_DESC FROM HDRT_SHIFT_TYPE_MST WHERE HDRNUM_SHIFT_TYPE\=A.hdrnum_shift_id  AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=A.GNUM_ISVALID)) AS shiftShortName, NVL((SELECT HDRNUM_SHIFT_TYPE  FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),a.hdrnum_shift_id) AS shiftType, a.str_emp_no AS empId, EXTRACT (DAY FROM hdrdt_start_datetime) AS startDateTime FROM hdrt_roster_dtl a, pist_emp_registration_dtl b   WHERE EXTRACT (YEAR FROM hdrdt_start_datetime) \= ?    AND EXTRACT (YEAR FROM hdrdt_end_datetime) \= ?     AND EXTRACT (MONTH FROM hdrdt_start_datetime) \= ?   AND EXTRACT (MONTH FROM hdrdt_end_datetime) \= ? AND a.gnum_isvalid \= ?   AND a.gnum_hospital_code \=? AND ( hdrnum_roster_type_id \!\= ?   OR hdrstr_duty_area_code \!\= ? )    
               AND gnum_isvalid IN (1, 2)))  as empName FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b  WHERE a.gnum_isvalid \= ?   AND a.gnum_hospital_code \= ?   AND a.hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE hdrnum_roster_cat_id \= ?    AND gnum_hospital_code \= ?   AND gnum_isvalid \= ?)   AND a.hdrstr_duty_area_code \= ? AND a.hdrnum_area_type_code \= ?   AND TRUNC (hdrdt_start_datetime) \= TRUNC (SYSDATE) AND a.hdrnum_roster_id \= b.hdrnum_roster_id   AND a.gnum_isvalid \= b.gnum_isvalid  AND trunc(hdrdt_start_datetime) >\= trunc(b.hdrdt_start_date) AND trunc(hdrdt_start_datetime) <\= trunc(b.hdrdt_end_date) AND NVL (a.hdrnum_duty_role_id, 'NA') \!\= 'NA'   order by startDateTime
	            	    
	         
//query---for----getting----the---list---of-----areas---in--which---the---employee---is--mapped

SELECT_AREA_EMP_MAPPING.HDRT_DUTY_AREA_EMPLOYEE_MST=SELECT a.STR_EMP_NO as empId,hdrstr_duty_area_code as areaTypeCode, (SELECT pkg_duty_roster.areaname (a.gnum_hospital_code,a.hdrnum_duty_area_id,a.hdrstr_duty_area_code ) as areaCode  FROM DUAL) AS areaCode FROM HDRT_DUTY_AREA_EMPLOYEE_MST a, pist_emp_registration_dtl b  WHERE a.gnum_hospital_code \=?    AND a.gnum_isvalid \= ?   AND a.str_emp_no \= b.str_emp_no    AND a.gnum_hospital_code \= b.gnum_hospital_code   AND a.gnum_isvalid \= b.gnum_isvalid AND b.Gnum_desig_CODE IN (  SELECT num_desig_id   FROM hdrt_roster_designation_mst c   WHERE hdrnum_roster_type_id \=?   AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno)    FROM hdrt_roster_designation_mst   WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t            \t    
	            	    

	            	    
	            	    
//query---for----getting----the---list---of-----Approved--Leave--days--in--which---the---employee---is--mapped	            	    
	            	    
	            	    

SELECT_ALL_MAPPED_EMP_LEAVE.PIST_EMP_LEAVE_DTL=SELECT t.str_emp_no AS empId,EXTRACT (DAY FROM s.dt_leave_frm_date) AS startDateTime,EXTRACT (DAY FROM S.dt_leave_to_date) AS endDateTime FROM pist_leave_req_trn T, pist_leave_req_dtl S WHERE S.gnum_isvalid \=T.gnum_isvalid AND S.gnum_hospital_code \=T.gnum_hospital_code AND S.num_leave_comm_req_no \=T.num_leave_comm_req_no  AND EXTRACT (YEAR FROM s.dt_leave_frm_date) \= ?  AND EXTRACT (YEAR FROM S.dt_leave_to_date) \=?  AND EXTRACT (MONTH FROM  s.dt_leave_frm_date) \= ?  AND EXTRACT (MONTH FROM S.dt_leave_to_date) \=?  AND S.GNUM_ISVALID\=? AND S.GNUM_HOSPITAL_CODE\=? AND t.num_leave_flag\=? AND T.str_emp_no IN ( SELECT DISTINCT a.str_emp_no AS empid   FROM hdrt_duty_area_employee_mst a, pist_emp_registration_dtl b  WHERE a.hdrnum_duty_area_id \= ? AND a.hdrstr_duty_area_code \=?  AND a.gnum_hospital_code \= s.gnum_hospital_code    AND a.gnum_isvalid \=S.gnum_isvalid AND a.str_emp_no \= b.str_emp_no     AND b.Gnum_desig_CODE IN ( SELECT num_desig_id   FROM hdrt_roster_designation_mst c   WHERE hdrnum_roster_type_id \=?  AND gnum_hospital_code \= a.gnum_hospital_code AND hdrnum_slno \=( SELECT MAX (hdrnum_slno)  FROM hdrt_roster_designation_mst   WHERE hdrnum_roster_type_id \=c.hdrnum_roster_type_id AND num_desig_id \= c.num_desig_id AND gnum_hospital_code \=c.gnum_hospital_code))  AND a.gnum_hospital_code \= b.gnum_hospital_code  AND a.gnum_isvalid \= b.gnum_isvalid) 
  // SELECT   str_emp_no AS empId,EXTRACT (DAY FROM dt_ext_leave_frm_date) AS startDateTime,EXTRACT (DAY FROM dt_ext_leave_to_date) AS endDateTime  // FROM pist_emp_leave_ejc_dtl  Y  WHERE EXTRACT (YEAR FROM dt_ext_leave_frm_date) \=?     AND EXTRACT (YEAR FROM dt_ext_leave_to_date) \=? //AND EXTRACT (MONTH FROM dt_ext_leave_frm_date) \=?  AND EXTRACT (MONTH FROM dt_ext_leave_to_date) \=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND str_appr_status \=?   AND str_emp_no IN //( SELECT DISTINCT a.str_emp_no AS empid  FROM hdrt_duty_area_employee_mst a,pist_emp_registration_dtl b   WHERE a.hdrnum_duty_area_id \=? // AND a.hdrstr_duty_area_code \=? AND a.gnum_hospital_code \= Y.gnum_hospital_code    AND a.gnum_isvalid \=Y.gnum_isvalid     AND a.str_emp_no \= b.str_emp_no   AND b.num_desig_id IN //( SELECT num_desig_id  FROM hdrt_roster_designation_mst c  WHERE hdrnum_roster_type_id \=?  AND gnum_hospital_code \=a.gnum_hospital_code  //AND hdrnum_slno \=( SELECT MAX (hdrnum_slno)  FROM hdrt_roster_designation_mst   WHERE hdrnum_roster_type_id \=c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  //AND gnum_hospital_code \=c.gnum_hospital_code))   AND a.gnum_hospital_code \= b.gnum_hospital_code    AND a.gnum_isvalid \= b.gnum_isvalid)   ORDER BY empId,startDateTime, endDateTime 
//////        

////////////////////For---------Roster-------Generation/////////////////////////////////////        
                    	    
	            	    
INSERT.HDRT_ROSTER_GENERATION_DTL=insert into HDRT_ROSTER_GENERATION_DTL(HDRNUM_ROSTER_TYPE_ID, HDRSTR_DUTY_AREA_CODE, HDRNUM_AREA_TYPE_CODE, STR_EMP_NO, GNUM_HOSPITAL_CODE, HDRDT_START_DATE, HDRDT_END_DATE, HDRNUM_ROSTER_STATUS, HDRSTR_REMARKS, HDRSTR_CANCEL_REMARKS, GNUM_ISVALID, GNUM_ENTER_BY, GDT_ENTRY_DATE,HDRNUM_ROSTER_ID, HDRNUM_SLNO) values(?,?,?,?,?,TO_DATE(?,'dd-mon-yyyy'),TO_DATE(?,'dd-mon-yyyy'),?,?,?,?,?,SYSDATE,?,(select nvl(max(HDRNUM_SLNO),0)+1 from HDRT_ROSTER_GENERATION_DTL where HDRNUM_ROSTER_ID\=? ))\t            \t    
	            	    
	            	    
SELECT_CHECK_RANGE.HDRT_ROSTER_GENERATION_DTL= SELECT COUNT (*)   FROM hdrt_roster_generation_dtl WHERE (   (    TRUNC (hdrdt_start_date) >\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  AND TRUNC (hdrdt_start_date) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  )  OR (    TRUNC (hdrdt_end_date) >\= TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   AND TRUNC (hdrdt_end_date) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))    )   OR (    TRUNC (hdrdt_start_date) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  AND TRUNC (hdrdt_end_date) >\= TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   )    OR (    TRUNC (hdrdt_start_date) <\=TRUNC (TO_DATE (?, 'dd-mon-yyyy'))  AND TRUNC (hdrdt_end_date) >\= TRUNC (TO_DATE (?, 'dd-mon-yyyy'))   )     ) AND hdrnum_roster_type_id \=?  AND hdrstr_duty_area_code \=?    AND hdrnum_area_type_code \=? AND hdrnum_roster_status \=?    AND gnum_isvalid \=?    AND gnum_hospital_code \=?
             	            	    
	            	   
	            	    
SELECT_RANGE.HDRT_ROSTER_GENERATION_DTL=SELECT hdrnum_roster_type_id as rosterId, hdrstr_duty_area_code as areaCode,EXTRACT(day from hdrdt_start_date) AS startDate, EXTRACT(DAY FROM hdrdt_end_date) as enddate FROM hdrt_roster_generation_dtl  WHERE hdrnum_roster_type_id \=?    AND hdrstr_duty_area_code \=?    AND hdrnum_area_type_code \= ?   AND gnum_hospital_code \=? AND hdrnum_roster_status \= ?    AND gnum_isvalid \= ?  and EXTRACT(year from hdrdt_start_date)\=?  and EXTRACT(year FROM hdrdt_end_date)\=?   and EXTRACT(month from hdrdt_start_date)\=?  and EXTRACT(month FROM hdrdt_end_date)\=?    order by startdate
	            	
	            	
	            	
	            	    
SELECT_RANGE_ALL_MAPPED_AREAS.HDRT_ROSTER_GENERATION_DTL=SELECT hdrnum_roster_type_id as rosterId, hdrstr_duty_area_code as areaCode,EXTRACT(day from hdrdt_start_date) AS startDate, EXTRACT(DAY FROM hdrdt_end_date) as enddate FROM hdrt_roster_generation_dtl a WHERE hdrnum_roster_type_id \=?    AND hdrstr_duty_area_code IN ( SELECT hdrstr_duty_area_code  FROM hdrt_rosterarea_capacity_mst x   WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id  AND gnum_hospital_code \= a.gnum_hospital_code AND hdrnum_slno \= (SELECT MAX (hdrnum_slno)  FROM hdrt_rosterarea_capacity_mst   WHERE hdrnum_roster_type_id \= x.hdrnum_roster_type_id   AND gnum_hospital_code \= x.gnum_hospital_code AND hdrstr_duty_area_code \= x.hdrstr_duty_area_code))   AND hdrnum_area_type_code \= ?   AND gnum_hospital_code \=? AND hdrnum_roster_status \= ?    AND gnum_isvalid \= ?  and EXTRACT(year from hdrdt_start_date)\=?  and EXTRACT(year FROM hdrdt_end_date)\=?   and EXTRACT(month from hdrdt_start_date)\=?  and EXTRACT(month FROM hdrdt_end_date)\=?
	            	    	       
	       
	       
UPDATE_DROP_ROSTER.HDRT_ROSTER_GENERATION_DTL=UPDATE hdrt_roster_generation_dtl    SET hdrnum_roster_status \= ?,gnum_isvalid \= ? WHERE hdrnum_roster_type_id \=?    AND hdrstr_duty_area_code \=?    AND hdrnum_area_type_code \= ?   AND gnum_hospital_code \=? AND hdrnum_roster_status \= ?    AND gnum_isvalid \= ?  and EXTRACT(year from hdrdt_start_date)\=?  and EXTRACT(year FROM hdrdt_end_date)\=?   and EXTRACT(month from hdrdt_start_date)\=?  and EXTRACT(month FROM hdrdt_end_date)\=?
	            	    
	       
	            	    

/////////FOR///////PRINTING//////REPORT///IN///SEPERATE////FOR///HOLIDAY/GAZETTED


SELECT_SEPERATE_ALL_MAPPED_AREA_EMP_REPORT.HDRT_ROSTER_DTL=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) || '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c WHERE a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid))) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id\=?   AND hdrstr_duty_area_code in (SELECT hdrstr_duty_area_code  FROM hdrt_rosterarea_capacity_mst X  WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.GNUM_HOSPITAL_CODE  AND hdrnum_slno \=(SELECT MAX (hdrnum_slno)   FROM hdrt_rosterarea_capacity_mst   WHERE hdrnum_roster_type_id \= X.hdrnum_roster_type_id   AND gnum_hospital_code \= X.gnum_hospital_code   AND hdrstr_duty_area_code \= X.hdrstr_duty_area_code))  AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			        
  	

SELECT_SEPERATE_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL_OLD=SELECT   HDRNUM_ROSTER_TYPE_ID as rosterId,a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id\=?      AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			      
			      	
	
SELECT_RANGE_ALL_ROSTERS_ROSTER_CATEG_AREAWISE.HDRT_ROSTER_GENERATION_DTL=SELECT hdrnum_roster_type_id AS rosterid, hdrstr_duty_area_code AS areacode,EXTRACT (DAY FROM hdrdt_start_date) AS startdate,EXTRACT (DAY FROM hdrdt_end_date) AS enddate FROM hdrt_roster_generation_dtl a  WHERE hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE gnum_hospital_code \= a.gnum_hospital_code   AND hdrnum_roster_cat_id \= ?  AND hdrnum_area_type_code \= a.hdrnum_area_type_code AND gnum_isvalid \= a.gnum_isvalid)    AND hdrstr_duty_area_code \=?   AND hdrnum_area_type_code \= ?    AND gnum_hospital_code \=?    AND hdrnum_roster_status \=?    AND gnum_isvalid \=?   AND EXTRACT (YEAR FROM hdrdt_start_date) \=?  AND EXTRACT (YEAR FROM hdrdt_end_date) \=?  AND EXTRACT (MONTH FROM hdrdt_start_date) \=?    AND EXTRACT (MONTH FROM hdrdt_end_date) \=? 



SELECT_ALL_ROSTERS_CATG_AREAWISE_REPORT.HDRT_ROSTER_DTL_OLD=SELECT   HDRNUM_ROSTER_TYPE_ID as rosterId,a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst   WHERE gnum_hospital_code \= a.gnum_hospital_code    AND hdrnum_roster_cat_id \=?    AND hdrnum_area_type_code \= a.hdrnum_area_type_code    AND gnum_isvalid \= a.gnum_isvalid )      AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code))



SELECT_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name) || '(' || (SELECT gstr_designation ||')'  FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN ( SELECT num_desig_id    FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= 1)  AND gnum_slno \=  (SELECT MAX (gnum_slno)  FROM gblt_designation_mst x WHERE num_desig_id \= x.num_desig_id   AND gnum_hospital_code \= x.gnum_hospital_code   AND gdt_effective_frm <\=TRUNC (SYSDATE)   AND NVL (gdt_effective_to,SYSDATE + 1 ) >\= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)) )\tFROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN (SELECT hdrnum_roster_type_id FROM hdrt_roster_type_mst  WHERE hdrnum_area_type_code \=a.hdrnum_area_type_code  AND hdrnum_roster_cat_id \= (SELECT hdrnum_roster_cat_id  FROM hdrt_roster_type_mst   WHERE hdrnum_roster_type_id \= ? AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ) AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= ( SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t 
	           
	           
SELECT_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL_NEW=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name) || '(' || (SELECT gstr_desig_name ||')'  FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid IN (1, 2)  AND gnum_desig_code IN ( SELECT gnum_desig_code    FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= 1)  )\tFROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) || '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c HAVING a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid)GROUP BY gnum_enter_by,c.hdrnum_roster_id,c.gnum_hospital_code,c.gnum_isvalid,c.hdrnum_slno )) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT gnum_desig_code FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= ( SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t
			    
			    
	           
SELECT_ALL_ROSTERS_CATG_AREAWISE_REPORT.HDRT_ROSTER_DTL=SELECT   HDRNUM_ROSTER_TYPE_ID as rosterId,a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name) || ' ('  || (SELECT gstr_designation || ')' FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid IN (1, 2)   AND gnum_desig_code IN ( SELECT gnum_desig_code   FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno)   FROM gblt_designation_mst x   WHERE num_desig_id \= x.num_desig_id  AND gnum_hospital_code \=x.gnum_hospital_code   AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)   AND gnum_isvalid IN (1, 2)))  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) || '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id IN( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst   WHERE gnum_hospital_code \= a.gnum_hospital_code    AND hdrnum_roster_cat_id \=?    AND hdrnum_area_type_code \= a.hdrnum_area_type_code    AND gnum_isvalid \= a.gnum_isvalid )      AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT gnum_desig_code FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= ( SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code))
	           
	           //---Changes in database as per G5--//
	           
	      SELECT_SEPERATE_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL=SELECT   HDRNUM_ROSTER_TYPE_ID as rosterId,a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  || ' ('  || (SELECT GSTR_DESIG_ST_NAME || ')' FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code    AND gnum_isvalid IN (1, 2)   AND gnum_desig_code IN ( SELECT gnum_desig_code   FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= 1) )   FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code)|| '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c HAVING a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid)GROUP BY gnum_enter_by,c.hdrnum_roster_id,c.gnum_hospital_code,c.gnum_isvalid,c.hdrnum_slno )) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id\=?      AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) 
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
	           
SELECT_SEPERATE_ALL_MAPPED_EMP_REPORT.HDRT_ROSTER_DTL_OLD_23-09-2015=SELECT   HDRNUM_ROSTER_TYPE_ID as rosterId,a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  || ' ('  || (SELECT gstr_designation || ')' FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code   AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE) AND gnum_isvalid IN (1, 2)   AND num_desig_id IN ( SELECT num_desig_id   FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno)   FROM gblt_designation_mst x   WHERE num_desig_id \= x.num_desig_id  AND gnum_hospital_code \=x.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)   AND gnum_isvalid IN (1, 2)))   FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code)|| '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c HAVING a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid)GROUP BY gnum_enter_by,c.hdrnum_roster_id,c.gnum_hospital_code,c.gnum_isvalid,c.hdrnum_slno )) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id\=?      AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t         \t\t\t      
			      	       
#			      	       //*******************Changes by Chetan Sharma as per new database***********************//
#AND hdrnum_area_type_code =?
SELECT_ALL_MAPPED_EMP_ROSTER.HDRT_ROSTER_DTL=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id    AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id   AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id   AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR(TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT  INITCAP(str_emp_full_name) || '(' || (SELECT gstr_desig_name ||')'  FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid IN (1, 2)  AND gnum_desig_code IN ( SELECT gnum_desig_code    FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= 1)   AND gnum_isvalid IN (1, 2)) \tFROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName, hdrnum_roster_id AS generatedRosterId, hdrnum_slno AS slNo FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \=?   AND hdrstr_duty_area_code \= ? AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.gnum_desig_code IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= ( SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code)) \t 
	           			      	       
  
  
SELECT_DESG_MAPPED_EMP_ROSTER.HDRT_ROSTER_DTL=SELECT   a.str_emp_no empId, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, NVL ((SELECT HDRSTR_START_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftStartTime,  NVL ((SELECT HDRSTR_END_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftEndTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime , SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName , hdrnum_roster_id AS generatedRosterId, hdrnum_slno AS slNo FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t and b.NUM_DESIG_ID\=?  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=?  AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID

			           		      	            	            	    
INSERT.HDRT_DUTY_ROLE_DTL=	insert into HDRT_DUTY_ROLE_DTL ( HDRNUM_ROSTER_ID, HDRSTR_DUTY_AREA_CODE, STR_EMP_NO, HDRNUM_SHIFT_ID, HDRNUM_DUTY_ROLE_ID, HDRSTR_DUTY_REMARKS, HDRSTR_CANCEL_REMARKS, GNUM_ISVALID, GNUM_ENTER_BY, \
							GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, HDRDT_FROM_DATE, HDRDT_TO_DATE) values(?,?,?,?,?,?,?,?,?,sysdate,?,to_date(?,'dd-mon-yyyy'),to_date(?,'dd-mon-yyyy'))
			           		      	 
			   
/////-------------------------For----inserting----into---HDRT_ROSTERWISE_RELIEVERS_DTL---------------------------			   
			           		      	            	            	    
INSERT.HDRT_ROSTERWISE_RELIEVERS_DTL=insert into HDRT_ROSTERWISE_RELIEVERS_DTL(HDRNUM_ROSTER_TYPE_ID, HDRNUM_ROSTER_ID, STR_EMP_NO, HDRNUM_RELIEVER_TYPE, HDRNUM_ENTRY_MODE, HDRDT_FROM_DATE, HDRDT_TO_DATE, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,?,?,?,TO_DATE(?,'dd-mon-yyyy'),TO_DATE(?,'dd-mon-yyyy'),?,?,?,sysdate) 			           		      	            	            	    
			           		      	            	            	    
			           		      	            	            	    
SELECT.HDRT_ROSTERWISE_RELIEVERS_DTL=SELECT HDRNUM_ROSTER_TYPE_ID as rosterId, HDRNUM_ROSTER_ID as generatedRosterId, STR_EMP_NO as empId,HDRNUM_RELIEVER_TYPE as reliverType,HDRNUM_ENTRY_MODE as entryMode, EXTRACT (DAY FROM hdrdt_from_date) AS fromDate, EXTRACT(DAY  FROM hdrdt_to_date) as toDate, GNUM_HOSPITAL_CODE as hospitalCode, GNUM_ISVALID as isValid,GNUM_SEAT_ID as enterBySeatId, GDT_ENTRY_DATE as entryDate 	 FROM HDRT_ROSTERWISE_RELIEVERS_DTL WHERE HDRNUM_ROSTER_ID=? AND GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? 


UPDATE.HDRT_ROSTERWISE_RELIEVERS_DTL=UPDATE HDRT_ROSTERWISE_RELIEVERS_DTL SET  GNUM_ISVALID=?  WHERE  HDRNUM_ROSTER_ID=? and GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID=?
 
 

SELECT_DUPLICATE_RELIVER_CHECK.HDRT_ROSTERWISE_RELIEVERS_DTL=SELECT distinct str_emp_no AS empId, (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) AS empName   FROM hdrt_rosterwise_relievers_dtl a  WHERE hdrnum_roster_id \!\=?    AND gnum_isvalid \=?    AND gnum_hospital_code \=?     AND str_emp_no \= ? AND (     TO_DATE (?, 'dd-mon-yyyy') BETWEEN hdrdt_from_date    AND hdrdt_to_date        OR   TO_DATE (?, 'dd-mon-yyyy') BETWEEN hdrdt_from_date    AND hdrdt_to_date OR   hdrdt_from_date BETWEEN TO_DATE (?,'dd-mon-yyyy' )    AND TO_DATE (?,'dd-mon-yyyy' ) OR   hdrdt_to_date BETWEEN TO_DATE (?, 'dd-mon-yyyy')      AND TO_DATE (?, 'dd-mon-yyyy')  ) 
			       


SELECT_RELIVERS_LIST.HDRT_ROSTERWISE_RELIEVERS_DTL=SELECT DISTINCT a.hdrnum_roster_id AS generatedRosterId,a.hdrnum_roster_type_id AS rosterId, a.str_emp_no AS empId,b.hdrnum_shift_id AS shiftId,hdrstr_duty_area_code AS areaCode, (SELECT pkg_duty_roster.areaname(b.gnum_hospital_code,b.hdrnum_area_type_code,b.hdrstr_duty_area_code )   FROM DUAL) AS areaName,hdrnum_area_type_code AS areaTypeCode,to_char(b.hdrdt_start_datetime,'dd-mon-yyyy') AS selectedDate, (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl    WHERE str_emp_no \= a.str_emp_no   AND gnum_isvalid \= a.gnum_isvalid     AND gnum_hospital_code \= a.gnum_hospital_code) AS empName FROM hdrt_rosterwise_relievers_dtl a, hdrt_roster_dtl b  WHERE a.hdrnum_roster_type_id \=?   AND a.gnum_isvalid \= ?   AND a.gnum_hospital_code \=?   AND b.hdrnum_shift_id like  ?  AND a.hdrnum_roster_id \= b.hdrnum_roster_id    AND a.gnum_hospital_code \= b.gnum_hospital_code  AND a.gnum_isvalid \= b.gnum_isvalid   AND a.str_emp_no \= b.str_emp_no AND TO_DATE (?, 'dd-mon-yyyy') BETWEEN a.hdrdt_from_date   AND a.hdrdt_to_date   AND TRUNC (b.hdrdt_start_datetime) \=TO_DATE (?, 'dd-mon-yyyy')  AND TRUNC (b.hdrdt_end_datetime) \=TO_DATE (?, 'dd-mon-yyyy')   ORDER BY empName\t\t
                
                
UPDATE_DUTY_DONE.HDRT_ROSTER_DTL.FOR_RELIVER_ASSIGNMENT=UPDATE hdrt_roster_dtl  SET hdrnum_duty_done = ?  WHERE hdrnum_roster_id = ?    AND str_emp_no = ?    AND TRUNC (hdrdt_start_datetime) = TO_DATE (?, 'dd-mm-yyyy')    AND TRUNC (hdrdt_end_datetime) = TO_DATE (?, 'dd-mm-yyyy')    AND gnum_isvalid = ?     and GNUM_HOSPITAL_CODE=?



INSERT_AS_RELIVER.HDRT_ROSTER_DTL.FOR_RELIVER_ASSIGNMENT=INSERT INTO hdrt_roster_dtl a(hdrnum_roster_id,hdrnum_slno,hdrnum_roster_type_id, hdrstr_duty_area_code,hdrnum_area_type_code, str_emp_no, hdrnum_shift_id,hdrdt_start_datetime,hdrdt_end_datetime, gnum_isvalid, hdrnum_duty_type,gnum_enter_by, gdt_entry_date, gnum_hospital_code  ) VALUES ( (SELECT DISTINCT hdrnum_roster_id    FROM hdrt_roster_dtl     WHERE hdrnum_roster_type_id \=?     AND hdrstr_duty_area_code \=?    AND hdrnum_area_type_code \=?     AND EXTRACT (YEAR FROM hdrdt_start_datetime) \=EXTRACT (YEAR FROM TO_DATE (?,'dd-mm-yyyy') )  AND EXTRACT (YEAR FROM hdrdt_end_datetime) \=EXTRACT (YEAR FROM TO_DATE (?,'dd-mm-yyyy') ) AND EXTRACT (MONTH FROM hdrdt_start_datetime) \= EXTRACT (MONTH FROM TO_DATE (?,'dd-mm-yyyy')  )  AND EXTRACT (MONTH FROM hdrdt_end_datetime) \=EXTRACT (MONTH FROM TO_DATE (?,'dd-mm-yyyy') )  AND gnum_isvalid \= ?), (SELECT MAX (hdrnum_slno)+1   FROM hdrt_roster_dtl   WHERE hdrnum_roster_id \=(SELECT DISTINCT hdrnum_roster_id   FROM hdrt_roster_dtl   WHERE hdrnum_roster_type_id \=?   AND hdrstr_duty_area_code \= ?    AND hdrnum_area_type_code \=?   AND EXTRACT(YEAR FROM hdrdt_start_datetime) \=EXTRACT(YEAR FROM TO_DATE(?,'dd-mm-yyyy'))  AND EXTRACT (YEAR FROM hdrdt_end_datetime) \=EXTRACT(YEAR FROM TO_DATE(?,'dd-mm-yyyy') )   AND EXTRACT(MONTH FROM hdrdt_start_datetime) \=EXTRACT(MONTH FROM TO_DATE(?,'dd-mm-yyyy') )  AND EXTRACT  (MONTH FROM hdrdt_end_datetime) \=EXTRACT(MONTH FROM TO_DATE(?,'dd-mm-yyyy') )    AND gnum_isvalid \= ?)),?, ?,?, ?, ?,TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss'),TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss'), ?, ?,?, SYSDATE,?)
                

                	       
UPDATE_DUTY_ROLE.HDRT_ROSTER_DTL=update hdrt_roster_dtl set  HDRNUM_DUTY_ROLE_ID\=?  where HDRNUM_ROSTER_ID\=? and STR_EMP_NO\=? and HDRNUM_SHIFT_ID\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and trunc(HDRDT_START_DATETIME) between to_date(?,'dd-mon-yyyy') and to_date(?,'dd-mon-yyyy') and trunc(HDRDT_END_DATETIME) between to_date(?,'dd-mon-yyyy') and to_date(?,'dd-mon-yyyy')\t\t\t       
			       

  
		//////////////////---------------Date---wise---emp----roster-----------------//////////
             	       
SELECT_DATE_WISE_EMP_ROSTER_MODIFY.HDRT_ROSTER_DTL=SELECT \thdrnum_roster_id as generatedRosterId, hdrnum_roster_type_id as rosterId, hdrstr_duty_area_code as areaCode,hdrnum_area_type_code as areaTypeCode, str_emp_no as empId, hdrnum_shift_id as shiftId,hdrdt_start_datetime as startDateTime, hdrdt_end_datetime as endDateTime, TO_CHAR (hdrdt_from_date, 'dd-Mon-yyyy') AS fromDate,TO_CHAR (hdrdt_to_date, 'dd-Mon-yyyy') AS toDate, nvl((SELECT    hdtstr_shift_shortname || '@' || hdrstr_start_time  || '@'  || hdrstr_end_time  || '@' || hdtstr_shift_desc  || '@'  || hdrnum_shift_type       FROM hdrt_shift_mst     WHERE hdrnum_shift_id \= a.hdrnum_shift_id    AND gnum_hospital_code \= a.gnum_hospital_code    AND gnum_isvalid \= a.gnum_isvalid  AND hdrnum_slno \=(SELECT MAX (hdrnum_slno)   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid)),(SELECT    HDTSTR_SHIFT_DESC  || '@' ||HDRNUM_SHIFT_TYPE || '@' || HDRNUM_SHIFT_TYPE || '@' || HDTSTR_SHIFT_DESC  || '@' || HDRNUM_SHIFT_TYPE    FROM HDRT_SHIFT_TYPE_MST  WHERE HDRNUM_SHIFT_TYPE\= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid  )) AS shiftdesc, (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl    WHERE str_emp_no \= a.str_emp_no   AND gnum_isvalid \= a.gnum_isvalid     AND gnum_hospital_code \= a.gnum_hospital_code) AS empName FROM hdrt_roster_dtl a WHERE hdrnum_roster_id \=?    AND gnum_isvalid \=?    AND gnum_hospital_code \=?\t\t\t       

 

SELECT_DUPLICATE_CHECK_DATE_WISE_EMP_ROSTER.HDRT_ROSTER_DTL=SELECT COUNT (*)  FROM hdrt_roster_dtl  WHERE hdrnum_roster_id \!\= ?   AND gnum_isvalid \= ?   AND gnum_hospital_code \=?   AND (  \t   TO_DATE (?, 'dd-mm-yyyy') BETWEEN hdrdt_from_date   AND hdrdt_to_date  OR TO_DATE (?, 'dd-mm-yyyy') BETWEEN hdrdt_from_date  AND hdrdt_to_date    OR hdrdt_from_date BETWEEN TO_DATE (?, 'dd-mm-yyyy')  AND TO_DATE (?, 'dd-mm-yyyy') OR hdrdt_to_date BETWEEN TO_DATE (?, 'dd-mm-yyyy')   AND TO_DATE (?, 'dd-mm-yyyy')) 
 

UPDATE_DATE_WISE_EMP_ROSTER.HDRT_ROSTER_DTL=UPDATE hdrt_roster_dtl   SET gnum_isvalid =?  WHERE gnum_isvalid =? AND hdrnum_roster_id =? and gnum_hospital_code=?



SELECT_MONTHLY_EMP_ROSTER_REPORT_DATE_WISE.HDRT_ROSTER_DTL=SELECT   TO_CHAR (a.hdrdt_start_datetime, 'dd-mm-yyyy@day') AS startdatetime,a.hdrnum_shift_id AS shiftid, a.str_emp_no AS empid,a.hdrnum_roster_id AS rostergenratedid,a.hdrstr_duty_area_code AS areacode, (SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaname, NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid)) AS shiftshortname, NVL ((SELECT hdrnum_shift_type   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),(SELECT hdrnum_shift_type   FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) ) AS shifttype, NVL ((SELECT hdtstr_shift_desc   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),(SELECT hdtstr_shift_desc   FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) ) AS shiftDesc, NVL ((SELECT hdrstr_start_time   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),0 ) AS shiftStartTime, NVL ((SELECT hdrstr_end_time   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid),0 ) AS shiftEndTime, (SELECT    INITCAP(str_emp_full_name) || '(' || (SELECT gstr_designation || ')'  FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN (SELECT num_desig_id   FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= 1)   AND gnum_slno \=(SELECT MAX (gnum_slno)  FROM gblt_designation_mst x   WHERE num_desig_id \= x.num_desig_id   AND gnum_hospital_code \=  x.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)))  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_isvalid \= a.gnum_isvalid  AND gnum_hospital_code \= a.gnum_hospital_code) AS empname FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b  WHERE a.hdrnum_roster_type_id \=?   AND a.hdrstr_duty_area_code \=?   AND a.hdrnum_area_type_code \=?  AND EXTRACT (YEAR FROM hdrdt_start_datetime) \=?  AND EXTRACT (YEAR FROM hdrdt_end_datetime) \=?  AND EXTRACT (MONTH FROM hdrdt_start_datetime) \=?     AND EXTRACT (MONTH FROM hdrdt_end_datetime) \=?  AND TRUNC (a.hdrdt_start_datetime) BETWEEN hdrdt_start_date   AND hdrdt_end_date   AND TRUNC (a.hdrdt_end_datetime) BETWEEN hdrdt_start_date AND hdrdt_end_date   AND  TRUNC (a.hdrdt_start_datetime) BETWEEN TO_DATE (?,'dd-mm-yyyy') AND TO_DATE (?,'dd-mm-yyyy')  AND TRUNC (a.hdrdt_end_datetime) BETWEEN TO_DATE (?,'dd-mm-yyyy')  AND TO_DATE (?,'dd-mm-yyyy') AND a.gnum_hospital_code \=?  AND a.gnum_isvalid \=?   AND a.gnum_isvalid \= b.gnum_isvalid  AND a.hdrnum_roster_id \= b.hdrnum_roster_id AND a.gnum_hospital_code \= b.gnum_hospital_code   ORDER BY startdatetime, shiftid, empid   
 
 
																																							 																		  																																																											    
																							
//////////////////////////////For//////////////////////Role///////////////////Report///////////////////////////
 
 
 SELECT.ROSTER_DETAIL.HDRT_ROSTER_DTL=SELECT a.str_emp_no AS empid, a.hdrnum_shift_id AS shiftid,a.hdrnum_duty_role_id AS roleid,(SELECT hdtstr_shift_desc  FROM hdrt_shift_mst c   WHERE c.hdrnum_shift_id \= a.hdrnum_shift_id     AND c.gnum_hospital_code \= a.gnum_hospital_code    AND c.gnum_isvalid \= a.gnum_isvalid) AS shiftdesc, TO_CHAR (hdrdt_start_datetime, 'hh24\:mm') AS startDateTime,TO_CHAR (hdrdt_end_datetime, 'hh24\:mm') AS endDateTime, PKG_BLOODBANK_MST.emp_name_empidwise(a.GNUM_HOSPITAL_CODE,a.str_emp_no) ||' ('  || (SELECT gstr_desig_name || ')'   FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid IN (1, 2)  AND gnum_desig_code IN  ( SELECT gnum_desig_code  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1)) as empName FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b  WHERE a.gnum_isvalid \= ?   AND a.gnum_hospital_code \= ?   AND a.hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE hdrnum_roster_cat_id \= ?    AND gnum_hospital_code \= ?   AND gnum_isvalid \= ?)   AND a.hdrstr_duty_area_code \= ? AND a.hdrnum_area_type_code \= ?   AND TRUNC (hdrdt_start_datetime) \= TRUNC (SYSDATE) AND a.hdrnum_roster_id \= b.hdrnum_roster_id   AND a.gnum_isvalid \= b.gnum_isvalid  AND trunc(hdrdt_start_datetime) >\= trunc(b.hdrdt_start_date) AND trunc(hdrdt_start_datetime) <\= trunc(b.hdrdt_end_date) AND NVL (a.hdrnum_duty_role_id, 'NA') \!\= 'NA'   order by startDateTime
 
 
 

 
 
 
 
 
 
 
 
SELECT.ROSTER_DETAIL.HDRT_ROSTER_DTL_older = SELECT a.str_emp_no AS empid, a.hdrnum_shift_id AS shiftid,a.hdrnum_duty_role_id AS roleid,(SELECT hdtstr_shift_desc  FROM hdrt_shift_mst c   WHERE c.hdrnum_shift_id \= a.hdrnum_shift_id     AND c.gnum_hospital_code \= a.gnum_hospital_code    AND c.gnum_isvalid \= a.gnum_isvalid) AS shiftdesc, TO_CHAR (hdrdt_start_datetime, 'hh24\:mm') AS startDateTime,TO_CHAR (hdrdt_end_datetime, 'hh24\:mm') AS endDateTime, PKG_BLOODBANK_MST.emp_name_empidwise(a.GNUM_HOSPITAL_CODE,a.str_emp_no) ||' ('  || (SELECT gstr_designation || ')'   FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE)     AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN  ( SELECT num_desig_id  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno)  FROM gblt_designation_mst x    WHERE num_desig_id \= x.num_desig_id  AND gnum_hospital_code \= x.gnum_hospital_code AND gnum_isvalid IN (1, 2)))  as empName FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b  WHERE a.gnum_isvalid \= ?   AND a.gnum_hospital_code \= ?   AND a.hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE hdrnum_roster_cat_id \= ?    AND gnum_hospital_code \= ?   AND gnum_isvalid \= ?)   AND a.hdrstr_duty_area_code \= ? AND a.hdrnum_area_type_code \= ?   AND TRUNC (hdrdt_start_datetime) \= TRUNC (SYSDATE) AND a.hdrnum_roster_id \= b.hdrnum_roster_id   AND a.gnum_isvalid \= b.gnum_isvalid  AND trunc(hdrdt_start_datetime) >\= trunc(b.hdrdt_start_date) AND trunc(hdrdt_start_datetime) <\= trunc(b.hdrdt_end_date) AND NVL (a.hdrnum_duty_role_id, 'NA') \!\= 'NA'   order by startDateTime


SELECT.ROSTER_DETAIL.HDRT_ROSTER_DTL_oldest = SELECT a.str_emp_no AS empid, a.hdrnum_shift_id AS shiftid,a.hdrnum_duty_role_id AS roleid,(SELECT hdtstr_shift_desc  FROM hdrt_shift_mst c   WHERE c.hdrnum_shift_id \= a.hdrnum_shift_id     AND c.gnum_hospital_code \= a.gnum_hospital_code    AND c.gnum_isvalid \= a.gnum_isvalid) AS shiftdesc, TO_CHAR (hdrdt_start_datetime, 'hh24\:mm') AS startDateTime,TO_CHAR (hdrdt_end_datetime, 'hh24\:mm') AS endDateTime, PKG_BLOODBANK_MST.emp_name_empidwise(a.GNUM_HOSPITAL_CODE,a.str_emp_no) ||' ('  || (SELECT gstr_designation || ')'   FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE)     AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN  ( SELECT num_desig_id  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno)  FROM gblt_designation_mst x    WHERE num_desig_id \= x.num_desig_id  AND gnum_hospital_code \= x.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (gdt_effective_to,SYSDATE + 1  ) >\= TRUNC (SYSDATE) 


////////////////////////////////////FOR////EXCHANGE////////////////QUERIES/////////////////////////////

 
UPDATE_EXCHANGE.HDRT_ROSTER_DTL=UPDATE hdrt_roster_dtl  SET hdrnum_duty_done = ?, gnum_isvalid=0  WHERE hdrnum_roster_id = ?  AND str_emp_no =?   AND TRUNC (hdrdt_start_datetime) = TO_DATE (?, 'dd-mm-yyyy')    AND TRUNC (hdrdt_end_datetime) = TO_DATE (?, 'dd-mm-yyyy')    AND gnum_isvalid = ?    AND gnum_hospital_code =?  




SELECT_DUTIES_OF_EMP_FOR_EXCHANGE.HDRT_ROSTER_DTL=SELECT DISTINCT a.hdrnum_roster_id AS generatedRosterId,EXTRACT (DAY FROM hdrdt_start_datetime) AS startDateTime,to_char(HDRDT_END_DATETIME,'dd-mm-yyyy') AS endDateTime,a.hdrstr_duty_area_code AS areaCode,a.hdrnum_area_type_code AS areaTypeCode,hdrnum_shift_id AS shiftId, NVL ((SELECT HDTSTR_SHIFT_DESC   FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid), (SELECT hdtstr_shift_desc   FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid) ) AS shiftName, (SELECT  pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code  )  FROM DUAL) AS areaName , (SELECT  HDRNUM_SHIFT_TYPE  FROM hdrt_shift_type_mst   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid  AND hdrnum_shift_type \=(SELECT hdrnum_shift_type  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid)) as shiftType , NVL ((SELECT HDRSTR_START_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftStartTime,  NVL ((SELECT HDRSTR_END_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftEndTime ,a.HDRNUM_ROSTER_TYPE_ID AS rosterId ,HDRNUM_DUTY_TYPE AS dutyType\t FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b    WHERE a.hdrnum_roster_id \= b.hdrnum_roster_id      AND a.gnum_hospital_code \= b.gnum_hospital_code   AND a.gnum_isvalid \= b.gnum_isvalid    AND a.hdrdt_start_datetime BETWEEN b.hdrdt_start_date   AND b.hdrdt_end_date AND a.hdrdt_end_datetime BETWEEN b.hdrdt_start_date  AND b.hdrdt_end_date  AND trunc(a.hdrdt_start_datetime) >\=TRUNC(SYSDATE)  AND trunc(a.hdrdt_end_datetime) >\=TRUNC(SYSDATE) \t\t AND EXTRACT (YEAR FROM hdrdt_start_datetime) \= ?  AND EXTRACT (YEAR FROM hdrdt_end_datetime) \= ?   AND EXTRACT (MONTH FROM hdrdt_start_datetime) \= ?   AND EXTRACT (MONTH FROM hdrdt_end_datetime) \= ? AND a.str_emp_no \= ?  AND a.gnum_hospital_code \= ?  AND a.gnum_isvalid \=? AND NVL (hdrnum_duty_done, -1) \= -1  AND a.hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE gnum_hospital_code \= a.gnum_hospital_code   AND hdrnum_roster_cat_id \=?   AND gnum_isvalid \= a.gnum_isvalid)     ORDER BY startDateTime, shiftType 
    


SELECT_DUTIES_OF_EMP_FOR_CHANGE.HDRT_ROSTER_DTL=SELECT DISTINCT a.hdrnum_roster_id AS generatedRosterId,EXTRACT (DAY FROM hdrdt_start_datetime) AS startDateTime,to_char(HDRDT_END_DATETIME,'dd-mm-yyyy') AS endDateTime,a.hdrstr_duty_area_code AS areaCode,a.hdrnum_area_type_code AS areaTypeCode,hdrnum_shift_id AS shiftId, NVL ((SELECT HDTSTR_SHIFT_DESC   FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid), (SELECT hdtstr_shift_desc   FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid) ) AS shiftName, (SELECT  pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code  )  FROM DUAL) AS areaName , (SELECT  HDRNUM_SHIFT_TYPE  FROM hdrt_shift_type_mst   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid  AND hdrnum_shift_type \=(SELECT hdrnum_shift_type  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid)) as shiftType , NVL ((SELECT HDRSTR_START_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftStartTime,  NVL ((SELECT HDRSTR_END_TIME   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),'0') as shiftEndTime ,a.HDRNUM_ROSTER_TYPE_ID AS rosterId  FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b    WHERE a.hdrnum_roster_id \= b.hdrnum_roster_id      AND a.gnum_hospital_code \= b.gnum_hospital_code   AND a.gnum_isvalid \= b.gnum_isvalid    AND a.hdrdt_start_datetime BETWEEN b.hdrdt_start_date   AND b.hdrdt_end_date AND a.hdrdt_end_datetime BETWEEN b.hdrdt_start_date  AND b.hdrdt_end_date  AND trunc(a.hdrdt_start_datetime) >\=TRUNC(SYSDATE)  AND trunc(a.hdrdt_end_datetime) >\=TRUNC(SYSDATE) \t\t AND EXTRACT (YEAR FROM hdrdt_start_datetime) \= ?  AND EXTRACT (YEAR FROM hdrdt_end_datetime) \= ?   AND EXTRACT (MONTH FROM hdrdt_start_datetime) \= ?   AND EXTRACT (MONTH FROM hdrdt_end_datetime) \= ?  AND EXTRACT (DAY FROM hdrdt_start_datetime) \= ?   AND EXTRACT (DAY FROM hdrdt_end_datetime) \= ?      AND a.str_emp_no \= ?  AND a.gnum_hospital_code \= ?  AND a.gnum_isvalid \=? AND NVL (hdrnum_duty_done, -1) \= -1  AND a.hdrnum_roster_type_id IN ( SELECT hdrnum_roster_type_id  FROM hdrt_roster_type_mst  WHERE gnum_hospital_code \= a.gnum_hospital_code   AND hdrnum_roster_cat_id \=?   AND gnum_isvalid \= a.gnum_isvalid)     ORDER BY startDateTime, shiftType 
    
              
                            
              
INSERT_EXCHANGE.HDRT_ROSTER_EXCHANGE_DTL=insert into HDRT_ROSTER_EXCHANGE_DTL(HDRDT_REQ_DATE, GNUM_HOSPITAL_CODE, HDRNUM_SLNO, HDRSTR_EXCHANGE_FOR, HDRNUM_REQ_STATUS, HDRNUM_SHIFT_ID, HDRNUM_EXCHANGE_TYPE, HDRDT_START_DATETIME, HDRDT_END_DATETIME, HDRSTR_EXCHNAGE_BY, HDRNUM_EXBY_ROSTER_ID, HDRNUM_ROSTER_ID, HDRSTR_REASON, HDRNUM_EXBY_SHIFT_ID, HDRDT_EXBY_START_DATETIME,HDRDT_EXBY_END_DATETIME, HDRSTR_CANCEL_REMARKS, GNUM_ISVALID, GNUM_ENTER_BY, GDT_ENTRY_DATE, GNUM_VERIFY_BY, GDT_VERIFY_DATE) values(trunc(SYSDATE),?,(SELECT NVL (MAX (hdrnum_slno), 0) + 1   FROM hdrt_roster_exchange_dtl   WHERE hdrdt_req_date \= trunc(SYSDATE)    AND gnum_hospital_code \= ? ),?,?,?,?,to_date(?,'dd-mm-yyyy hh24\:mi\:ss'),to_date(?,'dd-mm-yyyy hh24\:mi\:ss'),?,?,?,?,?,to_date(?,'dd-mm-yyyy hh24\:mi\:ss'),to_date(?,'dd-mm-yyyy hh24\:mi\:ss'),?,?,?,SYSDATE,?,SYSDATE) 
              
              
////////////////////////////////////FOR////Roster////Role////////////Assignment/////////////////////////////


UPDATE_IS_VALID.HDRT_DUTY_ROLE_DTL=UPDATE hdrt_duty_role_dtl   SET gnum_isvalid =?  WHERE hdrnum_roster_id =?   AND hdrnum_shift_id =?    AND TRUNC (hdrdt_from_date) = TO_date(?, 'dd-mm-yyyy')    AND TRUNC (hdrdt_to_date) = TO_date (?, 'dd-mm-yyyy') and gnum_isvalid=?             
              
              
              
SELECT_CHECK_DUTY_EXSISTS.HDRT_ROSTER_DTL= SELECT COUNT (*)  FROM hdrt_roster_dtl  WHERE   (    str_emp_no \= ?  AND gnum_isvalid \=?  AND gnum_hospital_code \= ? AND (   ( TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss')  BETWEEN hdrdt_start_datetime   AND hdrdt_end_datetime  )  OR ( TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss')   BETWEEN hdrdt_start_datetime  AND hdrdt_end_datetime  )   )  ) OR (    str_emp_no \=?   AND gnum_isvalid \=?   AND gnum_hospital_code \=? AND (     (TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss')  BETWEEN hdrdt_start_datetime AND hdrdt_end_datetime ) OR (TO_DATE (?, 'dd-mm-yyyy hh24\:mi\:ss')  BETWEEN hdrdt_start_datetime AND hdrdt_end_datetime )  )  )
       
		      
////////////////////////////////////FOR////HDRT_ROSTER_RELIVER_DTL////////////////////////////

SELECT_MAX_SNO.HDRT_ROSTER_RELIVER_DTL=SELECT nvl(MAX (hdrnum_slno),0)+1  FROM hdrt_roster_reliver_dtl WHERE TRUNC (hdrdt_req_date) = TRUNC(SYSDATE)  AND gnum_hospital_code = ?


INSERT.HDRT_ROSTER_RELIVER_DTL=INSERT INTO HDRT_ROSTER_RELIVER_DTL(HDRDT_REQ_DATE, GNUM_HOSPITAL_CODE, HDRNUM_SLNO, HDRSTR_RELIVER_FOR, HDRNUM_REQ_STATUS, HDRNUM_SHIFT_ID, HDRNUM_RELIEVER_MODE, HDRDT_START_DATETIME, HDRDT_END_DATETIME, HDRSTR_RELIVED_BY, HDRNUM_ROSTER_ID, HDRSTR_REASON,GNUM_ISVALID, GNUM_ENTER_BY, GDT_ENTRY_DATE)  \
		 VALUES (trunc(SYSDATE),?,?,?,?,?,?,TO_DATE (?, 'dd-mm-yyyy'),TO_DATE (?, 'dd-mm-yyyy'),?,?,?,?,?,SYSDATE)

 		      
UPDATE_SHIFT_TO_DAY_OFF.HDRT_ROSTER_DTL.FOR_RELIVER_ASSIGNMENT=UPDATE hdrt_roster_dtl  SET hdrnum_shift_id = ?, hdrdt_start_datetime = TRUNC (hdrdt_start_datetime),hdrdt_end_datetime = TRUNC (hdrdt_end_datetime) WHERE hdrnum_roster_id = ?    AND str_emp_no = ?    AND TRUNC (hdrdt_start_datetime) = TO_DATE (?, 'dd-mon-yyyy')    AND TRUNC (hdrdt_end_datetime) = TO_DATE (?, 'dd-mon-yyyy')    AND gnum_isvalid = ?     and GNUM_HOSPITAL_CODE=?		      



//////////////////////////////For////Daily////Work//////Report/////of////the/////Employee//////////////////////////
 
 
SELECT_DAILY_WORK_REPORT.ROSTER_DETAIL.HDRT_ROSTER_DTL = SELECT a.str_emp_no AS empid, a.hdrnum_shift_id AS shiftid,a.hdrnum_duty_role_id AS roleid,(SELECT hdtstr_shift_desc  FROM hdrt_shift_mst c   WHERE c.hdrnum_shift_id \= a.hdrnum_shift_id     AND c.gnum_hospital_code \= a.gnum_hospital_code    AND c.gnum_isvalid \= a.gnum_isvalid) AS shiftdesc, TO_CHAR (hdrdt_start_datetime, 'hh24\:mm') AS startDateTime,TO_CHAR (hdrdt_end_datetime, 'hh24\:mm') AS endDateTime, PKG_BLOODBANK_MST.emp_name_empidwise(a.GNUM_HOSPITAL_CODE,a.str_emp_no) ||' ('  || (SELECT gstr_designation || ')'   FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE)     AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN  ( SELECT num_desig_id  FROM pist_emp_registration_dtl  WHERE str_emp_no \= a.str_emp_no  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno)  FROM gblt_designation_mst x    WHERE num_desig_id \= x.num_desig_id  AND gnum_hospital_code \= x.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (gdt_effective_to,SYSDATE + 1  ) >\= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)))  as empName,a.hdrstr_duty_area_code || '@' || a.hdrnum_area_type_code || '@' || (SELECT pkg_duty_roster.areaName(?,a.hdrnum_area_type_code,a.hdrstr_duty_area_code) FROM DUAL) AS areaName FROM hdrt_roster_dtl a, hdrt_roster_generation_dtl b  WHERE a.gnum_isvalid \= ?   AND a.gnum_hospital_code \= ?   AND a.hdrnum_roster_type_id \= ? AND a.hdrstr_duty_area_code like ?   AND a.hdrnum_area_type_code \= ?  AND a.STR_EMP_NO\=?  AND TRUNC (hdrdt_start_datetime) \= to_date(?,'dd-mm-yyyy') AND a.hdrnum_roster_id \= b.hdrnum_roster_id   AND a.gnum_isvalid \= b.gnum_isvalid  AND trunc(hdrdt_start_datetime) >\= trunc(b.hdrdt_start_date) AND trunc(hdrdt_start_datetime) <\= trunc(b.hdrdt_end_date)    AND A.HDRNUM_SHIFT_ID\!\=0  order by startDateTime



SELECT_ALL_MAPPED_DUTY_REPORT.HDRT_ROSTER_DTL_NEW=SELECT   a.hdrstr_duty_area_code AS areaCode,SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime,nvl(TO_CHAR (hdrdt_start_datetime, 'dd-Mon-yyyy'),'---') as rosterDate,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,a.str_emp_no empId, (SELECT  substr(str_first_name,1,1) FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) empShortName,hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name) || '(' || (SELECT gstr_designation ||')'  FROM gblt_designation_mst x   WHERE gnum_hospital_code \= a.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)  AND num_desig_id IN ( SELECT num_desig_id    FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= 1)  AND gnum_slno \=  (SELECT MAX (gnum_slno)  FROM gblt_designation_mst x WHERE num_desig_id \= x.num_desig_id   AND gnum_hospital_code \= x.gnum_hospital_code   AND gdt_effective_frm <\=TRUNC (SYSDATE)   AND NVL (gdt_effective_to,SYSDATE + 1 ) >\= TRUNC (SYSDATE)  AND gnum_isvalid IN (1, 2)) )\tFROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code) || '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c WHERE a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid))) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?     AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= ( SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code))
			    
			    
SELECT_ALL_MAPPED_AREA_DUTY_REPORT.HDRT_ROSTER_DTL=SELECT   a.hdrstr_duty_area_code AS areaCode,(SELECT pkg_duty_roster.areaname(a.gnum_hospital_code,a.hdrnum_area_type_code,a.hdrstr_duty_area_code)  FROM DUAL) AS areaName,nvl(TO_CHAR (hdrdt_start_datetime, 'dd-Mon-yyyy'),'---') as rosterDate,a.str_emp_no empId,(SELECT  substr(str_first_name,1,1) FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) empShortName, hdrnum_shift_id shiftId,NVL ((SELECT hdtstr_shift_shortname   FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftShortName, NVL ((SELECT HDRNUM_SHIFT_TYPE    FROM hdrt_shift_mst  WHERE hdrnum_shift_id \= a.hdrnum_shift_id   AND gnum_hospital_code \= a.gnum_hospital_code   AND gnum_isvalid \= a.gnum_isvalid ),(SELECT HDRNUM_SHIFT_TYPE   FROM hdrt_shift_type_mst   WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid )) AS shiftType, NVL ((SELECT HDTSTR_SHIFT_DESC  FROM hdrt_shift_mst   WHERE hdrnum_shift_id \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= a.gnum_isvalid ),(SELECT hdtstr_shift_desc  FROM hdrt_shift_type_mst  WHERE hdrnum_shift_type \= a.hdrnum_shift_id  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid )) AS shiftName, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),1,2) startDateTime, SUBSTR (TO_CHAR (hdrdt_start_datetime, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftStartTime,SUBSTR (TO_CHAR (HDRDT_END_DATETIME, 'dd-mm-yyyy hh24\:mi\:ss'),12,5 ) shiftEndTime , (SELECT    INITCAP(str_emp_full_name)  FROM pist_emp_registration_dtl   WHERE str_emp_no \= a.str_emp_no    AND gnum_isvalid \= a.gnum_isvalid   AND gnum_hospital_code \=  a.gnum_hospital_code)|| '\#' || NVL ((SELECT c.num_mobile_no || ' ' ||NUM_TEL_NO_RESI FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) AS empname, (SELECT d.gstr_usr_name FROM gblt_user_mst d WHERE d.gnum_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid AND d.gnum_userid \= (SELECT gnum_enter_by FROM hdrt_roster_generation_dtl c WHERE a.hdrnum_roster_id \= c.hdrnum_roster_id AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid AND c.hdrnum_slno \= (SELECT MAX (c.hdrnum_slno) FROM hdrt_roster_generation_dtl e WHERE e.hdrnum_roster_id \= c.hdrnum_roster_id AND e.gnum_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid))) incharge FROM hdrt_roster_dtl a, pist_emp_registration_dtl b    WHERE hdrnum_roster_type_id \= ?  AND hdrstr_duty_area_code in (SELECT hdrstr_duty_area_code  FROM hdrt_rosterarea_capacity_mst X  WHERE hdrnum_roster_type_id \= a.hdrnum_roster_type_id   AND gnum_hospital_code \= a.GNUM_HOSPITAL_CODE  AND hdrnum_slno \=(SELECT MAX (hdrnum_slno)   FROM hdrt_rosterarea_capacity_mst   WHERE hdrnum_roster_type_id \= X.hdrnum_roster_type_id   AND gnum_hospital_code \= X.gnum_hospital_code   AND hdrstr_duty_area_code \= X.hdrstr_duty_area_code))  AND hdrnum_area_type_code \=?  AND a.str_emp_no \= b.str_emp_no \t  AND a.gnum_isvalid\= ?  AND a.gnum_hospital_code \=? AND a.gnum_hospital_code\=b.GNUM_HOSPITAL_CODE   and a.gnum_isvalid\=b.GNUM_ISVALID AND b.num_desig_id IN ( SELECT num_desig_id FROM hdrt_roster_designation_mst c WHERE hdrnum_roster_type_id \=a.hdrnum_roster_type_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND hdrnum_slno \= (SELECT MAX (hdrnum_slno) FROM hdrt_roster_designation_mst WHERE hdrnum_roster_type_id \= c.hdrnum_roster_type_id  AND num_desig_id \= c.num_desig_id  AND gnum_hospital_code \= c.gnum_hospital_code))\t\t\t    
			         
SELECT.DUTY_ROSTER_REPORT.HDRT_ROSTERWISE_RELIEVERS_DTL=select STR_EMP_NO as reliverId, nvl((SELECT  INITCAP (str_first_name)|| ' '|| INITCAP (str_middle_name)|| ' '|| INITCAP (str_last_name)|| '(' || (SELECT gstr_designation || ')' FROM gblt_designation_mst x WHERE gnum_hospital_code \= a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE) AND gnum_isvalid IN (1, 2) AND num_desig_id IN ( SELECT num_desig_id FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1) AND gnum_slno \= (SELECT MAX (gnum_slno) FROM gblt_designation_mst x WHERE num_desig_id \= x.num_desig_id AND gnum_hospital_code \= x.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\=TRUNC (SYSDATE) AND gnum_isvalid IN (1, 2))) FROM pist_emp_registration_dtl WHERE str_emp_no \= a.str_emp_no AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code),'--') || '\#' || NVL ((SELECT c.num_mobile_no || ' ' || c.num_fax_no FROM pist_emp_contact_dtl c WHERE a.str_emp_no \= c.str_emp_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= 1), '-' ) as reliverEmp from HDRT_ROSTERWISE_RELIEVERS_DTL a where GNUM_ISVALID\=1 and HDRNUM_ROSTER_TYPE_ID\=? and GNUM_HOSPITAL_CODE\=? AND EXTRACT (YEAR FROM HDRDT_FROM_DATE) \= ? AND EXTRACT (YEAR FROM HDRDT_TO_DATE) \= ? AND EXTRACT (MONTH FROM HDRDT_FROM_DATE) \= ? AND EXTRACT (MONTH FROM HDRDT_TO_DATE) \= ? and EXISTS ( SELECT   'X' FROM hdrt_roster_generation_dtl WHERE hdrnum_roster_type_id \= a.HDRNUM_ROSTER_TYPE_ID AND hdrstr_duty_area_code \= ? AND hdrnum_area_type_code \= ? AND gnum_hospital_code \= a.gnum_hospital_code AND hdrnum_roster_status \= ? AND EXTRACT (YEAR FROM hdrdt_start_date) \= ? AND EXTRACT (YEAR FROM hdrdt_end_date) \= ? AND EXTRACT (MONTH FROM hdrdt_start_date) \= ? AND EXTRACT (MONTH FROM hdrdt_end_date) \= ? ) 
	   	         