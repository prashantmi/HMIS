SELECT_ALL_EPISODE_MC.HRGT_EPISODE_DTL = select A.HRGNUM_PUK as patCrNo, A.HRGNUM_EPISODE_CODE as episodeCode ,A.GNUM_DEPT_CODE as departmentCode, A.HGNUM_DEPTUNITCODE as departmentUnitCode, to_char(A.HRGDT_EPISODE_START_DATE,'dd-Mon-yyyy') as episodeDate, A.HRGNUM_VISIT_TYPE as episodeVisitType, A.HRGNUM_ADMISSION_NO as admissionNo,(select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE \= A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ? ) as department, (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ? ) as departmentUnit, (select GNUM_DIAGNOSIS_CODE_TYPE from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= 1 ) as diagnosisCodeType ,(SELECT X.HGNUM_TEMPLATE_ID FROM HGBT_TEMPLATE_MST X WHERE X.GNUM_ISVALID\=1 AND X.HGNUM_TEMPLATE_CATEGORY \= 20) as templateIdfrom HRGT_EPISODE_DTL A where A.HRGNUM_PUK \= ? and A.HRGNUM_VISIT_NO \= ? AND A.GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? ORDER BY A.HRGDT_EPISODE_START_DATE DESC


SELECT_ADM_ADVICE.HIPT_ADMISSIONADVICE = SELECT HRGNUM_PUK as patCrNo, HOPNUM_EPISODE_NO as episodeCode,HIPNUM_ADM_ADVNO as admAdvNo, HIPDT_ADM_ADVICEDT as admAdvDate FROM HIPT_ADMISSIONADVICE WHERE HRGNUM_PUK \= ? AND HOPNUM_EPISODE_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?

#added by swati onn date:02-may-2019(NIMS)

#SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH_ADMNOWISE =SELECT c.HIPNUM_CASESHEET_ID AS casesheetid, A.HIPNUM_WARD_CODE AS wardCode,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code)patname,HIPNUM_CASESHEET_ID caseSheetId, a.hrgstr_sex  ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge , TO_CHAR (a.hipdt_disdatetime, 'DD-Mon-YYYY') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,(SELECT HGNUM_DEPTUNITCODE FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?) )AS departmentUnitCode, (SELECT GNUM_DEPT_CODE FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS departmentCode ,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code)) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',((TRUNC (SYSDATE)-(TRUNC(a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code and  d.HRGNUM_VISIT_NO\=a.HRGNUM_VISIT_NO) isMLC FROM hipt_patadmission_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.hipnum_admno \= ?  AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY patName, a.hipnum_admno

#added by swati onn date:02-may-2019 (NIMS)
#SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH_CRNOWISE = SELECT c.HIPNUM_CASESHEET_ID AS casesheetid, A.HIPNUM_WARD_CODE AS wardCode,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code)patname,HIPNUM_CASESHEET_ID caseSheetId, a.hrgstr_sex  ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge , TO_CHAR (a.hipdt_disdatetime, 'DD-Mon-YYYY') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,(SELECT HGNUM_DEPTUNITCODE FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?) )AS departmentUnitCode, (SELECT GNUM_DEPT_CODE FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS departmentCode ,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code)) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',((TRUNC (SYSDATE)-(TRUNC(a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code and  d.HRGNUM_VISIT_NO\=a.HRGNUM_VISIT_NO) isMLC FROM hipt_patadmission_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.HRGNUM_PUK \= ?  AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY patName, a.hipnum_admno

#added by swati onn date:15-may-2019
SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH_ADMNOWISE = SELECT c.HIPNUM_CASESHEET_ID AS casesheetid,A.HIPNUM_WARD_CODE AS wardCode,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) as patname,HIPNUM_CASESHEET_ID caseSheetId, (SELECT gstr_gender_code FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge, TO_CHAR (a.hipdt_disdatetime, 'dd-Mon-yyyy hh24\:mi') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code) and rownum\=1) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay, (SELECT decode(decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0),'0','Normal',1,'Delayed')FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \=? and gnum_Isvalid \=a.gnum_isvalid)isdelayed,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code and a.HRGNUM_VISIT_NO\=d.HRGNUM_VISIT_NO) isMLC FROM hipt_patadmdisc_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.hipnum_admno  \= ? AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY a.hipdt_disdatetime, a.hipnum_admno  

#added by swati onn date:15-may-2019
SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH_CRNOWISE = SELECT c.HIPNUM_CASESHEET_ID AS casesheetid,A.HIPNUM_WARD_CODE AS wardCode,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) as patname,HIPNUM_CASESHEET_ID caseSheetId, (SELECT gstr_gender_code FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge, TO_CHAR (a.hipdt_disdatetime, 'dd-Mon-yyyy hh24\:mi') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code) and rownum\=1) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay, (SELECT decode(decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0),'0','Normal',1,'Delayed')FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \=? and gnum_Isvalid \=a.gnum_isvalid)isdelayed,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code and a.HRGNUM_VISIT_NO\=d.HRGNUM_VISIT_NO) isMLC FROM hipt_patadmdisc_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.HRGNUM_PUK  \= ? AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY a.hipdt_disdatetime, a.hipnum_admno  



SELECT_EPISODE_REST_ADVICE.HRGT_EPISODE_RESTADVICE_DTL = SELECT HRGSTR_REST_REASON as restReason, to_char(HRGDT_START_DATE,'dd-Mon-yyyy') as startDate, to_char(HRGDT_END_DATE,'dd-Mon-yyyy') as endDate, (trunc(HRGDT_END_DATE)-trunc(HRGDT_START_DATE)+1) as adviceDays, PSRSTR_EMP_NO as empNo, A.HRGNUM_VISIT_NO as episodeVisitNo, (SELECT STR_EMP_FULL_NAME  FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO \=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ?) as consultantName FROM HRGT_EPISODE_RESTADVICE_DTL A WHERE A.HRGNUM_PUK \= ? AND A.HRGNUM_EPISODE_CODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?\tAND A.HRGNUM_CERTIFICATE_STATUS \= ?


INSERT.HRGT_PAT_MEDICAL_DTL = INSERT INTO HRGT_PAT_MEDICAL_DTL(HRGNUM_PUK, HPMRNUM_CERTIFICATE_ID, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HPMRSTR_MED_CERTIFICATE_ID, HRGNUM_S_NO, PSRSTR_EMP_NO, HRGNUM_ADMISSION_NO, HRGSTR_SUFFERING_FROM, HGNUM_ADVICE_DAYS, GNUM_ISVALID, HRGDT_FROM_DATE, GNUM_SEAT_ID, HRGDT_TO_DATE, GNUM_HOSPITAL_CODE, GDT_EFFECTIVE_FRM, GDT_ENTRY_DATE, HPMRSTR_REMARKS) VALUES(?,?,?,?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PAT_MEDICAL_DTL WHERE HPMRNUM_CERTIFICATE_ID \= ?),?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?)\t\t\t\t\t\t\t\t\t


SELECT_ALL_VISIT_NEW_ADVICE.HRGT_EPISODE_DTL = SELECT HRGNUM_PUK as patCrNo, HRGNUM_EPISODE_CODE as episodeCode, HRGNUM_VISIT_NO as episodeVisitNo,to_char(HRGDT_EPISODE_DATE,'dd-Mon-yyyy') as episodeDate, HRGNUM_VISIT_TYPE as episodeVisitType, HRGNUM_ADMISSION_NO as admissionNo FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?


CHECK_EXISTING_RECORD.HRGT_PAT_MEDICAL_DTL = SELECT A.HRGSTR_SUFFERING_FROM as sufferingFrom, A.HGNUM_ADVICE_DAYS as adviceDays, TO_CHAR(A.HRGDT_FROM_DATE,'dd-Mon-yyyy') as fromDate, TO_CHAR(A.HRGDT_TO_DATE,'dd-Mon-yyyy') as toDate, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST where GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_DEPT_CODE \=(select distinct GNUM_DEPT_CODE  from HRGT_EPISODE_DTL where HRGNUM_PUK \= A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE \= A.HRGNUM_EPISODE_CODE AND GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND gnum_isvalid \= 1  AND HGNUM_DEPTUNITCODE \=(select distinct HGNUM_DEPTUNITCODE  from HRGT_EPISODE_DTL where HRGNUM_PUK \= A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE \= A.HRGNUM_EPISODE_CODE AND GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE))||')' as unitName FROM HRGT_PAT_MEDICAL_DTL A WHERE NOT ((TO_DATE(?,'dd-Mon-yyyy') < TO_DATE(A.HRGDT_FROM_DATE) AND TO_DATE(?,'dd-Mon-yyyy') < TO_DATE(A.HRGDT_FROM_DATE)) OR (TO_DATE(?,'dd-Mon-yyyy') > TO_DATE(A.HRGDT_TO_DATE) AND TO_DATE(?,'dd-Mon-yyyy') > TO_DATE(A.HRGDT_TO_DATE))) AND A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GDT_EFFECTIVE_TO IS NULL
 


SELECT_ISSUED_MC.HRGT_PAT_MEDICAL_DTL = SELECT   A.HRGSTR_SUFFERING_FROM AS sufferingFrom, A.HGNUM_ADVICE_DAYS AS adviceDays, TO_CHAR (A.HRGDT_FROM_DATE, 'dd-Mon-yyyy') AS fromDate, A.HRGNUM_S_NO as sNo, TO_CHAR (A.HRGDT_TO_DATE, 'dd-Mon-yyyy') AS toDate, A.HRGNUM_ADMISSION_NO AS patAdmNo, A.HRGNUM_VISIT_NO AS episodeVisitNo, A.PSRSTR_EMP_NO as empNo, A.HPMRSTR_MED_CERTIFICATE_ID AS medicalCertificateName, A.HPMRNUM_CERTIFICATE_ID AS medicalCertificateId, (select TO_CHAR(B.HRGDT_FITNESS_DATE,'dd-Mon-yyyy') from HRGT_PAT_FITNESS_DTL B where B.HPMRNUM_MED_CERTIFICATE_ID \= A.HPMRNUM_CERTIFICATE_ID) as fitnessDate, (SELECT TRIM(STR_EMP_FULL_NAME) FROM PIST_EMP_REGISTRATION_DTL P WHERE P.GNUM_ISVALID \= ? AND P.STR_EMP_NO\=A.PSRSTR_EMP_NO AND P.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE) as empName, (SELECT C.HPMRNUM_CERTIFICATE_ID FROM HRGT_PAT_FITNESS_DTL C WHERE C.HPMRNUM_MED_CERTIFICATE_ID\=A.HPMRNUM_CERTIFICATE_ID) AS fitnessCertificateId, NVL((SELECT e.hgnum_max_days FROM HGBT_DOCTOR_DESIG_MAPPING e WHERE e.num_desig_id \= (SELECT DISTINCT d.gnum_desig_code  FROM PIST_EMP_REGISTRATION_DTL d WHERE d.str_emp_no \= a.psrstr_emp_no  AND d.gnum_hospital_code \=a.gnum_hospital_code)  AND e.gnum_hospital_code \= a.gnum_hospital_code  AND e.hgnum_process_type \= ?),0) maxDays FROM HRGT_PAT_MEDICAL_DTL A   WHERE A.HRGNUM_PUK \= ? AND A.HRGNUM_EPISODE_CODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GDT_EFFECTIVE_TO IS NULL ORDER BY A.HRGDT_FROM_DATE



INSERT.HRGT_PAT_FITNESS_DTL = INSERT INTO HRGT_PAT_FITNESS_DTL(HRGNUM_PUK, HPMRNUM_CERTIFICATE_ID, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_S_NO, PSRSTR_EMP_NO, HPMRSTR_FIT_CERTIFICATE_ID, HRGNUM_ADMISSION_NO, HPMRSTR_MED_CERTIFICATE_ID, HRGSTR_SUFFERING_FROM, HPMRNUM_MED_CERTIFICATE_ID, HRGDT_FITNESS_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE) VALUES(?,?,?,?,(SELECT NVL(MAX(HRGNUM_S_NO),0)+1 FROM HRGT_PAT_FITNESS_DTL WHERE HPMRNUM_CERTIFICATE_ID \= ?),?,?,?,?,?,?,?,?,?,?,SYSDATE)


CHECK_EXISTING_RECORD.HRGT_PAT_FITNESS_DTL = SELECT COUNT(*) FROM HRGT_PAT_FITNESS_DTL WHERE HRGNUM_PUK = ? AND HRGNUM_EPISODE_CODE = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ? AND TO_DATE(HRGDT_FITNESS_DATE) = TO_DATE(?,'dd-Mon-yyyy')

#Added by:	Akash Singh
#Date:		08-01-2015
#Reason:	Changes as per G5 Patient Death Detail Data Model
#Logs:		Added INSERT.HPMRT_CERTIFICATE_ISSUE_DTL


INSERT.HPMRT_CERTIFICATE_ISSUE_DTL = INSERT INTO HPMRT_CERTIFICATE_ISSUE_DTL (HPMRNUM_CERTIFICATE_ID, HPMRSTR_CERTIFICATE_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRNUM_HANDOVER_TO, HPMRNUM_ISDUPLICATE, HPMRNUM_ISRECEIPT_TAKEN, HPMRNUM_RECORD_STATUS, HPMRSTR_REMARKS, HGNUM_DEPTUNITCODE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, GSTR_IP_ADD)VALUES(?,?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_CERTIFICATE_ISSUE_DTL WHERE HPMRNUM_CERTIFICATE_ID \= ? AND GNUM_HOSPITAL_CODE \= ?),?,?,?,?,?,?,?,?,?,?,SYSDATE,?)


GENERATE_CERTIFICATE_ID = SELECT PKG_MRD_DTL.GENERATECERTIFICATEID(?,?,?,?,?) FROM DUAL


UPDATE_MC.HRGT_PAT_MEDICAL_DTL = UPDATE HRGT_PAT_MEDICAL_DTL SET GDT_EFFECTIVE_TO\= SYSDATE, GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \= ? WHERE HPMRNUM_CERTIFICATE_ID \= ? AND HRGNUM_S_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?



CHECK_EXISTING_RECORD_FOR_MODIFY.HRGT_PAT_MEDICAL_DTL = SELECT A.HRGSTR_SUFFERING_FROM as sufferingFrom, A.HGNUM_ADVICE_DAYS as adviceDays, TO_CHAR(A.HRGDT_FROM_DATE,'dd-Mon-yyyy') as fromDate, TO_CHAR(A.HRGDT_TO_DATE,'dd-Mon-yyyy') as toDate, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST where GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GNUM_DEPT_CODE \=(select distinct GNUM_DEPT_CODE  from HRGT_EPISODE_DTL where HRGNUM_PUK \= A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE \= A.HRGNUM_EPISODE_CODE AND GNUM_ISVALID \= ? AND HRGNUM_VISIT_TYPE \!\= ? AND A.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND HGNUM_DEPTUNITCODE \=(select distinct HGNUM_DEPTUNITCODE  from HRGT_EPISODE_DTL where HRGNUM_PUK \= A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE \= A.HRGNUM_EPISODE_CODE AND GNUM_ISVALID \= ? AND HRGNUM_VISIT_TYPE \!\= ? AND A.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE))||')' as unitName FROM HRGT_PAT_MEDICAL_DTL A WHERE NOT ((TO_DATE(?,'dd-Mon-yyyy') < TO_DATE(A.HRGDT_FROM_DATE) AND TO_DATE(?,'dd-Mon-yyyy') < TO_DATE(A.HRGDT_FROM_DATE)) OR (TO_DATE(?,'dd-Mon-yyyy') > TO_DATE(A.HRGDT_TO_DATE) AND TO_DATE(?,'dd-Mon-yyyy') > TO_DATE(A.HRGDT_TO_DATE))) AND A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GDT_EFFECTIVE_TO IS NULL AND HPMRNUM_CERTIFICATE_ID \!\= ?



SELECT_ALL_CERTIFICATE_BY_UNIT_FOR_MOVE.HPMRT_CERTIFICATE_ISSUE_DTL_OLD = SELECT A.HPMRSTR_CERTIFICATE_ID AS certificateDesc, A.HPMRNUM_CERTIFICATE_ID AS certificateId, A.HPMRNUM_SLNO as slNo, DECODE (A.HPMRNUM_RECORD_TYPE, '11', 'Medical Certificate', '12', 'Fitness Certificate') AS recordTypeName, A.HPMRNUM_RECORD_TYPE AS recordType, A.HGNUM_DEPTUNITCODE AS deptUnitCode, A.HPMRSTR_HANDOVER_TO AS handoverTo, (SELECT y.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST y WHERE y.GNUM_DEPT_CODE \= SUBSTR(a.HGNUM_DEPTUNITCODE,1,3) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= a.gnum_isvalid ) ||'('|| (SELECT x.HGSTR_UNITNAME FROM HGBT_UNIT_MST x WHERE x.HGNUM_DEPTUNITCODE\=a.HGNUM_DEPTUNITCODE AND x.GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE AND x.GNUM_ISVALID \= a.gnum_isvalid ) ||')' AS deptUnitName FROM HPMRT_CERTIFICATE_ISSUE_DTL A WHERE A.HPMRNUM_ISDUPLICATE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_RECORD_STATUS \= ? AND A.HGNUM_DEPTUNITCODE \= ?

SELECT_ALL_CERTIFICATE_BY_UNIT_FOR_MOVE.HPMRT_CERTIFICATE_ISSUE_DTL = (SELECT a.hpmrstr_certificate_id AS certificatedesc,b.HPMRNUM_DISPATCH_ID AS dispatchId,  a.hpmrnum_certificate_id AS certificateid, a.hpmrnum_slno AS slno, b.HPMRSTR_RETURN_REASON AS returnReason, (SELECT x.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST x WHERE x.HPMRNUM_RECORD_TYPE\=a.hpmrnum_record_type AND a.gnum_isvalid \= x.gnum_isvalid AND x.gnum_hospital_code\=a.gnum_hospital_code)AS recordtypename, a.hpmrnum_record_type AS recordtype, b.GDT_ENTRY_DATE, a.hgnum_deptunitcode AS deptunitcode, a.hpmrstr_handover_to AS handoverto, (SELECT y.gstr_dept_name FROM GBLT_DEPARTMENT_MST y WHERE y.gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid  ) || '(' || (SELECT x.hgstr_unitname FROM HGBT_UNIT_MST x WHERE x.hgnum_deptunitcode \= a.hgnum_deptunitcode AND x.gnum_hospital_code \= a.gnum_hospital_code AND x.gnum_isvalid \= a.gnum_isvalid  ) || ')' AS deptunitname  ,m.HRGNUM_PUK as patCrNo FROM HPMRT_CERTIFICATE_ISSUE_DTL a, HPMRT_RECORD_DISPATCH_DTL b,HRGT_PAT_MEDICAL_DTL m WHERE a.HPMRNUM_CERTIFICATE_ID\=b.HPMRNUM_RECORD_ID AND m.HPMRNUM_CERTIFICATE_ID\=a.HPMRNUM_CERTIFICATE_ID AND m.HRGNUM_S_NO\=(SELECT MAX(x.HRGNUM_S_NO) FROM HRGT_PAT_MEDICAL_DTL x WHERE x.HPMRNUM_CERTIFICATE_ID\=m.HPMRNUM_CERTIFICATE_ID) AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND b.hpmrnum_record_status IN (?, ?) AND a.hgnum_deptunitcode \= ?) UNION (SELECT a.hpmrstr_certificate_id AS certificatedesc,b.HPMRNUM_DISPATCH_ID AS dispatchId, a.hpmrnum_certificate_id AS certificateid, a.hpmrnum_slno AS slno, b.HPMRSTR_RETURN_REASON AS returnReason, (SELECT x.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST x WHERE x.HPMRNUM_RECORD_TYPE\=a.hpmrnum_record_type AND a.gnum_isvalid \= x.gnum_isvalid AND x.gnum_hospital_code\=a.gnum_hospital_code)AS recordtypename, a.hpmrnum_record_type AS recordtype, b.GDT_ENTRY_DATE, a.hgnum_deptunitcode AS deptunitcode, a.hpmrstr_handover_to AS handoverto, (SELECT y.gstr_dept_name FROM GBLT_DEPARTMENT_MST y WHERE y.gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid  ) || '(' || (SELECT x.hgstr_unitname FROM HGBT_UNIT_MST x WHERE x.hgnum_deptunitcode \= a.hgnum_deptunitcode AND x.gnum_hospital_code \= a.gnum_hospital_code AND x.gnum_isvalid \= a.gnum_isvalid  ) || ')' AS deptunitname ,F.HRGNUM_PUK as patCrNo FROM HPMRT_CERTIFICATE_ISSUE_DTL a, HPMRT_RECORD_DISPATCH_DTL b,HRGT_PAT_FITNESS_DTL F WHERE a.HPMRNUM_CERTIFICATE_ID\=b.HPMRNUM_RECORD_ID AND F.HPMRNUM_CERTIFICATE_ID\=a.HPMRNUM_CERTIFICATE_ID AND F.HRGNUM_S_NO\=(SELECT MAX(y.HRGNUM_S_NO) FROM HRGT_PAT_FITNESS_DTL y WHERE y.HPMRNUM_CERTIFICATE_ID\=F.HPMRNUM_CERTIFICATE_ID) AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND b.hpmrnum_record_status IN (?, ?) AND a.hgnum_deptunitcode \= ?) ORDER BY GDT_ENTRY_DATE
								
															
INSERT.HPMRT_RECORD_DISPATCH_DTL = INSERT INTO HPMRT_RECORD_DISPATCH_DTL(HPMRSTR_RECORD_ID, HPMRNUM_DISPATCH_ID, HPMRNUM_RECORD_ID, HPMRNUM_RECORD_TYPE, HGNUM_DEPTUNITCODE, GNUM_DEPT_CODE, HPMRSTR_REMARKS, GNUM_SENDER_SEATID, HIPNUM_WARD_CODE, GDT_SENDER_DATE, GNUM_RECIPIENT_SEATID, GDT_RECIPIENT_DATE, HPMRSTR_DELAY_REASON, HPMRSTR_RECEIVE_FROM, HPMRSTR_SENDER_EMPNO, GNUM_ISVALID, GNUM_SEAT_ID, HPMRNUM_RECORD_PAGES, HPMRSTR_APPROVED_EMPNO, HPMRSTR_HANDOVER_TO, GDT_ARROVED_DATE, GNUM_HOSPITAL_CODE, GNUM_APPROVED_SEATID, HPMRSTR_RECIPENT_EMPNO, GDT_ENTRY_DATE, HPMRSTR_VERIFY_EMPNO, HPMRNUM_RECORD_STATUS, HRGSTR_IP_ADD, GDT_VERIFY_DATE, GNUM_VERIFY_SEATID, HPMRSTR_RETURN_REASON, HPMRNUM_ENTRY_MODE, HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO) VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?)\t
										

UPDATE.MOVEMENT.HPMRT_CERTIFICATE_ISSUE_DTL = UPDATE HPMRT_CERTIFICATE_ISSUE_DTL SET HPMRNUM_RECORD_STATUS \= ? WHERE HPMRNUM_CERTIFICATE_ID \= ? AND HPMRNUM_SLNO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? and HPMRNUM_RECORD_TYPE\=?


SELECT_ALL_CERTIFICATE_BY_CRNO_FOR_MOVE.HPMRT_CERTIFICATE_ISSUE_DTL	= (SELECT A.HRGNUM_PUK AS patCrNo, e.HPMRNUM_DISPATCH_ID AS dispatchId, A.HPMRNUM_CERTIFICATE_ID as certificateId, A.HPMRSTR_MED_CERTIFICATE_ID as certificateDesc, DECODE(B.HPMRNUM_RECORD_TYPE,'11','Medical Certificate') as recordTypeName, e.HPMRSTR_RETURN_REASON AS returnReason, B.HPMRNUM_RECORD_TYPE as recordType,B.HPMRSTR_HANDOVER_TO as handoverTo,B.HPMRNUM_SLNO as slNo,B.HGNUM_DEPTUNITCODE as deptUnitCode, e.GDT_ENTRY_DATE, (SELECT y.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST y WHERE y.GNUM_DEPT_CODE \= SUBSTR(b.HGNUM_DEPTUNITCODE,1,3) AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= a.gnum_isvalid ) ||'('|| (SELECT x.HGSTR_UNITNAME FROM HGBT_UNIT_MST x WHERE x.HGNUM_DEPTUNITCODE\=b.HGNUM_DEPTUNITCODE AND x.GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE AND x.GNUM_ISVALID \= a.gnum_isvalid ) ||')' AS deptUnitName FROM HRGT_PAT_MEDICAL_DTL A,HPMRT_CERTIFICATE_ISSUE_DTL B, HPMRT_RECORD_DISPATCH_DTL e WHERE A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND  A.GNUM_HOSPITAL_CODE \= ? AND A.GDT_EFFECTIVE_TO IS NULL AND A.HPMRNUM_CERTIFICATE_ID\=B.HPMRNUM_CERTIFICATE_ID AND a.hpmrnum_certificate_id \= e.HPMRNUM_RECORD_ID AND A.HPMRNUM_CERTIFICATE_ID IN(SELECT x.HPMRNUM_RECORD_ID FROM HPMRT_RECORD_DISPATCH_DTL x WHERE x.HPMRNUM_RECORD_STATUS IN (?,?) AND x.GNUM_ISVALID \= A.gnum_isvalid AND x.GNUM_HOSPITAL_CODE \= A.gnum_hospital_code)) UNION (SELECT C.HRGNUM_PUK AS patCrNo, f.HPMRNUM_DISPATCH_ID AS dispatchId, C.HPMRNUM_CERTIFICATE_ID as certificateId, C.HPMRSTR_FIT_CERTIFICATE_ID as certificateDesc, DECODE(D.HPMRNUM_RECORD_TYPE,'12','Fitness Certifcate') as recordTypeName, F.HPMRSTR_RETURN_REASON as returnReason, D.HPMRNUM_RECORD_TYPE as recordType,D.HPMRSTR_HANDOVER_TO as handoverTo,D.HPMRNUM_SLNO as slNo,D.HGNUM_DEPTUNITCODE as deptUnitCode, f.GDT_ENTRY_DATE, (SELECT y.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST y WHERE y.GNUM_DEPT_CODE \= SUBSTR(d.HGNUM_DEPTUNITCODE,1,3) AND GNUM_HOSPITAL_CODE \= c.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= c.gnum_isvalid ) ||'('|| (SELECT x.HGSTR_UNITNAME FROM HGBT_UNIT_MST x WHERE x.HGNUM_DEPTUNITCODE\=d.HGNUM_DEPTUNITCODE AND x.GNUM_HOSPITAL_CODE \= c.GNUM_HOSPITAL_CODE AND x.GNUM_ISVALID \= c.gnum_isvalid ) ||')' AS deptUnitName FROM HRGT_PAT_FITNESS_DTL C, HPMRT_CERTIFICATE_ISSUE_DTL D, HPMRT_RECORD_DISPATCH_DTL F WHERE C.HRGNUM_PUK \= ? AND C.GNUM_ISVALID \= ? AND  C.GNUM_HOSPITAL_CODE \= ? AND C.HPMRNUM_CERTIFICATE_ID\=D.HPMRNUM_CERTIFICATE_ID AND c.hpmrnum_certificate_id \= F.HPMRNUM_RECORD_ID AND C.HPMRNUM_CERTIFICATE_ID IN(SELECT x.HPMRNUM_RECORD_ID FROM HPMRT_RECORD_DISPATCH_DTL x WHERE x.HPMRNUM_RECORD_STATUS IN (?,?) AND x.GNUM_ISVALID \= c.gnum_isvalid AND x.GNUM_HOSPITAL_CODE \= c.gnum_hospital_code))  ORDER BY GDT_ENTRY_DATE
	
	
INSERT.HPMRT_MRD_RECORD_DTL	= INSERT INTO HPMRT_MRD_RECORD_DTL(HPMRSTR_RECORD_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HPMRNUM_RECORD_STATUS, HPMRNUM_RACK_ID, HPMRNUM_MRD_CODE, GNUM_ISVALID, HRGNUM_PUK, HPMRNUM_SHELF_ID, HPMRNUM_IS_SCANNED, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, HPMRSTR_PUT_BY, HRGNUM_EPISODE_CODE, GDT_ENTRY_DATE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HRGSTR_IP_ADD) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)\t
	
																											
UPDATE.MOVEMENT.HPMRT_RECORD_DISPATCH_DTL = UPDATE HPMRT_RECORD_DISPATCH_DTL SET HPMRNUM_RECORD_STATUS \= ?, GNUM_RECIPIENT_SEAT_ID \= ?, GDT_RECIPIENT_DATE \= SYSDATE, HPMRSTR_RECEIVE_FROM \= ? WHERE HPMRNUM_RECORD_ID \= ? AND HPMRNUM_SLNO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? and HPMRNUM_RECORD_TYPE\=?


INSERT_OFFLINE.HPMRT_RECORD_DISPATCH_DTL = INSERT INTO HPMRT_RECORD_DISPATCH_DTL(HPMRSTR_RECORD_ID, HPMRNUM_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HGNUM_DEPTUNITCODE, GNUM_SENDER_SEAT_ID, GDT_SENDER_DATE, GNUM_RECIPIENT_SEAT_ID, GDT_RECIPIENT_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, PSRSTR_EMP_NO, GDT_ENTRY_DATE, HPMRNUM_RECORD_STATUS, HRGSTR_IP_ADD,HPMRSTR_RECEIVE_FROM) VALUES(?,?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_RECORD_DISPATCH_DTL WHERE HPMRNUM_RECORD_ID \=? and HPMRNUM_RECORD_TYPE\=?),?,?,?,SYSDATE,?,SYSDATE,?,?,?,?,SYSDATE,?,?, (SELECT STR_EMP_FULL_NAME FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?))


SELECT_ALL_EPISODE_MC_TODAY.HRGT_EPISODE_DTL = select A.HRGNUM_PUK as patCrNo, A.HRGNUM_EPISODE_CODE as episodeCode , A.HRGNUM_VISIT_NO AS episodeVisitNo, A.GNUM_DEPT_CODE as departmentCode, A.HGNUM_DEPTUNITCODE as departmentUnitCode, to_char(A.HRGDT_EPISODE_DATE,'dd-Mon-yyyy') as episodeDate, A.HRGNUM_VISIT_TYPE as episodeVisitType, A.HRGNUM_ADMISSION_NO as admissionNo,(select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE \= A.GNUM_DEPT_CODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ? ) as department, (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ? ) as departmentUnit, (select GNUM_DIAGNOSIS_CODE_TYPE from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= 1 AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1) >\= TRUNC(SYSDATE)) as diagnosisCodeType, TO_CHAR((SELECT HRGDT_EPISODE_CLOSE_DATE FROM HRGT_EPISODE_CLOSE_DTL WHERE HRGNUM_PUK\=A.HRGNUM_PUK AND HRGNUM_EPISODE_CODE\= A.HRGNUM_EPISODE_CODE AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE),'dd-Mon-yyyy') as episodeCloseDate from HRGT_EPISODE_DTL A where A.HRGNUM_PUK \= ? and TRUNC(A.HRGDT_EPISODE_DATE)\=TRUNC(SYSDATE) AND A.GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? ORDER BY A.HRGDT_EPISODE_DATE DESC


SELECT_EPISODE_REST_ADVICE_TODAY.HRGT_EPISODE_RESTADVICE_DTL = SELECT HRGSTR_REST_REASON as restReason, to_char(HRGDT_START_DATE,'dd-Mon-yyyy') as startDate, to_char(HRGDT_END_DATE,'dd-Mon-yyyy') as endDate, (trunc(HRGDT_END_DATE)-trunc(HRGDT_START_DATE)+1) as adviceDays, PSRSTR_EMP_NO as empNo, A.HRGNUM_VISIT_NO as episodeVisitNo, (SELECT STR_EMP_FULL_NAME  FROM PIST_EMP_REGISTRATION_DTL WHERE STR_EMP_NO \=A.PSRSTR_EMP_NO AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= ?) as consultantName FROM HRGT_EPISODE_RESTADVICE_DTL A WHERE A.HRGNUM_PUK \= ? AND A.HRGNUM_EPISODE_CODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?\tAND A.HRGNUM_CERTIFICATE_STATUS \= ? AND TRUNC(A.GDT_ENTRY_DATE)\=TRUNC(SYSDATE)


SELECT_EXIST_PAT_FAMILY_DOC.HPMRT_PAT_FAMILY_DOC_DTL = SELECT HPMRNUM_SLNO as slNo, HRGNUM_PUK as patCrNo, HPMRSTR_DOCTOR_NAME as doctorName, HPMRNUM_PHYSICIAN_TYPE as physicianType, (SELECT HPMRSTR_FLAG_DESC FROM HPMRT_FLAG_MST WHERE HPMRNUM_TABLE_ID \=3 AND HPMRNUM_FLAG_VALUE \= HPMRNUM_PHYSICIAN_TYPE) as physicianTypeDesc, HPMRSTR_CLINIC_HOS_NAME as clinicHosName, HPMRSTR_QUALIFICATION as qualification, HPMRSTR_DOCTOR_ID as doctorId, HPMRSTR_REG_NO as docRegNo, HPMRSTR_ADDR1 as address1, HPMRSTR_ADDR2 as address2, HPMRSTR_EMAIL as email, HPMRSTR_PHONE as phNo, HPMRSTR_MOBILE as mobileNo, HPMRSTR_CITY as city, HPMRSTR_CONSULTATION_FOR as consultationFor, HPMRSTR_REMARKS as remarks, GDT_EFFECTIVE_FRM as effectiveFrom, GDT_EFFECTIVE_TO as effectiveTo, HPMRSTR_FAX_NO as faxNo,HPMRSTR_PATIENT_ID as patientId, GNUM_HOSPITAL_CODE as hospitalCode FROM HPMRT_PAT_FAMILY_DOC_DTL WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND TRUNC(GDT_EFFECTIVE_FRM) <\= TRUNC(SYSDATE) AND TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE+1)) > TRUNC(SYSDATE) ORDER BY HPMRSTR_DOCTOR_NAME \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
														

INSERT.HPMRT_PAT_FAMILY_DOC_DTL = INSERT INTO HPMRT_PAT_FAMILY_DOC_DTL(HPMRNUM_SLNO, HRGNUM_PUK, HPMRSTR_DOCTOR_NAME, HPMRNUM_PHYSICIAN_TYPE, HPMRSTR_CLINIC_HOS_NAME, HPMRSTR_QUALIFICATION, HPMRSTR_DOCTOR_ID, HPMRSTR_REG_NO, GNUM_ISVALID, HPMRSTR_ADDR1, GNUM_SEAT_ID, HPMRSTR_ADDR2, HPMRSTR_EMAIL, GDT_ENTRY_DATE, HPMRSTR_PHONE, HPMRSTR_MOBILE, HPMRSTR_CITY, HPMRSTR_PATIENT_ID, GNUM_HOSPITAL_CODE, HPMRSTR_CONSULTATION_FOR, HPMRSTR_REMARKS, GDT_EFFECTIVE_FRM, HPMRSTR_FAX_NO,HPMRSTR_CLINIC_HOS_ID) VALUES((SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_PAT_FAMILY_DOC_DTL WHERE HRGNUM_PUK \= ? AND GNUM_HOSPITAL_CODE \= ?),?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,SYSDATE,?,?)


SELECT.HPMRT_PAT_FAMILY_DOC_DTL = SELECT hpmrstr_doctor_name AS doctorname, hpmrnum_physician_type AS physiciantype, hpmrstr_clinic_hos_name AS clinichosname, hpmrstr_qualification AS qualification, hpmrstr_doctor_id AS doctorid, hpmrstr_reg_no AS docregno, hpmrstr_addr1 AS address1, hpmrstr_addr2 AS address2, hpmrstr_email AS email, hpmrstr_phone AS phno, hpmrstr_mobile AS mobileno, hpmrstr_city AS city, hpmrstr_consultation_for AS consultationfor, hpmrstr_remarks AS remarks, gdt_effective_frm AS effectivefrom, gdt_effective_to AS effectiveto, hpmrstr_fax_no AS faxno, hpmrstr_patient_id AS patientid, HPMRSTR_CLINIC_HOS_ID as clinicHosId FROM hpmrt_pat_family_doc_dtl WHERE hrgnum_puk \= ? AND gnum_isvalid \= ? AND gnum_hospital_code \= ? AND HPMRNUM_SLNO \= ?

									 			
UPDATE.HPMRT_PAT_FAMILY_DOC_DTL = UPDATE HPMRT_PAT_FAMILY_DOC_DTL SET HPMRSTR_CLINIC_HOS_NAME \= ?, HPMRSTR_ADDR1 \= ?, HPMRSTR_ADDR2 \= ?, HPMRSTR_EMAIL \= ?, HPMRSTR_PHONE \= ?, HPMRSTR_MOBILE \= ?, HPMRSTR_CITY \= ?, HPMRSTR_PATIENT_ID \= ?, HPMRSTR_CONSULTATION_FOR \= ?, HPMRSTR_REMARKS \= ?, HPMRSTR_FAX_NO \= ?, GDT_LSTMOD_DATE \= sysdate, GNUM_LSTMOD_SEATID \= ?, HPMRNUM_PHYSICIAN_TYPE \= ?, HPMRSTR_DOCTOR_NAME \= ?, HPMRSTR_QUALIFICATION \= ?, HPMRSTR_DOCTOR_ID \= ?, HPMRSTR_REG_NO \= ?, HPMRSTR_CLINIC_HOS_ID \= ? WHERE HPMRNUM_SLNO \= ? AND HRGNUM_PUK \= ? AND GNUM_HOSPITAL_CODE \= ?\t\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t


REVOKE.HPMRT_PAT_FAMILY_DOC_DTL = UPDATE HPMRT_PAT_FAMILY_DOC_DTL SET GDT_EFFECTIVE_TO = SYSDATE WHERE HPMRNUM_SLNO = ? AND HRGNUM_PUK = ? AND GNUM_HOSPITAL_CODE = ?



#Modified by Shruti shail on 21-Apr-2017 for MLC check
#SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH = SELECT c.HIPNUM_CASESHEET_ID AS casesheetid,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code)patname,HIPNUM_CASESHEET_ID caseSheetId, a.hrgstr_sex  ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge , TO_CHAR (a.hipdt_disdatetime, 'DD-Mon-YYYY') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code)) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',((TRUNC (SYSDATE)-(TRUNC(a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code) isMLC FROM hipt_patadmission_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.gnum_deptunit_code \= ? AND a.hipnum_ward_code \= ? AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY patName, a.hipnum_admno 

#Modified by Prachi Tiwari on 15-Jan-2019 for delay check
SELECT_ALL_PATIENTS_FOR_CASESHEET_DISPATCH = SELECT c.HIPNUM_CASESHEET_ID AS casesheetid, A.HIPNUM_WARD_CODE AS wardCode,a.hipnum_admno AS patAdmNo, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) as patname,HIPNUM_CASESHEET_ID caseSheetId, (SELECT gstr_gender_code FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk) ||'/'|| ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patGenderAge, TO_CHAR (a.hipdt_disdatetime, 'dd-Mon-yyyy hh24\:mi') AS disdate, (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)  )AS owndepartmentunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch',5, 'Partial Lost') caseSheetStatusName,decode(HIPNUM_IS_DUPLICATE,'0','Original',1,'Duplicate')isDuplicate,hipnum_casesheet_status caseSheetStatus ,(SELECT hpmrnum_record_status|| '\#'||HPMRSTR_RETURN_REASON FROM hpmrt_record_dispatch_dtl d WHERE hpmrnum_record_id \= c.HIPNUM_CASESHEET_ID AND hpmrnum_record_type \= ? and GNUM_ISVALID\=a.GNUM_ISVALID and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE AND hpmrnum_dispatch_id \=(SELECT MAX (hpmrnum_dispatch_id) FROM hpmrt_record_dispatch_dtl WHERE hpmrnum_record_id \= d.hpmrnum_record_id AND gnum_isvalid \= d.gnum_isvalid AND gnum_hospital_code \= d.gnum_hospital_code) and rownum\=1) recordstatus,a.HRGNUM_EPISODE_CODE episodeCode, a.HRGNUM_VISIT_NO episodeVisitNo,(SELECT decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0) FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \= ? and gnum_Isvalid\=a.gnum_isvalid)isdelay, (SELECT decode(decode((sign(COALESCE((date_part('day',(( (SYSDATE)-((a.hipdt_disdatetime) + hpmrnum_dispatch_indays))))),0))),-1,0,1,1,0),'0','Normal',1,'Delayed')FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= ? AND gnum_hospital_code \=? and gnum_Isvalid \=a.gnum_isvalid)isdelayed,HIPNUM_CASESHEET_TYPE caseSheetType,(SELECT DECODE(D.hrgnum_mlc_Flag,1,1,DECODE(D.hrgnum_mlc_Flag,2,1,0)) FROM HRGT_EPISODE_DTL D WHERE a.hrgnum_puk \= d.hrgnum_puk AND a.gnum_deptunit_code \= d.HGNUM_DEPTUNITCODE AND a.hrgnum_episode_code\=d.hrgnum_episode_code and a.HRGNUM_VISIT_NO\=d.HRGNUM_VISIT_NO) isMLC FROM hipt_patadmdisc_dtl a, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= c.hrgnum_puk AND a.hipnum_admno \= c.HRGNUM_ADMISSION_NO AND a.gnum_deptunit_code like ? AND a.hipnum_ward_code \= ? AND a.hipdt_admstatus_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hipdt_disdatetime IS NOT NULL AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?, ?) ORDER BY a.hipdt_disdatetime, a.hipnum_admno  

#added by swati on date:01-may-20190
ENCLOSURE_LIST_FOR_CASESHEET_DISPATCH.HPMRT_RECORD_ENCLOSURE_MST = SELECT a.hpmrnum_enclosure_id AS enclosureid,(SELECT hpmrstr_enclosure FROM hpmrt_enclosure_mst WHERE hpmrnum_enclosure_id \= a.hpmrnum_enclosure_id and gnum_isvalid\=a.gnum_isvalid and gnum_hospital_code\=?) AS enclosure,HPMRNUM_ISCOMPULSORY as isCompulsory FROM HPMRT_RECORD_ENCLOSURE_MST a WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?  AND a.hpmrnum_record_type \= ? order by HPMRNUM_DISPLAY_ORDER  


UPDATE.HIPD_CASESHEET_DTL	=	update HIPD_CASESHEET_DTL set HIPNUM_CASESHEET_STATUS=? where HIPNUM_CASESHEET_ID=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?
   									
ENCLOSURE_LIST_FOR_CASESHEET_DISPATCH.HPMRT_RECORD_ENCLOSURE_MST = SELECT a.hpmrnum_enclosure_id AS enclosureid,(SELECT hpmrstr_enclosure FROM hpmrt_enclosure_mst WHERE hpmrnum_enclosure_id \= a.hpmrnum_enclosure_id and gnum_isvalid\=a.gnum_isvalid and gnum_hospital_code\=?) AS enclosure,HPMRNUM_ISCOMPULSORY as isCompulsory FROM HPMRT_RECORD_ENCLOSURE_MST a WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?  AND a.hpmrnum_record_type \= ? order by HPMRNUM_DISPLAY_ORDER  

CHECKLIST_FOR_CASESHEET_DISPATCH.HPMRT_RECORD_TYPE_CHECKLIST = SELECT a.HPMRNUM_CHECKLIST_ID AS checklistId,(SELECT hpmrstr_checklist FROM hpmrt_checklist_mst WHERE hpmrnum_checklist_id \= a.hpmrnum_checklist_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= ?) AS checklistName, HPMRNUM_ISCOMPULSORY as isCompulsory FROM HPMRT_RECORD_TYPE_CHECKLIST a WHERE a.GNUM_ISVALID\=? AND a.GNUM_HOSPITAL_CODE\=? AND a.HPMRNUM_RECORD_TYPE\=? and HPMRNUM_CHECKLIST_MODE\=? order by HPMRNUM_DISPLAY_ORDER

SELECT.CHECKLIST_BY_RECORDID.HPMRT_RECORD_CHECKLIST_DTL	=SELECT a.hpmrnum_checklist_id AS checklistid,(SELECT hpmrstr_checklist FROM hpmrt_record_type_checklist WHERE hpmrnum_checklist_id \= a.hpmrnum_checklist_id AND hpmrnum_record_type \= a.hpmrnum_record_type AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= ?) AS checklistname, hpmrstr_remarks remarks FROM hpmrt_record_checklist_dtl a WHERE a.gnum_isvalid \= ?  AND a.hpmrnum_record_type \=?\tAND hpmrnum_record_id \= ? 

INSERT.HPMRT_RECORD_ENCLOSURE_SUMMARY	=	INSERT into HPMRT_RECORD_ENCLOSURE_SUMMARY (HPMRNUM_DISPATCH_ID, HPMRNUM_RECORD_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_ENCLOSURE_ID, HPMRNUM_PAGES_DISPATCH, HPMRNUM_VERIFY_BYPEON, HPMRNUM_VERIFYBY_MRD, \
											HPMRSTR_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,?,?,?,?,?,?,?,?,sysdate)

SAVE_CASESHEET_DISPATCH_ENCLOSURE_DETAILS = INSERT INTO HPMRT_RECORD_ENCLOSURE_SUMMARY(HPMRNUM_SLNO, HPMRNUM_RECORD_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_ENCLOSURE_ID, HPMRNUM_PAGES_DISPATCH, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES((SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_RECORD_ENCLOSURE_SUMMARY WHERE HPMRNUM_RECORD_ID \= ? AND HPMRNUM_RECORD_TYPE \= ? and HPMRNUM_ENCLOSURE_ID\=?),?,?,?,?,?,?,sysdate)
									
SAVE_CASESHEET_DISPATCH_CHECKLIST_DETAILS = INSERT INTO HPMRT_RECORD_CHECKLIST_DTL(HPMRNUM_SLNO, HPMRNUM_RECORD_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_CHECKLIST_ID, HPMRNUM_CHECKLIST_BY, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HPMRSTR_REMARKS) VALUES((SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_RECORD_CHECKLIST_DTL WHERE HPMRNUM_RECORD_ID \= ? AND HPMRNUM_RECORD_TYPE \= ? and HPMRNUM_CHECKLIST_ID\=? and HPMRNUM_CHECKLIST_BY\=?),?,?,?,?,?,?,sysdate,?)

SAVE_CASESHEET_DISPATCH_DETAILS = INSERT INTO HPMRT_RECORD_DISPATCH_DTL(HPMRNUM_SLNO, HPMRNUM_RECORD_ID, HPMRNUM_RECORD_TYPE, HGNUM_DEPTUNITCODE,HIPNUM_WARD_CODE, GNUM_SENDER_SEAT_ID,GDT_SENDER_DATE, GNUM_ISVALID, GNUM_SEAT_ID,HPMRNUM_RECORD_PAGES,GNUM_HOSPITAL_CODE,HRGSTR_IP_ADD, GDT_ENTRY_DATE,HPMRSTR_RECORD_ID,HPMRNUM_RECORD_STATUS,PSRSTR_EMP_NO,HPMRSTR_HANDOVER_TO,GNUM_DEPT_CODE) VALUES((SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_RECORD_DISPATCH_DTL WHERE HPMRNUM_RECORD_ID \= ? AND HPMRNUM_RECORD_TYPE \= ? ),?,?,?,?,?,sysdate,?,?,?,?,?,sysdate,?,?,?,?,?) \t\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  \t\t\t\t\t\t\t\t\t  

INSERT.HPMRT_CRNO_MERGE_DTL = INSERT INTO HPMRT_CRNO_MERGE_DTL(HRGNUM_PUK_INUSED, HRGNUM_PUK_NOTINUSED, HPMRNUM_ISMERGED, HPMRSTR_REASON, \
								HPMRSTR_REMARKS, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID) VALUES(?,?,?,?,?,SYSDATE,?,?)

								
SELECT_MERGED_CR_NO.HPMRT_CRNO_MERGE_DTL = SELECT HRGNUM_PUK_NOTINUSED FROM HPMRT_CRNO_MERGE_DTL WHERE HRGNUM_PUK_INUSED = ? AND HPMRNUM_ISMERGED = ? AND GNUM_ISVALID = ?


SELECT.MERGED_CRNO_FOR_EMR.HPMRT_CRNO_MERGE_DTL = SELECT HRGNUM_PUK_INUSED AS patMainCrNo, HRGNUM_PUK_NOTINUSED AS patNotUsedCrNo, 1 AS isMerged, NVL(HPMRSTR_REASON,'-') AS reason, NVL(HPMRSTR_REMARKS,'-') AS remarks, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, NVL(pkg_bloodbank_mst.emp_name_useridwise(TO_NUMBER(SUBSTR(HRGNUM_PUK_INUSED,0,3)),gnum_seat_id),'-') AS mergedBy FROM HPMRT_CRNO_MERGE_DTL WHERE HRGNUM_PUK_INUSED\=? AND HPMRNUM_ISMERGED\=? AND GNUM_ISVALID\=? UNION SELECT HRGNUM_PUK_INUSED AS patMainCrNo, HRGNUM_PUK_NOTINUSED AS patNotUsedCrNo, 0 AS isMerged, NVL(HPMRSTR_REASON,'-') AS reason, NVL(HPMRSTR_REMARKS,'-') AS remarks, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, NVL(pkg_bloodbank_mst.emp_name_useridwise(TO_NUMBER(SUBSTR(HRGNUM_PUK_INUSED,0,3)),gnum_seat_id),'-') AS mergedBy FROM HPMRT_CRNO_MERGE_DTL WHERE HRGNUM_PUK_NOTINUSED\=? AND HPMRNUM_ISMERGED\=? AND GNUM_ISVALID\=?

REVOKE.HPMRT_CRNO_MERGE_DTL = UPDATE HPMRT_CRNO_MERGE_DTL SET HPMRNUM_ISMERGED \= ?, GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \= ?, HPMRSTR_REASON \= ? WHERE HRGNUM_PUK_INUSED \= ? AND HRGNUM_PUK_NOTINUSED \= ? AND GNUM_ISVALID \=? AND HPMRNUM_ISMERGED \= ?


SELECT_MAIN_CR_NO.HPMRT_CRNO_MERGE_DTL = SELECT DISTINCT HRGNUM_PUK_INUSED FROM HPMRT_CRNO_MERGE_DTL WHERE HPMRNUM_ISMERGED = ? AND GNUM_ISVALID = ?								
									      

COUNT_MERGED_CR_NO.HPMRT_CRNO_MERGE_DTL = SELECT count(*) FROM HPMRT_CRNO_MERGE_DTL WHERE HPMRNUM_ISMERGED = ? AND GNUM_ISVALID = ? and HRGNUM_PUK_NOTINUSED = ?


COUNT_MAIN_CR_NO.HPMRT_CRNO_MERGE_DTL = SELECT count(*) FROM HPMRT_CRNO_MERGE_DTL WHERE HPMRNUM_ISMERGED = ? AND GNUM_ISVALID = ? and HRGNUM_PUK_INUSED = ?
 

SELECT.HRGT_EPISODE_DTL.EMR=SELECT HRGNUM_EPISODE_CODE as episodeCode, HRGNUM_VISIT_NO as episodeVisitNo, HRGNUM_VISIT_TYPE as episodeVisitType, HRGNUM_EPISODE_TYPE_CODE as episodeVisitTypeCode, GNUM_DEPT_CODE as departmentCode, HGNUM_DEPTUNITCODE as departmentUnitCode,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE \=a.HGNUM_DEPTUNITCODE AND GNUM_ISVALID \=a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE \=a.GNUM_HOSPITAL_CODE AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) as departmentUnit FROM HRGT_EPISODE_DTL a WHERE HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? 

SELECT.DISCHARGE_PATIENT_DTL.BYCRNO	=SELECT A.HRGNUM_PUK as patCrNo, A.HRGSTR_PREV_PUK as prevCrNo, to_char(A.HRGDT_DOB,'dd-Mon-yyyy') as patDOB, A.HRGBL_IS_ACTUAL_DOB as isActualDob, A.HRGSTR_FNAME as patFirstName, A.HRGSTR_MNAME as patMiddleName, A.HRGSTR_LNAME as patLastName, A.GSTR_GENDER_CODE as patGenderCode, A.GNUM_MARITAL_STATUS_CODE as patMaritalStatusCode, A.HGNUM_PAT_STATUS_CODE as patStatusCode, A.HRGSTR_FATHER_NAME as patGuardianName, A.HRGSTR_MOMNAME as patMotherName, A.HRGNUM_REG_CAT_CODE as patRegCatCode, A.HGNUM_PATIENT_CAT_CODE as patPrimaryCatCode, A.GDT_ENTRY_DATE as registerDate, A.HRGNUM_IS_MLC as isMLC, A.HRGNUM_ISUNKNOWN as isUnknown, A.HRGNUM_MONTH_INCOME as patMonthlyIncome, A.HRGNUM_IS_URBAN as patIsUrban, '' as isFree, A.HRGNUM_ID_NO as patIdNo, A.HRGNUM_IS_REF as isReferred, A.GNUM_RELIGION_CODE as patReligionCode, AHIS_UTIL.PUK_AGE_ON (?, SYSDATE)  AS PATAGE, a.gnum_nationality AS patnationalitycode, A.HRGSTR_SPOUSENAME as patSpouceName, A.HRGSTR_NATIONAL_ID as patNationalId, A.HBNUM_BLDGRP_CODE as patBloodGroup, A.HRGNUM_ISNEWBORN as isNewBorn, A.HRGNUM_MOTHER_PUK as patMotherCrNo,  A.HRGSTR_NICKNAME as patNickName, A.HRGSTR_CARD_NO as patCardNo, A.HRGNUM_IS_BROUGHTDEAD as isBroughtDead, (SELECT B.GSTR_GENDER_NAME from GBLT_GENDER_MST B WHERE B.GSTR_GENDER_CODE\=A.GSTR_GENDER_CODE  AND B.GNUM_ISVALID \= 1) as patGender, (SELECT C.GSTR_MARITAL_STATUS from GBLT_MARITAL_STATUS_MST C WHERE C.GNUM_MARITAL_STATUS_CODE\=A.GNUM_MARITAL_STATUS_CODE  AND C.GNUM_ISVALID \= 1) as patMaritalStatus, (SELECT E.GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST E where E.GNUM_PATIENT_CAT_CODE\=A.HGNUM_PATIENT_CAT_CODE AND E.GNUM_HOSPITAL_CODE\=? AND E.GNUM_ISVALID \= 1 ) as patPrimaryCat, (SELECT F.gstr_country_name FROM GBLT_COUNTRY_MST F WHERE F.gstr_country_code\=A.gstr_country_code  AND F.GNUM_ISVALID \= 1) as patNationality, (SELECT G.GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST G WHERE G.GNUM_RELIGION_CODE\=A.GNUM_RELIGION_CODE AND G.GNUM_ISVALID \= 1) as patReligion, P.HIPNUM_ADMNO as patAdmNo, P.HIPNUM_ADM_ADVNO as admAdvNo, to_char(P.HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mi') as admDateTime, P.HIPDT_BEDALLOC_DATETIME as bedAllocDateTime, P.HIPNUM_WARD_CODE as wardCode, P.HIPNUM_ROOM_CODE as ipdRoomCode, (SELECT HIPSTR_ROOM_DESC FROM HIPT_ROOM_CONFIG_MST WHERE HIPNUM_ROOM_NO\=P.HIPNUM_ROOM_CODE AND GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE) AS ipdRoomName, P.HIPNUM_BED_CODE as bedCode, P.HIPNUM_CONSULTANT_ID as consultantID, P.HIPDT_DISDATETIME as disDateTime, P.HIPDT_ADMSTATUS_CODE as admStatusCode, P.HIPNUM_CHARGE as charge, P.GNUM_DEPT_CODE as departmentCode, P.GNUM_DEPTUNIT_CODE as departmentUnitCode, (SELECT K.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST K WHERE K.GNUM_DEPT_CODE\=P.GNUM_DEPT_CODE AND K.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND K.GNUM_ISVALID\=1 ) as departmentName, (SELECT L.HGSTR_UNITNAME FROM HGBT_UNIT_MST L WHERE L.HGNUM_DEPTUNITCODE\=P.GNUM_DEPTUNIT_CODE and L.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND L.GNUM_ISVALID\=1 ) as departmentUnitName, (SELECT H.HIPSTR_WARD_NAME FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=P.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=1 AND H.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(H.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))as wardName, (SELECT J.HGNUM_BED_NAME FROM HIPT_WARD_ROOM_BED_MST J WHERE J.HGNUM_BED_CODE\=P.HIPNUM_BED_CODE AND J.GNUM_HOSPITAL_CODE\=P.GNUM_HOSPITAL_CODE AND J.GNUM_ISVALID\=1) as bedName, P.HRGNUM_MLC_NO as mlcNo,P.HRGNUM_EPISODE_CODE as episodeCode, P.HRGNUM_VISIT_NO as episodeVisitNo  FROM HRGT_PATIENT_DTL A,HIPT_PATADMISSION_DTL P WHERE A.HRGNUM_PUK\=P.HRGNUM_PUK AND P.HIPDT_ADMSTATUS_CODE \=? AND P.GNUM_ISVALID\= ? AND A.HRGNUM_PUK \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?

//-----------------------------------------------------Case_Sheet_Monitoring----------------------------------------------------------------------------------------- 
SELECT.CASE_SHEET_DTL_.UNIT_WARD_WISE	=SELECT a.hipnum_admno AS patadmno, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime, hipnum_casesheet_id caseSheetId, hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname patname,b.gstr_gender_CODE|| '/'|| ahis_util.dob_age_on (hrgdt_dob, SYSDATE) patgenderage,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch', 1, 'In Ward', 4, 'Lost', 5, 'Partial Lost') casesheetstatusname, hipnum_casesheet_status casesheetstatus, DECODE (hipnum_is_duplicate, 0, 'Original',1, 'Duplicate') isduplicate, hipnum_is_duplicate isduplicatevalue,a.gnum_deptunit_code departmentUnitCode,a.HIPNUM_WARD_CODE wardCode, to_char(c.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') creationDate  FROM hipt_patadmission_dtl a, hrgt_patient_dtl b, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= b.hrgnum_puk AND a.gnum_deptunit_code like ? AND a.hipnum_ward_code \= ?  AND a.hipdt_admstatus_code IN (?, ?) AND a.gnum_isvalid \= ?  AND a.gnum_hospital_code \= ? AND a.hipnum_admno \= c.hrgnum_admission_no AND c.gnum_isvalid \= a.gnum_isvalid  AND c.gnum_hospital_code \= a.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid  AND c.hipnum_casesheet_status IN (?,?,?,?) ORDER BY a.hrgnum_puk, a.hipnum_admno 

SELECT.CASE_SHEET_DTL_.CR_NO_WISE_OLD	=SELECT   a.hipnum_admno AS patadmno, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') AS admdatetime,hipnum_casesheet_id casesheetid, b.hrgnum_name AS patname,(SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code \= b.hrgstr_sex AND gnum_isvalid \= a.gnum_isvalid) || '/'  || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage, TO_CHAR (a.hipdt_disdatetime, 'DD-Mon-YYYY') AS disdate,a.gnum_deptunit_code departmentUnitCode, a.gnum_dept_code departmentCode,a.HIPNUM_WARD_CODE wardCode,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?) ) AS owndepartmentunitcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch', 1, 'In Ward',2,'Send to Mrd',3,'In Mrd', 4, 'Lost', 5, 'Partial Lost') casesheetstatusname, hipnum_casesheet_status casesheetstatus, DECODE (hipnum_is_duplicate, 0, 'Original',1, 'Duplicate') isduplicate, hipnum_is_duplicate isduplicatevalue, to_char(c.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') creationDate FROM hipt_patadmission_dtl a, hipt_patadmdisc_dtl b, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= b.hrgnum_puk AND a.hipnum_admno \= b.hipnum_admno AND a.hipdt_admstatus_code IN (?,?) AND a.gnum_isvalid \= ?  AND a.gnum_hospital_code \= ? AND b.hipnum_admno \= c.hrgnum_admission_no AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?,?,?,?) AND a.hrgnum_puk \= ? ORDER BY a.hrgnum_puk, a.hipnum_admno

SELECT.CASE_SHEET_DTL_.CR_NO_WISE	=SELECT   a.hipnum_admno AS patadmno, a.hrgnum_puk AS patcrno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') AS admdatetime,hipnum_casesheet_id casesheetid, b.hrgnum_name AS patname,(SELECT x.gstr_gender_code FROM hrgt_patient_dtl x WHERE X.gnum_isvalid \= 1 AND X.gnum_hospital_code \= a.gnum_hospital_code AND X.hrgnum_puk \= a.hrgnum_puk) || '/'  || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage, TO_CHAR (a.hipdt_disdatetime, 'DD-Mon-YYYY') AS disdate,a.gnum_deptunit_code departmentUnitCode, a.gnum_dept_code departmentCode,a.HIPNUM_WARD_CODE wardCode,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?) ) AS owndepartmentunitcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?,?) ) AS owndepartmentcode,DECODE (hipnum_casesheet_status, 0,'Ready To Dispatch', 1, 'In Ward',2,'Send to Mrd',3,'In Mrd', 4, 'Lost', 5, 'Partial Lost') casesheetstatusname, hipnum_casesheet_status casesheetstatus, DECODE (hipnum_is_duplicate, 0, 'Original',1, 'Duplicate') isduplicate, hipnum_is_duplicate isduplicatevalue, to_char(c.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') creationDate FROM hipt_patadmission_dtl a, hipt_patadmdisc_dtl b, hipd_casesheet_dtl c WHERE a.hrgnum_puk \= b.hrgnum_puk AND a.hipnum_admno \= b.hipnum_admno AND a.hipdt_admstatus_code IN (?,?) AND a.gnum_isvalid \= ?  AND a.gnum_hospital_code \= ? AND b.hipnum_admno \= c.hrgnum_admission_no AND c.gnum_isvalid \= a.gnum_isvalid AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.hipnum_casesheet_status IN (?,?,?,?) AND a.hrgnum_puk \= ? ORDER BY a.hrgnum_puk, a.hipnum_admno
									

									
INSERT.HIPD_CASESHEET_LOSTFOUND_DTL		=insert into HIPD_CASESHEET_LOSTFOUND_DTL (HRGNUM_PUK, HIPNUM_SLNO, HIPDT_LOST_DATETIME,HIPNUM_CASESHEET_ID, HIPSTR_REPORTED_BY, HRGNUM_ADMISSION_NO, HIPDT_LASTSEEN_DATETIME,HIPSTR_LOST_AREA, HIPNUM_LOST_TYPE, HIPSTR_LOST_REMARKS, GNUM_ISVALID, GNUM_DEPTUNIT_CODE,GNUM_SEAT_ID, HIPNUM_WARD_CODE, GDT_ENTRY_DATE, HIPNUM_ROOM_CODE, GNUM_HOSPITAL_CODE,HIPDT_FOUND_DATETIME, HIPSTR_FOUND_REMARKS, HIPSTR_FOUND_BY, GSTR_IP_ADD)values(?,(select nvl(MAX(HIPNUM_SLNO),0)+1 FROM HIPD_CASESHEET_LOSTFOUND_DTL WHERE HRGNUM_ADMISSION_NO\=? AND HIPNUM_CASESHEET_ID\=? AND GNUM_HOSPITAL_CODE\=? ),to_date(to_char(?\:\:timestamp,'dd-Mon-yyyy HH24\:Mi'),'dd-Mon-yyyy HH24\:Mi'),?,?,?,to_date(to_char(?\:\:timestamp,'dd-Mon-yyyy HH24\:Mi'),'dd-Mon-yyyy HH24\:Mi'),?,?,?,?,?,?,?,sysdate,?,?,to_date(to_char(?\:\:timestamp,'dd-Mon-yyyy HH24\:Mi'),'dd-Mon-yyyy HH24\:Mi'),?,?,?)
  										
INSERT.HIPD_CASESHEET_LOSTFOUND_DTL2	=insert into HIPD_CASESHEET_LOSTFOUND_DTL (HRGNUM_PUK, HIPNUM_SLNO, HIPDT_LOST_DATETIME,HIPNUM_CASESHEET_ID, HIPSTR_REPORTED_BY, HRGNUM_ADMISSION_NO, HIPDT_LASTSEEN_DATETIME,HIPSTR_LOST_AREA, HIPNUM_LOST_TYPE, HIPSTR_LOST_REMARKS, GNUM_ISVALID, GNUM_DEPTUNIT_CODE,GNUM_SEAT_ID, HIPNUM_WARD_CODE, GDT_ENTRY_DATE, HIPNUM_ROOM_CODE, GNUM_HOSPITAL_CODE,HIPDT_FOUND_DATETIME, HIPSTR_FOUND_REMARKS, HIPSTR_FOUND_BY, GSTR_IP_ADD)values(?,(select nvl(MAX(HIPNUM_SLNO),0)+1 FROM HIPD_CASESHEET_LOSTFOUND_DTL WHERE HRGNUM_ADMISSION_NO\=? AND HIPNUM_CASESHEET_ID\=? AND GNUM_HOSPITAL_CODE\=? ),to_date(to_char(?\:\:timestamp,'dd-Mon-yyyy HH24\:Mi'),'dd-Mon-yyyy HH24\:Mi'),?,?,?,to_date(to_char(?\:\:timestamp,'dd-Mon-yyyy HH24\:Mi'),'dd-Mon-yyyy HH24\:Mi'),?,?,?,?,?,?,?,sysdate,?,?,null,?,?,?)
  										
INSERT.HIPD_CASESHEET_DTL	=insert into HIPD_CASESHEET_DTL (HRGNUM_PUK, HIPNUM_CASESHEET_STATUS,HIPNUM_CASESHEET_ID, HIPNUM_IS_DUPLICATE, GNUM_DEPTUNIT_CODE, HRGNUM_ADMISSION_NO, HIPNUM_WARD_CODE, HIPNUM_ROOM_CODE, HIPSTR_REMARKS, HIPSTR_CANCEL_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GSTR_IP_ADD) values(?,?,(SELECT nvl(max(HIPNUM_CASESHEET_ID),10)+1 from HIPD_CASESHEET_DTL where HRGNUM_ADMISSION_NO\=? and GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,?,?,sysdate,?,?)  \t\t\t\t\t\t\t\t\t\t
  										 
INSERT.HIPD_CASESHEET_DTL_new	=insert into HIPD_CASESHEET_DTL (HRGNUM_PUK, HIPNUM_CASESHEET_STATUS,HIPNUM_CASESHEET_ID, HIPNUM_IS_DUPLICATE, GNUM_DEPTUNIT_CODE, HRGNUM_ADMISSION_NO, HIPNUM_WARD_CODE, HIPNUM_ROOM_CODE, HIPSTR_REMARKS, HIPSTR_CANCEL_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GSTR_IP_ADD) values(?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?)  \t\t\t\t\t\t\t\t\t\t
  
  
SELECT.HIPD_CASESHEET_LOSTFOUND_DTL	=SELECT a.hrgnum_admission_no patAdmNo, a.hipnum_casesheet_id caseSheetId, a.hipnum_slno, a.hrgnum_puk patCrNo,to_char(a.hipdt_lost_datetime,'dd-Mon-yyyy hh24\:mi') lostDate, a.hipstr_reported_by reportedBy, to_char(a.hipdt_lastseen_datetime,'dd-Mon-yyyy hh24\:mi') lastSeenDateTime,a.hipstr_lost_area lostArea, a.hipnum_lost_type lostType,NVL(a.hipstr_lost_remarks,'-') lostRemarks, a.gnum_deptunit_code departmentUnitCode, a.hipnum_ward_code wardCode, a.hipnum_room_code roomCode, to_char(a.hipdt_found_datetime,'dd-Mon-yyyy hh24\:mi') foundDate, a.hipstr_found_remarks foundRemarks, a.hipstr_found_by foundBy FROM hipd_casesheet_lostfound_dtl a where a.HRGNUM_ADMISSION_NO\=? and a.HIPNUM_CASESHEET_ID\=? and  a.HIPNUM_SLNO\=(select max(HIPNUM_SLNO) from hipd_casesheet_lostfound_dtl  where HRGNUM_ADMISSION_NO\=? and HIPNUM_CASESHEET_ID\=? and gnum_hospital_code\=?) and a.gnum_isvalid\=? and a.gnum_hospital_code\=?



INSERT_UPLOAD.HPMRT_BIRTHDEATH_UPLOAD_DTL = INSERT INTO HPMRT_BIRTHDEATH_UPLOAD_DTL (HPMRNO_SLNO, HPMRSTR_REGISTRATION_NO, HPMRNUM_RECORD_TYPE, HPMRDT_UPLOAD_DATETIME, HPMRSTR_REMARKS, HPMRNUM_ENTRY_MODE, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD)VALUES((SELECT NVL(MAX(HPMRNO_SLNO),0)+1 FROM HPMRT_BIRTHDEATH_UPLOAD_DTL where HPMRNUM_RECORD_TYPE \= ? and HRGNUM_PUK \= ?),?,?,SYSDATE,?,?,?,?,?,?,SYSDATE,?)


INSERT_UPLOAD_N_HANDOVER.HPMRT_BIRTHDEATH_UPLOAD_DTL = INSERT INTO HPMRT_BIRTHDEATH_UPLOAD_DTL (HPMRNO_SLNO, HPMRSTR_REGISTRATION_NO, HPMRNUM_RECORD_TYPE, HPMRDT_UPLOAD_DATETIME, HPMRSTR_REMARKS, HPMRNUM_ENTRY_MODE, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, HPMRDT_HANDOVER_DATETIME, HPMRSTR_RELATIVE_NAME, HPMRSTR_RELATIVE_ADDRESS, GNUM_RELATIVECODE) VALUES((SELECT NVL(MAX(HPMRNO_SLNO),0)+1 FROM HPMRT_BIRTHDEATH_UPLOAD_DTL WHERE HPMRNUM_RECORD_TYPE \= ? AND HRGNUM_PUK \= ?),?,?,SYSDATE,?,?,?,?,?,?,SYSDATE,?,SYSDATE,?,?,?)


INSERT_HANDOVER.HPMRT_BIRTHDEATH_UPLOAD_DTL = INSERT INTO HPMRT_BIRTHDEATH_UPLOAD_DTL (HPMRNO_SLNO, HPMRSTR_REGISTRATION_NO, HPMRNUM_RECORD_TYPE, HPMRDT_UPLOAD_DATETIME, HPMRSTR_REMARKS, HPMRNUM_ENTRY_MODE, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, HPMRDT_HANDOVER_DATETIME, HPMRSTR_RELATIVE_NAME, HPMRSTR_RELATIVE_ADDRESS, GNUM_RELATIVECODE) VALUES((SELECT NVL(MAX(HPMRNO_SLNO),0)+1 FROM HPMRT_BIRTHDEATH_UPLOAD_DTL WHERE HPMRNUM_RECORD_TYPE \= ? AND HRGNUM_PUK \= ?),?,?,to_date(?,'dd-Mon-yyyy HH24\:MI'),?,?,?,?,?,?,SYSDATE,?,SYSDATE,?,?,?)



INSERT.HPMRT_SUMMON_DTL = insert into HPMRT_SUMMON_DTL(HPMRNUM_SUMMON_ID, HPMRNUM_SUMMON_TYPE_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_RECORD_CAT, HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGSTR_MLC_NO, HRGNUM_ADMISSION_NO, HPMRNUM_CERTIFICATE_ID, HMRNUM_DECEASED_NO, HMRNUM_POSTMORTEM_ID, HPMRDT_SUMMON_DATETIME, HPMRDT_SUMMON_RECEIVE_DATETIME, HPMRDT_HEARING_DATETIME, HPMRSTR_COURT_NAME, HPMRSTR_COURT_ADDRESS, HPMRSTR_JUDGE_NAME, HRGSTR_CASE_NO, HRGSTR_POLICE_STATION, HRGSTR_CONSTABLE_NAME, HRGSTR_CONSTABLE_DESIG, HRGSTR_CONSTABLE_BADGENO, HPMRSTR_EMP_NAME, HPMRSTR_ASSIGN_TO, HPMRNUM_ASSIGN_SAME, HPMRSTR_OTHER_ASSIGN_REASON, HPMRNUM_ENTRY_MODE, HPMRSTR_ASSIGN_BY, HPMRSTR_SUMMON_REMARKS, HPMRNUM_STATUS, HPMRSTR_VISIT_REMARKS, HPMRDT_NEXTHEARING_DATETIME, HPMRSTR_INSTRUCTIONS, HPMRSTR_PAT_NAME, HPMRSTR_FATHER_NAME, HPMRSTR_SPOUSE_NAME, HPMRSTR_MOTHER_NAME, HPMRNUM_PAT_GENDER_CODE, HPMRDT_PAT_DOB, HPMRSTR_PAT_ADDRESS, HPMRSTR_CID_NO,  HPMRNUM_IS_UPLAOD,  GNUM_ISVALID, GDT_ENTRY_DATE, GNUM_SEAT_ID, GDT_ASSIGN_DATE, GNUM_ASSIGNSEAT_ID, GDT_POSTENTRY_DATE, GNUM_POSTSEAT_ID,GNUM_HOSPITAL_CODE) values(PKG_MRD_DTL.generateSummonId(?),?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy') ,to_date(?,'dd/mm/yyyy hh24\:mi'),to_date(?,'dd/mm/yyyy hh24\:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,GetDob(?,?) ,?,?,?,?,trunc(sysdate),?,?,?,?,?,?)\t

UPDATE.ASSIGN_DETAIL.HPMRT_SUMMON_DTL = update HPMRT_SUMMON_DTL set HPMRSTR_ASSIGN_TO\=?, HPMRNUM_ASSIGN_SAME\=?, HPMRSTR_OTHER_ASSIGN_REASON\=?, HPMRSTR_ASSIGN_BY\=?, GDT_ASSIGN_DATE\=sysdate, GNUM_ASSIGNSEAT_ID\=?,HPMRNUM_STATUS\=? where HPMRNUM_SUMMON_ID\=? and  GNUM_ISVALID\=? and  GNUM_HOSPITAL_CODE\=?\t
										
UPDATE.POST_SUMMON.HPMRT_SUMMON_DTL = update HPMRT_SUMMON_DTL set HPMRSTR_VISIT_REMARKS\=?, HPMRDT_NEXTHEARING_DATETIME\=to_date(?,'dd/mm/yyyy hh24\:mi'), GDT_POSTENTRY_DATE\=sysdate, GNUM_POSTSEAT_ID\=? , HPMRNUM_STATUS\=? where HPMRNUM_SUMMON_ID\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?

 

INSERT.HPMRT_ASSIGNMENT_CHANGE_DTL = insert into HPMRT_ASSIGNMENT_CHANGE_DTL (HPMRNUM_SUMMON_ID, HPMRSTR_OLD_ASSIGNEE, HPMRNUM_SLNO, HPMRSTR_OLDOTHER_ASSIGN_REASON, HPMRNUM_OLD_SUMMON_ACK, HPMRNUM_OLD_ASSIGN_SAME, HPMRSTR_NEW_ASSIGNEE, HPMRSTR_REASON, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE) values(?,?,(select nvl(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_ASSIGNMENT_CHANGE_DTL WHERE HPMRNUM_SUMMON_ID\=? and GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,sysdate,?,?,?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t 

INSERT.COMPUTRIZE.HPMRT_SUMMON_DTL= insert into HPMRT_SUMMON_DTL(HPMRNUM_SUMMON_ID, HPMRNUM_SUMMON_TYPE_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_RECORD_CAT, HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGSTR_MLC_NO, HRGNUM_ADMISSION_NO, HPMRNUM_CERTIFICATE_ID, HMRNUM_DECEASED_NO, HMRNUM_POSTMORTEM_ID, HPMRDT_SUMMON_DATETIME, HPMRDT_SUMMON_RECEIVE_DATETIME, HPMRDT_HEARING_DATETIME, HPMRSTR_COURT_NAME, HPMRSTR_COURT_ADDRESS, HPMRSTR_JUDGE_NAME, HRGSTR_CASE_NO, HRGSTR_POLICE_STATION, HRGSTR_CONSTABLE_NAME, HRGSTR_CONSTABLE_DESIG, HRGSTR_CONSTABLE_BADGENO, HPMRSTR_EMP_NAME, HPMRSTR_ASSIGN_TO, HPMRNUM_ASSIGN_SAME, HPMRSTR_OTHER_ASSIGN_REASON, HPMRNUM_ENTRY_MODE, HPMRSTR_ASSIGN_BY, HPMRSTR_SUMMON_REMARKS, HPMRNUM_STATUS, HPMRSTR_VISIT_REMARKS, HPMRDT_NEXTHEARING_DATETIME, HPMRSTR_INSTRUCTIONS, HPMRSTR_PAT_NAME, HPMRSTR_FATHER_NAME, HPMRSTR_SPOUSE_NAME, HPMRSTR_MOTHER_NAME, HPMRNUM_PAT_GENDER_CODE, HPMRDT_PAT_DOB, HPMRSTR_PAT_ADDRESS, HPMRSTR_CID_NO,  HPMRNUM_IS_UPLAOD,  GNUM_ISVALID, GDT_ENTRY_DATE, GNUM_SEAT_ID, GDT_ASSIGN_DATE, GNUM_ASSIGNSEAT_ID, GDT_POSTENTRY_DATE, GNUM_POSTSEAT_ID,GNUM_HOSPITAL_CODE) values(PKG_MRD_DTL.generateSummonId(?),?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy') ,to_date(?,'dd/mm/yyyy hh24\:mi'),to_date(?,'dd/mm/yyyy hh24\:mi'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd-Mon_yyyy') ,?,?,?,?,trunc(sysdate),?,?,?,?,?,?)\t
									
INSERT.HPMRT_INSURANCE_DTL = insert into HPMRT_INSURANCE_DTL (HPMRNUM_INSURANCE_ID, HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HTRNUM_COMPANY_ID, HPMRSTR_POLICY_NO, HRGNUM_ADMISSION_NO, HPMRNUM_IS_OPINIONFORM, HPMRDT_RECEIVE_DATETIME, HPMRNUM_OPINION_PAGES, HPMRSTR_OPINION_BY, HPMRSTR_OPINION_REMARKS, HPMRNUM_STATUS, HPMRSTR_REMARKS, HPMRSTR_CID_NO, HPMRNUM_IS_OPINIONUPLAOD, GNUM_ISVALID, GDT_ENTRY_DATE, GNUM_SEAT_ID, GDT_OPINION_DATE, GNUM_OPINIONSEAT_ID, GDT_POSTENTRY_DATE, GNUM_HOSPITAL_CODE, GNUM_POSTSEAT_ID,HPMRNUM_RECEIVED_MODE) values(PKG_MRD_DTL.generateInsuranceId(?),?,?,?,?,?,?,?,to_date(?,'dd-mm-yyyy hh24\:mi'),?,?,?,?,?,?,?,?,sysdate,?,to_date(?,'dd-mm-yyyy'),?,to_date(?,'dd-mm-yyyy'),?,?,?)


GENERATE_ID.HPMRT_RECORD_DISPATCH_DTL = SELECT PKG_MRD_DTL.GENDISPATCHID(?,?)FROM DUAL


CHECKLIST_FOR_RECORD_TYPE_WISE.HPMRT_RECORD_TYPE_CHECKLIST = SELECT A.HPMRNUM_CHECKLIST_ID AS checklistId, A.HPMRNUM_RECORD_TYPE AS recordTypeId, A.HPMRNUM_CHECKLIST_MODE AS checkListMode, A.HPMRNUM_ISCOMPULSORY AS isCompulsory, (SELECT B.HPMRSTR_CHECKLIST FROM HPMRT_CHECKLIST_MST B WHERE B.HPMRNUM_CHECKLIST_ID\=A.HPMRNUM_CHECKLIST_ID AND B.GNUM_ISVALID \= A.GNUM_ISVALID AND B.GNUM_HOSPITAL_CODE \= ? ) AS checklistName FROM HPMRT_RECORD_TYPE_CHECKLIST A WHERE A.HPMRNUM_RECORD_TYPE \= ? AND  A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_CHECKLIST_MODE \= ? ORDER BY  A.HPMRNUM_DISPLAY_ORDER


INSERT.HPMRT_RECORD_CHECKLIST_DTL = INSERT INTO HPMRT_RECORD_CHECKLIST_DTL(HPMRNUM_RECORD_ID, HPMRNUM_DISPATCH_ID, HPMRNUM_RECORD_TYPE, HPMRNUM_CHECKLIST_ID, \
										HPMRNUM_CHECKLIST_BY, HPMRSTR_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE) VALUES(?,?,?,?,?,?,?,?,SYSDATE,?)


UPDATE.RECIPENT.HPMRT_RECORD_DISPATCH_DTL = UPDATE HPMRT_RECORD_DISPATCH_DTL SET GNUM_RECIPIENT_SEATID \= ? , GDT_RECIPIENT_DATE \= SYSDATE, HPMRSTR_RECIPENT_EMPNO \= ?, HPMRNUM_RECORD_STATUS \= ? WHERE HPMRNUM_DISPATCH_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? 


UPDATE.REJECT_RECORD.HPMRT_RECORD_DISPATCH_DTL = UPDATE HPMRT_RECORD_DISPATCH_DTL SET HPMRNUM_RECORD_STATUS \= ?, HPMRSTR_RETURN_REASON \= ? WHERE  HPMRNUM_DISPATCH_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? 


GET_RECORD_TOBE_ACCEPT_IN_MRD.HPMRT_RECORD_DISPATCH_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_DISPATCH_ID AS dispatchId, A.HPMRNUM_RECORD_ID AS recordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HGNUM_DEPTUNITCODE AS deptUnitCode, A.GNUM_DEPT_CODE AS deptCode, A.HPMRSTR_SENDER_EMPNO AS senderEmpNo, A.HPMRSTR_RECIPENT_EMPNO AS recipentEmpNo,NVL((SELECT B.STR_EMP_FULL_NAME  FROM PIST_EMP_REGISTRATION_DTL B WHERE B.STR_EMP_NO \=A.HPMRSTR_RECIPENT_EMPNO AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND B.GNUM_ISVALID \= A.GNUM_ISVALID),'-') AS recipentName, NVL((SELECT C.STR_EMP_FULL_NAME  FROM PIST_EMP_REGISTRATION_DTL C WHERE C.STR_EMP_NO \=A.HPMRSTR_SENDER_EMPNO AND C.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND C.GNUM_ISVALID \= A.GNUM_ISVALID),'-') AS senderName, (SELECT D.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST D WHERE D.GNUM_DEPT_CODE \= A.GNUM_DEPT_CODE AND D.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND D.GNUM_ISVALID \= A.GNUM_ISVALID ) AS departmentName, (SELECT E.HGSTR_UNITNAME FROM HGBT_UNIT_MST E WHERE E.HGNUM_DEPTUNITCODE\=A.HGNUM_DEPTUNITCODE AND E.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND E.GNUM_ISVALID \= A.GNUM_ISVALID ) AS departmentUnitName, (SELECT H.HIPSTR_WARD_NAME FROM HIPT_WARD_MST H WHERE H.HIPNUM_WARD_CODE\=A.HIPNUM_WARD_CODE AND H.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND H.GNUM_ISVALID\=A.GNUM_ISVALID AND H.GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(H.GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))AS wardName, A.HIPNUM_WARD_CODE AS wardCode, A.HRGNUM_PUK AS patCrNo, A.HRGNUM_EPISODE_CODE AS episodeCode, A.HRGNUM_VISIT_NO AS episodeVisitNo, A.HRGNUM_ADMISSION_NO AS patAdmNo, TO_CHAR(A.GDT_RECIPIENT_DATE,'dd-Mon-yyyy hh24\:mi') AS recipientDate, (select distinct INITCAP(HRGSTR_FNAME||' '||HRGSTR_MNAME||' '||HRGSTR_LNAME) from hrgt_daily_patient_dtl where HRGNUM_PUK\=a.HRGNUM_PUK and GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) AS patName, (select TO_CHAR (hipdt_disdatetime, 'dd-Mon-yyyy') from hipt_patadmdisc_dtl WHERE gnum_isvalid \= 1 AND hipdt_disdatetime IS NOT NULL AND HRGNUM_PUK\=a.HRGNUM_PUK and HIPNUM_ADMNO\=a.HRGNUM_ADMISSION_NO) AS dischargedate FROM HPMRT_RECORD_DISPATCH_DTL A WHERE A.HPMRNUM_RECORD_TYPE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_RECORD_STATUS \= ? 
																

GENERATE_ID.HPMRT_MRD_RECORD_DTL = SELECT PKG_MRD_DTL.genMrdRecordId(?,?)FROM DUAL


#INSERT_ACCEPT_RECORD_IN_MRD.HPMRT_MRD_RECORD_DTL = INSERT INTO HPMRT_MRD_RECORD_DTL(HPMRSTR_RECORD_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HPMRNUM_RECORD_STATUS, HPMRNUM_MRD_CODE, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE, HRGNUM_EPISODE_CODE, GDT_ENTRY_DATE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO, HRGSTR_IP_ADD) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)\t
#modified by Prachi Tiwari on 17-Jan-2019
INSERT_ACCEPT_RECORD_IN_MRD.HPMRT_MRD_RECORD_DTL = INSERT INTO HPMRT_MRD_RECORD_DTL(HPMRSTR_RECORD_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HPMRNUM_RECORD_STATUS, HPMRNUM_MRD_CODE, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID,GNUM_HOSPITAL_CODE, HRGNUM_EPISODE_CODE, GDT_ENTRY_DATE, HRGNUM_VISIT_NO, HRGNUM_ADMISSION_NO) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?)\t

UPDATE_RECORD_STATUS.HPMRT_RECORD_DISPATCH_DTL = UPDATE HPMRT_RECORD_DISPATCH_DTL SET HPMRNUM_RECORD_STATUS = ? WHERE HPMRNUM_DISPATCH_ID = ?


INSERT.HPMRT_RECORD_LOSTFOUND_DTL = INSERT INTO HPMRT_RECORD_LOSTFOUND_DTL (HPMRNUM_DISPATCH_ID, HIPNUM_SLNO, HPMRDT_LOST_DATETIME, HPMRSTR_REPORTED_BY, HPMRNUM_MRD_CODE, HPMRDT_LASTSEEN_DATETIME, HPMRSTR_LOST_AREA, HPMRNUM_LOST_TYPE, HPMRSTR_LOST_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, HPMRDT_FOUND_DATETIME, HPMRSTR_FOUND_REMARKS, HPMRSTR_FOUND_BY, GSTR_IP_ADD) VALUES(?,(SELECT NVL(MAX(HIPNUM_SLNO),0)+1 FROM HPMRT_RECORD_LOSTFOUND_DTL WHERE HPMRNUM_DISPATCH_ID \= ?), SYSDATE,?,?,TO_DATE(?,'dd-Mon-yyyy HH24\:MI'),?,?,?,?,?,SYSDATE,?,?,?,?,?)


#GET_RECORD_TOBE_ARCHIVED_IN_MRD.HPMRT_MRD_RECORD_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HPMRNUM_RECORD_ID AS recordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HRGNUM_PUK AS patCrNo, (SELECT b.HRGSTR_FNAME||' '||b.HRGSTR_MNAME||' '||b.HRGSTR_LNAME FROM HRGT_PATIENT_DTL b  WHERE b.HRGNUM_PUK\=a.HRGNUM_PUK AND b.GNUM_ISVALID \= a.gnum_isvalid AND b.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE)patName, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate FROM HPMRT_MRD_RECORD_DTL A WHERE A.HPMRNUM_RECORD_TYPE \= ? AND A.HPMRNUM_RECORD_STATUS \= ? AND A.HPMRNUM_MRD_CODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?
#modified by Prachi Tiwari on 18-Jan-2019 to remove mRDcODE CHECK

GET_RECORD_TOBE_ARCHIVED_IN_MRD.HPMRT_MRD_RECORD_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HPMRNUM_RECORD_ID AS recordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HRGNUM_PUK AS patCrNo, (SELECT b.HRGSTR_FNAME||' '||b.HRGSTR_MNAME||' '||b.HRGSTR_LNAME FROM HRGT_PATIENT_DTL b  WHERE b.HRGNUM_PUK\=a.HRGNUM_PUK AND b.GNUM_ISVALID \= a.gnum_isvalid)patName, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, hrgnum_admission_no as patAdmNo, TO_CHAR (b.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'DD-Mon-YYYY hh24\:mi') AS disDateTime, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) )||'/'||(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS unitName, (SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= b.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) wardName FROM HPMRT_MRD_RECORD_DTL A, hipt_patadmdisc_dtl b WHERE A.HPMRNUM_RECORD_TYPE \= ? AND A.HPMRNUM_RECORD_STATUS \= ?  AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?  and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code \= b.gnum_hospital_code order by a.gdt_entry_date

#added by swati on date 10-may-2019
GET_RECORD_TOBE_ARCHIVED_IN_MRD.HPMRT_ADMNO_RECORD_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HPMRNUM_RECORD_ID AS recordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HRGNUM_PUK AS patCrNo, (SELECT b.HRGSTR_FNAME||' '||b.HRGSTR_MNAME||' '||b.HRGSTR_LNAME FROM HRGT_PATIENT_DTL b  WHERE b.HRGNUM_PUK\=a.HRGNUM_PUK AND b.GNUM_ISVALID \= a.gnum_isvalid)patName, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, hrgnum_admission_no as patAdmNo, TO_CHAR (b.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'DD-Mon-YYYY hh24\:mi') AS disDateTime, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) )||'/'||(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS unitName, (SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= b.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) wardName FROM HPMRT_MRD_RECORD_DTL A, hipt_patadmdisc_dtl b WHERE A.HRGNUM_ADMISSION_NO \= ? AND A.HPMRNUM_RECORD_STATUS \= ?  AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?  and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code \= b.gnum_hospital_code order by a.gdt_entry_date


#added by swati on date 13-may-2019
GET_RECORD_TOBE_ARCHIVED_IN_MRD.HPMRT_CRNO_RECORD_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HPMRNUM_RECORD_ID AS recordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HRGNUM_PUK AS patCrNo, (SELECT b.HRGSTR_FNAME||' '||b.HRGSTR_MNAME||' '||b.HRGSTR_LNAME FROM HRGT_PATIENT_DTL b  WHERE b.HRGNUM_PUK\=a.HRGNUM_PUK AND b.GNUM_ISVALID \= a.gnum_isvalid)patName, TO_CHAR(A.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate, hrgnum_admission_no as patAdmNo, TO_CHAR (b.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'DD-Mon-YYYY hh24\:mi') AS disDateTime, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) )||'/'||(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS unitName, (SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= b.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=1) wardName FROM HPMRT_MRD_RECORD_DTL A, hipt_patadmdisc_dtl b WHERE A.hrgnum_puk \= ? AND A.HPMRNUM_RECORD_STATUS \= ?  AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?  and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code \= b.gnum_hospital_code order by a.gdt_entry_date



UPDATE_RECORD_ARCHIVAL_DETAIL.HPMRT_MRD_RECORD_DTL = UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_RECORD_STATUS \= ?, HPMRNUM_RACK_ID \= ?, HPMRNUM_SHELF_ID \= ?, HPMRSTR_PUT_BY \= ? WHERE HPMRNUM_MRD_RECORD_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?

UPDATE.RECORD_STATUS.HPMRT_MRD_RECORD_DTL = UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_RECORD_STATUS = ? WHERE HPMRNUM_MRD_RECORD_ID = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?

GET_LOST_RECORD_LIST.HPMRT_RECORD_LOSTFOUND_DTL = SELECT A.HPMRNUM_DISPATCH_ID AS dispatchId, A.HPMRSTR_REPORTED_BY AS reportedBy1,(SELECT c.str_emp_full_name FROM PIST_EMP_registration_DTL c WHERE c.str_emp_no \= a.hpmrstr_reported_by AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid)reportedby, TO_CHAR(A.HPMRDT_LASTSEEN_DATETIME,'dd-Mon-yyyy HH24\:MI') AS lastSeenDateTime, A.HPMRSTR_LOST_AREA AS lostArea, DECODE(A.HPMRNUM_LOST_TYPE,1,'Partial',2,'Complete') AS lostType ,TO_CHAR(HPMRDT_LOST_DATETIME,'dd-Mon-yyyy HH24\:MI') AS lostDateTime, b.HPMRSTR_RECORD_ID as recordDesc, b.HPMRNUM_RECORD_ID as recordId, a.HIPNUM_SLNO as slNo, B.HRGNUM_PUK AS patCrNo, B.HRGNUM_EPISODE_CODE AS episodeCode, B.HRGNUM_VISIT_NO AS episodeVisitNo, B.HRGNUM_ADMISSION_NO AS patAdmNo FROM HPMRT_RECORD_LOSTFOUND_DTL A,HPMRT_RECORD_DISPATCH_DTL B WHERE A.HPMRNUM_MRD_CODE \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_DISPATCH_ID\=B.HPMRNUM_DISPATCH_ID AND B.HPMRNUM_RECORD_TYPE \= ? AND b.HPMRNUM_RECORD_STATUS \= ? AND A.HIPNUM_SLNO\=(SELECT MAX(C.HIPNUM_SLNO) FROM HPMRT_RECORD_LOSTFOUND_DTL C WHERE A.HPMRNUM_DISPATCH_ID\=B.HPMRNUM_DISPATCH_ID) 


UPDATE_FOUND_DETAIL.HPMRT_RECORD_LOSTFOUND_DTL = UPDATE HPMRT_RECORD_LOSTFOUND_DTL SET HPMRDT_FOUND_DATETIME \= TO_DATE(?,'dd-Mon-yyyy HH24\:MI'), GNUM_LSTMOD_SEATID \= ?, HPMRSTR_FOUND_REMARKS \= ?, HPMRSTR_FOUND_BY \= ?, GDT_LSTMOD_DATE \=SYSDATE WHERE HPMRNUM_DISPATCH_ID \= ? AND HIPNUM_SLNO \= ?

GET_ALL_ACCEPTED_ENCLOSURE_BY_DISPATCHID.HPMRT_RECORD_ENCLOSURE_SUMMARY = SELECT A.HPMRNUM_ENCLOSURE_ID AS enclosureId, NVL(A.HPMRNUM_PAGES_DISPATCH,'0') AS pages,  NVL(A.HPMRNUM_VERIFY_BYPEON,'0') AS verifiedByPeon, NVL(A.HPMRNUM_VERIFYBY_MRD,'0') AS verifiedByMrd, (SELECT c.hpmrstr_enclosure FROM hpmrt_record_enclosure_mst b, hpmrt_enclosure_mst c WHERE b.hpmrnum_enclosure_id \= a.hpmrnum_enclosure_id AND b.gnum_isvalid \= a.gnum_isvalid  AND b.gnum_hospital_code \= ? AND b.hpmrnum_record_type \= a.hpmrnum_record_type and  b.hpmrnum_enclosure_id \= c.hpmrnum_enclosure_id  and b.gnum_isvalid\=c.gnum_isvalid and c.gnum_hospital_code\=?) AS enclosure FROM HPMRT_RECORD_ENCLOSURE_SUMMARY A WHERE A.HPMRNUM_DISPATCH_ID \= ? AND A.GNUM_ISVALID \= ? AND A.HPMRNUM_RECORD_TYPE \= ?  order by enclosure

#Modified by Prachi on 22-jan-2019
SEARCH_PATIENT_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL =  SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,b.gstr_gender_code AS gstr_gender_name, ahis_util.dob_age_on (B.hrgdt_dob, SYSDATE) AS patage,a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,(SELECT gstr_country_name FROM GBLT_COUNTRY_MST where gnum_country_code\=a.GNUM_COUNTRY_CODE  AND GNUM_ISVALID\=?) as gstr_countryname,(SELECT gstr_state_name FROM GBLT_STATE_MST where gnum_state_code\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null
#SEARCH_PATIENT_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL = SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,a.hrgstr_sex,(SELECT GSTR_GENDER_CODE FROM gblt_gender_mst WHERE GSTR_GENDER_CODE \= a.hrgstr_sex  and GNUM_ISVALID\=?) AS gstr_gender_name, a.hrgnum_age,a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,(SELECT gstr_country_name FROM GBLT_COUNTRY_MST where gnum_country_code\=a.GNUM_COUNTRY_CODE  AND GNUM_ISVALID\=?) as gstr_countryname,(SELECT gstr_state_name FROM GBLT_STATE_MST where gnum_state_code\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null
#SEARCH_PATIENT_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL  =  SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,b.gstr_gender_code AS gstr_gender_name, a.hrgnum_age,ahis_util.dob_age_on (B.hrgdt_dob, SYSDATE) AS PATAGE,a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,b.gstr_country_name as gstr_countryname,(SELECT gstr_state_name FROM GBLT_STATE_MST where gnum_state_code\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? and HPMRNUM_MRD_RECORD_ID\=c.HPMRNUM_MRD_RECORD_ID) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null
SELECT_RECORD_STORAGE.HPMRT_MRD_RECORD_DTL =SELECT hpmrnum_mrd_record_id as mrdRecordId, hpmrnum_record_type as recordType,(SELECT INITCAP (hpmrstr_mrd_name) FROM hpmrt_mrd_mst WHERE hpmrnum_mrd_code \= b.hpmrnum_mrd_code AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_isvalid \= ?) AS mrdname,b.hpmrnum_rack_id as rackId,(SELECT HPMRSTR_RACK_NAME FROM HPMRT_RACK_MST a WHERE a.hpmrnum_rack_id\=b.hpmrnum_rack_id AND a.gnum_hospital_code\=b.gnum_hospital_code AND a.gnum_isvalid\=? ) as rackLabel, b.hpmrnum_shelf_id as ShelfId,(SELECT HMPRSTR_SHELF_LABEL FROM HPMRT_RACK_SHELF_MST f WHERE f.HPMRNUM_RACKSHELF_ID\=b.hpmrnum_shelf_id AND f.gnum_hospital_code\=b.gnum_hospital_code AND f.gnum_isvalid\=?) as ShelfName, (SELECT    (SELECT b.str_building_name FROM est_building_mst b WHERE b.num_building_code \= a.num_building_code  AND b.gnum_isvalid \= a.gnum_isvalid) || ' , '|| (SELECT c.str_block_name FROM est_block_mst c WHERE c.num_block_id \= a.num_block_id AND c.num_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid) || ' , ' || (SELECT d.str_floor_name FROM est_floor_mst d WHERE d.num_floor_id \= a.num_floor_id AND d.num_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid) || ' , ' || (SELECT e.num_room_number FROM est_room_mst e WHERE e.num_room_id \= a.num_room_id AND e.num_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid)  FROM hpmrt_rack_mst a WHERE a.hpmrnum_rack_status \= ? AND a.hpmrnum_mrd_code \= b.hpmrnum_mrd_code AND a.hpmrnum_rack_id\=b.hpmrnum_rack_id AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= b.gnum_hospital_code) as racklocation, hpmrnum_record_status as recordStatus  FROM hpmrt_mrd_record_dtl b WHERE HPMRNUM_MRD_RECORD_ID\=? AND gnum_isvalid \= ? AND gnum_hospital_code \= ? AND hpmrnum_record_type IN (?, ?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
																																							
#modified by:NehaRajgariya Date:9march2017 Purpose:-changing column name as per table in DB                     											 
SEARCH_CHRONIC_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL = SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,a.hrgstr_sex,(SELECT GSTR_GENDER_CODE FROM gblt_gender_mst WHERE GSTR_GENDER_CODE \= a.hrgstr_sex  and GNUM_ISVALID\=?) AS gstr_gender_name, a.hrgnum_age,a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,(SELECT GSTR_COUNTRY_NAME FROM GBLT_COUNTRY_MST where GSTR_COUNTRY_CODE\=a.GNUM_COUNTRY_CODE  AND GNUM_ISVALID\=?) as gstr_countryname,(SELECT GSTR_STATE_NAME FROM GBLT_STATE_MST where GNUM_STATE_CODE\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null AND c.hrgnum_puk IN (SELECT HRGNUM_PUK FROM HPMRT_PAT_ALERTS_DTL WHERE HRGNUM_PUK\=c.HRGNUM_PUK AND GNUM_HOSPITAL_CODE\=c.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND HGNUM_PAT_ALERT_ID\=?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

#modified by:NehaRajgariya Date:9march2017 Purpose:-changing column name as per table in DB                     											 
SEARCH_ALLERGY_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL = SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,a.hrgstr_sex,(SELECT GSTR_GENDER_CODE FROM gblt_gender_mst WHERE GSTR_GENDER_CODE \= a.hrgstr_sex AND  GNUM_ISVALID\=?) AS gstr_gender_name, a.hrgnum_age,a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,(SELECT gstr_country_name FROM GBLT_COUNTRY_MST where gstr_country_code\=a.GNUM_COUNTRY_CODE  AND GNUM_ISVALID\=?) as gstr_countryname,(SELECT gstr_state_name FROM GBLT_STATE_MST where gnum_state_code\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null AND c.hrgnum_puk IN (SELECT HRGNUM_PUK FROM HPMRT_PAT_ALLERGY_DTL WHERE HRGNUM_PUK\=c.HRGNUM_PUK AND GNUM_HOSPITAL_CODE\=c.GNUM_HOSPITAL_CODE AND GNUM_ISVALID\=? AND HGNUM_ALLERGY_TYPE_CODE\=?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
																			



UPDATE_PAGES_IN_MRD.HPMRT_RECORD_ENCLOSURE_SUMMARY = UPDATE HPMRT_RECORD_ENCLOSURE_SUMMARY SET HPMRNUM_VERIFYBY_MRD = ? WHERE HPMRNUM_DISPATCH_ID = ? AND HPMRNUM_RECORD_TYPE = ? AND HPMRNUM_ENCLOSURE_ID = ?


GET_CHECKED_CHECKLIST_BY_DISPATCHID.HPMRT_RECORD_CHECKLIST_DTL = SELECT a.HPMRNUM_CHECKLIST_ID AS checkListId, a.HPMRNUM_CHECKLIST_BY AS checkListBy FROM HPMRT_RECORD_CHECKLIST_DTL a WHERE a.HPMRNUM_DISPATCH_ID\= ? AND a.GNUM_ISVALID \= ? AND a.GNUM_HOSPITAL_CODE \= ?
																									

//-----------------------------------------------Case_sheet_handover------------------------------------------------------------------------------
#Modified by Prachi on 15.Jan.19 to get Episode code and episode visit no
#SELECT.FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, hgnum_deptunitcode deptunitcode, gnum_dept_code deptcode, hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hgnum_deptunitcode AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward,HPMRSTR_DELAY_REASON delayReason FROM hpmrt_record_dispatch_dtl a  WHERE hpmrnum_record_status \= ?  AND gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND hgnum_deptunitcode \= ? AND hipnum_ward_code \= ?  order by patName
#SELECT.FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, hgnum_deptunitcode deptunitcode, gnum_dept_code deptcode, hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hgnum_deptunitcode AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason FROM hpmrt_record_dispatch_dtl a  WHERE hpmrnum_record_status \= ?  AND gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND hgnum_deptunitcode \= ? AND hipnum_ward_code \= ?  order by patName
 SELECT.FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, gnum_deptunit_code deptunitcode, b.gnum_dept_code deptcode, a.hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason , TO_CHAR (b.hipdt_admdatetime, 'yyyy-mm-dd hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'yyyy-mm-dd hh24\:mi') AS dischargeDate, TO_CHAR (a.gdt_sender_date, 'yyyy-mm-dd hh24\:mi') AS sendDateTime, NVL(TO_CHAR(a.gdt_arroved_date, 'yyyy-mm-dd hh24\:mi'),'-') AS approvedDate,(SELECT gstr_usr_name FROM gblt_user_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_userid \= a.gnum_sender_seatid) AS readyBy FROM hpmrt_record_dispatch_dtl a, hipt_patadmdisc_dtl b   WHERE hpmrnum_record_status \= ?  AND a.gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND b.gnum_deptunit_code like ? AND a.hipnum_ward_code \= ? and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code   \= b.gnum_hospital_code order by patName
 
 #ADDED BY SWATI SAGAR ON DATE:06-05-2019
 SELECT.FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL_ADMNOWISE	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, gnum_deptunit_code deptunitcode, b.gnum_dept_code deptcode, a.hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason , TO_CHAR (b.hipdt_admdatetime, 'yyyy-mm-dd hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'yyyy-mm-dd hh24\:mi') AS dischargeDate, TO_CHAR (a.gdt_sender_date, 'yyyy-mm-dd hh24\:mi') AS sendDateTime, NVL(TO_CHAR(a.gdt_arroved_date, 'yyyy-mm-dd hh24\:mi'),'-') AS approvedDate,(SELECT gstr_usr_name FROM gblt_user_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_userid \= a.gnum_sender_seatid) AS readyBy FROM hpmrt_record_dispatch_dtl a, hipt_patadmdisc_dtl b   WHERE  a.gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?)  AND a.hrgnum_admission_no \= ? and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code   \= b.gnum_hospital_code order by patName
 
 
  #ADDED BY SWATI SAGAR ON DATE:07-05-2019
  SELECT.FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL_CRNOWISE	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, gnum_deptunit_code deptunitcode, b.gnum_dept_code deptcode, a.hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason , TO_CHAR (b.hipdt_admdatetime, 'yyyy-mm-dd hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'yyyy-mm-dd hh24\:mi') AS dischargeDate, TO_CHAR (a.gdt_sender_date, 'yyyy-mm-dd hh24\:mi') AS sendDateTime, NVL(TO_CHAR(a.gdt_arroved_date, 'yyyy-mm-dd hh24\:mi'),'-') AS approvedDate,(SELECT gstr_usr_name FROM gblt_user_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_userid \= a.gnum_sender_seatid) AS readyBy FROM hpmrt_record_dispatch_dtl a, hipt_patadmdisc_dtl b   WHERE  a.gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?)  AND a.hrgnum_puk \= ? and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code   \= b.gnum_hospital_code order by patName
 
 
# SELECT.FOR_CASESHEET_HANDOVER_BY_PATCRNO.HPMRT_RECORD_DISPATCH_DTL	=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, hgnum_deptunitcode deptunitcode, gnum_dept_code deptcode, hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ?  AND b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hgnum_deptunitcode AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward,HPMRSTR_DELAY_REASON delayReason FROM hpmrt_record_dispatch_dtl a  WHERE hpmrnum_record_status \= ?  AND gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND hrgnum_puk\= ? order by HRGNUM_ADMISSION_NO 
  SELECT.FOR_CASESHEET_HANDOVER_BY_PATCRNO.HPMRT_RECORD_DISPATCH_DTL = SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, b.gnum_deptunit_code deptunitcode, b.gnum_dept_code deptcode, a.hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason , TO_CHAR (b.hipdt_admdatetime, 'dd-Mon-yyyy hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'DD-Mon-YYYY hh24\:mi') AS dischargeDate, TO_CHAR (a.gdt_sender_date, 'DD-Mon-YYYY hh24\:mi') AS sendDateTime, NVL(TO_CHAR(a.gdt_arroved_date, 'DD-Mon-YYYY hh24\:mi'),'-') AS approvedDate,(SELECT gstr_usr_name FROM gblt_user_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_userid \= a.gnum_sender_seatid) AS readyBy  FROM hpmrt_record_dispatch_dtl a, hipt_patadmdisc_dtl b   WHERE hpmrnum_record_status \= ?  AND a.gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND a.hrgnum_puk\= ? and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code   \= b.gnum_hospital_code order by HRGNUM_ADMISSION_NO 
  

SELECT.BY_RECORD_TYPE.HPMRT_RECORD_TYPE_CHECKLIST	=SELECT a.HPMRNUM_CHECKLIST_ID AS checklistId,(SELECT hpmrstr_checklist FROM hpmrt_checklist_mst WHERE hpmrnum_checklist_id \= a.hpmrnum_checklist_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= ?) AS checklistname, HPMRNUM_ISCOMPULSORY as isCompulsory FROM HPMRT_RECORD_TYPE_CHECKLIST a WHERE a.GNUM_ISVALID\=? AND a.GNUM_HOSPITAL_CODE\=? AND a.HPMRNUM_RECORD_TYPE\=? and HPMRNUM_CHECKLIST_MODE\=? order by HPMRNUM_DISPLAY_ORDER\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
		
UPDATE.VERIFY_BY_PEON.HPMRT_RECORD_ENCLOSURE_SUMMARY	=	UPDATE hpmrt_record_enclosure_summary SET HPMRNUM_VERIFY_BYPEON = ? WHERE HPMRNUM_DISPATCH_ID=? and HPMRNUM_ENCLOSURE_ID=? AND gnum_isvalid = ?


UPDATE_FOR_CASESHEET_HANDOVER.HPMRT_RECORD_DISPATCH_DTL	=UPDATE HPMRT_RECORD_DISPATCH_DTL SET HPMRNUM_RECORD_STATUS \= ?, HPMRSTR_SENDER_EMPNO\=?,GNUM_RECIPIENT_SEATID\=? , GDT_RECIPIENT_DATE\=sysdate,  HPMRSTR_RECIPENT_EMPNO\=? WHERE HPMRNUM_DISPATCH_ID \= ? and GNUM_HOSPITAL_CODE\=?


INSERT.HPMRT_RECORD_ENCLOSURE_DTL = INSERT INTO HPMRT_RECORD_ENCLOSURE_DTL (HPMRNUM_MRD_RECORD_ID, HPMRNUM_ENCLOSURE_ID, HPMRNUM_SLNO, HPMRNUM_PAGES, HIPNUM_ISLOST, HPMRSTR_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE)VALUES(?,?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_RECORD_ENCLOSURE_DTL WHERE HPMRNUM_MRD_RECORD_ID \= ? AND HPMRNUM_ENCLOSURE_ID \= ? ),?,?,?,?,?,SYSDATE)


GET_REQUEST_PURPOSE.HPMRT_REQ_PURPOSE_MST = SELECT A.HPMRNUM_REQ_PURPOSE_ID AS reqPurposeId, A.HPMRSTR_PURPOSE AS purpose, A.HPMRNUM_PRIORITY AS priority FROM HPMRT_REQ_PURPOSE_MST A WHERE A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_RECORD_TYPE \= ? AND A.HPMRNUM_SLNO\=(SELECT MAX(B.HPMRNUM_SLNO) FROM HPMRT_REQ_PURPOSE_MST B WHERE B.HPMRNUM_REQ_PURPOSE_ID\=A.HPMRNUM_REQ_PURPOSE_ID AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE) ORDER BY A.HPMRSTR_PURPOSE

												
INSERT.HPMRT_MRDRECORD_REQ_DTL = INSERT INTO HPMRT_MRDRECORD_REQ_DTL (HPMRNUM_REQ_ID, HPMRDT_REQ_DATE, HPMRNUM_MRD_CODE, HPMRNUM_RECORD_TYPE, \
								HPMRSTR_REMARKS, HPMRNUM_REQ_PURPOSE_ID, HPMRNUM_REQ_STATUS, HPMRNUM_REQ_MODE, HPMRNUM_FOR_DAYS, GNUM_ISVALID, \
								HPMRNUM_ISSUE_UPTO, HPMRSTR_REQ_BY, HPMRSTR_CANCEL_REASON, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, HPMRSTR_APPROVED_BY, \
								GDT_ENTRY_DATE, HRGSTR_IP_ADD, GNUM_APPROVEDSEAT_ID, GDT_APPROVED_DATE,hpmrstr_req_by_name,hpmrnum_req_by_flag)VALUES(?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,SYSDATE,?,?)


INSERT_ONLINE.HPMRT_MRDRECORD_REQ_DTL = INSERT INTO HPMRT_MRDRECORD_REQ_DTL(HPMRNUM_REQ_ID, HPMRDT_REQ_DATE, HPMRNUM_MRD_CODE, HPMRNUM_RECORD_TYPE, \
											HPMRSTR_REMARKS, HPMRNUM_REQ_PURPOSE_ID, HPMRNUM_REQ_STATUS, HPMRNUM_REQ_MODE, HPMRNUM_FOR_DAYS, GNUM_ISVALID, \
											HPMRSTR_REQ_BY, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, hpmrnum_req_by_flag,hpmrstr_req_by_name, HPMRSTR_DESIGNATED_APPROVED_BY)VALUES(?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,0,pkg_clinical_gbl_fun.get_emp_name(?,?),?)


INSERT_ONLINE.HPMRT_MRDRECORD_REQ_DTL = INSERT INTO HPMRT_MRDRECORD_REQ_DTL(HPMRNUM_REQ_ID, HPMRDT_REQ_DATE, HPMRNUM_MRD_CODE, HPMRNUM_RECORD_TYPE, \
											HPMRSTR_REMARKS, HPMRNUM_REQ_PURPOSE_ID, HPMRNUM_REQ_STATUS, HPMRNUM_REQ_MODE, HPMRNUM_FOR_DAYS, GNUM_ISVALID, \
											HPMRSTR_REQ_BY, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, hpmrnum_req_by_flag,hpmrstr_req_by_name, HPMRSTR_DESIGNATED_APPROVED_BY)VALUES(?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,0,pkg_clinical_gbl_fun.get_emp_name(?,?),?)
#added by swati on date:27-02-2019
INSERT.ICD_INDEX_DTL=INSERT INTO hpmrt_pat_diagnosis_dtl(hrgnum_puk,hrgnum_episode_code,hrgnum_visit_no,hrgnum_s_no,hipnum_admno,gnum_dept_code,gstr_dept_name,hgnum_deptunitcode,hgstr_unitname,gnum_isvalid,gnum_seat_id,hipnum_ward_code ,gdt_entry_date ,hipstr_ward_name,hgnum_room_code ,gnum_hospital_code ,hgstr_room_name ,gnum_entry_source,gstr_ip_add,\
                      gstr_entry_source_ref_id ,gstr_entry_source_ref_name ,hrgstr_disease_code ,hrgstr_disease_name ,gnum_lstmod_action ,gdt_lstmod_date ,gnum_lstmod_seatid ,hrgstr_pat_name character ,hgnum_patient_cat_code ,gstr_patient_cat_name ,hrgstr_national_id ,gstr_gender_code,hrgdt_dob ,gnum_religion_code,gstr_religion_name,num_caste_id,str_caste_name,\
                      hbnum_bldgrp_code,hbstr_bldgrp,hrgnum_isnewborn ,hrgnum_is_dead,  gnum_nationality ,hrgnum_is_urban,gstr_country_code,  gstr_country_name ,gnum_state_code,hrgstr_state_name,gnum_district_code,hrgstr_district,hrgnum_pincode,hrgstr_city,hrgstr_city_location,

INSERT_ONLINE_APPROVED.HPMRT_MRDRECORD_REQ_DTL = INSERT INTO HPMRT_MRDRECORD_REQ_DTL(HPMRNUM_REQ_ID, HPMRDT_REQ_DATE, HPMRNUM_MRD_CODE, HPMRNUM_RECORD_TYPE, \
											HPMRSTR_REMARKS, HPMRNUM_REQ_PURPOSE_ID, HPMRNUM_REQ_STATUS, HPMRNUM_REQ_MODE, HPMRNUM_FOR_DAYS, GNUM_ISVALID, \
											HPMRSTR_REQ_BY, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, hpmrnum_req_by_flag,hpmrstr_req_by_name, HPMRSTR_DESIGNATED_APPROVED_BY, gdt_approved_date)VALUES(?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,0,pkg_clinical_gbl_fun.get_emp_name(?,?),?,SYSDATE)


#UPDATE.HPMRT_MRDRECORD_REQ_DTL	=update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_REQ_STATUS\=?,HPMRNUM_ISSUE_UPTO\=?, HPMRSTR_CANCEL_REASON\=?, HPMRSTR_APPROVED_BY\=?, GNUM_APPROVEDSEAT_ID\=?, GDT_APPROVED_DATE\=sysdate where HPMRNUM_REQ_ID\=? and GNUM_HOSPITAL_CODE\=?

UPDATE.HPMRT_MRDRECORD_REQ_DTL	=update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_REQ_STATUS\=decode((select count(*) from HPMRT_REQ_RECORD_DTL where HPMRNUM_REQ_ID\=? and HPMRNUM_REQ_STATUS not in(3,6,8)),0,3,2),HPMRNUM_ISSUE_UPTO\=?, HPMRSTR_CANCEL_REASON\=?, HPMRSTR_APPROVED_BY\=?, GNUM_APPROVEDSEAT_ID\=?, GDT_APPROVED_DATE\=sysdate where HPMRNUM_REQ_ID\=? and GNUM_HOSPITAL_CODE\=?


UPDATE.REJECT_DETAIL.HPMRT_MRDRECORD_REQ_DTL	=	update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_REQ_STATUS=?, HPMRSTR_CANCEL_REASON=? where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?


INSERT.HPMRT_REQ_RECORD_DTL = INSERT INTO HPMRT_REQ_RECORD_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HRGNUM_ADMISSION_NO, HPMRNUM_REQ_STATUS, HPMRNUM_MRD_CODE, HPMRNUM_REQ_PURPOSE_ID, GNUM_ISVALID, HRGNUM_PUK, HPMRSTR_CANCEL_REASON, GNUM_SEAT_ID, HPMRSTR_APPROVED_BY, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, GNUM_APPROVEDSEAT_ID, HRGSTR_IP_ADD, GDT_APPROVED_DATE,gnum_deptunit_code)VALUES(?,?,?,?,?,?,decode((select count(*) from hgbt_unit_consultant_mst where hgstr_emp_code\=? and hgnum_hierarchy_level IN(1,2,3,4,5) and hgnum_deptunitcode\=? and gnum_hospital_code\=? and gnum_isvalid\=1 ),0,1,2),?,?,?,?,?,?,?,?,SYSDATE,?,?,SYSDATE,?)
								
UPDATE.HPMRT_REQ_RECORD_DTL	=update HPMRT_REQ_RECORD_DTL set HPMRNUM_REQ_STATUS\=?, HPMRSTR_CANCEL_REASON\=?, HPMRSTR_APPROVED_BY\=?, GNUM_APPROVEDSEAT_ID\=?, GDT_APPROVED_DATE\=sysdate where HPMRNUM_REQ_ID\=? and HPMRNUM_MRD_RECORD_ID\=? and GNUM_HOSPITAL_CODE\=?

UPDATE.REJECT_DETAIL.HPMRT_REQ_RECORD_DTL	=	update HPMRT_REQ_RECORD_DTL set HPMRNUM_REQ_STATUS=?, HPMRSTR_CANCEL_REASON=? where HPMRNUM_REQ_ID=? and HPMRNUM_MRD_RECORD_ID=? and GNUM_HOSPITAL_CODE=?		

#modified by:NehaRajgariya Date:9march2017 Purpose:-changing column name as per table in DB                     											 
#edited by sandip naik on 20/7/17 for deptunit
SEARCH_RECORD_FOR_RECORD_REQUEST = SELECT a.hrgnum_puk, a.hipnum_admno, a.hrgnum_mlc_no, INITCAP (b.hrgstr_fname) AS hrgstr_fname, INITCAP (b.hrgstr_mname) AS hrgstr_mname, INITCAP (b.hrgstr_lname) AS hrgstr_lname, a.hrgstr_sex, (SELECT GSTR_GENDER_CODE FROM GBLT_GENDER_MST WHERE GSTR_GENDER_CODE \= b.GSTR_GENDER_CODE AND gnum_isvalid \= ? AND ROWNUM \= 1) AS gstr_gender_name, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) as hrgnum_age, a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code, a.hrgstr_city, a.gnum_dept_code as deptcode, (select a.gnum_deptunit_code) as deptUnit, a.hipdt_admstatus_code, TO_CHAR(a.hipdt_admdatetime,'dd-Mon-yyyy HH24\:MI'), TO_CHAR(a.hipdt_disdatetime,'dd-Mon-yyyy HH24\:Mi'), (SELECT hgstr_discharge_desc FROM HIPT_DISCHARGE_TYPE_MST WHERE hgnum_disharge_type_code \= a.hipdt_disstatus_code AND gnum_hospital_code \= ? AND gnum_isvalid \= ? AND ROWNUM \= 1) dischargetype, (SELECT COUNT (*) FROM HPMRT_MRD_RECORD_DTL WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? AND ROWNUM \= 1) AS COUNT, (SELECT hpmrnum_record_status FROM HPMRT_MRD_RECORD_DTL WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? AND ROWNUM \= 1) AS recordstatus, (SELECT HPMRNUM_MRD_RECORD_ID FROM HPMRT_MRD_RECORD_DTL WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? AND ROWNUM \= 1) AS mrdRecordId, (select gstr_dept_name from gblt_department_mst c where c.gnum_dept_code \= a.gnum_dept_code and c.gnum_hospital_code \= a.gnum_hospital_code) as deptname, (select HGSTR_UNITNAME from HGBT_UNIT_MST d where d.HGNUM_DEPTUNITCODE \= a.gnum_deptunit_code and d.gnum_hospital_code \= a.gnum_hospital_code) as deptunitname, (select  upper(d.str_emp_full_name) from pist_emp_registration_dtl d where d.gnum_desig_code \= 142 AND d.gnum_dept_code\=a.gnum_dept_code AND  d.gnum_hospital_code \= a.gnum_hospital_code) hodName FROM HIPT_PATADMDISC_DTL a, HRGT_PATIENT_DTL b WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hrgnum_puk \= b.hrgnum_puk AND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_isvalid \= ? AND (SELECT hpmrnum_record_status FROM HPMRT_MRD_RECORD_DTL WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? AND ROWNUM \= 1) IN (?,?) AND (SELECT HPMRNUM_RECORD_TYPE FROM HPMRT_MRD_RECORD_DTL WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? AND ROWNUM \= 1)\= ? 

SEARCH_RECORD_FOR_RECORD_REQUEST_NEW = SELECT a.hrgnum_puk, a.hipnum_admno, a.hrgnum_mlc_no, INITCAP (b.hrgstr_fname) AS hrgstr_fname, INITCAP (b.hrgstr_mname) AS hrgstr_mname, INITCAP (b.hrgstr_lname) AS hrgstr_lname, a.hrgstr_sex,(SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code \= a.hrgstr_sex AND gnum_isvalid \= c.gnum_isvalid) AS gstr_gender_name, a.hrgnum_age, a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code, a.hrgstr_city, a.gnum_dept_code,a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR (a.hipdt_admdatetime,'dd-Mon-yyyy HH24\:MI' ) AS hipdt_admdatetime,TO_CHAR (a.hipdt_disdatetime,'dd-Mon-yyyy HH24\:MI') AS hipdt_disdatetime,a.gnum_state_code, a.gnum_country_code,(SELECT gstr_countryname FROM gblt_country_mst WHERE gnum_countrycode \= a.gnum_country_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) AS gstr_countryname, (SELECT gstr_statename FROM gblt_state_mst WHERE gnum_statecode \= a.gnum_state_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) AS hrgstr_state_name,(SELECT hgstr_discharge_desc FROM hipt_discharge_type_mst WHERE hgnum_disharge_type_code \= a.hipdt_disstatus_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) dischargetype,(SELECT COUNT (*) FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) AS COUNT, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid),0) AS recordstatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) AS recordtype,(SELECT hpmrnum_mrd_record_id FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code  AND gnum_isvalid \= c.gnum_isvalid) AS mrdrecordid,(SELECT INITCAP (hpmrstr_mrd_name) FROM hpmrt_mrd_mst WHERE hpmrnum_mrd_code \= c.hpmrnum_mrd_code AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid) AS mrdname, c.hpmrnum_rack_id AS rackid,(SELECT hpmrstr_rack_name FROM hpmrt_rack_mst a WHERE a.hpmrnum_rack_id \= c.hpmrnum_rack_id AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_isvalid \= c.gnum_isvalid) AS racklabel,c.hpmrnum_shelf_id AS shelfid,(SELECT hmprstr_shelf_label FROM hpmrt_rack_shelf_mst f WHERE f.hpmrnum_rackshelf_id \= c.hpmrnum_shelf_id AND f.gnum_hospital_code \= b.gnum_hospital_code AND f.gnum_isvalid \= c.gnum_isvalid) AS shelfname, (SELECT (SELECT b.str_building_name FROM est_building_mst b  WHERE b.num_building_code \= a.num_building_code AND b.num_hospital_code \= a.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid)|| ' , '|| (SELECT c.str_block_name FROM est_block_mst c  WHERE c.num_block_id \= a.num_block_id AND c.num_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid)
               || ' , ' || (SELECT d.str_floor_name    FROM est_floor_mst d WHERE d.num_floor_id \= a.num_floor_id AND d.num_hospital_code \= a.gnum_hospital_code AND d.gnum_isvalid \= a.gnum_isvalid) || ' , ' || (SELECT e.num_room_number FROM est_room_mst e WHERE e.num_room_id \= a.num_room_id AND e.num_hospital_code \= a.gnum_hospital_code AND e.gnum_isvalid \= a.gnum_isvalid) FROM hpmrt_rack_mst a WHERE a.hpmrnum_rack_status \= 1 AND a.hpmrnum_mrd_code \= c.hpmrnum_mrd_code AND a.gnum_isvalid \= c.gnum_isvalid AND a.gnum_hospital_code \= b.gnum_hospital_code) AS racklocation FROM hipt_patadmdisc_dtl a, hrgt_patient_dtl b, hpmrt_mrd_record_dtl c WHERE a.gnum_isvalid \= 1 AND a.gnum_hospital_code \= ? AND a.hrgnum_puk \= b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk AND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code AND b.gnum_isvalid \= c.gnum_isvalid AND a.gnum_isvalid \= c.gnum_isvalid AND hipdt_disdatetime IS NOT NULL and HPMRNUM_RECORD_STATUS in (1,2) AND hipdt_disdatetime > TRUNC (TO_DATE ('08-Nov-2008', 'dd-mm-yyyy')) ORDER BY TRIM (b.hrgstr_fname), TRIM (b.hrgstr_mname), TRIM (b.hrgstr_lname)
									


GENERATE_REQUEST_ID.HPMRT_MRDRECORD_REQ_DTL = SELECT PKG_MRD_DTL.genMrdRecordReqId(?)FROM DUAL

#edited by sandip naik on 20/7/17 to insert deptunitcode
INSERT_ONLINE.HPMRT_REQ_RECORD_DTL = INSERT INTO HPMRT_REQ_RECORD_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HRGNUM_ADMISSION_NO, HPMRNUM_REQ_STATUS, HPMRNUM_MRD_CODE, HPMRNUM_REQ_PURPOSE_ID, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD,GNUM_DEPTUNIT_CODE)VALUES(?,?,?,?,?,?,decode((select count(*) from hgbt_unit_consultant_mst where hgstr_emp_code\=? and hgnum_hierarchy_level IN(1,2,3,4,5) and hgnum_deptunitcode\=? and gnum_hospital_code\=? and gnum_isvalid\=1 ),0,1,2),?,?,?,?,?,?,SYSDATE,?,?)

#INSERT_ONLINE.HPMRT_REQ_RECORD_DTL = INSERT INTO HPMRT_REQ_RECORD_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, \
#										HPMRSTR_REMARKS, HRGNUM_ADMISSION_NO, HPMRNUM_REQ_STATUS, HPMRNUM_MRD_CODE, HPMRNUM_REQ_PURPOSE_ID, GNUM_ISVALID, \
#										HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
#
									 

#INSERT_ONLINE_APPROVED.HPMRT_REQ_RECORD_DTL = INSERT INTO HPMRT_REQ_RECORD_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, \
										#HPMRSTR_REMARKS, HRGNUM_ADMISSION_NO, HPMRNUM_REQ_STATUS, HPMRNUM_MRD_CODE, HPMRNUM_REQ_PURPOSE_ID, GNUM_ISVALID, \
										#HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD, GDT_APPROVED_DATE)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,SYSDATE)
#added by sandip naik on 16/8/2017
INSERT_ONLINE_APPROVED.HPMRT_REQ_RECORD_DTL=INSERT INTO HPMRT_REQ_RECORD_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRNUM_RECORD_TYPE, HPMRSTR_REMARKS, HRGNUM_ADMISSION_NO, HPMRNUM_REQ_STATUS, HPMRNUM_MRD_CODE, HPMRNUM_REQ_PURPOSE_ID, GNUM_ISVALID, HRGNUM_PUK, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD,GNUM_DEPTUNIT_CODE)VALUES(?,?,?,?,?,?,decode((select count(*) from hgbt_unit_consultant_mst where hgstr_emp_code\=? and hgnum_hierarchy_level IN(1,2,3,4,5) and hgnum_deptunitcode\=? and gnum_hospital_code\=? and gnum_isvalid\=1 ),0,1,2),?,?,?,?,?,?,SYSDATE,?,?)


//-----------------------------------------------case_sheet_approval--------------------------------------------------------

UPDATE.APPROVAL_DETAIL.HPMRT_RECORD_DISPATCH_DTL	=	UPDATE HPMRT_RECORD_DISPATCH_DTL SET HPMRNUM_RECORD_STATUS = ?,HPMRSTR_APPROVED_EMPNO=?, GDT_ARROVED_DATE=sysdate, GNUM_APPROVED_SEATID=?,HPMRSTR_APPROVED_REMARKS=? WHERE HPMRNUM_DISPATCH_ID = ? and GNUM_HOSPITAL_CODE=?

//-----------------------------------------------Mrd_Record_Request_Approval-----------------------------------------------------

# modified by Akash Singh, dated on 08-09-2015
#modified by:NehaRajgariya Date:9march2017 Purpose:-changing column name as per table in DB                     											 
#SELECT.BY_STATUS.HPMRT_MRDRECORD_REQ_DTL	=SELECT b.hpmrnum_req_id requestid, hpmrnum_for_days forDays, hpmrstr_req_by requestBy,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') reqDate,(SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no \= b.hpmrstr_req_by AND c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid) requestbyName, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code \= (SELECT c.gnum_dept_code FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no \= b.hpmrstr_req_by AND c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid) AND b.gnum_hospital_code \= e.gnum_hospital_code AND e.gnum_isvalid \= 1) requestbyNameDept, b.hpmrnum_req_purpose_id purposeId,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) purpose, (SELECT HPMRNUM_PRIORITY FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) priority, (SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= b.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) recordTypeName, b.hpmrnum_record_type as recordType, HPMRSTR_REMARKS remarks FROM hpmrt_mrdrecord_req_dtl b WHERE b.gnum_hospital_code \= ? and b.GNUM_ISVALID\=? AND b.hpmrnum_req_status \= ? AND HPMRSTR_DESIGNATED_APPROVED_BY \= ? order by b.HPMRNUM_REQ_ID

#added by sandip naik on 13/06/2017 Purpose:to fetch data for logged in user mapped with units
#SELECT.BY_STATUS.HPMRT_MRDRECORD_REQ_DTL	=SELECT b.hpmrnum_req_id requestid, hpmrnum_for_days forDays, hpmrstr_req_by requestBy,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') reqDate,(SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no = b.hpmrstr_req_by AND c.gnum_hospital_code = b.gnum_hospital_code AND c.gnum_isvalid = b.gnum_isvalid) requestbyName,(SELECT INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')' FROM gblt_department_mst e,hgbt_unit_mst f WHERE e.gnum_dept_code = (SELECT SUBSTR(a.hgnum_deptunitcode,0,3)FROM hgbt_unit_consultant_mst a WHERE a.hgstr_emp_code = b.hpmrstr_req_by AND a.gnum_hospital_code = b.gnum_hospital_code AND a.gnum_isvalid = b.gnum_isvalid AND f.hgnum_deptunitcode=a.hgnum_deptunitcode  and a.hgnum_is_hou = 1) AND e.gnum_hospital_code = b.gnum_hospital_code AND e.gnum_isvalid =b.gnum_isvalid  AND f.gnum_hospital_code=b.gnum_hospital_code AND f.gnum_isvalid=b.gnum_isvalid ) requestbyNameDept, b.hpmrnum_req_purpose_id purposeId,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = b.hpmrnum_req_purpose_id AND gnum_hospital_code = ? AND gnum_isvalid = b.gnum_isvalid) purpose, (SELECT HPMRNUM_PRIORITY FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = b.hpmrnum_req_purpose_id AND gnum_hospital_code = ? AND gnum_isvalid = b.gnum_isvalid) priority, (SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type = b.hpmrnum_record_type AND gnum_hospital_code = ? AND gnum_isvalid = b.gnum_isvalid) recordTypeName, b.hpmrnum_record_type as recordType, HPMRSTR_REMARKS remarks FROM hpmrt_mrdrecord_req_dtl b WHERE b.gnum_hospital_code = ? and b.GNUM_ISVALID = ? AND b.hpmrnum_req_status = ? AND  b.hpmrstr_req_by = ?  order by b.HPMRNUM_REQ_ID
#SELECT.BY_STATUS.HPMRT_MRDRECORD_REQ_DTL	=SELECT x.hpmrnum_req_id requestid,y.hpmrnum_for_days forDays,y.hpmrstr_req_by requestBy,to_char(y.hpmrdt_req_date,'dd-Mon-yyyy') reqDate,(SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no = y.hpmrstr_req_by AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = 1) requestbyName,y.hpmrnum_req_status as reqStatus,x.hpmrnum_mrd_record_id as recordId,x.gnum_deptunit_code as reqRecordUnit,x.hpmrnum_req_status as reqRecordStatus,y.hpmrnum_req_purpose_id purposeId,x.hrgnum_admission_no as admno,(select hgstr_unitname from hgbt_unit_mst where hgnum_deptunitcode=x.gnum_deptunit_code and gnum_hospital_code=x.gnum_hospital_code and gnum_isvalid = 1) as deptunitname,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code = x.gnum_hospital_code AND gnum_isvalid = 1) purpose,(SELECT HPMRNUM_PRIORITY FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code = y.gnum_hospital_code AND gnum_isvalid = 1) priority, (SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type = x.hpmrnum_record_type AND gnum_hospital_code = x.gnum_hospital_code AND gnum_isvalid = 1) recordTypeName, x.hpmrnum_record_type as recordType,y. HPMRSTR_REMARKS remarks FROM hpmrt_req_record_dtl x, hpmrt_mrdrecord_req_dtl y WHERE x.gnum_hospital_code =? and  x.GNUM_ISVALID = 1 AND x.hpmrnum_req_status = ? AND x.hpmrnum_req_id=y.hpmrnum_req_id and x.gnum_hospital_code=y.gnum_hospital_code and y.gnum_isvalid=1 AND exists (select 1 from hgbt_unit_consultant_mst a where a.gnum_hospital_code=x.gnum_hospital_code and a.gnum_isvalid=1 and a.hgnum_deptunitcode=x.gnum_deptunit_code and a.hgstr_emp_code=? and a.hgnum_hierarchy_level between 1 and 5)order by y.hpmrdt_req_date, x.hpmrnum_mrd_record_id

#commented by Dheeraj on 06-Nov-2018
#SELECT.BY_STATUS.HPMRT_MRDRECORD_REQ_DTL	=SELECT x.hpmrnum_req_id requestid,y.hpmrnum_for_days forDays,y.hpmrstr_req_by requestBy,to_char(y.hpmrdt_req_date,'dd-Mon-yyyy') reqDate,(SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no = y.hpmrstr_req_by AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = 1) requestbyName,y.hpmrnum_req_status as reqStatus,x.hpmrnum_mrd_record_id as recordId,x.gnum_deptunit_code as reqRecordUnit,x.hpmrnum_req_status as reqRecordStatus,y.hpmrnum_req_purpose_id purposeId,x.hrgnum_admission_no as admno,(SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',')  FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code=x.gnum_hospital_code and f.gnum_hospital_code=x.gnum_hospital_code and e.gnum_isvalid=1 and f.gnum_isvalid=1 and e.gnum_dept_code=SUBSTR(x.gnum_deptunit_code,0,3)and f.hgnum_deptunitcode=x.gnum_deptunit_code) as deptunitname,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code =? AND gnum_isvalid = 1) purpose,(SELECT HPMRNUM_PRIORITY FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code =? AND gnum_isvalid = 1) priority, (SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type = x.hpmrnum_record_type AND gnum_hospital_code =? AND gnum_isvalid = 1) recordTypeName, x.hpmrnum_record_type as recordType,y. HPMRSTR_REMARKS remarks FROM hpmrt_req_record_dtl x, hpmrt_mrdrecord_req_dtl y WHERE x.gnum_hospital_code =? and  x.GNUM_ISVALID = 1 AND x.hpmrnum_req_status = ? AND x.hpmrnum_req_id=y.hpmrnum_req_id and x.gnum_hospital_code=y.gnum_hospital_code and y.gnum_isvalid=1 AND exists (select 1 from hgbt_unit_consultant_mst a where a.gnum_hospital_code=x.gnum_hospital_code and a.gnum_isvalid=1 and a.hgnum_deptunitcode=x.gnum_deptunit_code and a.hgstr_emp_code=? and a.hgnum_hierarchy_level between 1 and 5)order by y.hpmrdt_req_date, x.hpmrnum_mrd_record_id
#Added by Dheeraj on 06-Nov-2018 to get MRD Record Request Details
SELECT.BY_STATUS.HPMRT_MRDRECORD_REQ_DTL	=SELECT x.hpmrnum_req_id requestid,y.hpmrnum_for_days forDays,y.hpmrstr_req_by requestBy,to_char(y.hpmrdt_req_date,'dd-Mon-yyyy') reqDate,(SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no = y.hpmrstr_req_by AND c.gnum_hospital_code = x.gnum_hospital_code AND c.gnum_isvalid = 1) requestbyName,y.hpmrnum_req_status as reqStatus,x.hpmrnum_mrd_record_id as recordId,x.gnum_deptunit_code as reqRecordUnit,x.hpmrnum_req_status as reqRecordStatus,y.hpmrnum_req_purpose_id purposeId,x.hrgnum_admission_no as admno,(SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',')  FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code=x.gnum_hospital_code and f.gnum_hospital_code=x.gnum_hospital_code and e.gnum_isvalid=1 and f.gnum_isvalid=1 and e.gnum_dept_code=SUBSTR(x.gnum_deptunit_code,0,3)and f.hgnum_deptunitcode=x.gnum_deptunit_code) as deptunitname,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code =? AND gnum_isvalid = 1) purpose,(SELECT HPMRNUM_PRIORITY FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = y.hpmrnum_req_purpose_id AND gnum_hospital_code =? AND gnum_isvalid = 1) priority, (SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type = x.hpmrnum_record_type AND gnum_hospital_code =? AND gnum_isvalid = 1) recordTypeName, x.hpmrnum_record_type as recordType,y. HPMRSTR_REMARKS remarks FROM hpmrt_req_record_dtl x, hpmrt_mrdrecord_req_dtl y WHERE x.gnum_hospital_code =? and  x.GNUM_ISVALID = 1 AND x.hpmrnum_req_status = ? AND x.hpmrnum_req_id=y.hpmrnum_req_id and x.gnum_hospital_code=y.gnum_hospital_code and y.gnum_isvalid=1 order by y.hpmrdt_req_date, x.hpmrnum_mrd_record_id

#edited by sandip naik on 20/7/17 to fetch record on recordidbasis
SELECT.BY_REQ_ID.HPMRT_REQ_RECORD_DTL	=SELECT a.hpmrnum_req_id requestid, hpmrnum_mrd_record_id mrdrecordid,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= a.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= a.gnum_isvalid) recordTypeName, a.hpmrnum_record_type as recordType, hrgnum_admission_no patAdmNo, hrgnum_puk patCrNo, a.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= a.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= a.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= a.hpmrnum_req_purpose_id AND gnum_hospital_code \= ?  AND gnum_isvalid \= a.gnum_isvalid) priority,(SELECT hrgstr_fname|| ' '|| hrgstr_mname|| ' '|| hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,HPMRNUM_MRD_CODE mrdCode,HPMRSTR_REMARKS remarks,(SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id and gnum_hospital_code\=a.gnum_hospital_code)mrdRecordStatus ,(SELECT HPMRSTR_RECORD_ID FROM HPMRT_MRD_RECORD_DTL WHERE HPMRNUM_MRD_RECORD_ID\=a.HPMRNUM_MRD_RECORD_ID AND GNUM_ISVALID\=a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) AS fileNo, (select hpmrnum_issue_upto from hpmrt_mrdrecord_req_dtl where hpmrnum_req_id \= a.hpmrnum_req_id) as extendDays FROM hpmrt_req_record_dtl a  WHERE a.hpmrnum_mrd_record_id \= ? AND a.hpmrnum_req_status \= ? AND  a.gnum_hospital_code \= ? AND a.hpmrnum_req_id\=? ORDER BY hpmrnum_mrd_record_id

//-----------------------------------------------Mrd_Record_Issue-------------------------------------------------------

UPDATE.REQUEST_STATUS.HPMRT_REQ_RECORD_DTL 	=	Update HPMRT_REQ_RECORD_DTL set HPMRNUM_REQ_STATUS=? where HPMRNUM_REQ_ID=? and HPMRNUM_MRD_RECORD_ID=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?

INSERT.HPMRT_MRDRECORD_ISSUE_DTL	=	Insert into HPMRT_MRDRECORD_ISSUE_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRDT_ISSUE_DATE, HPMRNUM_RECORD_TYPE, HPMRNUM_MRD_CODE, HPMRSTR_REMARKS, HPMRSTR_HANDOVER_TO, HPMRDT_EXPECTED_RETURN_DATE, \
 										GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD,hpmrstr_handover_to_name) values(?,?,sysdate,?,?,?,?,to_date(?,'dd-Mon-yyyy'),?,?,?,sysdate,?,?)

#added by manisha acc to UAT pt 5
#SELECT.RECORD_TO_ISSUE.HPMRT_MRDRECORD_REQ_DTL	=	SELECT b.hpmrnum_req_id requestid, hpmrnum_for_days fordays, hpmrstr_req_by requestby, \
#													(SELECT D.GSTR_DESIG_NAME FROM GBLT_DESIGNATION_MST D WHERE D.GNUM_DESIG_CODE=(SELECT DISTINCT C.GNUM_DESIG_CODE FROM PIST_EMP_REGISTRATION_DTL C WHERE C.STR_EMP_NO=b.hpmrstr_req_by AND C.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE) AND D.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE) as requestByNameDesig, \
#													(SELECT e.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST e WHERE e.GNUM_DEPT_CODE = (SELECT DISTINCT C.gnum_dept_code FROM PIST_EMP_REGISTRATION_DTL C WHERE C.STR_EMP_NO=b.hpmrstr_req_by AND C.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE) AND e.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE AND e.GNUM_ISVALID = b.GNUM_ISVALID) as requestByNameDept, \
#													to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') reqDate,to_char(GDT_APPROVED_DATE,'dd-Mon-yyyy') approvedDate,(select hpmrstr_req_by_name FROM HPMRT_MRDRECORD_REQ_DTL C WHERE c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid  AND c.hpmrnum_req_id\=b.hpmrnum_req_id) requestbyname,HPMRSTR_REMARKS remarks, b.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id  AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) priority,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= b.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) recordtypename,HPMRNUM_RECORD_TYPE recordType,nvl(hpmrnum_issue_upto,HPMRNUM_FOR_DAYS) issueupto,HPMRSTR_REMARKS remarks FROM hpmrt_mrdrecord_req_dtl b WHERE b.gnum_hospital_code \= ? AND b.gnum_isvalid \= ? AND b.hpmrnum_req_status \= ? AND hpmrnum_req_id IN ( SELECT hpmrnum_req_id FROM hpmrt_req_record_dtl WHERE hpmrnum_req_status \= ? AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_isvalid \= b.gnum_isvalid) ORDER BY b.hpmrnum_req_id

#SELECT.RECORD_TO_ISSUE.HPMRT_MRDRECORD_REQ_DTL	=SELECT b.hpmrnum_req_id requestid, hpmrnum_for_days fordays, hpmrstr_req_by requestby,to_char(GDT_ENTRY_DATE,'dd-Mon-yyyy') reqDate,to_char(GDT_APPROVED_DATE,'dd-Mon-yyyy') approvedDate,(select hpmrstr_req_by_name FROM HPMRT_MRDRECORD_REQ_DTL C WHERE c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid  AND c.hpmrnum_req_id\=b.hpmrnum_req_id) requestbyname,HPMRSTR_REMARKS remarks, b.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id  AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) priority,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= b.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) recordtypename,HPMRNUM_RECORD_TYPE recordType,nvl(hpmrnum_issue_upto,HPMRNUM_FOR_DAYS) issueupto,HPMRSTR_REMARKS remarks FROM hpmrt_mrdrecord_req_dtl b WHERE b.gnum_hospital_code \= ? AND b.gnum_isvalid \= ? AND b.hpmrnum_req_status \= ? AND hpmrnum_req_id IN ( SELECT hpmrnum_req_id FROM hpmrt_req_record_dtl WHERE hpmrnum_req_status \= ? AND gnum_hospital_code \= b.gnum_hospital_code AND gnum_isvalid \= b.gnum_isvalid) ORDER BY b.hpmrnum_req_id
SELECT.RECORD_TO_ISSUE.HPMRT_MRDRECORD_REQ_DTL=SELECT b.hpmrnum_req_id requestid, b.hpmrnum_for_days fordays, b.hpmrstr_req_by requestby, (SELECT D.GSTR_DESIG_NAME FROM GBLT_DESIGNATION_MST D WHERE D.GNUM_DESIG_CODE\=(SELECT DISTINCT C.GNUM_DESIG_CODE FROM PIST_EMP_REGISTRATION_DTL C WHERE C.STR_EMP_NO\=b.hpmrstr_req_by AND C.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE) AND D.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE) as requestByNameDesig, (SELECT e.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST e WHERE e.GNUM_DEPT_CODE \= (SELECT DISTINCT C.gnum_dept_code FROM PIST_EMP_REGISTRATION_DTL C WHERE C.STR_EMP_NO\=b.hpmrstr_req_by AND C.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE) AND e.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE AND e.GNUM_ISVALID \= b.GNUM_ISVALID) as requestByNameDept,  to_char(b.hpmrdt_req_date,'dd-Mon-yyyy') reqDate,to_char(b.GDT_APPROVED_DATE,'dd-Mon-yyyy') approvedDate,  (select hpmrstr_req_by_name FROM HPMRT_MRDRECORD_REQ_DTL C WHERE c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid  AND c.hpmrnum_req_id\=b.hpmrnum_req_id) requestbyname,b.HPMRSTR_REMARKS remarks, b.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id  AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) priority,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= b.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) recordtypename,b.HPMRNUM_RECORD_TYPE recordType,nvl(hpmrnum_issue_upto,HPMRNUM_FOR_DAYS) issueupto,a.hpmrnum_mrd_record_id as recordId,a.hrgnum_admission_no as admno, (SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',')  FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code\=a.gnum_hospital_code and f.gnum_hospital_code\=a.gnum_hospital_code and e.gnum_isvalid\=1 and f.gnum_isvalid\=1 and e.gnum_dept_code\=SUBSTR(a.gnum_deptunit_code,0,3)and f.hgnum_deptunitcode\=a.gnum_deptunit_code) as deptunitname,(select  str_emp_full_name from pist_emp_registration_dtl where str_emp_no\=b.hpmrstr_approved_by and gnum_hospital_code\=b.gnum_hospital_code and gnum_isvalid\=1)approvedBy FROM hpmrt_mrdrecord_req_dtl b,hpmrt_req_record_dtl a WHERE b.gnum_hospital_code \=? AND b.gnum_isvalid \= ? AND a.hpmrnum_req_status \= ? AND a.hpmrnum_req_id\=b.hpmrnum_req_id ORDER BY b.hpmrnum_req_id


#UPDATE.REQUEST_STATUS.HPMRT_MRDRECORD_REQ_DTL	=	update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_REQ_STATUS=? where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?

UPDATE.REQUEST_STATUS.HPMRT_MRDRECORD_REQ_DTL	=update HPMRT_MRDRECORD_REQ_DTL a set HPMRNUM_REQ_STATUS\=(decode((select count(*) from HPMRT_REQ_RECORD_DTL where HPMRNUM_REQ_ID\=a.HPMRNUM_REQ_ID and HPMRNUM_REQ_STATUS not in(3,6,8)),0,3,2)) where a.HPMRNUM_REQ_ID\=? and a.GNUM_HOSPITAL_CODE\=?


UPDATE.REQUEST_STATUS_REJECTED.HPMRT_MRDRECORD_REQ_DTL	=	update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_REQ_STATUS=?, hpmrstr_mrd_approved_by=?, gnum_mrd_approvedseat_id=?, gdt_mrd_approved_date=sysdate, hpmrstr_mrd_reject_reason=?  where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?

//---------------------------------------------Mrd_record_return----------------------------------------------------

INSERT.HPMRT_MRDRECORD_RETURN_DTL	=	Insert into HPMRT_MRDRECORD_RETURN_DTL (HPMRNUM_REQ_ID, HPMRNUM_MRD_RECORD_ID, HPMRDT_RETURN_DATE,HPMRNUM_RECORD_TYPE, HPMRNUM_MRD_CODE, HPMRSTR_REMARKS, HPMRSTR_RETURN_BY, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, \
										GDT_ENTRY_DATE, HRGSTR_IP_ADD,HPMRSTR_RETURN_BY_NAME) values(?,?,sysdate,?,?,?,?,?,?,?,sysdate,?,?)

SELECT.BY_REQID.HPMRT_MRDRECORD_ISSUE_DTL =SELECT A.HPMRNUM_REQ_ID REQUESTID, HPMRNUM_MRD_RECORD_ID MRDRECORDID, TO_CHAR (HPMRDT_ISSUE_DATE, 'dd-Mon-yyyy') ISSUEDATE, A.HPMRNUM_RECORD_TYPE RECORDTYPE, A.HPMRNUM_MRD_CODE MRDCODE, A.HPMRSTR_REMARKS REMARKS, (SELECT c.str_emp_full_name FROM PIST_EMP_REGISTRATION_DTL c WHERE c.str_emp_no \= a.hpmrstr_handover_to AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.gnum_isvalid) handoverto,TO_CHAR (HPMRDT_EXPECTED_RETURN_DATE, 'dd-Mon-yyyy') EXPECTEDRETURNDATE FROM HPMRT_MRDRECORD_ISSUE_DTL A WHERE A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND HPMRNUM_REQ_ID\=? ORDER BY HPMRNUM_MRD_RECORD_ID

SELECT.RECORD_TO_RETURN.HPMRT_MRDRECORD_REQ_DTL	=SELECT b.hpmrnum_req_id requestid, hpmrnum_for_days fordays, hpmrstr_req_by requestby, (SELECT c.str_emp_full_name  FROM PIST_EMP_registration_DTL c WHERE c.str_emp_no \= b.hpmrstr_req_by AND c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid) requestbyname, b.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id  AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id \= b.hpmrnum_req_purpose_id AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) priority,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type \= b.hpmrnum_record_type AND gnum_hospital_code \= ? AND gnum_isvalid \= b.gnum_isvalid) recordtypename,HPMRNUM_RECORD_TYPE recordType,nvl(hpmrnum_issue_upto,HPMRNUM_FOR_DAYS) issueupto FROM hpmrt_mrdrecord_req_dtl b WHERE b.gnum_hospital_code \= ? AND b.gnum_isvalid \= ? AND b.hpmrnum_req_status \= ? ORDER BY b.hpmrnum_req_id

SELECT.RECORD_STATUS_DETAIL.HPMRT_MRD_RECORD_DTL	=SELECT hpmrnum_record_status AS recordstatus,hpmrnum_record_type AS recordtype,hpmrnum_mrd_record_id AS mrdrecordid,(SELECT INITCAP (hpmrstr_mrd_name) FROM hpmrt_mrd_mst WHERE hpmrnum_mrd_code \= a.hpmrnum_mrd_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) AS mrdname, a.hpmrnum_rack_id AS rackid,(SELECT hpmrstr_rack_name FROM hpmrt_rack_mst r WHERE r.hpmrnum_rack_id \= a.hpmrnum_rack_id AND r.gnum_hospital_code \= a.gnum_hospital_code AND r.gnum_isvalid \= a.gnum_isvalid) AS racklabel, a.hpmrnum_shelf_id AS shelfid,(SELECT hmprstr_shelf_label FROM hpmrt_rack_shelf_mst f WHERE f.hpmrnum_rackshelf_id \= a.hpmrnum_shelf_id AND f.gnum_hospital_code \= a.gnum_hospital_code AND f.gnum_isvalid \= a.gnum_isvalid) AS shelfname,(SELECT (SELECT b.str_building_name FROM est_building_mst b WHERE b.num_building_code \= x.num_building_code  AND b.gnum_isvalid \= x.gnum_isvalid)|| ' , '|| (SELECT c.str_block_name FROM est_block_mst c WHERE c.num_block_id \= x.num_block_id AND c.num_hospital_code \= x.gnum_hospital_code AND c.gnum_isvalid \= x.gnum_isvalid)|| ' , '|| (SELECT d.str_floor_name FROM est_floor_mst d WHERE d.num_floor_id \= x.num_floor_id AND d.num_hospital_code \= x.gnum_hospital_code AND d.gnum_isvalid \= x.gnum_isvalid)|| ' , '|| (SELECT e.num_room_number FROM est_room_mst e WHERE e.num_room_id \= x.num_room_id AND e.num_hospital_code \= x.gnum_hospital_code AND e.gnum_isvalid \= x.gnum_isvalid) FROM hpmrt_rack_mst x WHERE x.hpmrnum_rack_status \= ? AND x.hpmrnum_mrd_code \= a.hpmrnum_mrd_code AND x.gnum_isvalid \= a.gnum_isvalid AND x.gnum_hospital_code \= a.gnum_hospital_code AND x.HPMRNUM_RACK_ID\=a.HPMRNUM_RACK_ID) AS racklocation, (SELECT COUNT (*) FROM hpmrt_req_record_dtl WHERE hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id AND hpmrnum_req_status \= ? AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) raisedrequest, (SELECT ROUND(ahis_gbl_util.date_diff(hpmrdt_expected_return_date,gdt_entry_date)) FROM hpmrt_mrdrecord_issue_dtl WHERE hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid AND HPMRNUM_REQ_ID \= ?)issuedFor FROM hpmrt_mrd_record_dtl a WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND hpmrnum_mrd_record_id \= ?

SELECT.BY_RECORD_ID.HPMRT_MRDRECORD_ISSUE_DTL	= SELECT a.hpmrnum_req_id requestid, hpmrnum_mrd_record_id mrdrecordid, TO_CHAR (hpmrdt_issue_date, 'dd-Mon-yyyy') issuedate, ROUND (ahis_gbl_util.date_diff(hpmrdt_expected_return_date,a.gdt_entry_date)) issuedfor, (SELECT c.str_emp_full_name FROM PIST_EMP_registration_DTL c WHERE c.str_emp_no \= b.hpmrstr_req_by AND c.gnum_hospital_code \= b.gnum_hospital_code AND c.gnum_isvalid \= b.gnum_isvalid) requestby FROM hpmrt_mrdrecord_issue_dtl a, hpmrt_mrdrecord_req_dtl b WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND hpmrnum_mrd_record_id \= ? AND a.hpmrnum_req_id \= b.hpmrnum_req_id AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_isvalid \= b.gnum_isvalid order by hpmrdt_issue_date desc


UPDATE.SUMMON_ACCEPTED_DETAIL.HPMRT_SUMMON_DTL = update HPMRT_SUMMON_DTL set HPMRNUM_STATUS=? where HPMRNUM_SUMMON_ID=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?



SEARCH_DIAGNOSIS_CASESHEET_ENQUIRY.HIPT_PATADMDISC_DTL = SELECT a.hrgnum_puk, a.HIPNUM_ADMNO,a.hrgnum_mlc_no,initcap(b.hrgstr_fname) as hrgstr_fname, initcap(b.hrgstr_mname) as hrgstr_mname, initcap(b.hrgstr_lname) as hrgstr_lname,a.hrgstr_sex,(SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code \= a.hrgstr_sex and GNUM_ISVALID\=?) AS gstr_gender_name, a.hrgnum_age,a.hrgstr_ageunit, a.hrgstr_address, a.hrgnum_city_loc_code,a.hrgstr_city, a.gnum_dept_code, a.gnum_deptunit_code, a.hipdt_admstatus_code,TO_CHAR(a.HIPDT_ADMDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_admdatetime,TO_CHAR(a.HIPDT_DISDATETIME,'dd-Mon-yyyy HH24\:MI') as hipdt_disdatetime, a.GNUM_STATE_CODE, a.GNUM_COUNTRY_CODE,(SELECT gstr_country_name FROM GBLT_COUNTRY_MST where gnum_country_code\=a.GNUM_COUNTRY_CODE  AND GNUM_ISVALID\=?) as gstr_countryname,(SELECT gstr_state_name FROM GBLT_STATE_MST where gnum_state_code\=a.GNUM_STATE_CODE  AND GNUM_ISVALID\=?) as hrgstr_state_name, (select HGSTR_DISCHARGE_DESC from HIPT_DISCHARGE_TYPE_MST where HGNUM_DISHARGE_TYPE_CODE\=a.HIPDT_DISSTATUS_CODE and gnum_hospital_code \=? and GNUM_ISVALID\=?) dischargeType ,(SELECT HPMRNUM_PROFILE_STATUS FROM HPMRT_PAT_PROFILE_DTL WHERE HPMRNUM_PROFILE_TYPE\=? AND HRGNUM_ADMISSION_NO\=A.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as profileStatus, (SELECT HPMRNUM_PROFILE_ID FROM hpmrt_pat_profile_dtl WHERE hpmrnum_profile_type \= ? AND hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS profileId, (SELECT count(*) FROM HPMRT_MRD_RECORD_DTL WHERE HRGNUM_ADMISSION_NO\=a.HIPNUM_ADMNO and gnum_hospital_code \=a.gnum_hospital_code and GNUM_ISVALID\=?) as count, NVL ((SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?),0 ) as recordStatus, (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as recordType, (SELECT HPMRNUM_MRD_RECORD_ID FROM hpmrt_mrd_record_dtl WHERE hrgnum_admission_no \= a.hipnum_admno AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) as mrdRecordId FROM hipt_patadmdisc_dtl a,HRGT_PATIENT_DTL b,HPMRT_MRD_RECORD_DTL c WHERE a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?   and a.hrgnum_puk\=b.hrgnum_puk AND b.hrgnum_puk \= c.hrgnum_puk AND c.hrgnum_puk \= a.hrgnum_puk and a.gnum_hospital_code\=b.gnum_hospital_code AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= a.gnum_hospital_code and b.gnum_isvalid\=? AND c.gnum_isvalid \= ? and HIPDT_DISDATETIME is not null AND HIPNUM_ADMNO IN (SELECT HRGNUM_ADMISSION_NO FROM HRGT_EPISODE_DIAGNOSIS_DTL WHERE gnum_hospital_code \= c.gnum_hospital_code AND gnum_isvalid \= ? AND upper(HRGNUM_DIAGNOSTIC_CODE) \=upper(?) and HRGNUM_ADMISSION_NO is not null )\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t



UPDATE.OPINION_DETAIL.HPMRT_INSURANCE_DTL = update HPMRT_INSURANCE_DTL set HPMRSTR_OPINION_BY\=?, HPMRSTR_OPINION_REMARKS\=?, HPMRNUM_SEND_MODE\=?, HPMRNUM_STATUS\=?, GDT_OPINION_DATE\=to_date(?,'dd-Mon-yyyy'), GNUM_OPINIONSEAT_ID\=? where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_INSURANCE_ID\=?

											

#SELECT_ISSUED_MRD_RECORD_REQUEST.HPMRT_MRDRECORD_REQ_DTL = SELECT A.HPMRNUM_REQ_ID AS requestId, TO_CHAR(A.HPMRDT_REQ_DATE,'dd-Mon-yyyy') AS reqDate, A.HPMRNUM_MRD_CODE AS mrdCode, A.HPMRNUM_RECORD_TYPE AS recordType,(SELECT B.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST B WHERE B.HPMRNUM_RECORD_TYPE\=A.HPMRNUM_RECORD_TYPE AND B.GNUM_HOSPITAL_CODE \= ? AND B.GNUM_ISVALID\=A.GNUM_ISVALID)AS recordTypeName, A.HPMRNUM_REQ_PURPOSE_ID AS reqPurposeId,(SELECT C.HPMRSTR_PURPOSE FROM HPMRT_REQ_PURPOSE_MST C WHERE C.HPMRNUM_REQ_PURPOSE_ID\=A.HPMRNUM_REQ_PURPOSE_ID AND C.GNUM_HOSPITAL_CODE \= ? AND C.GNUM_ISVALID\=A.GNUM_ISVALID) AS purpose, A.HPMRNUM_REQ_STATUS AS reqStatus, A.HPMRNUM_FOR_DAYS AS forDays, A.HPMRSTR_REQ_BY AS requestBy, (select hpmrstr_req_by_name FROM HPMRT_MRDRECORD_REQ_DTL D WHERE D.gnum_hospital_code \= A.gnum_hospital_code AND D.gnum_isvalid \= A.gnum_isvalid  AND D.hpmrnum_req_id\=A.hpmrnum_req_id\t)AS requestByName FROM HPMRT_MRDRECORD_REQ_DTL A WHERE A.HPMRNUM_REQ_STATUS \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_REQ_ID IN (SELECT x.HPMRNUM_REQ_ID FROM HPMRT_MRDRECORD_ISSUE_DTL x WHERE x.GNUM_ISVALID \= A.GNUM_ISVALID AND x.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND x.HPMRNUM_MRD_RECORD_ID NOT IN (SELECT y.HPMRNUM_MRD_RECORD_ID FROM HPMRT_MRDRECORD_RETURN_DTL y WHERE y.HPMRNUM_REQ_ID \=A.HPMRNUM_REQ_ID AND y.GNUM_ISVALID \= A.GNUM_ISVALID AND y.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE ))\tORDER BY A.HPMRDT_REQ_DATE\t\t\t\t\t\t\t\t



SELECT_ISSUED_MRD_RECORD_REQUEST.HPMRT_MRDRECORD_REQ_DTL = SELECT A.HPMRNUM_REQ_ID AS requestId, a.HPMRNUM_MRD_RECORD_ID AS recordId, TO_CHAR(Z.HPMRDT_REQ_DATE,'dd-Mon-yyyy') AS reqDate, A.HPMRNUM_MRD_CODE AS mrdCode, A.HPMRNUM_RECORD_TYPE AS recordType,(SELECT B.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST B WHERE B.HPMRNUM_RECORD_TYPE\=A.HPMRNUM_RECORD_TYPE AND B.GNUM_HOSPITAL_CODE \= ? AND B.GNUM_ISVALID\=A.GNUM_ISVALID)AS recordTypeName, A.HPMRNUM_REQ_PURPOSE_ID AS reqPurposeId,(SELECT C.HPMRSTR_PURPOSE FROM HPMRT_REQ_PURPOSE_MST C WHERE C.HPMRNUM_REQ_PURPOSE_ID\=A.HPMRNUM_REQ_PURPOSE_ID AND C.GNUM_HOSPITAL_CODE \= ? AND C.GNUM_ISVALID\=A.GNUM_ISVALID) AS purpose, A.HPMRNUM_REQ_STATUS AS reqStatus, Z.HPMRNUM_FOR_DAYS AS forDays, Z.HPMRSTR_REQ_BY AS requestBy, (select hpmrstr_req_by_name FROM HPMRT_MRDRECORD_REQ_DTL D WHERE D.gnum_hospital_code \= A.gnum_hospital_code AND D.gnum_isvalid \= A.gnum_isvalid  AND D.hpmrnum_req_id\=A.hpmrnum_req_id\t)AS requestByName, a.hrgnum_admission_no as admno, (SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',')  FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code\=a.gnum_hospital_code and f.gnum_hospital_code\=a.gnum_hospital_code and e.gnum_isvalid\=1 and f.gnum_isvalid\=1 and e.gnum_dept_code\=SUBSTR(a.gnum_deptunit_code,0,3)and f.hgnum_deptunitcode\=a.gnum_deptunit_code) as deptunitname FROM HPMRT_REQ_RECORD_DTL A, HPMRT_MRDRECORD_REQ_DTL z  WHERE A.HPMRNUM_REQ_STATUS \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?  AND a.hpmrnum_req_id\=z.hpmrnum_req_id AND A.HPMRNUM_REQ_ID IN (SELECT x.HPMRNUM_REQ_ID FROM HPMRT_MRDRECORD_ISSUE_DTL x WHERE x.GNUM_ISVALID \= A.GNUM_ISVALID AND x.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND x.HPMRNUM_MRD_RECORD_ID NOT IN (SELECT y.HPMRNUM_MRD_RECORD_ID FROM HPMRT_MRDRECORD_RETURN_DTL y WHERE y.HPMRNUM_REQ_ID \=A.HPMRNUM_REQ_ID AND y.GNUM_ISVALID \= A.GNUM_ISVALID AND y.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE ))\tORDER BY Z.HPMRDT_REQ_DATE\t\t\t\t\t\t\t\t


SELECT_ISSUED_MRD_RECORD_BY_REQ_ID.HPMRT_MRDRECORD_ISSUE_DTL = SELECT A.HPMRNUM_REQ_ID REQUESTID, A.HPMRNUM_MRD_RECORD_ID MRDRECORDID, TO_CHAR (A.HPMRDT_ISSUE_DATE, 'dd-Mon-yyyy') ISSUEDATE, A.HPMRNUM_RECORD_TYPE RECORDTYPE, A.HPMRNUM_MRD_CODE MRDCODE, A.HPMRSTR_REMARKS REMARKS, (SELECT b.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST b WHERE b.HPMRNUM_RECORD_TYPE\=a.HPMRNUM_RECORD_TYPE AND b.GNUM_HOSPITAL_CODE \= ? AND b.GNUM_ISVALID\=a.GNUM_ISVALID)recordTypeName, hpmrstr_handover_to_name as handoverto, TO_CHAR (HPMRDT_EXPECTED_RETURN_DATE, 'dd-Mon-yyyy') EXPECTEDRETURNDATE, d.HRGNUM_PUK as patCrNo, d.HRGNUM_ADMISSION_NO as patAdmNo, (SELECT p.HRGSTR_FNAME||' '|| p.HRGSTR_MNAME||' '||p.HRGSTR_LNAME FROM HRGT_PATIENT_DTL p WHERE p.HRGNUM_PUK\=d.HRGNUM_PUK AND p.gnum_isvalid\=a.gnum_isvalid AND p.gnum_hospital_code\=a.gnum_hospital_code) as patName, d.HPMRNUM_RACK_ID as rackId, d.HPMRNUM_SHELF_ID as shelfId, (SELECT m.HPMRSTR_RACK_NAME FROM HPMRT_RACK_MST m WHERE m.HPMRNUM_RACK_ID\=d.HPMRNUM_RACK_ID AND m.gnum_hospital_code\=d.gnum_hospital_code AND m.gnum_isvalid\=d.gnum_isvalid ) AS rackLabel, (SELECT n.HMPRSTR_SHELF_LABEL FROM HPMRT_RACK_SHELF_MST n WHERE n.HPMRNUM_RACKSHELF_ID\=d.HPMRNUM_SHELF_ID AND n.gnum_hospital_code\=d.gnum_hospital_code AND n.gnum_isvalid\=d.gnum_isvalid) AS shelfName, (SELECT   NVL((SELECT p.str_building_name FROM est_building_mst p WHERE p.num_building_code \= x.num_building_code  AND p.gnum_isvalid \= x.gnum_isvalid),'NA') || ' / ' || NVL((SELECT q.str_block_name FROM est_block_mst q WHERE q.num_block_id \= x.num_block_id AND q.num_hospital_code \= x.gnum_hospital_code AND q.gnum_isvalid \= x.gnum_isvalid),'NA') || ' / ' || NVL((SELECT r.str_floor_name FROM est_floor_mst r WHERE r.num_floor_id \= x.num_floor_id AND r.num_hospital_code \= x.gnum_hospital_code AND r.gnum_isvalid \= x.gnum_isvalid),'NA') || ' / ' ||DECODE( NVL((SELECT s.num_room_number FROM est_room_mst s WHERE s.num_room_id \= x.num_room_id AND s.num_hospital_code \= x.gnum_hospital_code AND s.gnum_isvalid \= x.gnum_isvalid),0),0,'NA') FROM hpmrt_rack_mst x WHERE x.hpmrnum_mrd_code \= d.hpmrnum_mrd_code AND x.hpmrnum_rack_id \= d.hpmrnum_rack_id AND x.gnum_isvalid \= d.gnum_isvalid AND x.gnum_hospital_code \= d.gnum_hospital_code) AS racklocation, d.HPMRSTR_RECORD_ID as fileNo  FROM HPMRT_MRDRECORD_ISSUE_DTL A, HPMRT_MRD_RECORD_DTL d WHERE A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND HPMRNUM_REQ_ID\=? AND a.HPMRNUM_MRD_RECORD_ID\= ? AND d.gnum_isvalid\=a.gnum_isvalid AND d.gnum_hospital_code\=a.gnum_hospital_code  and a.HPMRNUM_MRD_RECORD_ID\=d.HPMRNUM_MRD_RECORD_ID AND a.hpmrnum_mrd_record_id NOT IN(SELECT x.HPMRNUM_MRD_RECORD_ID FROM HPMRT_MRDRECORD_RETURN_DTL x WHERE x.HPMRNUM_REQ_ID \=a.hpmrnum_req_id) ORDER BY HPMRDT_ISSUE_DATE

#SELECT_ISSUED_MRD_RECORD_BY_REQ_ID.HPMRT_MRDRECORD_ISSUE_DTL = SELECT a.hpmrnum_req_id requestid, hpmrnum_mrd_record_id mrdrecordid,(SELECT hpmrstr_recordtype_desc FROM hpmrt_mrd_recordtype_mst WHERE hpmrnum_record_type = a.hpmrnum_record_type AND gnum_hospital_code = ? AND gnum_isvalid = a.gnum_isvalid) recordTypeName, a.hpmrnum_record_type as recordType, hrgnum_admission_no patAdmNo, hrgnum_puk patCrNo, a.hpmrnum_req_purpose_id purposeid,(SELECT hpmrstr_purpose FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = a.hpmrnum_req_purpose_id AND gnum_hospital_code = ? AND gnum_isvalid = a.gnum_isvalid) purpose,(SELECT hpmrnum_priority FROM hpmrt_req_purpose_mst WHERE hpmrnum_req_purpose_id = a.hpmrnum_req_purpose_id AND gnum_hospital_code = ?  AND gnum_isvalid = a.gnum_isvalid) priority,(SELECT hrgstr_fname|| ' '|| hrgstr_mname|| ' '|| hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = a.gnum_hospital_code) patname,HPMRNUM_MRD_CODE mrdCode,HPMRSTR_REMARKS remarks,(SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hpmrnum_mrd_record_id = a.hpmrnum_mrd_record_id and gnum_hospital_code=a.gnum_hospital_code)mrdRecordStatus ,(SELECT HPMRSTR_RECORD_ID FROM HPMRT_MRD_RECORD_DTL WHERE HPMRNUM_MRD_RECORD_ID=a.HPMRNUM_MRD_RECORD_ID AND GNUM_ISVALID=a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE) AS fileNo, (select hpmrnum_issue_upto from hpmrt_mrdrecord_req_dtl where hpmrnum_req_id = a.hpmrnum_req_id) as extendDays FROM hpmrt_req_record_dtl a  WHERE a.hpmrnum_mrd_record_id = ? AND a.hpmrnum_req_status = ? AND  a.gnum_hospital_code = ? and a.gnum_isvalid= ? ORDER BY hpmrnum_mrd_record_id \


UPDATE_RETURN_RECORD_UNCHANGED_DETAIL.HPMRT_MRD_RECORD_DTL = UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_RECORD_STATUS = ?, HPMRSTR_PUT_BY = ? WHERE HPMRNUM_MRD_RECORD_ID = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?


SELECT_PENDING_MRD_RECORD_REQUEST.HPMRT_MRDRECORD_REQ_DTL = SELECT A.HPMRNUM_REQ_ID AS requestId, TO_CHAR(A.HPMRDT_REQ_DATE,'dd-Mon-yyyy') AS reqDate, A.HPMRNUM_MRD_CODE AS mrdCode, A.HPMRNUM_RECORD_TYPE AS recordType, (SELECT b.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST b WHERE b.HPMRNUM_RECORD_TYPE\=a.HPMRNUM_RECORD_TYPE AND b.GNUM_HOSPITAL_CODE \= ? AND b.GNUM_ISVALID\=a.GNUM_ISVALID)recordTypeName, A.HPMRNUM_REQ_PURPOSE_ID AS reqPurposeId, A.HPMRNUM_REQ_STATUS AS reqStatus, A.HPMRNUM_FOR_DAYS AS forDays, (SELECT C.HPMRSTR_PURPOSE FROM HPMRT_REQ_PURPOSE_MST C WHERE C.HPMRNUM_REQ_PURPOSE_ID\=A.HPMRNUM_REQ_PURPOSE_ID AND C.GNUM_HOSPITAL_CODE \= ? AND C.GNUM_ISVALID\=A.GNUM_ISVALID) AS purpose, (select HPMRNUM_EXTEND_DAYS from HPMRT_MRDRECORD_ISS_EXTEND_DTL where GNUM_EXTENSION_S_NO \= A.HPMRNUM_UNDER_EXTENTION_SNO and HPMRNUM_REQ_ID \= A.HPMRNUM_REQ_ID) as extendDays FROM HPMRT_MRDRECORD_REQ_DTL A WHERE A.GNUM_ISVALID \= ? AND A.HPMRSTR_REQ_BY \= ? AND A.GNUM_HOSPITAL_CODE \= ? ORDER BY A.HPMRDT_REQ_DATE DESC


SELECT.PENDING_REQUEST_DETAIL.HPMRT_REQ_RECORD_DTL = SELECT A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HPMRNUM_RECORD_TYPE AS recordType, A.HRGNUM_ADMISSION_NO AS patAdmNo, A.HPMRNUM_REQ_STATUS AS reqStatus, A.HPMRNUM_REQ_PURPOSE_ID AS reqPurposeId, A.HRGNUM_PUK AS patCrNo, A.HPMRSTR_CANCEL_REASON AS cancelReason, (SELECT B.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST B WHERE B.HPMRNUM_RECORD_TYPE\=A.HPMRNUM_RECORD_TYPE AND B.GNUM_HOSPITAL_CODE \= ? AND B.GNUM_ISVALID\=A.GNUM_ISVALID)AS recordTypeName, (SELECT C.HPMRSTR_PURPOSE FROM HPMRT_REQ_PURPOSE_MST C WHERE C.HPMRNUM_REQ_PURPOSE_ID\=A.HPMRNUM_REQ_PURPOSE_ID AND C.GNUM_HOSPITAL_CODE \= ? AND C.GNUM_ISVALID\=A.GNUM_ISVALID) AS purpose, (SELECT D.HPMRSTR_CANCEL_REASON FROM HPMRT_MRDRECORD_REQ_DTL D WHERE D.HPMRNUM_REQ_ID\=A.HPMRNUM_REQ_ID) AS rejectReason, (SELECT p.HRGSTR_FNAME||' '|| p.HRGSTR_MNAME||' '||p.HRGSTR_LNAME FROM HRGT_PATIENT_DTL p WHERE p.HRGNUM_PUK\=a.HRGNUM_PUK AND p.gnum_isvalid\=a.gnum_isvalid AND p.gnum_hospital_code\=a.gnum_hospital_code) AS patName, TO_CHAR( (SELECT e.HPMRDT_ISSUE_DATE FROM HPMRT_MRDRECORD_ISSUE_DTL e WHERE e.HPMRNUM_REQ_ID\=a.HPMRNUM_REQ_ID AND e.HPMRNUM_MRD_RECORD_ID\=a.HPMRNUM_MRD_RECORD_ID),'dd-Mon-yyyy') as issueDate, TO_CHAR((SELECT F.HPMRDT_RETURN_DATE FROM HPMRT_MRDRECORD_RETURN_DTL F WHERE F.hpmrnum_req_id \= a.hpmrnum_req_id AND F.hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id),  'dd-Mon-yyyy' ) AS returnDate, (SELECT HPMRSTR_RECORD_ID FROM HPMRT_MRD_RECORD_DTL WHERE HPMRNUM_MRD_RECORD_ID\=a.HPMRNUM_MRD_RECORD_ID AND GNUM_ISVALID\=a.GNUM_ISVALID AND GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE) AS fileNo, (select max(hpmrnum_profile_id) from hpmrt_pat_profile_dtl where hrgnum_puk\=a.hrgnum_puk and hpmrnum_profile_type\=13 and gnum_isvalid\=1 and gnum_hospital_code\=A.gnum_hospital_code) as profileId, (select HPMRNUM_EXTEND_DAYS from HPMRT_MRDRECORD_ISS_EXTEND_DTL where GNUM_EXTENSION_S_NO \= (select max(D.HPMRNUM_UNDER_EXTENTION_SNO) from HPMRT_MRDRECORD_REQ_DTL D where D.HPMRNUM_REQ_ID\=A.HPMRNUM_REQ_ID ) and HPMRNUM_REQ_ID \= A.HPMRNUM_REQ_ID) as extendDays FROM HPMRT_REQ_RECORD_DTL A WHERE A.HPMRNUM_REQ_ID \= ? AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t


SEARCH_RECORD_FOR_RECORD_LOST = SELECT a.HPMRSTR_RECORD_ID AS recordDesc, a.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, a.HPMRNUM_RECORD_ID AS recordId, a.HPMRNUM_RECORD_TYPE AS recordType, a.HPMRNUM_RECORD_STATUS AS recordStatus, a.HPMRNUM_RACK_ID AS rackId, a.HPMRNUM_MRD_CODE AS mrdCode, a.HRGNUM_PUK AS patCrNo, a.HPMRNUM_SHELF_ID AS ShelfId, a.HRGNUM_ADMISSION_NO AS patAdmNo,to_char(a.GDT_ENTRY_DATE,'dd-Mon-yyyy hh24\:mi') AS entryDate,INITCAP (b.hrgstr_fname)||' '|| INITCAP (b.hrgstr_mname)||' '||INITCAP (b.hrgstr_lname) AS patName, (SELECT gstr_gender_code  FROM GBLT_GENDER_MST  WHERE gstr_gender_code \= b.gstr_gender_code AND gnum_isvalid \= 1) AS patGender, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patAge FROM HPMRT_MRD_RECORD_DTL a, HRGT_PATIENT_DTL b WHERE a.GNUM_ISVALID \= ? AND a.GNUM_HOSPITAL_CODE \= ? AND a.hrgnum_puk \= b.hrgnum_puk AND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid AND a.hpmrnum_record_status IN (?,?)
									

INSERT_LOST.HPMRT_MRDRECORD_LOSTFOUND_DTL = INSERT INTO HPMRT_MRDRECORD_LOSTFOUND_DTL (HPMRNUM_MRD_RECORD_ID, HPMRNUM_SLNO, HPMRDT_LOST_DATETIME, HPMRNUM_RECORD_ID, HPMRSTR_REPORTED_BY, HPMRDT_LASTSEEN_DATETIME, HPMRSTR_LOST_AREA, HPMRNUM_LOST_TYPE, HPMRSTR_LOST_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE, GSTR_IP_ADD) VALUES (?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_MRDRECORD_LOSTFOUND_DTL WHERE HPMRNUM_MRD_RECORD_ID \= ?), SYSDATE,?,?,TO_DATE(?,'dd-Mon-yyyy HH24\:MI'),?,?,?,?,?,SYSDATE,?,?)\t\t

# changed by Akash Singh, dated on 09-09-2015, bec in recordEntryDate for AGE fun 
GET_RECORD_TOBE_MOVED.HPMRT_MRD_RECORD_DTL_OLD = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HRGNUM_PUK AS patCrNo, (SELECT p.HRGSTR_FNAME||' '|| p.HRGSTR_MNAME||' '||p.HRGSTR_LNAME FROM HRGT_PATIENT_DTL p WHERE p.HRGNUM_PUK\=a.HRGNUM_PUK AND p.gnum_isvalid\=a.gnum_isvalid AND p.gnum_hospital_code\=a.gnum_hospital_code) AS patName, (SELECT c.gstr_gender_code FROM HRGT_PATIENT_DTL b, GBLT_GENDER_MST c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.GNUM_ISVALID AND  b.gstr_gender_code \= c.gstr_gender_code) AS patGender, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patAge ,(AGE(TO_DATE(gdt_entry_date,'dd-Mon-YYYY'))) AS recordEntryDate FROM HPMRT_MRD_RECORD_DTL A WHERE  A.GNUM_ISVALID \= ? AND A.HPMRNUM_SHELF_ID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_RECORD_TYPE \= ? AND A.HPMRNUM_RECORD_STATUS \= ?\t\t\t\t\t\t\t\t\t\t\t

GET_RECORD_TOBE_MOVED.HPMRT_MRD_RECORD_DTL = SELECT A.HPMRSTR_RECORD_ID AS recordDesc, A.HPMRNUM_MRD_RECORD_ID AS mrdRecordId, A.HRGNUM_PUK AS patCrNo, (SELECT p.HRGSTR_FNAME||' '|| p.HRGSTR_MNAME||' '||p.HRGSTR_LNAME FROM HRGT_PATIENT_DTL p WHERE p.HRGNUM_PUK\=a.HRGNUM_PUK AND p.gnum_isvalid\=a.gnum_isvalid AND p.gnum_hospital_code\=a.gnum_hospital_code) AS patName, (SELECT c.gstr_gender_code FROM HRGT_PATIENT_DTL b, GBLT_GENDER_MST c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= a.GNUM_ISVALID AND  b.gstr_gender_code \= c.gstr_gender_code) AS patGender, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patAge ,((TO_DATE(gdt_entry_date,'dd-Mon-YYYY'))) AS recordEntryDate FROM HPMRT_MRD_RECORD_DTL A WHERE  A.GNUM_ISVALID \= ? AND A.HPMRNUM_SHELF_ID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_RECORD_TYPE \= ? AND A.HPMRNUM_RECORD_STATUS \= ?\t

INSERT.HPMRT_MRD_RACKSHELF_CHANGE_DTL = INSERT INTO HPMRT_MRD_RACKSHELF_CHANGE_DTL(HPMRNUM_MRD_RECORD_ID, HPMRNUM_TO_MRD_CODE, HPMRNUM_TO_RACK_ID, \
											HPMRNUM_TO_SHELF_ID, HPMRSTR_REMARKS, HPMRNUM_FROM_RACK_ID, HPMRNUM_ENTRY_MODE, HPMRNUM_FROM_MRD_CODE, \
											GNUM_ISVALID, HPMRNUM_FROM_SHELF_ID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, HPMRSTR_PUT_BY, GDT_ENTRY_DATE, HRGSTR_IP_ADD) \
											VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
																						

UPDATE_RECORD_MOVEMENT_DETAIL.HPMRT_MRD_RECORD_DTL = UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_MRD_CODE \= ?, HPMRNUM_RACK_ID \= ?, HPMRNUM_SHELF_ID \= ?, HPMRSTR_PUT_BY \= ? WHERE HPMRNUM_MRD_RECORD_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?


UPDATE_FOUND_DETAIL.HPMRT_MRDRECORD_LOSTFOUND_DTL = UPDATE HPMRT_MRDRECORD_LOSTFOUND_DTL SET HPMRDT_FOUND_DATETIME \= TO_DATE(?,'dd-Mon-yyyy HH24\:MI'), GNUM_LSTMOD_SEATID \= ?, HPMRSTR_FOUND_REMARKS \= ?, HPMRSTR_FOUND_BY \= ? , GDT_LSTMOD_DATE \= SYSDATE WHERE HPMRNUM_MRD_RECORD_ID \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? AND HPMRDT_FOUND_DATETIME IS NULL


GET_BUONDED_RECORD_TYPE.HPMRT_RECORD_BOUNDING = SELECT HPMRNUM_RECORD_TYPE,(SELECT A.HPMRSTR_RECORDTYPE_DESC FROM HPMRT_MRD_RECORDTYPE_MST A WHERE A.HPMRNUM_RECORD_TYPE\= B.HPMRNUM_RECORD_TYPE AND A.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_ISVALID \= 1) FROM HPMRT_RECORD_BOUNDING B WHERE B.HPMRNUM_BOUNDING_MODE \= ? AND B.HPMRNUM_BOUNDING_ID \= ? AND B.GNUM_HOSPITAL_CODE \= ? AND B.GNUM_ISVALID \= ?
															

UPDATE.REJECT_REQUEST_INACTIVE.HPMRT_MRDRECORD_REQ_DTL = UPDATE HPMRT_MRDRECORD_REQ_DTL SET GNUM_ISVALID = ? WHERE HPMRNUM_REQ_ID = ? AND GNUM_HOSPITAL_CODE = ?



SELECT.HPMRT_EPR_TAB_MST	=SELECT HPMRNUM_EPR_TAB_ID tabId, HPMRSTR_TAB_NAME tabName, HPMRNUM_ISDEFAULT isDefault, HPMRNUM_NORMAL_BOUND_TYPE normalBoundType, HPMRNUM_RESTRICTED_BOUND_TYPE restrictedBoundType,HPMRSTR_URL tabUrl,HPMRNUM_DISPLAY_ORDER FROM HPMRT_EPR_TAB_MST a where gnum_isvalid\=? and gnum_hospital_code\=? and hpmrnum_isdefault\=?  and HPMRNUM_TAB_TYPE in(?,?) UNION SELECT HPMRNUM_EPR_TAB_ID, HPMRSTR_TAB_NAME, HPMRNUM_ISDEFAULT,HPMRNUM_NORMAL_BOUND_TYPE, HPMRNUM_RESTRICTED_BOUND_TYPE,HPMRSTR_URL tabUrl,HPMRNUM_DISPLAY_ORDER FROM HPMRT_EPR_TAB_MST a where gnum_isvalid\=? and gnum_hospital_code\=?  and HPMRNUM_TAB_TYPE in(?,?) and HPMRNUM_EPR_TAB_ID in (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND P.GSTR_TABLE_NAME \= 'HPMRT_EPR_TAB_MST' AND Q.GSTR_COLUMN_NAME \= 'HPMRNUM_EPR_TAB_ID' AND P.GNUM_SEATID \= PKG_USERMGMT.FUN_GETSEATID (?, a.GNUM_HOSPITAL_CODE )  AND P.GNUM_HOSPITAL_CODE \= a.GNUM_HOSPITAL_CODE ) order by HPMRNUM_DISPLAY_ORDER

GET_OPD_FILE_TOBE_ACCEPT_IN_MRD.HRGT_EPISODE_DTL = SELECT A.HRGNUM_PUK AS patCrNo,B.HRGSTR_FILE_NO AS dispatchId, A.HRGNUM_PUK AS recordId,B.HRGSTR_FILE_NO AS recordDesc,TO_CHAR(HRGDT_EPISODE_DATE,'DD-Mon-YYYY') AS senderDate, INITCAP(HRGSTR_FNAME||' '||HRGSTR_MNAME||' '||HRGSTR_LNAME) AS patName,B.HRGNUM_EPISODE_CODE AS episodeCode, B.HRGNUM_VISIT_NO AS episodeVisitNo, B.GNUM_DEPT_CODE AS deptCode, B.HGNUM_DEPTUNITCODE AS deptUnitCode, (SELECT D.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST D WHERE D.GNUM_DEPT_CODE \= B.GNUM_DEPT_CODE AND D.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE AND D.GNUM_ISVALID \= B.GNUM_ISVALID ) AS departmentName, (SELECT E.HGSTR_UNITNAME FROM HGBT_UNIT_MST E WHERE E.HGNUM_DEPTUNITCODE\=B.HGNUM_DEPTUNITCODE AND E.GNUM_HOSPITAL_CODE \= B.GNUM_HOSPITAL_CODE AND E.GNUM_ISVALID \= B.GNUM_ISVALID ) AS departmentUnitName FROM HRGT_PATIENT_DTL A,HRGT_EPISODE_DTL B WHERE A.HRGNUM_PUK\=B.HRGNUM_PUK AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.HRGSTR_FILE_NO IS NOT NULL AND B.GNUM_HOSPITAL_CODE\=? AND B.HRGSTR_FILE_NO NOT IN (SELECT HPMRSTR_RECORD_ID FROM HPMRT_MRD_RECORD_DTL C WHERE C.GNUM_HOSPITAL_CODE\=? AND HPMRNUM_RECORD_TYPE\=?) AND B.HGNUM_DEPTUNITCODE IN ( SELECT gnum_column_value FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST q WHERE P.gnum_metatable_id \= q.gnum_metatable_id AND gstr_table_name \='HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND P.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,?) AND P.gnum_hospital_code \= q.gnum_hospital_code AND P.gnum_hospital_code \=? )AND b.hrgdt_episode_date\=to_date(?,'dd-Mon-yyyy') ORDER BY HRGDT_EPISODE_DATE DESC


# Changed by Akash Singh, dated on 08-09-2015
SEARCH_OPD_FILE_FOR_RECORD_REQUEST_OLD = SELECT b.hrgstr_file_no,a.hrgnum_puk, a.hrgstr_fname, a.hrgstr_mname,a.hrgstr_lname, a.hrgdt_register_date,b.hrgnum_episode_code, (SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hpmrstr_record_id \= b.hrgstr_file_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS recordstatus, (SELECT hpmrnum_mrd_record_id FROM hpmrt_mrd_record_dtl WHERE hpmrstr_record_id \= b.hrgstr_file_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS mrdrecordid, (SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code \= a.gstr_gender_code AND gnum_isvalid \= ?) AS gender, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE)AS age,b.gnum_dept_code,b.hgnum_deptunitcode, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code \= b.gnum_dept_code AND b.GNUM_HOSPITAL_CODE\=e.GNUM_HOSPITAL_CODE ) ||'('||(SELECT INITCAP (x.HGSTR_UNITNAME) FROM HGBT_UNIT_MST x WHERE x.HGNUM_DEPTUNITCODE \= b.HGNUM_DEPTUNITCODE AND x.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE ) ||')' AS deptUnit FROM hrgt_patient_dtl a, hrgt_episode_dtl b WHERE a.hrgnum_puk\=b.hrgnum_puk AND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND b.hrgnum_is_old \= ? AND b.hrgstr_file_no IS NOT NULL AND (SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE hpmrstr_record_id \= b.hrgstr_file_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? ) IN (?,?) AND (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE hpmrstr_record_id \= b.hrgstr_file_no AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? ) \= ? 
										

SEARCH_OPD_FILE_FOR_RECORD_REQUEST = SELECT a.hrgnum_puk, a.hrgstr_fname, a.hrgstr_mname,a.hrgstr_lname, a.gdt_entry_date,b.hrgnum_episode_code, (SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS recordstatus, (SELECT hpmrnum_mrd_record_id FROM hpmrt_mrd_record_dtl WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ?) AS mrdrecordid, (SELECT gstr_gender_code FROM gblt_gender_mst WHERE gstr_gender_code \= a.gstr_gender_code AND gnum_isvalid \= ?) AS gender, ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE)AS age,b.gnum_dept_code,b.hgnum_deptunitcode, (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code \= b.gnum_dept_code AND b.GNUM_HOSPITAL_CODE\=e.GNUM_HOSPITAL_CODE ) ||'('||(SELECT INITCAP (x.HGSTR_UNITNAME) FROM HGBT_UNIT_MST x WHERE x.HGNUM_DEPTUNITCODE \= b.HGNUM_DEPTUNITCODE AND x.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE ) ||')' AS deptUnit FROM hrgt_patient_dtl a, hrgt_episode_dtl b WHERE a.hrgnum_puk\=b.hrgnum_puk AND a.gnum_hospital_code \= b.gnum_hospital_code AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?AND (SELECT hpmrnum_record_status FROM hpmrt_mrd_record_dtl WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? ) IN (?,?) AND (SELECT hpmrnum_record_type FROM hpmrt_mrd_record_dtl WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= ? ) \= ? 
										

SELECT_OPD_FILE_FOR_MOVEMENT.HPMRT_MRD_RECORD_DTL=SELECT hpmrnum_mrd_record_id mrdrecordid, hpmrstr_record_id recordid, hpmrnum_record_status recordstatus, hpmrnum_mrd_code mrdcode, DECODE (hpmrnum_record_status, 1, 'In MRD', 2, 'Archived', 3, 'Issued', 4, 'Lost', 5, 'Destroyed') recordstatuslabel, hpmrnum_rack_id rackid, (SELECT hpmrstr_rack_name FROM hpmrt_rack_mst WHERE hpmrnum_mrd_code \= a.hpmrnum_mrd_code AND hpmrnum_rack_id \= a.hpmrnum_rack_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) racklabel, a.hrgnum_puk patcrno, hpmrnum_shelf_id shelfid, (SELECT hmprstr_shelf_label FROM hpmrt_rack_shelf_mst WHERE hpmrnum_rack_id \= a.hpmrnum_rack_id AND hpmrnum_rackshelf_id \= a.hpmrnum_shelf_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) shelfname, hpmrnum_issue_flag issueflag, (SELECT    hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) AS patname, b.hgnum_deptunitcode as unitcode, (SELECT    hgstr_unitname || '(' || (SELECT gstr_dept_name FROM gblt_department_mst WHERE GNUM_DEPT_CODE \= u.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code  and gnum_isvalid\=1) || ')' FROM hgbt_unit_mst u WHERE hgnum_deptunitcode \= b.hgnum_deptunitcode AND gnum_hospital_code \= a.gnum_hospital_code ) as unitName, a.GDT_ENTRY_DATE as entrydate, hrgnum_que_no visitqueueno FROM hpmrt_mrd_record_dtl a, hrgt_episode_dtl b WHERE hpmrstr_record_id\= hrgstr_file_no AND a.hrgnum_puk \= b.hrgnum_puk AND a.gnum_isvalid \= b.gnum_isvalid AND a.gnum_hospital_code \= b.gnum_hospital_code AND TRUNC (b.gdt_entry_date) \= TRUNC (SYSDATE) AND hpmrnum_mrd_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? order by hpmrnum_record_status,  unitcode , hrgnum_que_no desc

UPDATE.RECORD_STATUS_ISSUE_FLAG.HPMRT_MRD_RECORD_DTL = UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_RECORD_STATUS = ?, HPMRNUM_ISSUE_FLAG=? WHERE HPMRNUM_MRD_RECORD_ID = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?

INSERT.HPMRT_MRD_RECORD_MOVEMENT_DTL=	insert into HPMRT_MRD_RECORD_MOVEMENT_DTL (HPMRNUM_MRD_RECORD_ID, HPMRSTR_EMP_NO, HPMRSTR_REMARKS, HPMRNUM_MOVEMENT_TYPE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, \
										GDT_ENTRY_DATE, HRGSTR_IP_ADD) values(?,?,?,?,?,?,?,sysdate,?)
										
SELECT_OPD_FILE_FOR_RETURN.HPMRT_MRD_RECORD_DTL= SELECT a.hpmrnum_mrd_record_id mrdrecordid, hpmrstr_record_id recordid, hpmrnum_mrd_code mrdcode, hpmrnum_rack_id rackid, TO_CHAR (b.gdt_entry_date, 'dd-Mon-yyyy') entrydate, pkg_bloodbank_mst.emp_name_empidwise (a.gnum_hospital_code, b.hpmrstr_emp_no ) issuedfor, (SELECT hpmrstr_rack_name FROM hpmrt_rack_mst WHERE hpmrnum_mrd_code \= a.hpmrnum_mrd_code AND hpmrnum_rack_id \= a.hpmrnum_rack_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) racklabel, a.hrgnum_puk patcrno, hpmrnum_shelf_id shelfid, (SELECT hmprstr_shelf_label FROM hpmrt_rack_shelf_mst WHERE hpmrnum_rack_id \= a.hpmrnum_rack_id  AND hpmrnum_rackshelf_id \= a.hpmrnum_shelf_id AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) shelfname, (SELECT    hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) AS patname, c.hgnum_deptunitcode as unitcode, (SELECT    hgstr_unitname || '(' || (SELECT gstr_dept_name FROM gblt_department_mst WHERE GNUM_DEPT_CODE \= u.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code  and gnum_isvalid\=1) || ')' FROM hgbt_unit_mst u WHERE hgnum_deptunitcode \= c.hgnum_deptunitcode AND gnum_hospital_code \= c.gnum_hospital_code ) as unitName FROM hpmrt_mrd_record_dtl a, hpmrt_mrd_record_movement_dtl b, hrgt_episode_dtl c WHERE a.hpmrstr_record_id \= c.hrgstr_file_no and a.gnum_hospital_code \= c.gnum_hospital_code AND a.gnum_isvalid \= c.gnum_isvalid and a.hrgnum_puk \= c.hrgnum_puk  AND hpmrnum_mrd_code \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ? AND a.hpmrnum_issue_flag \= ? AND b.hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id AND b.gnum_hospital_code \= a.gnum_hospital_code AND b.hpmrnum_movement_type \= ? AND b.gdt_entry_date \= (SELECT MAX (gdt_entry_date) FROM hpmrt_mrd_record_movement_dtl WHERE hpmrnum_mrd_record_id \= a.hpmrnum_mrd_record_id AND gnum_hospital_code \= a.gnum_hospital_code AND hpmrnum_movement_type \= b.hpmrnum_movement_type) AND c.gdt_entry_date \= (SELECT MAX (gdt_entry_date) FROM hrgt_episode_dtl WHERE gnum_hospital_code \= c.gnum_hospital_code AND gnum_isvalid \= c.gnum_isvalid and hrgnum_puk \= c.hrgnum_puk) order by unitcode


INSERT.HPMRT_PAT_FAMILY_DTL = INSERT INTO HPMRT_PAT_FAMILY_DTL(HPMRNUM_PAT_RELATIVE_ID, HRGNUM_PUK, HPMRSTR_RELATIVE_NAME, HPMRNUM_SLNO, GNUM_RELATION_CODE, HRGNUM_RELATIVE_PUK, GNUM_ISVALID, HPMRSTR_ADDR1, GNUM_SEAT_ID, HPMRSTR_EMAIL, GDT_ENTRY_DATE, HPMRSTR_PHONE, HPMRSTR_MOBILE, GNUM_HOSPITAL_CODE) VALUES(?,?,?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_PAT_FAMILY_DTL WHERE HPMRNUM_PAT_RELATIVE_ID\= ? AND GNUM_HOSPITAL_CODE \= ?),?,?,?,?,?,?,SYSDATE,?,?,?)


INSERT.HRGT_EPISODE_ATTENDANT_DTL = INSERT INTO HRGT_EPISODE_ATTENDANT_DTL (HRGNUM_PUK, HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_SLNO, HPMRNUM_PAT_RELATIVE_ID, HGNUM_ATTENDANT_REASON_ID, PSRSTR_EMP_NO, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD) VALUES(?,?,?,(SELECT NVL(MAX(HRGNUM_SLNO),0)+1 FROM HRGT_EPISODE_ATTENDANT_DTL WHERE HRGNUM_PUK \= ? AND HRGNUM_EPISODE_CODE \= ? AND HRGNUM_VISIT_NO \= ? ),?,?,?,?,SYSDATE,?,?,?)

SELECT.LIST_BY_PAT_EPI.HRGT_EPISODE_ATTENDANT_DTL = SELECT X.HRGNUM_PUK AS patCrNo, X.HRGNUM_EPISODE_CODE AS episodeCode, X.HRGNUM_VISIT_NO AS episodeVisitNo, X.HRGNUM_SLNO AS slNo, X.HPMRNUM_PAT_RELATIVE_ID AS patRelativeId, X.HGNUM_ATTENDANT_REASON_ID AS attendantReasonId, X.PSRSTR_EMP_NO AS empNo FROM HRGT_EPISODE_ATTENDANT_DTL X WHERE X.HRGNUM_PUK \= ? AND X.HRGNUM_EPISODE_CODE \= ? AND X.GNUM_ISVALID\=? AND X.GNUM_HOSPITAL_CODE\=? ORDER BY X.HRGNUM_VISIT_NO DESC, X.HRGNUM_SLNO


GENERATE_PAT_RELATIVE_ID.HPMRT_PAT_FAMILY_DTL = SELECT NVL(MAX(HPMRNUM_PAT_RELATIVE_ID),0)+1 FROM HPMRT_PAT_FAMILY_DTL WHERE HRGNUM_PUK= ?

SELECT.EXISTS.HPMRT_PAT_FAMILY_DTL = SELECT COUNT(HPMRNUM_PAT_RELATIVE_ID) FROM HPMRT_PAT_FAMILY_DTL WHERE UPPER(TRIM(HPMRSTR_RELATIVE_NAME)) \= UPPER(TRIM(?)) AND GNUM_RELATION_CODE\=? AND GNUM_ISVALID\=1 AND GNUM_HOSPITAL_CODE\=? AND HRGNUM_PUK\= ?

SELECT.TAB_ACCESS_POLICY.HPMRT_EPR_TABACCESS_MST_OLD	=SELECT a.HPMRNUM_EPR_TAB_ID TABID, a.HPMRNUM_ACCESS_TYPE ACCESSTYPE, HPMRNUM_ACCESS_RECORD_ID || '\#' || HPMRNUM_USER_LEVEL ACCESSTO FROM HPMRT_EPR_TABACCESS_MST A, HPMRT_EPR_TABACCESS_USERWISE b WHERE a.HGNUM_FROM_DEPTUNITCODE \= ? AND a.GNUM_HOSPITAL_CODE \=? AND a.HPMRNUM_POLICY_TYPE \= ?  AND a.GNUM_ISVALID \= ? and HPMRNUM_USER_LEVEL <\= ? and b.HGNUM_FROM_DEPTUNITCODE \= A.HGNUM_FROM_DEPTUNITCODE AND b.HPMRNUM_EPR_TAB_ID \= A.HPMRNUM_EPR_TAB_ID AND b.GNUM_HOSPITAL_CODE \=A.GNUM_HOSPITAL_CODE AND b.HPMRNUM_POLICY_TYPE \= A.HPMRNUM_POLICY_TYPE AND b.HPMRNUM_ACCESS_TYPE\=A.HPMRNUM_ACCESS_TYPE AND b.GNUM_ISVALID \= A.GNUM_ISVALID ORDER BY a.HPMRNUM_EPR_TAB_ID

SELECT.TAB_ACCESS_POLICY.HPMRT_EPR_TABACCESS_MST	=SELECT   A.HPMRNUM_EPR_TAB_ID TABID, A.HPMRNUM_ACCESS_TYPE ACCESSTYPE,A.HGNUM_TO_DEPTUNITCODE ACCESSTO,(SELECT HPMRNUM_USER_ID FROM HPMRT_EPR_TABACCESS_USERWISE B WHERE B.HGNUM_FROM_DEPTUNITCODE \= A.HGNUM_FROM_DEPTUNITCODE AND B.HPMRNUM_EPR_TAB_ID \= A.HPMRNUM_EPR_TAB_ID AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND B.HPMRNUM_POLICY_TYPE \= A.HPMRNUM_POLICY_TYPE AND A.HGNUM_TO_DEPTUNITCODE \= B.HGNUM_TO_DEPTUNITCODE AND B.GNUM_ISVALID \= A.GNUM_ISVALID) USERID,A.HPMRNUM_USER_LEVEL USERLEVEL FROM HPMRT_EPR_TABACCESS_MST A WHERE A.HGNUM_FROM_DEPTUNITCODE \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.HPMRNUM_POLICY_TYPE \= ? AND A.GNUM_ISVALID \= ? AND HPMRNUM_USER_LEVEL <\= ? ORDER BY A.HPMRNUM_EPR_TAB_ID


SELECT.BY_UNIT_AND_POLICY_TYPE.HPMRT_EPR_TABACCESS_MST	=SELECT a.HPMRNUM_EPR_TAB_ID TABID, a.HPMRNUM_ACCESS_TYPE ACCESSTYPE,HPMRNUM_USER_LEVEL userLevel FROM HPMRT_EPR_TABACCESS_MST A WHERE a.HGNUM_FROM_DEPTUNITCODE \= ? AND a.GNUM_HOSPITAL_CODE \=? AND a.HPMRNUM_POLICY_TYPE \= ?  AND a.GNUM_ISVALID \= ? and HGNUM_TO_DEPTUNITCODE\=? AND TRUNC (gdt_effective_frm) <\= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >\= TRUNC (SYSDATE) ORDER BY a.HPMRNUM_EPR_TAB_ID 

INSERT.HPMRT_EPR_TABACCESS_MST	=INSERT INTO HPMRT_EPR_TABACCESS_MST (HGNUM_FROM_DEPTUNITCODE, HPMRNUM_EPR_TAB_ID, GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE,HGNUM_TO_DEPTUNITCODE, HPMRNUM_SLNO, HPMRNUM_ACCESS_TYPE, HPMRNUM_USER_LEVEL,GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO) VALUES(?,?,?,?,?,(SELECT NVL(MAX(HPMRNUM_SLNO),0)+1 FROM HPMRT_EPR_TABACCESS_MST WHERE HGNUM_FROM_DEPTUNITCODE\=? AND HPMRNUM_EPR_TAB_ID\=? AND GNUM_HOSPITAL_CODE\=? AND HPMRNUM_POLICY_TYPE\=? AND HGNUM_TO_DEPTUNITCODE\=?),?,?,?,?,SYSDATE,SYSDATE,?)
 									
UPDATE.IS_VALID.HPMRT_EPR_TABACCESS_MST	= update HPMRT_EPR_TABACCESS_MST set GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? where HGNUM_FROM_DEPTUNITCODE\=? and HPMRNUM_EPR_TAB_ID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_POLICY_TYPE\=? and HGNUM_TO_DEPTUNITCODE\=? and HPMRNUM_SLNO\=(select max(HPMRNUM_SLNO) from HPMRT_EPR_TABACCESS_MST where HGNUM_FROM_DEPTUNITCODE\=? and HPMRNUM_EPR_TAB_ID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_POLICY_TYPE\=? and HGNUM_TO_DEPTUNITCODE\=?)
   										  
INSERT.HPMRT_EPR_TABACCESS_USERWISE	=insert into HPMRT_EPR_TABACCESS_USERWISE (HGNUM_FROM_DEPTUNITCODE, HPMRNUM_EPR_TAB_ID,GNUM_HOSPITAL_CODE, HPMRNUM_POLICY_TYPE, HGNUM_TO_DEPTUNITCODE,HPMRNUM_SLNO,HPMRNUM_USER_ID,GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO) values(?,?,?,?,?,(select nvl(max(HPMRNUM_SLNO),0)+1 from HPMRT_EPR_TABACCESS_USERWISE where HGNUM_FROM_DEPTUNITCODE\=? and HPMRNUM_EPR_TAB_ID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_POLICY_TYPE\=? and HGNUM_TO_DEPTUNITCODE\=?),?,?,?,sysdate,sysdate,?)
										
UPDATE.HPMRT_EPR_TABACCESS_USERWISE	=update HPMRT_EPR_TABACCESS_USERWISE set GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? where HGNUM_FROM_DEPTUNITCODE\=? and HPMRNUM_EPR_TAB_ID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_POLICY_TYPE\=? and HGNUM_TO_DEPTUNITCODE\=? and HPMRNUM_SLNO\=(select max(HPMRNUM_SLNO) from HPMRT_EPR_TABACCESS_USERWISE where HGNUM_FROM_DEPTUNITCODE\=? and HPMRNUM_EPR_TAB_ID\=? and GNUM_HOSPITAL_CODE\=? and HPMRNUM_POLICY_TYPE\=?  and HGNUM_TO_DEPTUNITCODE\=?)
										
SELECT.HPMRT_EPR_TABACCESS_USERWISE =SELECT HPMRNUM_EPR_TAB_ID tabId,HPMRNUM_USER_ID userId,(SELECT GSTR_USR_NAME FROM GBLT_USER_MST WHERE GNUM_USERID \= A.HPMRNUM_USER_ID AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID \= A.GNUM_ISVALID) USERNAME FROM HPMRT_EPR_TABACCESS_USERWISE A WHERE HGNUM_FROM_DEPTUNITCODE \= ? AND HPMRNUM_POLICY_TYPE \= ? AND HGNUM_TO_DEPTUNITCODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? AND TRUNC (GDT_EFFECTIVE_FRM) <\= TRUNC (SYSDATE) AND TRUNC (NVL (GDT_EFFECTIVE_TO, SYSDATE)) >\= TRUNC (SYSDATE) \t\t\t\t\t\t 
																			   										  								
INSERT.HPMRT_PAT_PROFILE_CDBURN_DTL	=	insert into HPMRT_PAT_PROFILE_CDBURN_DTL (HPMRNUM_PROFILE_ID, HBLNUM_BILL_NO, HRGNUM_PUK, HPRSTR_REMARK, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE) values(?,?,?,?,?,?,sysdate,?) 

SELECT.BY_CRNO.HIPT_PATADMISSION_DTL	=SELECT HIPNUM_ADMNO patAdmNo, HRGNUM_PUK patCrNo, HRGNUM_EPISODE_CODE episodeCode, HRGNUM_VISIT_NO episodeVisitNo, to_char(HIPDT_ADMDATETIME,'dd-Mon-yyyy hh24\:mi') admDateTime, to_char(HIPDT_DISDATETIME,'dd-Mon-yyyy hh24\:mi') disDateTime FROM HIPT_PATADMISSION_DTL  WHERE HRGNUM_PUK\=? AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ? order by admDateTime

SELECT_MED_CAMP_NO.HPMRT_MEDICAL_CAMP_DTL =  SELECT PKG_MRD_DTL.gen_medical_camp_reqno(?) FROM DUAL		




INSERT_MED_CAMP_REQ_DETAIL.HPMRT_MEDICAL_CAMP_DTL = INSERT INTO  hpmrt_medical_camp_dtl( hpmrnum_med_camp_no, hpmrnum_slno, hpmrdt_camp_req_date, hpmrdt_camp_from_datetime,  hpmrdt_camp_to_datetime, hpmrstr_description, hpmrnum_tot_female_pat_att,  hpmrnum_tot_malechild_pat_att, hpmrstr_venue, hpmrnum_tot_femalchild_pat_att, gnum_seat_id, hpmrnum_tot_pat_attended, hpmrnum_tot_male_pat_att,  gdt_entry_date, hpmrnum_camp_status, gnum_hospital_code, gnum_isvalid, hpmrstr_camp_name)  VALUES (?\:\:numeric, ?\:\:numeric,  TO_DATE (?\:\:timestamp without time zone, 'dd-Mon-yyyy'), TO_DATE (?, 'dd-Mon-yyyy hh24\:mi'), TO_DATE (?, 'dd-Mon-yyyy hh24\:mi'), ?\:\:character varying, ?\:\:numeric, ?\:\:numeric, ?\:\:character varying, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, SYSDATE, ?\:\:numeric, ?\:\:numeric, ?\:\:numeric, UPPER(?));
    													
UPDATE_MED_CAMP_REQ_DETAIL.HPMRT_MEDICAL_CAMP_DTL = UPDATE  hpmrt_medical_camp_dtl  SET hpmrdt_camp_from_datetime\=?\:\:timestamp without time zone, hpmrdt_camp_to_datetime\=?\:\:timestamp without time zone, hpmrstr_description\=?\:\:character varying, hpmrnum_tot_female_pat_att\=?\:\:numeric, hpmrnum_tot_malechild_pat_att\=?\:\:numeric, hpmrstr_venue\=?\:\:character varying, hpmrnum_tot_femalchild_pat_att\=?\:\:numeric, hpmrnum_tot_pat_attended\=?\:\:numeric, hpmrnum_tot_male_pat_att\=?\:\:numeric, hpmrnum_camp_status\=?\:\:numeric, gdt_lstmod_date\=SYSDATE, gnum_lstmod_seatid\=?\:\:numeric, hpmrstr_camp_name\=?\:\:character varying  WHERE hpmrnum_med_camp_no\=? AND gnum_hospital_code\=? AND  gnum_isvalid\=?
    																			

SELECT.RECORD_TO_MEDICAL_CAMP.HPMRT_MEDICAL_CAMP_DTL  = SELECT hpmrnum_med_camp_no AS strCampId, hpmrstr_camp_name AS strCampName, hpmrstr_venue AS strCampVenue, to_char(hpmrdt_camp_from_datetime,'dd-Mon-yyyy hh24\:mi') AS strCampStartDateTime, to_char(hpmrdt_camp_req_date,'dd-Mon-yyyy') AS strCampRequisitionDate FROM hpmrt_medical_camp_dtl WHERE gnum_hospital_code\=? AND gnum_isvalid\=? AND hpmrnum_camp_status\=1
														
SELECT.ALL_RECORD_TO_MEDICAL_CAMP.HPMRT_MEDICAL_CAMP_DTL = SELECT hpmrstr_camp_name AS strCampName, hpmrstr_venue AS strCampVenue, to_char(hpmrdt_camp_to_datetime,'dd-Mon-yyyy hh24\:mi') AS strCampEndDateTime,to_char(hpmrdt_camp_from_datetime,'dd-Mon-yyyy hh24\:mi') AS strCampStartDateTime, to_char(hpmrdt_camp_req_date,'dd-Mon-yyyy') AS strCampRequisitionDate, hpmrstr_description AS strCampDescription ,hpmrnum_tot_female_pat_att AS strTotalFemalePatientAttended, hpmrnum_tot_malechild_pat_att AS strTotalMaleChildPatientAttended, hpmrnum_tot_femalchild_pat_att AS strTotalFemaleChildPatientAttended, hpmrnum_tot_pat_attended AS strTotalNoofPatientAttended, hpmrnum_tot_male_pat_att AS strTotalMalePatientAttended, hpmrnum_camp_status AS strIsCampClosed  FROM hpmrt_medical_camp_dtl WHERE gnum_hospital_code\=? AND gnum_isvalid\=? AND hpmrnum_med_camp_no\= ?
															
SELECT.ALL_EMP_RECORD_TO_MEDICAL_CAMP.HPMRT_MEDICAL_CAMP_DTL= SELECT str_emp_no as strArrEmployeeId , ( SELECT str_emp_full_name FROM pist_emp_registration_dtl b WHERE b.STR_EMP_NO = a.str_emp_no AND gnum_isvalid=1 AND rownum=1) AS strArrEmployeeName, hpmrstr_role AS strArrRole, hpmrstr_duty_remark AS strArrDutyRemarks FROM hpmrt_med_camp_team_dtl a  WHERE gnum_hospital_code=? AND gnum_isvalid=? AND hpmrnum_med_camp_no= ?

DESTROY_RECORD_DETAIL.HPMRT_MRD_RECORD_DTL= UPDATE HPMRT_MRD_RECORD_DTL SET HPMRNUM_RECORD_STATUS = ? WHERE HPMRNUM_MRD_RECORD_ID = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?

#addedby:NehaRajgariya Date:15March2017 Purpose:Fetching login user details for requestby as per MRD UAT Point
#REQUEST_BY_LOGIN_USER_DETAILS = select (SELECT INITCAP (e.gstr_dept_name) FROM gblt_department_mst e WHERE e.gnum_dept_code = a.gnum_dept_code AND a.gnum_hospital_code = e.gnum_hospital_code AND e.gnum_isvalid = 1) departmentname, (select str_emp_full_name from pist_emp_registration_dtl where gnum_desig_code = 142 and gnum_dept_code = a.gnum_dept_code and gnum_hospital_code = a.gnum_hospital_code) hodname FROM pist_emp_registration_dtl a where str_emp_no = ? 

#addedby:Sandip naik Date:09June2017 Purpose:Fetching Department and HOU From Unit Consultaion
REQUEST_BY_LOGIN_USER_DETAILS=select string_agg((SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',') FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code=a.gnum_hospital_code and f.gnum_hospital_code=a.gnum_hospital_code and e.gnum_isvalid=1 and f.gnum_isvalid=1 and e.gnum_dept_code=SUBSTR(a.hgnum_deptunitcode,0,3)and f.hgnum_deptunitcode=a.hgnum_deptunitcode),',') departmentname,string_agg((SELECT string_agg((INITCAP (e.gstr_dept_name)|| '(' || f.hgstr_unitname||')'),',') FROM gblt_department_mst e,hgbt_unit_mst f WHERE  e.gnum_hospital_code=a.gnum_hospital_code and f.gnum_hospital_code=a.gnum_hospital_code and e.gnum_isvalid=1 and f.gnum_isvalid=1 and e.gnum_dept_code=SUBSTR(a.hgnum_deptunitcode,0,3)and f.hgnum_deptunitcode=a.hgnum_deptunitcode AND  a.hgnum_hierarchy_level IN(1,2,3,4,5) AND  a.hgnum_is_hou = 1),',') hodname FROM hgbt_unit_consultant_mst a where hgstr_emp_code =?


#addedby:NehaRajgariya Date:15March2017 Purpose:Check login user is employee or not as per MRD UAT Point(Record Approval)
CHECK_USER_IS_EMP_PIST_EMP_REGISTRATION_DTL = select a.str_emp_full_name  FROM pist_emp_registration_dtl a where a.gnum_hospital_code=? and a.str_emp_no = ? and a.gnum_isvalid=?

#addedby:NehaRajgariya Date:27March2017 Purpose:extendig case sheet request date as per MRD UAT Point
UPDATE_EXTENDED_DAYS_HPMRT_MRDRECORD_REQ_DTL  = update hpmrt_mrdrecord_req_dtl  set hpmrnum_req_status = ?, hpmrnum_issue_upto = ?, hpmrstr_extend_reason = ? where hpmrnum_req_id = ? and gnum_isvalid=1 and gnum_hospital_code=?
 
UPDATE.FOR_DAYS.HPMRT_MRDRECORD_REQ_DTL	=	update HPMRT_MRDRECORD_REQ_DTL set hpmrnum_for_days=?, HPMRNUM_UNDER_EXTENTION_SNO=0 where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?

 INSERT_HPMRT_MRDRECORD_ISS_EXTEND_DTL = insert into HPMRT_MRDRECORD_ISS_EXTEND_DTL (HPMRNUM_REQ_ID, GNUM_EXTENSION_S_NO, HPMRDT_EXTEND_REQ_DATE, HPMRNUM_EXTEND_DAYS, HPMRSTR_EXTEND_REQ_BY, HPMRSTR_EXTEND_REASON, HPMRNUM_EXTENSION_STATUS, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, GDT_ENTRY_DATE, HRGSTR_IP_ADD) values (?, (SELECT NVL(MAX(GNUM_EXTENSION_S_NO),0)+1 FROM HPMRT_MRDRECORD_ISS_EXTEND_DTL WHERE HPMRNUM_REQ_ID=?), sysdate, ?, ?, ?, 1, 1, ?, ?, sysdate, ?)
 
 SELECT_GNUM_EXTENSION_S_NO_HPMRT_MRDRECORD_ISS_EXTEND_DTL = select max(GNUM_EXTENSION_S_NO) from HPMRT_MRDRECORD_ISS_EXTEND_DTL where HPMRNUM_REQ_ID = ? and gnum_isvalid=1 and gnum_hospital_code=?
 
 UPDATE_HPMRNUM_UNDER_EXTENTION_SNO_HPMRT_MRDRECORD_REQ_DTL = update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_UNDER_EXTENTION_SNO = ? where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=? and gnum_isvalid=1
 
UPDATE.EXTENSION_SL_NO.HPMRT_MRDRECORD_REQ_DTL	=	update HPMRT_MRDRECORD_REQ_DTL set HPMRNUM_UNDER_EXTENTION_SNO=0 where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?

UPDATE.REJECTED.HPMRT_MRDRECORD_ISS_EXTEND_DTL = update HPMRT_MRDRECORD_ISS_EXTEND_DTL set HPMRNUM_EXTENSION_STATUS  = 3, hpmrstr_approved_by = ?, gnum_approved_seat_id = ?, hpmrdt_approved_date = sysdate, hpmrstr_reject_reason=? where HPMRNUM_REQ_ID=? and and GNUM_HOSPITAL_CODE=?
 
 
 UPDATE.ISSUE.HPMRT_MRDRECORD_ISS_EXTEND_DTL = update HPMRT_MRDRECORD_ISS_EXTEND_DTL set HPMRNUM_EXTENSION_STATUS  = 2, hpmrstr_approved_by = ?, gnum_approved_seat_id = ?, hpmrdt_approved_date = sysdate, hpmrstr_reject_reason=? where HPMRNUM_REQ_ID=? and GNUM_HOSPITAL_CODE=?
 
 #added by manisha gangwar date: 10.07.2017  new process MRDDocumentUpload
 SELECT.HRGT_PATIENT_DOCUMENT_DTL.COUNT_CR_NO_WISE=SELECT COUNT(*) FROM HRGT_PATIENT_DOCUMENT_DTL WHERE HRGNUM_PUK=? AND GNUM_HOSPITAL_CODE=?

INSERT.HOPT_DOC_UPLOAD_DTL=INSERT INTO HRGT_PATIENT_DOCUMENT_DTL (hrgnum_puk, hrgnum_s_no, hrgnum_episode_code, hrgnum_visit_no, \
						   HRGSTR_DOC_TITLE, hrgstr_file_name, HRGSTR_DOCUMENT_ID,HRGSTR_DIR_PATH, gnum_isvalid, gnum_seat_id, gdt_entry_date,GNUM_HOSPITAL_CODE,GNUM_FILE_TYPE,HRGSTR_MLC_NO,HRGNUM_ADMISSION_NO) \
						   VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, SYSDATE,?,?,?,?)

UPDATE.ISSCANNED_HPMRT_MRD_RECORD_DTL= UPDATE HPMRT_MRD_RECORD_DTL SET hpmrnum_is_scanned\=? WHERE hpmrnum_record_id\=? AND GNUM_HOSPITAL_CODE\=?\tAND  GNUM_ISVALID\=? 

SELECT.FOR_CASESHEET_HANDOVER_BY_PATADMNO.HPMRT_RECORD_DISPATCH_DTL_APPROVAL=SELECT hpmrnum_dispatch_id dispatchid, hpmrstr_record_id recordid, hpmrnum_record_type recordtype, gnum_deptunit_code deptunitcode, b.gnum_dept_code deptcode, a.hipnum_ward_code wardcode, hpmrnum_record_status recordstatus, a.hrgnum_puk AS patcrno, (SELECT hrgstr_fname || ' ' || hrgstr_mname || ' ' || hrgstr_lname FROM hrgt_patient_dtl WHERE hrgnum_puk \= a.hrgnum_puk AND gnum_hospital_code \= a.gnum_hospital_code) patname,(SELECT c.GSTR_GENDER_CODE FROM hrgt_patient_dtl b, gblt_gender_mst c WHERE b.hrgnum_puk \= a.hrgnum_puk AND b.gnum_hospital_code \= a.gnum_hospital_code AND c.gnum_isvalid \= ? AND  b.GSTR_GENDER_CODE \= c.GSTR_GENDER_CODE) || '/' || ahis_util.puk_age_on (a.hrgnum_puk, SYSDATE) AS patgenderage,HRGNUM_ADMISSION_NO patAdmNo,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= b.gnum_deptunit_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentunitname,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= b.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (1, 2) ) AS departmentName,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \= a.hipnum_ward_code and gnum_hospital_code\=a.gnum_hospital_code and gnum_isvalid\=?) ward, a.HRGNUM_EPISODE_CODE AS episodeCode, a.HRGNUM_VISIT_NO AS episodeVisitNo,HPMRSTR_DELAY_REASON delayReason , TO_CHAR (b.hipdt_admdatetime, 'yyyy-mm-dd hh24\:mi') AS admdatetime,  TO_CHAR (b.hipdt_disdatetime, 'yyyy-mm-dd hh24\:mi') AS dischargeDate, TO_CHAR (a.gdt_sender_date, 'yyyy-mm-dd hh24\:mi') AS sendDateTime, NVL(TO_CHAR(a.gdt_arroved_date, 'yyyy-mm-dd hh24\:mi'),'-') AS approvedDate,(SELECT gstr_usr_name FROM gblt_user_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_userid \= a.gnum_sender_seatid) AS readyBy FROM hpmrt_record_dispatch_dtl a, hipt_patadmdisc_dtl b   WHERE hpmrnum_record_status \= ?  AND a.gnum_hospital_code \= ?  AND hpmrnum_record_type in(?,?) AND HRGNUM_ADMISSION_NO\= ? and a.HRGNUM_ADMISSION_NO  \= b.hipnum_admno and a.gnum_hospital_code   \= b.gnum_hospital_code order by patName \



#End of MRDDocumentUpload
 
 