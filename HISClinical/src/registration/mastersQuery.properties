#Changed By Amit Garg as OPD G5 Changes
ESSENTIAL.GBLT_PATIENT_CAT_MST.PRIMARY_OLD=  SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_TYPE=? AND GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?  ORDER BY GSTR_PATIENT_CAT_NAME									 

ESSENTIAL.GBLT_PATIENT_CAT_MST=SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_TYPE\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_PATIENT_CAT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID \= B.GNUM_METATABLE_ID  AND B.GSTR_TABLE_NAME \= 'GBLT_PATIENT_CAT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_PATIENT_CAT_CODE' AND A.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY GSTR_PATIENT_CAT_NAME\t


ESSENTIAL.GBLT_PATIENT_CAT_MST.PRIMARY=SELECT gnum_patient_cat_code, gstr_patient_cat_name FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_type \= ? AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_FRM <\= sysdate and (TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>\=TO_DATE(SYSDATE,'DD-MM-YY')) and (GNUM_ISVALID \=? OR GNUM_ISVALID \=?)AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'GBLT_PATIENT_CAT_MST' AND gstr_column_name \= 'GNUM_PATIENT_CAT_CODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY gstr_patient_cat_name 
										
ESSENTIAL.SECONDARY.EXPIRY.DAYS.GBLT_PATIENT_CAT_MST=SELECT   gnum_patient_cat_code||'\#'|| DECODE(GNUM_ISEXPIRY,0,'0',1, date_part('day',(to_date(GSTR_EXPIRY_MONTH||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(GSTR_EXPIRY_MONTH,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')-sysdate)) ,2,GNUM_EXPIRY_DAYS) as catcodedays ,gstr_patient_cat_name FROM gblt_patient_cat_mst WHERE gnum_patient_cat_type \= ? AND gnum_hospital_code \= ? AND gdt_effective_frm <\= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (gnum_isvalid \= ? OR gnum_isvalid \= ?) AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'GBLT_PATIENT_CAT_MST' AND gstr_column_name \= 'GNUM_PATIENT_CAT_CODE' AND a.gnum_seatid \=Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_hospital_code \= ? and gnum_module_id \= ?) ORDER BY gstr_patient_cat_name \t\t\t\t\t\t\t\t\t

ESSENTIAL.PRIMARY.EXPIRY.DAYS.GBLT_PATIENT_CAT_MST=SELECT   gnum_patient_cat_code||'\#'|| DECODE(GNUM_ISEXPIRY,0,'0',1, (to_date(GSTR_EXPIRY_MONTH||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(GSTR_EXPIRY_MONTH,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')-sysdate) ,2,GNUM_EXPIRY_DAYS) as catcodedays ,gstr_patient_cat_name FROM gblt_patient_cat_mst WHERE gnum_patient_cat_type \= ? AND gnum_hospital_code \= ? AND gdt_effective_frm <\= SYSDATE AND (TO_CHAR (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY')) AND (gnum_isvalid \= ? OR gnum_isvalid \= ?) AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'GBLT_PATIENT_CAT_MST' AND gstr_column_name \= 'GNUM_PATIENT_CAT_CODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_hospital_code \= ? AND a.GNUM_MODULE_ID \=? ) ORDER BY gstr_patient_cat_name \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
										 
										 
ESSENTIAL.GBLT_PATIENT_CAT_MST.PRIMARY_CRNO=SELECT   gnum_patient_cat_code, gstr_patient_cat_name FROM gblt_patient_cat_mst  WHERE gnum_patient_cat_type \= ? AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_FRM\t<\= sysdate and (TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>\=TO_DATE(SYSDATE,'DD-MM-YY')) and (GNUM_ISVALID \=? OR GNUM_ISVALID \=?)AND gnum_patient_cat_code IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'GBLT_PATIENT_CAT_MST' AND gstr_column_name \= 'GNUM_PATIENT_CAT_CODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=?) AND gnum_patient_cat_code NOT IN   (SELECT   D.HGNUM_PATIENT_CAT_CODE FROM HRGT_PATIENT_DTL D  WHERE  D.HRGNUM_PUK\=? AND D.GNUM_HOSPITAL_CODE\=gnum_hospital_code ) ORDER BY gstr_patient_cat_name




ESSENTIAL.GBLT_PATIENT_CAT_MST.SECONDARY=SELECT GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE IN (SELECT HRGNUM_PAT_SEC_CAT_CODE FROM HRGT_PATIENT_CAT_MAPPING_MST WHERE HRGNUM_PAT_PRI_CAT_CODE \= ? AND GNUM_ISVALID\=?) AND GNUM_PATIENT_CAT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID \= B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME \= 'GBLT_PATIENT_CAT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_PATIENT_CAT_CODE' AND A.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY GSTR_PATIENT_CAT_NAME


ESSENTIAL.GBLT_REG_CAT_MST=SELECT GNUM_REG_CAT_CODE, GSTR_REG_CAT_NAME FROM GBLT_REG_CAT_MST WHERE GNUM_ISVALID\=? AND (GDT_EFFECTIVE_FRM<\=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>\=trunc(sysdate)) AND GNUM_HOSPITAL_CODE\=? AND GNUM_REG_CAT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID \= B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME \= 'GBLT_REG_CAT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_REG_CAT_CODE' AND A.GNUM_SEATID \=Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY GSTR_REG_CAT_NAME\t\t\t\t\t\t\t\t\t 

ESSENTIAL.GBLT_GENDER_MST=		SELECT GNUM_GENDER_CODE, GSTR_GENDER_NAME FROM GBLT_GENDER_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GNUM_GENDER_CODE

 										  
ESSENTIAL.GBLT_MARITAL_STATUS_MST=	SELECT GNUM_MARITAL_STATUS_CODE, GSTR_MARITAL_STATUS FROM GBLT_MARITAL_STATUS_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_MARITAL_STATUS


ESSENTIAL.GBLT_USER_MST=   SELECT GNUM_USERID, INITCAP(GSTR_USER_NAME) FROM GBLT_USER_MST WHERE GNUM_ISVALID=? ORDER BY INITCAP(GSTR_USER_NAME)

ESSENTIAL.OPD.GBLT_USER_MST= SELECT GNUM_USER_SEATID, INITCAP(GSTR_USR_NAME) FROM GBLT_USER_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? and (GDT_EFFECT_DATE <\=trunc(sysdate) and nvl(GDT_EXPIRY_DATE,sysdate+1) >\=trunc(sysdate)) ORDER BY INITCAP(GSTR_USR_NAME)                                          
ESSENTIAL.GBLT_RELIGION_MST=		SELECT GNUM_RELIGION_CODE, GSTR_RELIGION_NAME FROM GBLT_RELIGION_MST WHERE  GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_RELIGION_NAME

										  
#Modified by Shruti shail on 21-Apr-2017
ESSENTIAL.GBLT_DEPARTMENT_MST_1=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE  GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_DEPT_TYPE\=?  ORDER BY GSTR_DEPT_NAME 
										  
										  
ESSENTIAL.GBLT_DEPARTMENT_MST.OLD=SELECT DISTINCT SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3), B.GSTR_DEPT_NAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A, GBLT_DEPARTMENT_MST B WHERE A.HOPDT_START_DT<\=SYSDATE AND A.HOPDT_END_DT>\=SYSDATE AND B.GNUM_DEPT_CODE\=SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3) AND A.GNUM_ISVALID\=? AND B.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY B.GSTR_DEPT_NAME\t  


ESSENTIAL.GBLT_DEPARTMENT_MST=SELECT DISTINCT SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3), B.GSTR_DEPT_NAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A, GBLT_DEPARTMENT_MST B WHERE A.HOPDT_START_DT <\= SYSDATE AND A.HOPDT_END_DT >\= SYSDATE AND B.GNUM_DEPT_CODE \= SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3) AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND GDT_EFFECTIVE_FRM<\=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>\=trunc(sysdate) AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE\=? AND B.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,Q.GNUM_HOSPITAL_CODE) AND P.GNUM_HOSPITAL_CODE\=Q.GNUM_HOSPITAL_CODE AND P.GNUM_HOSPITAL_CODE\=?\t) ORDER BY B.GSTR_DEPT_NAME 

ESSENTIAL.GBLT_CITY_LOCATION_MST=	SELECT GNUM_CITY_LOC_CODE, GSTR_CITY_LOC_NAME FROM GBLT_CITY_LOCATION_MST WHERE  GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_CITY_LOC_NAME


ESSENTIAL.GBLT_STATE_MST =	SELECT GNUM_STATECODE, GSTR_STATENAME FROM GBLT_STATE_MST WHERE  GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_STATENAME


ESSENTIAL.GBLT_COUNTRY_MST =		SELECT GNUM_COUNTRYCODE, GSTR_COUNTRYNAME FROM GBLT_COUNTRY_MST WHERE  GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_COUNTRYNAME
										                            
                                          
ESSENTIAL.GBLT_EXT_INSTITUTE_MST=		SELECT   GNUM_INSTITUTE_CODE,GSTR_INSTITUTE_NAME FROM GBLT_EXT_INSTITUTE_MST WHERE gnum_isvalid = ? AND gnum_hospital_code = ? ORDER BY GSTR_INSTITUTE_NAME         
                                          
                                              

ESSENTIAL.FOR_REFERAL.GBLT_EXT_INSTITUTE_MST =		SELECT   GNUM_INSTITUTE_CODE,GSTR_INSTITUTE_NAME FROM GBLT_EXT_INSTITUTE_MST WHERE gnum_isvalid = ? AND gnum_hospital_code = ? ORDER BY GSTR_INSTITUTE_NAME
                                  
                                                                                 

ESSENTIAL.REVISIT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID \= ? AND GNUM_SEAT_ID \= ? AND GNUM_HOSPITAL_CODE\=? AND GNUM_DEPT_CODE  NOT IN (SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK \= ? AND GNUM_HOSPITAL_CODE\=?) AND GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,Q.GNUM_HOSPITAL_CODE) AND P.GNUM_HOSPITAL_CODE\=Q.GNUM_HOSPITAL_CODE AND P.GNUM_HOSPITAL_CODE\=?) ORDER BY GSTR_DEPT_NAME
										        
										        
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST1=SELECT  DISTINCT SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3), B.GSTR_DEPT_NAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A, GBLT_DEPARTMENT_MST B WHERE A.HOPDT_START_DT<\=SYSDATE AND A.HOPDT_END_DT>\=SYSDATE AND B.GNUM_DEPT_CODE\=SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3) AND A.GNUM_ISVALID\=? AND SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3) NOT IN (SELECT DISTINCT M.GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL M WHERE M.HRGNUM_PUK \= ? AND M.GNUM_ISVALID \= ? AND M.HRGNUM_IS_EPISODE_OPEN\=? AND M.HRGNUM_VISIT_NO >\= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK \= ?) AND (Z.HRGSTR_EPISODE_CODE \= M.HRGSTR_EPISODE_CODE) AND (Z.GNUM_ISVALID \= ?))) ORDER BY B.GSTR_DEPT_NAME\t\t\t\t\t\t\t\t        
			
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST2=SELECT DISTINCT SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3), B.GSTR_DEPT_NAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A, GBLT_DEPARTMENT_MST B WHERE A.HOPDT_START_DT <\= SYSDATE AND A.HOPDT_END_DT >\= SYSDATE AND B.GNUM_DEPT_CODE \= SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3) AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE\=? AND  NOT EXISTS (SELECT  M.GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL M WHERE M.HRGNUM_PUK \= ? AND M.GNUM_ISVALID \= ? AND M.HRGNUM_IS_EPISODE_OPEN \= ? AND SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3)\=M.GNUM_DEPT_CODE AND M.GNUM_HOSPITAL_CODE\=? AND M.HRGNUM_VISIT_NO >\= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK \= ?) AND Z.HRGNUM_EPISODE_CODE \= M.HRGNUM_EPISODE_CODE AND Z.GNUM_ISVALID \= ? ))  AND B.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,Q.GNUM_HOSPITAL_CODE) AND P.GNUM_HOSPITAL_CODE\=Q.GNUM_HOSPITAL_CODE AND P.GNUM_HOSPITAL_CODE\=?) ORDER BY B.GSTR_DEPT_NAME
												
												
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST_3-11-09_changed_for_file_number=SELECT DISTINCT SUBSTR (a.hopnum_deptunitcode, 1, 3), (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= SUBSTR (a.hopnum_deptunitcode, 1, 3) and gnum_hospital_code\=a.gnum_hospital_code and gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS DEPTNAME FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND HGNUM_ROSTER_TYPE\=1 AND a.gnum_isvalid \= ? and gnum_hospital_code\=? AND NOT EXISTS (SELECT m.gnum_dept_code FROM hrgt_episode_dtl m  WHERE m.hrgnum_puk \= ? AND m.gnum_isvalid \= ? AND SUBSTR (a.hopnum_deptunitcode, 1, 3) \=m.gnum_dept_code and m.HRGNUM_VISIT_TYPE\=? AND m.gnum_hospital_code \= ?  and HRGNUM_IS_EPISODE_OPEN\=1 AND m.hrgnum_visit_no >\=ALL (SELECT z.hrgnum_visit_no AS episodevisitno      FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk \= m.hrgnum_puk) AND (z.hrgnum_episode_code \= m.hrgnum_episode_code) AND (z.gnum_isvalid \= 1)and z.hrgnum_visit_type\=m.hrgnum_visit_type AND (z.gnum_hospital_code \= m.gnum_hospital_code))) AND SUBSTR (a.hopnum_deptunitcode, 1, 3) IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p,gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'GBLT_DEPARTMENT_MST' AND gstr_column_name \= 'GNUM_DEPT_CODE' AND p.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,q.GNUM_HOSPITAL_CODE) AND p.gnum_hospital_code \= q.gnum_hospital_code   AND p.gnum_hospital_code \= ?) AND SUBSTR (a.hopnum_deptunitcode, 1, 3) IN ( SELECT GNUM_DEPT_CODE FROM GBLT_DEPARTMENT_MST WHERE gnum_hospital_code \= A.gnum_hospital_code  AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND (gnum_isvalid \= 1 OR gnum_isvalid \= 2)) ORDER BY deptname 
												
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST=SELECT DISTINCT SUBSTR (a.hopnum_deptunitcode, 1, 3), (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= SUBSTR (a.hopnum_deptunitcode, 1, 3) AND gnum_hospital_code \= a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS deptname FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND hgnum_roster_type \= 1 AND a.gnum_isvalid \= ? AND gnum_hospital_code \= ? AND NOT EXISTS ( SELECT m.gnum_dept_code FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.gnum_isvalid \= ? AND SUBSTR (a.hopnum_deptunitcode, 1, 3) \= m.gnum_dept_code AND m.hrgnum_visit_type \= ? AND m.gnum_hospital_code \= ?) AND SUBSTR (a.hopnum_deptunitcode, 1, 3) IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'GBLT_DEPARTMENT_MST' AND gstr_column_name \= 'GNUM_DEPT_CODE' AND p.gnum_seatid \= pkg_usermgmt.fun_getseatid (?, q.gnum_hospital_code) AND p.gnum_hospital_code \= q.gnum_hospital_code AND p.gnum_hospital_code \= ?) ORDER BY deptname
												
ESSENTIAL.NEW_DEPT_VISIT_COUNTER_WISE.GBLT_DEPARTMENT_MST=SELECT distinct gnum_dept_code, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code AND gnum_hospital_code \= a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AS deptname FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND hgnum_roster_type \= 1 AND a.gnum_isvalid \= ? AND gnum_hospital_code \= ? AND NOT EXISTS ( SELECT m.gnum_dept_code FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.gnum_isvalid \= ? AND  a.gnum_dept_code \= m.gnum_dept_code AND m.hrgnum_visit_type \= ? AND m.gnum_hospital_code \= ?) AND gnum_dept_code IN (  SELECT gnum_dept_code FROM gblt_counter_dept_mst WHERE gblnum_counter_id \= (SELECT gblnum_counter_id FROM gblt_counter_mst WHERE TRIM (gblstr_ip_addr) \= TRIM (?) AND gnum_isvalid \= 1 AND gnum_hospital_code \= ?) AND gnum_isvalid \= 1 AND gnum_hospital_code \= ?) ORDER BY deptname

																						                                           										  										  
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST_111=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID \= ? AND GNUM_DEPT_CODE  NOT IN (SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ?) AND GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY GSTR_DEPT_NAME

																			  
ESSENTIAL.NEW_DEPT_VISIT.GBLT_DEPARTMENT_MST11=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID \= ? AND GNUM_SEAT_ID \= ? AND GNUM_DEPT_CODE  NOT IN (SELECT DISTINCT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK \= ? AND GNUM_ISVALID \= ?) AND GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY GSTR_DEPT_NAME
										                                           										  										  
										  
ESSENTIAL.OLD_DEPT_VISIT.GBLT_DEPARTMENT_MST1=SELECT  DISTINCT SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3), B.GSTR_DEPT_NAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A, GBLT_DEPARTMENT_MST B WHERE A.HOPDT_START_DT<\=SYSDATE AND A.HOPDT_END_DT>\=SYSDATE AND B.GNUM_DEPT_CODE\=SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3) AND A.GNUM_ISVALID\=? AND SUBSTR(A.HOPNUM_DEPTUNITCODE,1, 3) IN (SELECT DISTINCT M.GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL M WHERE M.HRGNUM_PUK \= ? AND M.GNUM_ISVALID \= ? AND M.HRGNUM_IS_EPISODE_OPEN\=? AND M.HRGNUM_VISIT_NO >\= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK \= ?) AND (Z.HRGSTR_EPISODE_CODE \= M.HRGSTR_EPISODE_CODE) AND (Z.GNUM_ISVALID \= ?))) AND B.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY B.GSTR_DEPT_NAME\t\t\t\t\t\t\t\t\t\t        

ESSENTIAL.OLD_DEPT_VISIT.GBLT_DEPARTMENT_MST=SELECT DISTINCT B.GSTR_DEPT_NAME, B.GNUM_DEPT_CODE FROM GBLT_DEPARTMENT_MST B WHERE B.GNUM_ISVALID \= ? AND B.GNUM_DEPT_CODE IN (SELECT DISTINCT M.GNUM_DEPT_CODE WHERE M.HRGNUM_PUK \= ? AND M.GNUM_ISVALID \= ? AND M.HRGNUM_IS_EPISODE_OPEN \= ? AND M.HRGNUM_VISIT_NO >\= ALL (SELECT Z.HRGNUM_VISIT_NO AS EPISODEVISITNO FROM HRGT_EPISODE_DTL Z WHERE (Z.HRGNUM_PUK \= ?) AND (Z.HRGSTR_EPISODE_CODE \= M.HRGSTR_EPISODE_CODE) AND (Z.GNUM_ISVALID \= ?))) AND B.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND Q.GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,b.GNUM_HOSPITAL_CODE)) ORDER BY B.GSTR_DEPT_NAME\t\t\t

ESSENTIAL.GBLT_EPISODE_ACTION_MST.EMG=		SELECT GNUM_EPISODE_ACTION_CODE, GSTR_EPISODE_ACTION_NAME FROM GBLT_EPISODE_ACTION_MST WHERE GNUM_ISVALID=? AND HRGNUM_VISIT_TYPE=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_EPISODE_ACTION_NAME        			


ESSENTIAL.GBLT_VERIFICATION_DOCUMENT_MST=	SELECT GNUM_DOCUMENT_CODE||'|'||GSTR_DOCUMENT_NAME,GSTR_DOCUMENT_NAME FROM GBLT_VERIFICATION_DOCUMENT_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=?

												
ESSENTIAL.GBLT_ADDRESS_TYPE_MST=	SELECT GNUM_ADDRESS_TYPE_CODE, GSTR_ADDRESS_TYPE FROM GBLT_ADDRESS_TYPE_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_ADDRESS_TYPE


ESSENTIAL.GBLT_DEPARTMENT_WITH_CASUALITY_MST =	SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_DEPT_NAME 

                                                                                     
ESSENTIAL.GBLT_RELATION_MST	=	SELECT GNUM_RELATION_CODE, INITCAP(GSTR_RELATION_NAME) FROM GBLT_RELATION_MST WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_RELATION_NAME

ESSENTIAL.GET_RELATION.GBLT_RELATION_MST = SELECT   gnum_relation_code, gstr_relation_name FROM gblt_relation_mst WHERE gnum_isvalid = ?  and GNUM_HOSPITAL_CODE = ? ORDER BY gstr_relation_name
											  
ESSENTIAL.HGBT_WARD_MST.WARD_OLD=SELECT HANUM_WARD_CODE, HASTR_WARD_NAME FROM HGBT_WARD_MST WHERE HANUM_WARD_CODE IN (SELECT HANUM_WARD_CODE FROM HGBT_WARD_ROOM_MST WHERE HANUM_DEPT_CODE \= ? AND GNUM_ISVALID\=?) ORDER BY HASTR_WARD_NAME 


ESSENTIAL.HGBT_WARD_MST.WARD=	SELECT   hipnum_ward_code, hipstr_ward_name FROM hipt_ward_mst a  WHERE \
				 				GNUM_HOSPITAL_CODE=? AND TRUNC(SYSDATE) BETWEEN GDT_EFFECTIVE_FRM AND NVL(GDT_EFFECTIVE_TO,TRUNC(SYSDATE)) AND GNUM_ISVALID = 1 AND \
			         			hipnum_ward_code IN (SELECT hipnum_ward_code FROM HIPT_DUWRBED_MST WHERE \
				 				GNUM_DEPT_CODE= ? AND gnum_isvalid = ? AND GNUM_HOSPITAL_CODE= a.gnum_hospital_code) \
				 				ORDER BY hipstr_ward_name	                                      
	                                      
ESSENTIAL.GBLT_EPISODE_ACTION_MST.OPD=	SELECT GNUM_EPISODE_ACTION_CODE, GSTR_EPISODE_ACTION_NAME FROM GBLT_EPISODE_ACTION_MST WHERE GNUM_ISVALID=? AND HRGNUM_VISIT_TYPE=?  ORDER BY GSTR_EPISODE_ACTION_NAME

//------------------Query-Changed---------		  			 
ESSENTIAL.HGBT_UNIT_MST.UNIT_CHANGE_11Apr_09=SELECT HGNUM_DEPTUNITCODE, HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE <> ? AND GNUM_ISVALID \= ? AND HGNUM_DEPTUNITCODE IN ( SELECT HOPNUM_DEPTUNITCODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPDT_START_DT <\= SYSDATE AND SYSDATE < HOPDT_END_DT AND SUBSTR (HOPNUM_DEPTUNITCODE, 1,3)  \= ?) ORDER BY HGSTR_UNITNAME\t

ESSENTIAL.HGBT_UNIT_MST.UNIT_CHANGE=SELECT HGNUM_DEPTUNITCODE, HGSTR_UNITNAME FROM HGBT_UNIT_MST a WHERE HGNUM_DEPTUNITCODE <> ? AND a.GNUM_ISVALID \= ? AND a.gnum_hospital_code \= ? AND a.gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (a.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND a.HGNUM_DEPTUNITCODE IN ( SELECT HOPNUM_DEPTUNITCODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPDT_START_DT <\= SYSDATE AND SYSDATE < HOPDT_END_DT AND SUBSTR (HOPNUM_DEPTUNITCODE, 1,3)  \= ? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) ORDER BY HGSTR_UNITNAME\t


ESSENTIAL.SELECT_NAME_VALUES_DISPLAY=SELECT A.GSTR_DEPT_NAME AS DEPARTMENT, (SELECT \t hgstr_room_name FROM  hgbt_room_mst b WHERE b.hgnum_room_code \= ? AND B.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE ) AS ROOM,(SELECT c.hgstr_unitname FROM  hgbt_unit_mst C WHERE C.gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (C.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND C.hgnum_deptunitcode \=? AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND (C.GNUM_ISVALID\=? OR C.GNUM_ISVALID\=?) ) AS DEPARTMENTUNIT FROM GBLT_DEPARTMENT_MST A WHERE A.gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL (A.gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND a.gnum_dept_code \=? AND A.GNUM_HOSPITAL_CODE\=? AND (A.GNUM_ISVALID\=? or A.GNUM_ISVALID\=?)
										
ESSENTIAL.SELECT_NAME_VALUES_DISPLAY_EMERGENCY=SELECT A.GSTR_DEPT_NAME AS department,C.HGSTR_UNITNAME AS departmentUnit FROM GBLT_DEPARTMENT_MST A , HGBT_UNIT_MST C WHERE A.GNUM_ISVALID \= ? AND A.GNUM_DEPT_CODE \= ? AND C.HGNUM_DEPTUNITCODE \= ?
  											
ESSENTIAL.NATIONALITY.GBLT_COUNTRY_MST=	SELECT GNUM_COUNTRYCODE, GSTR_NATIONALITY FROM GBLT_COUNTRY_MST WHERE  GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? ORDER BY GSTR_NATIONALITY


ESSENTIAL.REFERRED_TO_DEPT.HRGT_EPISODE_REFFER_DTL=SELECT DISTINCT A.GNUM_DEPT_CODE, A.GSTR_DEPT_NAME, B.HRGNUM_REFF_DEPT_CODE FROM GBLT_DEPARTMENT_MST A, HRGT_EPISODE_REFFER_DTL B WHERE A.GNUM_ISVALID \= ? AND A.GNUM_DEPT_CODE \= B.HRGNUM_REFF_DEPT_CODE AND B.HRGSTR_IS_REFF_IN_OUT \= ? AND B.HRGNUM_PUK \= ?
													
													
ESSENTIAL.REFERRED_FROM_DEPT.HRGT_EPISODE_DTL=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE \= (SELECT GNUM_DEPT_CODE FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK \= ? AND HRGSTR_EPISODE_CODE \= (SELECT B.HRGSTR_EPISODE_CODE FROM HRGT_EPISODE_REFFER_DTL B WHERE B.HRGSTR_IS_REFF_IN_OUT \= ? AND B.HRGNUM_PUK \= ?))

#Start:Sheeldarshi:Enquiry Changes
#ESSENTIAL.ALL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GDT_EFFECTIVE_FRM<\=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>\=trunc(sysdate) and GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE\=? ORDER BY GSTR_DEPT_NAME
ESSENTIAL.ALL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE\=? ORDER BY GSTR_DEPT_NAME

#ESSENTIAL.HGBT_UNIT_MST.DEPT=select HGNUM_DEPTUNITCODE,HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPT_CODE like ? AND GNUM_ISVALID \=? AND GNUM_HOSPITAL_CODE \=? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ORDER BY HGSTR_UNITNAME
ESSENTIAL.HGBT_UNIT_MST.DEPT=select HGNUM_DEPTUNITCODE,HGSTR_UNITNAME from HGBT_UNIT_MST where GNUM_DEPT_CODE like ? AND GNUM_ISVALID \=? AND GNUM_HOSPITAL_CODE \=?  ORDER BY HGSTR_UNITNAME
#End:Sheeldarshi:Enquiry Changes

ESSENTIAL.HGBT_UNIT_MST.SPECIALITY= SELECT   HGNUM_DEPTUNITCODE||'@'||HGNUM_ISGENERAL,(SELECT x.gstr_dept_name FROM gblt_department_mst x WHERE x.gnum_dept_code \= SUBSTR (HGNUM_DEPTUNITCODE, 1, 3) AND x.gnum_hospital_code \= ? AND x.gnum_isvalid \= ?) || ' (' || c.hgstr_unitname || ')' deptName FROM  hgbt_unit_mst c WHERE  gnum_hospital_code \=? AND c.gnum_isvalid \= ? ORDER BY deptName
	
						 												
ESSENTIAL.GET.HGBT_ROOM_MST.SEQUENCE = SELECT a.HGSTR_ROOM_NAME as roomName,b.HRGNUM_SEQUENCE as sequenceNo,a.HGNUM_ROOM_CODE as roomcode, b.hgnum_deptunitcode as departmentUnitCode from HGBT_ROOM_MST a,HRGT_DEPT_UNIT_ROOM_MST b where a.HGNUM_ROOM_CODE \=b.HGNUM_ROOM_CODE and a.GNUM_ISVALID \=? and b.HGNUM_UNIT_CODE  \=? and GNUM_DEPT_CODE \=?\t\t\t\t\t\t\t\t\t\t\t\t


ESSENTIAL.UPDATE.HRGT_DEPT_UNIT_ROOM_MST= update HRGT_DEPT_UNIT_ROOM_MST set HRGNUM_SEQUENCE \=? where HGNUM_DEPTUNITCODE\= ?and  GNUM_DEPT_CODE \=  ?and HGNUM_ROOM_CODE \= ?
													
ESSENTIAL.GET.HOPT_ROSTER_MST.SEQUENCE = Select a.HGSTR_UNITNAME as UNITNAME,b.HGNUM_DEPTUNITCODE as departmentunitcode, b.HOPSTR_START_TIME as starttime,b.HOPSTR_END_TIME as endtime,b.HGNUM_SEQ_NO as sequenceNO from HGBT_UNIT_MST a, HOPT_ROSTER_MST b  Where substr(a.HGNUM_DEPTUNITCODE,4,5) \=b.HGNUM_DEPTUNITCODE and substr(b.HGNUM_DEPTUNITCODE,1,3) \= ? and b.HOPNUM_WEEK_DAY \=? and b.GNUM_ISVALID\=? Order by b.HGNUM_DEPTUNITCODE,b.HOPNUM_WEEK_DAY,HOPSTR_START_TIME 


ESSENTIAL.UPDATE.HOPT_ROSTER_MST=	UPDATE HOPT_ROSTER_MST SET HGNUM_SEQ_NO= ? WHERE HGNUM_DEPTUNITCODE =? AND HOPNUM_WEEK_DAY = ? AND HOPSTR_START_TIME =? AND HGNUM_SEQ_NO = ?

													
ESSENTIAL.HOPT_ROSTER_MST.DEPT_WEEKDAY=		Select substr(HGNUM_DEPTUNITCODE,1,3),HOPSTR_OPD_NAME from HOPT_ROSTER_MST where HOPNUM_WEEK_DAY =? and GNUM_ISVALID =?


ESSENTIAL.GBLT_DEATH_MANNER_MST	=	SELECT GNUM_DEATH_MANNER_CODE, INITCAP(GSTR_DEATH_MANNER_DESC) FROM GBLT_DEATH_MANNER_MST WHERE GNUM_ISVALID=?


ESSENTIAL.HGBT_DIAGNOSIS_TYPE_MST =		SELECT HGBNUM_DIAGNOSTIC_TYPE_CODE, HGBSTR_DIAGNOSTIC_TYPE_NAME FROM  HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_ISVALID= ? 

 

ESSENTIAL.GBLT_SHIFT_MST=SELECT HGNUM_SHIFT_CODE shiftCode, HRGSTR_SHIFT_DESC shiftDescription, HOPSTR_START_TIME shiftStartTime, HOPSTR_END_TIME shiftEndTime, GDT_ENTRY_DATE shiftEntryDate, GNUM_SEAT_ID shiftSeatId, GNUM_ISVALID shiftIsValid FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID \= ? AND GBLT_SHIFT_TYPE\= ? AND GNUM_HOSPITAL_CODE \= ? 
							
ESSENTIAL.ICD.CODE.HGBT_ICD_DISEASE_MST=SELECT HGBSTR_DISEASE_CODE,HGBSTR_DISEASE FROM HGBT_ICD_DISEASE_MST WHERE GNUM_ISVALID= ? ORDER BY HGBSTR_DISEASE 							

SELECT.BY.ICD.CODE.HGBT_ICD_DISEASE_MST=SELECT HGBSTR_DISEASE_CODE,HGBSTR_DISEASE FROM HGBT_ICD_DISEASE_MST WHERE HGBSTR_DISEASE_CODE LIKE UPPER(?) AND GNUM_ISVALID=?

SELECT.BY.DISEASE.NAME.HGBT_ICD_DISEASE_MST=SELECT HGBSTR_DISEASE,HGBSTR_DISEASE_CODE FROM HGBT_ICD_DISEASE_MST WHERE HGBSTR_DISEASE LIKE UPPER(?) AND GNUM_ISVALID=?


ESSENTIAL.DIAGNOSIS.TYPE.HGBT_DIAGNOSIS_TYPE_MST=SELECT HGBNUM_DIAGNOSTIC_TYPE_CODE ,HGBSTR_DIAGNOSTIC_TYPE_NAME FROM HGBT_DIAGNOSIS_TYPE_MST WHERE GNUM_ISVALID=? and GNUM_HOSPITAL_CODE =?

INSERT.HGBT_UNIT_MST=INSERT INTO HGBT_UNIT_MST (HGNUM_DEPTUNITCODE, HGNUM_DEPT_CODE, HGSTR_UNITNAME, PSRSTR_EMP_NO, HGNUM_UNIT_SLNO, HGNUM_SEAT_ID,HGDT_ENTRY_DATE, HGNUM_ISGENERAL, GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO, HGNUM_UNIT_CODE, GNUM_ISVALID, GNUM_ISEXPIRY, GNUM_EXPIRY_DAY, GNUM_EXPIRY_MONTH, GNUM_DIAGNOSIS_CODE_TYPE, HGBNUM_EPI_DEFAULT_CLOSE_DAYS,GNUM_LOCATION_CODE,GNUM_HOSPITAL_CODE,HGNUM_ISFILEREQUIRED,HGNUM_ISUNIT,HGSTR_FILE_PREFIX, HGNUM_FILE_STARTS_FROM, HGNUM_FILE_DEPTCODE, HGNUM_FILE_DEPTUNITCODE,HGSTR_CARDPRINT_SETTING,HGSTR_FILEPRINT_SETTING) VALUES(?,?,?,?,1,?,sysdate,?,to_date(?,'dd-Mon-yyyy'),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,upper(?),?,?,?,?,?) 
											 	
INSERT.HGBT_UNIT_CONSULTANT_MST= INSERT INTO HGBT_UNIT_CONSULTANT_MST (HGNUM_DEPTUNITCODE, HGSTR_EMP_CODE,HGDT_ENTRY_DATE, HGNUM_SEAT_ID, HGNUM_LOCATION_CODE,GNUM_ISVALID,HGNUM_IS_HOU,GNUM_HOSPITAL_CODE,HGDT_EMP_FROM_DATE,HGNUM_SLNO,HGNUM_HIERARCHY_LEVEL)VALUES(?,?,sysdate,?,?,?,?,?,sysdate, (select nvl(max(HGNUM_SLNO),0)+1 from HGBT_UNIT_CONSULTANT_MST where HGNUM_DEPTUNITCODE \= ? and HGSTR_EMP_CODE \= ? and GNUM_HOSPITAL_CODE \= ?),?)
                                       
INSERT.HRGT_DEPT_UNIT_ROOM_MST= 			 INSERT INTO HRGT_DEPT_UNIT_ROOM_MST \
 											 (HGNUM_DEPTUNITCODE, GNUM_DEPT_CODE, HGNUM_UNIT_CODE, \
 											 HGNUM_ROOM_CODE, HRGNUM_CAPACITY, HRGNUM_SEQUENCE, \
 											 GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_ISVALID, \
 											 GDT_EFFECTIVE_FRM, GDT_EFFECTIVE_TO,GNUM_HOSPITAL_CODE,HRGNUM_CAPACITY_MODE) \
 											 VALUES(?,?,?,?,?,?,?,sysdate,?,to_date(?,'dd-Mon-yyyy '),to_date(?,'dd-Mon-yyyy '),?,?)
	
SELECT.CONSULTANT.UNIT.HGBT_UNIT_CONSULTANT_MST_OLD= SELECT a.hgnum_deptunitcode AS departmentunitcode, a.hgstr_emp_code AS empno, HGNUM_HIERARCHY_LEVEL hierarchyLevel,a.hgnum_location_code AS locationcode, a.hgnum_is_hou AS ishou, NVL((SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name || '(' || (SELECT str_desig_st_name FROM pist_designation_mst WHERE num_desig_id \= b.num_desig_id AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and gnum_hospital_code\=a.gnum_hospital_code) || ')' || '(' || a.str_emp_no || ')' AS empname FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b WHERE a.str_emp_no \= b.str_emp_no AND a.gnum_isvalid \= ? AND b.gnum_isvalid \= ? AND a.str_emp_no \= hgstr_emp_code),'Empname not found in PIS') AS employeefullname FROM hgbt_unit_consultant_mst a WHERE a.hgnum_deptunitcode \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?  order by a.hgnum_is_hou desc,HGNUM_HIERARCHY_LEVEL

SELECT.CONSULTANT.UNIT.HGBT_UNIT_CONSULTANT_MST=SELECT c.hgnum_deptunitcode AS departmentunitcode, c.hgstr_emp_code AS empno, HGNUM_HIERARCHY_LEVEL hierarchyLevel,c.hgnum_location_code AS locationcode, c.hgnum_is_hou AS ishou, NVL((SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name || '(' || (SELECT str_desig_st_name FROM pist_designation_mst WHERE num_desig_id = a.num_desig_id AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and gnum_hospital_code\=a.gnum_hospital_code) || ')' || '(' || a.str_emp_no || ')' AS empname FROM pist_emp_entry_dtl a WHERE a.gnum_isvalid \= ? and a.str_emp_no\=c.hgstr_emp_code),'Empname not found in PIS') AS employeefullname FROM hgbt_unit_consultant_mst c WHERE c.hgnum_deptunitcode \= ? AND c.gnum_isvalid \= ? AND c.gnum_hospital_code \= ?  order by c.hgnum_is_hou desc,HGNUM_HIERARCHY_LEVEL
										
SELECT.CONSULTANT.DELETED.HGBT_UNIT_CONSULTANT_MST= SELECT A.HGNUM_DEPTUNITCODE as departmentUnitCode,A.HGSTR_EMP_CODE as empNo  from HGBT_UNIT_CONSULTANT_MST A WHERE (A.GNUM_ISVALID\=? OR A.GNUM_ISVALID\=?) AND A.GNUM_HOSPITAL_CODE\=? \t\t\t\t\t\t\t\t\t\t\t\t 
 											 
SELECT.ISCONSULTANT.PSRT_EMPLOYEE_MST_OLD= SELECT   a.str_emp_no, INITCAP(str_first_name) || ' ' || INITCAP(str_middle_name) || ' ' || INITCAP(str_last_name) || '(' || (SELECT str_desig_st_name FROM pist_designation_mst WHERE num_desig_id \= b.num_desig_id AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and gnum_hospital_code\=a.gnum_hospital_code) || ')' || '(' || a.str_emp_no || ')' AS empname FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b  WHERE a.str_emp_no \= b.str_emp_no AND a.gnum_isvalid \= ? AND b.gnum_isvalid \= ? and b.gnum_hospital_code\=a.gnum_hospital_code AND num_desig_id IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid\=? and hgnum_process_type \= ? AND gnum_hospital_code \= a.gnum_hospital_code) ANd a.gnum_hospital_code\=? ORDER BY empname
								
#Changed by Akash Singh, Due to table changed in G5, dated on 20-07-2015 								
SELECT.ISCONSULTANT.PSRT_EMPLOYEE_MST=SELECT   a.str_emp_no, INITCAP(str_emp_full_name)  || '(' || (SELECT gstr_desig_name FROM gblt_designation_mst WHERE gnum_desig_code \= a.gnum_desig_code AND gnum_isvalid \= ? and gnum_hospital_code\=a.gnum_hospital_code) || ')' || '(' || a.str_emp_no || ')' AS empname FROM pist_emp_registration_dtl a where gnum_desig_code IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid\=? and hgnum_process_type \= ? AND gnum_hospital_code \= a.gnum_hospital_code) ANd a.gnum_hospital_code\=? ORDER BY str_emp_full_name	 
SELECT.ALLOTEDROOMS.HRGT_DEPT_UNIT_ROOM_MST= SELECT HGNUM_ROOM_CODE, HRGNUM_CAPACITY, HRGNUM_SEQUENCE,(SELECT B.HGSTR_ROOM_NAMEFROM HGBT_ROOM_MST  B WHERE B.HGNUM_ROOM_CODE \= A.HGNUM_ROOM_CODE) AS ROOMNAME FROM HRGT_DEPT_UNIT_ROOM_MST A WHERE A.HGNUM_DEPTUNITCODE\=? AND A.GNUM_ISVALID\=?
											 
SELECT.DELETED.HRGT_DEPT_UNIT_ROOM_MST= SELECT HGNUM_DEPTUNITCODE ,HGNUM_ROOM_CODE FROM HRGT_DEPT_UNIT_ROOM_MST WHERE (GNUM_ISVALID\=? or GNUM_ISVALID\=?) and GNUM_HOSPITAL_CODE\=?  

										 	
SELECT.MAX_UNIT_CODE.HGBT_UNIT_MST= SELECT NVL(MAX(HGNUM_UNIT_CODE),10)+1 FROM HGBT_UNIT_MST WHERE HGNUM_DEPT_CODE\=? AND GNUM_HOSPITAL_CODE \= ?\t\t
											  
SELECT.ALLOTEDROOMS.SEQUENCE.HRGT_DEPT_UNIT_ROOM_MST=SELECT a.HGNUM_DEPTUNITCODE AS departmentunitcode, a.HGNUM_ROOM_CODE AS ROOMCODE, a.HRGNUM_CAPACITY AS capacity, a.HRGNUM_SEQUENCE as sequenceNo, to_char(a.GDT_EFFECTIVE_FRM,'dd/mm/yyyy') as effectiveFrom,to_char(a.GDT_EFFECTIVE_TO,'dd/mm/yyyy') as effectiveTo,(SELECT b.HGSTR_ROOM_NAME FROM HGBT_ROOM_MST  b WHERE b.HGNUM_ROOM_CODE \= a.HGNUM_ROOM_CODE AND b.GNUM_HOSPITAL_CODE \= ?) AS ROOMNAME,Decode(HRGNUM_CAPACITY_MODE,1,'Unit Room Wise',2,'Unit Room DayWise') as capacityMode FROM  HRGT_DEPT_UNIT_ROOM_MST a  WHERE a.HGNUM_DEPTUNITCODE \= ? AND a.gnum_isvalid > 0 AND (TO_CHAR(NVL(A.GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>\=TO_CHAR(SYSDATE,'DD-MM-YY')) AND a.gnum_hospital_code \= ? order by a.HRGNUM_SEQUENCE
 
SELECT.ROOMS.HGBT_ROOM_MST= Select HGNUM_ROOM_CODE,HGSTR_ROOM_NAME FROM HGBT_ROOM_MST WHERE gnum_isvalid\=? AND gnum_hospital_code \= ? order by HGSTR_ROOM_NAME
											 
											 
											 
SELECT.ALL.HGBT_UNIT_MST= select HGNUM_DEPTUNITCODE as departmentUnitCode, HGNUM_DEPT_CODE as departmentCode,GNUM_ISVALID as isValid, HGSTR_UNITNAME as unitName, PSRSTR_EMP_NO as empNo, HGNUM_UNIT_SLNO as unitSerialNo, TO_CHAR(HGDT_EFFECT_DATE,'dd-Mon-yyyy') as effectiveDate, HGNUM_SEAT_ID as seatID, HGDT_ENTRY_DATE as entryDate, HGSTR_FILE_PREFIX filePrefix, HGNUM_FILE_STARTS_FROM startNo, HGNUM_FILE_DEPTCODE fileDepartmentCode, HGNUM_FILE_DEPTUNITCODE fileDepartmentUnitCode, HGNUM_ISGENERAL as isGeneral,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') as effectiveFrom, TO_CHAR(GDT_EFFECTIVE_TO,'dd-Mon-yyyy') as effectiveTo, HGNUM_UNIT_CODE as unitCode, GNUM_ISVALID as isValid, GSTR_REMARKS as remarks,GNUM_ISEXPIRY as isExpiry, GNUM_EXPIRY_DAY as expiryDay, GNUM_EXPIRY_MONTH as expiryMonth, GNUM_DIAGNOSIS_CODE_TYPE as diagnosisCodeType, HGBNUM_EPI_DEFAULT_CLOSE_DAYS as defaultCloseDays,GNUM_LOCATION_CODE as locationCode,HGNUM_ISFILEREQUIRED as fileNoRequired, HGNUM_ISUNIT as isUnit, (SELECT x.HGSTR_EMP_CODE FROM HGBT_UNIT_CONSULTANT_MST x WHERE x.HGNUM_DEPTUNITCODE\= a.hgnum_deptunitcode AND x.gnum_hospital_code\=a.gnum_hospital_code AND x.gnum_isvalid\=a.gnum_isvalid AND x.HGNUM_IS_HOU\=?) as unitDoctorName,HGSTR_CARDPRINT_SETTING as cardPrintFlag, HGSTR_FILEPRINT_SETTING as filePrintFlag from HGBT_UNIT_MST a where HGNUM_DEPTUNITCODE \= ? AND HGNUM_UNIT_SLNO \= ? AND GNUM_HOSPITAL_CODE \= ?
						   
						   
UPDATE.HGBT_UNIT_MST= update HGBT_UNIT_MST set HGDT_EFFECT_DATE\=?, HGNUM_ISGENERAL\=?,GDT_INACTIVE_FROM_DATE\=?,GDT_INACTIVE_TILL_DATE \=?where HGNUM_DEPTUNITCODE\=?
                            
UPDATE.ADMIN.HGBT_UNIT_MST=update HGBT_UNIT_MST set  HGSTR_UNITNAME\=?, HGNUM_ISGENERAL\=? where HGNUM_DEPTUNITCODE\=?
                           
UPDATE.PERMANENT.HGBT_UNIT_MST=update HGBT_UNIT_MST set  GDT_INACTIVE_FROM_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'),GDT_INACTIVE_TILL_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi')where HGNUM_DEPTUNITCODE\=?                           
                           
UPDATE.TEMPCLOSE.HGBT_UNIT_MST=update HGBT_UNIT_MST set  HGDT_EFFECT_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'),GDT_INACTIVE_FROM_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'),GDT_INACTIVE_TILL_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi') where HGNUM_DEPTUNITCODE\=? 
	                      
UPDATE.REMOVE.HGBT_UNIT_CONSULTANT_MST=update HGBT_UNIT_CONSULTANT_MST set GNUM_ISVALID\=? where HGNUM_DEPTUNITCODE\=? AND HGSTR_EMP_CODE\=? AND GNUM_HOSPITAL_CODE\=?
									   									    						   											 
UPDATE.HOU.HGBT_UNIT_CONSULTANT_MST=update HGBT_UNIT_CONSULTANT_MST set HGNUM_IS_HOU\=?,HGNUM_HIERARCHY_LEVEL\=?  where HGNUM_DEPTUNITCODE\=? AND HGSTR_EMP_CODE\=? AND GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?
									
DELETE.HGBT_UNIT_CONSULTANT_MST=Delete from HGBT_UNIT_CONSULTANT_MST where HGNUM_DEPTUNITCODE\=? AND HGSTR_EMP_CODE\=?\tAND A.GNUM_HOSPITAL_CODE\=?\t
								
UPDATE.CAPACITY.HRGT_DEPT_UNIT_ROOM_MST= update HRGT_DEPT_UNIT_ROOM_MST set HRGNUM_CAPACITY\=? where HGNUM_DEPTUNITCODE\=? and GNUM_DEPT_CODE\=? and  HGNUM_ROOM_CODE\=? and HRGNUM_SEQUENCE\=?                              
                                
UPDATE.HRGT_DEPT_UNIT_ROOM_MST= update HRGT_DEPT_UNIT_ROOM_MST set  GDT_EFFECTIVE_FRM\=to_date(?,'dd-Mon-yyyy '), GDT_EFFECTIVE_TO\=to_date(?,'dd-Mon-yyyy '), HRGNUM_CAPACITY \= ? , HRGNUM_CAPACITY_MODE\=?  where HGNUM_DEPTUNITCODE\=? and GNUM_DEPT_CODE\=? and  HGNUM_ROOM_CODE\=? and HRGNUM_SEQUENCE\=? and GNUM_HOSPITAL_CODE \= ?
                                          
UPDATE.PERMCLOSE.HRGT_DEPT_UNIT_ROOM_MST= update HRGT_DEPT_UNIT_ROOM_MST set GDT_INACTIVE_FROM_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'), GDT_INACTIVE_TILL_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi') where HGNUM_DEPTUNITCODE\=? and GNUM_DEPT_CODE\=? and  HGNUM_ROOM_CODE\=? and HRGNUM_SEQUENCE\=?                       
                                
                                
DELETE.HRGT_DEPT_UNIT_ROOM_MST =update HRGT_DEPT_UNIT_ROOM_MST set GNUM_ISVALID\=? where HGNUM_DEPTUNITCODE\=? and GNUM_DEPT_CODE\=? and HGNUM_ROOM_CODE\=? and HRGNUM_SEQUENCE\=? and GNUM_HOSPITAL_CODE \= ?
 
REMOVE.HRGT_DEPT_UNIT_ROOM_MST= Delete from HRGT_DEPT_UNIT_ROOM_MST where HGNUM_DEPTUNITCODE\=? AND HGNUM_ROOM_CODE\=? AND GNUM_HOSPITAL_CODE \= ?
                        			                                                              
                                
UPDATE.SEQUENCE.HRGT_DEPT_UNIT_ROOM_MST=update HRGT_DEPT_UNIT_ROOM_MST set  HRGNUM_SEQUENCE\=? where HGNUM_DEPTUNITCODE\=? and GNUM_DEPT_CODE\=? and HGNUM_ROOM_CODE \=? and gnum_isvalid \= ?\tAND gnum_hospital_code \= ?
										 
SELECT.ROOM.HRGT_DEPT_UNIT_ROOM_MST= SELECT a.HGNUM_DEPTUNITCODE AS departmentunitcode, a.HGNUM_ROOM_CODE AS ROOMCODE, a.HRGNUM_CAPACITY AS capacity, a.HRGNUM_SEQUENCE as sequenceNo,to_char(a.GDT_EFFECTIVE_FRM,'dd-mon-yyyy') as effectiveFrom,to_char(a.GDT_EFFECTIVE_TO,'dd-mon-yyyy') as effectiveTo,(SELECT b.HGSTR_ROOM_NAME FROM HGBT_ROOM_MST  b WHERE b.HGNUM_ROOM_CODE \= a.HGNUM_ROOM_CODE AND b.gnum_hospital_code \= ?) AS ROOMNAME ,HRGNUM_CAPACITY_MODE as capacityMode FROM  HRGT_DEPT_UNIT_ROOM_MST a  WHERE a.HGNUM_DEPTUNITCODE \= ? and a.HGNUM_ROOM_CODE\=? and a.GNUM_DEPT_CODE\=? AND a.gnum_isvalid \= ?\tAND a.gnum_hospital_code \= ?
									 
ESSENTIAL.ROOMSTOUNIT.HRGT_DEPT_UNIT_ROOM_MST=select  a.HGNUM_ROOM_CODE AS ROOMCODE,(SELECT b.HGSTR_ROOM_NAME FROM HGBT_ROOM_MST  b WHERE b.HGNUM_ROOM_CODE \= a.HGNUM_ROOM_CODE AND b.GNUM_HOSPITAL_CODE \= ?) AS ROOMNAME FROM HRGT_DEPT_UNIT_ROOM_MST a WHERE a.HGNUM_DEPTUNITCODE \= ? AND a.gnum_isvalid \= ? AND a.gnum_hospital_code \= ?  
                                                
DELETE.HGBT_UNIT_MST = update HGBT_UNIT_MST set GNUM_ISVALID\=? where HGNUM_DEPTUNITCODE\=? AND HGNUM_UNIT_SLNO\=? AND GNUM_HOSPITAL_CODE \= ?
                                
SELECT.ALLUNITS.HGBT_UNIT_MST = select HGNUM_DEPTUNITCODE as departmentUnitCode, HGNUM_DEPT_CODE as departmentCode, HGNUM_UNIT_SLNO as unitSerialNo, HGSTR_UNITNAME as unitName, PSRSTR_EMP_NO as empNo, HGNUM_SEAT_ID as seatID, HGDT_ENTRY_DATE as entryDate, HGNUM_ISGENERAL as isGeneral,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') as effectiveFrom, TO_CHAR(GDT_EFFECTIVE_TO,'dd-Mon-yyyy') as effectiveTo, HGNUM_UNIT_CODE as unitCode, GNUM_ISVALID as isValid from HGBT_UNIT_MST  where HGNUM_DEPT_CODE \= ? AND TO_CHAR(NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY') AND GNUM_ISVALID >0 AND GNUM_HOSPITAL_CODE \= ?\torder by HGNUM_DEPTUNITCODE
							  
INSERT.GBLT_DEPARTMENT_MST=insert into GBLT_DEPARTMENT_MST  (GNUM_DEPT_CODE, GSTR_DEPT_NAME, GSTR_HOD_CODE, GSTR_DEPT_SHORT, GNUM_LOCATION_CODE, GDT_EFFECT_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_DEPT_TYPE, HGBNUM_EPI_DEFAULT_CLOSE_DAYS, GDT_INACTIVE_FROM_DATE, GDT_INACTIVE_TILL_DATE, GNUM_HL7_CODE) values((SELECT NVL(MAX(GNUM_DEPT_CODE),100)+1  FROM GBLT_DEPARTMENT_MST), ?,?,?,?,to_date(?,'dd-Mon-yyyy HH24\:Mi'),?,?,sysdate,?,?,to_date(?,'dd-Mon-yyyy HH24\:Mi'),to_date(?,'dd-Mon-yyyy HH24\:Mi'),?)
						    
UPDATE.GBLT_DEPARTMENT_MST= UPDATE GBLT_DEPARTMENT_MST  set GSTR_DEPT_NAME\=?, GNUM_DEPT_TYPE \=?,GDT_EFFECT_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'),GDT_INACTIVE_FROM_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'),GDT_INACTIVE_TILL_DATE\=to_date(?,'dd-Mon-yyyy HH24\:Mi'), GSTR_HOD_CODE\=?,GSTR_DEPT_SHORT\=?,HGBNUM_EPI_DEFAULT_CLOSE_DAYS\=?, GNUM_HL7_CODE\=? WHERE GNUM_DEPT_CODE\=? and GNUM_ISVALID\=?\t\t
								
SELECT.DEPT.GBLT_DEPARTMENT_MST= SELECT GNUM_DEPT_CODE as departmentCode, GSTR_DEPT_NAME as department, GSTR_HOD_CODE as hodCode, GSTR_DEPT_SHORT as deptShortName,GNUM_LOCATION_CODE as locationCode, TO_CHAR(GDT_EFFECT_DATE,'dd-Mon-yyyy') as effectiveDate, GNUM_ISVALID as isValid, GNUM_SEAT_ID as seatID, GDT_ENTRY_DATE as entryDate, GNUM_DEPT_TYPE as departmentType , HGBNUM_EPI_DEFAULT_CLOSE_DAYS as defaultCloseDays, TO_CHAR(GDT_INACTIVE_FROM_DATE,'dd-Mon-yyyy') as inactiveFromDate, TO_CHAR(GDT_INACTIVE_TILL_DATE,'dd-Mon-yyyy') as inactiveTillDate, GNUM_HL7_CODE as hl7Code FROM GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=? AND GNUM_ISVALID\=?\t
                                  

SELECT.ISCONSULTANT_VAL.PSRT_EMPLOYEE_MST= SELECT   a.str_emp_no, str_first_name || ' ' || str_middle_name || ' ' || str_last_name || '(' || (SELECT str_desig_st_name FROM pist_designation_mst WHERE num_desig_id \= b.num_desig_id AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and gnum_hospital_code\=a.gnum_hospital_code) || ')' || '(' || a.str_emp_no || ')' AS empname FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b  WHERE a.str_emp_no \= b.str_emp_no AND a.gnum_isvalid \= ? AND b.gnum_isvalid \= ? and b.gnum_hospital_code\=a.gnum_hospital_code AND num_desig_id IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid\=? and hgnum_process_type \= ? AND gnum_hospital_code \= a.gnum_hospital_code) ANd a.gnum_hospital_code\=? ORDER BY str_first_name
											
UPDATE.UNITMST.HGBT_UNIT_MST=update HGBT_UNIT_MST set  HGSTR_UNITNAME\=?, HGNUM_ISGENERAL\=?, GDT_EFFECTIVE_FRM\=TO_DATE(?,'dd-Mon-yyyy'), GDT_EFFECTIVE_TO \= TO_DATE(?,'dd-Mon-yyyy'), GDT_LSTMOD_DATE \= TO_DATE(?,'dd-Mon-yyyy'), GNUM_LSTMOD_SEATID \= ?, GSTR_REMARKS \= ?, GNUM_ISEXPIRY \= ?, GNUM_EXPIRY_DAY \= ?, GNUM_EXPIRY_MONTH \= ?, GNUM_DIAGNOSIS_CODE_TYPE \= ?, HGBNUM_EPI_DEFAULT_CLOSE_DAYS \= ?, GNUM_LOCATION_CODE \= ? , HGNUM_ISFILEREQUIRED\=? where HGNUM_DEPTUNITCODE\=? AND HGNUM_UNIT_SLNO \= ? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?\t\t\t\t\t    \t
						  
SELECT.STATE.GBLT_STATE_MST=SELECT GNUM_STATECODE, GSTR_STATENAME FROM GBLT_STATE_MST WHERE GNUM_COUNTRYCODE\=? AND  GNUM_ISVALID\=?\tAND GNUM_HOSPITAL_CODE\=? ORDER BY GSTR_STATENAME
							
SELECT.DEPT.GBLT_DEPT_MST =SELECT gnum_dept_code AS departmentcode, gstr_dept_name AS department, gstr_dept_short AS deptshortname, TO_CHAR (gdt_effect_date, 'dd-Mon-yyyy') AS effectivedate,gnum_isvalid AS isvalid, gnum_seat_id AS seatid, TO_CHAR(gdt_entry_date,'dd-mon-yyyy') AS entrydate, gnum_dept_type AS departmenttype FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= ? AND gnum_isvalid \= ?
							   


									
INSERT.GBLT_DEPARTMENT_MASTER = INSERT INTO GBLT_DEPARTMENT_MST (GNUM_DEPT_CODE, GNUM_DEPT_SLNO, GSTR_DEPT_NAME,GSTR_HOD_CODE, GSTR_DEPT_SHORT,GNUM_LOCATION_CODE, GDT_EFFECTIVE_FRM,  GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_DEPT_TYPE, GNUM_HL7_CODE, GSTR_REMARKS,GNUM_HOSPITAL_CODE) VALUES (?, (SELECT NVL (MAX (GNUM_DEPT_SLNO), 00) + 1 FROM gblt_department_mst WHERE GNUM_DEPT_CODE\=? AND GNUM_HOSPITAL_CODE \= ?), INITCAP(?), ?,UPPER(?),?, TO_DATE(TO_CHAR(sysdate, 'dd-Mon-yyyy'),'dd-Mon-yyyy'), ?, ?, TO_DATE(TO_CHAR(sysdate, 'dd-Mon-yyyy'),'dd-Mon-yyyy'), ?,?,?,? )
							
SELECT.DEPT.GBLT_DEPARTMENT_MASTER = SELECT gnum_dept_code AS departmentcode, gnum_dept_slno AS departmentslno, gstr_dept_name AS department, GSTR_HOD_CODE as hodCode, gstr_dept_short AS deptshortname,  TO_CHAR (gdt_effective_frm, 'dd-Mon-yyyy') AS effectivefrom, gnum_isvalid AS isvalid, gnum_seat_id AS seatid, TO_CHAR (gdt_effective_to, 'dd-Mon-yyyy') AS effectiveto, gnum_dept_type AS departmenttype, gstr_remarks AS remarks , GNUM_HL7_CODE as hl7Code, GNUM_LOCATION_CODE as locationCode FROM gblt_department_mst WHERE gnum_dept_code \= ? AND gnum_dept_slno\= ? AND gnum_hospital_code \= ?
	

								   
						   
UPDATE.GBLT_DEPARTMENT_MASTER= UPDATE GBLT_DEPARTMENT_MST set GSTR_DEPT_NAME\=INITCAP(?), GNUM_DEPT_TYPE \=?,GDT_EFFECTIVE_FRM\=to_date(?,'dd-Mon-yyyy'), GSTR_DEPT_SHORT\=UPPER(?),GDT_EFFECTIVE_TO\=to_date(?,'dd-Mon-yyyy'), GNUM_ISVALID\=? ,GSTR_REMARKS\=?, GDT_LSTMOD_DATE \= to_date(?,'dd-Mon-yyyy'), GSTR_HOD_CODE \= ? , GNUM_LOCATION_CODE \= ?, GNUM_LSTMOD_SEATID \= ?  WHERE GNUM_DEPT_CODE\=? and GNUM_DEPT_SLNO\=? and GNUM_HOSPITAL_CODE \= ?
								 
									


UPDATE.PREVIOUS_ROW.GBLT_DEPARTMENT_MASTER=UPDATE GBLT_DEPARTMENT_MST set GNUM_ISVALID\=?,GDT_EFFECTIVE_TO\=to_date(to_char(?\:\:timestamp,'dd-mon-yyyy'),'dd-mon-yyyy') -1, GDT_LSTMOD_DATE\=to_date(to_char(?\:\:timestamp,'dd-mon-yyyy'),'dd-mon-yyyy') , GNUM_LSTMOD_SEATID \= ?  WHERE GNUM_DEPT_CODE\=? AND GNUM_DEPT_SLNO\=? AND GNUM_HOSPITAL_CODE \= ?
											
											

CREATE.NEW.GBLT_DEPARTMENT_MASTER = INSERT INTO GBLT_DEPARTMENT_MST (GNUM_DEPT_CODE, GNUM_DEPT_SLNO, GSTR_DEPT_NAME,GSTR_HOD_CODE, GNUM_LOCATION_CODE,GSTR_DEPT_SHORT, GDT_EFFECTIVE_FRM, GNUM_ISVALID, GNUM_SEAT_ID, GDT_EFFECTIVE_TO, GNUM_DEPT_TYPE, GSTR_REMARKS,GNUM_HOSPITAL_CODE) VALUES (?, (SELECT NVL (MAX (GNUM_DEPT_SLNO), 00) + 1 FROM gblt_department_mst WHERE GNUM_DEPT_CODE\=? AND GNUM_HOSPITAL_CODE \= ?) ,INITCAP(?),?,?, UPPER(?),TRUNC(SYSDATE), ?, ?, TO_DATE(?, 'dd-Mon-yyyy'), ? ,?,?)
						


 		 			   
ESSENTIAL.HGBT_UNIT_MST.UNITTYPE=SELECT   hgnum_deptunitcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= c.hgnum_dept_code and gnum_hospital_code\=c.gnum_hospital_code AND \tGDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) || '('|| hgstr_unitname || ')' FROM hgbt_unit_mst c WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? and gnum_hospital_code\=? AND hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id and a.gnum_hospital_code\=c.gnum_hospital_code and  a.gnum_hospital_code\=b.gnum_hospital_code AND b.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,b.GNUM_HOSPITAL_CODE)) ORDER BY hgnum_deptunitcode
								 
								 
ESSENTIAL.UNIT.BASED.ON.SEATID.HGBT_UNIT_MST=SELECT   hgnum_deptunitcode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.hgnum_dept_code AND (SYSDATE BETWEEN gdt_effective_frm AND NVL (gdt_effective_to, SYSDATE)) AND gnum_hospital_code \= a.gnum_hospital_code) || '('|| hgstr_unitname || ')' as deptUnitName FROM hgbt_unit_mst a WHERE gnum_isvalid \= ? and a.gnum_hospital_code\=? AND hgnum_deptunitcode IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl b, gblt_metatable_column_mst c WHERE b.gnum_metatable_id \= c.gnum_metatable_id AND b.gnum_hospital_code\=c.gnum_hospital_code AND b.gnum_hospital_code\= a.gnum_hospital_code AND c.gstr_table_name \= 'HGBT_UNIT_MST' AND c.gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND b.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,a.GNUM_HOSPITAL_CODE)) order by deptUnitName

								 						
								 						
ESSENTIAL.EPISODE.ACTION.GBLT_EPISODE_ACTION_MST=SELECT GNUM_EPISODE_ACTION_CODE,GSTR_EPISODE_ACTION_NAME FROM GBLT_EPISODE_ACTION_MST WHERE GNUM_ISVALID \=? ORDER BY GSTR_EPISODE_ACTION_NAME

							 								 
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL_SP_CLINIC=SELECT   a.hopnum_deptunitcode,(SELECT x.gstr_dept_name FROM gblt_department_mst x WHERE x.gnum_dept_code \= SUBSTR (a.hopnum_deptunitcode, 1, 3)  and x.gnum_hospital_code\=a.gnum_hospital_code and sysdate between GDT_EFFECTIVE_FRM and nvl(GDT_EFFECTIVE_TO,sysdate))|| '(' || c.hgstr_unitname || ')' FROM hopt_dept_unit_roster_dtl a, hgbt_unit_mst c WHERE c.hgnum_isgeneral \= ? AND a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND c.hgnum_deptunitcode \= a.hopnum_deptunitcode and  c.gnum_hospital_code\=a.gnum_hospital_code AND a.gnum_isvalid \= ? and  a.gnum_hospital_code\=? AND a.hopnum_deptunitcode IN ( SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id and  a.gnum_hospital_code\=b.gnum_hospital_code AND b.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,b.GNUM_HOSPITAL_CODE) and a.gnum_hospital_code\=?) ORDER BY a.hopnum_deptunitcode \t\t\t\t
								

SELECT.HBLT_CHARGE_MST_1= SELECT HBLNUM_OPD_CHARGE  FROM HBLT_CHARGE_MST WHERE HBLSTR_SERVICE_ID = ? AND HBLSTR_TARIFF_ID = ? AND HBLNUM_CATEGORY_CODE = ? AND HGBL_ISVALID=?



					


               									
SELECT.PREV_DATE.GBLT_DEPARTMENT_MASTER	=SELECT COUNT(*) FROM GBLT_DEPARTMENT_MST WHERE trunc(GDT_EFFECTIVE_FRM)<\=trunc(to_date(?,'dd-Mon-yyyy')) AND trunc(NVL(GDT_EFFECTIVE_TO,GDT_EFFECTIVE_FRM))>\=  trunc(to_date(?,'dd-Mon-yyyy')) AND GNUM_DEPT_CODE \=? AND GNUM_ISVALID > 0
											 
											 
											 
SELECT.NEXT_DATE.GBLT_DEPARTMENT_MASTER	=SELECT to_char(MIN (gdt_effective_frm),'dd-mon-yyyy') FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= ? and GDT_EFFECTIVE_FRM >? and gnum_isvalid\= ? and gnum_hospital_code \= ?
											 

SELECT.PREVIOUS_SERIAL_NO.GBLT_DEPARTMENT_MASTER =SELECT GNUM_DEPT_SLNO,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE \= ? AND GDT_EFFECTIVE_TO is null AND GNUM_HOSPITAL_CODE \= ?
													
													


 
SELECT.NEXT_DATE.HGBT_UNIT_MASTER	=SELECT to_char(MIN(GDT_EFFECTIVE_FRM),'dd-Mon-yyyy') FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE \= ? and GDT_EFFECTIVE_FRM >? and gnum_isvalid\= ? and gnum_hospital_code \= ?
											 
											 
SELECT.PREV_DATE.HGBT_UNIT_MASTER	=SELECT COUNT(*) FROM GBLT_DEPARTMENT_MST WHERE trunc(GDT_EFFECTIVE_FRM)<\=trunc(to_date(?,'dd-Mon-yyyy')) AND trunc(NVL(GDT_EFFECTIVE_TO,GDT_EFFECTIVE_FRM))>\=  trunc(to_date(?,'dd-Mon-yyyy')) AND GNUM_DEPT_CODE \=? AND GNUM_ISVALID > 0 AND GNUM_HOSPITAL_CODE \= ?
											 
SELECT.PREVIOUS_SERIAL_NO.HGBT_UNIT_MASTER =SELECT HGNUM_UNIT_SLNO,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE \= ? AND GDT_EFFECTIVE_TO is null AND GNUM_HOSPITAL_CODE \= ?

													
UPDATE.PREVIOUS_ROW.HGBT_UNIT_MASTER=UPDATE HGBT_UNIT_MST set GNUM_ISVALID\=?,GDT_EFFECTIVE_TO\=to_date(to_char(?\:\:timestamp,'dd-mon-yyyy'),'dd-mon-yyyy')-1, GDT_LSTMOD_DATE\=to_date(to_char(?\:\:timestamp,'dd-mon-yyyy'),'dd-mon-yyyy') , GNUM_LSTMOD_SEATID \= ?  WHERE HGNUM_DEPTUNITCODE\=? AND HGNUM_UNIT_SLNO\=? AND GNUM_HOSPITAL_CODE \= ?
											
											
CREATE.NEW.HGBT_UNIT_MASTER = INSERT INTO HGBT_UNIT_MST (HGNUM_DEPTUNITCODE, HGNUM_DEPT_CODE, HGSTR_UNITNAME,PSRSTR_EMP_NO, HGNUM_UNIT_SLNO, HGNUM_SEAT_ID,HGDT_ENTRY_DATE, HGNUM_ISGENERAL, GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO, HGNUM_UNIT_CODE, GNUM_ISVALID, GSTR_REMARKS, GNUM_ISEXPIRY, GNUM_EXPIRY_DAY, GNUM_EXPIRY_MONTH, GNUM_DIAGNOSIS_CODE_TYPE, HGBNUM_EPI_DEFAULT_CLOSE_DAYS,GNUM_LOCATION_CODE,GNUM_HOSPITAL_CODE,HGNUM_ISUNIT,hgnum_isfilerequired,hgstr_unit_days,HGSTR_FILE_PREFIX, HGNUM_FILE_STARTS_FROM, HGNUM_FILE_DEPTCODE,HGNUM_FILE_DEPTUNITCODE,HGSTR_CARDPRINT_SETTING,HGSTR_FILEPRINT_SETTING) VALUES(?,?,?,?,(SELECT NVL (MAX (HGNUM_UNIT_SLNO), 00) + 1 FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE\=? AND GNUM_HOSPITAL_CODE \= ?),?,sysdate, ?,TRUNC(SYSDATE),to_date(?,'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,(select ahis_reg.unit_room_time (?,'0','0','0',?) from dual),upper(?),?,?,?,?,?)
						

SELECT.EMPNO_PSRT_EMPLOYEE_MST= Select PSRSTR_EMP_NO as patIdNo, GNUM_SALUTATION_CODE as patSalutationCode, PSRSTR_FNAME as patFirstName, PSRSTR_MNAME as patMiddleName, PSRSTR_LNAME as patLastName, GNUM_GENDER_CODE as patGenderCode, PSRSTR_ADD1 as patAdd, PSRSTR_LOCATION_PO as patLocationPo, PSRSTR_CITY as  patAddCityLocCode, PSRSTR_DISTRICT as patAddDistrict, GNUM_STATE_CODE as patAddStateCode,PSRNUM_PINCODE as patAddPIN, GNUM_COUNTRY_CODE as patAddCountryCode, PSRSTR_RES_TEL as resTelNo, PSRSTR_MOBILE as patAddContactNo, PSRSTR_OFF_TEL as OffTelNo, PSRSTR_EMAIL as email, PSRDT_DOJ as dateOfJoining,TO_CHAR (PSRDT_DOB, 'dd-Mon-yyyy') as patDOB, GNUM_DESIG_CODE as designatonCode, GNUM_DEPT_CODE as departmentCode, PSRSTR_EMP_STATUS_CODE as empStatusCode , PSRNUM_EMP_TYPE_CODE as empTypeCode, PSRBL_ISCONSULTANT as isConsultant, PSRDT_SEPARATION_DATE as seprationDate, GNUM_LOCATION_CODE as patAddCityLocCode, GDT_ENTRY_DATE as entryDate, GNUM_SEAT_ID as seatId, GNUM_RELATIVECODE as relativeCode, GNUM_ISVALID as isValid from PSRT_EMPLOYEE_MST where PSRSTR_EMP_NO\=? AND GNUM_ISVALID\=?\t\t\t\t\t\t\t\t  
								  

SELECT.HBLT_CHARGE_MST= SELECT HBLNUM_COST FROM HBLT_CHARGE_MST WHERE SBLNUM_CHARGETYPE_ID\=? AND hblnum_tariff_id \= ? AND gnum_patient_cat_code \= ? AND gnum_isvalid \= ? AND ( gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE))



SELECT.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST1= SELECT TO_CHAR (psrstr_emp_no)as patIdNo, NVL (psrstr_fname, ' ')as patFirstName, NVL (psrstr_mname, ' ')as patMiddleName, NVL (psrstr_lname, ' ')as patLastName, (SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code \= psrt_employee_mst.gnum_gender_code)||'/'||( DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1 / 24),-1, ROUND (24 * 60 * ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob))|| ' Minutes ', DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1), -1, ROUND (24 * ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob)) || ' Hours ',DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 14),-1, TRUNC ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob) || ' Days  ', DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 60 ),-1, TRUNC (((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob )/ 7)|| ' Weeks ',DECODE(SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 365 ),-1, ROUND(MONTHS_BETWEEN ((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob )) || ' Months ',FLOOR(  MONTHS_BETWEEN((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob)/ 12 )|| ' Years '))))) )as patGenderAge, (SELECT GSTR_RELATION_NAME FROM gblt_relation_mst WHERE GNUM_RELATION_CODE \= psrt_employee_mst.gnum_relativecode)as relation , GNUM_LOCATION_CODE as  patAddCityLocCode,TO_CHAR (PSRDT_DOB, 'dd-Mon-yyyy') as patDOB, GNUM_STATE_CODE as patAddStateCode,GNUM_COUNTRY_CODE as patAddCountryCode,GNUM_GENDER_CODE as patGenderCode FROM psrt_employee_mst WHERE SUBSTR (psrstr_emp_no, 1, 8) \= ? AND gnum_isvalid \= ? order by patIdNo
SELECT.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST = SELECT  A.STR_EMP_NO AS patno,   STR_FIRST_NAME AS patfirstname,STR_MIDDLE_NAME AS patmiddlename,STR_LAST_NAME AS patlastname, (STR_GENDER_NAME)|| '/'|| ahis_util.dob_age_on(dt_birth_date,sysdate) AS patgenderage,'Employee'  AS relation, TO_CHAR (DT_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob,A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS fathername , STR_MOTHER_NAME AS MOTHERNAME,STR_SPOUSE_NAME  AS SPOUSENAME, STR_CUR_HOUSE_NO  AS HOUSENO, STR_CUR_PIN_CODE  AS PINCODE, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS CONTACTNO , NUM_CUR_COUNTRY_ID as patAddCountryCode , decode(UPPER(str_gender_name),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||'10' as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\= a.str_emp_no || '10' and gnum_hospital_code\=c.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_PERSONNEL_DTL C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NO\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NO\= B.STR_EMP_NUMBER(+) AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NO\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) AND   C.STR_EMP_No\= upper(?) AND c.GNUM_HOSPITAL_CODE\=? AND  C.GNUM_ISVALID\=1 UNION SELECT   A.STR_EMP_NO AS patidno,STR_F_MEM_NAME AS patfirstname,'  ' AS patmiddlename,'  ' AS patlastname,(STR_SEX)|| '/'|| ahis_util.dob_age_on(STR_BIRTH_DATE,sysdate) AS patgenderage, (SELECT gstr_relation_name        FROM GBLT_RELATION_MST      WHERE GNUM_RELATION_CODE \=C.NUM_RELATION_ID AND gnum_hospital_code\=C.gnum_hospital_code AND GNUM_ISVALID\=1)     AS relation, TO_CHAR (STR_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob, A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS patGuardianName , STR_MOTHER_NAME AS patMotherName,STR_SPOUSE_NAME  AS patHusbandName, STR_CUR_HOUSE_NO  AS patAddHNo, STR_CUR_PIN_CODE  AS patAddPIN, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS patAddContactNo , NUM_CUR_COUNTRY_ID as patAddCountryCode ,  decode(UPPER(str_sex),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||c.num_relation_id as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\=a.str_emp_no || c.num_relation_id and gnum_hospital_code\=c.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_FAMILY_NOMINEE_DTL  C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NUMBER\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NUMBER\= B.STR_EMP_NUMBER(+)  AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NUMBER\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) AND  C.GNUM_ISVALID\=1 AND C.STR_IS_DEPENDENT\='Y' AND  C.STR_EMP_NUMBER\=upper(?) AND c.GNUM_HOSPITAL_CODE\=? ORDER BY patidno 
											
											
/*********Employee_query_for_pGI*******/ 

SELECT.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST_STAFF_CLINIC=SELECT  A.STR_EMP_NO AS patno,   STR_FIRST_NAME AS patfirstname,STR_MIDDLE_NAME AS patmiddlename,STR_LAST_NAME AS patlastname, (STR_GENDER_NAME)|| '/'|| ahis_util.dob_age_on(dt_birth_date,sysdate) AS patgenderage,'Employee'  AS relation, TO_CHAR (DT_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob,A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS fathername , STR_MOTHER_NAME AS MOTHERNAME,STR_SPOUSE_NAME  AS SPOUSENAME, STR_CUR_HOUSE_NO  AS HOUSENO, STR_CUR_PIN_CODE  AS PINCODE, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS CONTACTNO , NUM_CUR_COUNTRY_ID as patAddCountryCode , decode(UPPER(str_gender_name),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||'10' as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\= a.str_emp_no || '10' and gnum_hospital_code\=c.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_PERSONNEL_DTL C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NO\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NO\= B.STR_EMP_NUMBER(+) AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NO\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) AND   C.STR_EMP_No\= upper(?) AND c.GNUM_HOSPITAL_CODE\=? AND  C.GNUM_ISVALID\=1 AND c.str_emp_no IN ( SELECT str_emp_no  FROM pist_sc_new_reg_dtl  WHERE gnum_hospital_code \= c.gnum_hospital_code  AND str_status \= 5  AND str_emp_no IS NOT NULL) UNION SELECT   b.str_emp_no AS patidno, str_dependent_name AS patfirstname, ' ' AS patmiddlename, ' ' AS patlastname,(str_gender)|| '/'|| ahis_util.dob_age_on (dt_birth_date, SYSDATE) AS patgenderage, (SELECT gstr_relation_name   FROM gblt_relation_mst    WHERE gnum_relation_code \= b.num_rel_id   AND gnum_hospital_code \= b.gnum_hospital_code  AND gnum_isvalid \= 1) AS relation, TO_CHAR (dt_birth_date, 'dd-Mon-yyyy') AS patdob, 0,' ' AS patguardianname, ' ' AS patmothername, ' ' AS pathusbandname, str_cur_house_no AS pataddhno, str_cur_pin_code AS pataddpin, num_cur_state_id AS pataddstatecode, num_cur_dist_id AS patadddistrictcode,num_mobile_no AS pataddcontactno,num_cur_country_id AS pataddcountrycode, DECODE (UPPER (str_gender),'M', '1', 'F', '2', '3') AS patgendercode, b.str_emp_no || num_rel_id AS patidno, (SELECT max(hrgnum_puk)   FROM hrgt_patient_dtl WHERE hrgnum_id_no \= b.str_emp_no || b.num_rel_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND gnum_isvalid \= 1) AS patcrno FROM pist_sc_depend_dtl b, pist_emp_contact_dtl d WHERE b.str_emp_no \= d.str_emp_no(+) AND b.gnum_hospital_code \= d.gnum_hospital_code(+) AND b.gnum_isvalid \= d.gnum_isvalid(+) AND b.gnum_isvalid \= 1 AND b.str_emp_no \= UPPER (?) AND b.gnum_hospital_code \= ? AND b.str_emp_no IN ( SELECT str_emp_no FROM pist_sc_new_reg_dtl WHERE gnum_hospital_code \= b.gnum_hospital_code AND str_status \= 5  AND str_emp_no IS NOT NULL) ORDER BY patidno 


SELECT.BYNAME.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST_STAFF_CLINIC=SELECT  A.STR_EMP_NO AS patno,   STR_FIRST_NAME AS patfirstname,STR_MIDDLE_NAME AS patmiddlename,STR_LAST_NAME AS patlastname, (STR_GENDER_NAME)|| '/'||ahis_util.dob_age_on(dt_birth_date,sysdate) AS patgenderage,'Employee'  AS relation, TO_CHAR (DT_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob,A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS fathername , STR_MOTHER_NAME AS MOTHERNAME,STR_SPOUSE_NAME  AS SPOUSENAME, STR_CUR_HOUSE_NO  AS HOUSENO, STR_CUR_PIN_CODE  AS PINCODE, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS CONTACTNO , NUM_CUR_COUNTRY_ID as patAddCountryCode , decode(UPPER(str_gender_name),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||'10' as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\= a.str_emp_no ||  '10' and gnum_hospital_code\=c.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_PERSONNEL_DTL C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NO\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NO\= B.STR_EMP_NUMBER(+) AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NO\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) and ((UPPER (str_first_name) LIKE UPPER (?) AND UPPER (str_middle_name) LIKE UPPER (?) AND UPPER (str_last_name) LIKE UPPER (?)) or (UPPER (str_first_name) LIKE UPPER  (?) AND UPPER (str_middle_name) LIKE UPPER (?)) or (UPPER (str_first_name) LIKE UPPER (?) AND UPPER (str_last_name) LIKE UPPER (?)) ) AND c.GNUM_HOSPITAL_CODE\=? AND  C.GNUM_ISVALID\=1 AND c.str_emp_no IN (SELECT str_emp_no      FROM pist_sc_new_reg_dtl    WHERE gnum_hospital_code \= c.gnum_hospital_code  AND str_status \= 5  AND str_emp_no IS NOT NULL) UNION SELECT   b.str_emp_no AS patidno, str_dependent_name AS patfirstname, ' ' AS patmiddlename, ' ' AS patlastname,(str_gender)|| '/'|| ahis_util.dob_age_on (dt_birth_date, SYSDATE) AS patgenderage, (SELECT gstr_relation_name   FROM gblt_relation_mst    WHERE gnum_relation_code \= b.num_rel_id   AND gnum_hospital_code \= b.gnum_hospital_code  AND gnum_isvalid \= 1) AS relation, TO_CHAR (dt_birth_date, 'dd-Mon-yyyy') AS patdob, 0,' ' AS patguardianname, ' ' AS patmothername, ' ' AS pathusbandname, str_cur_house_no AS pataddhno, str_cur_pin_code AS pataddpin, num_cur_state_id AS pataddstatecode, num_cur_dist_id AS patadddistrictcode,num_mobile_no AS pataddcontactno,num_cur_country_id AS pataddcountrycode, DECODE (UPPER (str_gender),'M', '1', 'F', '2', '3') AS patgendercode, b.str_emp_no || num_rel_id AS patidno, (SELECT max(hrgnum_puk)   FROM hrgt_patient_dtl WHERE hrgnum_id_no \= b.str_emp_no || b.num_rel_id  AND gnum_hospital_code \= b.gnum_hospital_code  AND gnum_isvalid \= 1) AS patcrno FROM pist_sc_depend_dtl b, pist_emp_contact_dtl d WHERE b.str_emp_no \= d.str_emp_no(+) AND b.gnum_hospital_code \= d.gnum_hospital_code(+) AND b.gnum_isvalid \= d.gnum_isvalid(+) AND b.gnum_isvalid \= 1 AND b.str_dependent_name LIKE UPPER (?) AND b.gnum_hospital_code \= ? AND b.str_emp_no IN ( SELECT str_emp_no FROM pist_sc_new_reg_dtl WHERE gnum_hospital_code \= b.gnum_hospital_code AND str_status \= 5  AND str_emp_no IS NOT NULL) ORDER BY patidno    
                                            

SELECT.BYNAME.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST1= SELECT TO_CHAR (psrstr_emp_no)as patIdNo, NVL (psrstr_fname, ' ')as patFirstName, NVL (psrstr_mname, ' ')as patMiddleName, NVL (psrstr_lname, ' ')as patLastName, (SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code \= psrt_employee_mst.gnum_gender_code)||'/'||( DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1 / 24),-1, ROUND (24 * 60 * ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob))|| ' Minutes ', DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1), -1, ROUND (24 * ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob)) || ' Hours ',DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 14),-1, TRUNC ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob) || ' Days  ', DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 60 ),-1, TRUNC (((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob )/ 7)|| ' Weeks ',DECODE(SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 365 ),-1, ROUND(MONTHS_BETWEEN ((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob )) || ' Months ',FLOOR(  MONTHS_BETWEEN((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob)/ 12 )|| ' Years '))))) )as patGenderAge, (SELECT GSTR_RELATION_NAME FROM gblt_relation_mst WHERE GNUM_RELATION_CODE \= psrt_employee_mst.gnum_relativecode)as relation , GNUM_LOCATION_CODE as  patAddCityLocCode,TO_CHAR (PSRDT_DOB, 'dd-Mon-yyyy') as patDOB, GNUM_STATE_CODE as patAddStateCode,GNUM_COUNTRY_CODE as patAddCountryCode,GNUM_GENDER_CODE as patGenderCode FROM psrt_employee_mst WHERE (UPPER (psrstr_fname) LIKE UPPER (?) AND UPPER (PSRSTR_MNAME) LIKE UPPER (?) AND UPPER (psrstr_lname) LIKE UPPER (?)) or (UPPER (psrstr_fname) LIKE UPPER (?) AND UPPER (PSRSTR_MNAME) LIKE UPPER (?)) or (UPPER (psrstr_fname) LIKE UPPER (?) AND UPPER (psrstr_lname) LIKE UPPER (?)) AND gnum_isvalid \= ? ORDER BY patfirstname
													  
										  
										  

SELECT.BYNAME.EMPDEPENDENT_DTL_PSRT_EMPLOYEE_MST = SELECT  A.STR_EMP_NO AS patno,   STR_FIRST_NAME AS patfirstname,STR_MIDDLE_NAME AS patmiddlename,STR_LAST_NAME AS patlastname, (STR_GENDER_NAME)|| '/'||ahis_util.dob_age_on(dt_birth_date,sysdate) AS patgenderage,'Employee'  AS relation, TO_CHAR (DT_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob,A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS fathername , STR_MOTHER_NAME AS MOTHERNAME,STR_SPOUSE_NAME  AS SPOUSENAME, STR_CUR_HOUSE_NO  AS HOUSENO, STR_CUR_PIN_CODE  AS PINCODE, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS CONTACTNO , NUM_CUR_COUNTRY_ID as patAddCountryCode , decode(UPPER(str_gender_name),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||'10' as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\= a.str_emp_no ||  '10' and gnum_hospital_code\=c.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_PERSONNEL_DTL C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NO\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NO\= B.STR_EMP_NUMBER(+) AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NO\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) and ((UPPER (str_first_name) LIKE UPPER (?) AND UPPER (str_middle_name) LIKE UPPER (?) AND UPPER (str_last_name) LIKE UPPER (?)) or (UPPER (str_first_name) LIKE UPPER  (?) AND UPPER (str_middle_name) LIKE UPPER (?)) or (UPPER (str_first_name) LIKE UPPER (?) AND UPPER (str_last_name) LIKE UPPER (?)) ) AND c.GNUM_HOSPITAL_CODE\=? AND  C.GNUM_ISVALID\=1 UNION SELECT   A.STR_EMP_NO AS patidno,STR_F_MEM_NAME AS patfirstname,'  ' AS patmiddlename,'  ' AS patlastname,(STR_SEX)|| '/'||  ahis_util.dob_age_on(STR_BIRTH_DATE,sysdate) AS patgenderage, (SELECT gstr_relation_name        FROM GBLT_RELATION_MST      WHERE GNUM_RELATION_CODE \=C.NUM_RELATION_ID AND gnum_hospital_code\=C.gnum_hospital_code AND GNUM_ISVALID\=1)     AS relation, TO_CHAR (STR_BIRTH_DATE, 'dd-Mon-yyyy') AS patdob, A.NUM_CUR_BASIC_PAY,STR_FATHER_NAME AS patGuardianName , STR_MOTHER_NAME AS patMotherName,STR_SPOUSE_NAME  AS patHusbandName, STR_CUR_HOUSE_NO  AS patAddHNo, STR_CUR_PIN_CODE  AS patAddPIN, NUM_CUR_STATE_ID AS patAddStateCode,NUM_CUR_DIST_ID AS patadddistrictcode, NUM_MOBILE_NO  AS patAddContactNo , NUM_CUR_COUNTRY_ID as patAddCountryCode ,  decode(UPPER(str_sex),'M','1','F','2','3') AS patGenderCode , a.str_emp_no||c.num_relation_id as patidno, (select max(HRGNUM_PUK) from HRGT_PATIENT_DTL where HRGNUM_ID_NO\=a.str_emp_no || c.num_relation_id AND gnum_hospital_code\=C.gnum_hospital_code and gnum_isvalid\=1) as patcrno FROM PIST_EMP_FAMILY_NOMINEE_DTL  C,  PIST_EMP_FAMILY_DTL  B,PIST_EMP_CUR_DETAIL_DTL A, PIST_EMP_CONTACT_DTL D WHERE  C .STR_EMP_NUMBER\=A.STR_EMP_NO AND C.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND   C.STR_EMP_NUMBER\= B.STR_EMP_NUMBER(+)  AND C.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= B.GNUM_ISVALID(+) AND C.STR_EMP_NUMBER\=D.STR_EMP_NO(+) AND C.GNUM_HOSPITAL_CODE\=D.GNUM_HOSPITAL_CODE(+) AND C.GNUM_ISVALID\= D.GNUM_ISVALID(+) AND  C.GNUM_ISVALID\=1 AND C.STR_IS_DEPENDENT\='Y' AND str_f_mem_name like UPPER (?) AND c.GNUM_HOSPITAL_CODE\=? ORDER BY patidno    
                                            
                                           
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL_GBLT_DEPARTMENT_MST_NEW_VISIT_SP_CLINIC_3-11-09 =SELECT DISTINCT a.hopnum_deptunitcode, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= SUBSTR(a.hopnum_deptunitcode,1,3) and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || '('|| (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hopnum_deptunitcode and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || ')' FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND a.gnum_isvalid \= ? and a.gnum_hospital_code\=? AND a.hopnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst a WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? AND gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AND a.hopnum_deptunitcode NOT IN (SELECT m.hgnum_deptunitcode FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.hgnum_deptunitcode \= a.hopnum_deptunitcode AND M.gnum_hospital_code\=a.gnum_hospital_code AND m.hrgnum_visit_type \= 4 AND hrgnum_is_episode_open \= 1 AND m.hrgnum_visit_no >\= ALL (SELECT z.hrgnum_visit_no AS episodevisitno FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk \= ?) AND z.hrgnum_episode_code \=m.hrgnum_episode_code AND z.hrgnum_visit_type \= m.hrgnum_visit_type)) AND a.hopnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND p.gnum_hospital_code\=q.gnum_hospital_code AND p.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,q.GNUM_HOSPITAL_CODE) and p.gnum_hospital_code\=?)
													
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL_GBLT_DEPARTMENT_MST_NEW_VISIT_SP_CLINIC=SELECT DISTINCT a.hopnum_deptunitcode, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= SUBSTR(a.hopnum_deptunitcode,1,3) and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || '('|| (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hopnum_deptunitcode and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || ')' unitname FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND a.gnum_isvalid \= ? and a.gnum_hospital_code\=? AND a.hopnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst a WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? AND gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AND a.hopnum_deptunitcode NOT IN (SELECT m.hgnum_deptunitcode FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.hgnum_deptunitcode \= a.hopnum_deptunitcode AND M.gnum_hospital_code\=a.gnum_hospital_code AND m.hrgnum_visit_type \= 4 ) AND a.hopnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND p.gnum_hospital_code\=q.gnum_hospital_code AND p.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,q.GNUM_HOSPITAL_CODE) and p.gnum_hospital_code\=?) order by unitname
																				
ESSENTIAL.NEW_VISIT_SP_CLINIC_COUNTER_WISE.HGBT_UNIT_MST=SELECT DISTINCT a.hopnum_deptunitcode, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= SUBSTR(a.hopnum_deptunitcode,1,3) and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || '('|| (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hopnum_deptunitcode and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || ')' unitname FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND a.gnum_isvalid \= ? and a.gnum_hospital_code\=? AND a.hopnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst a WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? AND gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AND a.hopnum_deptunitcode NOT IN (SELECT m.hgnum_deptunitcode FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.hgnum_deptunitcode \= a.hopnum_deptunitcode AND M.gnum_hospital_code\=a.gnum_hospital_code AND m.hrgnum_visit_type \= 4 ) AND a.hopnum_deptunitcode IN (SELECT HGNUM_DEPTUNITCODE FROM gblt_counter_unit_mst WHERE gblnum_counter_id \= (SELECT gblnum_counter_id FROM gblt_counter_mst WHERE TRIM (gblstr_ip_addr) \= TRIM (?) AND gnum_isvalid \= 1 AND gnum_hospital_code \= ?) AND gnum_isvalid \= 1 AND gnum_hospital_code \= ?) order by unitname
																				
																				
ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL_GBLT_DEPARTMENT_MST_EMG_VISIT6-11-09 = SELECT   hgnum_deptunitcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code \= a.hgnum_dept_code AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || '('|| hgstr_unitname|| ')' FROM hgbt_unit_mst a WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND GNUM_HOSPITAL_CODE\=? AND hgnum_deptunitcode NOT IN (SELECT m.hgnum_deptunitcode FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND M.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND m.hgnum_deptunitcode \= a.hgnum_deptunitcode  AND m.hrgnum_visit_type IN (2,3) AND hrgnum_is_episode_open \= 1 AND m.hrgnum_visit_no >\= (SELECT max(z.hrgnum_visit_no) AS episodevisitno FROM hrgt_episode_dtl z WHERE (z.hrgnum_puk \= ?) AND Z.GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE AND z.hrgnum_episode_code \= m.hrgnum_episode_code and  z.hrgnum_visit_type \= m.hrgnum_visit_type)) AND hgnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl a, gblt_metatable_column_mst b WHERE a.gnum_metatable_id \= b.gnum_metatable_id AND b.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND B.GNUM_HOSPITAL_CODE\=? AND a.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE)) ORDER BY hgnum_deptunitcode

ESSENTIAL.HOPT_DEPT_UNIT_ROSTER_DTL_GBLT_DEPARTMENT_MST_EMG_VISIT=SELECT DISTINCT a.hopnum_deptunitcode, (SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE gnum_dept_code \= SUBSTR(a.hopnum_deptunitcode,1,3) and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || '('|| (SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= a.hopnum_deptunitcode and gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE)  AND NVL(gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ) || ')' unitname FROM hopt_dept_unit_roster_dtl a WHERE a.hopdt_start_dt <\= SYSDATE AND a.hopdt_end_dt >\= SYSDATE AND a.gnum_isvalid \= ? and a.gnum_hospital_code\=? AND a.hopnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst a WHERE hgnum_isgeneral \= ? AND gnum_isvalid \= ? AND gnum_hospital_code\=a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AND a.hopnum_deptunitcode NOT IN (SELECT m.hgnum_deptunitcode FROM hrgt_episode_dtl m WHERE m.hrgnum_puk \= ? AND m.hgnum_deptunitcode \= a.hopnum_deptunitcode AND M.gnum_hospital_code\=a.gnum_hospital_code AND m.hrgnum_visit_type in (2,3) ) AND a.hopnum_deptunitcode IN (SELECT gnum_column_value FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'HGBT_UNIT_MST' AND gstr_column_name \= 'HGNUM_DEPTUNITCODE' AND p.gnum_hospital_code\=q.gnum_hospital_code AND p.gnum_seatid \= Pkg_Usermgmt.fun_getseatid(?,q.GNUM_HOSPITAL_CODE) and p.gnum_hospital_code\=?) order by unitname
																				


SELECT.PATIENT_CATEGORY_DETAIL.GBLT_PAT_CAT_MST = Select GNUM_PATIENT_CAT_CODE as patCatCode,GNUM_CAT_SLNO as patCatSlNo, GSTR_PATIENT_CAT_NAME as patCatName,GSTR_PATIENT_CAT_SHORT as patCatShortName, GNUM_PATIENT_CAT_TYPE as patCatType,GBL_ISPAID as isPaid,GNUM_ISEXPIRY as isExpiry, GNUM_HL7_CODE as hl7Code,GNUM_ISVALID as isValid,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') as effectiveFrom, TO_CHAR(GDT_EFFECTIVE_TO,'dd-Mon-yyyy') as effectiveTo,GSTR_REMARKS as remarks, TO_CHAR(GDT_EXPIRY_DATE,'dd-Mon-yyyy') as expiryDate,GNUM_CAT_PRIORITY as priority, GSTR_EXPIRY_MONTH as expiryMonth, GNUM_EXPIRY_DAYS as expiryDay, GNUM_IS_ID_REQ as idRequired,GSTR_CRITERIA as criteriaRemarks, GSTR_BENEFIT as categoryBenefits from GBLT_PATIENT_CAT_MST where GNUM_PATIENT_CAT_CODE\=? AND GNUM_CAT_SLNO\=? AND GNUM_HOSPITAL_CODE\=?


UPDATE.GBLT_PATIENT_CAT_MST = UPDATE GBLT_PATIENT_CAT_MST SET GSTR_PATIENT_CAT_NAME \= Initcap(?),GSTR_PATIENT_CAT_SHORT \=upper(?), GNUM_PATIENT_CAT_TYPE \= ?,GBL_ISPAID \= ?,GNUM_ISEXPIRY \= ?,GNUM_HL7_CODE \= ?, GDT_EFFECTIVE_FRM \= TO_DATE(?,'dd-Mon-yyyy'), GDT_EFFECTIVE_TO \= TO_DATE(?,'dd-Mon-yyyy'),GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \= ?,GSTR_REMARKS \= ?,GNUM_CAT_PRIORITY \= ?, GSTR_EXPIRY_MONTH \= ?, GNUM_EXPIRY_DAYS \=?,GNUM_ISVALID \= ?,GNUM_IS_ID_REQ \= ? , GSTR_CRITERIA\= ? , GSTR_BENEFIT \=?  WHERE GNUM_PATIENT_CAT_CODE \= ? AND GNUM_CAT_SLNO \= ? AND GNUM_HOSPITAL_CODE\=?

								
SELECT.NEXT_DATE.GBLT_PAT_CAT_MST =SELECT to_char(MIN(GDT_EFFECTIVE_FRM),'dd-Mon-yyyy') FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE \= ? and GDT_EFFECTIVE_FRM >? and gnum_isvalid > 0 and gnum_hospital_code\=?\t
										
										
SELECT.PREV_DATE.GBLT_PAT_CAT_MST =SELECT COUNT(*) FROM GBLT_PATIENT_CAT_MST WHERE trunc(GDT_EFFECTIVE_FRM)<\=trunc(to_date(?,'dd-Mon-yyyy')) AND trunc(NVL(GDT_EFFECTIVE_TO,GDT_EFFECTIVE_FRM))>\=  trunc(to_date(?,'dd-Mon-yyyy')) AND GNUM_PATIENT_CAT_CODE \=? AND GNUM_ISVALID > 0 AND GNUM_HOSPITAL_CODE \= ?
										
SELECT.PREVIOUS_SERIAL_NO.GBLT_PAT_CAT_MST =SELECT GNUM_CAT_SLNO,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE \= ? AND GDT_EFFECTIVE_TO is null AND GNUM_HOSPITAL_CODE \= ?
								
UPDATE.PREVIOUS_ROW.GBLT_PAT_CAT_MST =UPDATE GBLT_PATIENT_CAT_MST set GNUM_ISVALID\=0, GDT_LSTMOD_DATE\=to_date(?,'dd-Mon-yyyy') , GNUM_LSTMOD_SEATID \= ?  WHERE GNUM_PATIENT_CAT_CODE\=? AND GNUM_CAT_SLNO\=?\tAND GNUM_HOSPITAL_CODE \= ?
											
CREATE.NEW.GBLT_PAT_CAT_MST = INSERT INTO GBLT_PATIENT_CAT_MST (GNUM_PATIENT_CAT_CODE,GNUM_CAT_SLNO,GSTR_PATIENT_CAT_NAME,GSTR_PATIENT_CAT_SHORT,GNUM_PATIENT_CAT_TYPE, GBL_ISPAID,GNUM_ISEXPIRY,GNUM_HL7_CODE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,GDT_EFFECTIVE_FRM, GSTR_REMARKS,GNUM_CAT_PRIORITY,GNUM_HOSPITAL_CODE,GSTR_EXPIRY_MONTH,GNUM_EXPIRY_DAYS,GNUM_IS_ID_REQ,GSTR_CRITERIA, GSTR_BENEFIT) VALUES (?,(SELECT NVL (MAX (GNUM_CAT_SLNO), 00) + 1 FROM GBLT_PATIENT_CAT_MST WHERE GNUM_PATIENT_CAT_CODE\=? AND GNUM_HOSPITAL_CODE \= ?), Initcap(?),upper(?),?,?,?,?,?,?,sysdate,sysdate,?,?,?,?,?,?,?,?)\t\t\t\t\t\t\t\t\t
								
UPDATE.GBLT_REG_CAT_MST =UPDATE GBLT_REG_CAT_MST set GSTR_REG_CAT_NAME \= ?,GSTR_REG_CAT_SHORT \= UPPER(?), GDT_EFFECTIVE_FRM \= TO_DATE(?,'dd-Mon-yyyy'), GDT_EFFECTIVE_TO \= TO_DATE(?,'dd-Mon-yyyy'),GNUM_HL7_CODE\= ?,GDT_LSTMOD_DATE \= sysdate, GNUM_LSTMOD_SEATID \= ?,GSTR_REMARKS \= ? where GNUM_REG_CAT_CODE \= ? and GNUM_REG_SLNO \= ? AND GNUM_HOSPITAL_CODE \= ?\t\t\t\t\t\t\t
								
								
SELECT.NEXT_DATE.GBLT_REG_CAT_MST	=SELECT MIN(GDT_EFFECTIVE_FRM) FROM GBLT_REG_CAT_MST WHERE GNUM_REG_CAT_CODE \= ? and GDT_EFFECTIVE_FRM >? and gnum_isvalid >0 and GNUM_HOSPITAL_CODE \= ?\t
										 
										 
SELECT.PREV_DATE.GBLT_REG_CAT_MST	=SELECT COUNT(*) FROM GBLT_REG_CAT_MST WHERE trunc(GDT_EFFECTIVE_FRM)<\=trunc(to_date(?,'dd-Mon-yyyy')) AND trunc(NVL(GDT_EFFECTIVE_TO,GDT_EFFECTIVE_FRM))>\=  trunc(to_date(?,'dd-Mon-yyyy')) AND GNUM_REG_CAT_CODE \=? AND GNUM_ISVALID >0 and GNUM_HOSPITAL_CODE \= ?\t
										 
										 
SELECT.PREVIOUS_SERIAL_NO.GBLT_REG_CAT_MST =SELECT GNUM_REG_SLNO,TO_CHAR(GDT_EFFECTIVE_FRM,'dd-Mon-yyyy') FROM GBLT_REG_CAT_MST WHERE GNUM_REG_CAT_CODE \= ? AND GDT_EFFECTIVE_TO is null and GNUM_HOSPITAL_CODE \= ?\t\t
												
												
UPDATE.PREVIOUS_ROW.GBLT_REG_CAT_MST=UPDATE GBLT_REG_CAT_MST set GDT_EFFECTIVE_TO\=TO_DATE(? ,'dd-mm-yyyy')-1, GDT_LSTMOD_DATE\=to_date(?,'dd-Mon-yyyy') , GNUM_LSTMOD_SEATID \= ?  WHERE GNUM_REG_CAT_CODE\=? AND GNUM_REG_SLNO\=? and GNUM_HOSPITAL_CODE \= ?
																
																
																
CREATE.NEW.GBLT_REG_CAT_MST =INSERT INTO GBLT_REG_CAT_MST (GNUM_REG_CAT_CODE,GNUM_REG_SLNO, GSTR_REG_CAT_NAME,GSTR_REG_CAT_SHORT,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM,GDT_EFFECTIVE_TO,GNUM_HL7_CODE,GSTR_REMARKS,GNUM_HOSPITAL_CODE) VALUES (?,(SELECT NVL (MAX (GNUM_REG_SLNO), 00) + 1 FROM GBLT_REG_CAT_MST  WHERE GNUM_REG_CAT_CODE\=? AND GNUM_HOSPITAL_CODE \= ?),?,UPPER(?),?,?,sysdate,TO_DATE(?,'dd-Mon-yyyy'), TO_DATE(?,'dd-Mon-yyyy'),?,?,?)\t
								
								
SELECT.REGISTRATION_CATEGORY_DETAIL.GBLT_REG_CAT_MST=SELECT gnum_reg_cat_code AS regcatcode, gnum_reg_slno AS regcatslno, gstr_reg_cat_name AS regcatname, gstr_reg_cat_short AS regcatshortname, gnum_hl7_code AS hl7code, gnum_isvalid AS isvalid, TO_CHAR (gdt_effective_frm, 'dd-Mon-yyyy') AS effectivefrom, TO_CHAR (gdt_effective_to, 'dd-Mon-yyyy') AS effectiveto, gstr_remarks AS remarks FROM gblt_reg_cat_mst WHERE gnum_reg_cat_code \= ? AND gnum_reg_slno \= ? AND GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t
	
#Changed by Akash Singh, Due to table changed in G5, dated on 20-07-2015 											 													
SELECT.ISCONSULTANTDOCT_LIST.PSRT_EMPLOYEE_MST_OLD	=SELECT A.STR_EMP_NO AS cmoCode, STR_FIRST_NAME||' '||STR_MIDDLE_NAME||' '|| STR_LAST_NAME||'('||( SELECT STR_DESIG_ST_NAME FROM PIST_DESIGNATION_MST WHERE NUM_DESIG_ID\=B.NUM_DESIG_ID AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? AND TRUNC(SYSDATE) BETWEEN TRUNC(GDT_EFFECTIVE_FRM) AND TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE)) )||')'||'('|| A.STR_EMP_NO|| ')' AS doctorName FROM PIST_EMP_PERSONNEL_DTL A, PIST_EMP_CUR_DETAIL_DTL B WHERE A.STR_EMP_NO\=B.STR_EMP_NO AND A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=? AND NUM_DESIG_ID IN (3,5) ORDER BY STR_FIRST_NAME  \t\t\t

#Changed by Akash Singh, Due to table changed in G5, dated on 20-07-2015 													 													
SELECT.ISCONSULTANTDOCT_LIST.PSRT_EMPLOYEE_MST	=SELECT A.STR_EMP_NO AS cmoCode, STR_EMP_FULL_NAME||'('||( SELECT gstr_desig_name FROM gblt_designation_mst WHERE gnum_desig_code\=A.gnum_desig_code AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=? )||')'||'('|| A.STR_EMP_NO|| ')' AS doctorName FROM PIST_EMP_REGISTRATION_DTL A WHERE A.GNUM_HOSPITAL_CODE\=? AND A.GNUM_ISVALID\=? AND gnum_desig_code IN (3,5,116) ORDER BY STR_EMP_FULL_NAME  \t\t\t
																 
SELECT.EXPIRY_DTL.HGBT_UNIT_MST= SELECT GNUM_EXPIRY_DAY,GNUM_EXPIRY_MONTH,GNUM_ISEXPIRY FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE=?

SELECT.NEXT_EXPIRY_DATE_DUAL= SELECT TO_CHAR (TRUNC (SYSDATE + ?), 'dd-Mon-yyyy') FROM DUAL			


ESSENTIAL.HGBT_DEPT_ICD_MST.DEPT= SELECT   DISTINCT TRIM(HGBSTR_DISEASE_CODE) FROM HGBT_DEPT_ICD_MST WHERE GNUM_DEPT_CODE = ? AND GNUM_ISVALID = ? ORDER BY TRIM(HGBSTR_DISEASE_CODE)


ESSENTIAL.PSRT_EMPLOYEE_MST.UNIT = SELECT B.PSRSTR_EMP_NO,B.PSRSTR_FNAME||' '||B.PSRSTR_MNAME||' '||B.PSRSTR_LNAME NAME FROM HGBT_UNIT_CONSULTANT_MST A,PSRT_EMPLOYEE_MST B WHERE A.HGSTR_EMP_CODE\=B.PSRSTR_EMP_NO  AND A.HGNUM_DEPTUNITCODE\=? AND A.GNUM_ISVALID\=? AND B.GNUM_ISVALID\=? ORDER BY NAME

SELECT.GBLT_DEPARTMENT_MST	=SELECT INITCAP(B.GSTR_DEPT_NAME) || ' (' || INITCAP(A.HGSTR_UNITNAME) || ')' AS unitName, A.HGNUM_DEPTUNITCODE  FROM HGBT_UNIT_MST A, GBLT_DEPARTMENT_MST B WHERE A.HGNUM_DEPT_CODE\=B.GNUM_DEPT_CODE AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND TRUNC(SYSDATE) BETWEEN TRUNC(A.GDT_EFFECTIVE_FRM) AND TRUNC(NVL(A.GDT_EFFECTIVE_TO,SYSDATE)) AND TRUNC(SYSDATE) BETWEEN TRUNC(B.GDT_EFFECTIVE_FRM) AND TRUNC(NVL(B.GDT_EFFECTIVE_TO,SYSDATE)) AND A.GNUM_ISVALID\=? AND A.HGNUM_DEPTUNITCODE\=? AND A.GNUM_HOSPITAL_CODE\=?
						

SELECT.EXT_INSTITUTE_DTL.GBLT_EXT_INSTITUTE_MST = select GNUM_INSTITUTE_CODE as instituteCode, GNUM_INSTITUTE_SLNO as instituteSlNo, GSTR_INSTITUTE_NAME as instituteName, GSTR_SHORT_NAME as instituteShortName, GNUM_IS_ASSOCIATED as isAssociated, GNUM_INSTITUTE_TYPE as instituteType, GSTR_INSTITUTE_ADD1 as instituteAddress1, GSTR_INSTITUTEL_ADD2 as instituteAddress2, GSTR_CITY as city, GNUM_STATE_CODE as stateCode, GSTR_PHONE as phone, GSTR_FAX as fax, GSTR_EMAIL as email, GSTR_CONTACT_PERSON as contactPerson, GNUM_HL7_CODE as hl7Code, GSTR_REMARKS as remarks, GNUM_ISVALID as isValid from GBLT_EXT_INSTITUTE_MST where GNUM_INSTITUTE_CODE\=? and GNUM_INSTITUTE_SLNO\=? and GNUM_HOSPITAL_CODE\=?\t
													
													
SELECT.GBLT_STATE_MST = select GNUM_STATECODE, GSTR_STATENAME from GBLT_STATE_MST where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? order by GSTR_STATENAME
						

UPDATE.GBLT_EXT_INSTITUTE_MST = UPDATE GBLT_EXT_INSTITUTE_MST SET GSTR_INSTITUTE_NAME\=?,GSTR_SHORT_NAME\=?,GNUM_IS_ASSOCIATED\=?, GNUM_INSTITUTE_TYPE\=?, GSTR_INSTITUTE_ADD1\=?, GSTR_INSTITUTEL_ADD2\=?, GSTR_CITY\=?,GNUM_STATE_CODE\=?, GSTR_PHONE\=?, GSTR_FAX\=?, GSTR_EMAIL\=?, GSTR_CONTACT_PERSON\=?, GNUM_HL7_CODE\=?,GSTR_REMARKS\=?, GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? WHERE GNUM_INSTITUTE_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_INSTITUTE_SLNO\=?
								
								
INSERT.GBLT_EXT_INSTITUTE_MST = INSERT INTO GBLT_EXT_INSTITUTE_MST (GNUM_INSTITUTE_CODE, GNUM_HOSPITAL_CODE, GNUM_INSTITUTE_SLNO, GSTR_INSTITUTE_NAME, GSTR_SHORT_NAME, GNUM_IS_ASSOCIATED, GNUM_INSTITUTE_TYPE, GSTR_INSTITUTE_ADD1, GSTR_INSTITUTEL_ADD2, GSTR_CITY, GNUM_STATE_CODE, GSTR_PHONE, GSTR_FAX, GSTR_EMAIL, GSTR_CONTACT_PERSON, GNUM_HL7_CODE, GSTR_REMARKS, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,(SELECT NVL(MAX(GNUM_INSTITUTE_SLNO),0)+1 FROM GBLT_EXT_INSTITUTE_MST WHERE GNUM_INSTITUTE_CODE\=? AND GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE)

										
INSERT.HRGT_REG_SEASON_MST = INSERT INTO HRGT_REG_SEASON_MST (HRGNUM_SEASON_CODE, GNUM_HOSPITAL_CODE, HRGNUM_SLNO, HRGSTR_SEASON_DESC, HRGDT_SEASON_FRM_DT, HRGDT_SEASON_TO_DT, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HRGNUM_DAYS) VALUES((SELECT NVL(MAX(HRGNUM_SEASON_CODE),10)+1 FROM HRGT_REG_SEASON_MST WHERE GNUM_HOSPITAL_CODE\=?),?,?,INITCAP(?),?,?,?,?,SYSDATE,?)
							 

SELECT.HRGT_REG_SEASON_MST = select HRGNUM_SEASON_CODE as seasonCode, GNUM_HOSPITAL_CODE as hospitalCode, HRGNUM_SLNO as seasonSlNo, HRGSTR_SEASON_DESC as seasonDesc, HRGDT_SEASON_FRM_DT as seasonFromDate, HRGDT_SEASON_TO_DT as seasonToDate from HRGT_REG_SEASON_MST where HRGNUM_SEASON_CODE\=? and HRGNUM_SLNO\=? and GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t 
							 
						
UPDATE.HRGT_REG_SEASON_MST = UPDATE HRGT_REG_SEASON_MST SET HRGSTR_SEASON_DESC\=INITCAP(?), GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_SEASON_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND HRGNUM_SLNO\=?
							
UPDATE.PREVIOUS.ROW.HRGT_REG_SEASON_MST = UPDATE HRGT_REG_SEASON_MST SET GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_SEASON_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND HRGNUM_SLNO\=?


MODIFY.INSERT.HRGT_REG_SEASON_MST = INSERT INTO HRGT_REG_SEASON_MST (HRGNUM_SEASON_CODE, GNUM_HOSPITAL_CODE, HRGNUM_SLNO, HRGSTR_SEASON_DESC, HRGDT_SEASON_FRM_DT, HRGDT_SEASON_TO_DT, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE,HRGNUM_DAYS) VALUES(?,?,(SELECT NVL(MAX(HRGNUM_SLNO),0)+1 FROM HRGT_REG_SEASON_MST WHERE HRGNUM_SEASON_CODE\=? AND GNUM_HOSPITAL_CODE\=?),INITCAP(?),?,?,?,?,SYSDATE,?)
									
CHECK.FROM_DATE.HRGT_REG_SEASON_MST = SELECT * FROM HRGT_REG_SEASON_MST WHERE TO_DATE(?,'DD-MM') >\=TO_DATE(HRGDT_SEASON_FRM_DT,'dd-mm') AND TO_DATE(?,'DD-MM')<\=TO_DATE(HRGDT_SEASON_FRM_DT,'dd-mm')+HRGNUM_DAYS AND GNUM_HOSPITAL_CODE\=?
	
CHECK.TO_DATE.HRGT_REG_SEASON_MST = SELECT * FROM HRGT_REG_SEASON_MST WHERE TO_DATE(?,'dd-mm')+? >\=TO_DATE(HRGDT_SEASON_FRM_DT,'dd-mm') AND TO_DATE(?,'dd-mm')+? <\=TO_DATE(HRGDT_SEASON_FRM_DT,'dd-mm')+HRGNUM_DAYS AND GNUM_HOSPITAL_CODE\=?\t\t\t\t\t\t\t
							
COUNT.DAYS.HRGT_REG_SEASON_MST = SELECT TO_DATE(?,'DD-MM')- TO_DATE(?,'DD-MM') FROM DUAL 	

COUNT.DAYS.DIFF.HRGT_REG_SEASON_MST = select ahis_gbl_util.date_diff(TO_DATE(?,'DD-Mon')+365,TO_DATE(?,'DD-Mon')) from dual 																												 
	

INSERT.GBLT_OCCUPATION_MST = INSERT INTO GBLT_OCCUPATION_MST(GNUM_OCCUPATION_CODE,GNUM_OCCUPATION_SLNO,GNUM_HOSPITAL_CODE,GSTR_OCCUPATION_NAME,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(GNUM_OCCUPATION_CODE),10)+1 FROM GBLT_OCCUPATION_MST WHERE GNUM_HOSPITAL_CODE\=?),11,?,INITCAP(?),?,?,SYSDATE)               \t\t\t\t\t\t\t\t  \t\t\t 
								  			 
								  			 
SELECT.GBLT_OCCUPATION_MST = SELECT GSTR_OCCUPATION_NAME FROM GBLT_OCCUPATION_MST WHERE GNUM_OCCUPATION_CODE\=? AND GNUM_OCCUPATION_SLNO\=? AND GNUM_ISVALID\=?\t 
                                             
                                             
UPDATE.GBLT_OCCUPATION_MST = UPDATE  GBLT_OCCUPATION_MST  SET GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=To_date(SYSDATE,'dd-Mon-yyyy'),GNUM_ISVALID\=? WHERE GNUM_OCCUPATION_CODE\=? AND GNUM_OCCUPATION_SLNO\=? AND GNUM_HOSPITAL_CODE\=?                                            
                                             
INSERTMODIFY.GBLT_OCCUPATION_MST = INSERT INTO GBLT_OCCUPATION_MST(GNUM_OCCUPATION_CODE,GNUM_OCCUPATION_SLNO,GNUM_HOSPITAL_CODE,GSTR_OCCUPATION_NAME,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES (?,(SELECT MAX(GNUM_OCCUPATION_SLNO)+1 FROM GBLT_OCCUPATION_MST WHERE GNUM_OCCUPATION_CODE\=? AND GNUM_HOSPITAL_CODE\=?),?,INITCAP(?),?,?,SYSDATE)     
                                             
                                             
                                             							  			 																															


SELECT.REGISTRATION_TIMING.DUAL = select ahis_reg.getregtiming(?,?,?) from dual																																	

ESSENTIAL.GBLT_OCCUPATION_MST = select GNUM_OCCUPATION_CODE,GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where GNUM_ISVALID = ?  ORDER BY GSTR_OCCUPATION_NAME
						


ESSENTIAL.HRGT_REG_SEASON_MST = SELECT HRGNUM_SEASON_CODE, HRGSTR_SEASON_DESC FROM HRGT_REG_SEASON_MST A WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? AND HRGNUM_SLNO\=(SELECT MAX(HRGNUM_SLNO) FROM HRGT_REG_SEASON_MST WHERE HRGNUM_SEASON_CODE\=A.HRGNUM_SEASON_CODE AND GNUM_HOSPITAL_CODE\=A.GNUM_HOSPITAL_CODE)

SELECT.HRGT_REG_CAT_TIMINGS =select GNUM_REG_CAT_CODE as regCatCode, HRGNUM_SEASON_CODE as seasonCode, GNUM_WEEK_DAY as weekDay, HGNUM_SHIFT_CODE as shiftCode, GNUM_HOSPITAL_CODE as hospitalCode, GNUM_ISVALID as isValid, GNUM_SEAT_ID as seatID, GDT_ENTRY_DATE as entryDate, GNUM_SLNO as slNo from HRGT_REG_CAT_TIMINGS where GNUM_REG_CAT_CODE\=? and HRGNUM_SEASON_CODE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t


ESSENTIAL.FOR_REG.GBLT_SHIFT_MST = SELECT HGNUM_SHIFT_CODE, HRGSTR_SHIFT_DESC FROM GBLT_SHIFT_MST WHERE GNUM_ISVALID = ? and GBLT_SHIFT_TYPE=? AND GNUM_HOSPITAL_CODE = ?


INSERT.NEW.GBLT_PAT_CAT_MST = INSERT INTO GBLT_PATIENT_CAT_MST (GNUM_PATIENT_CAT_CODE, GSTR_PATIENT_CAT_NAME, GSTR_PATIENT_CAT_SHORT, GNUM_PATIENT_CAT_TYPE, GBL_ISPAID, GNUM_CAT_PRIORITY, GNUM_ISEXPIRY, GNUM_EXPIRY_DAYS, GSTR_EXPIRY_MONTH, GNUM_HL7_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GDT_EFFECTIVE_FRM,  GNUM_HOSPITAL_CODE, GNUM_IS_ID_REQ,GSTR_CRITERIA, GSTR_BENEFIT) VALUES((SELECT NVL(MAX(GNUM_PATIENT_CAT_CODE),10)+1 FROM GBLT_PATIENT_CAT_MST WHERE GNUM_HOSPITAL_CODE\=?), Initcap(?),upper(?),?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,?,?,?)

					

SELECT.DEPT.HRGT_DEPTUNIT_GROUPING = select GNUM_FROM_DEPT_CODE as fromDeptCode, GNUM_TO_DEPT_CODE as toDeptCode, HRGNUM_GROUPING_TYPE as groupingType, GNUM_ISVALID as isValid, GNUM_SEAT_ID as seatID, GDT_ENTRY_DATE as entryDate, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_FROM_DEPT_CODE and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as fromDeptName, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_TO_DEPT_CODE and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as toDeptName from HRGT_DEPTUNIT_GROUPING a where HRGNUM_GROUPING_TYPE \= ? and GNUM_ISVALID \= ? and GNUM_HOSPITAL_CODE\=? order by todeptname
									
									
SELECT.UNIT.HRGT_DEPTUNIT_GROUPING = select HGNUM_FROM_DEPTUNITCODE as fromDeptUnitCode, HGNUM_TO_DEPTUNITCODE as toDeptUnitCode, HRGNUM_GROUPING_TYPE as groupingType, GNUM_ISVALID as isValid, GNUM_SEAT_ID as seatID, GDT_ENTRY_DATE as entryDate, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=substr(a.HGNUM_FROM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_FROM_DEPTUNITCODE and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||')'as fromDeptUnitName, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=substr(a.HGNUM_TO_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_TO_DEPTUNITCODE and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||')'as toDeptUnitName from HRGT_DEPTUNIT_GROUPING a where HRGNUM_GROUPING_TYPE \= ? and GNUM_ISVALID \= ? and GNUM_HOSPITAL_CODE\=? order by toDeptUnitName
									

ESSENTIAL.DEPT.GBLT_DEPARTMENT_MST = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE \= ? ORDER BY GSTR_DEPT_NAME
										
ALL_DEPT_EXCEPT_FROM_DEPT = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST a WHERE GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE) AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_CODE\!\=? AND GNUM_DEPT_TYPE \= ? and gnum_dept_code not in (select GNUM_FROM_DEPT_CODE from HRGT_DEPTUNIT_GROUPING where GNUM_TO_DEPT_CODE\=? AND gnum_isvalid \= a.gnum_isvalid  AND gnum_hospital_code \= A.GNUM_HOSPITAL_CODE) ORDER BY GSTR_DEPT_NAME

ALL_UNIT_EXCEPT_FROM_UNIT = SELECT A.HGNUM_DEPTUNITCODE,(SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE\=SUBSTR(A.HGNUM_DEPTUNITCODE,1,3) AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE))||'('|| HGSTR_UNITNAME ||')' AS UNIT FROM HGBT_UNIT_MST A WHERE A.GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? and  A.HGNUM_DEPTUNITCODE\!\=? AND A.GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (A.GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE) and hgnum_deptunitcode not in (select HGNUM_FROM_DEPTUNITCODE from HRGT_DEPTUNIT_GROUPING where HGNUM_TO_DEPTUNITCODE\= ? AND gnum_isvalid \= a.gnum_isvalid  AND gnum_hospital_code \= A.GNUM_HOSPITAL_CODE) ORDER BY UNIT
												
												
INSERT.DEPT.HRGT_DEPTUNIT_GROUPING = INSERT INTO HRGT_DEPTUNIT_GROUPING \
									(GNUM_FROM_DEPT_CODE, GNUM_TO_DEPT_CODE, HRGNUM_GROUPING_TYPE, \
									GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HGNUM_VISITDATE_BOUND) \
									VALUES(?,?,?,?,?,SYSDATE,?,?)
																
																
INSERT.UNIT.HRGT_DEPTUNIT_GROUPING = INSERT INTO HRGT_DEPTUNIT_GROUPING \
									(HGNUM_FROM_DEPTUNITCODE, HGNUM_TO_DEPTUNITCODE, HRGNUM_GROUPING_TYPE, \
									GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HOSPITAL_CODE,HGNUM_VISITDATE_BOUND) \
									VALUES(?,?,?,?,?,SYSDATE,?,?)

DELETE.DEPT.HRGT_DEPTUNIT_GROUPING = UPDATE HRGT_DEPTUNIT_GROUPING SET GNUM_ISVALID=? WHERE GNUM_FROM_DEPT_CODE = ? AND GNUM_TO_DEPT_CODE = ? AND GNUM_HOSPITAL_CODE =? AND GNUM_ISVALID = ?


DELETE.UNIT.HRGT_DEPTUNIT_GROUPING = UPDATE HRGT_DEPTUNIT_GROUPING SET GNUM_ISVALID=? WHERE HGNUM_FROM_DEPTUNITCODE = ? AND HGNUM_TO_DEPTUNITCODE = ? AND GNUM_HOSPITAL_CODE =? AND GNUM_ISVALID = ?


MODIFY.DEPT_GROUP.HRGT_DEPTUNIT_GROUPING = select GNUM_FROM_DEPT_CODE as fromDeptCode, GNUM_TO_DEPT_CODE as toDeptCode, GNUM_ISVALID as isValid, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_FROM_DEPT_CODE and GNUM_HOSPITAL_CODE \= ? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as fromDeptName, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=a.GNUM_TO_DEPT_CODE and GNUM_HOSPITAL_CODE \= ? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) as toDeptName,HGNUM_VISITDATE_BOUND as groupingValidity from HRGT_DEPTUNIT_GROUPING A where GNUM_FROM_DEPT_CODE \= ? and GNUM_TO_DEPT_CODE \= ? and GNUM_HOSPITAL_CODE \= ? and GNUM_ISVALID \= ?


MODIFY.UNIT_GROUP.HRGT_DEPTUNIT_GROUPING = select HGNUM_FROM_DEPTUNITCODE as fromDeptUnitCode, HGNUM_TO_DEPTUNITCODE as toDeptUnitCode, GNUM_ISVALID as isValid, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=substr(a.HGNUM_FROM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE \= ? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_FROM_DEPTUNITCODE and GNUM_HOSPITAL_CODE \= ? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||')'as fromDeptUnitName, (select GSTR_DEPT_NAME from GBLT_DEPARTMENT_MST where GNUM_DEPT_CODE\=substr(a.HGNUM_TO_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE \= ? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||'('|| (select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE\=a.HGNUM_TO_DEPTUNITCODE and GNUM_HOSPITAL_CODE\=? and GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE))||')'as toDeptUnitName,HGNUM_VISITDATE_BOUND as groupingValidity from HRGT_DEPTUNIT_GROUPING a where GNUM_ISVALID \= ? and GNUM_HOSPITAL_CODE \= ? and HGNUM_FROM_DEPTUNITCODE \= ? and HGNUM_TO_DEPTUNITCODE \= ?


UPDATE.DEPT.HRGT_DEPTUNIT_GROUPING = UPDATE HRGT_DEPTUNIT_GROUPING SET GNUM_ISVALID \= ?,HGNUM_VISITDATE_BOUND\=?, GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \= ? WHERE GNUM_FROM_DEPT_CODE \= ? AND GNUM_TO_DEPT_CODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ? 


UPDATE.UNIT.HRGT_DEPTUNIT_GROUPING = UPDATE HRGT_DEPTUNIT_GROUPING SET GNUM_ISVALID \= ?,HGNUM_VISITDATE_BOUND\=?, GDT_LSTMOD_DATE \= SYSDATE, GNUM_LSTMOD_SEATID \= ? WHERE HGNUM_FROM_DEPTUNITCODE \= ? AND HGNUM_TO_DEPTUNITCODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \= ?


COUNT.DEPT.RECORD.HRGT_DEPTUNIT_GROUPING = SELECT COUNT(*) FROM HRGT_DEPTUNIT_GROUPING WHERE GNUM_FROM_DEPT_CODE \=? AND GNUM_TO_DEPT_CODE \= ? AND HRGNUM_GROUPING_TYPE \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?
											
COUNT.UNIT.RECORD.HRGT_DEPTUNIT_GROUPING = SELECT COUNT(*) FROM HRGT_DEPTUNIT_GROUPING WHERE HGNUM_FROM_DEPTUNITCODE \=? AND HGNUM_TO_DEPTUNITCODE \= ? AND HRGNUM_GROUPING_TYPE \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ? \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t

																		



INSERT.HRGT_PAT_STATUS_MST= INSERT INTO HRGT_PAT_STATUS_MST(HRGNUM_STATUS_CODE,HRGNUM_SLNO,GNUM_HOSPITAL_CODE,HRGSTR_STATUS,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(HRGNUM_STATUS_CODE),10)+1 FROM HRGT_PAT_STATUS_MST WHERE GNUM_HOSPITAL_CODE\=? ),1,?,INITCAP(?),?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy')\:\:timestamp)               \t\t\t\t\t\t\t\t  \t\t\t 


SELECT.HRGT_PAT_STATUS_MST=    SELECT HRGSTR_STATUS,HRGNUM_IS_MLC FROM HRGT_PAT_STATUS_MST WHERE HRGNUM_STATUS_CODE=? AND HRGNUM_SLNO=? AND GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=?	          								  			 

UPDATE.HRGT_PAT_STATUS_MST= UPDATE HRGT_PAT_STATUS_MST SET GNUM_LSTMOD_SEATID\=?,GDT_LSTMOD_DATE\=to_date(to_char(SYSDATE,'dd-Mon-yyyy'),'dd-Mon-yyyy')\:\:timestamp,GNUM_ISVALID\=? WHERE HRGNUM_STATUS_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?   

INSERTMODIFY.HRGT_PAT_STATUS_MST= INSERT INTO HRGT_PAT_STATUS_MST (HRGNUM_STATUS_CODE,HRGNUM_SLNO,GNUM_HOSPITAL_CODE,HRGSTR_STATUS,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE)VALUES (?,(SELECT MAX(HRGNUM_SLNO)+1 FROM HRGT_PAT_STATUS_MST WHERE HRGNUM_STATUS_CODE\=? AND GNUM_HOSPITAL_CODE\=?),?,INITCAP(?),?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy')\:\:timestamp)     

                                             								  			 
	/**
	## 		Modification Log		:Hospital Code Removed				
	##		Modify Date				: 19-01-2015
	##		Reason	(CR/PRS)		: CR [Hospital code removed from the Table HRGT_PAT_STATUS_MST]
	##		Modify By				: Akash Singh
	*/
SELECT.PAT_STATUS_LIST.HRGT_PAT_STATUS_MST	=SELECT HRGNUM_STATUS_CODE, INITCAP(HRGSTR_STATUS) FROM HRGT_PAT_STATUS_MST WHERE GNUM_ISVALID\=? order by INITCAP(HRGSTR_STATUS)

SELECT.REG_CHARGE.REG_DEPT_CHARGES = SELECT Ahis_Reg.RegDeptCharges(?,?,?,?,?,?,?,?) FROM dual
SELECT.REG_CHARGE.REG_UNIT_CHARGES = SELECT Ahis_Reg.RegUnitCharges(?,?,?,?,?,?,?) FROM dual



INSERT.HRGT_TRIAGE_DTL	=INSERT INTO HRGT_TRIAGE_DTL(HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_PUK, HRGNUM_SNO, HRGNUM_EMRGENCY_CASE_CODE ,HRGDT_IN_DATE, HRGTM_IN_TIME, HRGNUM_PAT_INSTATUS, HRGSTR_PAT_INCOMPLAINT, HRGDT_OUT_DATE, HRGTM_OUT_TIME, HRGNUM_PAT_OUTSTATUS, HRGSTR_PAT_OUTCOMPLAINT, HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD) VALUES (?, ?, ?,NVL((SELECT MAX(HRGNUM_SNO) FROM HRGT_TRIAGE_DTL WHERE HRGNUM_EPISODE_CODE \=? AND HRGNUM_VISIT_NO\=? AND HRGNUM_PUK\=? AND GNUM_HOSPITAL_CODE\=?),0)+1, ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, INITCAP(?), TO_DATE(?,'dd-Mon-yyyy'), ?, ?, INITCAP(?), INITCAP(?), TO_DATE(sysdate,'dd-Mon-yyyy'), ?, ?, ?, ?)

INSERT.NEW.HRGT_TRIAGE_DTL	=INSERT INTO HRGT_TRIAGE_DTL(HRGNUM_EPISODE_CODE, HRGNUM_VISIT_NO, HRGNUM_PUK, HRGNUM_SNO, HRGNUM_EMRGENCY_CASE_CODE ,HRGDT_IN_DATE, HRGTM_IN_TIME, HRGNUM_PAT_INSTATUS, HRGSTR_PAT_INCOMPLAINT, HRGDT_OUT_DATE, HRGTM_OUT_TIME, HRGNUM_PAT_OUTSTATUS, HRGSTR_PAT_OUTCOMPLAINT, HRGSTR_REMARKS, GDT_ENTRY_DATE, GNUM_ISVALID, GNUM_SEAT_ID, GNUM_HOSPITAL_CODE, HRGSTR_IP_ADD) VALUES (?, ?, ?,(SELECT MAX(NVL(HRGNUM_SNO,0))+1 FROM HRGT_TRIAGE_DTL WHERE HRGNUM_EPISODE_CODE \=? AND HRGNUM_VISIT_NO\=? AND HRGNUM_PUK\=? AND GNUM_HOSPITAL_CODE\=?), ?, TO_DATE(?,'dd-Mon-yyyy'), ?, ?, INITCAP(?), TO_DATE(?,'dd-Mon-yyyy'), ?, ?, INITCAP(?), INITCAP(?), TO_DATE(sysdate,'dd-Mon-yyyy'), ?, ?, ?, ?)

SELECT.DATA_BY_EPI_VISIT.HRGT_TRIAGE_DTL	=SELECT HRGNUM_EMRGENCY_CASE_CODE AS emergencyCode , TO_CHAR(HRGDT_IN_DATE,'dd-Mon-yyyy') AS inDate, HRGTM_IN_TIME AS inTime, HRGNUM_PAT_INSTATUS AS inPatStatus, INITCAP(HRGSTR_PAT_INCOMPLAINT) AS inCondition, TO_CHAR(HRGDT_OUT_DATE,'dd-Mon-yyyy') AS outDate, HRGTM_OUT_TIME AS outTime, HRGNUM_PAT_OUTSTATUS AS outPatStatus, INITCAP(HRGSTR_PAT_OUTCOMPLAINT) AS outCondition, INITCAP(HRGSTR_REMARKS) AS remarks, TO_CHAR(GDT_ENTRY_DATE,'dd-Mon-yyyy') AS entryDate, GNUM_SEAT_ID AS seatId FROM HRGT_TRIAGE_DTL WHERE HRGNUM_EPISODE_CODE\=? AND HRGNUM_VISIT_NO\=? AND HRGNUM_PUK\=? AND GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=?


ESSENTIAL.GBLT_REG_CAT_MST_LIST = SELECT GNUM_REG_CAT_CODE, GSTR_REG_CAT_NAME FROM GBLT_REG_CAT_MST WHERE GNUM_ISVALID \=? AND GNUM_HOSPITAL_CODE\=? AND GDT_EFFECTIVE_FRM\t<\= SYSDATE AND (TO_DATE(NVL(GDT_EFFECTIVE_TO,SYSDATE),'DD-MM-YY')>\=TO_DATE(SYSDATE,'DD-MM-YY')) ORDER BY GSTR_REG_CAT_NAME
								
								
UPDATE.CURRENT.HRGT_TRIAGE_DTL	=UPDATE HRGT_TRIAGE_DTL SET HRGNUM_EMRGENCY_CASE_CODE\=?, HRGDT_OUT_DATE\=TO_DATE(?,'dd-Mon-yyyy'), HRGTM_OUT_TIME\=?, HRGNUM_PAT_OUTSTATUS\=?, HRGSTR_PAT_OUTCOMPLAINT\=?, HRGSTR_REMARKS\=?, GDT_LSTMOD_DATE\=TO_DATE(SYSDATE,'dd-Mon-yyyy'), GNUM_LSTMOD_SEATID\=? WHERE HRGNUM_EPISODE_CODE \=? AND HRGNUM_VISIT_NO\=? AND HRGNUM_PUK\=? AND GNUM_HOSPITAL_CODE\=?

UPDATE.OLD.HRGT_TRIAGE_DTL	=UPDATE HRGT_TRIAGE_DTL SET GDT_LSTMOD_DATE\=TO_DATE(?,'dd-Mon-yyyy'), GNUM_LSTMOD_SEATID\=?, GNUM_ISVALID\=? WHERE HRGNUM_EPISODE_CODE \=? AND HRGNUM_VISIT_NO\=? AND HRGNUM_PUK\=? AND GNUM_HOSPITAL_CODE\=?

SELECT.DIAGNOSIS.TYPE.CODE.HGBT_UNIT_MST=SELECT gnum_diagnosis_code_type FROM hgbt_unit_mst WHERE hgnum_deptunitcode \= ? AND gnum_hospital_code \= ? AND gdt_effective_frm <\= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_DATE (SYSDATE, 'DD-MM-YY') ) AND (gnum_isvalid \= ? OR gnum_isvalid \= ?)
											
SELECT.CONSULTANT.HGBT_UNIT_CONSULTANT_MST=select HGSTR_EMP_CODE, (SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_personnel_dtl b WHERE b.str_emp_no \=HGSTR_EMP_CODE)  AS empname from HGBT_UNIT_CONSULTANT_MST where HGNUM_DEPTUNITCODE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_ISVALID\=?


SELECT.EMER_CASE_LIST.HRGT_EMRGENCY_CASE_MST	=SELECT HRGNUM_EMRGENCY_CASE_CODE, INITCAP(HRGNUM_EMRGENCY_CASE) FROM HRGT_EMRGENCY_CASE_MST WHERE GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?


CHECK.RECORD.HRGT_REG_SEASON_MST = SELECT ISSEASONOVERLAPPED(?,?,?,?,?) FROM DUAL


												

SELECT.NEXT_EXPIRY_DATE_FROM_DUAL=	select to_char(ROUND (TO_DATE (?|| '-'  || DECODE (SIGN (  TO_CHAR (TO_DATE (SUBSTR (?, 4, 3 ), 'MM' ), 'MM' ) - TO_CHAR (SYSDATE, 'MM') ), -1, TO_CHAR (SYSDATE, 'YYYY') + 1, TO_CHAR (SYSDATE, 'YYYY') ), 'dd-mm-yyyy') ),'dd-Mon-yyyy') from dual




INSERT.HRGT_EMRGENCY_CASE_MST= INSERT INTO HRGT_EMRGENCY_CASE_MST(HRGNUM_EMRGENCY_CASE_CODE,HRGNUM_SLNO,GNUM_HOSPITAL_CODE,HRGNUM_EMRGENCY_CASE,HRGNUM_ISMLC_REQ,HRGNUM_CASE_TYPE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(HRGNUM_EMRGENCY_CASE_CODE),10)+1 FROM HRGT_EMRGENCY_CASE_MST WHERE GNUM_HOSPITAL_CODE\=?),1,?,INITCAP(?),?,?,?,?,TO_DATE(TO_CHAR(SYSDATE, 'dd-Mon-yyyy'), 'dd-Mon-yyyy'))    
                                
SELECT.HRGT_EMRGENCY_CASE_MST= SELECT HRGNUM_EMRGENCY_CASE,HRGNUM_ISMLC_REQ,HRGNUM_ISMLC_REQ FROM HRGT_EMRGENCY_CASE_MST WHERE HRGNUM_EMRGENCY_CASE_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?\t                         
                                           								  			 
UPDATE.HRGT_EMRGENCY_CASE_MST=UPDATE HRGT_EMRGENCY_CASE_MST SET GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=To_date(to_char(SYSDATE,'dd-Mon-yyyy'),'dd-Mon-yyyy'),GNUM_ISVALID\=? WHERE HRGNUM_EMRGENCY_CASE_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?                                            
  
INSERTMODIFY.HRGT_EMRGENCY_CASE_MST= INSERT INTO HRGT_EMRGENCY_CASE_MST(HRGNUM_EMRGENCY_CASE_CODE,HRGNUM_SLNO,GNUM_HOSPITAL_CODE,HRGNUM_EMRGENCY_CASE,HRGNUM_ISMLC_REQ,HRGNUM_CASE_TYPE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES (?,(SELECT MAX(HRGNUM_SLNO)+1 FROM HRGT_EMRGENCY_CASE_MST WHERE HRGNUM_EMRGENCY_CASE_CODE\=? AND GNUM_HOSPITAL_CODE\=?),?,INITCAP(?),?,?,?,  ?,TO_DATE(TO_CHAR(SYSDATE,'dd-Mon-yyyy'),'dd-Mon-yyyy'))    
                                       
                                       
                                       
DUPLICATE_CHECK.INSERT.HRGT_EMRGENCY_CASE_MST=SELECT COUNT (HRGNUM_EMRGENCY_CASE)   FROM HRGT_EMRGENCY_CASE_MST WHERE TRIM (UPPER (HRGNUM_EMRGENCY_CASE)) \= TRIM (UPPER (?))    AND gnum_isvalid \!\= ?  AND gnum_hospital_code \=?

DUPLICATE_CHECK.MODIFY.HRGT_EMRGENCY_CASE_MST=SELECT COUNT (HRGNUM_EMRGENCY_CASE) FROM HRGT_EMRGENCY_CASE_MST  WHERE TRIM (UPPER (HRGNUM_EMRGENCY_CASE)) \= TRIM (UPPER (?)) AND gnum_isvalid \!\=?  AND gnum_hospital_code \=?   AND HRGNUM_EMRGENCY_CASE_CODE \!\=?                                       
                                        											 
											                                        							  			 
#Changed By Amit Garg as OPD G5 Changes
ESSENTIAL.ALL.HGBT_UNIT_MST = select hgnum_deptunitcode,deptunitname from(SELECT a.hgnum_deptunitcode,(SELECT  gstr_dept_name   FROM gblt_department_mst WHERE gnum_hospital_code \= a.gnum_hospital_code and gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) and  gnum_isvalid \= ? ) ||'(' || a.hgstr_unitname || ')' as deptunitname FROM hgbt_unit_mst a    WHERE a.gnum_hospital_code \= ?      AND a.gnum_isvalid \= ? ) where 1\=1 ORDER BY deptunitname 
								



INSERT.HRGT_REG_CAT_TIMINGS = INSERT INTO HRGT_REG_CAT_TIMINGS (GNUM_REG_CAT_CODE, HRGNUM_SEASON_CODE, GNUM_WEEK_DAY, HGNUM_SHIFT_CODE, GNUM_SLNO, GNUM_HOSPITAL_CODE, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) VALUES(?,?,?,?,(SELECT NVL(MAX(GNUM_SLNO),0)+1 FROM HRGT_REG_CAT_TIMINGS WHERE GNUM_REG_CAT_CODE\=? AND HRGNUM_SEASON_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_WEEK_DAY\=? AND HGNUM_SHIFT_CODE\=?),?,?,?,SYSDATE)



DELETE.HRGT_REG_CAT_TIMINGS = UPDATE HRGT_REG_CAT_TIMINGS SET GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=SYSDATE, GNUM_LSTMOD_SEATID\=? WHERE GNUM_REG_CAT_CODE\=? AND HRGNUM_SEASON_CODE\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?
								

								

											
ESSENTIAL.GBLT_PATIENT_CAT_MST.DETAIL_VOS	=SELECT GNUM_PATIENT_CAT_CODE AS patCatCode, GNUM_CAT_SLNO AS patCatSlNo, GSTR_PATIENT_CAT_NAME AS patCatName, GSTR_PATIENT_CAT_SHORT AS patCatShortName, GNUM_PATIENT_CAT_TYPE AS patCatType, GBL_ISPAID AS isPaid, GNUM_CAT_PRIORITY AS priority, GNUM_ISEXPIRY AS isExpiry, GSTR_EXPIRY_MONTH AS expiryMonth, GNUM_EXPIRY_DAYS AS expiryDay, GNUM_HL7_CODE AS hl7Code, GDT_EXPIRY_DATE AS expiryDate, GSTR_REMARKS AS remarks FROM GBLT_PATIENT_CAT_MST  WHERE GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \=? AND TRUNC(SYSDATE) BETWEEN TRUNC(GDT_EFFECTIVE_FRM) AND TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE)) AND GNUM_PATIENT_CAT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL A, GBLT_METATABLE_COLUMN_MST B WHERE A.GNUM_METATABLE_ID \= B.GNUM_METATABLE_ID AND B.GSTR_TABLE_NAME \= 'GBLT_PATIENT_CAT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_PATIENT_CAT_CODE' AND A.GNUM_SEATID \= Pkg_Usermgmt.fun_getseatid(?,B.GNUM_HOSPITAL_CODE) AND A.GNUM_HOSPITAL_CODE\=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE\=?) ORDER BY GSTR_PATIENT_CAT_NAME


ESSENTIAL.GBLT_PATIENT_CAT_MST.DESK	=SELECT GNUM_PATIENT_CAT_CODE AS patCatCode, GNUM_CAT_SLNO AS patCatSlNo, GSTR_PATIENT_CAT_NAME AS patCatName, GSTR_PATIENT_CAT_SHORT AS patCatShortName, GNUM_PATIENT_CAT_TYPE AS patCatType, GBL_ISPAID AS isPaid, GNUM_CAT_PRIORITY AS priority, GNUM_ISEXPIRY AS isExpiry, GSTR_EXPIRY_MONTH AS expiryMonth, GNUM_EXPIRY_DAYS AS expiryDay, GNUM_HL7_CODE AS hl7Code, GDT_EXPIRY_DATE AS expiryDate, GSTR_REMARKS AS remarks FROM GBLT_PATIENT_CAT_MST  WHERE GNUM_HOSPITAL_CODE \= ? AND GNUM_ISVALID \=? AND TRUNC(SYSDATE) BETWEEN TRUNC(GDT_EFFECTIVE_FRM) AND TRUNC(NVL(GDT_EFFECTIVE_TO,SYSDATE)) and GNUM_PATIENT_CAT_TYPE\=0 ORDER BY GSTR_PATIENT_CAT_NAME
												
												
INSERT.HRGT_INJURY_TYPE_MST= INSERT INTO HRGT_INJURY_TYPE_MST(HRGNUM_INJURY_TYPE_CODE,HRGNUM_SLNO,HRGNUM_IS_MLC,GNUM_HOSPITAL_CODE,HRGSTR_INJURY_TYPE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES ((SELECT NVL(MAX(HRGNUM_INJURY_TYPE_CODE),10)+1 FROM HRGT_INJURY_TYPE_MST WHERE GNUM_HOSPITAL_CODE\=?),1,?,?,INITCAP(?),?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy')\:\:timestamp)               \t\t\t\t\t\t\t\t  \t\t\t 


					
DUPLICATE_CHECK.INSERT.HRGT_INJURY_TYPE_MST=SELECT COUNT (HRGSTR_INJURY_TYPE)   FROM HRGT_INJURY_TYPE_MST WHERE TRIM (UPPER (HRGSTR_INJURY_TYPE)) \= TRIM (UPPER (?)) AND HRGNUM_IS_MLC\=? AND gnum_isvalid \!\=?   AND gnum_hospital_code \=?   



DUPLICATE_CHECK.MODIFY.HRGT_INJURY_TYPE_MST=SELECT COUNT (HRGSTR_INJURY_TYPE)   FROM HRGT_INJURY_TYPE_MST WHERE TRIM (UPPER (HRGSTR_INJURY_TYPE)) \= TRIM (UPPER (?)) AND gnum_isvalid \!\=?   AND gnum_hospital_code \=?   AND HRGNUM_INJURY_TYPE_CODE\!\=?

								  			 
SELECT.HRGT_INJURY_TYPE_MST= SELECT HRGSTR_INJURY_TYPE,HRGNUM_IS_MLC FROM HRGT_INJURY_TYPE_MST WHERE HRGNUM_INJURY_TYPE_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?\t 
	   
//UPDATE.HRGT_INJURY_TYPE_MST= UPDATE HRGT_INJURY_TYPE_MST SET GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=To_date(SYSDATE,'dd-Mon-yyyy'),// GNUM_ISVALID\=? WHERE HRGNUM_INJURY_TYPE_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?       
                             
                       
UPDATE.HRGT_INJURY_TYPE_MST= UPDATE HRGT_INJURY_TYPE_MST SET GNUM_LSTMOD_SEATID\=?, GDT_LSTMOD_DATE\=To_char(SYSDATE,'dd-Mon-yyyy')\:\:timestamp,GNUM_ISVALID\=? WHERE HRGNUM_INJURY_TYPE_CODE\=? AND HRGNUM_SLNO\=? AND GNUM_HOSPITAL_CODE\=?       
  
MODIFYINSERT.HRGT_INJURY_TYPE_MST= INSERT INTO HRGT_INJURY_TYPE_MST(HRGNUM_INJURY_TYPE_CODE,HRGNUM_SLNO,HRGNUM_IS_MLC,GNUM_HOSPITAL_CODE,HRGSTR_INJURY_TYPE,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE) VALUES (?,(SELECT MAX(HRGNUM_SLNO)+1 FROM HRGT_INJURY_TYPE_MST WHERE HRGNUM_INJURY_TYPE_CODE\=? AND GNUM_HOSPITAL_CODE\=?),?,?,INITCAP(?),?,?,TO_CHAR(SYSDATE,'dd-Mon-yyyy')\:\:timestamp)     
                                                             


SELECT.MLC_NO.HRGT_PATIENT_MLC_DTL = SELECT HRGSTR_MLC_NO FROM HRGT_PATIENT_MLC_DTL A WHERE HRGNUM_PUK \= ? AND GNUM_HOSPITAL_CODE \= ? AND HRGNUM_S_NO \= (SELECT MAX(HRGNUM_S_NO) FROM HRGT_PATIENT_MLC_DTL WHERE HRGNUM_PUK \= A.HRGNUM_PUK AND GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID \= ?



CHECK_VALID_MLC_CR_NO.HRGT_PATIENT_MLC_DTL = select count(*) from HRGT_PATIENT_MLC_DTL where HRGNUM_PUK = ? and GNUM_HOSPITAL_CODE = ?

 

SELECT.ALL_INJURY_TYPES.HRGT_INJURY_TYPE_MST	=SELECT HRGNUM_INJURY_TYPE_CODE, INITCAP(HRGSTR_INJURY_TYPE) FROM HRGT_INJURY_TYPE_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE\=? order by INITCAP(HRGSTR_INJURY_TYPE)

					
					
					
			/*Query For City Location Master */
			
SELECT.DEFAULTSTATE.GBLT_STATE_MST= SELECT gstr_statename  FROM gblt_state_mst WHERE gnum_statecode = ? and GNUM_HOSPITAL_CODE=?

SELECT.DISTRICT.GBLT_DISTRICT_MST=SELECT NUM_DIST_ID, INITCAP(str_dist_name)  FROM GBLT_DISTRICT_MST WHERE GNUM_STATECODE \= ? AND GNUM_HOSPITAL_CODE \= ? AND GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)  ORDER BY INITCAP(str_dist_name)

INSERT.GBLT_CITY_LOCATION_MST= INSERT INTO GBLT_CITY_LOCATION_MST(GNUM_CITY_LOC_CODE, GSTR_CITY_LOC_NAME, GNUM_CITY_LOC_PIN, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_HL7_CODE, GNUM_HOSPITAL_CODE, NUM_DIST_ID, GNUM_AREA_CATEGORY, GSTR_CITY_NAME) VALUES((SELECT NVL(MAX(GNUM_CITY_LOC_CODE),999)+1 FROM GBLT_CITY_LOCATION_MST WHERE GNUM_HOSPITAL_CODE \= ?),INITCAP(?), ?,?,?,TO_DATE(?,'dd-Mon-yyyy'),?,?,?,?,?)
								 
SELECT.CITYLOCATIONDETAIL.GBLT_CITY_LOCATION_MST=SELECT gstr_city_loc_name AS locationname,gnum_city_loc_code as locationCode, gnum_city_loc_pin AS pincode, gnum_isvalid AS isvalid, gnum_seat_id AS seatid, gdt_entry_date AS entrydate, gnum_hl7_code AS hl7code, num_dist_id AS district, (SELECT DISTINCT b.str_dist_name FROM gblt_district_mst b WHERE b.num_dist_id \= a.num_dist_id AND b.gnum_hospital_code \= 100 and trunc(GDT_EFFECTIVE_FRM)<\=trunc(sysdate) and trunc(nvl(GDT_EFFECTIVE_TO,sysdate))>\=trunc(sysdate)) AS districtname, (SELECT DISTINCT c.gstr_statename FROM gblt_state_mst c, gblt_district_mst b WHERE a.num_dist_id \= b.num_dist_id AND b.gnum_statecode \= c.gnum_statecode AND b.gnum_hospital_code \= c.gnum_hospital_code AND c.gnum_hospital_code \= 100) AS state, gnum_area_category AS areacategory, gstr_city_name AS cityname FROM gblt_city_location_mst a WHERE gnum_city_loc_code \= ? AND gnum_hospital_code \= ? 
											 
UPDATE.GBLT_CITY_LOCATION_MST= update gblt_city_location_mst set  GSTR_CITY_LOC_NAME\=initcap(?),NUM_DIST_ID\=?, GNUM_AREA_CATEGORY\=?,GSTR_CITY_NAME\=?, GNUM_CITY_LOC_PIN\=?, GNUM_ISVALID\=?, GNUM_SEAT_ID\=?, GNUM_HL7_CODE\=? where GNUM_CITY_LOC_CODE\=? and GNUM_HOSPITAL_CODE\=?
								
								
INSERT.HGBT_ROOM_MST=insert into HGBT_ROOM_MST(HGNUM_ROOM_CODE,HGSTR_ROOM_NAME, HGNUM_SEAT_ID, GNUM_ISVALID, HGSTR_ROOM_DESC, GNUM_HOSPITAL_CODE, NUM_ROOM_ID) values((SELECT NVL(MAX(HGNUM_ROOM_CODE),99999)+1 FROM HGBT_ROOM_MST WHERE GNUM_HOSPITAL_CODE \= ?),initcap(?),?,?,?,?,?)
								
SELECT.ROOMMASTERDETAIL.HGBT_ROOM_MST=select HGSTR_ROOM_NAME as roomName, GNUM_ISVALID as isValid, HGSTR_ROOM_DESC as roomDescription,(SELECT a.num_room_number FROM est_room_mst a, hgbt_room_mst b WHERE b.hgnum_room_code \=? AND b.num_room_id \= a.num_room_id) AS estateroomname,GDT_EFFECT_DATE as effectiveDate from HGBT_ROOM_MST  where HGNUM_ROOM_CODE\=? and GNUM_HOSPITAL_CODE\=?
													

UPDATE.HGBT_ROOM_MST=update HGBT_ROOM_MST set HGSTR_ROOM_NAME\=?, GNUM_ISVALID\=?, HGSTR_ROOM_DESC\=?, GDT_EFFECT_DATE\=?, NUM_ROOM_ID\=? where HGNUM_ROOM_CODE\=? and GNUM_HOSPITAL_CODE\=?



SELECT.EXPIRY_DATE.FOR.STAMPING.AND.RENEWAL.FROM_DUAL	=	select to_char(ROUND(TO_DATE(? ||'-'||DECODE(SIGN(TO_CHAR(TO_DATE(SUBSTR(?,4,3),'MM'),'MM')-TO_CHAR(SYSDATE,'MM')),-1,TO_CHAR(SYSDATE,'YYYY')+1,TO_CHAR(SYSDATE,'YYYY')),'dd-mm-yyyy')),'dd-mon-yyyy') from dual													 

SELECT_LOC_DETAIL_BASIS_OF_CODE_GBLT_CITY_LOCATION_MST = SELECT GNUM_CITY_LOC_PIN as pinCode,  NUM_DIST_ID as district, GNUM_AREA_CATEGORY as areaCategory, GSTR_CITY_NAME as cityName FROM GBLT_CITY_LOCATION_MST WHERE GNUM_CITY_LOC_CODE \= ? AND GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?
														
ESSENTIAL_SPECIAL_CLINIC_UNIT.HGBT_UNIT_MST = SELECT a.hgnum_deptunitcode,(SELECT  gstr_dept_name   FROM gblt_department_mst WHERE gnum_hospital_code \= a.gnum_hospital_code and gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) and  gnum_isvalid \= ? AND \tGDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE)) ||'(' || a.hgstr_unitname || ')' as deptunitname FROM hgbt_unit_mst a    WHERE a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND a.HGNUM_ISGENERAL\=? AND GDT_EFFECTIVE_FRM<\=TRUNC(SYSDATE) AND NVL(GDT_EFFECTIVE_TO,SYSDATE+1)>\=TRUNC(SYSDATE) ORDER BY INITCAP (deptunitname) \t\t\t\t\t\t\t\t
												
																																		

													

SELECT.BILL.AMOUNT.IS_ID_REQUIRED.HBLT_CHARGE_MST.GBLT_PATIENT_CAT_MST	=SELECT nvl((SELECT hblnum_cost FROM hblt_charge_mst WHERE sblnum_chargetype_id \= ? AND hblnum_tariff_id \= ? AND gnum_patient_cat_code \= ? AND gnum_isvalid \= ? AND (gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) AND GNUM_HOSPITAL_CODE \=? ),0) as amount, gnum_is_id_req FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code \= ? AND gdt_effective_frm <\= SYSDATE AND (TO_CHAR (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY')) AND (gnum_isvalid \= ? OR gnum_isvalid \= ?) and gnum_hospital_code\=?
		
	
	
								
SELECT.BLOCK.EST_BLOCK_MST=SELECT distinct NUM_BLOCK_ID, STR_BLOCK_NAME FROM est_block_mst WHERE num_building_code \= ? AND num_hospital_code \= ? AND GNUM_ISVALID\=?  AND gdt_effective_frm <\= SYSDATE  AND (TO_CHAR(NVL (gdt_effective_to, SYSDATE),'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY'))  order by  STR_BLOCK_NAME

SELECT.FLOOR.EST_FLOOR_MST=select NUM_FLOOR_ID, STR_FLOOR_NAME from EST_FLOOR_MST where NUM_BLOCK_ID\=? and NUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?  AND  gdt_effective_frm <\= SYSDATE  AND (TO_CHAR(NVL (gdt_effective_to, SYSDATE),'DD-MM-YY') >\= TO_CHAR(SYSDATE, 'DD-MM-YY'))  order by  NUM_FLOOR_NUMBER

SELECT.ROOM.EST_ROOM_MST=select NUM_ROOM_ID, STR_ROOM_NAME from EST_ROOM_MST where NUM_FLOOR_ID\=? and NUM_HOSPITAL_CODE\=? AND GNUM_ISVALID\=?  AND  gdt_effective_frm <\= SYSDATE  AND (TO_CHAR (NVL (gdt_effective_to, SYSDATE),'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY')) order by  NUM_ROOM_NUMBER
			
SELECT.LOCATION.HGBT_LOCATION_MST = SELECT hgnum_location_code, INITCAP(hgstr_description) FROM hgbt_location_mst WHERE gnum_isvalid \= ? AND gnum_hospital_code \= ?ORDER BY INITCAP(hgstr_description)
										
ESSENTIAL.EST_BUILDING_MST=SELECT num_building_code, STR_BUILDING_NAME FROM EST_BUILDING_MST WHERE GNUM_ISVALID \= ? AND NUM_HOSPITAL_CODE\=? and   gdt_effective_frm <\= SYSDATE  AND (TO_CHAR (NVL (gdt_effective_to, SYSDATE),'DD-MM-YY') >\= TO_CHAR (SYSDATE, 'DD-MM-YY'))  order by STR_BUILDING_NAME 
                          																			

SELECT.GBLT_LOCATION_TYPE_MST=SELECT   GNUM_LOC_TYPE_CODE, GSTR_LOC_TYPE FROM gblt_location_type_mst WHERE gnum_isvalid \= ? AND gnum_hospital_code \= ? ORDER BY GSTR_LOC_TYPE

INSERT.HGBT_LOCATION_MST=insert into hgbt_location_mst (HGNUM_LOCATION_CODE,HGSTR_DESCRIPTION,HGSTR_BUILDING,HGSTR_BLOCK,HGSTR_FLOOR,HGSTR_ROOM,HGSTR_LANDMARK, HGNUM_LOC_TYPE_CODE,HGDT_EFFECT_DATE,GNUM_ISVALID,HGNUM_SEAT_ID,HGDT_ENTRY_DATE,GNUM_HOSPITAL_CODE) values((SELECT NVL (MAX (HGNUM_LOCATION_CODE), 100000) + 1 from hgbt_location_mst where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,trunc(sysdate),?,?,sysdate,?)

SELECT.HGBT_LOCATION_MST=select  HGNUM_LOCATION_CODE as locationCode, HGSTR_DESCRIPTION as locationDescription, HGSTR_FLOOR as floor, HGSTR_BUILDING as building, HGSTR_LANDMARK as landMark,HGNUM_LOC_TYPE_CODE as locationTypeCode, to_char(HGDT_EFFECT_DATE,'dd-mon-yyyy') as effectiveDate, GNUM_ISVALID as isValid, HGNUM_SEAT_ID as seatID, to_char(HGDT_ENTRY_DATE,'dd-mon-yyyy') as entryDate,HGSTR_ROOM as room, HGSTR_BLOCK as block,GNUM_HOSPITAL_CODE as hospitalCode from HGBT_LOCATION_MST a where a.HGNUM_LOCATION_CODE\=? and a.GNUM_HOSPITAL_CODE\=?
                              
UPDATE.HGBT_LOCATION_MST=update  hgbt_location_mst set hgstr_description\=?,hgstr_building\=?, hgstr_block\=?, hgstr_floor\=?, hgstr_room\=?,hgnum_loc_type_code \=?, hgstr_landmark\=?, hgdt_effect_date\=?\:\:timestamp,gnum_isvalid\=? where HGNUM_LOCATION_CODE\=? and GNUM_HOSPITAL_CODE\=?  
                         
DUPLICATE_CHECK.INSERT.HGBT_LOCATION_MST = SELECT COUNT (hgstr_description)   FROM hgbt_location_mst  WHERE TRIM (UPPER (hgstr_description)) \= TRIM (UPPER (?)) AND  gnum_isvalid \!\=?   AND gnum_hospital_code \= ?   
                 
DUPLICATE_CHECK.UPDATE.HGBT_LOCATION_MST = SELECT COUNT (hgstr_description)   FROM hgbt_location_mst  WHERE TRIM (UPPER (hgstr_description)) \= TRIM (UPPER (?)) AND  gnum_isvalid \!\=?    AND gnum_hospital_code \= ?   AND  HGNUM_LOCATION_CODE\!\=?

                            
INSERT.HRGT_DISCLAIMER_MST.DEFAULT=insert into HRGT_DISCLAIMER_MST (HRGNUM_DISCLAIMER_ID,GNUM_HOSPITAL_CODE,HRGNUM_SLNO,HRGNUM_USABILITY_FLAG, HGSTR_DISCLAIMER_DESC1,HGSTR_DISCLAIMER_DESC2, HGSTR_DISCLAIMER_DESC3,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HRGNUM_ISDEFAULT) values((SELECT NVL (MAX (HRGNUM_DISCLAIMER_ID), 100) + 1 from HRGT_DISCLAIMER_MST where GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,?,?,sysdate,?)   

      
         
SELECT.HRGT_DISCLAIMER_MST.DEFAULT.NORMAL=select HRGNUM_DISCLAIMER_ID as disclaimerId,HRGNUM_USABILITY_FLAG as usabilityFlag,HRGNUM_SLNO as slNo, HGSTR_DISCLAIMER_DESC1 as disclaimerDesc1, HGSTR_DISCLAIMER_DESC2 as disclaimerDesc2, HGSTR_DISCLAIMER_DESC3 as disclaimerDesc3 from HRGT_DISCLAIMER_MST where HRGNUM_SLNO\= ( select max(HRGNUM_SLNO) from HRGT_DISCLAIMER_MST where HRGNUM_USABILITY_FLAG\=1 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=? ) and HRGNUM_USABILITY_FLAG\=1 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=?


SELECT.HRGT_DISCLAIMER_MST.DEFAULT.SPECIAL=select HRGNUM_DISCLAIMER_ID as disclaimerId,HRGNUM_USABILITY_FLAG as usabilityFlag,HRGNUM_SLNO as slNo, HGSTR_DISCLAIMER_DESC1 as disclaimerDesc1, HGSTR_DISCLAIMER_DESC2 as disclaimerDesc2, HGSTR_DISCLAIMER_DESC3 as disclaimerDesc3 from HRGT_DISCLAIMER_MST where HRGNUM_SLNO\= ( select max(HRGNUM_SLNO) from HRGT_DISCLAIMER_MST where HRGNUM_USABILITY_FLAG\=2 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=? ) and HRGNUM_USABILITY_FLAG\=2 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=?


SELECT.HRGT_DISCLAIMER_MST.DEFAULT.CASUALITY=select HRGNUM_DISCLAIMER_ID as disclaimerId,HRGNUM_USABILITY_FLAG as usabilityFlag,HRGNUM_SLNO as slNo, HGSTR_DISCLAIMER_DESC1 as disclaimerDesc1, HGSTR_DISCLAIMER_DESC2 as disclaimerDesc2, HGSTR_DISCLAIMER_DESC3 as disclaimerDesc3 from HRGT_DISCLAIMER_MST where HRGNUM_SLNO\= ( select max(HRGNUM_SLNO) from HRGT_DISCLAIMER_MST where HRGNUM_USABILITY_FLAG\=3 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=? ) and HRGNUM_USABILITY_FLAG\=3 and GNUM_ISVALID\=1 and GNUM_HOSPITAL_CODE\=?

SELECT.HRGT_DISCLAIMER_MST.DEFAULT=select HRGNUM_DISCLAIMER_ID as disclaimerId,HRGNUM_USABILITY_FLAG as usabilityFlag,HRGNUM_SLNO as slNo,HRGNUM_ISHEADER isHeader,HRGNUM_ALIGN alignment,GNUM_ISVALID isvalid, HGSTR_DISCLAIMER_DESC1 as disclaimerDesc1, HGSTR_DISCLAIMER_DESC2 as disclaimerDesc2, HGSTR_DISCLAIMER_DESC3 as disclaimerDesc3 from HRGT_DISCLAIMER_MST where HRGNUM_SLNO\= ( select max(HRGNUM_SLNO) from HRGT_DISCLAIMER_MST where HRGNUM_ISDEFAULT\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=? ) and HRGNUM_ISDEFAULT\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE\=?


              
               
MODIFY.INSERT.HRGT_DISCLAIMER_MST.DEFAULT = insert into HRGT_DISCLAIMER_MST (HRGNUM_DISCLAIMER_ID,GNUM_HOSPITAL_CODE,HRGNUM_SLNO,HRGNUM_USABILITY_FLAG, HGSTR_DISCLAIMER_DESC1,HGSTR_DISCLAIMER_DESC2, HGSTR_DISCLAIMER_DESC3,GNUM_ISVALID,GNUM_SEAT_ID,GDT_ENTRY_DATE,HRGNUM_ISDEFAULT,HRGNUM_ISHEADER,HRGNUM_ALIGN) values(?,?,(select max(HRGNUM_SLNO)+1 from HRGT_DISCLAIMER_MST where HRGNUM_DISCLAIMER_ID\=? and GNUM_HOSPITAL_CODE\=?),?,?,?,?,?,?,sysdate,?,?,?)   


UPDATE.HRGT_DISCLAIMER_MST.DEFAULT=UPDATE hrgt_disclaimer_mst  SET gnum_isvalid \= ?, gdt_lstmod_date \= SYSDATE,gnum_lstmod_seatid \=?   WHERE hrgnum_disclaimer_id \=? and gnum_hospital_code \=?  and hrgnum_slno \= (select max(hrgnum_slno) from hrgt_disclaimer_mst where hrgnum_disclaimer_id \=? and gnum_hospital_code \=?)

SELECT.GBLT_DEPARTMENT_MST.DUPLICATE_ADD_CHECK=SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_ISVALID IN (1,2) AND UPPER(TRIM(GSTR_DEPT_NAME))=UPPER(TRIM(?)) AND GNUM_HOSPITAL_CODE=? AND GNUM_DEPT_CODE <> ?



CHECKDUPLICATE.GBLT_OCCUPATION_MST= select GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where upper(GSTR_OCCUPATION_NAME)=upper(?) and GNUM_ISVALID!=? and GNUM_HOSPITAL_CODE=?


CHECKDUPLICATEMODIFY.GBLT_OCCUPATION_MST= select GSTR_OCCUPATION_NAME from GBLT_OCCUPATION_MST where upper(GSTR_OCCUPATION_NAME)=upper(?) and GNUM_ISVALID!=? and GNUM_HOSPITAL_CODE=? and GNUM_OCCUPATION_CODE!=?

SELECT.CHECK_DUPLICATE.HRGT_PAT_STATUS_MST= select count(*) from hrgt_pat_status_mst where trim(upper(HRGSTR_STATUS))=trim(upper(?)) and  GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?


SELECT.CHECK_MOD_DUPLICATE.HRGT_PAT_STATUS_MST= select count(*) from hrgt_pat_status_mst where trim(upper(HRGSTR_STATUS))=trim(upper(?))  and GNUM_ISVALID!=? and GNUM_HOSPITAL_CODE=? and HRGNUM_STATUS_CODE!=?


CHECK_LOCATION.GBLT_CITY_LOCATION_MST = SELECT * FROM GBLT_CITY_LOCATION_MST WHERE trim(UPPER(?))=trim(UPPER(GSTR_CITY_LOC_NAME)) AND GNUM_HOSPITAL_CODE = ? and GNUM_ISVALID in(?,?)

CHECK_LOCATION_MODIFY.GBLT_CITY_LOCATION_MST = SELECT * FROM GBLT_CITY_LOCATION_MST WHERE trim(UPPER(?))=trim(UPPER(GSTR_CITY_LOC_NAME)) AND GNUM_HOSPITAL_CODE = ? and GNUM_ISVALID != ? AND GNUM_CITY_LOC_CODE!= ?

SELECT.CHEK_DUPLICATE_RECORD=SELECT get_dup_check(?,?,?,?,?,?) FROM DUAL



SELECT.CMO_LIST.PIST_EMP_PERSONNEL_DTL	=SELECT   a.hgstr_emp_code, str_first_name || ' ' || str_middle_name || ' '|| str_last_name NAME FROM hgbt_unit_consultant_mst a, hgbt_unit_mst b, pist_emp_personnel_dtl c  WHERE b.hgnum_isgeneral \= 3 AND a.hgnum_deptunitcode \= b.hgnum_deptunitcode AND a.gnum_isvalid \= ?  AND b.gnum_isvalid \= a.gnum_isvalid   AND c.gnum_isvalid \= a.gnum_isvalid AND a.gnum_hospital_code \= ?  AND b.gnum_hospital_code \= a.gnum_hospital_code  AND c.gnum_hospital_code \= a.gnum_hospital_code AND c.str_emp_no \= a.hgstr_emp_code ORDER BY NAME

SELECT.SHIFT.GBLT_SHIFT_MST	=SELECT DISTINCT hopstr_start_time||'@'||hopstr_end_time,hrgstr_shift_desc FROM gblt_shift_mst a, hopt_dept_unit_roster_mst b WHERE a.gnum_isvalid \= ? AND b.gnum_isvalid \= a.gnum_isvalid AND a.gnum_hospital_code \= ? AND b.gnum_hospital_code \= a.gnum_hospital_code AND a.hgnum_shift_code \= b.hgnum_shift_code AND b.hgnum_deptunitcode IN (SELECT hgnum_deptunitcode FROM hgbt_unit_mst WHERE gnum_isvalid \= a.gnum_isvalid AND hgnum_isgeneral \= 3 AND gnum_hospital_code \= a.gnum_hospital_code) order by hrgstr_shift_desc 


SELECT.DEPARTMENT_TYPE.GBLT_DEPARTMENT_TYPE=	select GNUM_DEPT_TYPE, INITCAP(GSTR_DEPT_TYPE_NAME) from gblt_department_type where GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID=? order by  GSTR_DEPT_TYPE_NAME

SELECT.HRGT_DISCLAIMER_MST.UNITWISE 	=SELECT hgstr_disclaimer_desc1||'@'||hgstr_disclaimer_desc2||'@'|| hgstr_disclaimer_desc3||'@'||hrgnum_isheader||'@'||hrgnum_align as disclaimer FROM hrgt_disclaimer_mst a WHERE gnum_hospital_code \= ? and HGNUM_DEPTUNITCODE \=? AND hrgnum_slno \=(SELECT MAX (hrgnum_slno) FROM hrgt_disclaimer_mst WHERE a.hrgnum_disclaimer_id \= hrgnum_disclaimer_id AND a.gnum_hospital_code \= gnum_hospital_code and gnum_isvalid\=a.gnum_isvalid) and gnum_isvalid\=?\t\t       
		       
SELECT.HRGT_DISCLAIMER_MST.DEPTWISE 	=SELECT hgstr_disclaimer_desc1||'@'||hgstr_disclaimer_desc2||'@'|| hgstr_disclaimer_desc3||'@'||hrgnum_isheader||'@'||hrgnum_align as disclaimer FROM hrgt_disclaimer_mst a WHERE gnum_hospital_code \= ? and GNUM_DEPT_CODE \=? AND hrgnum_slno \=(SELECT MAX (hrgnum_slno) FROM hrgt_disclaimer_mst WHERE a.hrgnum_disclaimer_id \= hrgnum_disclaimer_id AND a.gnum_hospital_code \= gnum_hospital_code and gnum_isvalid\=a.gnum_isvalid) and gnum_isvalid\=?\t\t       
		       
SELECT.FOR.REGISTRATION.HRGT_DISCLAIMER_MST.DEFAULT 	=SELECT hgstr_disclaimer_desc1||'@'||hgstr_disclaimer_desc2||'@'||hgstr_disclaimer_desc3||'@'||hrgnum_isheader||'@'||hrgnum_align as disclaimer FROM hrgt_disclaimer_mst a WHERE gnum_hospital_code \= ? and HRGNUM_ISDEFAULT\=1 and hrgnum_usability_flag\=? AND hrgnum_slno \=(SELECT MAX (hrgnum_slno) FROM hrgt_disclaimer_mst  WHERE a.hrgnum_disclaimer_id \= hrgnum_disclaimer_id AND a.gnum_hospital_code \= gnum_hospital_code and gnum_isvalid\=a.gnum_isvalid) and gnum_isvalid\=? \t\t       
		       
SELECT.UNIT_WORKING_DAYS_FROM_DUAL=select unitdays(?,?) from dual

SELECT.ALL_CLINICAL_DEPARTMENT_FOR_REFER.GBLT_DEPARTMENT_MST=SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_hospital_code \= ?  AND gnum_dept_type \= ? AND gdt_effective_frm <\= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >\= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (gnum_isvalid \= ? OR gnum_isvalid \= ?) order by gstr_dept_name
																
ESSENTIAL.ALL_UNIT_BY_TYPE.HGBT_UNIT_MST=SELECT   a.hgnum_deptunitcode, INITCAP (b.gstr_dept_name) || ' (' || INITCAP (a.hgstr_unitname) || ')' FROM hgbt_unit_mst a, gblt_department_mst b WHERE a.hgnum_dept_code \= b.gnum_dept_code AND a.gnum_hospital_code \= b.gnum_hospital_code AND TRUNC (SYSDATE) BETWEEN TRUNC (a.gdt_effective_frm) AND TRUNC (NVL (a.gdt_effective_to, SYSDATE)) AND TRUNC (SYSDATE) BETWEEN TRUNC (b.gdt_effective_frm) AND TRUNC (NVL (b.gdt_effective_to, SYSDATE)) AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND a.HGNUM_ISGENERAL\=? ORDER BY INITCAP (b.gstr_dept_name) || ' (' || INITCAP (a.hgstr_unitname) || ')' 
											

											
#Changed By Amit Garg as OPD G5 Changes
ESSENTIAL.ALL_UNIT_BY_TYPE_FOR_REFERAL.HGBT_UNIT_MST=SELECT   a.hgnum_deptunitcode, (SELECT INITCAP (gstr_dept_name) FROM gblt_department_mst WHERE gnum_dept_code \= a.gnum_dept_code  AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid IN (?, ?)) || ' (' || INITCAP (a.hgstr_unitname) || ')' AS NAME FROM hgbt_unit_mst a WHERE  a.gnum_hospital_code \= ? AND a.gnum_isvalid IN (?, ?)  AND a.hgnum_deptunitcode NOT IN ( SELECT hgnum_to_deptunitcode FROM hrgt_episode_ref_dtl WHERE hrgnum_puk \= ? AND gnum_isvalid \= ? AND gnum_hospital_code \=  a.GNUM_HOSPITAL_CODE AND TRUNC (gdt_entry_date) \= TRUNC (SYSDATE) AND hgnum_to_deptunitcode IS NOT NULL) ORDER BY NAME  
														
ESSENTIAL.ALL_DEPARTMENT_WITH_GENERAL_UNIT.GBLT_DEPARTMENT_MST=SELECT gnum_dept_code, gstr_dept_name FROM gblt_department_mst a WHERE gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND gnum_isvalid \= ? AND gnum_hospital_code \= ? AND gnum_dept_type \= ? AND EXISTS (SELECT hgnum_deptunitcode FROM hgbt_unit_mst WHERE hgnum_dept_code \= a.gnum_dept_code AND hgnum_isgeneral \= ? and gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code) ORDER BY gstr_dept_name

														

ESSENTIAL.ALL_DEPARTMENT_WITH_GENERAL_UNIT_FOR_REFERAL.GBLT_DEPARTMENT_MST=SELECT gnum_dept_code, gstr_dept_name FROM gblt_department_mst a WHERE gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND gnum_isvalid \= ? AND gnum_hospital_code \= ? AND gnum_dept_type \= ? AND EXISTS (SELECT hgnum_deptunitcode FROM hgbt_unit_mst WHERE hgnum_dept_code \= a.gnum_dept_code AND hgnum_isgeneral \= ? and gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code)  AND gnum_dept_code NOT IN ( SELECT hrgnum_to_dept_code FROM hrgt_episode_ref_dtl WHERE hrgnum_puk \= ? AND gnum_isvalid \= ? AND gnum_hospital_code \= a.gnum_hospital_code AND TRUNC (gdt_entry_date) \= TRUNC (SYSDATE) and hrgnum_to_dept_code is not null) ORDER BY gstr_dept_name

GET_MACRO_FOR_PATIENT_CONDITION.HGBT_MACRO_MST = SELECT HGSTR_MACRO_HEADER, HGSTR_MACRO_DESC FROM HGBT_MACRO_MST WHERE GNUM_HOSPITAL_CODE = ? AND HGNUM_PROCESS_ID = ? AND GNUM_ISVALID = ? ORDER BY HGSTR_MACRO_HEADER


SELECT.ALL_DEATH_MANNER.HGBT_DEATH_MANNER_MST = SELECT HGNUM_DEATH_MANNER_CODE as deathMannerCode, HGSTR_DEATH_MANNER_NAME as deathMannerName, HRGNUM_ISPOSTMORTEM_REQ as isPostMortemReq, HGNUM_ISACCIDENTAL as isAccidental FROM HGBT_DEATH_MANNER_MST WHERE GNUM_ISVALID \= ? AND GNUM_HOSPITAL_CODE \= ?


SELECT.ALL_INJURY_NATURE.HRGT_INJURY_NATURE_MST = SELECT HRGNUM_INJURY_NATURE_CODE, HRGSTR_INJURY_NATURE FROM HRGT_INJURY_NATURE_MST WHERE GNUM_ISVALID = ?  ORDER BY HRGSTR_INJURY_NATURE


#Changed By Amit Garg as OPD G5 Changes
SELECT.DEATH_MANNER_WITH_ACCIDENTAL_FLAG.HGBT_DEATH_MANNER_MST = SELECT HGNUM_DEATH_MANNER_CODE||'@'||HGNUM_ISACCIDENTAL, HGSTR_DEATH_MANNER_NAME as deathMannerName FROM HGBT_DEATH_MANNER_MST WHERE GNUM_ISVALID=?
																	

																	
UPDATE.PREVIOUS_ROW.HGBT_UNIT_CONSULTANT_MST = UPDATE HGBT_UNIT_CONSULTANT_MST b SET b.GNUM_ISVALID\= ? WHERE b.HGNUM_DEPTUNITCODE \= ?  AND b.GNUM_HOSPITAL_CODE \= ? AND b.HGNUM_SLNO\=(SELECT MAX(a.HGNUM_SLNO) FROM HGBT_UNIT_CONSULTANT_MST a WHERE a.HGNUM_DEPTUNITCODE\=b.HGNUM_DEPTUNITCODE  AND a.GNUM_HOSPITAL_CODE\=b.GNUM_HOSPITAL_CODE)\t\t\t


VER_DOC_BY_CAT_CODE.GBLT_VERIFICATION_DOCUMENT_MST = SELECT A.GNUM_DOCUMENT_CODE || '|' || A.GSTR_DOCUMENT_NAME, A.GSTR_DOCUMENT_NAME FROM GBLT_VERIFICATION_DOCUMENT_MST A WHERE A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_DOCUMENT_CODE IN (SELECT X.GNUM_DOCUMENT_CODE FROM GBLT_PATCAT_VERIFICATION_MST X WHERE X.GNUM_PATIENT_CAT_CODE \=? AND  X.GNUM_ISVALID \= A.GNUM_ISVALID AND X.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE)
								

SELECT.AGE_RANGE.HGBT_AGE_CLASSIFICATION_MST	=	select HGNUM_MIN||'-'||HGNUM_MAX,HGSTR_AGE_CLASSIFICATION from HGBT_AGE_CLASSIFICATION_MST where GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=? order by HGNUM_MIN 																
																	
																	


ESSENTIAL.UNITS_BASED_ON_WEEKDAY = SELECT DISTINCT(c.HGNUM_DEPTUNITCODE), c.HGNUM_DEPT_CODE deptCode,(SELECT INITCAP(b.GSTR_DEPT_NAME) FROM GBLT_DEPARTMENT_MST b WHERE c.HGNUM_DEPT_CODE=b.GNUM_DEPT_CODE AND a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE  AND a.GNUM_ISVALID=b.GNUM_ISVALID AND b.gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (b.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) ||'('||INITCAP(c.HGSTR_UNITNAME) ||')' unitName FROM HOPT_DEPT_UNIT_ROSTER_MST a,  HGBT_UNIT_MST c  WHERE c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE  AND a.HOPNUM_DAY_OF_WEEK=? AND a.GNUM_HOSPITAL_CODE=? AND a.GNUM_ISVALID=? AND a.GNUM_HOSPITAL_CODE=c.GNUM_HOSPITAL_CODE AND a.HOPNUM_WEEK_OF_MONTH=? AND a.GNUM_ISVALID=c.GNUM_ISVALID AND c.gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (c.gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) ORDER BY unitName

 
																 


ESSENTIAL.ROOM.HRGT_DEPT_UNIT_ROOM_MST=SELECT a.hgnum_room_code ||'\#'|| HRGNUM_SEQUENCE , hgstr_room_name FROM hrgt_dept_unit_room_mst a, hgbt_room_mst b WHERE hgnum_deptunitcode \= ? AND a.gnum_isvalid \= ? AND b.gnum_hospital_code \= ? AND b.hgnum_room_code \= a.hgnum_room_code AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_hospital_code \= a.gnum_hospital_code  order by hgstr_room_name
						 																												

SELECT.ACTIVE_DISASTER.HDST_DISASTER_DTL=SELECT hdsnum_disaster_id, initcap(hdsstr_disaster_name) FROM hdst_disaster_dtl WHERE gnum_hospital_code \= ? AND hdsnum_status \= ? AND gnum_isvalid \= ? order by initcap(hdsstr_disaster_name)

											
ESSENTIAL.CONSULTANT.HOU_1_2.HGBT_UNIT_CONSULTANT_MST= SELECT hgstr_emp_code AS empId,(SELECT    INITCAP (str_first_name) || ' ' || INITCAP (str_middle_name) || ' ' || INITCAP (str_last_name)  FROM pist_emp_personnel_dtl   WHERE str_emp_no \= a.hgstr_emp_code  AND gnum_isvalid \= a.gnum_isvalid  AND gnum_hospital_code \= a.gnum_hospital_code) AS empName FROM hgbt_unit_consultant_mst   a  WHERE hgnum_deptunitcode \=?    AND gnum_hospital_code \=?    AND gnum_isvalid \= ?    AND hgnum_is_hou IN (1, 0)  order by empName\t\t\t\t\t\t\t\t
											


#Changed By Amit Garg as OPD G5 Changes
SELECT_PRIMARY_CATEGORY.GBLT_PATIENT_CAT_MST=SELECT   gnum_patient_cat_code patientCategoryid,gstr_patient_cat_name patientCategoryName FROM gblt_patient_cat_mst    WHERE gnum_patient_cat_type \=? AND  gnum_hospital_code \= ?   AND (gnum_isvalid \= ? OR gnum_isvalid \= ?) ORDER BY patientCategoryName 


SELECT_CATEGORYWISE_MAPPED_VERIFICATION_DOC.GBLT_PATCAT_VERIFICATION_MST=SELECT gnum_document_code, gstr_document_name   FROM gblt_verification_document_mst a  WHERE gnum_isvalid \=?   AND gnum_hospital_code \=?    AND gnum_document_code  IN ( SELECT gnum_document_code  FROM gblt_patcat_verification_mst  WHERE gnum_patient_cat_code \= ?  AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE  AND gnum_isvalid \= a.GNUM_ISVALID) ORDER BY gstr_document_name             

             
SELECT_CATEGORYWISE_UNMAPPED_VERIFICATION_DOC.GBLT_PATCAT_VERIFICATION_MST=SELECT gnum_document_code, gstr_document_name   FROM gblt_verification_document_mst a  WHERE gnum_isvalid \=?   AND gnum_hospital_code \=?    AND gnum_document_code NOT  IN ( SELECT gnum_document_code  FROM gblt_patcat_verification_mst  WHERE gnum_patient_cat_code \= ?  AND gnum_hospital_code \=a.GNUM_HOSPITAL_CODE  AND gnum_isvalid \= a.GNUM_ISVALID)  ORDER BY gstr_document_name              
             							 
INSERT.GBLT_PATCAT_VERIFICATION_MST=insert into GBLT_PATCAT_VERIFICATION_MST(GNUM_PATIENT_CAT_CODE, GNUM_DOCUMENT_CODE, GNUM_HOSPITAL_CODE,GNUM_CAT_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE, GNUM_IS_REQ) values(?,?,?,(SELECT NVL (MAX (gnum_cat_slno), 0) + 1   FROM gblt_patcat_verification_mst  WHERE gnum_patient_cat_code \= ?    AND gnum_document_code \= ?    AND gnum_hospital_code \= ?),?,?,SYSDATE,?) 
							
							
UPDATE.GBLT_PATCAT_VERIFICATION_MST=UPDATE GBLT_PATCAT_VERIFICATION_MST SET GNUM_ISVALID=?, GDT_LSTMOD_DATE=SYSDATE, GNUM_LSTMOD_SEATID=? WHERE GNUM_PATIENT_CAT_CODE=? AND  GNUM_DOCUMENT_CODE=? AND  GNUM_HOSPITAL_CODE=? AND  GNUM_ISVALID=? 												 
							 
UPDATE.HGSTR_UNIT_DAYS.HGBT_UNIT_MST	=	update hgbt_unit_mst set HGSTR_UNIT_DAYS=ahis_reg.unit_room_time(gnum_hospital_code::character varying, '0'::character varying,'0'::character varying,'0'::character varying,HGNUM_DEPTUNITCODE::character varying) where GNUM_ISVALID=? and gnum_hospital_code=? and HGNUM_DEPTUNITCODE=?


ESSENTIAL.ROOM.DAY_WISE_CAPACITY.HRGT_DEPT_UNIT_ROOM_MST=SELECT a.hgnum_room_code||'\#'||HRGNUM_SEQUENCE, hgstr_room_name FROM hrgt_dept_unit_room_mst a, hgbt_room_mst b WHERE hgnum_deptunitcode \= ? AND a.gnum_isvalid \= ? AND b.gnum_hospital_code \= ? AND b.hgnum_room_code \= a.hgnum_room_code AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_hospital_code \= a.gnum_hospital_code   and a.HRGNUM_CAPACITY_MODE\=?  order by hgstr_room_name
											
ESSENTIAL.ROOM_ROSTER.HRGT_DEPT_UNIT_ROOM_MST=SELECT a.hgnum_room_code ||'\#'|| HRGNUM_SEQUENCE ||'\#'|| HRGNUM_CAPACITY, hgstr_room_name FROM hrgt_dept_unit_room_mst a, hgbt_room_mst b WHERE hgnum_deptunitcode \= ? AND a.gnum_isvalid \= ? AND b.gnum_hospital_code \= ? AND b.hgnum_room_code \= a.hgnum_room_code AND b.gnum_isvalid \= a.gnum_isvalid AND b.gnum_hospital_code \= a.gnum_hospital_code  order by hgstr_room_name

	
SELECT_ALL_COUNTER_NAME.GBLT_COUNTER_MST= SELECT GBLNUM_COUNTER_ID, INITCAP(GBLSTR_COUNTER_NAME)FROM GBLT_COUNTER_MST WHERE GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ?ORDER BY GBLSTR_COUNTER_NAME
										
SELECT.DEPT_NAME.GBLT_COUNTER_DEPT_MST = SELECT   a.gnum_dept_code,b.gstr_dept_name FROM gblt_counter_dept_mst a,gblt_department_mst b WHERE a.gblnum_counter_id \= ? AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? and a.gnum_dept_code \= b.gnum_dept_code AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_isvalid \= b.gnum_isvalid AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ORDER BY b.gstr_dept_name
										
SELECT.DEPT_NAME_NOT_ADDED.GBLT_COUNTER_DEPT_MST = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME  FROM GBLT_DEPARTMENT_MST a WHERE GNUM_HOSPITAL_CODE \= ?  AND GNUM_ISVALID \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)  and GNUM_DEPT_CODE not in (select GNUM_DEPT_CODE from GBLT_COUNTER_DEPT_MST where GBLNUM_COUNTER_ID\=? and  GNUM_HOSPITAL_CODE\=a.GNUM_HOSPITAL_CODE  and  GNUM_ISVALID\=a.GNUM_ISVALID)  ORDER BY GSTR_DEPT_NAME

INSERT.GBLT_COUNTER_DEPT_MST = 		insert into GBLT_COUNTER_DEPT_MST (GNUM_DEPT_CODE, GBLNUM_COUNTER_ID, GNUM_HOSPITAL_CODE, GNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,?,(select nvl(max(GNUM_SLNO),0)+1 from GBLT_COUNTER_DEPT_MST  where GNUM_DEPT_CODE=? and GBLNUM_COUNTER_ID=? and GNUM_HOSPITAL_CODE=?),?,?,sysdate)

UPDATE.GBLT_COUNTER_DEPT_MST =update GBLT_COUNTER_DEPT_MST set  GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? where GBLNUM_COUNTER_ID\=? and GNUM_DEPT_CODE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_SLNO\=(select max(GNUM_SLNO) from GBLT_COUNTER_DEPT_MST where GBLNUM_COUNTER_ID\=? and GNUM_DEPT_CODE\=? and GNUM_HOSPITAL_CODE\=?)
										
SELECT.UNIT_NAME.GBLT_COUNTER_UNIT_MST = SELECT   a.hgnum_deptunitcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) AND gnum_isvalid \= a.gnum_isvalid AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) || '(' || b.hgstr_unitname || ')' AS deptunitname FROM gblt_counter_unit_mst a, hgbt_unit_mst b  WHERE a.gblnum_counter_id \= ? AND a.gnum_hospital_code \= ? AND a.gnum_isvalid \= ? AND a.hgnum_deptunitcode \= b.hgnum_deptunitcode AND a.gnum_hospital_code \= b.gnum_hospital_code AND a.gnum_isvalid \= b.gnum_isvalid AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) ORDER BY deptunitname
	
SELECT.UNIT_NAME_NOT_ADDED.GBLT_COUNTER_UNIT_MST = SELECT   hgnum_deptunitcode,  (SELECT gstr_dept_name  FROM gblt_department_mst WHERE gnum_hospital_code \= a.gnum_hospital_code AND gnum_dept_code \= SUBSTR (a.hgnum_deptunitcode, 1, 3) AND gnum_isvalid \= a.gnum_isvalid AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) || '(' || a.hgstr_unitname || ')' AS deptunitname FROM hgbt_unit_mst a WHERE gnum_hospital_code \= ? AND gnum_isvalid \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) AND hgnum_deptunitcode NOT IN ( SELECT hgnum_deptunitcode FROM gblt_counter_unit_mst WHERE gblnum_counter_id \= ? AND gnum_hospital_code \= a.gnum_hospital_code AND gnum_isvalid \= a.gnum_isvalid) ORDER BY deptunitname

INSERT.GBLT_COUNTER_UNIT_MST = 		insert into GBLT_COUNTER_UNIT_MST (HGNUM_DEPTUNITCODE, GBLNUM_COUNTER_ID, GNUM_HOSPITAL_CODE, GNUM_SLNO, GNUM_ISVALID, GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,?,(select nvl(max(GNUM_SLNO),0)+1 from GBLT_COUNTER_UNIT_MST  where HGNUM_DEPTUNITCODE=? and GBLNUM_COUNTER_ID=? and GNUM_HOSPITAL_CODE=?),?,?,sysdate)

UPDATE.GBLT_COUNTER_UNIT_MST =update GBLT_COUNTER_UNIT_MST set  GNUM_ISVALID\=?, GDT_LSTMOD_DATE\=sysdate, GNUM_LSTMOD_SEATID\=? where GBLNUM_COUNTER_ID\=? and HGNUM_DEPTUNITCODE\=? and GNUM_HOSPITAL_CODE\=? and GNUM_SLNO\=(select max(GNUM_SLNO) from GBLT_COUNTER_UNIT_MST where GBLNUM_COUNTER_ID\=? and HGNUM_DEPTUNITCODE\=? and GNUM_HOSPITAL_CODE\=?)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t


SELECT_UNIT_DAYS_LIST.HOPT_DEPT_UNIT_ROSTER_MST=SELECT distinct a.hopnum_day_of_week AS dayofweek,DECODE (a.hopnum_day_of_week,1, 'Sun', 2, 'Mon', 3, 'Tue',4, 'Wed',5, 'Thu',6, 'Fri',7, 'Sat') ||'\#'|| (select HGSTR_INITIAL from  HGBT_CONSULTANT_INITIAL_MST where  hgnum_deptunitcode\=a.hgnum_deptunitcode AND gnum_isvalid\=a.gnum_isvalid and gnum_hospital_code\=a.gnum_hospital_code and hopnum_day_of_week\=a.hopnum_day_of_week) initials FROM hopt_dept_unit_roster_mst a  WHERE a.hgnum_deptunitcode \= ? AND a.gnum_isvalid \= ?  AND a.gnum_hospital_code \=? order by dayofweek  
						  					 																											
INSERT.HGBT_CONSULTANT_INITIAL_MST=INSERT into HGBT_CONSULTANT_INITIAL_MST (HGNUM_DEPTUNITCODE,HGSTR_INITIAL,HOPNUM_DAY_OF_WEEK,GNUM_ISVALID,GDT_ENTRY_DATE,GNUM_SEAT_ID,GNUM_HOSPITAL_CODE) values(?,UPPER(?),?,?,sysdate,?,?) 

UPDATE.HGBT_CONSULTANT_INITIAL_MST	=	update HGBT_CONSULTANT_INITIAL_MST set GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=?	where HGNUM_DEPTUNITCODE =? and  GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?
						  					 																											
SELECT.CONSULTANT_BY_UNIT.PIST_EMP_PERSONNEL_DTL	=SELECT (SELECT STR_FIRST_NAME || ' ' || STR_MIDDLE_NAME || ' ' || STR_LAST_NAME  FROM PIST_EMP_PERSONNEL_DTL WHERE STR_EMP_NO\=A.HGSTR_EMP_CODE) as consultant  FROM HGBT_UNIT_CONSULTANT_MST A WHERE HGNUM_DEPTUNITCODE \= ?  AND GNUM_ISVALID \= ?  AND GNUM_HOSPITAL_CODE \= ?\t order by consultant
   	
SELECT.FOR_FILE_NO_PRINTING.GBLT_DEPARTMENT_MST	=SELECT DISTINCT GNUM_DEPT_CODE,(SELECT B.GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST B WHERE B.GNUM_ISVALID \=  ?  AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND GDT_EFFECTIVE_FRM <\= TRUNC (SYSDATE) AND NVL (GDT_EFFECTIVE_TO, SYSDATE + 1) >\= TRUNC (SYSDATE) AND B.GNUM_DEPT_CODE \= SUBSTR (A.HOPNUM_DEPTUNITCODE, 1, 3)) DEPTNAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A WHERE A.HOPDT_START_DT <\= SYSDATE AND A.HOPDT_END_DT >\= SYSDATE AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ?   AND A.GNUM_DEPT_CODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P,GBLT_METATABLE_COLUMN_MST Q       WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID AND GSTR_TABLE_NAME \= 'GBLT_DEPARTMENT_MST' AND GSTR_COLUMN_NAME \= 'GNUM_DEPT_CODE' AND P.GNUM_SEATID \= PKG_USERMGMT.FUN_GETSEATID (?, ?)  AND P.GNUM_HOSPITAL_CODE \= Q.GNUM_HOSPITAL_CODE AND P.GNUM_HOSPITAL_CODE \= ?)  ORDER BY DEPTNAME\t\t\t

SELECT.FOR_FILE_NO_PRINTING.HGBT_UNIT_MST	=SELECT DISTINCT A.HOPNUM_DEPTUNITCODE, (SELECT B.HGSTR_UNITNAME FROM HGBT_UNIT_MST B  WHERE B.GNUM_ISVALID \= ? AND SYSDATE BETWEEN GDT_EFFECTIVE_FRM AND NVL (GDT_EFFECTIVE_TO, SYSDATE) AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND B.HGNUM_DEPTUNITCODE \= A.HOPNUM_DEPTUNITCODE)  UNITNAME FROM HOPT_DEPT_UNIT_ROSTER_DTL A WHERE A.HOPDT_START_DT <\= SYSDATE AND A.HOPDT_END_DT >\= SYSDATE AND A.GNUM_ISVALID \= ? AND A.GNUM_HOSPITAL_CODE \= ? AND A.GNUM_DEPT_CODE\=? AND A.HOPNUM_DEPTUNITCODE IN (SELECT GNUM_COLUMN_VALUE FROM GBLT_ROLE_SEAT_TABLE_DTL P, GBLT_METATABLE_COLUMN_MST Q WHERE P.GNUM_METATABLE_ID \= Q.GNUM_METATABLE_ID  AND GSTR_TABLE_NAME \= 'HGBT_UNIT_MST' AND GSTR_COLUMN_NAME \= 'HGNUM_DEPTUNITCODE' AND P.GNUM_SEATID \= PKG_USERMGMT.FUN_GETSEATID (?, ?) AND P.GNUM_HOSPITAL_CODE \= Q.GNUM_HOSPITAL_CODE AND P.GNUM_HOSPITAL_CODE \= ?) ORDER BY unitname 

ESSENTIAL.SELECT_ALL_USER.GBLT_USER_MST	=	SELECT  DISTINCT GNUM_USERID, INITCAP(GSTR_USR_NAME||' ('||GSTR_USER_NAME||')') USERNAME FROM GBLT_USER_MST WHERE GNUM_HOSPITAL_CODE =? AND GNUM_ISVALID=? ORDER BY USERNAME

ESSENTIAL.SELECT_TODAY_WORKING_ROOM.HRGT_DEPT_UNIT_ROOM_MST	=SELECT A.HGNUM_ROOM_CODE, HGSTR_ROOM_NAME FROM HRGT_DEPT_UNIT_ROOM_MST A, HGBT_ROOM_MST B WHERE HGNUM_DEPTUNITCODE \= ? AND A.GNUM_ISVALID \= ?  AND B.GNUM_HOSPITAL_CODE \= ?  AND B.HGNUM_ROOM_CODE \= A.HGNUM_ROOM_CODE AND B.GNUM_ISVALID \= A.GNUM_ISVALID AND B.GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE  AND  A.HGNUM_ROOM_CODE IN (SELECT HGNUM_ROOM_CODE FROM HOPT_DEPT_UNIT_ROSTER_DTL WHERE HOPNUM_DEPTUNITCODE\= A.HGNUM_DEPTUNITCODE AND  GNUM_HOSPITAL_CODE \= A.GNUM_HOSPITAL_CODE AND HOPDT_START_DT <\= SYSDATE  AND HOPDT_END_DT>\=SYSDATE ) ORDER BY HGSTR_ROOM_NAME
     												

SELECT.FOR_FILE_GEN.HGBT_UNIT_MST	=SELECT DISTINCT hgnum_dept_code departmentCode, hgstr_file_prefix filePrefix, hgnum_file_starts_from startNo,HGNUM_ISFILEREQUIRED fileNoRequired FROM hgbt_unit_mst WHERE HGNUM_DEPT_CODE LIKE ? AND HGNUM_DEPTUNITCODE LIKE ? AND hgnum_isfilerequired \= ? and GNUM_ISVALID\= ? and GNUM_HOSPITAL_CODE\=? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and hgnum_file_deptcode like ? and hgnum_file_deptunitcode like ?

SELECT.WHOSE_FILE_REQUIRED.GBLT_DEPARTMENT_MST	=select GNUM_DEPT_CODE, GSTR_DEPT_NAME from gblt_department_mst a WHERE gnum_isvalid \= ? AND gnum_hospital_code \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE) and  GNUM_DEPT_CODE in (SELECT DISTINCT hgnum_dept_code FROM hgbt_unit_mst WHERE hgnum_isfilerequired \= ? AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) order by GSTR_DEPT_NAME\t\t\t\t\t\t\t\t\t\t
SELECT.WHOSE_FILE_REQUIRED.HGBT_UNIT_MST	=SELECT DISTINCT HGNUM_DEPTUNITCODE,(select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE\=a.HGNUM_DEPT_CODE AND gnum_isvalid \= a.gnum_isvalid AND gnum_hospital_code \= a.gnum_hospital_code AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)) ||' ('||hgstr_unitname ||')' name  FROM hgbt_unit_mst a WHERE hgnum_isfilerequired \= ?  AND gnum_isvalid \= ? AND gnum_hospital_code \= ? AND gdt_effective_frm <\= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >\= TRUNC (SYSDATE)\torder by NAME
            									
										     												 														   					  							 																											
SELECT.GLOBAL_DEPARTMENT.GBLT_DEPARTMENT_MST	=select GNUM_DEPT_CODE departmentCode,GSTR_DEPT_NAME department,GSTR_DEPT_SHORT deptShortName,GNUM_DEPT_TYPE departmentType from gblt_department_mst where GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE \=? AND gnum_dept_code NOT IN (SELECT gdms.gnum_dept_code FROM gblt_department_mst gdms WHERE gdms.gnum_dept_code \= gnum_dept_code AND gdms.gnum_hospital_code \= ? AND gdms.gnum_isvalid in (?,?)) order by GSTR_DEPT_NAME

SELECT.GLOBAL_DEPARTMENT_DETAIL.GBLT_DEPARTMENT_MST	=select GNUM_DEPT_CODE departmentCode,GSTR_DEPT_NAME department,GSTR_DEPT_SHORT deptShortName,GNUM_DEPT_TYPE departmentType from gblt_department_mst where GNUM_DEPT_CODE\=? and GNUM_ISVALID\=? and GNUM_HOSPITAL_CODE \=? 
													
																										
ESSENTIAL.ALL_HOSPTIAL.GBLT_HOSPITAL_MST = SELECT gnum_hospital_code, gstr_hospital_name  FROM GBLT_HOSPITAL_MST  WHERE gnum_isvalid = ? order by gstr_hospital_name

#Changed By Amit Garg as OPD G5 Changes
ESSENTIAL.ALL_HOSPTIAL_SEAT_WISE.GBLT_HOSPITAL_MST = SELECT  distinct gnum_hospital_code, gstr_hospital_name AS orderbyname  FROM gblt_hospital_mst WHERE (gnum_hospital_code\=? or gnum_hospital_code IN ( SELECT gnum_column_value  FROM gblt_role_seat_table_dtl p, gblt_metatable_column_mst q WHERE p.gnum_metatable_id \= q.gnum_metatable_id AND q.gstr_table_name \= 'GBLT_HOSPITAL_MST' AND p.gstr_column_name \= 'GNUM_HOSPITAL_CODE' AND p.gnum_seatid \= pkg_usermgmt.fun_getseatid (?, ?)  AND p.gnum_hospital_code \= ? AND p.gbl_isvalid \= ?  )) and GNUM_ISVALID\=1 ORDER BY orderbyname\t\t\t\t\t\t\t\t\t\t\t\t\t

#Start:Sheeldarshi:05-Nov-14:Enquiry changes		
#ESSENTIAL.ALL_GLOBAL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE , GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GDT_EFFECTIVE_FRM<\=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>\=trunc(sysdate) and GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE\=? ORDER BY GSTR_DEPT_NAME
ESSENTIAL.ALL_GLOBAL_DEPT.GBLT_DEPARTMENT_MST=SELECT GNUM_DEPT_CODE , GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE   GNUM_ISVALID\=? AND GNUM_HOSPITAL_CODE \= ? AND GNUM_DEPT_TYPE\=? ORDER BY GSTR_DEPT_NAME
#End:Sheeldarshi:05-Nov-14:Enquiry changes

SELECT.EMPLOYEEMASTERDETAIL.PIST_EMP_ENTRY_DTL=SELECT STR_EMP_NO as empNo, gnum_salutation_id as salutationId,STR_FIRST_NAME as firstName,STR_MIDDLE_NAME as middleName,STR_LAST_NAME as lastName,NUM_GENDER_CODE as genderCode,DT_BIRTH_DATE as birthDate,NUM_COUNTRY_ID as countryCode,NUM_DESIG_ID as designationCode,NUM_DEPT_ID as deptCode,HRGSTR_CONTACT_NO as contactNo FROM PIST_EMP_ENTRY_DTL WHERE STR_EMP_NO=? and GNUM_HOSPITAL_CODE=?
# Added by Anant Patel on 12th Jan 2015 for Retreiving mlc type in Patient Death Detail Process
SELECT.ALL_MLC_TYPES.HRGT_MLC_CASE_TYPE_MST	=SELECT hrgnum_mlc_case_type_code, INITCAP(hrgstr_mlc_case_type) FROM HRGT_MLC_CASE_TYPE_MST WHERE GNUM_ISVALID\=? order by INITCAP(hrgstr_mlc_case_type)
