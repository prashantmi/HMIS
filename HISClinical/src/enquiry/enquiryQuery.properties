SEARCH_PATIENT_BY_PATIENT_ADREESS_DEPARTMENT1=	SELECT distinct a.hrgnum_puk, TO_CHAR (c.hrgdt_episode_date, 'dd-Mon-yyyy') AS hrgdt_episode_date, initcap(a.hrgstr_fname) as hrgstr_fname, initcap(a.hrgstr_mname) as hrgstr_mname, initcap(a.hrgstr_lname) as hrgstr_lname, ahis_util.dob_age_on(a.hrgdt_dob,sysdate) hrgstr_age, a.hrgdt_dob, DECODE (a.hgnum_pat_status_code, 11, 'Admitted', 12, 'Not Admitted', 13, 'Dead', 14, 'Not Dead' ) AS hgnum_pat_status_code, \
												a.hrgnum_is_imageuploaded, a.gnum_gender_code, (SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code = a.gnum_gender_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_gender_name, initcap(a.hrgstr_father_name) as hrgstr_fhname, initcap(a.hrgstr_spousename) as hrgstr_spousename, b.hrgstr_house_no, b.hrgstr_street_no, \
												b.hrgstr_city_location  AS hrgstr_city_location, b.hrgstr_city, b.hrgstr_district, \
												DECODE (NVL (LENGTH (b.gnum_state_code), 0), 0, b.hrgstr_state_name, (SELECT gstr_statename FROM gblt_state_mst WHERE gnum_statecode = b.gnum_state_code AND gnum_hospital_code = ? and GNUM_ISVALID=1)) AS hrgstr_state_name, b.gnum_country_code, (SELECT gstr_countryname FROM gblt_country_mst \
												WHERE gnum_countrycode = b.gnum_country_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_countryname, b.hrgnum_pincode, b.hrgnum_s_no, c.hrgnum_episode_code, c.hrgnum_visit_no, c.gnum_dept_code, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = c.gnum_dept_code \
												AND gnum_hospital_code = ? and GNUM_ISVALID=1 AND GDT_EFFECTIVE_FRM <= SYSDATE AND (TRUNC (NVL (GDT_EFFECTIVE_TO, SYSDATE)) >= TRUNC (SYSDATE) \
       											)) AS gstr_dept_name,(SELECT hrgstr_path || '/' || hrgstr_fileno FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
												and HRGNUM_IS_DEFAULT=1) patientImage,gstr_tehsil FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b, hrgt_episode_dtl c WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND a.gnum_hospital_code = b.gnum_hospital_code (+) AND a.hrgnum_puk = c.hrgnum_puk AND NVL (b.gnum_add_type_code, 1) = 1 AND c.hrgnum_visit_no = (SELECT MAX (hrgnum_visit_no) \
												FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = c.hrgnum_episode_code AND gnum_hospital_code = ? and gnum_isvalid=?) AND C.hrgnum_episode_code= (SELECT MAX (hrgnum_episode_code) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = ? AND \
												gnum_dept_code = c.gnum_dept_code) AND c.gnum_hospital_code = ? and a.gnum_isvalid=? and a.gnum_isvalid=b.gnum_isvalid (+)  and c.gnum_isvalid=a.gnum_isvalid
#Start:Sheeldarshi:07-Nov-2014:Enquiry Changes
#SEARCH_PATIENT_BY_PATIENT_ADREESS_DEPARTMENT=	SELECT distinct a.hrgnum_puk, TO_CHAR (c.hrgdt_episode_date, 'dd-Mon-yyyy') AS hrgdt_episode_date, initcap(a.hrgstr_fname) as hrgstr_fname, initcap(a.hrgstr_mname) as hrgstr_mname, initcap(a.hrgstr_lname) as hrgstr_lname, ahis_util.dob_age_on(a.hrgdt_dob,sysdate) hrgstr_age, a.hrgdt_dob, DECODE (a.hgnum_pat_status_code, 11, 'Admitted', 12, 'Not Admitted', 13, 'Dead', 14, 'Not Dead' ) AS hgnum_pat_status_code, \											a.hrgnum_is_imageuploaded, a.gnum_gender_code, (SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code = a.gnum_gender_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_gender_name, initcap(a.hrgstr_father_name) as hrgstr_fhname, initcap(a.hrgstr_spousename) as hrgstr_spousename, b.hrgstr_house_no, b.hrgstr_street_no, \												b.hrgstr_city_location  AS hrgstr_city_location, b.hrgstr_city, (SELECT str_dist_name FROM gblt_district_mst WHERE num_dist_id =b.num_dist_id AND gnum_hospital_code = 100 AND gnum_isvalid = 1) AS hrgstr_district, \												DECODE (NVL (LENGTH (b.gnum_state_code), 0), 0, b.hrgstr_state_name, (SELECT gstr_statename FROM gblt_state_mst WHERE gnum_statecode = b.gnum_state_code AND gnum_hospital_code = ? and GNUM_ISVALID=1)) AS hrgstr_state_name, b.gnum_country_code, (SELECT gstr_countryname FROM gblt_country_mst \												WHERE gnum_countrycode = b.gnum_country_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_countryname, b.hrgnum_pincode, b.hrgnum_s_no, c.hrgnum_episode_code, c.hrgnum_visit_no, c.gnum_dept_code, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = c.gnum_dept_code \												AND gnum_hospital_code =  c.gnum_hospital_code and GNUM_ISVALID=1 AND GDT_EFFECTIVE_FRM <= SYSDATE AND (TO_DATE (NVL (GDT_EFFECTIVE_TO, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY') \       											)) AS gstr_dept_name,(SELECT hrgstr_path || '/' || hrgstr_fileno FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \												and HRGNUM_IS_DEFAULT=1) patientImage,gstr_tehsil,initcap(pkg_clinical_gbl_fun.GETHOSPITALNAME(c.gnum_hospital_code::character varying)) gstr_hospital_name FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b, hrgt_episode_dtl c WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND a.hrgnum_puk = c.hrgnum_puk AND NVL (b.gnum_add_type_code, 1) = 1 AND c.hrgnum_visit_no = (SELECT MAX (hrgnum_visit_no) \												FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = c.hrgnum_episode_code AND gnum_hospital_code = c.gnum_hospital_code and gnum_isvalid=?) AND C.hrgnum_episode_code= (SELECT MAX (hrgnum_episode_code) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = c.gnum_hospital_code AND \											gnum_dept_code = c.gnum_dept_code) AND c.gnum_hospital_code like ? and a.gnum_isvalid=? and a.gnum_isvalid=b.gnum_isvalid (+)  and c.gnum_isvalid=a.gnum_isvalid 
							
SEARCH_PATIENT_BY_PATIENT_ADREESS_DEPARTMENT=	SELECT distinct a.hrgnum_puk, TO_CHAR (c.hrgdt_episode_start_date, 'dd-Mon-yyyy') AS hrgdt_episode_date, initcap(a.hrgstr_fname) as hrgstr_fname, initcap(a.hrgstr_mname) as hrgstr_mname, initcap(a.hrgstr_lname) as hrgstr_lname, ahis_util.dob_age_on(a.hrgdt_dob,sysdate) hrgstr_age, a.hrgdt_dob, DECODE (a.hgnum_pat_status_code, 11, 'Admitted', 12, 'Not Admitted', 13, 'Dead', 14, 'Not Dead' ) AS hgnum_pat_status_code, \
												a.hrgnum_is_imageuploaded, a.gstr_gender_code, (SELECT GSTR_GENDER_NAME FROM gblt_gender_mst WHERE gstr_gender_code = a.gstr_gender_code and GNUM_ISVALID=1) AS gstr_gender_name, initcap(a.hrgstr_father_name) as hrgstr_fhname, initcap(a.hrgstr_spousename) as hrgstr_spousename, b.hrgstr_address_line1, b.hrgstr_sub_locality1, \
												b.hrgstr_city_location  AS hrgstr_city_location, b.hrgstr_city, (SELECT gstr_district_name FROM gblt_district_mst WHERE gnum_district_code =b.gnum_district_code AND gnum_isvalid = 1) AS hrgstr_district, \
												DECODE (NVL (LENGTH (b.gnum_state_code), 0), 0, b.hrgstr_state_name, (SELECT gstr_state_name FROM gblt_state_mst WHERE gnum_state_code = b.gnum_state_code AND GNUM_ISVALID=1)) AS hrgstr_state_name, b.gstr_country_code, (SELECT gstr_country_name FROM gblt_country_mst \
												WHERE gstr_country_code = b.gstr_country_code and GNUM_ISVALID=1) AS gstr_countryname, b.hrgnum_pincode,  c.hrgnum_episode_code, c.hrgnum_visit_no, c.gnum_dept_code, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = c.gnum_dept_code \
												AND gnum_hospital_code =  c.gnum_hospital_code and GNUM_ISVALID=1 ) AS gstr_dept_name,(SELECT gst_file_name FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
												and HRGNUM_IS_DEFAULT=1) patientImage,initcap(pkg_clinical_gbl_fun.GETHOSPITALNAME(c.gnum_hospital_code::character varying)) gstr_hospital_name FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b, hrgt_episode_dtl c WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND a.hrgnum_puk = c.hrgnum_puk AND NVL (b.gnum_add_type_code, 1) = 1 AND c.hrgnum_visit_no = (SELECT MAX (hrgnum_visit_no) \
												FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND hrgnum_episode_code = c.hrgnum_episode_code AND gnum_hospital_code = c.gnum_hospital_code and gnum_isvalid=?) AND C.hrgnum_episode_code= (SELECT MAX (hrgnum_episode_code) FROM hrgt_episode_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_hospital_code = c.gnum_hospital_code AND \
												gnum_dept_code = c.gnum_dept_code) AND c.gnum_hospital_code like ? and a.gnum_isvalid=? and a.gnum_isvalid=b.gnum_isvalid (+)  and c.gnum_isvalid=a.gnum_isvalid

																								 
#SEARCH_INPATIENT_BY_PATIENT_ADREESS_DEPARTMENT=	SELECT distinct a.hrgnum_puk, initcap(a.hrgstr_fname) as hrgstr_fname, initcap(a.hrgstr_mname) as hrgstr_mname, initcap(a.hrgstr_lname) as hrgstr_lname, ahis_util.dob_age_on(a.hrgdt_dob,sysdate) hrgstr_age, a.hrgdt_dob, DECODE (a.hgnum_pat_status_code, 11, 'Admitted', 12, 'Not Admitted', 13, 'Dead', 14, 'Not Dead' ) AS hgnum_pat_status_code, \											a.hrgnum_is_imageuploaded, a.gnum_gender_code, (SELECT GSTR_GENDER_SHORT FROM gblt_gender_mst WHERE gnum_gender_code = a.gnum_gender_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_gender_name, initcap(a.hrgstr_father_name) as hrgstr_fhname, initcap(a.hrgstr_spousename) as hrgstr_spousename, b.hrgstr_house_no, b.hrgstr_street_no, \												b.hrgstr_city_location  AS hrgstr_city_location, b.hrgstr_city, b.hrgstr_district, \												DECODE (NVL (LENGTH (b.gnum_state_code), 0), 0, b.hrgstr_state_name, (SELECT gstr_statename FROM gblt_state_mst WHERE gnum_statecode = b.gnum_state_code AND gnum_hospital_code = ? and GNUM_ISVALID=1)) AS hrgstr_state_name, b.gnum_country_code, (SELECT gstr_countryname FROM gblt_country_mst \												WHERE gnum_countrycode = b.gnum_country_code AND gnum_hospital_code = ? and GNUM_ISVALID=1) AS gstr_countryname, b.hrgnum_pincode, b.hrgnum_s_no, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = ? \												AND gnum_hospital_code = c.gnum_hospital_code and GNUM_ISVALID=1 AND GDT_EFFECTIVE_FRM <= SYSDATE AND (TO_DATE (NVL (GDT_EFFECTIVE_TO, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY') \       											)) AS gstr_dept_name,(SELECT hrgstr_path || '/' || hrgstr_fileno FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \												and HRGNUM_IS_DEFAULT=1) patientImage,gstr_tehsil,c.gnum_hospital_code,initcap(pkg_clinical_gbl_fun.GETHOSPITALNAME(c.gnum_hospital_code::character varying)) gstr_hospital_name FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b,hipt_patadmission_dtl c WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND b.hrgnum_puk = c.hrgnum_puk AND NVL (b.gnum_add_type_code, 1) = 1 \												AND c.gnum_hospital_code like ? AND a.gnum_isvalid=? and a.gnum_isvalid=b.gnum_isvalid (+)

SEARCH_INPATIENT_BY_PATIENT_ADREESS_DEPARTMENT=	SELECT distinct a.hrgnum_puk, initcap(a.hrgstr_fname) as hrgstr_fname, initcap(a.hrgstr_mname) as hrgstr_mname, initcap(a.hrgstr_lname) as hrgstr_lname, ahis_util.dob_age_on(a.hrgdt_dob,sysdate) hrgstr_age, a.hrgdt_dob, DECODE (a.hgnum_pat_status_code, 11, 'Admitted', 12, 'Not Admitted', 13, 'Dead', 14, 'Not Dead' ) AS hgnum_pat_status_code, \
												a.hrgnum_is_imageuploaded, a.gstr_gender_code, (SELECT GSTR_GENDER_NAME FROM gblt_gender_mst WHERE gstr_gender_code = a.gstr_gender_code  and GNUM_ISVALID=1) AS gstr_gender_name, initcap(a.hrgstr_father_name) as hrgstr_fhname, initcap(a.hrgstr_spousename) as hrgstr_spousename, b.hrgstr_address_line1, b.hrgstr_sub_locality1, \
												b.hrgstr_city_location  AS hrgstr_city_location, b.hrgstr_city, b.hrgstr_district, \
												DECODE (NVL (LENGTH (b.gnum_state_code), 0), 0, b.hrgstr_state_name, (SELECT gstr_state_name FROM gblt_state_mst WHERE gnum_state_code = b.gnum_state_code and GNUM_ISVALID=1)) AS hrgstr_state_name, b.gstr_country_code, (SELECT gstr_country_name FROM gblt_country_mst \
												WHERE gstr_country_code = b.gstr_country_code and GNUM_ISVALID=1) AS gstr_country_name, b.hrgnum_pincode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = ? \
												AND gnum_hospital_code = c.gnum_hospital_code and GNUM_ISVALID=1    \
       											) AS gstr_dept_name,(SELECT gst_file_name FROM hrgt_patient_image_dtl WHERE hrgnum_puk = a.hrgnum_puk AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
												and HRGNUM_IS_DEFAULT=1) patientImage,c.gnum_hospital_code,initcap(pkg_clinical_gbl_fun.GETHOSPITALNAME(c.gnum_hospital_code::character varying)) gstr_hospital_name FROM hrgt_patient_dtl a, hrgt_patient_add_dtl b,hipt_patadmission_dtl c WHERE a.hrgnum_puk = b.hrgnum_puk(+) AND b.hrgnum_puk = c.hrgnum_puk AND NVL (b.gnum_add_type_code, 1) = 1 \
												AND c.gnum_hospital_code like ? AND a.gnum_isvalid=? and a.gnum_isvalid=b.gnum_isvalid (+)												

#End:Sheeldarshi:07-Nov-2014:Enquiry Changes												
 
SEARCH_OPD_RELATED_DETAIL_11Apr_09=select (select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=substr(a.HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE =?) as gstr_dept_name, \
						  a.HGNUM_DEPTUNITCODE,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE \
						  and GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate) and GNUM_HOSPITAL_CODE =?) as HGSTR_UNITNAME, \
						  b.HOPNUM_DAY_OF_WEEK,b.hopnum_week_of_month, b.HGNUM_SHIFT_CODE,(select HOPSTR_START_TIME from GBLT_SHIFT_MST where \
						  HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =?)as HOPSTR_START_TIME,(select HOPSTR_END_TIME from GBLT_SHIFT_MST \
						  where HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =?)as HOPSTR_END_TIME,c.HGNUM_ROOM_CODE ,(select HGSTR_ROOM_NAME from \
						  HGBT_ROOM_MST where HGNUM_ROOM_CODE=c.HGNUM_ROOM_CODE and GNUM_HOSPITAL_CODE =?)as HGSTR_ROOM_NAME, d.HGSTR_EMP_CODE,(select PSRSTR_FNAME \
						  ||' ' || PSRSTR_MNAME || ' ' || PSRSTR_LNAME from PSRT_EMPLOYEE_MST where PSRSTR_EMP_NO=d.hgstr_emp_code) as employeeName, \
						  d.HGNUM_IS_HOU from HGBT_UNIT_MST a,HOPT_DEPT_UNIT_ROSTER_MST b , HRGT_DEPT_UNIT_ROOM_MST c, HGBT_UNIT_CONSULTANT_MST d \
						  where   (b.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and (c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) \
						  and (d.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and  HGNUM_IS_HOU=? and a.gnum_isvalid=? \
						  and c.GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(c.GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate)  \
						  and a.GNUM_HOSPITAL_CODE =? and b.GNUM_HOSPITAL_CODE =? and c.GNUM_HOSPITAL_CODE =? and d.GNUM_HOSPITAL_CODE =?

SEARCH_OPD_RELATED_DETAIL_OLD=select distinct (select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=substr(a.HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as gstr_dept_name, \
						  a.HGNUM_DEPTUNITCODE,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE \
						  and GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as HGSTR_UNITNAME, \
						  b.HOPNUM_DAY_OF_WEEK,b.hopnum_week_of_month, b.HGNUM_SHIFT_CODE,(select HOPSTR_START_TIME from GBLT_SHIFT_MST where \
						  HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_START_TIME,(select HOPSTR_END_TIME from GBLT_SHIFT_MST \
						  where HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_END_TIME,c.HGNUM_ROOM_CODE ,(select HGSTR_ROOM_NAME from \
						  HGBT_ROOM_MST where HGNUM_ROOM_CODE=c.HGNUM_ROOM_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HGSTR_ROOM_NAME, d.HGSTR_EMP_CODE,(SELECT    STR_FIRST_NAME || ' '|| STR_MIDDLE_NAME|| ' '|| STR_LAST_NAME FROM pist_emp_personnel_dtl \
           				  WHERE STR_EMP_NO = d.hgstr_emp_code) as employeeName, \
						  d.HGNUM_IS_HOU from HGBT_UNIT_MST a,HOPT_DEPT_UNIT_ROSTER_MST b , HRGT_DEPT_UNIT_ROOM_MST c, HGBT_UNIT_CONSULTANT_MST d \
						  where   (b.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and (c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) \
						  and (d.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and  HGNUM_IS_HOU=? and a.gnum_isvalid=? \
						  and c.GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(c.GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate)  \
						  and a.GNUM_HOSPITAL_CODE =? and b.GNUM_HOSPITAL_CODE =? and c.GNUM_HOSPITAL_CODE =? and d.GNUM_HOSPITAL_CODE =? and hopnum_week_of_month=1

#Start:Sheeldarshi:07-Nov-2014:Enquiry Changes

#SEARCH_OPD_RELATED_DETAIL=select distinct (select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=substr(a.HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as gstr_dept_name, \						  a.HGNUM_DEPTUNITCODE,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE \						  and GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as HGSTR_UNITNAME, \						  b.HOPNUM_DAY_OF_WEEK,b.hopnum_week_of_month, b.HGNUM_SHIFT_CODE,(select HOPSTR_START_TIME from GBLT_SHIFT_MST where \						  HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_START_TIME,(select HOPSTR_END_TIME from GBLT_SHIFT_MST \						  where HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_END_TIME,c.HGNUM_ROOM_CODE ,(select HGSTR_ROOM_NAME from \						  HGBT_ROOM_MST where HGNUM_ROOM_CODE=c.HGNUM_ROOM_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HGSTR_ROOM_NAME, d.HGSTR_EMP_CODE,(SELECT    STR_FIRST_NAME || ' '|| STR_MIDDLE_NAME|| ' '|| STR_LAST_NAME FROM pist_emp_entry_dtl \           				  WHERE STR_EMP_NO = d.hgstr_emp_code and GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE) as employeeName, \						  d.HGNUM_IS_HOU from HGBT_UNIT_MST a,HOPT_DEPT_UNIT_ROSTER_MST b , HRGT_DEPT_UNIT_ROOM_MST c, HGBT_UNIT_CONSULTANT_MST d \						  where   (b.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and (c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) \						  and (d.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and  HGNUM_IS_HOU=? and a.gnum_isvalid=? \						  and c.GDT_EFFECTIVE_FRM<=trunc(sysdate) and nvl(c.GDT_EFFECTIVE_TO,sysdate+1)>=trunc(sysdate)  \						  and a.GNUM_HOSPITAL_CODE =? and b.GNUM_HOSPITAL_CODE =? and c.GNUM_HOSPITAL_CODE =? and d.GNUM_HOSPITAL_CODE =? and hopnum_week_of_month=1

#Employee detail come from PIST_EMP_ENTRY_DTL
SEARCH_OPD_RELATED_DETAIL_1=select distinct (select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=substr(a.HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as gstr_dept_name, \
						  a.HGNUM_DEPTUNITCODE,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE \
						  and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as HGSTR_UNITNAME, \
						  b.HOPNUM_DAY_OF_WEEK,b.hopnum_week_of_month, b.HGNUM_SHIFT_CODE,(select HOPSTR_START_TIME from GBLT_SHIFT_MST where \
						  HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_START_TIME,(select HOPSTR_END_TIME from GBLT_SHIFT_MST \
						  where HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_END_TIME,c.HGNUM_ROOM_CODE ,(select HGSTR_ROOM_NAME from \
						  HGBT_ROOM_MST where HGNUM_ROOM_CODE=c.HGNUM_ROOM_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HGSTR_ROOM_NAME, d.HGSTR_EMP_CODE,(SELECT    STR_FIRST_NAME || ' '|| STR_MIDDLE_NAME|| ' '|| STR_LAST_NAME FROM pist_emp_entry_dtl \
           				  WHERE STR_EMP_NO = d.hgstr_emp_code and GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE) as employeeName, \
						  d.HGNUM_IS_HOU from HGBT_UNIT_MST a,HOPT_DEPT_UNIT_ROSTER_MST b , HRGT_DEPT_UNIT_ROOM_MST c, HGBT_UNIT_CONSULTANT_MST d \
						  where   (b.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and (c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) \
						  and (d.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and  HGNUM_IS_HOU=? and a.gnum_isvalid=? \
  						  and a.GNUM_HOSPITAL_CODE =? and b.GNUM_HOSPITAL_CODE =? and c.GNUM_HOSPITAL_CODE =? and d.GNUM_HOSPITAL_CODE =? and hopnum_week_of_month=1

#Employee detail come from PIST_EMP_REGISTRATION_DTL  						  
SEARCH_OPD_RELATED_DETAIL=select distinct (select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=substr(a.HGNUM_DEPTUNITCODE,1,3) and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as gstr_dept_name, \
						  a.HGNUM_DEPTUNITCODE,(select HGSTR_UNITNAME from HGBT_UNIT_MST where HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE \
						  and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1) as HGSTR_UNITNAME, \
						  b.HOPNUM_DAY_OF_WEEK,b.hopnum_week_of_month, b.HGNUM_SHIFT_CODE,(select HOPSTR_START_TIME from GBLT_SHIFT_MST where \
						  HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_START_TIME,(select HOPSTR_END_TIME from GBLT_SHIFT_MST \
						  where HGNUM_SHIFT_CODE=b.HGNUM_SHIFT_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HOPSTR_END_TIME,c.HGNUM_ROOM_CODE ,(select HGSTR_ROOM_NAME from \
						  HGBT_ROOM_MST where HGNUM_ROOM_CODE=c.HGNUM_ROOM_CODE and GNUM_HOSPITAL_CODE =? and GNUM_ISVALID=1)as HGSTR_ROOM_NAME, d.HGSTR_EMP_CODE,(SELECT    STR_EMP_FULL_NAME FROM pist_emp_registration_dtl \
           				  WHERE STR_EMP_NO = d.hgstr_emp_code and GNUM_HOSPITAL_CODE =a.GNUM_HOSPITAL_CODE) as employeeName, \
						  d.HGNUM_IS_HOU from HGBT_UNIT_MST a,HOPT_DEPT_UNIT_ROSTER_MST b , HRGT_DEPT_UNIT_ROOM_MST c, HGBT_UNIT_CONSULTANT_MST d \
						  where   (b.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and (c.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) \
						  and (d.HGNUM_DEPTUNITCODE=a.HGNUM_DEPTUNITCODE) and  HGNUM_IS_HOU=? and a.gnum_isvalid=? \
  						  and a.GNUM_HOSPITAL_CODE =? and b.GNUM_HOSPITAL_CODE =? and c.GNUM_HOSPITAL_CODE =? and d.GNUM_HOSPITAL_CODE =? and hopnum_week_of_month=1					    						  					  

#End:Sheeldarshi:07-Nov-2014:Enquiry Changes

ENQUIRY.OPD_DETAIL_BY_CRNO	=SELECT HRGNUM_PUK,(SELECT GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_DEPT_CODE = A.GNUM_DEPT_CODE AND GNUM_ISVALID = ? AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE \
          					AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=                                            TO_DATE (SYSDATE, 'DD-MM-YY') AND gnum_hospital_code = a.gnum_hospital_code )) gnum_dept_code, \
       						(SELECT DISTINCT HGSTR_UNITNAME FROM HGBT_UNIT_MST WHERE HGNUM_DEPTUNITCODE = A.HGNUM_DEPTUNITCODE AND GNUM_ISVALID = ? AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE \
				            AND(TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=                                         TO_DATE (SYSDATE, 'DD-MM-YY') AND gnum_hospital_code = a.gnum_hospital_code)) UNIT, \
      						TO_CHAR (HRGDT_EPISODE_DATE, 'dd-Mon-yyy') lastVisitDate,(SELECT HGSTR_ROOM_NAME FROM HGBT_ROOM_MST \
         					WHERE HGNUM_ROOM_CODE = A.HGNUM_ROOM_CODE AND GNUM_ISVALID = ? AND gnum_hospital_code = a.gnum_hospital_code) roomNo FROM HRGT_EPISODE_DTL A \
 							WHERE A.GNUM_ISVALID = ?   AND A.HRGNUM_PUK = ?   AND A.GNUM_HOSPITAL_CODE = ?  AND HRGNUM_VISIT_NO = (SELECT MAX (HRGNUM_VISIT_NO) \
 							FROM HRGT_EPISODE_DTL WHERE HRGNUM_PUK = ? AND GNUM_ISVALID=? \
 							AND hrgnum_episode_code = a.hrgnum_episode_code AND gnum_hospital_code = a.gnum_hospital_code)


ENQUIRY.IPD_DETAIL_BY_CRNO	=SELECT a.hipnum_admno,TO_CHAR (a.hipdt_admdatetime, 'dd-Mon-yyyy') admdate,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code \
           					AND gnum_isvalid = ? AND gnum_hospital_code = a.gnum_hospital_code AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE)) \
                            dept,(SELECT DISTINCT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.gnum_deptunit_code AND gnum_isvalid = ? AND gnum_hospital_code = a.gnum_hospital_code \
                    		AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >=TRUNC (SYSDATE)) unit,(SELECT hipstr_ward_name FROM hipt_ward_mst WHERE hipnum_ward_code \
                    		= a.hipnum_ward_code AND gnum_isvalid = ?  AND gnum_hospital_code = a.gnum_hospital_code) ward,DECODE (a.hipdt_admstatus_code,12, 'Admitted',13, 'LAMA', \
               				14, 'Admission Cancelled',15, 'On leave',16, 'Discharged') status, TO_CHAR (b.hipdt_disdatetime, 'dd-Mon-yyyy') dischargedate, (SELECT hgnum_bed_name FROM hipt_ward_room_bed_mst \
         					WHERE hgnum_bed_code = a.hipnum_bed_code AND hipnum_room_no = a.hipnum_room_code AND hgnum_ward_code = a.hipnum_ward_code AND gnum_isvalid = ? AND gnum_hospital_code = a.gnum_hospital_code) bedno \
  							FROM hipt_patadmission_dtl a, hipt_patadmdisc_dtl b WHERE a.hipnum_admno = b.hipnum_admno AND a.hrgnum_puk = ? AND a.gnum_isvalid = ? and a.gnum_isvalid=b.gnum_isvalid AND a.gnum_hospital_code = ? \
   							and a.gnum_hospital_code=b.gnum_hospital_code


SEARCH_DEPARTMENT_LOCATION.HGBT_LOCATION_MST.LOCATION_MAPPING_NO=	SELECT INITCAP (hgstr_description) AS hgstr_description, \
												INITCAP (hgstr_floor) AS hgstr_floor, INITCAP (hgstr_building) \
												AS hgstr_building, INITCAP (hgstr_landmark) AS hgstr_landmark \
												FROM hgbt_location_mst a WHERE hgnum_location_code = (SELECT \
												gnum_location_code FROM gblt_department_mst WHERE gnum_dept_code = ? \
												AND gnum_hospital_code = ?) AND gnum_hospital_code = ?


SEARCH_DEPARTMENT_LOCATION.HGBT_LOCATION_MST.LOCATION_MAPPING_YES=SELECT INITCAP (hgstr_description) AS hgstr_description,\
				    (SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = a.gnum_hospital_code \
						 AND num_building_code = a.hgstr_building AND gdt_effective_frm <= SYSDATE  AND \
						 (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY'))  \
						  AND gnum_isvalid > 0) AS hgstr_building, \
					 (SELECT str_block_name  FROM est_block_mst WHERE num_hospital_code = a.gnum_hospital_code  AND num_block_id = a.hgstr_block \
						 AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY')) \
				          AND gnum_isvalid > 0) AS hgstr_block, \
				     (SELECT STR_FLOOR_NAME  from  est_floor_mst  WHERE num_hospital_code = a.gnum_hospital_code \
				          AND num_floor_id = a.hgstr_floor AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
			              AND gnum_isvalid > 0) AS hgstr_floor, \
			         (SELECT STR_ROOM_NAME from est_room_mst  WHERE num_hospital_code = a.gnum_hospital_code \
			              AND num_room_id = a.hgstr_room  AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY')) \
			              AND gnum_isvalid > 0) AS hgstr_room,HGSTR_LANDMARK as hgstr_landmark   FROM hgbt_location_mst a  \
			              WHERE hgnum_location_code = (SELECT gnum_location_code FROM gblt_department_mst a  \
			            WHERE a.gnum_dept_code =?  AND a.gnum_hospital_code =?  AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY') ) \
			              AND gnum_isvalid > 0)   AND gnum_hospital_code =?

											
SELECT_ALL_CONSULANT_DETAIL_OPD_ENQUIRY_11_Apr_09=	SELECT hgstr_emp_code, (SELECT    psrstr_fname  || ' ' || psrstr_mname || ' ' || psrstr_lname \
												FROM psrt_employee_mst WHERE psrstr_emp_no = a.hgstr_emp_code) AS employeename,HGNUM_IS_HOU \
			 									FROM hgbt_unit_consultant_mst a  WHERE hgnum_deptunitcode = ? AND gnum_hospital_code=?

SELECT_ALL_CONSULANT_DETAIL_OPD_ENQUIRY_BEFORE_MHMIS=	SELECT hgstr_emp_code,(SELECT  str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = a.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS employeename, \
											hgnum_is_hou,(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID and gnum_isvalid=b.gnum_isvalid and gnum_hospital_code=b.gnum_hospital_code) designation, \
											decode(hgnum_is_hou,1,'Yes','')hou FROM hgbt_unit_consultant_mst a,PIST_EMP_CUR_DETAIL_DTL b WHERE hgnum_deptunitcode = ? AND a.gnum_hospital_code = ? \
											and HGSTR_EMP_CODE=b.STR_EMP_NO and a.gnum_isvalid=b.gnum_isvalid and a.gnum_hospital_code=b.gnum_hospital_code  order by hgnum_is_hou desc ,HGNUM_HIERARCHY_LEVEL asc

#Start:Sheeldarshi:10-Nov-2014:Enquiry changes
#SELECT_ALL_CONSULANT_DETAIL_OPD_ENQUIRY=SELECT hgstr_emp_code,(SELECT  str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = a.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS employeename, \hgnum_is_hou,(select gstr_designation
 from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID and gnum_isvalid=b.gnum_isvalid and gnum_hospital_code=b.gnum_hospital_code) designation, \decode(hgnum_is_hou,1,'Yes','')hou FROM hgbt_unit_consultant_mst a,PIST_EMP_ENTRY_DTL b WHERE hgnum_deptunitcode = ? AND a.gnum_hospital_code = ? \and HGSTR_EMP_CODE=b.STR_EMP_NO and a.gnum_isvalid=b.gnum_isvalid and a.gnum_hospital_code=b.gnum_hospital_code  order by hgnum_is_hou desc ,HGNUM_HIERARCHY_LEVEL asc

#Employee detail come from pist_emp_entry_dtl

SELECT_ALL_CONSULANT_DETAIL_OPD_ENQUIRY_1=SELECT hgstr_emp_code,(SELECT  str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = a.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS employeename, \
hgnum_is_hou,(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID and gnum_isvalid=b.gnum_isvalid and gnum_hospital_code=b.gnum_hospital_code) designation, \
decode(hgnum_is_hou,1,'Yes','No')hou FROM hgbt_unit_consultant_mst a,PIST_EMP_ENTRY_DTL b WHERE hgnum_deptunitcode = ? AND a.gnum_hospital_code = ? \
and HGSTR_EMP_CODE=b.STR_EMP_NO and a.gnum_isvalid=b.gnum_isvalid and a.gnum_hospital_code=b.gnum_hospital_code  order by hgnum_is_hou desc ,HGNUM_HIERARCHY_LEVEL asc

#Employee detail come from pist_emp_registration_dtl

SELECT_ALL_CONSULANT_DETAIL_OPD_ENQUIRY=SELECT hgstr_emp_code,(SELECT  str_emp_full_name FROM pist_emp_registration_dtl WHERE str_emp_no = a.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS employeename, \
hgnum_is_hou,(select GSTR_DESIG_ST_NAME from GBLT_DESIGNATION_MST where GNUM_DESIG_CODE=b.GNUM_DESIG_CODE and gnum_isvalid=b.gnum_isvalid and gnum_hospital_code=b.gnum_hospital_code) designation, \
decode(hgnum_is_hou,1,'Yes','No')hou FROM hgbt_unit_consultant_mst a,PIST_EMP_REGISTRATION_DTL b WHERE hgnum_deptunitcode = ? AND a.gnum_hospital_code = ? \
and HGSTR_EMP_CODE=b.STR_EMP_NO and a.gnum_isvalid=b.gnum_isvalid and a.gnum_hospital_code=b.gnum_hospital_code  order by hgnum_is_hou desc ,HGNUM_HIERARCHY_LEVEL asc

#End:Sheeldarshi:10-Nov-2014:Enquiry changes

SEARCH_CONSULTANT_DETAIL.PSRT_EMPLOYEE_MST_13_Apr_09=SELECT   TO_CHAR (psrstr_emp_no) AS PSRSTR_EMP_NO, NVL (psrstr_fname, ' ') AS PSRSTR_FNAME, \
										   NVL (psrstr_mname, ' ') AS PSRSTR_MNAME,NVL (psrstr_lname, ' ') AS PSRSTR_LNAME, \
										   PSRBL_ISCONSULTANT ,(SELECT gstr_gender_short FROM gblt_gender_mst WHERE gnum_gender_code =psrt_employee_mst.gnum_gender_code and gnum_hospital_code=?) \
										   || '/' || (DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1 / 24), \
										    -1, ROUND (  24 * 60 * ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob )) || ' Minutes ', \
										    DECODE (SIGN ((SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 1), -1, \
										    ROUND (  24 * (  (SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob)) || ' Hours ', \
										    DECODE (SIGN (  (SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 14 ), -1, \
										    TRUNC (  (SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob ) || ' Days  ', \
										    DECODE(SIGN (  (SELECT SYSDATE FROM DUAL) - psrt_employee_mst.psrdt_dob - 60), -1, TRUNC (  (  (SELECT SYSDATE FROM DUAL) \
										    - psrt_employee_mst.psrdt_dob) / 7 ) || ' Weeks ', DECODE (SIGN (  (SELECT SYSDATE FROM DUAL) \
										    - psrt_employee_mst.psrdt_dob - 365), -1, ROUND (MONTHS_BETWEEN ((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob)) \
										    || ' Months ', FLOOR(  MONTHS_BETWEEN ((SELECT SYSDATE FROM DUAL), psrt_employee_mst.psrdt_dob) / 12) \
										    || ' Years ')))))) AS patgenderage,(SELECT NVL (d.psrstr_fname, ' ') || ' ' || NVL (d.PSRSTR_MNAME, ' ') || ' ' ||  NVL (d.PSRSTR_LNAME, ' ') \
										    FROM psrt_employee_mst d WHERE d.psrstr_emp_no=SUBSTR (psrt_employee_mst.psrstr_emp_no,1,8) || '01') AS patfathername, \
										    (Select GSTR_STATENAME from GBLT_STATE_MST where GNUM_STATECODE=psrt_employee_mst.gnum_state_code and gnum_hospital_code=?) AS GSTR_STATENAME, \
										    (select GSTR_COUNTRYNAME from GBLT_COUNTRY_MST where GNUM_COUNTRYCODE=psrt_employee_mst.gnum_country_code and gnum_hospital_code=?) AS GSTR_COUNTRYNAME, \
										    (select GSTR_CITY_LOC_NAME from GBLT_CITY_LOCATION_MST where GNUM_CITY_LOC_CODE=psrt_employee_mst.GNUM_LOCATION_CODE and gnum_hospital_code=?) AS GSTR_CITY_LOC_NAME, \
										    PSRSTR_CITY,PSRSTR_DISTRICT,PSRSTR_ADD1,PSRNUM_PINCODE FROM psrt_employee_mst where  PSRBL_ISCONSULTANT= 1 AND gnum_isvalid = 1  
										    
SEARCH_CONSULTANT_DETAIL.PSRT_EMPLOYEE_MST=SELECT DISTINCT TO_CHAR (a.str_emp_no) AS psrstr_emp_no, NVL (str_first_name, ' ') AS str_first_name, NVL (str_middle_name, ' ') AS str_middle_name, NVL (str_last_name, ' ') \
											AS str_last_name, num_desig_id srbl_isconsultant, str_gender_name  || '/' || ahis_util.dob_age_on (dt_birth_date, SYSDATE) AS patgenderage,  (SELECT str_father_name \
											FROM pist_emp_family_dtl c WHERE     c.gnum_isvalid = a.gnum_isvalid AND c.gnum_hospital_code = a.gnum_hospital_code AND c.str_emp_number = a.str_emp_no) AS patfathername, \
											(SELECT gstr_statename FROM gblt_state_mst WHERE gnum_statecode = d.num_cur_state_id AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid ) \
											AS num_cur_state_id,(SELECT gstr_countryname FROM gblt_country_mst WHERE gnum_countrycode =   d.num_cur_country_id AND gnum_hospital_code = 100 AND \
											gnum_isvalid = a.gnum_isvalid ) AS num_cur_country_id,  (SELECT gstr_city_loc_name FROM gblt_city_location_mst WHERE gnum_city_loc_code = d.num_cur_city_id AND \
											gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid ) AS num_cur_city_id, (SELECT str_dist_name  FROM gblt_district_mst WHERE num_dist_id = \
											d.num_cur_dist_id  AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) \
											num_cur_dist_id,  str_cur_pin_code,(str_cur_house_no || ',' || \
											str_cur_locality) psrstr_add1 FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b, pist_emp_contact_dtl d  WHERE num_desig_id IN (SELECT num_desig_id \
											FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid = a.gnum_isvalid AND hgnum_process_type = ? AND gnum_hospital_code = a.gnum_hospital_code) AND \
											a.str_emp_no = b.str_emp_no  AND a.str_emp_no = d.str_emp_no(+) AND a.gnum_isvalid = ? AND b.gnum_isvalid = a.gnum_isvalid  AND  \
											a.gnum_isvalid = d.gnum_isvalid(+) AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code  AND \
											a.gnum_hospital_code = d.gnum_hospital_code(+)
										    
										    
SELECT.ALL_COMPONENT.BLOOD_STOCK_ENQUIRY=	SELECT C.HBSTR_COMPONENT_NAME as componentName,D.HBSTR_BLDGRP as bloodGroup, (SELECT COUNT(A.HBSTR_BLDBAG_NO) bagCount \
											FROM HBBT_BLDBAG_COMPONENT_DTL A,HBBT_BLDBAG_DTL B WHERE A.HBSTR_BLDBAG_NO=B.HBSTR_BLDBAG_NO AND \
											A.HBNUM_BLD_COMPONENT_ID=C.HBNUM_BLD_COMPONENT_ID AND B.HBNUM_BLDGRP_CODE=D.HBNUM_BLDGRP_CODE AND \
											A.HBNUM_BAG_STATUS=1 AND B.HBNUM_BAG_STATUS=2 ) bagCount FROM HBBT_BLD_COMPONENT_MST C,HBBT_BLDGRP_MST D \
											where c.gnum_isvalid=? and d.gnum_isvalid=? and c.GNUM_HOSPITAL_CODE=? and d.GNUM_HOSPITAL_CODE=?\
											ORDER BY componentName DESC, bloodGroup ASC

										    
SELECT.IN_STOCK_COMPONENT.BLOOD_STOCK_ENQUIRY=	SELECT (SELECT hbstr_component_name FROM hbbt_bld_component_mst d WHERE hbnum_bld_component_id = o.compid \
												AND gnum_isvalid = ? AND gnum_hospital_code = ?) componentname,  NVL((SELECT hbstr_bldgrp FROM hbbt_bldgrp_mst \
												WHERE hbnum_bldgrp_code = o.bldgrp AND gnum_isvalid = ? AND gnum_hospital_code = ?),'Grouping In process') bloodgroup,o.bldgrp, \
												o.bagcount FROM (SELECT   a.hbnum_bld_component_id compid, b.hbnum_bldgrp_code bldgrp, COUNT (a.hbstr_bldbag_no) bagcount \
												FROM hbbt_bldbag_component_dtl a, hbbt_bldbag_dtl b WHERE a.hbstr_bldbag_no = b.hbstr_bldbag_no AND a.hbnum_bag_status = 1 \
												AND b.hbnum_bag_status = 2 GROUP BY a.hbnum_bld_component_id, b.hbnum_bldgrp_code) o 									     

               
                 
SELECT.VOLUNTARY_DONOR_ENQUIRY.HBBT_DONOR_DTL=SELECT b.hbstr_fname AS donorFirstName, b.hbstr_mname AS donorMiddleName,b.hbstr_lname AS donorLastName, hbdt_dob AS donorDob,\
                        (SELECT ahis_util.dob_age_on (hbdt_dob, SYSDATE) FROM DUAL) AS donorAge, b.gnum_gender_code AS donorGenderCode, \
                        (SELECT gstr_gender_short FROM gblt_gender_mst   WHERE gnum_gender_code = b.gnum_gender_code  AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS donorGender, \
                        b.hbnum_bldgrp_code AS bloodGroupCode, \
                        (SELECT hbstr_bldgrp FROM hbbt_bldgrp_mst WHERE hbnum_bldgrp_code = b.hbnum_bldgrp_code  AND gnum_hospital_code = b.gnum_hospital_code  AND gnum_isvalid = 1) AS bloodGroupDesc, \
                         hbstr_mobile_no AS donorMobileNo, hbstr_email_id AS donorEmailId,hbnum_emergency_call AS donationEmergencycode, \
                         DECODE (hbnum_emergency_call,1, 'YES',0, 'NO','NO') AS donationEmergencydesc, \
                        (SELECT TO_CHAR (a.hbdt_donor_visit_date,'dd-Mon-yy') FROM hbbt_donor_visit_dtl a WHERE a.hbnum_donor_regno = b.hbnum_donor_regno AND a.gnum_isvalid = 1  AND a.gnum_hospital_code = b.gnum_hospital_code \
                         AND a.hbnum_donor_visitno=(SELECT MAX (hbnum_donor_visitno) FROM hbbt_donor_visit_dtl WHERE hbnum_donor_regno = b.hbnum_donor_regno AND gnum_isvalid = 1 AND gnum_hospital_code = b.gnum_hospital_code)) AS donationLastDate, \
                        (SELECT DECODE (hbnum_donation_status,2, 'Sucessfully Donation',3, 'Partially Donated',4, 'Donation Cancelled','Not Known') FROM hbbt_donor_visit_dtl a WHERE a.hbnum_donor_regno = b.hbnum_donor_regno AND a.gnum_isvalid = 1 AND a.gnum_hospital_code = b.gnum_hospital_code \
                        AND a.hbnum_donor_visitno =(SELECT MAX (hbnum_donor_visitno) FROM hbbt_donor_visit_dtl WHERE hbnum_donor_regno = b.hbnum_donor_regno AND gnum_isvalid = 1 AND gnum_hospital_code = b.gnum_hospital_code)) AS donationLastStatusCode,b.HBNUM_DONOR_REGNO	as donorRegistrationNo \
                        FROM hbbt_donor_dtl b  \
                        WHERE b.gnum_hospital_code=?  AND b.hbnum_is_voluntry = '1' AND b.hbnum_donor_status NOT IN (3, 4) AND b.gnum_isvalid = 1

                        
SELECT.DEPARMENT_NAME.GBLT_DEPARTMENT_MST   = SELECT GNUM_DEPT_CODE, GSTR_DEPT_NAME FROM GBLT_DEPARTMENT_MST WHERE GNUM_HOSPITAL_CODE=? AND GNUM_ISVALID=? order by GSTR_DEPT_NAME

SELECT.DESIGNATION_NAME.GBLT_DEPARTMENT_MST 	= SELECT GNUM_DESIG_CODE, GSTR_DESIG_NAME FROM GBLT_DESIGNATION_MST WHERE GNUM_ISVALID=? AND  GNUM_HOSPITAL_CODE=? order by GSTR_DESIG_NAME

SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL_OLD = SELECT A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME, \
											STR_GENDER_NAME , ahis_util.DOB_AGE_ON(DT_BIRTH_DATE,SYSDATE)AGE , \
											GSTR_DEPT_NAME FROM NUM_DEPT_ID, \
											(SELECT gstr_designation FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID=B.NUM_DESIG_ID AND GNUM_ISVALID=?  AND gnum_hospital_code = c.gnum_hospital_code)NUM_DESIG_ID, \
											(SELECT HGSTR_DESCRIPTION||','||HGSTR_ROOM||','||HGSTR_FLOOR||' floor,'||HGSTR_BUILDING||','||HGSTR_BLOCK  FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE=C.GNUM_LOCATION_CODE AND GNUM_ISVALID=?  AND gnum_hospital_code = c.gnum_hospital_code)HGNUM_LOCATION_CODE \
											FROM PIST_EMP_PERSONNEL_DTL A,PIST_EMP_CUR_DETAIL_DTL B,GBLT_DEPARTMENT_MST C \
											WHERE A.GNUM_ISVALID=? AND B.GNUM_ISVALID=? AND c.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=? \
											AND B.GNUM_HOSPITAL_CODE=? AND B.GNUM_HOSPITAL_CODE=? AND STR_VALIDATE='Y' AND A.STR_EMP_NO=B.STR_EMP_NO AND B.NUM_DEPT_ID=C.GNUM_DEPT_CODE \
											AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)


SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL1 = SELECT A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME, \
											STR_GENDER_NAME , ahis_util.DOB_AGE_ON(DT_BIRTH_DATE,SYSDATE)AGE , \
											GSTR_DEPT_NAME FROM NUM_DEPT_ID, \
											(SELECT gstr_designation FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID=A.NUM_DESIG_ID AND GNUM_ISVALID=?  AND gnum_hospital_code = c.gnum_hospital_code)NUM_DESIG_ID, \
											(SELECT HGSTR_DESCRIPTION FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE=C.GNUM_LOCATION_CODE AND GNUM_ISVALID=?  AND gnum_hospital_code = c.gnum_hospital_code)HGNUM_LOCATION_CODE \
											FROM PIST_EMP_ENTRY_DTL A,GBLT_DEPARTMENT_MST C \
											WHERE A.GNUM_ISVALID=? AND c.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=? \
											AND C.GNUM_HOSPITAL_CODE=? AND STR_VALIDATE='Y' AND A.NUM_DEPT_ID=C.GNUM_DEPT_CODE \
											AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)
#employee detail come from pist_emp_entry_dtl table
SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL_2 = SELECT   A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME,\
											(SELECT INITCAP(GSTR_GENDER_NAME) FROM GBLT_GENDER_MST WHERE GNUM_GENDER_CODE=A.NUM_GENDER_CODE AND GNUM_ISVALID=1) AS STR_GENDER_NAME,\
											ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE,(SELECT GSTR_DEPT_NAME FROM gblt_department_mst WHERE gnum_dept_code=A.NUM_DEPT_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) NUM_DEPT_ID,\
											(SELECT gstr_designation FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID = A.NUM_DESIG_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code =A.gnum_hospital_code) NUM_DESIG_ID, \
											CASE WHEN (LENGTH(A.NUM_DEPT_ID)>=3) THEN \
											(SELECT HGSTR_DESCRIPTION  FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = (SELECT gnum_location_code FROM gblt_department_mst WHERE gnum_dept_code=A.NUM_DEPT_ID AND GNUM_ISVALID = 1 AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) \
											ELSE '--' END HGNUM_LOCATION_CODE \
											FROM PIST_EMP_ENTRY_DTL A \
											WHERE A.GNUM_ISVALID=? AND A.GNUM_HOSPITAL_CODE=? \
											AND STR_VALIDATE='Y'
#employee detail come from pist_emp_registration_dtl table
SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL =  SELECT   A.STR_EMP_NO, STR_EMP_FULL_NAME,\
											(SELECT INITCAP(GSTR_GENDER_NAME) FROM GBLT_GENDER_MST WHERE GSTR_GENDER_CODE=A.GSTR_GENDER_CODE AND GNUM_ISVALID=1) AS STR_GENDER_NAME,\
											ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE,(SELECT GSTR_DEPT_NAME FROM gblt_department_mst WHERE gnum_dept_code=A.gnum_dept_code AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) NUM_DEPT_ID,\
											(SELECT GSTR_DESIG_NAME FROM GBLT_DESIGNATION_MST WHERE GNUM_DESIG_CODE = A.gnum_desig_code AND GNUM_ISVALID = 1 AND gnum_hospital_code =A.gnum_hospital_code) NUM_DESIG_ID, \
											CASE WHEN (LENGTH(A.gnum_dept_code)>=3) THEN \
											(SELECT HGSTR_DESCRIPTION  FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = (SELECT gnum_location_code FROM gblt_department_mst WHERE gnum_dept_code=A.gnum_dept_code AND GNUM_ISVALID = 1 AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) \
									        ELSE '--' END HGNUM_LOCATION_CODE \
											FROM PIST_EMP_REGISTRATION_DTL A \
											WHERE A.GNUM_ISVALID=1 AND A.GNUM_HOSPITAL_CODE=?
																						

SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL.ESTATE_MAPPING_REQ_OLD = SELECT   A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME,STR_GENDER_NAME,ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE, \
																GSTR_DEPT_NAME NUM_DEPT_ID,(SELECT gstr_designation \
																FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID = A.NUM_DESIG_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code = c.gnum_hospital_code) NUM_DESIG_ID,(SELECT HGSTR_DESCRIPTION || ','|| (SELECT NUM_ROOM_NUMBER FROM EST_ROOM_MST WHERE \
																NUM_BUILDING_CODE=HGSTR_BUILDING AND NUM_BLOCK_ID=HGSTR_BLOCK AND NUM_FLOOR_ID=HGSTR_FLOOR  AND NUM_ROOM_ID=HGSTR_ROOM AND GNUM_ISVALID=? AND NUM_HOSPITAL_CODE=?) \
																|| ','|| (SELECT STR_FLOOR_NAME FROM EST_FLOOR_MST WHERE NUM_BUILDING_CODE = HGSTR_BUILDING AND NUM_BLOCK_ID = HGSTR_BLOCK \
																AND NUM_FLOOR_ID = HGSTR_FLOOR AND GNUM_ISVALID=? AND NUM_HOSPITAL_CODE=? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= \
                                                               TRUNC (SYSDATE))|| ' floor ,' || (SELECT STR_BLOCK_NAME FROM EST_BLOCK_MST WHERE NUM_BUILDING_CODE = HGSTR_BUILDING \
																AND NUM_BLOCK_ID = HGSTR_BLOCK AND GNUM_ISVALID=? AND NUM_HOSPITAL_CODE=? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= \
                                                               TRUNC (SYSDATE))|| ','|| (SELECT STR_BUILDING_NAME FROM EST_BUILDING_MST WHERE NUM_BUILDING_CODE =  \
																HGSTR_BUILDING AND GNUM_ISVALID=? AND NUM_HOSPITAL_CODE=? AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= \
                                                               TRUNC (SYSDATE)) FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = C.GNUM_LOCATION_CODE AND GNUM_ISVALID = ?  AND gnum_hospital_code = c.gnum_hospital_code) HGNUM_LOCATION_CODE \
																FROM PIST_EMP_PERSONNEL_DTL A, PIST_EMP_CUR_DETAIL_DTL B, GBLT_DEPARTMENT_MST C WHERE A.GNUM_ISVALID = ? AND B.GNUM_ISVALID = ? AND C.GNUM_ISVALID = ?  AND A.GNUM_HOSPITAL_CODE = ? \
																AND B.GNUM_HOSPITAL_CODE = ? AND c.GNUM_HOSPITAL_CODE = ? AND STR_VALIDATE = 'Y' AND A.STR_EMP_NO = B.STR_EMP_NO AND B.NUM_DEPT_ID = C.GNUM_DEPT_CODE AND gdt_effective_frm <= TRUNC (SYSDATE) \
                       											AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) 
                       											
                       											
                       											
 SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL.ESTATE_MAPPING_REQ1 = SELECT   A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME,STR_GENDER_NAME,ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE, \
																GSTR_DEPT_NAME NUM_DEPT_ID,(SELECT gstr_designation \
																FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID = A.NUM_DESIG_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code = c.gnum_hospital_code) NUM_DESIG_ID,(SELECT HGSTR_DESCRIPTION  \
																FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = C.GNUM_LOCATION_CODE AND GNUM_ISVALID = ?  AND gnum_hospital_code = c.gnum_hospital_code) HGNUM_LOCATION_CODE \
																FROM PIST_EMP_ENTRY_DTL A,GBLT_DEPARTMENT_MST C WHERE A.GNUM_ISVALID = ? AND C.GNUM_ISVALID = ?  AND A.GNUM_HOSPITAL_CODE = ? \
																AND c.GNUM_HOSPITAL_CODE = ? AND STR_VALIDATE = 'Y' AND A.NUM_DEPT_ID = C.GNUM_DEPT_CODE AND gdt_effective_frm <= TRUNC (SYSDATE) \
																AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) 

#Start:Sheeldarshi:07-Nov-2014:Enquiry Changes
#SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL.ESTATE_MAPPING_REQ = SELECT   A.STR_EMP_NO, STR_FIRST_NAME, STR_MIDDLE_NAME, STR_LAST_NAME,(SELECT INITCAP(GSTR_GENDER_NAME) FROM GBLT_GENDER_MST WHERE GNUM_GENDER_CODE=A.NUM_GENDER_CODE AND GNUM_ISVALID=1) AS STR_GENDER_NAME,ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE, \																(SELECT GSTR_DEPT_NAME FROM gblt_department_mst WHERE gnum_dept_code=A.NUM_DEPT_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) NUM_DEPT_ID, \																(SELECT gstr_designation FROM gblt_designation_mst_clinical WHERE NUM_DESIG_ID = A.NUM_DESIG_ID AND GNUM_ISVALID = 1 AND gnum_hospital_code =A.gnum_hospital_code) NUM_DESIG_ID, \																CASE WHEN (LENGTH(A.NUM_DEPT_ID)>=3) THEN  \																(SELECT HGSTR_DESCRIPTION  FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = (SELECT gnum_location_code FROM gblt_department_mst WHERE gnum_dept_code=A.NUM_DEPT_ID AND GNUM_ISVALID = 1 AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) ELSE '--' END HGNUM_LOCATION_CODE \																FROM PIST_EMP_ENTRY_DTL A WHERE A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? \																AND STR_VALIDATE = 'Y'

#employee detail come from pist_emp_registration_dtl table
SEARCH_STAFF_DETAIL.PIST_EMP_PERSONNEL_DTL.ESTATE_MAPPING_REQ = SELECT   A.STR_EMP_NO, STR_EMP_FULL_NAME,(SELECT INITCAP(GSTR_GENDER_NAME) FROM GBLT_GENDER_MST WHERE GSTR_GENDER_CODE=A.gstr_gender_code AND GNUM_ISVALID=1) AS STR_GENDER_NAME,ahis_util.DOB_AGE_ON (DT_BIRTH_DATE, SYSDATE) AGE, \
																(SELECT GSTR_DEPT_NAME FROM gblt_department_mst WHERE gnum_dept_code=A.gnum_dept_code AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) NUM_DEPT_ID, \
																(SELECT GSTR_DESIG_NAME FROM GBLT_DESIGNATION_MST WHERE GNUM_DESIG_CODE = A.gnum_desig_code AND GNUM_ISVALID = 1 AND gnum_hospital_code =A.gnum_hospital_code) NUM_DESIG_ID, \
																CASE WHEN (LENGTH(A.GNUM_DEPT_CODE)>=3) THEN  \
																(SELECT HGSTR_DESCRIPTION  FROM HGBT_LOCATION_MST WHERE HGNUM_LOCATION_CODE = (SELECT gnum_location_code FROM gblt_department_mst WHERE gnum_dept_code=A.gnum_dept_code AND GNUM_ISVALID = 1 AND GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) AND GNUM_ISVALID = 1 AND gnum_hospital_code = A.gnum_hospital_code) ELSE '--' END HGNUM_LOCATION_CODE \
																FROM PIST_EMP_REGISTRATION_DTL A WHERE A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? 
																
#End:Sheeldarshi:07-Nov-2014:Enquiry Changes
SELECT.FREE_PATIENT.GBLT_PATIENT_CAT_MST =  select initcap(GSTR_PATIENT_CAT_NAME) as categoryName from GBLT_PATIENT_CAT_MST \
					  						where GNUM_PATIENT_CAT_TYPE=? and GBL_ISPAID=? and gnum_isvalid=? and  GNUM_HOSPITAL_CODE=?                        
					  	
//--------------------------------------------------HOSPITAL_DEPARTMENT_ENQUIRY------------------------------------------------
					  						
SELECT.DEPARTMENT_AND_TYPE.GBLT_DEPARTMENT_MST=	SELECT  gnum_dept_type || '# ' || (SELECT gstr_dept_type_name FROM gblt_department_type \
												WHERE gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = ? and GNUM_DEPT_TYPE=a.GNUM_DEPT_TYPE), \
												gnum_dept_code || ' # ' || gstr_dept_name FROM gblt_department_mst a \
												WHERE gnum_hospital_code = ?  AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
												TO_DATE (SYSDATE, 'DD-MM-YY') ) AND (gnum_isvalid = ? OR gnum_isvalid = ?) order by gnum_dept_type,gstr_dept_name
												
SELECT.DEPARTMENT_DETAILS.GBLT_DEPARTMENT_MST.HGBT_UNIT_MST_OLD=	SELECT   gnum_dept_code AS departmentcode, gstr_dept_name AS department, gstr_hod_code AS hodcode,HGNUM_ISGENERAL unitType, (SELECT str_first_name \
												|| ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND \
												gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod,GSTR_DEPT_SHORT departmentShort,b.gnum_location_code AS locationcode, (SELECT STR_ROOM_NAME \
												FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = a.hgstr_room AND gdt_effective_frm <= SYSDATE \
												AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationroom, \
												(SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = a.hgstr_floor \
												AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
												AND gnum_isvalid > 0) as locationfloor, (SELECT str_block_name FROM est_block_mst WHERE num_hospital_code = a.gnum_hospital_code AND \
												num_block_id = a.hgstr_block AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) \
												 >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationblock, (SELECT str_building_name FROM est_building_mst WHERE \
												 num_hospital_code = a.gnum_hospital_code AND num_building_code = a.hgstr_building AND gdt_effective_frm <= SYSDATE AND \
												 (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationbuilding, \
												 c.hgnum_deptunitcode AS departmentunitcode, c.hgstr_unitname AS departmentunit, DECODE (c.hgnum_isgeneral, 1, 'General', \
												 2, 'Special Clinic', 3, 'Casuality' ) AS unit_type, (SELECT (SELECT str_first_name || ' ' || str_middle_name || ' ' || \
												 str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = d.hgstr_emp_code AND gnum_hospital_code = d.gnum_hospital_code \
												 AND gnum_isvalid = 1) FROM hgbt_unit_consultant_mst d WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gnum_isvalid = 1 \
												 AND hgnum_is_hou = 1 AND gnum_hospital_code = b.gnum_hospital_code) AS hou FROM hgbt_location_mst a, gblt_department_mst b, \
												 hgbt_unit_mst c WHERE b.gnum_dept_code = ? AND b.gnum_dept_code = c.hgnum_dept_code AND b.gnum_hospital_code = ? AND \
												 b.gnum_hospital_code = c.gnum_hospital_code AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gdt_effective_frm <= SYSDATE \
												 AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) \
												 AND c.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (c.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
												 AND (c.gnum_isvalid = 1 OR c.gnum_isvalid = 2) and a.HGNUM_LOCATION_CODE=b.gnum_location_code and a.gnum_isvalid=1 \
												 ORDER BY unittype, departmentunit
												 
SELECT.DEPARTMENT_DETAILS.GBLT_DEPARTMENT_MST.HGBT_UNIT_MST= SELECT   gnum_dept_code AS departmentcode, gstr_dept_name AS department, gstr_hod_code AS hodcode,HGNUM_ISGENERAL unitType, (SELECT str_first_name \
												|| ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = b.gstr_hod_code AND \
												gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod,GSTR_DEPT_SHORT departmentShort,b.gnum_location_code AS locationcode, (SELECT STR_ROOM_NAME \
												FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = a.hgstr_room AND gdt_effective_frm <= SYSDATE \
												AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationroom, \
												(SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = a.hgstr_floor \
												AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
												AND gnum_isvalid > 0) as locationfloor, (SELECT str_block_name FROM est_block_mst WHERE num_hospital_code = a.gnum_hospital_code AND \
												num_block_id = a.hgstr_block AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) \
												 >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationblock, (SELECT str_building_name FROM est_building_mst WHERE \
												 num_hospital_code = a.gnum_hospital_code AND num_building_code = a.hgstr_building AND gdt_effective_frm <= SYSDATE AND \
												 (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationbuilding, \
												 c.hgnum_deptunitcode AS departmentunitcode, c.hgstr_unitname AS departmentunit, DECODE (c.hgnum_isgeneral, 1, 'General', \
												 2, 'Special Clinic', 3, 'Casuality' ) AS unit_type, (SELECT (SELECT str_first_name || ' ' || str_middle_name || ' ' || \
												 str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = d.hgstr_emp_code AND gnum_hospital_code = d.gnum_hospital_code \
												 AND gnum_isvalid = 1) FROM hgbt_unit_consultant_mst d WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gnum_isvalid = 1 \
												 AND hgnum_is_hou = 1 AND gnum_hospital_code = b.gnum_hospital_code) AS hou FROM hgbt_location_mst a, gblt_department_mst b, \
												 hgbt_unit_mst c WHERE b.gnum_dept_code = ? AND b.gnum_dept_code = c.hgnum_dept_code AND b.gnum_hospital_code = ? AND \
												 b.gnum_hospital_code = c.gnum_hospital_code AND b.gnum_hospital_code = a.gnum_hospital_code AND b.gdt_effective_frm <= SYSDATE \
												 AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) \
												 AND c.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (c.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
												 AND (c.gnum_isvalid = 1 OR c.gnum_isvalid = 2) and a.HGNUM_LOCATION_CODE=b.gnum_location_code and a.gnum_isvalid=1 \
												 ORDER BY unittype, departmentunit
												  
SELECT.DEPARTMENT_DETAILS_WITHOUT_LOCATION_MAPPING=	SELECT   gnum_dept_code AS departmentcode, gstr_dept_name AS department, gstr_hod_code AS hodcode,GSTR_DEPT_SHORT departmentShort, (SELECT str_first_name \
													|| ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND \
													gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod, b.gnum_location_code AS locationcode, \
													a.hgstr_room as locationroom, a.hgstr_floor as locationfloor ,a.hgstr_block as locationblock , a.hgstr_building as locationbuilding, c.hgnum_deptunitcode \
													AS departmentunitcode, c.hgstr_unitname AS departmentunit, DECODE (c.hgnum_isgeneral, 1, 'General', 2, 'Special Clinic', \
													3, 'Casuality' ) AS unittype, (SELECT (SELECT    str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM \
													pist_emp_personnel_dtl WHERE str_emp_no = d.hgstr_emp_code AND gnum_hospital_code = d.gnum_hospital_code AND gnum_isvalid = 1)\
													FROM hgbt_unit_consultant_mst d WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gnum_isvalid = 1 AND hgnum_is_hou = 1 \
													AND gnum_hospital_code = b.gnum_hospital_code) AS hou FROM hgbt_location_mst a,gblt_department_mst b, hgbt_unit_mst c \
													WHERE b.gnum_dept_code = ? AND b.gnum_dept_code = c.hgnum_dept_code AND b.gnum_hospital_code = ? AND b.gnum_hospital_code = \
													c.gnum_hospital_code AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
													TO_DATE (SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) AND c.gdt_effective_frm <= SYSDATE AND \
													(TO_DATE (NVL (c.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (c.gnum_isvalid = 1 OR \
													c.gnum_isvalid = 2) AND a.hgnum_location_code = b.gnum_location_code AND a.gnum_hospital_code = b.gnum_hospital_code \
													AND a.gnum_isvalid = 1 ORDER BY unittype, departmentunit
													
SELECT.DEPARTMENT_UNIT_DETAILS_LOCATION_MAPPING.HGBT_UNIT_MST=	SELECT DISTINCT b.hgstr_unitname AS departmentunit,  gnum_location_code AS locationcode, (SELECT STR_ROOM_NAME \
																FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = a.hgstr_room AND gdt_effective_frm \
																<= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND \
																gnum_isvalid > 0) as locationroom, (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code \
																AND num_floor_id = a.hgstr_floor AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), \
																'DD-MM-YY' ) >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationfloor, (SELECT str_block_name FROM est_block_mst \
																WHERE num_hospital_code = a.gnum_hospital_code AND num_block_id = a.hgstr_block AND gdt_effective_frm <= SYSDATE AND \
																(TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) as locationblock, \
																(SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_building_code = \
																a.hgstr_building AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE \
																(SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationbuilding FROM hgbt_location_mst a, hgbt_unit_mst b WHERE b.hgnum_deptunitcode = ? \
																AND b.gnum_hospital_code = ? AND b.gnum_location_code=a.HGNUM_LOCATION_CODE AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE \
																(NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) \
																AND a.gnum_isvalid = 1 AND b.gnum_hospital_code = a.gnum_hospital_code 
																
SELECT.DEPARTMENT_UNIT_DETAILS_LOCATION_MAPPING_NO.HGBT_UNIT_MST=	SELECT DISTINCT b.hgstr_unitname AS departmentunit, gnum_location_code AS locationcode, a.hgstr_room as locationroom, a.hgstr_floor as locationfloor, \
																	a.hgstr_block as locationblock,a.hgstr_building AS locationbuilding FROM hgbt_location_mst a, hgbt_unit_mst b WHERE b.hgnum_deptunitcode = ? \
																	And b.GNUM_LOCATION_CODE=a.HGNUM_LOCATION_CODE AND b.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE \
																	(NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) \
																	AND a.gnum_isvalid = 1 AND b.gnum_hospital_code = a.gnum_hospital_code
																	
SELECT.UNIT_CONSULTANT_DETAILS.HGBT_UNIT_CONSULTANT_MST=	SELECT hgstr_emp_code AS emp_code,(SELECT str_first_name || ' ' || str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = a.hgstr_emp_code AND gnum_hospital_code = a.gnum_hospital_code \
															AND gnum_isvalid = a.gnum_isvalid)||' ('||(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID and GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and gnum_isvalid=b.gnum_isvalid)||')' AS unitconsultant, \
															hgnum_is_hou AS ishou FROM hgbt_unit_consultant_mst a ,PIST_EMP_CUR_DETAIL_DTL b WHERE hgnum_deptunitcode = ? AND a.gnum_isvalid = ? and a.gnum_isvalid=b.gnum_isvalid AND a.gnum_hospital_code = ? and a.GNUM_HOSPITAL_CODE=b.GNUM_HOSPITAL_CODE and a.HGSTR_EMP_CODE=b.STR_EMP_NO 
															
SELECT.UNIT_ROOM_DETAILS.HGBT_UNIT_CONSULTANT_MST=	SELECT HGNUM_ROOM_CODE as roomcode, (SELECT HGSTR_ROOM_NAME from hgbt_room_mst WHERE HGNUM_ROOM_CODE = a.HGNUM_ROOM_CODE AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.GNUM_ISVALID) as room \
													FROM HRGT_DEPT_UNIT_ROOM_MST a WHERE hgnum_deptunitcode = ? AND gnum_isvalid = 1  AND gnum_hospital_code =? AND trunc(gdt_effective_frm) <= trunc(SYSDATE)  AND (trunc(NVL (gdt_effective_to,SYSDATE)) >= trunc(SYSDATE))
													
SELECT.UNIT_WARD_DETAILS.HIPT_DUWRBED_MST_OLD=	SELECT DISTINCT a.hipnum_ward_code AS wardCode,hipstr_ward_name ward, (SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = \
											a.gnum_hospital_code AND num_building_code = b.GNUM_BUILDING_CODE AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
											TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationBuilding,  (SELECT str_block_name FROM est_block_mst      WHERE num_hospital_code = a.gnum_hospital_code \
											AND num_block_id = b.GNUM_BLOCK_CODE AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY') \
											)AND gnum_isvalid > 0) AS locationBlock,(SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = b.HIPSTR_FLOORNO \
											AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationFloor, \
											(select HIPSTR_WARDTYPENAME from hipt_wardtype_mst where HIPNUM_WARDTYPE_CODE=b.HIPNUM_WARDTYPE_CODE and gnum_hospital_code=b.gnum_hospital_code and gnum_isvalid=b.gnum_isvalid)wardType \
											FROM hipt_duwrbed_mst a,hipt_ward_mst b WHERE hgnum_deptunitcode = ? and b.hipnum_ward_code = a.hipnum_ward_code AND b.gnum_hospital_code = a.gnum_hospital_code \
											AND a.gdt_effective_frm < SYSDATE AND a.gnum_isvalid = ? AND a.gnum_isvalid =b.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE \
											AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY')) AND b.hipnum_ward_code IN (SELECT hipnum_ward_code FROM hipt_ward_mst WHERE hipnum_ward_code = a.hipnum_ward_code \
											AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), \
											'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')))
											
SELECT.UNIT_WARD_DETAILS.HIPT_DUWRBED_MST=	SELECT DISTINCT a.hipnum_ward_code AS wardCode,hipstr_ward_name ward, (SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = \
											a.gnum_hospital_code AND num_building_code = b.GNUM_BUILDING_CODE AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
											TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationBuilding,  (SELECT str_block_name FROM est_block_mst      WHERE num_hospital_code = a.gnum_hospital_code \
											AND num_block_id = b.GNUM_BLOCK_CODE AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY') \
											)AND gnum_isvalid > 0) AS locationBlock,HIPSTR_FLOORNO locationFloor, \
											(select HIPSTR_WARDTYPENAME from hipt_wardtype_mst where HIPNUM_WARDTYPE_CODE=b.HIPNUM_WARDTYPE_CODE and gnum_hospital_code=b.gnum_hospital_code and gnum_isvalid=b.gnum_isvalid)wardType \
											FROM hipt_duwrbed_mst a,hipt_ward_mst b WHERE hgnum_deptunitcode = ? and b.hipnum_ward_code = a.hipnum_ward_code AND b.gnum_hospital_code = a.gnum_hospital_code \
											AND a.gdt_effective_frm < SYSDATE AND a.gnum_isvalid = ? AND a.gnum_isvalid =b.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE \
											AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY')) AND b.hipnum_ward_code IN (SELECT hipnum_ward_code FROM hipt_ward_mst WHERE hipnum_ward_code = a.hipnum_ward_code \
											AND gnum_hospital_code = a.gnum_hospital_code  AND gnum_isvalid = a.gnum_isvalid AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), \
											'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY'))) order by hipstr_ward_name
											
SELECT.DEPARTMENT_DETAILS_WITH_MAPPING.GBLT_DEPARTMENT_MST=	SELECT gnum_dept_code AS departmentcode, gstr_dept_name AS department,GSTR_DEPT_SHORT departmentShort, gstr_hod_code AS hodcode, (SELECT str_first_name || ' ' || str_middle_name \
															|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod, \
															b.gnum_location_code AS locationcode, (SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = a.hgstr_room \
															AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationroom, \
															(SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = a.hgstr_floor AND gdt_effective_frm <= SYSDATE AND \
															(TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationfloor, (SELECT str_block_name FROM est_block_mst \
															WHERE num_hospital_code = a.gnum_hospital_code AND num_block_id = a.hgstr_block AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
															TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationblock, (SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = a.gnum_hospital_code \
															AND num_building_code = a.hgstr_building AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
															AND gnum_isvalid > 0) AS locationbuilding FROM hgbt_location_mst a, gblt_department_mst b WHERE b.gnum_dept_code = ? AND b.gnum_hospital_code = ? AND \
															b.gnum_hospital_code = a.gnum_hospital_code AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE \
															(SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) AND a.hgnum_location_code = b.gnum_location_code AND a.gnum_isvalid = 1
															
SELECT.DEPARTMENT_DETAILS_WITHOUT_LOCATION_MAPPING.GBLT_DEPARTMENT_MST= SELECT gnum_dept_code AS departmentcode, gstr_dept_name AS department,GSTR_DEPT_SHORT departmentShort, gstr_hod_code AS hodcode, (SELECT str_first_name || ' ' || str_middle_name \
																		|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code AND \
																		gnum_isvalid = 1) AS hod, b.gnum_location_code AS locationcode, a.hgstr_room AS locationroom, a.hgstr_floor AS locationfloor, a.hgstr_block \
																		AS locationblock, a.hgstr_building AS locationbuilding FROM hgbt_location_mst a, gblt_department_mst b WHERE b.gnum_dept_code = ? AND \
																		b.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE \
																		(SYSDATE, 'DD-MM-YY')) AND (b.gnum_isvalid = 1 OR b.gnum_isvalid = 2) AND a.hgnum_location_code = b.gnum_location_code \
																		AND a.gnum_hospital_code = b.gnum_hospital_code AND a.gnum_isvalid = 1 
											
SELECT.PARA_CLINIC_DEPARTMENT_DETAILS_WITH_MAPPING.GBLT_LABORATORY_MST =	SELECT gnum_lab_code labCode, a.gnum_dept_code departmentCode,gstr_dept_name department,GSTR_DEPT_SHORT departmentShort,gstr_lab_name labName, gstr_lab_short, decode(gnum_lab_type,'R','Routine','E','Emergency')labType, gnum_lab_incharge,a.GNUM_LOCATION_CODE, \
														(SELECT str_first_name || ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = a.gnum_lab_incharge AND gnum_hospital_code = gnum_hospital_code \
														AND gnum_isvalid = 1) labIncharge,(SELECT str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code \
           												AND gnum_isvalid = 1) AS hod,(SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = c.hgstr_room AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 		TO_DATE (SYSDATE, 'DD-MM-YY'))AND gnum_isvalid > 0) AS locationroom,(SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = c.hgstr_floor AND gdt_effective_frm <= SYSDATE \
                                                 		AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY'))AND gnum_isvalid > 0) AS locationfloor,(SELECT str_block_name FROM est_block_mst WHERE num_hospital_code = a.gnum_hospital_code \
           												AND num_block_id = c.hgstr_block AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationblock, \
       													(SELECT str_building_name FROM est_building_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_building_code = c.hgstr_building AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                		TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationbuilding FROM gblt_laboratory_mst a,gblt_department_mst b,hgbt_location_mst c WHERE a.gnum_hospital_code = ? AND gbl_isvalid = ? AND a.gnum_dept_code =  ?   and a.gnum_dept_code=b.gnum_dept_code \
                                                		and c.HGNUM_LOCATION_CODE=b.GNUM_LOCATION_CODE and a.gnum_hospital_code=b.gnum_hospital_code and a.gbl_isvalid=b.gnum_isvalid AND a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
                                                		 and a.gnum_hospital_code=c.gnum_hospital_code and b.gnum_isvalid=c.gnum_isvalid order by gstr_lab_name
																									
SELECT.PARA_CLINIC_DEPARTMENT_DETAILS_WITHOUT_LOCATION_MAPPING.GBLT_LABORATORY_MST = SELECT gnum_lab_code labCode, a.gnum_dept_code departmentCode,gstr_dept_name department,GSTR_DEPT_SHORT departmentShort,gstr_lab_name labName, gstr_lab_short, decode(gnum_lab_type,'R','Routine','E','Emergency')labType, gnum_lab_incharge,a.GNUM_LOCATION_CODE, \
														(SELECT str_first_name || ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = a.gnum_lab_incharge AND gnum_hospital_code = gnum_hospital_code \
														AND gnum_isvalid = 1) labIncharge,(SELECT str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = b.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code \
           												AND gnum_isvalid = 1) AS hod,c.hgstr_room AS locationroom, c.hgstr_floor AS locationfloor, c.hgstr_block AS locationblock,c.hgstr_building \
           												AS locationbuilding FROM gblt_laboratory_mst a,gblt_department_mst b,hgbt_location_mst c WHERE a.gnum_hospital_code = ? AND gbl_isvalid = ? AND a.gnum_dept_code =  ?   and a.gnum_dept_code=b.gnum_dept_code and a.gnum_hospital_code=b.gnum_hospital_code \
  														and a.gnum_hospital_code=c.gnum_hospital_code and b.gnum_isvalid=c.gnum_isvalid and c.HGNUM_LOCATION_CODE=b.GNUM_LOCATION_CODE and a.gbl_isvalid=b.gnum_isvalid AND a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
														order by gstr_lab_name
																									
//-------------------------------------------HOSPITAL_CONSULTANT_ENQUIRY--------------------------------------------					  						
										 
SELECT.ALL_CONSULTANT.HGBT_UNIT_CONSULTANT_MST_OLD	=	SELECT TO_CHAR(a.str_emp_no) AS empNo, (NVL (str_first_name, ' ')|| ' '|| NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, '')) consultantName,substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
													(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
													num_desig_id srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) \
													AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
													FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
													AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department,hgnum_is_hou, decode(hgnum_is_hou,0,' ',1,NVL (str_first_name, ' ')|| ' '|| \
													NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, ''))hou FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b,HGBT_UNIT_CONSULTANT_MST c WHERE num_desig_id IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid=a.gnum_isvalid and hgnum_process_type = ? AND gnum_hospital_code =a.gnum_hospital_code) \
													AND a.str_emp_no = b.str_emp_no AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND b.gnum_isvalid = a.gnum_isvalid AND b.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
													AND b.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit
														
	#Start:Sheeldarshi:05-Nov-2014:Enquiry Changes													
	#SELECT.ALL_CONSULTANT.HGBT_UNIT_CONSULTANT_MST	=	SELECT TO_CHAR(a.str_emp_no) AS empNo, (NVL (str_first_name, ' ')|| ' '|| NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, '')) consultantName,substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \														(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=a.NUM_DESIG_ID AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \														num_desig_id srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) \														AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \														FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \														AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department,hgnum_is_hou, decode(hgnum_is_hou,0,' ',1,NVL (str_first_name, ' ')|| ' '|| \														NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, ''))hou FROM pist_emp_entry_dtl a,HGBT_UNIT_CONSULTANT_MST c WHERE num_desig_id IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid=a.gnum_isvalid and hgnum_process_type = ? AND gnum_hospital_code =a.gnum_hospital_code) \														AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND a.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \														AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit

#employee data fetch from pist_emp_entry__dtl table											
	SELECT.ALL_CONSULTANT.HGBT_UNIT_CONSULTANT_MST_1	=	SELECT TO_CHAR(a.str_emp_no) AS empNo, (NVL (str_first_name, ' ')|| ' '|| NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, '')) consultantName,substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
														(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=a.NUM_DESIG_ID AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
														num_desig_id srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode  \
														AND  gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
														FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
														) department,hgnum_is_hou, decode(hgnum_is_hou,0,' ',1,NVL (str_first_name, ' ')|| ' '|| \
														NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, ''))hou FROM pist_emp_entry_dtl a,HGBT_UNIT_CONSULTANT_MST c WHERE num_desig_id IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid=a.gnum_isvalid and hgnum_process_type = ? AND gnum_hospital_code =a.gnum_hospital_code) \
														AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND a.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
														AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit
#employee data fetch from pist_emp_registration__dtl table															
  SELECT.ALL_CONSULTANT.HGBT_UNIT_CONSULTANT_MST	=	SELECT TO_CHAR(a.str_emp_no) AS empNo, (NVL (str_emp_full_name, '')) consultantName,substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
														(select GSTR_DESIG_ST_NAME from GBLT_DESIGNATION_MST where GNUM_DESIG_CODE=a.gnum_desig_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
														gnum_desig_code srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode  \
														AND  gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
														FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
														) department,hgnum_is_hou, decode(hgnum_is_hou,0,' ',1,NVL (str_emp_full_name, ' '))hou FROM pist_emp_registration_dtl a,HGBT_UNIT_CONSULTANT_MST c WHERE \
														gnum_desig_code IN (SELECT num_desig_id FROM hgbt_doctor_desig_mapping WHERE gnum_isvalid=a.gnum_isvalid and hgnum_process_type = ? AND gnum_hospital_code =a.gnum_hospital_code) \
														AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND a.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
														AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit														
														
	#End:Sheeldarshi:05-Nov-2014:Enquiry Changes
													 																									 
SELECT.CONSULTANT_DETAIL_BY_NAME.HGBT_UNIT_CONSULTANT_MST_OLD	=	SELECT TO_CHAR (a.str_emp_no) AS empNo, NVL (str_first_name, ' ')|| ' '|| NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, '') consultantName, substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
													(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=b.NUM_DESIG_ID AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
													num_desig_id srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) \
													AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
													FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
													AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department,hgnum_is_hou, decode(hgnum_is_hou,1,NVL (str_first_name, ' ')|| ' '|| \
													NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, ''))hod FROM pist_emp_personnel_dtl a, pist_emp_cur_detail_dtl b,HGBT_UNIT_CONSULTANT_MST c WHERE num_desig_id IN (3, 5) \
													and UPPER (NVL (str_first_name, '')|| ''|| NVL (str_middle_name, '')|| ''|| NVL (str_last_name, '')) LIKE UPPER (?) and substr(HGNUM_DEPTUNITCODE,1,3) like (?)\
													AND a.str_emp_no = b.str_emp_no AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND b.gnum_isvalid = a.gnum_isvalid AND b.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
													AND b.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit
#employee data come from PIST_EMP_ENTRY_DTL table
SELECT.CONSULTANT_DETAIL_BY_NAME.HGBT_UNIT_CONSULTANT_MST_1= SELECT TO_CHAR (a.str_emp_no) AS empNo, NVL (str_first_name, ' ')|| ' '|| NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, '') consultantName, substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
															(select gstr_designation from gblt_designation_mst_clinical where NUM_DESIG_ID=a.NUM_DESIG_ID AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
															num_desig_id srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND gdt_effective_frm <= TRUNC (SYSDATE) \
															AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
															FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code \
															AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE)) department,hgnum_is_hou, decode(hgnum_is_hou,1,NVL (str_first_name, ' ')|| ' '|| \
															NVL (str_middle_name, '')|| ' '|| NVL (str_last_name, ''))hod FROM pist_emp_entry_dtl a,HGBT_UNIT_CONSULTANT_MST c WHERE num_desig_id IN (3, 5) \
															and UPPER (NVL (str_first_name, '')|| ''|| NVL (str_middle_name, '')|| ''|| NVL (str_last_name, '')) LIKE UPPER (?) and substr(HGNUM_DEPTUNITCODE,1,3) like (?)\
															AND a.str_emp_no = a.str_emp_no AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND a.gnum_isvalid = a.gnum_isvalid AND a.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
															AND a.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit
#employee data come from PIST_EMP_REGISTRATION_DTL table
SELECT.CONSULTANT_DETAIL_BY_NAME.HGBT_UNIT_CONSULTANT_MST= SELECT TO_CHAR (a.str_emp_no) AS empNo, NVL (str_emp_full_name, '') consultantName, substr(HGNUM_DEPTUNITCODE,1,3) departmentCode, \
															(select GSTR_DESIG_ST_NAME from GBLT_DESIGNATION_MST where GNUM_DESIG_CODE=a.GNUM_DESIG_CODE AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code)designation, \
															gnum_desig_code srbl_isconsultant,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = c.hgnum_deptunitcode AND  \
															 gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentUnit,(SELECT gstr_dept_name \
															FROM gblt_department_mst WHERE gnum_dept_code = SUBSTR (c.hgnum_deptunitcode, 1, 3) AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) \
															department,hgnum_is_hou, decode(hgnum_is_hou,1,NVL (str_emp_full_name,'')) \
															 hod FROM pist_emp_registration_dtl a,HGBT_UNIT_CONSULTANT_MST c WHERE gnum_desig_code IN (3, 5) \
															and UPPER (NVL (str_emp_full_name, '')) LIKE UPPER (?) and substr(HGNUM_DEPTUNITCODE,1,3) like (?)\
															AND a.str_emp_no = a.str_emp_no AND a.str_emp_no = c.hgstr_emp_code AND a.gnum_isvalid = ? AND a.gnum_isvalid = a.gnum_isvalid AND a.gnum_isvalid = c.gnum_isvalid AND a.gnum_hospital_code =? \
															AND a.gnum_hospital_code = a.gnum_hospital_code AND c.gnum_hospital_code = a.gnum_hospital_code order by consultantname,department,departmentunit

SELECT.CONSULTANT_DETAIL_BY_EMPNO.HGBT_UNIT_CONSULTANT_MST_OLD	=	SELECT  d.hgstr_emp_code AS empno,(SELECT str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = d.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS consultantname, \
         											GSTR_DEPT_NAME department, a.hgnum_deptunitcode departmentunitcode,hgstr_unitname AS departmentunit,GNUM_DEPT_CODE departmentcode,(SELECT (SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_building_code = hgstr_building \
                        							AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND num_hospital_code = a.gnum_hospital_code and gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY') \
                 									))|| '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_hospital_code = a.gnum_hospital_code and num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 	TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_block_name FROM est_block_mst WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building and num_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 	TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building and num_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 	TO_DATE (SYSDATE, 'DD-MM-YY') )) FROM hgbt_location_mst WHERE hgnum_location_code = b.gnum_location_code  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) AS LOCATION,(SELECT (SELECT STR_ROOM_NAME \
                       								FROM est_room_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 	TO_DATE (SYSDATE, 'DD-MM-YY'))) || '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE \
             										AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_block_name FROM est_block_mst  WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building AND gdt_effective_frm <= SYSDATE \
             										AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
                                                 	TO_DATE (SYSDATE, 'DD-MM-YY'))) FROM hgbt_location_mst WHERE hgnum_location_code = a.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid and trunc(HGDT_EFFECT_DATE) <= trunc(sysdate)) unitlocation, \
         											d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d, gblt_department_mst b WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.HGNUM_DEPT_CODE = b.gnum_dept_code AND d.hgstr_emp_code = ? AND a.gnum_isvalid = ? \
     												AND b.gnum_isvalid = a.gnum_isvalid AND d.gnum_isvalid = a.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code  AND d.gnum_hospital_code = a.gnum_hospital_code  and a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), \
                                      				'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) and b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) ORDER BY department, departmentunit

#consultant detail come from pist_emp_entry_dtl table
SELECT.CONSULTANT_DETAIL_BY_EMPNO.HGBT_UNIT_CONSULTANT_MST1= SELECT  d.hgstr_emp_code AS empno,(SELECT str_first_name || ' '|| str_middle_name || ' '|| str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = d.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS consultantname, \
 GSTR_DEPT_NAME department, a.hgnum_deptunitcode departmentunitcode,hgstr_unitname AS departmentunit,GNUM_DEPT_CODE departmentcode,(SELECT (SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_building_code = hgstr_building \
 AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND num_hospital_code = a.gnum_hospital_code and gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY') \
 ))|| '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_hospital_code = a.gnum_hospital_code and num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_block_name FROM est_block_mst WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building and num_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building and num_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE  AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY') )) FROM hgbt_location_mst WHERE hgnum_location_code = b.gnum_location_code  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) AS LOCATION,(SELECT (SELECT STR_ROOM_NAME \
 FROM est_room_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY'))) || '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE \
 AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_block_name FROM est_block_mst  WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building AND gdt_effective_frm <= SYSDATE \
 AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY'))) FROM hgbt_location_mst WHERE hgnum_location_code = a.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid and trunc(HGDT_EFFECT_DATE) <= trunc(sysdate)) unitlocation, \
 d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d, gblt_department_mst b WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.HGNUM_DEPT_CODE = b.gnum_dept_code AND d.hgstr_emp_code = ? AND a.gnum_isvalid = ? \
 AND b.gnum_isvalid = a.gnum_isvalid AND d.gnum_isvalid = a.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code  AND d.gnum_hospital_code = a.gnum_hospital_code  and a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), \
 'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) and b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) ORDER BY department, departmentunit

#consultant detail come from pist_emp_registration_dtl table
 SELECT.CONSULTANT_DETAIL_BY_EMPNO.HGBT_UNIT_CONSULTANT_MST=SELECT  d.hgstr_emp_code AS empno,(SELECT str_emp_full_name FROM pist_emp_registration_dtl WHERE str_emp_no = d.hgstr_emp_code and gnum_hospital_code=a.gnum_hospital_code) AS consultantname,\ 
 GSTR_DEPT_NAME department, a.hgnum_deptunitcode departmentunitcode,hgstr_unitname AS departmentunit,a.GNUM_DEPT_CODE departmentcode,(SELECT (SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_building_code = hgstr_building \
 AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND num_hospital_code = a.gnum_hospital_code and gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY') \
 ))|| '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_hospital_code = a.gnum_hospital_code and num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_block_name FROM est_block_mst WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building and num_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building and gnum_hospital_code = a.gnum_hospital_code ) FROM hgbt_location_mst WHERE hgnum_location_code = b.gnum_location_code  AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) AS LOCATION,(SELECT (SELECT STR_ROOM_NAME \
 FROM est_room_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND num_room_id = hgstr_room AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
 TO_DATE (SYSDATE, 'DD-MM-YY'))) || '@'|| (SELECT STR_FLOOR_NAME FROM est_floor_mst WHERE num_building_code = hgstr_building AND num_block_id = num_block_id AND num_floor_id = hgstr_floor AND gdt_effective_frm <= SYSDATE \
 AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=  TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@' || (SELECT str_block_name FROM est_block_mst  WHERE hgstr_block = num_block_id AND num_building_code = hgstr_building AND gdt_effective_frm <= SYSDATE \
 AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')))|| '@'|| (SELECT str_building_name FROM est_building_mst WHERE num_building_code = hgstr_building ) FROM hgbt_location_mst WHERE hgnum_location_code = a.hgnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid ) unitlocation, \
 d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d, gblt_department_mst b WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.GNUM_DEPT_CODE = b.gnum_dept_code AND d.hgstr_emp_code = ''AND a.gnum_isvalid = 1 \
 AND b.gnum_isvalid = a.gnum_isvalid AND d.gnum_isvalid = a.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code  AND d.gnum_hospital_code = a.gnum_hospital_code  ORDER BY department, departmentunit

SELECT.CONSULTANT_DETAIL_BY_EMPNO_WITHOUT_LOCATION_MAPPING.HGBT_UNIT_CONSULTANT_MST_OLD	=	SELECT d.hgstr_emp_code as empNo, (SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = d.hgstr_emp_code) AS consultantname, \
													 gstr_dept_name  AS department,	a.hgnum_deptunitcode departmentUnitCode,hgstr_unitname AS departmentUnit, GNUM_DEPT_CODE departmentCode,(select HGSTR_ROOM || '@'|| HGSTR_FLOOR || '@'||hgstr_block || '@'|| HGSTR_BUILDING FROM hgbt_location_mst \
													 WHERE hgnum_location_code = b.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) LOCATION,(SELECT  HGSTR_ROOM|| '@'|| HGSTR_FLOOR ||'@'|| HGSTR_BLOCK||'@'|| HGSTR_BUILDING FROM hgbt_location_mst \
													 WHERE hgnum_location_code = a.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) unitlocation, d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d , gblt_department_mst b \
											 		 WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.HGNUM_DEPT_CODE = b.gnum_dept_code and d.hgstr_emp_code = ? AND a.gnum_isvalid =?  and b.gnum_isvalid =a.gnum_isvalid  AND d.gnum_isvalid = a.gnum_isvalid \
													 AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code AND d.gnum_hospital_code = a.gnum_hospital_code  and a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), \
                                      				'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) and b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) ORDER BY department, departmentunit
#consultant detail fetch from pist_emp_entry_dtl table
SELECT.CONSULTANT_DETAIL_BY_EMPNO_WITHOUT_LOCATION_MAPPING.HGBT_UNIT_CONSULTANT_MST_1	=	SELECT d.hgstr_emp_code as empNo, (SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = d.hgstr_emp_code) AS consultantname, \
													 gstr_dept_name  AS department,	a.hgnum_deptunitcode departmentUnitCode,hgstr_unitname AS departmentUnit, GNUM_DEPT_CODE departmentCode,(select HGSTR_ROOM || '@'|| HGSTR_FLOOR || '@'||hgstr_block || '@'|| HGSTR_BUILDING FROM hgbt_location_mst \
													 WHERE hgnum_location_code = b.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) LOCATION,(SELECT  HGSTR_ROOM|| '@'|| HGSTR_FLOOR ||'@'|| HGSTR_BLOCK||'@'|| HGSTR_BUILDING FROM hgbt_location_mst \
													 WHERE hgnum_location_code = a.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) unitlocation, d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d , gblt_department_mst b \
											 		 WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.HGNUM_DEPT_CODE = b.gnum_dept_code and d.hgstr_emp_code = ? AND a.gnum_isvalid =?  and b.gnum_isvalid =a.gnum_isvalid  AND d.gnum_isvalid = a.gnum_isvalid \
													 AND a.gnum_hospital_code = ? AND b.gnum_hospital_code = a.gnum_hospital_code AND d.gnum_hospital_code = a.gnum_hospital_code  and a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), \
                                      				'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) and b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YYYY') >= TO_DATE (SYSDATE, 'DD-MM-YYYY')) ORDER BY department, departmentunit

#consultant detail fetch from pist_emp_registration_dtl table
SELECT.CONSULTANT_DETAIL_BY_EMPNO_WITHOUT_LOCATION_MAPPING.HGBT_UNIT_CONSULTANT_MST	=SELECT d.hgstr_emp_code as empNo, (SELECT str_emp_full_name FROM pist_emp_registration_dtl WHERE str_emp_no = d.hgstr_emp_code) AS consultantname, \
            gstr_dept_name  AS department,	a.hgnum_deptunitcode departmentUnitCode,hgstr_unitname AS departmentUnit, a.GNUM_DEPT_CODE departmentCode,(select HGSTR_ROOM || '@'|| HGSTR_FLOOR || '@'||hgstr_block || '@'|| HGSTR_BUILDING FROM hgbt_location_mst\ 
           WHERE hgnum_location_code = b.gnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) as location,(SELECT  HGSTR_ROOM|| '@'|| HGSTR_FLOOR ||'@'|| HGSTR_BLOCK||'@'|| HGSTR_BUILDING FROM hgbt_location_mst \
        WHERE hgnum_location_code = a.hgnum_location_code AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid) unitlocation, d.hgnum_is_hou ishou FROM hgbt_unit_mst a, hgbt_unit_consultant_mst d , gblt_department_mst b \
      WHERE (d.hgnum_deptunitcode = a.hgnum_deptunitcode) AND a.GNUM_DEPT_CODE = b.gnum_dept_code and d.hgstr_emp_code = '' AND a.gnum_isvalid =1  and b.gnum_isvalid =a.gnum_isvalid  AND d.gnum_isvalid = a.gnum_isvalid \
      AND a.gnum_hospital_code = 101 AND b.gnum_hospital_code = a.gnum_hospital_code AND d.gnum_hospital_code = a.gnum_hospital_code \  
       ORDER BY department, departmentunit
       
SELECT.ROOM_BY_DEPT_UNIT.HGBT_ROOM_MST	=	SELECT (SELECT hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = b.hgnum_room_code AND b.gnum_hospital_code = gnum_hospital_code and b.gnum_isvalid = gnum_isvalid)hgstr_room_name \
  											FROM hrgt_dept_unit_room_mst b WHERE b.gnum_isvalid = ?  AND b.gnum_hospital_code = ? AND hgnum_deptunitcode = ?
											
SELECT.UNIT_WORKING_DTL.HGBT_UNIT_MST	=	select unitdays(?,?)||'#'||unitrooms(?,?) from dual
											
//---------------------------------------------WARD_ENQUIRY-------------------------------------------------------------

SELECT.ALL_WARD.HIPT_WARD_MST	=	SELECT b.hipnum_ward_code AS wardCode, hipstr_ward_name ward,(SELECT hipstr_wardtypename FROM hipt_wardtype_mst WHERE hipnum_wardtype_code = b.hipnum_wardtype_code \
									AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid) wardType FROM hipt_ward_mst b WHERE b.gnum_isvalid = ? AND b.gnum_hospital_code = ? \
									AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY'))
					//-----------gnumhangedtonum----------------//	

#Start:Sheeldarshi:07-Nov-2014:Enquiry Changes								
SELECT.WARD_DETAIL.HIPT_WARD_MST 	=	SELECT distinct a.hipnum_ward_code AS wardcode, hipstr_ward_name ward,nvl((SELECT str_building_name FROM est_building_mst where num_hospital_code= a.gnum_hospital_code AND num_building_code = b.gnum_building_code \
									AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0 ) ,' ') AS locationbuilding, \
									nvl((SELECT str_block_name FROM est_block_mst WHERE gnum_hospital_code =  a.gnum_hospital_code AND num_block_id = b.gnum_block_code   \
									 AND gnum_isvalid > 0),'') AS locationblock, b.hipstr_floorno  AS locationfloor,\
									(SELECT hipstr_wardtypename FROM hipt_wardtype_mst WHERE hipnum_wardtype_code = b.hipnum_wardtype_code \
									AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid) wardtype,(SELECT gstr_dept_name FROM gblt_department_mst  WHERE gnum_dept_code = a.gnum_dept_code \
									AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code ) department,(SELECT hgstr_unitname \
									FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND NVL (gdt_effective_to, SYSDATE) >= SYSDATE) departmentUnit,HGNUM_DEPTUNITCODE departmentUnitCode \
									FROM hipt_duwrbed_mst a, hipt_ward_mst b WHERE b.hipnum_ward_code = a.hipnum_ward_code AND b.gnum_hospital_code = a.gnum_hospital_code AND a.gdt_effective_frm < SYSDATE AND a.gnum_isvalid = ? \
									AND a.gnum_isvalid = b.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
									and b.hipnum_ward_code =? order by department,departmentUnit

SELECT.WARD_DETAIL.HIPT_WARD_MST 	=	SELECT distinct a.hipnum_ward_code AS wardcode, hipstr_ward_name ward,nvl((SELECT str_building_name FROM est_building_mst where gnum_hospital_code= a.gnum_hospital_code AND num_building_code = b.gnum_building_code \
									AND gnum_isvalid > 0 ) ,' ') AS locationbuilding, \
									nvl((SELECT str_block_name FROM est_block_mst WHERE num_hospital_code =  a.gnum_hospital_code AND num_block_id = b.gnum_block_code   \
									 AND gnum_isvalid > 0),'') AS locationblock, b.hipstr_floorno  AS locationfloor,\
									(SELECT hipstr_wardtypename FROM hipt_wardtype_mst WHERE hipnum_wardtype_code = b.hipnum_wardtype_code \
									AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid) wardtype,(SELECT gstr_dept_name FROM gblt_department_mst  WHERE gnum_dept_code = a.gnum_dept_code \
									AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code ) department,(SELECT hgstr_unitname \
									FROM hgbt_unit_mst WHERE hgnum_deptunitcode = a.hgnum_deptunitcode AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND NVL (gdt_effective_to, SYSDATE) >= SYSDATE) departmentUnit,HGNUM_DEPTUNITCODE departmentUnitCode \
									FROM hipt_duwrbed_mst a, hipt_ward_mst b WHERE b.hipnum_ward_code = a.hipnum_ward_code AND b.gnum_hospital_code = a.gnum_hospital_code AND a.gdt_effective_frm < SYSDATE AND a.gnum_isvalid = ? \
									AND a.gnum_isvalid = b.gnum_isvalid AND a.gnum_hospital_code = ? AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
									and b.hipnum_ward_code =? order by department,departmentUnit																										
#End:Sheeldarshi:07-Nov-2014:Enquiry Changes
									          									
//---------------------------------------------HOSPITAL_ENQUIRY-------------------------------------------------------
									          									
SELECT.GBLT_HOSPITAL_MST=SELECT NVL (gstr_hospital_name, '') AS hospitalname,NVL (gstr_hosp_short_name, '') AS hospitalShortName,NVL (gstr_hospital_add1, '') AS address1,NVL (gstr_hospital_add2, ' ') AS address2, NVL (gstr_city, ' ') AS city, \
				         NVL (gnum_state_code, 0) AS stateCode,(SELECT nvl(gstr_state_name,'')  FROM gblt_state_mst WHERE gnum_state_code = a.gnum_state_code  AND gnum_hospital_code = a.gnum_hospital_code) as state, \
				         NVL (gstr_phone, ' ') AS phone,NVL (gstr_fax, ' ') AS fax, gstr_email as email, gstr_contact_person as contactPerson,gnum_hospital_type as hospitalTypeCode, \
				         DECODE (gnum_hospital_type,1, 'Govt Hospital',2, 'Dispensary',3, 'Private Hospital',4,'Nursing Home',' ') AS hospitalTypeName, gstr_busroutes_no as busRouteNo, \
				         NVL (gstr_bed_capacity, ' ') AS bedcapacity,NVL (gstr_weekdays_timing, ' ') AS weekdaytimings,NVL (gstr_sat_timing, ' ') AS saturdayTimings, NVL (gstr_lunch_break, ' ') AS lunchtimings \
				         FROM gblt_hospital_mst  a  WHERE gnum_hospital_code = ? and GNUM_ISVALID=?
				         
				         
				         
SELECT_REG_TIMINGS.HRGT_REG_CAT_TIMINGS=SELECT  gnum_reg_cat_code || '#' || DECODE (gnum_reg_cat_code,11, 'Normal',12, 'Special',13, 'Casuality','' ) AS regcategorycode, \
			         DECODE (gnum_reg_cat_code,11, 'Normal',12, 'Special',13, 'Casuality','') AS regcategorydesc,\
			         hrgnum_season_code || '#' || (SELECT    hrgstr_season_desc  || '( '  || hrgdt_season_frm_dt || '  To  ' || hrgdt_season_to_dt  || ' )'  FROM hrgt_reg_season_mst \
			         WHERE hrgnum_season_code = a.hrgnum_season_code  AND gnum_hospital_code = ?  AND gnum_isvalid = ?) AS seasoncode, \
			         (SELECT    hrgstr_season_desc  || '( '  || hrgdt_season_frm_dt || ' To ' || hrgdt_season_to_dt || ' )'  FROM hrgt_reg_season_mst  WHERE hrgnum_season_code = a.hrgnum_season_code \
			          AND gnum_hospital_code = ?  AND gnum_isvalid = ?) AS seasondesc,hgnum_shift_code || '#'  || (SELECT     hopstr_start_time || ' To ' || hopstr_end_time   \
			          FROM gblt_shift_mst  WHERE hgnum_shift_code = a.hgnum_shift_code  AND gnum_isvalid = ?  AND gnum_hospital_code = ?) AS shiftcode, \
			          (SELECT    hrgstr_shift_desc || '( ' || hopstr_start_time  || ' To ' || hopstr_end_time  || ' )'  FROM gblt_shift_mst  WHERE hgnum_shift_code = a.hgnum_shift_code  \
			          AND gnum_isvalid = ?   AND gnum_hospital_code = ?) AS shiftdesc,gnum_week_day AS weekdaycode,\
			          DECODE (gnum_week_day,1, 'Sun',2,'Mon',3, 'Tue',4, 'Wed',5, 'Thu',6, 'Fri',7, 'Sat','' ) AS weekday \
			          FROM hrgt_reg_cat_timings a   WHERE gnum_hospital_code =?  AND gnum_isvalid =?  AND gnum_slno = \
	                  ( SELECT MAX (gnum_slno)  FROM hrgt_reg_cat_timings   WHERE gnum_hospital_code = a.gnum_hospital_code  AND gnum_reg_cat_code = a.gnum_reg_cat_code  AND hrgnum_season_code = a.hrgnum_season_code   AND gnum_week_day = a.gnum_week_day   AND hgnum_shift_code = a.hgnum_shift_code \
	                  AND gnum_isvalid =a.gnum_isvalid )    ORDER BY regcategorycode, seasoncode, shiftcode, weekdaycode 
				      								          									
									          									


//---------------------------------------OPD_SCHEDULE_ENQUIRY_QUERY------------------------------------------------

SELECT.ALL_DEPARTMENT_FOR_OPD_SCHEDULE.GBLT_DEPARTMENT_MST	=	SELECT gnum_dept_code departmentcode, gstr_dept_name department,(decode((SELECT distinct SUBSTR(hgnum_deptunitcode,1,3)FROM hopt_dept_unit_roster_mst b \
         											WHERE SUBSTR (hgnum_deptunitcode, 1, 3) = GNUM_DEPT_CODE AND gnum_hospital_code = a.gnum_hospital_code AND gnum_isvalid = a.gnum_isvalid AND hopnum_day_of_week=TO_CHAR (SYSDATE, 'D') and HOPNUM_WEEK_OF_MONTH=1 \
													and HGNUM_DEPTUNITCODE in (select HGNUM_DEPTUNITCODE from hgbt_unit_mst where hgnum_isgeneral NOT IN (2, 3) AND TO_DATE (gdt_effective_frm, 'dd-Mon-yyyy') <= SYSDATE \
                      								AND NVL (TO_DATE (gdt_effective_to, 'dd-Mon-yyyy'),SYSDATE) >= SYSDATE)	\
													),null,0,1))deptunitisonduty FROM GBLT_DEPARTMENT_MST a WHERE gnum_dept_type = 1 \
													AND a.gnum_isvalid in(?,?) AND a.gnum_hospital_code = ? AND TO_DATE (gdt_effective_frm, 'dd-Mon-yyyy') <= SYSDATE AND NVL (TO_DATE (gdt_effective_to, 'dd-Mon-yyyy'), SYSDATE) >= \
													SYSDATE AND gnum_dept_code IN (SELECT hgnum_dept_code FROM hgbt_unit_mst  WHERE gnum_isvalid = a.gnum_isvalid  and gnum_hospital_code=a.gnum_hospital_code and HGNUM_ISGENERAL=1 AND TO_DATE (gdt_effective_frm, 'dd-Mon-yyyy') <= SYSDATE \
													AND NVL (TO_DATE (gdt_effective_to, 'dd-Mon-yyyy'),SYSDATE) >= SYSDATE) ORDER BY department
													
SELECT.SPECIAL_CLINIC_DEPT.GBLT_DEPARTMENT_MST	= SELECT b.HGNUM_DEPT_CODE departmentCode ,hgstr_unitname departmentUnit,HGNUM_DEPTUNITCODE departmentUnitCode,unitDays(b.hgnum_deptunitcode,b.gnum_hospital_code)unitDays,substr(to_char(sysdate,'Day'),1,3)today, \
											(select GSTR_DEPT_NAME from gblt_department_mst where GNUM_DEPT_CODE=b.HGNUM_DEPT_CODE and gnum_isvalid=b.gnum_isvalid and gnum_hospital_code=b.gnum_hospital_code  AND trunc(b.gdt_effective_frm) <= SYSDATE \
            								AND NVL (trunc(b.gdt_effective_to), SYSDATE) >=TRUNC (SYSDATE)) department FROM hgbt_unit_mst b WHERE b.gnum_isvalid in (?,?) AND hgnum_isgeneral =2 AND b.gnum_hospital_code = ? AND TO_DATE (b.gdt_effective_frm, 'dd-Mon-yyyy') <= SYSDATE \
											AND NVL (TO_DATE (b.gdt_effective_to, 'dd-Mon-yyyy'), SYSDATE) >= trunc(SYSDATE) ORDER BY departmentUnit 

SELECT.ROOM_BY_DEPT.HRGT_DEPT_UNIT_ROOM_MST	=	SELECT a.hgnum_deptunitcode departmentUnitCode,(SELECT distinct hgstr_room_name FROM hgbt_room_mst WHERE hgnum_room_code = a.hgnum_room_code AND gnum_hospital_code = a.gnum_hospital_code \
										AND gnum_isvalid = a.gnum_isvalid ) AS room FROM hrgt_dept_unit_room_mst a,HGBT_UNIT_MST b WHERE a.hgnum_deptunitcode = b.hgnum_deptunitcode AND a.gnum_isvalid = ? \
										AND a.gnum_hospital_code = ? and b.HGNUM_DEPT_CODE=? AND a.gnum_hospital_code = b.gnum_hospital_code order by A.hgnum_deptunitcode 
																					          									
																					          									
SELECT.UNIT_WORKING_DETAIL.HGBT_UNIT_MST	=SELECT b.hgnum_deptunitcode departmentUnitCode, hgstr_unitname departmentUnit, b.HGNUM_DEPT_CODE departmentCode, unitdays (b.hgnum_deptunitcode,b.gnum_hospital_code) unitDays,GSTR_DEPT_NAME department, \
									SUBSTR (TO_CHAR (SYSDATE, 'Day'), 1, 3) today,(SELECT str_first_name || ' ' || str_middle_name || ' '|| str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = c.gstr_hod_code \
									AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = b.gnum_isvalid) AS hod FROM hgbt_unit_mst b, gblt_department_mst c  WHERE  b.HGNUM_DEPT_CODE=c.GNUM_DEPT_CODE \
									AND c.gnum_hospital_code = b.gnum_hospital_code AND TO_DATE (b.gdt_effective_frm, 'dd-Mon-yyyy') <= TRUNC (SYSDATE) AND hgnum_isgeneral NOT IN (2, 3) AND c.gnum_isvalid=? AND c.gnum_hospital_code=? \
									and HGNUM_DEPT_CODE = ? AND NVL (TO_DATE (b.gdt_effective_to, 'dd-Mon-yyyy'), SYSDATE) >= TRUNC (SYSDATE) and b.gnum_isvalid=c.gnum_isvalid ORDER BY departmentunit
																												          									
SELECT.SPECIAL_CLINIC_WORKING_DETAIL.HGBT_UNIT_MST_OLD	=SELECT  b.hgnum_deptunitcode departmentUnitCode,hgstr_unitname departmentUnit, b.HGNUM_DEPT_CODE departmentCode,GSTR_DEPT_NAME department,unitDays (b.hgnum_deptunitcode, \
									b.gnum_hospital_code) unitDays,SUBSTR (TO_CHAR (SYSDATE, 'Day'), 1, 3) today,(SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_personnel_dtl \
									WHERE str_emp_no = c.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod FROM hgbt_unit_mst b, \
									gblt_department_mst c WHERE b.HGNUM_DEPT_CODE =GNUM_DEPT_CODE AND b.gnum_isvalid = ?	AND b.gnum_isvalid = c.gnum_isvalid \
									AND b.gnum_hospital_code = ? AND b.hgnum_deptunitcode = ? AND b.gnum_hospital_code = c.gnum_hospital_code AND TO_DATE (b.gdt_effective_frm, 'dd-Mon-yyyy') <= \
									TRUNC (SYSDATE) AND NVL (TO_DATE (b.gdt_effective_to, 'dd-Mon-yyyy'), SYSDATE) >= TRUNC (SYSDATE) and b.gnum_isvalid=c.gnum_isvalid  ORDER BY departmentunit

SELECT.SPECIAL_CLINIC_WORKING_DETAIL.HGBT_UNIT_MST	=SELECT  b.hgnum_deptunitcode departmentUnitCode,hgstr_unitname departmentUnit, b.HGNUM_DEPT_CODE departmentCode,GSTR_DEPT_NAME department,unitDays (b.hgnum_deptunitcode, \
									b.gnum_hospital_code) unitDays,SUBSTR (TO_CHAR (SYSDATE, 'Day'), 1, 3) today,(SELECT str_first_name || ' ' || str_middle_name || ' ' || str_last_name FROM pist_emp_entry_dtl \
									WHERE str_emp_no = c.gstr_hod_code AND gnum_hospital_code = b.gnum_hospital_code AND gnum_isvalid = 1) AS hod FROM hgbt_unit_mst b, \
									gblt_department_mst c WHERE b.HGNUM_DEPT_CODE =GNUM_DEPT_CODE AND b.gnum_isvalid = ?	AND b.gnum_isvalid = c.gnum_isvalid \
									AND b.gnum_hospital_code = ? AND b.hgnum_deptunitcode = ? AND b.gnum_hospital_code = c.gnum_hospital_code AND TO_DATE (b.gdt_effective_frm, 'dd-Mon-yyyy') <= \
									TRUNC (SYSDATE) AND NVL (TO_DATE (b.gdt_effective_to, 'dd-Mon-yyyy'), SYSDATE) >= TRUNC (SYSDATE) and b.gnum_isvalid=c.gnum_isvalid  ORDER BY departmentunit

//-----------------------------------------------TELEPHONE_ENQUIRY-------------------------------------------------
#start:Sheeldarshi:05-Nov-2014:Enquiry changes

#SELECT.TELEPHONE_DETAIL.PIST_EMP_ENTRY_DTL= SELECT str_emp_no, trim(initcap(str_first_name||' '||str_middle_name||' '||str_last_name)) employeename,\hrgstr_contact_no telephoneno,str_middle_name,str_last_name \FROM 	pist_emp_entry_dtl a \WHERE 	gnum_isvalid = ? \AND 	gnum_hospital_code = ? \ORDER BY employeename
SELECT.TELEPHONE_DETAIL.PIST_EMP_REGISTRATION_DTL= SELECT 	str_emp_no, trim(initcap(str_emp_full_name)) employeename,\
												num_mobile_no telephoneno \
											  FROM 	pist_emp_registration_dtl a \
											 WHERE 	gnum_isvalid = ? \
											   AND 	gnum_hospital_code = ? \
											 ORDER BY employeename 
 #End:Sheeldarshi:05-Nov-2014:Enquiry changes
SELECT.TELEPHONE_DETAIL_OF_DEPT.EST_TELEPHONE_MST	=	SELECT str_department departmentCode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.str_department AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.num_hospital_code \
												AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE))department,(SELECT str_telephone_no \
												FROM EST_TELEPHONE_MST WHERE a.num_telephone_id = num_telephone_id and NUM_HOSPITAL_CODE=a.num_hospital_code  AND TRUNC (gdt_effective_frm) <= SYSDATE \
												AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE) and (GNUM_ISVALID=1 or GNUM_ISVALID=2)) telephoneNo FROM est_telephone_allotment_dtl a where gnum_isvalid=? and num_hospital_code=? and STR_ALLOTMENT_TYPE='D' order by department 
												 
SELECT.TELEPHONE_DETAIL.EST_TELEPHONE_MST	=	SELECT  str_department departmentcode,(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.str_department AND gnum_isvalid = a.gnum_isvalid \
             									AND gnum_hospital_code = a.num_hospital_code AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE)) \
             									department,str_employee_no,nvl2(STR_DEPARTMENT, STR_DEPARTMENT,str_allotee_name)employeename,(SELECT str_telephone_no FROM est_telephone_mst WHERE a.num_telephone_id = num_telephone_id \
             									AND num_hospital_code = a.num_hospital_code AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE) \
             									AND (gnum_isvalid = 1 OR gnum_isvalid = 2)) telephoneno FROM est_telephone_allotment_dtl a WHERE gnum_isvalid = ?  AND num_hospital_code = ? \
	 											and num_telephone_id in (select num_telephone_id from  est_telephone_mst WHERE a.num_telephone_id = num_telephone_id AND num_hospital_code = a.num_hospital_code \
             									AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE) AND (gnum_isvalid = 1 OR gnum_isvalid = 2) and NUM_IS_IMPORTANT=?) \
 												ORDER BY employeename
												
SELECT.TELEPHONE_DETAIL_OF_EMP.EST_TELEPHONE_MST	=	SELECT STR_EMPLOYEE_NO,STR_ALLOTEE_NAME employeeName,(SELECT str_telephone_no FROM est_telephone_mst WHERE a.num_telephone_id = num_telephone_id and NUM_HOSPITAL_CODE=a.num_hospital_code  AND \
											TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE) and (GNUM_ISVALID=1 or GNUM_ISVALID=2)) telephoneNo FROM est_telephone_allotment_dtl a \
											where gnum_isvalid=? and num_hospital_code=? and  STR_ALLOTMENT_TYPE='E' order by employeeName
											
//-----------------------------------------------------OT_LOCATION_ENQUIRY-------------------------------------------
											
SELECT.ALL_OPERATION_THEATER.HOTT_OPERATION_THEATER_MST	=	SELECT hotnum_theater_code theatercode,(SELECT hotstr_operation_type  FROM hott_operation_type_mst  WHERE hotnum_operation_type_code =  a.hotnum_operation_type_code AND gnum_isvalid = a.gnum_isvalid \
												AND gnum_hospital_code = a.gnum_hospital_code) operationtype, hotnum_operation_type_code operationTypeCode, hotstr_theater_name theatername, gnum_dept_code departmentCode, (SELECT gstr_dept_name FROM gblt_department_mst \
												WHERE gnum_dept_code = a.gnum_dept_code AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND TRUNC (gdt_effective_frm) \
												<= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE)) department,(SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_room_id = a.NUM_ROOM_ID \
             									AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY'))AND gnum_isvalid > 0) AS locationroom,(SELECT STR_FLOOR_NAME FROM est_floor_mst \
           										WHERE num_hospital_code = a.gnum_hospital_code AND num_floor_id = a.num_floor_id AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) \
									             AND gnum_isvalid > 0) AS locationfloor,(SELECT str_block_name  FROM est_block_mst  WHERE num_hospital_code = a.gnum_hospital_code AND num_block_id = a.num_block_id \
									             AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationblock, (SELECT str_building_name \
									             FROM est_building_mst WHERE num_hospital_code = a.gnum_hospital_code AND num_building_code = a.num_building_code AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
										         TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationbuilding,hotstr_theater_name||' ('||(SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code AND gnum_isvalid = a.gnum_isvalid \
										         AND gnum_hospital_code = a.gnum_hospital_code AND TRUNC (gdt_effective_frm) <= SYSDATE AND NVL (TRUNC (gdt_effective_to), SYSDATE) >= TRUNC (SYSDATE))||')' theaternameDept FROM hott_operation_theater_mst a WHERE a.gnum_isvalid = ? \
										         AND a.gnum_hospital_code = ? order by hotnum_operation_type_code,theaternamedept
												
//---------------------------------------------Query_for_Hospital_Facility_Master----------------------------------------

SELECT.ALL.HGBT_HOSPITAL_FACILITY_MST	=	select HGNUM_FACILITY_ID||'#'|| GNUM_HOSPITAL_CODE||'#'||HRGNUM_SLNO facilityId ,HGSTR_FACILITY_NAME facilityName, rtrim(HGSTR_FACILITY_DESC,'#') facilityDesc,HGNUM_DISPLAY_ORDER displayOrder from HGBT_HOSPITAL_FACILITY_MST where GNUM_HOSPITAL_CODE=? and  GNUM_ISVALID=? order by displayOrder 

INSERT.HGBT_HOSPITAL_FACILITY_MST	= insert into hgbt_hospital_facility_mst(HGNUM_FACILITY_ID, GNUM_HOSPITAL_CODE, HRGNUM_SLNO,HGSTR_FACILITY_NAME, HGNUM_DESC_TYPE, HGSTR_FACILITY_DESC, HGNUM_ISEMERGENCY_SERVICES, \
									HGNUM_DISPLAY_ORDER, HGNUM_ISLOCATION_SPECIFIC, GNUM_ISVALID, HGSTR_LOCATION_QUERY,GNUM_SEAT_ID, GDT_ENTRY_DATE) values((select  \
									nvl(max(HGNUM_FACILITY_ID),10)+1 from hgbt_hospital_facility_mst where gnum_hospital_code=?),?,1,?,?,?,?,(select nvl(max(hgnum_display_order),0)+1 from hgbt_hospital_facility_mst where gnum_isvalid<> 0),?,?,?,?,sysdate)
									
UPDATE.HGBT_HOSPITAL_FACILITY_MST	=	update HGBT_HOSPITAL_FACILITY_MST set  GNUM_ISVALID=?, GDT_LSTMOD_DATE=sysdate, GNUM_LSTMOD_SEATID=? where HGNUM_FACILITY_ID=? and  GNUM_HOSPITAL_CODE=? and HRGNUM_SLNO=(select max(HRGNUM_SLNO) from HGBT_HOSPITAL_FACILITY_MST where HGNUM_FACILITY_ID=? and  GNUM_HOSPITAL_CODE=?)

MODIFY.INSERT.HGBT_HOSPITAL_FACILITY_MST	= insert into hgbt_hospital_facility_mst (HGNUM_FACILITY_ID, GNUM_HOSPITAL_CODE, HRGNUM_SLNO,HGSTR_FACILITY_NAME, HGNUM_DESC_TYPE, HGSTR_FACILITY_DESC, HGNUM_ISEMERGENCY_SERVICES, \
									HGNUM_DISPLAY_ORDER, HGNUM_ISLOCATION_SPECIFIC, GNUM_ISVALID, HGSTR_LOCATION_QUERY,GNUM_SEAT_ID, GDT_ENTRY_DATE) values(?,?,(select  \
									max(HRGNUM_SLNO)+1 from hgbt_hospital_facility_mst where gnum_hospital_code=? and HGNUM_FACILITY_ID=?),?,?,?,?,?,?,?,?,?,sysdate)
									
SELECT.HGBT_HOSPITAL_FACILITY_MST	=	SELECT hgstr_facility_name facilityName, hgnum_desc_type facilityDescType, hgstr_facility_desc facilityDesc, hgnum_isemergency_services isEmergencyService , hgnum_display_order displayOrder, \
									hgnum_islocation_specific isLocationSpecific, gnum_isvalid isValid, hgstr_location_query locationQuery FROM hgbt_hospital_facility_mst where HGNUM_FACILITY_ID=? and GNUM_HOSPITAL_CODE=? and HRGNUM_SLNO=?
									

CHANGE_DISPLAY_ORDER.HGBT_HOSPITAL_FACILITY_MST	=	update hgbt_hospital_facility_mst  set HGNUM_DISPLAY_ORDER=? where hgnum_facility_id=? and gnum_hospital_code=? and hrgnum_slno=?

//----------------------------------------------HOSPITAL_CHARGE_ENQUIRY------------------------------------------------

SELECT.ALL_TARIFF.HBLT_TARIFF_MST	=	select HBLNUM_TARIFF_ID tariffId, SBLNUM_SERVICE_ID, HBLSTR_TARIFF_NAME tariffName,HBLNUM_GROUP_ID groupId,(select HBLSTR_GROUP_NAME from HBLT_GROUP_MST where hblnum_group_id =a.hblnum_group_id  and trunc(GDT_EFFECTIVE_FRM)<=trunc(sysdate) and \
										GNUM_ISVALID=a.gnum_isvalid and GNUM_HOSPITAL_CODE=a.GNUM_HOSPITAL_CODE)groupName from HBLT_TARIFF_MST a where GNUM_HOSPITAL_CODE=? and gnum_isvalid=? and HBLNUM_GROUP_ID like ? and trunc(GDT_EFFECTIVE_FRM) <= trunc(sysdate) order by HBLSTR_TARIFF_NAME

SELECT.GROUP_NAME.HBLT_GROUP_MST	=	select HBLNUM_GROUP_ID, HBLSTR_GROUP_NAME from HBLT_GROUP_MST where GNUM_HOSPITAL_CODE=? and gnum_isvalid=? and trunc(GDT_EFFECTIVE_FRM) <= trunc(sysdate) order by HBLSTR_GROUP_NAME

SELECT.CHARGE_TYPE.SBLT_CHARGETYPE_MST	=	select a.SBLNUM_CHARGETYPE_ID, decode(sblstr_ipd_chargetype_name,null,sblstr_chargetype_name,(sblstr_chargetype_name || ' ('|| NVL (sblstr_ipd_chargetype_name , ' ') ||')')) \
											from SBLT_CHARGETYPE_MST a,sblt_ipd_chargetype_mst b where a.GNUM_HOSPITAL_CODE=100 and b.GNUM_HOSPITAL_CODE=? and a.GNUM_ISVALID=? and a.sblnum_chargetype_id=b.sblnum_chargetype_id(+) order by a.SBLNUM_CHARGETYPE_ID			

SELECT.CHARGE_DETAIL.BY_TARIFF.HBLT_CHARGE_MST	=	SELECT hblnum_tariff_id tariffId,(SELECT hblstr_tariff_name FROM hblt_tariff_mst WHERE hblnum_tariff_id = a.hblnum_tariff_id AND gnum_hospital_code=a.gnum_hospital_code AND gnum_isvalid=1) tariffName, gnum_patient_cat_code patCatCode, sblnum_chargetype_id||'|'||sblnum_ipd_chargetype_id chargeTypeId, \
												(SELECT sblstr_chargetype_name FROM sblt_chargetype_mst WHERE sblnum_chargetype_id = a.sblnum_chargetype_id AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code=a.gnum_hospital_code AND gnum_isvalid=1) chargetype,hblnum_cost charge, (SELECT gstr_patient_cat_name ||' ('||decode(GNUM_PATIENT_CAT_TYPE,0,'P',1,'T')||')'\
												FROM gblt_patient_cat_mst WHERE gnum_patient_cat_code = a.gnum_patient_cat_code AND gnum_hospital_code = 100 AND gnum_isvalid = a.gnum_isvalid AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND \
												TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE)) patcat, sblnum_ipd_chargetype_id ipdChargeTypeId,(SELECT sblstr_ipd_chargetype_name FROM sblt_ipd_chargetype_mst WHERE sblnum_ipd_chargetype_id = \
												a.sblnum_ipd_chargetype_id AND gnum_isvalid = a.gnum_isvalid AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND gnum_hospital_code=a.gnum_hospital_code AND gnum_isvalid=1) ipdchargetype FROM hblt_charge_mst a WHERE gnum_hospital_code = ? AND gnum_isvalid = ? \
												AND hblnum_tariff_id = ? AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) ORDER BY gnum_patient_cat_code, sblnum_chargetype_id,sblnum_ipd_chargetype_id			 							
 
//--------------------------------------------HOSPITAL_LAB_ENQUIRY------------------------------------------------------

SELECT.ALL_LABORATORY_LIST.GBLT_LABORATORY_MST1	=	SELECT gnum_lab_code labcode, a.gnum_dept_code departmentcode, (SELECT gstr_dept_name  FROM gblt_department_mst WHERE gnum_isvalid = a.gbl_isvalid \
											AND gnum_hospital_code = a.gnum_hospital_code AND gnum_dept_code = a.gnum_dept_code AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
											TO_DATE (SYSDATE, 'DD-MM-YY'))) department, gstr_lab_name labname,DECODE (gnum_lab_type, 'R', 'Routine', 'E', 'Emergency') labtype FROM gblt_laboratory_mst a \
											WHERE a.gnum_hospital_code = ? AND gbl_isvalid = ? AND a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
											TO_DATE (SYSDATE, 'DD-MM-YY'))order by labName


SELECT.ALL_LABORATORY_LIST.GBLT_LABORATORY_MST	=	SELECT gnum_lab_code labcode, a.gnum_dept_code departmentcode,b.gstr_dept_name department, gstr_lab_name labname,DECODE (gnum_lab_type, 'R', 'Routine', 'E', 'Emergency') labtype FROM gblt_laboratory_mst a,gblt_department_mst b \
											WHERE a.gnum_hospital_code = ? AND a.gnum_hospital_code = b.gnum_hospital_code AND gbl_isvalid = ? AND a.gbl_isvalid = b.gnum_isvalid AND a.gnum_dept_code = b.gnum_dept_code AND a.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (a.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
											TO_DATE (SYSDATE, 'DD-MM-YY'))order by labName	
																						
SELECT.TESTS.GBLT_TEST_MST_OLD	=	SELECT  gstr_test_name testname,gstr_lab_name labName, \
								SUBSTR (a.gnum_lab_test_code, 6, 10) testcode, (SELECT str_first_name|| ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = c.gnum_lab_incharge \
								AND gnum_hospital_code = gnum_hospital_code AND gnum_isvalid = 1) labincharge,b.GSTR_REMARKS preRequisite,GSTR_TURNAROUND_TIME timeRequired,GCHAR_TEST_DAY testDay FROM hivt_laboratory_test_dtl a, gblt_laboratory_mst c,gblt_test_mst b \
								WHERE SUBSTR (a.gnum_lab_test_code, 1, 5) = ? and gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 10) AND SUBSTR (a.gnum_lab_test_code, 1, 5) = c.gnum_lab_code \
								AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gbl_isvalid = a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \
								AND b.gnum_isvalid = a.gnum_isvalid AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) ORDER BY testname		

SELECT.TESTS.GBLT_TEST_MST1	=	SELECT  gstr_test_name testname,gstr_lab_name labName, \
								SUBSTR (a.gnum_lab_test_code, 6, 10) testcode, (SELECT str_first_name|| ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = c.gnum_lab_incharge \
								AND gnum_hospital_code = gnum_hospital_code AND gnum_isvalid = 1) labincharge,b.GSTR_REMARKS preRequisite,GSTR_TURNAROUND_TIME timeRequired,GCHAR_TEST_DAY testDay FROM hivt_laboratory_test_dtl a, gblt_laboratory_mst c,gblt_test_mst b \
								WHERE SUBSTR (a.gnum_lab_test_code, 1, 5) = ? and gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 10) AND SUBSTR (a.gnum_lab_test_code, 1, 5) = c.gnum_lab_code \
								AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gbl_isvalid = a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \
								AND b.gnum_isvalid = a.gnum_isvalid AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) ORDER BY testname

#Start:Sheeldarshi:07-Nov-2014:Enquiry Changes								
#SELECT.TESTS.GBLT_TEST_MST	=	SELECT  gstr_test_name testname,gstr_lab_name labName, \								SUBSTR (a.gnum_lab_test_code, 6, 10) testcode, (SELECT str_first_name|| ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = c.gnum_lab_incharge \								AND gnum_hospital_code = gnum_hospital_code AND gnum_isvalid = 1 \								AND GNUM_SLNO_MAIN=(Select max(GNUM_SLNO_MAIN) \                                from pist_emp_personnel_dtl \                                WHERE str_emp_no = c.gnum_lab_incharge \                                AND gnum_hospital_code = gnum_hospital_code \                                AND gnum_isvalid = 1)) labincharge,b.GSTR_REMARKS preRequisite,GSTR_TURNAROUND_TIME timeRequired,GCHAR_TEST_DAY testDay FROM hivt_laboratory_test_dtl a, gblt_laboratory_mst c,gblt_test_mst b \								WHERE SUBSTR (a.gnum_lab_test_code, 1, 5) = ? and gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 10) AND SUBSTR (a.gnum_lab_test_code, 1, 5) = c.gnum_lab_code \								AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gbl_isvalid = a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \								AND b.gnum_isvalid = a.gnum_isvalid AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) ORDER BY testname
#employee detail fetch from pist_emp_entry_dtl table
SELECT.TESTS.GBLT_TEST_MST1	=	SELECT  gstr_test_name testname,gstr_lab_name labName, \
								SUBSTR (a.gnum_lab_test_code, 6, 10) testcode, (SELECT str_first_name|| ' ' || str_middle_name|| ' ' || str_last_name FROM pist_emp_entry_dtl WHERE str_emp_no = c.gnum_lab_incharge \
								AND gnum_hospital_code = c.gnum_hospital_code AND gnum_isvalid = 1 \
								AND GNUM_SLNO_MAIN=(Select max(GNUM_SLNO_MAIN) \
                                from pist_emp_entry_dtl \
                                WHERE str_emp_no = c.gnum_lab_incharge \
                                AND gnum_hospital_code = c.gnum_hospital_code \
                                AND gnum_isvalid = 1)) labincharge,b.GSTR_REMARKS preRequisite,GSTR_TURNAROUND_TIME timeRequired,GCHAR_TEST_DAY testDay FROM hivt_laboratory_test_dtl a, gblt_laboratory_mst c,gblt_test_mst b \
								WHERE SUBSTR (a.gnum_lab_test_code, 1, 5) = ? and gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 10) AND SUBSTR (a.gnum_lab_test_code, 1, 5) = c.gnum_lab_code \
								AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gbl_isvalid = a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \
								AND b.gnum_isvalid = a.gnum_isvalid AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) ORDER BY testname
#employee detail fetch from pist_emp_registration_dtl table								
SELECT.TESTS.GBLT_TEST_MST	=	SELECT  gstr_test_name testname,gstr_lab_name labName, \
								SUBSTR (a.gnum_lab_test_code, 6, 10) testcode, (SELECT str_emp_full_name FROM pist_emp_registration_dtl WHERE str_emp_no = c.gnum_lab_incharge \
								AND gnum_hospital_code = c.gnum_hospital_code AND gnum_isvalid = 1 \
								AND NUM_REC_SLNO=(Select max(NUM_REC_SLNO) \
                                from pist_emp_registration_dtl \
                                WHERE str_emp_no = c.gnum_lab_incharge \
                                AND gnum_hospital_code = c.gnum_hospital_code \
                                AND gnum_isvalid = 1)) labincharge,b.GSTR_REMARKS preRequisite,GSTR_TURNAROUND_TIME timeRequired,GCHAR_TEST_DAY testDay FROM hivt_laboratory_test_dtl a, gblt_laboratory_mst c,gblt_test_mst b \
								WHERE SUBSTR (a.gnum_lab_test_code, 1, 5) = ? and gnum_test_code = SUBSTR (a.gnum_lab_test_code, 6, 10) AND SUBSTR (a.gnum_lab_test_code, 1, 5) = c.gnum_lab_code \
								AND a.gnum_hospital_code = ? AND a.gnum_isvalid = ? AND c.gnum_hospital_code = a.gnum_hospital_code AND c.gbl_isvalid = a.gnum_isvalid AND b.gnum_hospital_code = a.gnum_hospital_code \
								AND b.gnum_isvalid = a.gnum_isvalid AND b.gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (b.gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) ORDER BY testname								
#End:Sheeldarshi:07-Nov-2014:Enquiry Changes										
								
//----------------------------------------------OT_CONSULTANT_ENQUIRY---------------------------------------------------										
SELECT.OT_CONSULTANT.HOTT_SURGEON_ROSTER_MST	=	SELECT distinct gnum_dept_code departmentCode, (SELECT gstr_dept_name FROM gblt_department_mst WHERE gnum_dept_code = a.gnum_dept_code \
										AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code AND gdt_effective_frm <= TRUNC (SYSDATE) \
										AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE))department,(SELECT hgstr_unitname FROM hgbt_unit_mst WHERE hgnum_deptunitcode = \
										a.GNUM_DEPTUNIT_CODE AND gdt_effective_frm <= TRUNC (SYSDATE) AND NVL (gdt_effective_to, SYSDATE + 1) >= TRUNC (SYSDATE) \
										AND gnum_isvalid = a.gnum_isvalid AND gnum_hospital_code = a.gnum_hospital_code) departmentunit,gnum_deptunit_code departmentUnitCode, \
										(SELECT    str_first_name|| ' '|| str_middle_name|| ' ' || str_last_name FROM pist_emp_personnel_dtl WHERE str_emp_no = a.pstr_emp_no and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) consultantName,PSTR_EMP_NO empNo, \
										(SELECT str_desig_name FROM pist_emp_cur_detail_dtl b, gblt_designation_mst_clinical c  WHERE b.num_desig_id = c.num_desig_id \
										AND a.pstr_emp_no = b.str_emp_no AND b.gnum_hospital_code=A.gnum_hospital_code and c.gnum_hospital_code=a.gnum_hospital_code) designation FROM hott_surgeon_roster_mst a  WHERE gnum_isvalid = ? AND TO_DATE (hotdt_effective_date, 'dd-mm-yyyy') <= \
										TO_DATE (SYSDATE, 'dd-mm-yyyy') AND gnum_hospital_code = ?
										
SELECT.CONSULTANT_DETAIL.HOTT_SURGEON_ROSTER_MST	=	SELECT  gnum_dept_code departmentCode, gnum_deptunit_code departmentUnitCode, hotnum_dow,SUBSTR (HOTNUM_WOM,1,1), DECODE (hotnum_dow, 1, 'Mon',2, 'Tue', \
										3, 'Wed',4, 'Thu', 5, 'Fri',6, 'Sat',  7, 'Sun') day,hotnum_wom, pstr_emp_no empNo, (SELECT str_first_name  || ' '|| str_middle_name|| ' '|| str_last_name \
										FROM pist_emp_personnel_dtl WHERE str_emp_no = a.pstr_emp_no and gnum_hospital_code=a.gnum_hospital_code and gnum_isvalid=1) consultantName,(SELECT str_desig_name FROM pist_emp_cur_detail_dtl b, gblt_designation_mst_clinical c \
										WHERE b.num_desig_id = c.num_desig_id AND a.pstr_emp_no = b.str_emp_no AND b.gnum_hospital_code=A.gnum_hospital_code and c.gnum_hospital_code=a.gnum_hospital_code) designation FROM hott_surgeon_roster_mst a WHERE gnum_isvalid = ? AND TO_DATE (hotdt_effective_date, 'dd-mm-yyyy') <= \
										TO_DATE (SYSDATE, 'dd-mm-yyyy') AND gnum_hospital_code = ?  AND pstr_emp_no = ?  AND SUBSTR (HOTNUM_WOM,1,1) = 1

SELECT.OT_CONSULTANT_WORKING_DAYS.HOTT_SURGEON_ROSTER_MST =	SELECT  DECODE (hotnum_dow, 1, 'Mon', 2, 'Tue', 3, 'Wed',  4, 'Thu',  5, 'Fri',  6, 'Sat', 7, 'Sun') AS DAY, pstr_emp_no empno, \
													hotnum_dow FROM hott_surgeon_roster_mst a WHERE gnum_isvalid = ? AND TO_DATE (hotdt_effective_date, 'dd-mm-yyyy') <= TO_DATE (SYSDATE, 'dd-mm-yyyy') \
													AND gnum_hospital_code = ?  AND SUBSTR (hotnum_wom, 1, 1) = 1	order by empno,hotnum_dow 

//-----------------------------------------------HOLIDAY_ENQUIRY----------------------------------------------------										
SELECT.HOLIDAY.PIST_HOLIDAY_MST	=	SELECT num_holiday_id holidayId, str_holiday_name holidayName, DECODE (str_holiday_type, 'C', 'Compulsory', 'R', 'Restricted') holidayType,str_day, TO_CHAR (dt_holiday_date, 'dd-Mon-yyyy') holidayDate,initcap(to_char(dt_holiday_date,'day')) AS day \
									FROM pist_holiday_mst a WHERE gnum_hospital_code = ? AND gnum_isvalid = ?  AND gnum_slno = (SELECT MAX (gnum_slno) FROM pist_holiday_mst WHERE a.num_holiday_id = num_holiday_id \
									AND a.gnum_hospital_code = gnum_hospital_code) AND num_year LIKE ? AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) \
									ORDER BY dt_holiday_date, str_holiday_type
									
SELECT.YEAR.PIST_HOLIDAY_MST	=select distinct NUM_YEAR from pist_holiday_mst			
//----------------------------------------------GUEST_HOUSE_ENQUIRY----------------------------------------------------

SELECT.GUEST_HOUSE.EST_GUEST_HOUSE_MST	=	SELECT num_guest_house_id guestHouse, (SELECT STR_ROOM_NAME FROM est_room_mst WHERE num_hospital_code = a.num_hospital_code AND num_room_id = a.num_room_id AND gdt_effective_frm <= SYSDATE \
						AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >=TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationroom, (SELECT STR_FLOOR_NAME \
						FROM est_floor_mst WHERE num_hospital_code = a.num_hospital_code AND num_floor_id = a.num_floor_id AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= \
						TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationfloor, (SELECT str_block_name FROM est_block_mst WHERE num_hospital_code = a.num_hospital_code AND num_block_id = a.num_block_id \
						AND gdt_effective_frm <= SYSDATE AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationblock, \
						(SELECT str_building_name  FROM est_building_mst  WHERE num_hospital_code = a.num_hospital_code AND num_building_code = a.num_building_code AND gdt_effective_frm <= SYSDATE \
						AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > 0) AS locationbuilding FROM est_guest_house_mst a WHERE num_hospital_code = ? \
						AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE)  AND TRUNC (NVL (gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND gnum_isvalid = ? order by num_guest_house_id 
						
SELECT.GUEST_HOUSE_DETAIL.EST_GUEST_HOUSE_BEDID_MAP		=	SELECT (SELECT m.str_floor_name FROM est_floor_mst m WHERE m.num_floor_id = a.num_floor_id  AND TRUNC (gdt_effective_frm) <= TRUNC (SYSDATE) AND TRUNC (NVL \
											(gdt_effective_to, SYSDATE)) >= TRUNC (SYSDATE) AND gnum_isvalid = 1  AND m.num_hospital_code = a.num_hospital_code) AS locationFloor, a.num_room_id AS locationroom, a.num_bed_id AS bed, \
       										(SELECT DECODE (t.str_status, '2', 'alloted', 'vacate') FROM piscgh_allotment_trn t WHERE a.num_room_id = t.num_room_id \
           									AND a.num_bed_id = t.num_bed_id AND t.gnum_hospital_code = a.num_hospital_code AND t.num_guest_house_id = a.num_guest_house_id and gnum_isvalid=1 and trunc(GDT_EFFECT_DATE)>=trunc(sysdate))status, \
           									(SELECT to_char(DT_VACATION_DATE,'dd-Mon-yyyy') FROM piscgh_allotment_trn t WHERE a.num_room_id = t.num_room_id \
           									AND a.num_bed_id = t.num_bed_id AND t.gnum_hospital_code = a.num_hospital_code AND t.num_guest_house_id = a.num_guest_house_id and gnum_isvalid=1 and trunc(GDT_EFFECT_DATE)>=trunc(sysdate))vacantOn,STR_RENT rent FROM est_guest_house_bedid_map a \
 											WHERE a.num_hospital_code = ? AND a.num_guest_house_id = ?	
 											
 											
ESSENTIAL.TEMPLATE_LIST_FOR_GUIDLINE.HGBT_TEMPLATE_MST = select HGNUM_TEMPLATE_ID, HGSTR_TEMPLATE_NAME from HGBT_TEMPLATE_MST \
															where HGNUM_TEMPLATE_CATEGORY=? and GNUM_ISVALID=? and GNUM_HOSPITAL_CODE=?	order by HGSTR_TEMPLATE_NAME


//-----------------MORTUARY----------------DECESED_ENQUIRY--------------------------------------------------------

SELECT_DECEASED_DETAIL_LIST.HMRT_DECEASED_DTL = SELECT A.HMRNUM_DECEASED_NO AS deceasedNo, A.HRGNUM_PUK AS patCrNo, A.HMRNUM_ENTRY_MODE AS entryMode, A.HMRSTR_FNAME AS patFirstName, \
													TO_CHAR(A.HMRDT_RECEIVED_DATETIME,'dd-Mon-yyyy HH24:MI') AS receivedDateTime, A.HMRSTR_MNAME AS patMiddleName, A.HMRSTR_LNAME AS patLastName, \
													A.GNUM_GENDER_CODE AS patGenderCode, TO_CHAR(A.HMRDT_DEATH_DATETIME,'dd-Mon-yyyy HH24:MI') AS deathDate, A.HMRNUM_BODY_STATUS AS bodyStatus, \
													A.HMRNUM_ISBROUGHT_DEAD AS isBroughtDead, A.HMRNUM_ISCLAIMED AS isClaimed, A.HMRNUM_UNIDENTIFIED_BODY as unidentifiedBody, ahis_util.DOB_AGE_ON(A.HMRDT_DOB,SYSDATE) AS patAge, \
													(SELECT D.GSTR_GENDER_NAME FROM GBLT_GENDER_MST D WHERE D.GSTR_GENDER_CODE =A.GNUM_GENDER_CODE AND  A.GNUM_ISVALID = A.GNUM_ISVALID) AS patGender \
													FROM HMRT_DECEASED_DTL A WHERE A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? AND A.HMRNUM_BODY_STATUS!= ? \
													ORDER BY A.HMRSTR_FNAME, A.HMRSTR_MNAME, A.HMRSTR_LNAME


SELECT_DECEASED_GENERL_APPEARANCE_BY_DECEASED_NO.HMRT_DECEASED_DTL = SELECT HMRSTR_COMPLEXION AS complexion, HMRSTR_HAIRCOLOR_LENGTH AS hairColorLength, HMRSTR_EYE_COLOR AS eyeColor, \
																		HMRNUM_LENGTH AS LENGTH,HMRNUM_WEIGHT AS weight, HMRSTR_CLOTHES_DETAIL AS clothDetails, HMRNUM_BODY_LOOKS AS bodyLooks, \
																		HMRNUM_IS_DECOMPOSITION AS isDecomposition, HMRNUM_BODY_STATUS AS bodystatus \
																		FROM HMRT_DECEASED_DTL WHERE HMRNUM_DECEASED_NO = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?


SELECT_DECEASED_DEFAULT_IMAGE.HMRT_DECEASED_IMAGE_DTL = SELECT HRGSTR_FILENO AS fileNo, HRGSTR_PATH AS filePath FROM HMRT_DECEASED_IMAGE_DTL WHERE HMRNUM_DECEASED_NO = ? \
															AND  HRGNUM_IS_DEFAULT = ? AND GNUM_ISVALID = ? AND GNUM_HOSPITAL_CODE = ?


GET_POSTMORTEM_STATUS_FOR_HANDOVER.HMRT_POSTMORTEM_REQ_DTL = SELECT  DECODE(A.HMRNUM_POSTMORTEM_STATUS,1,'Request Raised',2,'Request Approved',3,'Cancelled',4,'Wave Off',5,'Postmortm Entry',6,'Postmortem Done')||'@'|| \
																A.HMRNUM_POSTMORTEM_STATUS FROM HMRT_POSTMORTEM_REQ_DTL A WHERE A.HMRNUM_DECEASED_NO =  ? \
																AND A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? \
																AND A.HMRNUM_POSTMORTEM_ID = (SELECT MAX(B.HMRNUM_POSTMORTEM_ID) FROM HMRT_POSTMORTEM_REQ_DTL B \
																WHERE B.HMRNUM_DECEASED_NO=A.HMRNUM_DECEASED_NO AND B.GNUM_ISVALID = A.GNUM_ISVALID AND B.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE) \
																AND A.HRGNUM_SRNO = (SELECT MAX(B.HRGNUM_SRNO) FROM HMRT_POSTMORTEM_REQ_DTL B \
																WHERE B.HMRNUM_DECEASED_NO=A.HMRNUM_DECEASED_NO AND A.HMRNUM_POSTMORTEM_ID=B.HMRNUM_POSTMORTEM_ID \
																AND B.GNUM_ISVALID = A.GNUM_ISVALID AND B.GNUM_HOSPITAL_CODE = A.GNUM_HOSPITAL_CODE)

GET_DECEASED_STORAGE_DETAIL_BY_DECEASED_NO = SELECT HMRSTR_MORTURY_NAME||'@'||HMRSTR_AREA_NAME||'@'||HMRSTR_CHAMBER_NAME||'@'||HMRSTR_RACK_NAME \
												FROM HMRT_CHAMBER_MST A ,HMRT_CHAMBER_RACK_MST B,HMRT_DECEASED_STORAGE_DTL C, HMRT_MORTUARY_AREA_MST D, HMRT_MORTUARY_MST E \
												WHERE C.HMRNUM_DECEASED_NO = ? AND C.GNUM_ISVALID = ? \
												AND  C.HMRNUM_SLNO=(SELECT MAX(B.HMRNUM_SLNO) FROM HMRT_DECEASED_STORAGE_DTL B \
												WHERE C.HMRNUM_DECEASED_NO=B.HMRNUM_DECEASED_NO) \
												AND C.HMRNUM_CHAMBERRACK_ID=B.HMRNUM_CHAMBERRACK_ID AND B.HMRNUM_CHAMBER_ID=A.HMRNUM_CHAMBER_ID \
												AND C.GNUM_ISVALID=A.GNUM_ISVALID AND C.GNUM_ISVALID=B.GNUM_ISVALID \
												AND A.GNUM_HOSPITAL_CODE=B.GNUM_HOSPITAL_CODE AND A.GNUM_HOSPITAL_CODE=? \
												AND A.HMRNUM_AREA_CODE = D.HMRNUM_AREA_CODE AND A.GNUM_HOSPITAL_CODE=D.GNUM_HOSPITAL_CODE AND A.GNUM_ISVALID=D.GNUM_ISVALID \
												AND D. HMRNUM_MORTURY_CODE = E.HMRNUM_MORTURY_CODE AND D.GNUM_HOSPITAL_CODE=E.GNUM_HOSPITAL_CODE AND D.GNUM_ISVALID=E.GNUM_ISVALID 


SELECT_DECEASED_HANDOVER_DETAIL_BY_DECEASED_NO.HMRT_DECEASED_HANDOVER_DTL = SELECT A.HMRNUM_ISHANDOVER_TO AS isHandoverTo, A.HMRSTR_HANDOVER_TO_NAME AS handoverToName, A.HMRSTR_HANDOVER_TO_ADDRESS AS handoverToAddress, \
																				A.HRGSTR_HANDOVER_TO_PHONE AS handoverToPhone, A.HRGSTR_CONSTABLE_DESIG AS officerDesignation,  A.HRGSTR_CONSTABLE_BADGENO AS officerBadgeNo, \
																				(SELECT C.GSTR_RELATION_NAME FROM GBLT_RELATION_MST C WHERE C.GNUM_RELATION_CODE=A.GNUM_RELATION_CODE  AND C.GNUM_ISVALID=A.GNUM_ISVALID) AS relativeCode, \
																				DECODE(A.HMRNUM_ISHANDOVER_TO,2,'Police',3,'Relative') AS isHandoverToLabel FROM HMRT_DECEASED_HANDOVER_DTL A \
																				WHERE A.HMRNUM_DECEASED_NO = ? AND A.GNUM_ISVALID = ? AND A.GNUM_HOSPITAL_CODE = ? \
																				AND A.HRGNUM_SLNO = (SELECT MAX(B.HRGNUM_SLNO) FROM HMRT_DECEASED_HANDOVER_DTL B WHERE A.HMRNUM_DECEASED_NO=B.HMRNUM_DECEASED_NO)

SELECT.UNIT_WORKING_ROOM_DAYS_TIMING	=	SELECT DISTINCT DECODE(HOPNUM_DAY_OF_WEEK,1,'Sun',2,'Mon',3,'Tue',4,'Wed',5,'Thu',6,'Fri',7,'Sat') ||'#'|| \
											(SELECT HOPSTR_START_TIME||' - '||HOPSTR_END_TIME FROM GBLT_SHIFT_MST WHERE GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND \
											GNUM_ISVALID=1 AND HGNUM_SHIFT_CODE=A.HGNUM_SHIFT_CODE AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE \
											AND GNUM_ISVALID=A.GNUM_ISVALID) ||'#'||(SELECT HGSTR_ROOM_NAME FROM HGBT_ROOM_MST WHERE HGNUM_ROOM_CODE=A.HGNUM_ROOM_CODE \
											AND GNUM_HOSPITAL_CODE=A.GNUM_HOSPITAL_CODE AND GNUM_ISVALID=A.GNUM_ISVALID) room,HOPNUM_DAY_OF_WEEK dayOfWeek FROM HOPT_DEPT_UNIT_ROSTER_MST A \
											WHERE GNUM_ISVALID=? AND GNUM_HOSPITAL_CODE=? AND HGNUM_DEPTUNITCODE=? ORDER BY HOPNUM_DAY_OF_WEEK 


SELECT.FLOOR_NAME.EST_FLOOR_MST	=	SELECT str_floor_name FROM est_floor_mst WHERE num_hospital_code = ? AND num_floor_id = ?  AND gdt_effective_frm <= SYSDATE \
   									AND (TO_DATE (NVL (gdt_effective_to, SYSDATE), 'DD-MM-YY') >= TO_DATE (SYSDATE, 'DD-MM-YY')) AND gnum_isvalid > ?
																																																																																																						